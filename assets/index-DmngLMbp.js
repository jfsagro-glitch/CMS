const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DnynsFSl.js","assets/react-vendor-Of7we7Bb.js","assets/index.es-DG3o9-Dj.js","assets/antd-vendor-BS2-pQj8.js","assets/demoData-DJKFRABz.js","assets/redux-vendor-fNz2gZ-b.js","assets/inspectionDemoData-CpwMOjkS.js"])))=>i.map(i=>d[i]);
var vT=Object.defineProperty;var wT=(e,t,r)=>t in e?vT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var tr=(e,t,r)=>wT(e,typeof t!="symbol"?t+"":t,r);import{r as M,c as ET,g as db,u as $i,f as dc,O as bT,R as Ma,e as _T,h as ub,L as CT,H as BT,i as ST,j as Rr,N as Ov}from"./react-vendor-Of7we7Bb.js";import{c as am,a as TT,u as OT,b as IT,P as NT}from"./redux-vendor-fNz2gZ-b.js";import{C as fb,t as Ul,s as Ne,L as _f,T as Kr,M as FT,S as Te,a as Ve,B as Be,R as el,b as Oi,c as pb,d as go,e as RT,f as qc,g as z1,h as jr,i as kT,j as hb,k as tA,l as DT,m as Zf,n as Ao,o as jT,p as LT,q as Cf,r as Kc,u as ht,v as mb,w as gb,x as UT,y as xb,z as ys,A as MT,D as PT,I as Re,E as Pa,F as Iv,G as Bf,H as V1,J as yb,K as nm,N as ti,O as cr,P as ye,Q as QT,U as Nr,V as re,W as ir,X as pa,Y as ms,Z as Rs,_ as po,$ as Ze,a0 as qT,a1 as es,a2 as Ue,a3 as dt,a4 as be,a5 as yn,a6 as hh,a7 as tl,a8 as jt,a9 as KT,aa as Ns,ab as Js,ac as kl,ad as In,ae as Ii,af as We,ag as Dr,ah as $1,ai as ri,aj as vb,ak as sm,al as Sr,am as im,an as Y1,ao as Vn,ap as Jl,aq as Qt,ar as pt,as as Ml,at as tf,au as HT,av as GT,aw as mh,ax as ea,ay as zT,az as wb,aA as gh,aB as Eb,aC as VT,aD as lo,aE as $T,aF as W1,aG as Jp,aH as Ho,aI as Zl,aJ as ec,aK as bb,aL as _b,aM as YT,aN as Nv,aO as WT,aP as B2,aQ as Fv,aR as bd,aS as qn,aT as Cb,aU as XT,aV as JT,aW as S2,aX as Bb,aY as ZT,aZ as Sb,a_ as eO,a$ as Tb,b0 as Ob,b1 as Rv,b2 as tO,b3 as Z0,b4 as Ib,b5 as kv,b6 as rO,b7 as aO,b8 as nO,b9 as bn,ba as sO,bb as Dv,bc as iO,bd as oO,be as lO,bf as cO}from"./antd-vendor-BS2-pQj8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Nb={exports:{}},om={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AO=M,dO=Symbol.for("react.element"),uO=Symbol.for("react.fragment"),fO=Object.prototype.hasOwnProperty,pO=AO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hO={key:!0,ref:!0,__self:!0,__source:!0};function Fb(e,t,r){var a,n={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)fO.call(t,a)&&!hO.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:dO,type:e,key:i,ref:o,props:n,_owner:pO.current}}om.Fragment=uO;om.jsx=Fb;om.jsxs=Fb;Nb.exports=om;var s=Nb.exports,X1={},jv=ET;X1.createRoot=jv.createRoot,X1.hydrateRoot=jv.hydrateRoot;const mO="modulepreload",gO=function(e){return"/"+e},Lv={},ps=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=gO(c),c in Lv)return;Lv[c]=!0;const A=c.endsWith(".css"),d=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=A?"stylesheet":mO,A||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),A)return new Promise((p,u)=>{f.addEventListener("load",p),f.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};var lm={},Rb={exports:{}};(function(e){function t(r){return r&&r.__esModule?r:{default:r}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Rb);var cm=Rb.exports,Am={};Object.defineProperty(Am,"__esModule",{value:!0});Am.default=void 0;var xO={items_per_page:"/ стр.",jump_to:"Перейти",jump_to_confirm:"подтвердить",page:"Страница",prev_page:"Назад",next_page:"Вперед",prev_5:"Предыдущие 5",next_5:"Следующие 5",prev_3:"Предыдущие 3",next_3:"Следующие 3",page_size:"размер страницы"};Am.default=xO;var dm={},e0={},um={},kb={exports:{}},Db={exports:{}},jb={exports:{}},Lb={exports:{}};(function(e){function t(r){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Lb);var Ub=Lb.exports,Mb={exports:{}};(function(e){var t=Ub.default;function r(a,n){if(t(a)!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var o=i.call(a,n||"default");if(t(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Mb);var yO=Mb.exports;(function(e){var t=Ub.default,r=yO;function a(n){var i=r(n,"string");return t(i)=="symbol"?i:i+""}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(jb);var vO=jb.exports;(function(e){var t=vO;function r(a,n,i){return(n=t(n))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i,a}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Db);var wO=Db.exports;(function(e){var t=wO;function r(n,i){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);i&&(l=l.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),o.push.apply(o,l)}return o}function a(n){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?r(Object(o),!0).forEach(function(l){t(n,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(o,l))})}return n}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(kb);var EO=kb.exports,fm={};Object.defineProperty(fm,"__esModule",{value:!0});fm.commonLocale=void 0;fm.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var bO=cm.default;Object.defineProperty(um,"__esModule",{value:!0});um.default=void 0;var Uv=bO(EO),_O=fm,CO=(0,Uv.default)((0,Uv.default)({},_O.commonLocale),{},{locale:"ru_RU",today:"Сегодня",now:"Сейчас",backToToday:"Текущая дата",ok:"ОК",clear:"Очистить",week:"Неделя",month:"Месяц",year:"Год",timeSelect:"Выбрать время",dateSelect:"Выбрать дату",monthSelect:"Выбрать месяц",yearSelect:"Выбрать год",decadeSelect:"Выбрать десятилетие",dateFormat:"D-M-YYYY",dateTimeFormat:"D-M-YYYY HH:mm:ss",previousMonth:"Предыдущий месяц (PageUp)",nextMonth:"Следующий месяц (PageDown)",previousYear:"Предыдущий год (Control + left)",nextYear:"Следующий год (Control + right)",previousDecade:"Предыдущее десятилетие",nextDecade:"Следущее десятилетие",previousCentury:"Предыдущий век",nextCentury:"Следующий век"});um.default=CO;var t0={};Object.defineProperty(t0,"__esModule",{value:!0});t0.default=void 0;const BO={placeholder:"Выберите время",rangePlaceholder:["Время начала","Время окончания"]};t0.default=BO;var Pb=cm.default;Object.defineProperty(e0,"__esModule",{value:!0});e0.default=void 0;var SO=Pb(um),TO=Pb(t0);const OO={lang:Object.assign({placeholder:"Выберите дату",yearPlaceholder:"Выберите год",quarterPlaceholder:"Выберите квартал",monthPlaceholder:"Выберите месяц",weekPlaceholder:"Выберите неделю",rangePlaceholder:["Начальная дата","Конечная дата"],rangeYearPlaceholder:["Начальный год","Год окончания"],rangeMonthPlaceholder:["Начальный месяц","Конечный месяц"],rangeWeekPlaceholder:["Начальная неделя","Конечная неделя"],shortWeekDays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],shortMonths:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]},SO.default),timePickerLocale:Object.assign({},TO.default)};e0.default=OO;var IO=cm.default;Object.defineProperty(dm,"__esModule",{value:!0});dm.default=void 0;var NO=IO(e0);dm.default=NO.default;var pm=cm.default;Object.defineProperty(lm,"__esModule",{value:!0});lm.default=void 0;var FO=pm(Am),RO=pm(dm),kO=pm(e0),DO=pm(t0);const Qs="${label} не является типом ${type}",jO={locale:"ru",Pagination:FO.default,DatePicker:kO.default,TimePicker:DO.default,Calendar:RO.default,global:{placeholder:"Пожалуйста выберите",close:"Закрыть"},Table:{filterTitle:"Фильтр",filterConfirm:"OK",filterReset:"Сбросить",filterEmptyText:"Без фильтров",filterCheckAll:"Выбрать все элементы",filterSearchPlaceholder:"Поиск в фильтрах",emptyText:"Нет данных",selectAll:"Выбрать всё",selectInvert:"Инвертировать выбор",selectNone:"Очистить все данные",selectionAll:"Выбрать все данные",sortTitle:"Сортировка",expand:"Развернуть строку",collapse:"Свернуть строку",triggerDesc:"Нажмите для сортировки по убыванию",triggerAsc:"Нажмите для сортировки по возрастанию",cancelSort:"Нажмите, чтобы отменить сортировку"},Tour:{Next:"Далее",Previous:"Назад",Finish:"Завершить"},Modal:{okText:"OK",cancelText:"Отмена",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Отмена"},Transfer:{titles:["",""],searchPlaceholder:"Поиск",itemUnit:"элем.",itemsUnit:"элем.",remove:"Удалить",selectAll:"Выбрать все данные",deselectAll:"Очистить все данные",selectCurrent:"Выбрать текущую страницу",selectInvert:"Инвертировать выбор",removeAll:"Удалить все данные",removeCurrent:"Удалить текущую страницу"},Upload:{uploading:"Загрузка...",removeFile:"Удалить файл",uploadError:"При загрузке произошла ошибка",previewFile:"Предпросмотр файла",downloadFile:"Загрузить файл"},Empty:{description:"Нет данных"},Icon:{icon:"иконка"},Text:{edit:"Редактировать",copy:"Копировать",copied:"Скопировано",expand:"Раскрыть",collapse:"Свернуть"},Form:{optional:"(необязательно)",defaultValidateMessages:{default:"Ошибка проверки поля ${label}",required:"Пожалуйста, введите ${label}",enum:"${label} должен быть одним из [${enum}]",whitespace:"${label} не может быть пустым",date:{format:"${label} не правильный формат даты",parse:"${label} не может быть преобразовано в дату",invalid:"${label} не является корректной датой"},types:{string:Qs,method:Qs,array:Qs,object:Qs,number:Qs,date:Qs,boolean:Qs,integer:Qs,float:Qs,regexp:Qs,email:Qs,url:Qs,hex:Qs},string:{len:"${label} должна быть ${len} символов",min:"${label} должна быть больше или равна ${min} символов",max:"${label} должна быть меньше или равна ${max} символов",range:"Длина ${label} должна быть между ${min}-${max} символами"},number:{len:"${label} должна быть равна ${len}",min:"${label} должна быть больше или равна ${min}",max:"${label} должна быть меньше или равна ${max}",range:"${label} должна быть между ${min}-${max}"},array:{len:"Количество элементов ${label} должно быть равно ${len}",min:"Количество элементов ${label} должно быть больше или равно ${min}",max:"Количество элементов ${label} должно быть меньше или равно ${max}",range:"Количество элементов ${label} должно быть между ${min} и ${max}"},pattern:{mismatch:"${label} не соответствует шаблону ${pattern}"}}},Image:{preview:"Предпросмотр"},QRCode:{expired:"QR-код устарел",refresh:"Обновить"},ColorPicker:{presetEmpty:"Пустой",transparent:"Прозрачный",singleColor:"Один цвет",gradientColor:"Градиент"}};lm.default=jO;var LO=lm;const UO=db(LO),MO={theme:"light",language:"ru",sidebarCollapsed:!1,loading:!1,initialized:!1},Qb=am({name:"app",initialState:MO,reducers:{setTheme:(e,t)=>{e.theme=t.payload},setLanguage:(e,t)=>{e.language=t.payload},toggleSidebar:e=>{e.sidebarCollapsed=!e.sidebarCollapsed},setSidebarCollapsed:(e,t)=>{e.sidebarCollapsed=t.payload},setLoading:(e,t)=>{e.loading=t.payload},setInitialized:(e,t)=>{e.initialized=t.payload},setSettings:(e,t)=>({...e,...t.payload})}}),{setTheme:hY,setLanguage:mY,toggleSidebar:PO,setSidebarCollapsed:gY,setLoading:xY,setInitialized:QO,setSettings:qO}=Qb.actions,KO=Qb.reducer,HO={items:[],filteredItems:[],selectedCard:null,filters:{},sort:null,loading:!1,error:null},qb=am({name:"cards",initialState:HO,reducers:{setCards:(e,t)=>{e.items=t.payload,e.filteredItems=bl(t.payload,e.filters,e.sort)},addCard:(e,t)=>{e.items.push(t.payload),e.filteredItems=bl(e.items,e.filters,e.sort)},updateCard:(e,t)=>{const r=e.items.findIndex(a=>a.id===t.payload.id);r!==-1&&(e.items[r]=t.payload,e.filteredItems=bl(e.items,e.filters,e.sort))},deleteCard:(e,t)=>{e.items=e.items.filter(r=>r.id!==t.payload),e.filteredItems=bl(e.items,e.filters,e.sort)},deleteCards:(e,t)=>{e.items=e.items.filter(r=>!t.payload.includes(r.id)),e.filteredItems=bl(e.items,e.filters,e.sort)},setSelectedCard:(e,t)=>{e.selectedCard=t.payload},setFilters:(e,t)=>{e.filters=t.payload,e.filteredItems=bl(e.items,t.payload,e.sort)},setSort:(e,t)=>{e.sort=t.payload,e.filteredItems=bl(e.items,e.filters,t.payload)},clearFilters:e=>{e.filters={},e.filteredItems=bl(e.items,{},e.sort)},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload}}});function bl(e,t,r){let a=[...e];if(t.mainCategory&&(a=a.filter(n=>n.mainCategory===t.mainCategory)),t.status&&(a=a.filter(n=>n.status===t.status)),t.searchQuery){const n=t.searchQuery.toLowerCase();a=a.filter(i=>i.name.toLowerCase().includes(n)||i.number.toLowerCase().includes(n))}return t.dateFrom&&(a=a.filter(n=>n.createdAt>=t.dateFrom)),t.dateTo&&(a=a.filter(n=>n.createdAt<=t.dateTo)),r&&a.sort((n,i)=>{const o=n[r.field],l=i[r.field];return o==null?1:l==null?-1:o<l?r.order==="asc"?-1:1:o>l?r.order==="asc"?1:-1:0}),a}const{setCards:rf,addCard:yY,updateCard:vY,deleteCard:wY,deleteCards:EY,setSelectedCard:bY,setFilters:_Y,setSort:CY,clearFilters:BY,setLoading:SY,setError:TY}=qb.actions,GO=qb.reducer,zO={items:[],filteredItems:[],selectedCard:null,filters:{},sort:null,loading:!1,error:null},Kb=am({name:"extendedCards",initialState:zO,reducers:{setExtendedCards:(e,t)=>{e.items=t.payload,e.filteredItems=_l(t.payload,e.filters,e.sort)},addExtendedCard:(e,t)=>{e.items.push(t.payload),e.filteredItems=_l(e.items,e.filters,e.sort)},updateExtendedCard:(e,t)=>{const r=e.items.findIndex(a=>a.id===t.payload.id);r!==-1&&(e.items[r]=t.payload,e.filteredItems=_l(e.items,e.filters,e.sort))},deleteExtendedCard:(e,t)=>{e.items=e.items.filter(r=>r.id!==t.payload),e.filteredItems=_l(e.items,e.filters,e.sort)},deleteExtendedCards:(e,t)=>{e.items=e.items.filter(r=>!t.payload.includes(r.id)),e.filteredItems=_l(e.items,e.filters,e.sort)},setSelectedExtendedCard:(e,t)=>{e.selectedCard=t.payload},setExtendedFilters:(e,t)=>{e.filters=t.payload,e.filteredItems=_l(e.items,t.payload,e.sort)},setExtendedSort:(e,t)=>{e.sort=t.payload,e.filteredItems=_l(e.items,e.filters,t.payload)},clearExtendedFilters:e=>{e.filters={},e.filteredItems=_l(e.items,{},e.sort)},setExtendedLoading:(e,t)=>{e.loading=t.payload},setExtendedError:(e,t)=>{e.error=t.payload}}});function _l(e,t,r){let a=[...e];if(t.mainCategory&&(a=a.filter(n=>n.mainCategory===t.mainCategory)),t.status&&(a=a.filter(n=>n.status===t.status)),t.searchQuery){const n=t.searchQuery.toLowerCase();a=a.filter(i=>{var o,l;return i.name.toLowerCase().includes(n)||i.number.toLowerCase().includes(n)||((l=(o=i.address)==null?void 0:o.fullAddress)==null?void 0:l.toLowerCase().includes(n))})}return t.region&&(a=a.filter(n=>{var i,o;return(o=(i=n.address)==null?void 0:i.region)==null?void 0:o.toLowerCase().includes(t.region.toLowerCase())})),t.hasDocuments!==void 0&&(a=a.filter(n=>{var i,o;return t.hasDocuments?(((i=n.documents)==null?void 0:i.length)||0)>0:(((o=n.documents)==null?void 0:o.length)||0)===0})),r&&a.sort((n,i)=>{const o=n[r.field],l=i[r.field];if(o!==void 0&&l!==void 0){if(o<l)return r.order==="asc"?-1:1;if(o>l)return r.order==="asc"?1:-1}return 0}),a}const{setExtendedCards:J1,addExtendedCard:VO,updateExtendedCard:$O,deleteExtendedCard:YO,deleteExtendedCards:OY,setSelectedExtendedCard:IY,setExtendedFilters:NY,setExtendedSort:FY,clearExtendedFilters:RY,setExtendedLoading:Mv,setExtendedError:kY}=Kb.actions,WO=Kb.reducer,XO=[{id:"wf-1",objectId:"card-101",objectName:"Офисное помещение, Москва, 450 м²",assetType:"Недвижимость",debtAmount:12e7,appraisedValue:15e7,stage:"ANALYSIS",manager:"Иванов И.И.",deadline:new Date(Date.now()+7*24*3600*1e3).toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),history:[{id:"h-1",stage:"ANALYSIS",user:"Иванов И.И.",comment:"Старт анализа внесудебной реализации",createdAt:new Date().toISOString()}],documents:[],notes:"Проверить актуальность оценки и запросить выписку ЕГРН"},{id:"wf-2",objectId:"card-202",objectName:"Спецтехника: автокран Liebherr",assetType:"Движимое имущество",debtAmount:35e6,appraisedValue:42e6,stage:"NEGOTIATION",manager:"Петрова А.А.",deadline:new Date(Date.now()+3*24*3600*1e3).toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),history:[{id:"h-2",stage:"ANALYSIS",user:"Петрова А.А.",createdAt:new Date().toISOString(),comment:"Проведен анализ возможности внесудебной реализации"},{id:"h-3",stage:"PREPARATION",user:"Петрова А.А.",createdAt:new Date().toISOString(),comment:"Подготовлен пакет уведомлений"},{id:"h-4",stage:"NEGOTIATION",user:"Петрова А.А.",createdAt:new Date().toISOString(),comment:"Начаты переговоры с залогодателем"}],documents:[],notes:"Нужно согласовать скидку и рассрочку"}],Z1=[{id:"tpl-1",name:"Уведомление о намерении реализовать залог",type:"notification",description:"Базовое уведомление о старте внесудебной реализации",updatedAt:new Date().toISOString(),content:`Уведомление о намерении реализовать предмет залога

Дата: {{today}}

Объект залога: {{object.name}}
Идентификатор / номер: {{object.number}}
Адрес / местонахождение: {{object.address}}

Сумма задолженности по договору: {{workflow.debtAmount}} руб.
Оценочная (рыночная) стоимость предмета залога: {{workflow.appraisedValue}} руб.

Настоящим Банк уведомляет о намерении осуществить внесудебную реализацию предмета залога в связи с нарушением обязательств по договору. Просим в срок до {{workflow.deadlineFormatted}} связаться с ответственным менеджером {{workflow.manager}} для обсуждения вариантов урегулирования задолженности (добровольная продажа, отступное, реструктуризация).`},{id:"tpl-2",name:"Претензионное письмо",type:"claim",description:"Претензия с указанием задолженности и сроков",updatedAt:new Date().toISOString(),content:`Претензионное письмо

Дата: {{today}}

Объект залога: {{object.name}}
Идентификатор / номер: {{object.number}}
Адрес / местонахождение: {{object.address}}

Сумма просроченной задолженности: {{workflow.debtAmount}} руб.

В нарушение условий заключённого договора обязательства исполняются ненадлежащим образом. В соответствии с условиями договора и действующим законодательством предлагаем в срок до {{workflow.deadlineFormatted}} добровольно урегулировать задолженность путём погашения задолженности или заключения соглашения об отступном / добровольной реализации залога.

В случае неисполнения требований Банка в указанный срок Банк оставляет за собой право обратиться в суд и (или) реализовать предмет залога в порядке, предусмотренном законодательством.`},{id:"tpl-3",name:"Соглашение об отступном",type:"agreement",description:"Шаблон соглашения об отступном",updatedAt:new Date().toISOString(),content:`Соглашение об отступном (черновик)

Дата: {{today}}

Объект: {{object.name}}, идентификатор {{object.number}}, адрес {{object.address}}.

Стороны договорились, что в целях прекращения обязательств по договору займа/кредита заёмщик / залогодатель передаёт Банку в собственность указанный предмет залога, а Банк засчитывает его стоимость в счёт исполнения обязательств.

Договорная стоимость предмета залога по соглашению сторон: {{workflow.appraisedValue}} руб.
Условия и порядок передачи имущества, а также порядок снятия обременений и государственной регистрации перехода права собственности подробно описываются в разделах {{custom.sections}} данного соглашения.

Настоящий текст является заготовкой и подлежит юридической доработке.`},{id:"tpl-4",name:"Договор купли-продажи залогового имущества",type:"sale-contract",description:"Шаблон ДКП для внесудебной реализации",updatedAt:new Date().toISOString(),content:`Договор купли-продажи залогового имущества (черновик)

Дата: {{today}}

Предмет договора: {{object.name}}
Идентификатор / номер: {{object.number}}
Адрес / местонахождение: {{object.address}}

Покупатель приобретает у Продавца указанный объект по цене {{workflow.salePrice}} руб. (при отсутствии договорной цены использовать оценочную стоимость {{workflow.appraisedValue}} руб.).

Расчёты производятся в порядке и сроки, определённые разделом "Порядок расчётов". Особые условия сделки и распределение расходов на регистрацию перехода права собственности указываются в разделе "Особые условия": {{workflow.conditions}}.

Настоящий текст является заготовкой и требует проверки со стороны юридической службы.`}],JO={cases:XO,kpi:null,templates:Z1,segments:[{id:"seg-1",name:"Малый долг, короткая просрочка",description:"Сумма долга до 300 тыс., просрочка до 10 дней",minDebt:0,maxDebt:3e5,minDaysOverdue:1,maxDaysOverdue:10,debtorTypes:["individual","sole_trader"],strategySummary:"Мягкая коммуникация, напоминания, акцент на сохранении отношений."},{id:"seg-2",name:"Средний долг, средняя просрочка",description:"300 тыс.–5 млн, просрочка 11–30 дней",minDebt:3e5,maxDebt:5e6,minDaysOverdue:11,maxDaysOverdue:30,debtorTypes:["individual","sole_trader","legal"],strategySummary:"Комбинация напоминаний и претензионной работы, проработка реструктуризации."},{id:"seg-3",name:"Крупный долг / длительная просрочка",description:"Более 5 млн или просрочка свыше 30 дней",minDebt:5e6,debtorTypes:["individual","sole_trader","legal"],strategySummary:"Усиленная претензионная работа, подключение юристов, обсуждение отступного/реализации залога."}],steps:[{id:"step-1",name:"Автоматическое напоминание",dayFrom:0,dayTo:3,channel:"sms",owner:"system",description:"Авто-SMS/email напоминание о необходимости оплаты, без давления."},{id:"step-2",name:"Первичный звонок менеджера",dayFrom:5,dayTo:9,channel:"call",owner:"manager",description:"Вежливый звонок, выяснение причины, фиксация договорённостей."},{id:"step-3",name:"Официальная претензия",dayFrom:10,dayTo:19,channel:"email",owner:"manager",description:"Претензия по email/почте с указанием срока для добровольного урегулирования."},{id:"step-4",name:"Звонок старшего менеджера",dayFrom:20,dayTo:29,channel:"call",owner:"senior_manager",description:"Углублённое обсуждение вариантов реструктуризации, фиксация предложения Банка."},{id:"step-5",name:"Эскалация и подготовка к суду",dayFrom:30,dayTo:999,channel:"legal",owner:"legal",description:"Окончательная претензия, подготовка пакета документов для передачи юристам/коллекторам."}],scripts:[{id:"scr-1",name:"Вежливое напоминание (дни 0–3)",segmentIds:["seg-1","seg-2"],stepIds:["step-1"],summary:"Короткое напоминание без давления: уточнение, всё ли в порядке, предложение помощи по оплате."},{id:"scr-2",name:"Звонок менеджера (день 5+)",segmentIds:["seg-1","seg-2","seg-3"],stepIds:["step-2"],summary:"Скрипт звонка с выяснением причин просрочки, фиксацией даты оплаты и отказом от угроз."},{id:"scr-3",name:"Официальная претензия",segmentIds:["seg-2","seg-3"],stepIds:["step-3"],summary:"Структура претензионного письма без нарушения закона о коллекторах (без давления на личность)."}],restructuringRules:[{id:"rr-1",name:"Рассрочка до 6 месяцев",description:"Деление долга на равные ежемесячные платежи до 6 месяцев, без списания основного долга.",allowedForSegments:["seg-1","seg-2"],managerLimitPercent:10},{id:"rr-2",name:"Отсрочка + увеличение срока",description:"Отсрочка погашения основного долга на 1–3 месяца с сохранением процентов и увеличением срока кредита.",allowedForSegments:["seg-2"],managerLimitPercent:15},{id:"rr-3",name:"Скидка за быстрый расчёт",description:"Разовая скидка при полном погашении долга в короткий срок (до 10 рабочих дней).",allowedForSegments:["seg-2","seg-3"],managerLimitPercent:20}]},Hb=am({name:"workflow",initialState:JO,reducers:{setCases:(e,t)=>{e.cases=t.payload},addCase:(e,t)=>{e.cases.push(t.payload)},addTemplate:(e,t)=>{e.templates.push(t.payload)},updateCaseStage:(e,t)=>{const r=e.cases.find(a=>a.id===t.payload.id);r&&(r.stage=t.payload.stage,r.updatedAt=new Date().toISOString(),r.history=[{id:`h-${Date.now()}`,stage:t.payload.stage,user:t.payload.user||"Система",comment:t.payload.comment,createdAt:r.updatedAt},...r.history])},updateCaseDocuments:(e,t)=>{const r=e.cases.find(a=>a.id===t.payload.id);r&&(r.documents=t.payload.documents,r.updatedAt=new Date().toISOString())},setKpi:(e,t)=>{e.kpi=t.payload},setTemplates:(e,t)=>{e.templates=t.payload},updateTemplate:(e,t)=>{const r=e.templates.findIndex(a=>a.id===t.payload.id);r>=0&&(e.templates[r]=t.payload)},updateCaseSegment:(e,t)=>{const r=e.cases.find(a=>a.id===t.payload.id);r&&(r.segmentId=t.payload.segmentId,r.updatedAt=new Date().toISOString())}}}),{setCases:ZO,addCase:eI,addTemplate:tI,updateCaseStage:ex,updateCaseDocuments:Pv,setKpi:DY,setTemplates:Qv,updateTemplate:rI,updateCaseSegment:aI}=Hb.actions,nI=Hb.reducer,sI=TT({reducer:{app:KO,cards:GO,extendedCards:WO,workflow:nI},middleware:e=>e({serializableCheck:{ignoredActions:["cards/setCards","cards/addCard","cards/updateCard","extendedCards/setExtendedCards","extendedCards/addExtendedCard","extendedCards/updateExtendedCard"],ignoredPaths:["cards.items","extendedCards.items"]}})}),nl=()=>OT(),Vi=IT,ia=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Xa=Object.keys,Xn=Array.isArray;function gs(e,t){return typeof t!="object"||Xa(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||ia.Promise||(ia.Promise=Promise);const Sf=Object.getPrototypeOf,iI={}.hasOwnProperty;function ai(e,t){return iI.call(e,t)}function Pd(e,t){typeof t=="function"&&(t=t(Sf(e))),(typeof Reflect>"u"?Xa:Reflect.ownKeys)(t).forEach(r=>{$o(e,r,t[r])})}const Gb=Object.defineProperty;function $o(e,t,r,a){Gb(e,t,gs(r&&ai(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},a))}function _d(e){return{from:function(t){return e.prototype=Object.create(t.prototype),$o(e.prototype,"constructor",e),{extend:Pd.bind(null,e.prototype)}}}}const oI=Object.getOwnPropertyDescriptor;function T2(e,t){let r;return oI(e,t)||(r=Sf(e))&&T2(r,t)}const lI=[].slice;function xh(e,t,r){return lI.call(e,t,r)}function zb(e,t){return t(e)}function qu(e){if(!e)throw new Error("Assertion Failed")}function Vb(e){ia.setImmediate?setImmediate(e):setTimeout(e,0)}function $b(e,t){return e.reduce((r,a,n)=>{var i=t(a,n);return i&&(r[i[0]]=i[1]),r},{})}function Yo(e,t){if(typeof t=="string"&&ai(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],a=0,n=t.length;a<n;++a){var i=Yo(e,t[a]);r.push(i)}return r}var o=t.indexOf(".");if(o!==-1){var l=e[t.substr(0,o)];return l==null?void 0:Yo(l,t.substr(o+1))}}function Ki(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){qu(typeof r!="string"&&"length"in r);for(var a=0,n=t.length;a<n;++a)Ki(e,t[a],r[a])}else{var i=t.indexOf(".");if(i!==-1){var o=t.substr(0,i),l=t.substr(i+1);if(l==="")r===void 0?Xn(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=r;else{var c=e[o];c&&ai(e,o)||(c=e[o]={}),Ki(c,l,r)}}else r===void 0?Xn(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Yb(e){var t={};for(var r in e)ai(e,r)&&(t[r]=e[r]);return t}const cI=[].concat;function Wb(e){return cI.apply([],e)}const Xb="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Wb([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>ia[e]),AI=Xb.map(e=>ia[e]);$b(Xb,e=>[e,!0]);let Dl=null;function r0(e){Dl=typeof WeakMap<"u"&&new WeakMap;const t=tx(e);return Dl=null,t}function tx(e){if(!e||typeof e!="object")return e;let t=Dl&&Dl.get(e);if(t)return t;if(Xn(e)){t=[],Dl&&Dl.set(e,t);for(var r=0,a=e.length;r<a;++r)t.push(tx(e[r]))}else if(AI.indexOf(e.constructor)>=0)t=e;else{const i=Sf(e);for(var n in t=i===Object.prototype?{}:Object.create(i),Dl&&Dl.set(e,t),e)ai(e,n)&&(t[n]=tx(e[n]))}return t}const{toString:dI}={};function rx(e){return dI.call(e).slice(8,-1)}const ax=typeof Symbol<"u"?Symbol.iterator:"@@iterator",uI=typeof ax=="symbol"?function(e){var t;return e!=null&&(t=e[ax])&&t.apply(e)}:function(){return null},dd={};function Ko(e){var t,r,a,n;if(arguments.length===1){if(Xn(e))return e.slice();if(this===dd&&typeof e=="string")return[e];if(n=uI(e)){for(r=[];!(a=n.next()).done;)r.push(a.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const O2=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var yo=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Jb(e,t){yo=e,Zb=t}var Zb=()=>!0;const fI=!new Error("").stack;function uA(){if(fI)try{throw uA.arguments,new Error}catch(e){return e}return new Error}function nx(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(Zb).map(a=>`
`+a).join("")):""}var e_=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],I2=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(e_),pI={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Cd(e,t){this._e=uA(),this.name=e,this.message=t}function t_(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,a,n)=>n.indexOf(r)===a).join(`
`)}function yh(e,t,r,a){this._e=uA(),this.failures=t,this.failedKeys=a,this.successCount=r,this.message=t_(e,t)}function af(e,t){this._e=uA(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=t_(e,t)}_d(Cd).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+nx(this._e,2))}},toString:function(){return this.name+": "+this.message}}),_d(yh).from(Cd),_d(af).from(Cd);var N2=I2.reduce((e,t)=>(e[t]=t+"Error",e),{});const hI=Cd;var Xt=I2.reduce((e,t)=>{var r=t+"Error";function a(n,i){this._e=uA(),this.name=r,n?typeof n=="string"?(this.message=`${n}${i?`
 `+i:""}`,this.inner=i||null):typeof n=="object"&&(this.message=`${n.name} ${n.message}`,this.inner=n):(this.message=pI[t]||r,this.inner=null)}return _d(a).from(hI),e[t]=a,e},{});Xt.Syntax=SyntaxError,Xt.Type=TypeError,Xt.Range=RangeError;var qv=e_.reduce((e,t)=>(e[t+"Error"]=Xt[t],e),{}),Zp=I2.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Xt[t]),e),{});function Zr(){}function Tf(e){return e}function mI(e,t){return e==null||e===Tf?t:function(r){return t(e(r))}}function rA(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function gI(e,t){return e===Zr?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var a=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?rA(a,this.onsuccess):a),n&&(this.onerror=this.onerror?rA(n,this.onerror):n),i!==void 0?i:r}}function xI(e,t){return e===Zr?t:function(){e.apply(this,arguments);var r=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?rA(r,this.onsuccess):r),a&&(this.onerror=this.onerror?rA(a,this.onerror):a)}}function yI(e,t){return e===Zr?t:function(r){var a=e.apply(this,arguments);gs(r,a);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?rA(n,this.onsuccess):n),i&&(this.onerror=this.onerror?rA(i,this.onerror):i),a===void 0?o===void 0?void 0:o:gs(a,o)}}function vI(e,t){return e===Zr?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function F2(e,t){return e===Zr?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var a=this,n=arguments.length,i=new Array(n);n--;)i[n]=arguments[n];return r.then(function(){return t.apply(a,i)})}return t.apply(this,arguments)}}Zp.ModifyError=yh,Zp.DexieError=Cd,Zp.BulkError=af;var Of={};const r_=100,[sx,vh,ix]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Sf(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Sf(t),e]})(),a_=vh&&vh.then,eh=sx&&sx.constructor,R2=!!ix;var ox=!1,wI=ix?()=>{ix.then(ep)}:ia.setImmediate?setImmediate.bind(null,ep):ia.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{ep(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(ep,0)},nf=function(e,t){Ku.push([e,t]),wh&&(wI(),wh=!1)},lx=!0,wh=!0,Hc=[],th=[],cx=null,Ax=Tf,Bd={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Gv,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{Gv(e[0],e[1])}catch{}})}},qt=Bd,Ku=[],Gc=0,rh=[];function Nt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Zr,this._lib=!1;var t=this._PSD=qt;if(yo&&(this._stackHolder=uA(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Of)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ux(this,this._value))}this._state=null,this._value=null,++t.ref,s_(this,e)}const dx={get:function(){var e=qt,t=Eh;function r(a,n){var i=!e.global&&(e!==qt||t!==Eh);const o=i&&!rl();var l=new Nt((c,A)=>{k2(this,new n_(bh(a,e,i,o),bh(n,e,i,o),c,A,e))});return yo&&l_(l,this),l}return r.prototype=Of,r},set:function(e){$o(this,"then",e&&e.prototype===Of?dx:{get:function(){return e},set:dx.set})}};function n_(e,t,r,a,n){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=a,this.psd=n}function s_(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var a=e._lib&&a0();r&&typeof r.then=="function"?s_(e,(n,i)=>{r instanceof Nt?r._then(n,i):r.then(n,i)}):(e._state=!0,e._value=r,i_(e)),a&&n0()}},ux.bind(null,e))}catch(r){ux(e,r)}}function ux(e,t){if(th.push(t),e._state===null){var r=e._lib&&a0();t=Ax(t),e._state=!1,e._value=t,yo&&t!==null&&typeof t=="object"&&!t._promise&&function(a,n,i){try{a.apply(null,i)}catch{}}(()=>{var a=T2(t,"stack");t._promise=e,$o(t,"stack",{get:()=>ox?a&&(a.get?a.get.apply(t):a.value):e.stack})}),function(a){Hc.some(n=>n._value===a._value)||Hc.push(a)}(e),i_(e),r&&n0()}}function i_(e){var t=e._listeners;e._listeners=[];for(var r=0,a=t.length;r<a;++r)k2(e,t[r]);var n=e._PSD;--n.ref||n.finalize(),Gc===0&&(++Gc,nf(()=>{--Gc==0&&D2()},[]))}function k2(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Gc,nf(EI,[r,e,t])}else e._listeners.push(t)}function EI(e,t,r){try{cx=t;var a,n=t._value;t._state?a=e(n):(th.length&&(th=[]),a=e(n),th.indexOf(n)===-1&&function(i){for(var o=Hc.length;o;)if(Hc[--o]._value===i._value)return void Hc.splice(o,1)}(t)),r.resolve(a)}catch(i){r.reject(i)}finally{cx=null,--Gc==0&&D2(),--r.psd.ref||r.psd.finalize()}}function o_(e,t,r){if(t.length===r)return t;var a="";if(e._state===!1){var n,i,o=e._value;o!=null?(n=o.name||"Error",i=o.message||o,a=nx(o,0)):(n=o,i=""),t.push(n+(i?": "+i:"")+a)}return yo&&((a=nx(e._stackHolder,2))&&t.indexOf(a)===-1&&t.push(a),e._prev&&o_(e._prev,t,r)),t}function l_(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function ep(){a0()&&n0()}function a0(){var e=lx;return lx=!1,wh=!1,e}function n0(){var e,t,r;do for(;Ku.length>0;)for(e=Ku,Ku=[],r=e.length,t=0;t<r;++t){var a=e[t];a[0].apply(null,a[1])}while(Ku.length>0);lx=!0,wh=!0}function D2(){var e=Hc;Hc=[],e.forEach(a=>{a._PSD.onunhandled.call(null,a._value,a)});for(var t=rh.slice(0),r=t.length;r;)t[--r]()}function tp(e){return new Nt(Of,!1,e)}function fa(e,t){var r=qt;return function(){var a=a0(),n=qt;try{return rc(r,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{rc(n,!1),a&&n0()}}}Pd(Nt.prototype,{then:dx,_then:function(e,t){k2(this,new n_(null,null,e,t,qt))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,a=>a instanceof t?r(a):tp(a)):this.then(null,a=>a&&a.name===t?r(a):tp(a))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),tp(t)))},stack:{get:function(){if(this._stack)return this._stack;try{ox=!0;var e=o_(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{ox=!1}}},timeout:function(e,t){return e<1/0?new Nt((r,a)=>{var n=setTimeout(()=>a(new Xt.Timeout(t)),e);this.then(r,a).finally(clearTimeout.bind(null,n))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&$o(Nt.prototype,Symbol.toStringTag,"Dexie.Promise"),Bd.env=c_(),Pd(Nt,{all:function(){var e=Ko.apply(null,arguments).map(rp);return new Nt(function(t,r){e.length===0&&t([]);var a=e.length;e.forEach((n,i)=>Nt.resolve(n).then(o=>{e[i]=o,--a||t(e)},r))})},resolve:e=>{if(e instanceof Nt)return e;if(e&&typeof e.then=="function")return new Nt((r,a)=>{e.then(r,a)});var t=new Nt(Of,!0,e);return l_(t,cx),t},reject:tp,race:function(){var e=Ko.apply(null,arguments).map(rp);return new Nt((t,r)=>{e.map(a=>Nt.resolve(a).then(t,r))})},PSD:{get:()=>qt,set:e=>qt=e},totalEchoes:{get:()=>Eh},newPSD:tc,usePSD:Vd,scheduler:{get:()=>nf,set:e=>{nf=e}},rejectionMapper:{get:()=>Ax,set:e=>{Ax=e}},follow:(e,t)=>new Nt((r,a)=>tc((n,i)=>{var o=qt;o.unhandleds=[],o.onunhandled=i,o.finalize=rA(function(){(function(l){function c(){l(),rh.splice(rh.indexOf(c),1)}rh.push(c),++Gc,nf(()=>{--Gc==0&&D2()},[])})(()=>{this.unhandleds.length===0?n():i(this.unhandleds[0])})},o.finalize),e()},t,r,a))}),eh&&(eh.allSettled&&$o(Nt,"allSettled",function(){const e=Ko.apply(null,arguments).map(rp);return new Nt(t=>{e.length===0&&t([]);let r=e.length;const a=new Array(r);e.forEach((n,i)=>Nt.resolve(n).then(o=>a[i]={status:"fulfilled",value:o},o=>a[i]={status:"rejected",reason:o}).then(()=>--r||t(a)))})}),eh.any&&typeof AggregateError<"u"&&$o(Nt,"any",function(){const e=Ko.apply(null,arguments).map(rp);return new Nt((t,r)=>{e.length===0&&r(new AggregateError([]));let a=e.length;const n=new Array(a);e.forEach((i,o)=>Nt.resolve(i).then(l=>t(l),l=>{n[o]=l,--a||r(new AggregateError(n))}))})}));const $n={awaits:0,echoes:0,id:0};var bI=0,ah=[],bg=0,Eh=0,_I=0;function tc(e,t,r,a){var n=qt,i=Object.create(n);i.parent=n,i.ref=0,i.global=!1,i.id=++_I;var o=Bd.env;i.env=R2?{Promise:Nt,PromiseProp:{value:Nt,configurable:!0,writable:!0},all:Nt.all,race:Nt.race,allSettled:Nt.allSettled,any:Nt.any,resolve:Nt.resolve,reject:Nt.reject,nthen:Kv(o.nthen,i),gthen:Kv(o.gthen,i)}:{},t&&gs(i,t),++n.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=Vd(i,e,r,a);return i.ref===0&&i.finalize(),l}function zd(){return $n.id||($n.id=++bI),++$n.awaits,$n.echoes+=r_,$n.id}function rl(){return!!$n.awaits&&(--$n.awaits==0&&($n.id=0),$n.echoes=$n.awaits*r_,!0)}function rp(e){return $n.echoes&&e&&e.constructor===eh?(zd(),e.then(t=>(rl(),t),t=>(rl(),on(t)))):e}function CI(e){++Eh,$n.echoes&&--$n.echoes!=0||($n.echoes=$n.id=0),ah.push(qt),rc(e,!0)}function BI(){var e=ah[ah.length-1];ah.pop(),rc(e,!1)}function rc(e,t){var r=qt;if((t?!$n.echoes||bg++&&e===qt:!bg||--bg&&e===qt)||A_(t?CI.bind(null,e):BI),e!==qt&&(qt=e,r===Bd&&(Bd.env=c_()),R2)){var a=Bd.env.Promise,n=e.env;vh.then=n.nthen,a.prototype.then=n.gthen,(r.global||e.global)&&(Object.defineProperty(ia,"Promise",n.PromiseProp),a.all=n.all,a.race=n.race,a.resolve=n.resolve,a.reject=n.reject,n.allSettled&&(a.allSettled=n.allSettled),n.any&&(a.any=n.any))}}function c_(){var e=ia.Promise;return R2?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(ia,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:vh.then,gthen:e.prototype.then}:{}}function Vd(e,t,r,a,n){var i=qt;try{return rc(e,!0),t(r,a,n)}finally{rc(i,!1)}}function A_(e){a_.call(sx,e)}function bh(e,t,r,a){return typeof e!="function"?e:function(){var n=qt;r&&zd(),rc(t,!0);try{return e.apply(this,arguments)}finally{rc(n,!1),a&&A_(rl)}}}function Kv(e,t){return function(r,a){return e.call(this,bh(r,t),bh(a,t))}}(""+a_).indexOf("[native code]")===-1&&(zd=rl=Zr);const Hv="unhandledrejection";function Gv(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var a,n={promise:t,reason:e};if(ia.document&&document.createEvent?((a=document.createEvent("Event")).initEvent(Hv,!0,!0),gs(a,n)):ia.CustomEvent&&gs(a=new CustomEvent(Hv,{detail:n}),n),a&&ia.dispatchEvent&&(dispatchEvent(a),!ia.PromiseRejectionEvent&&ia.onunhandledrejection))try{ia.onunhandledrejection(a)}catch{}yo&&a&&!a.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var on=Nt.reject;function fx(e,t,r,a){if(e.idbdb&&(e._state.openComplete||qt.letThrough||e._vip)){var n=e._createTransaction(t,r,e._dbSchema);try{n.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===N2.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>fx(e,t,r,a))):on(i)}return n._promise(t,(i,o)=>tc(()=>(qt.trans=n,a(i,o,n)))).then(i=>n._completion.then(()=>i))}if(e._state.openComplete)return on(new Xt.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return on(new Xt.DatabaseClosed);e.open().catch(Zr)}return e._state.dbReadyPromise.then(()=>fx(e,t,r,a))}const zv="3.2.7",Uc="￿",px=-1/0,jo="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",d_="String expected.",sf=[],hm=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),SI=hm,TI=hm,u_=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),mm="__dbnames",_g="readonly",Cg="readwrite";function aA(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const f_={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ap(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=r0(t))[e],t)}let OI=class{_trans(t,r,a){const n=this._tx||qt.trans,i=this.name;function o(c,A,d){if(!d.schema[i])throw new Xt.NotFound("Table "+i+" not part of transaction");return r(d.idbtrans,d)}const l=a0();try{return n&&n.db===this.db?n===qt.trans?n._promise(t,o,a):tc(()=>n._promise(t,o,a),{trans:n,transless:qt.transless||qt}):fx(this.db,t,[this.name],o)}finally{l&&n0()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",a=>this.core.get({trans:a,key:t}).then(n=>this.hook.reading.fire(n))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Xn(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Xa(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const a=this.schema.indexes.concat(this.schema.primKey).filter(A=>{if(A.compound&&r.every(d=>A.keyPath.indexOf(d)>=0)){for(let d=0;d<r.length;++d)if(r.indexOf(A.keyPath[d])===-1)return!1;return!0}return!1}).sort((A,d)=>A.keyPath.length-d.keyPath.length)[0];if(a&&this.db._maxKey!==Uc){const A=a.keyPath.slice(0,r.length);return this.where(A).equals(A.map(d=>t[d]))}!a&&yo&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:n}=this.schema,i=this.db._deps.indexedDB;function o(A,d){try{return i.cmp(A,d)===0}catch{return!1}}const[l,c]=r.reduce(([A,d],f)=>{const p=n[f],u=t[f];return[A||p,A||!p?aA(d,p&&p.multi?g=>{const h=Yo(g,f);return Xn(h)&&h.some(x=>o(u,x))}:g=>o(u,Yo(g,f))):d]},[null,null]);return l?this.where(l.name).equals(t[l.keyPath]).filter(c):a?this.filter(c):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Xn(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=a=>{if(!a)return a;const n=Object.create(t.prototype);for(var i in a)if(ai(a,i))try{n[i]=a[i]}catch{}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){gs(this,t)})}add(t,r){const{auto:a,keyPath:n}=this.schema.primKey;let i=t;return n&&a&&(i=ap(n)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:r!=null?[r]:null,values:[i]})).then(o=>o.numFailures?Nt.reject(o.failures[0]):o.lastResult).then(o=>{if(n)try{Ki(t,n,o)}catch{}return o})}update(t,r){if(typeof t!="object"||Xn(t))return this.where(":id").equals(t).modify(r);{const a=Yo(t,this.schema.primKey.keyPath);if(a===void 0)return on(new Xt.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Xa(r).forEach(n=>{Ki(t,n,r[n])}):r(t,{value:t,primKey:a})}catch{}return this.where(":id").equals(a).modify(r)}}put(t,r){const{auto:a,keyPath:n}=this.schema.primKey;let i=t;return n&&a&&(i=ap(n)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[i],keys:r!=null?[r]:null})).then(o=>o.numFailures?Nt.reject(o.failures[0]):o.lastResult).then(o=>{if(n)try{Ki(t,n,o)}catch{}return o})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?Nt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:f_})).then(t=>t.numFailures?Nt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(a=>a.map(n=>this.hook.reading.fire(n))))}bulkAdd(t,r,a){const n=Array.isArray(r)?r:void 0,i=(a=a||(n?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:l,keyPath:c}=this.schema.primKey;if(c&&n)throw new Xt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Xt.InvalidArgument("Arguments objects and keys must have the same length");const A=t.length;let d=c&&l?t.map(ap(c)):t;return this.core.mutate({trans:o,type:"add",keys:n,values:d,wantResults:i}).then(({numFailures:f,results:p,lastResult:u,failures:g})=>{if(f===0)return i?p:u;throw new af(`${this.name}.bulkAdd(): ${f} of ${A} operations failed`,g)})})}bulkPut(t,r,a){const n=Array.isArray(r)?r:void 0,i=(a=a||(n?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:l,keyPath:c}=this.schema.primKey;if(c&&n)throw new Xt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Xt.InvalidArgument("Arguments objects and keys must have the same length");const A=t.length;let d=c&&l?t.map(ap(c)):t;return this.core.mutate({trans:o,type:"put",keys:n,values:d,wantResults:i}).then(({numFailures:f,results:p,lastResult:u,failures:g})=>{if(f===0)return i?p:u;throw new af(`${this.name}.bulkPut(): ${f} of ${A} operations failed`,g)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",a=>this.core.mutate({trans:a,type:"delete",keys:t})).then(({numFailures:a,lastResult:n,failures:i})=>{if(a===0)return n;throw new af(`${this.name}.bulkDelete(): ${a} of ${r} operations failed`,i)})}};function of(e){var t={},r=function(o,l){if(l){for(var c=arguments.length,A=new Array(c-1);--c;)A[c-1]=arguments[c];return t[o].subscribe.apply(null,A),e}if(typeof o=="string")return t[o]};r.addEventType=i;for(var a=1,n=arguments.length;a<n;++a)i(arguments[a]);return r;function i(o,l,c){if(typeof o!="object"){var A;l||(l=vI),c||(c=Zr);var d={subscribers:[],fire:c,subscribe:function(f){d.subscribers.indexOf(f)===-1&&(d.subscribers.push(f),d.fire=l(d.fire,f))},unsubscribe:function(f){d.subscribers=d.subscribers.filter(function(p){return p!==f}),d.fire=d.subscribers.reduce(l,c)}};return t[o]=r[o]=d,d}Xa(A=o).forEach(function(f){var p=A[f];if(Xn(p))i(f,A[f][0],A[f][1]);else{if(p!=="asap")throw new Xt.InvalidArgument("Invalid event config");var u=i(f,Tf,function(){for(var g=arguments.length,h=new Array(g);g--;)h[g]=arguments[g];u.subscribers.forEach(function(x){Vb(function(){x.apply(null,h)})})})}})}}function Su(e,t){return _d(t).from({prototype:e}),t}function KA(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Bg(e,t){e.filter=aA(e.filter,t)}function Sg(e,t,r){var a=e.replayFilter;e.replayFilter=a?()=>aA(a(),t()):t,e.justLimit=r&&!a}function nh(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Xt.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Vv(e,t,r){const a=nh(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:a,range:e.range}})}function np(e,t,r,a){const n=e.replayFilter?aA(e.filter,e.replayFilter()):e.filter;if(e.or){const i={},o=(l,c,A)=>{if(!n||n(c,A,p=>c.stop(p),p=>c.fail(p))){var d=c.primaryKey,f=""+d;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(d)),ai(i,f)||(i[f]=!0,t(l,c,A))}};return Promise.all([e.or._iterate(o,r),$v(Vv(e,a,r),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return $v(Vv(e,a,r),aA(e.algorithm,n),t,!e.keysOnly&&e.valueMapper)}function $v(e,t,r,a){var n=fa(a?(i,o,l)=>r(a(i),o,l):r);return e.then(i=>{if(i)return i.start(()=>{var o=()=>i.continue();t&&!t(i,l=>o=l,l=>{i.stop(l),o=Zr},l=>{i.fail(l),o=Zr})||n(i.value,i,l=>o=l),o()})})}function hs(e,t){try{const r=Yv(e),a=Yv(t);if(r!==a)return r==="Array"?1:a==="Array"?-1:r==="binary"?1:a==="binary"?-1:r==="string"?1:a==="string"?-1:r==="Date"?1:a!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(n,i){const o=n.length,l=i.length,c=o<l?o:l;for(let A=0;A<c;++A)if(n[A]!==i[A])return n[A]<i[A]?-1:1;return o===l?0:o<l?-1:1}(Wv(e),Wv(t));case"Array":return function(n,i){const o=n.length,l=i.length,c=o<l?o:l;for(let A=0;A<c;++A){const d=hs(n[A],i[A]);if(d!==0)return d}return o===l?0:o<l?-1:1}(e,t)}}catch{}return NaN}function Yv(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=rx(e);return r==="ArrayBuffer"?"binary":r}function Wv(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}let II=class{_read(t,r){var a=this._ctx;return a.error?a.table._trans(null,on.bind(null,a.error)):a.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,on.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=aA(r.algorithm,t)}_iterate(t,r){return np(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),a=Object.create(this._ctx);return t&&gs(a,t),r._ctx=a,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(a=>np(r,t,a,r.table.core))}count(t){return this._read(r=>{const a=this._ctx,n=a.table.core;if(KA(a,!0))return n.count({trans:r,query:{index:nh(a,n.schema),range:a.range}}).then(o=>Math.min(o,a.limit));var i=0;return np(a,()=>(++i,!1),r,n).then(()=>i)}).then(t)}sortBy(t,r){const a=t.split(".").reverse(),n=a[0],i=a.length-1;function o(A,d){return d?o(A[a[d]],d-1):A[n]}var l=this._ctx.dir==="next"?1:-1;function c(A,d){var f=o(A,i),p=o(d,i);return f<p?-l:f>p?l:0}return this.toArray(function(A){return A.sort(c)}).then(r)}toArray(t){return this._read(r=>{var a=this._ctx;if(a.dir==="next"&&KA(a,!0)&&a.limit>0){const{valueMapper:n}=a,i=nh(a,a.table.core.schema);return a.table.core.query({trans:r,limit:a.limit,values:!0,query:{index:i,range:a.range}}).then(({result:o})=>n?o.map(n):o)}{const n=[];return np(a,i=>n.push(i),r,a.table.core).then(()=>n)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,KA(r)?Sg(r,()=>{var a=t;return(n,i)=>a===0||(a===1?(--a,!1):(i(()=>{n.advance(a),a=0}),!1))}):Sg(r,()=>{var a=t;return()=>--a<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Sg(this._ctx,()=>{var r=t;return function(a,n,i){return--r<=0&&n(i),r>=0}},!0),this}until(t,r){return Bg(this._ctx,function(a,n,i){return!t(a.value)||(n(i),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,a;return Bg(this._ctx,function(n){return t(n.value)}),r=this._ctx,a=t,r.isMatch=aA(r.isMatch,a),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,n){t(n.key,n)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,n){t(n.primaryKey,n)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var a=[];return this.each(function(n,i){a.push(i.key)}).then(function(){return a}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&KA(r,!0)&&r.limit>0)return this._read(n=>{var i=nh(r,r.table.core.schema);return r.table.core.query({trans:n,values:!1,limit:r.limit,query:{index:i,range:r.range}})}).then(({result:n})=>n).then(t);r.keysOnly=!r.isMatch;var a=[];return this.each(function(n,i){a.push(i.primaryKey)}).then(function(){return a}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var a={};return Bg(this._ctx,function(n){var i=n.primaryKey.toString(),o=ai(a,i);return a[i]=!0,!o}),this}modify(t){var r=this._ctx;return this._write(a=>{var n;if(typeof t=="function")n=t;else{var i=Xa(t),o=i.length;n=function(h){for(var x=!1,y=0;y<o;++y){var v=i[y],E=t[v];Yo(h,v)!==E&&(Ki(h,v,E),x=!0)}return x}}const l=r.table.core,{outbound:c,extractKey:A}=l.schema.primaryKey,d=this.db._options.modifyChunkSize||200,f=[];let p=0;const u=[],g=(h,x)=>{const{failures:y,numFailures:v}=x;p+=h-v;for(let E of Xa(y))f.push(y[E])};return this.clone().primaryKeys().then(h=>{const x=y=>{const v=Math.min(d,h.length-y);return l.getMany({trans:a,keys:h.slice(y,y+v),cache:"immutable"}).then(E=>{const k=[],S=[],B=c?[]:null,b=[];for(let _=0;_<v;++_){const U=E[_],I={value:r0(U),primKey:h[y+_]};n.call(I,I.value,I)!==!1&&(I.value==null?b.push(h[y+_]):c||hs(A(U),A(I.value))===0?(S.push(I.value),c&&B.push(h[y+_])):(b.push(h[y+_]),k.push(I.value)))}const O=KA(r)&&r.limit===1/0&&(typeof t!="function"||t===Tg)&&{index:r.index,range:r.range};return Promise.resolve(k.length>0&&l.mutate({trans:a,type:"add",values:k}).then(_=>{for(let U in _.failures)b.splice(parseInt(U),1);g(k.length,_)})).then(()=>(S.length>0||O&&typeof t=="object")&&l.mutate({trans:a,type:"put",keys:B,values:S,criteria:O,changeSpec:typeof t!="function"&&t}).then(_=>g(S.length,_))).then(()=>(b.length>0||O&&t===Tg)&&l.mutate({trans:a,type:"delete",keys:b,criteria:O}).then(_=>g(b.length,_))).then(()=>h.length>y+v&&x(y+d))})};return x(0).then(()=>{if(f.length>0)throw new yh("Error modifying one or more objects",f,p,u);return h.length})})})}delete(){var t=this._ctx,r=t.range;return KA(t)&&(t.isPrimKey&&!TI||r.type===3)?this._write(a=>{const{primaryKey:n}=t.table.core.schema,i=r;return t.table.core.count({trans:a,query:{index:n,range:i}}).then(o=>t.table.core.mutate({trans:a,type:"deleteRange",range:i}).then(({failures:l,lastResult:c,results:A,numFailures:d})=>{if(d)throw new yh("Could not delete some values",Object.keys(l).map(f=>l[f]),o-d);return o-d}))}):this.modify(Tg)}};const Tg=(e,t)=>t.value=null;function NI(e,t){return e<t?-1:e===t?0:1}function FI(e,t){return e>t?-1:e===t?0:1}function Hs(e,t,r){var a=e instanceof h_?new e.Collection(e):e;return a._ctx.error=r?new r(t):new TypeError(t),a}function HA(e){return new e.Collection(e,()=>p_("")).limit(0)}function RI(e,t,r,a,n,i){for(var o=Math.min(e.length,a.length),l=-1,c=0;c<o;++c){var A=t[c];if(A!==a[c])return n(e[c],r[c])<0?e.substr(0,c)+r[c]+r.substr(c+1):n(e[c],a[c])<0?e.substr(0,c)+a[c]+r.substr(c+1):l>=0?e.substr(0,l)+t[l]+r.substr(l+1):null;n(e[c],A)<0&&(l=c)}return o<a.length&&i==="next"?e+r.substr(e.length):o<e.length&&i==="prev"?e.substr(0,r.length):l<0?null:e.substr(0,l)+a[l]+r.substr(l+1)}function sp(e,t,r,a){var n,i,o,l,c,A,d,f=r.length;if(!r.every(h=>typeof h=="string"))return Hs(e,d_);function p(h){n=function(y){return y==="next"?v=>v.toUpperCase():v=>v.toLowerCase()}(h),i=function(y){return y==="next"?v=>v.toLowerCase():v=>v.toUpperCase()}(h),o=h==="next"?NI:FI;var x=r.map(function(y){return{lower:i(y),upper:n(y)}}).sort(function(y,v){return o(y.lower,v.lower)});l=x.map(function(y){return y.upper}),c=x.map(function(y){return y.lower}),A=h,d=h==="next"?"":a}p("next");var u=new e.Collection(e,()=>Il(l[0],c[f-1]+a));u._ondirectionchange=function(h){p(h)};var g=0;return u._addAlgorithm(function(h,x,y){var v=h.key;if(typeof v!="string")return!1;var E=i(v);if(t(E,c,g))return!0;for(var k=null,S=g;S<f;++S){var B=RI(v,E,l[S],c[S],o,A);B===null&&k===null?g=S+1:(k===null||o(k,B)>0)&&(k=B)}return x(k!==null?function(){h.continue(k+d)}:y),!1}),u}function Il(e,t,r,a){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:a}}function p_(e){return{type:1,lower:e,upper:e}}class h_{get Collection(){return this._ctx.table.db.Collection}between(t,r,a,n){a=a!==!1,n=n===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(a||n)&&(!a||!n)?HA(this):new this.Collection(this,()=>Il(t,r,!a,!n))}catch{return Hs(this,jo)}}equals(t){return t==null?Hs(this,jo):new this.Collection(this,()=>p_(t))}above(t){return t==null?Hs(this,jo):new this.Collection(this,()=>Il(t,void 0,!0))}aboveOrEqual(t){return t==null?Hs(this,jo):new this.Collection(this,()=>Il(t,void 0,!1))}below(t){return t==null?Hs(this,jo):new this.Collection(this,()=>Il(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Hs(this,jo):new this.Collection(this,()=>Il(void 0,t))}startsWith(t){return typeof t!="string"?Hs(this,d_):this.between(t,t+Uc,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):sp(this,(r,a)=>r.indexOf(a[0])===0,[t],Uc)}equalsIgnoreCase(t){return sp(this,(r,a)=>r===a[0],[t],"")}anyOfIgnoreCase(){var t=Ko.apply(dd,arguments);return t.length===0?HA(this):sp(this,(r,a)=>a.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Ko.apply(dd,arguments);return t.length===0?HA(this):sp(this,(r,a)=>a.some(n=>r.indexOf(n)===0),t,Uc)}anyOf(){const t=Ko.apply(dd,arguments);let r=this._cmp;try{t.sort(r)}catch{return Hs(this,jo)}if(t.length===0)return HA(this);const a=new this.Collection(this,()=>Il(t[0],t[t.length-1]));a._ondirectionchange=i=>{r=i==="next"?this._ascending:this._descending,t.sort(r)};let n=0;return a._addAlgorithm((i,o,l)=>{const c=i.key;for(;r(c,t[n])>0;)if(++n,n===t.length)return o(l),!1;return r(c,t[n])===0||(o(()=>{i.continue(t[n])}),!1)}),a}notEqual(t){return this.inAnyRange([[px,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Ko.apply(dd,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Hs(this,jo)}const r=t.reduce((a,n)=>a?a.concat([[a[a.length-1][1],n]]):[[px,n]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const a=this._cmp,n=this._ascending,i=this._descending,o=this._min,l=this._max;if(t.length===0)return HA(this);if(!t.every(v=>v[0]!==void 0&&v[1]!==void 0&&n(v[0],v[1])<=0))return Hs(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Xt.InvalidArgument);const c=!r||r.includeLowers!==!1,A=r&&r.includeUppers===!0;let d,f=n;function p(v,E){return f(v[0],E[0])}try{d=t.reduce(function(v,E){let k=0,S=v.length;for(;k<S;++k){const B=v[k];if(a(E[0],B[1])<0&&a(E[1],B[0])>0){B[0]=o(B[0],E[0]),B[1]=l(B[1],E[1]);break}}return k===S&&v.push(E),v},[]),d.sort(p)}catch{return Hs(this,jo)}let u=0;const g=A?v=>n(v,d[u][1])>0:v=>n(v,d[u][1])>=0,h=c?v=>i(v,d[u][0])>0:v=>i(v,d[u][0])>=0;let x=g;const y=new this.Collection(this,()=>Il(d[0][0],d[d.length-1][1],!c,!A));return y._ondirectionchange=v=>{v==="next"?(x=g,f=n):(x=h,f=i),d.sort(p)},y._addAlgorithm((v,E,k)=>{for(var S=v.key;x(S);)if(++u,u===d.length)return E(k),!1;return!!function(B){return!g(B)&&!h(B)}(S)||(this._cmp(S,d[u][1])===0||this._cmp(S,d[u][0])===0||E(()=>{f===n?v.continue(d[u][0]):v.continue(d[u][1])}),!1)}),y}startsWithAnyOf(){const t=Ko.apply(dd,arguments);return t.every(r=>typeof r=="string")?t.length===0?HA(this):this.inAnyRange(t.map(r=>[r,r+Uc])):Hs(this,"startsWithAnyOf() only works with strings")}}function co(e){return fa(function(t){return If(t),e(t.target.error),!1})}function If(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Nf="storagemutated",Ll="x-storagemutated-1",ac=of(null,Nf);class kI{_lock(){return qu(!qt.global),++this._reculock,this._reculock!==1||qt.global||(qt.lockOwnerFor=this),this}_unlock(){if(qu(!qt.global),--this._reculock==0)for(qt.global||(qt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Vd(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&qt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,a=this.db._state.dbOpenError;if(qu(!this.idbtrans),!t&&!r)switch(a&&a.name){case"DatabaseClosedError":throw new Xt.DatabaseClosed(a);case"MissingAPIError":throw new Xt.MissingAPI(a.message,a);default:throw new Xt.OpenFailed(a)}if(!this.active)throw new Xt.TransactionInactive;return qu(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=fa(n=>{If(n),this._reject(t.error)}),t.onabort=fa(n=>{If(n),this.active&&this._reject(new Xt.Abort(t.error)),this.active=!1,this.on("abort").fire(n)}),t.oncomplete=fa(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&ac.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,a){if(t==="readwrite"&&this.mode!=="readwrite")return on(new Xt.ReadOnly("Transaction is readonly"));if(!this.active)return on(new Xt.TransactionInactive);if(this._locked())return new Nt((i,o)=>{this._blockedFuncs.push([()=>{this._promise(t,r,a).then(i,o)},qt])});if(a)return tc(()=>{var i=new Nt((o,l)=>{this._lock();const c=r(o,l,this);c&&c.then&&c.then(o,l)});return i.finally(()=>this._unlock()),i._lib=!0,i});var n=new Nt((i,o)=>{var l=r(i,o,this);l&&l.then&&l.then(i,o)});return n._lib=!0,n}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const a=Nt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>a);else{r._waitingFor=a,r._waitingQueue=[];var n=r.idbtrans.objectStore(r.storeNames[0]);(function o(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(n.get(-1/0).onsuccess=o)})()}var i=r._waitingFor;return new Nt((o,l)=>{a.then(c=>r._waitingQueue.push(fa(o.bind(null,c))),c=>r._waitingQueue.push(fa(l.bind(null,c)))).finally(()=>{r._waitingFor===i&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Xt.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(ai(r,t))return r[t];const a=this.schema[t];if(!a)throw new Xt.NotFound("Table "+t+" not part of transaction");const n=new this.db.Table(t,a,this);return n.core=this.db.core.table(t),r[t]=n,n}}function hx(e,t,r,a,n,i,o){return{name:e,keyPath:t,unique:r,multi:a,auto:n,compound:i,src:(r&&!o?"&":"")+(a?"*":"")+(n?"++":"")+m_(t)}}function m_(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function g_(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:$b(r,a=>[a.name,a])}}let Ff=e=>{try{return e.only([[]]),Ff=()=>[[]],[[]]}catch{return Ff=()=>Uc,Uc}};function mx(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?a=>a[t]:a=>Yo(a,t)}(e):t=>Yo(t,e)}function Xv(e){return[].slice.call(e)}let DI=0;function lf(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function jI(e,t,r){function a(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:A,upper:d,lowerOpen:f,upperOpen:p}=c;return A===void 0?d===void 0?null:t.upperBound(d,!!p):d===void 0?t.lowerBound(A,!!f):t.bound(A,d,!!f,!!p)}const{schema:n,hasGetAll:i}=function(c,A){const d=Xv(c.objectStoreNames);return{schema:{name:c.name,tables:d.map(f=>A.objectStore(f)).map(f=>{const{keyPath:p,autoIncrement:u}=f,g=Xn(p),h=p==null,x={},y={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:g,keyPath:p,autoIncrement:u,unique:!0,extractKey:mx(p)},indexes:Xv(f.indexNames).map(v=>f.index(v)).map(v=>{const{name:E,unique:k,multiEntry:S,keyPath:B}=v,b={name:E,compound:Xn(B),keyPath:B,unique:k,multiEntry:S,extractKey:mx(B)};return x[lf(B)]=b,b}),getIndexByKeyPath:v=>x[lf(v)]};return x[":id"]=y.primaryKey,p!=null&&(x[lf(p)]=y.primaryKey),y})},hasGetAll:d.length>0&&"getAll"in A.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),o=n.tables.map(c=>function(A){const d=A.name;return{name:d,schema:A,mutate:function({trans:f,type:p,keys:u,values:g,range:h}){return new Promise((x,y)=>{x=fa(x);const v=f.objectStore(d),E=v.keyPath==null,k=p==="put"||p==="add";if(!k&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:S}=u||g||{length:1};if(u&&g&&u.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(S===0)return x({numFailures:0,failures:{},results:[],lastResult:void 0});let B;const b=[],O=[];let _=0;const U=R=>{++_,If(R)};if(p==="deleteRange"){if(h.type===4)return x({numFailures:_,failures:O,results:[],lastResult:void 0});h.type===3?b.push(B=v.clear()):b.push(B=v.delete(a(h)))}else{const[R,L]=k?E?[g,u]:[g,null]:[u,null];if(k)for(let N=0;N<S;++N)b.push(B=L&&L[N]!==void 0?v[p](R[N],L[N]):v[p](R[N])),B.onerror=U;else for(let N=0;N<S;++N)b.push(B=v[p](R[N])),B.onerror=U}const I=R=>{const L=R.target.result;b.forEach((N,P)=>N.error!=null&&(O[P]=N.error)),x({numFailures:_,failures:O,results:p==="delete"?u:b.map(N=>N.result),lastResult:L})};B.onerror=R=>{U(R),I(R)},B.onsuccess=I})},getMany:({trans:f,keys:p})=>new Promise((u,g)=>{u=fa(u);const h=f.objectStore(d),x=p.length,y=new Array(x);let v,E=0,k=0;const S=b=>{const O=b.target;y[O._pos]=O.result,++k===E&&u(y)},B=co(g);for(let b=0;b<x;++b)p[b]!=null&&(v=h.get(p[b]),v._pos=b,v.onsuccess=S,v.onerror=B,++E);E===0&&u(y)}),get:({trans:f,key:p})=>new Promise((u,g)=>{u=fa(u);const h=f.objectStore(d).get(p);h.onsuccess=x=>u(x.target.result),h.onerror=co(g)}),query:function(f){return p=>new Promise((u,g)=>{u=fa(u);const{trans:h,values:x,limit:y,query:v}=p,E=y===1/0?void 0:y,{index:k,range:S}=v,B=h.objectStore(d),b=k.isPrimaryKey?B:B.index(k.name),O=a(S);if(y===0)return u({result:[]});if(f){const _=x?b.getAll(O,E):b.getAllKeys(O,E);_.onsuccess=U=>u({result:U.target.result}),_.onerror=co(g)}else{let _=0;const U=x||!("openKeyCursor"in b)?b.openCursor(O):b.openKeyCursor(O),I=[];U.onsuccess=R=>{const L=U.result;return L?(I.push(x?L.value:L.primaryKey),++_===y?u({result:I}):void L.continue()):u({result:I})},U.onerror=co(g)}})}(i),openCursor:function({trans:f,values:p,query:u,reverse:g,unique:h}){return new Promise((x,y)=>{x=fa(x);const{index:v,range:E}=u,k=f.objectStore(d),S=v.isPrimaryKey?k:k.index(v.name),B=g?h?"prevunique":"prev":h?"nextunique":"next",b=p||!("openKeyCursor"in S)?S.openCursor(a(E),B):S.openKeyCursor(a(E),B);b.onerror=co(y),b.onsuccess=fa(O=>{const _=b.result;if(!_)return void x(null);_.___id=++DI,_.done=!1;const U=_.continue.bind(_);let I=_.continuePrimaryKey;I&&(I=I.bind(_));const R=_.advance.bind(_),L=()=>{throw new Error("Cursor not stopped")};_.trans=f,_.stop=_.continue=_.continuePrimaryKey=_.advance=()=>{throw new Error("Cursor not started")},_.fail=fa(y),_.next=function(){let N=1;return this.start(()=>N--?this.continue():this.stop()).then(()=>this)},_.start=N=>{const P=new Promise((Y,ee)=>{Y=fa(Y),b.onerror=co(ee),_.fail=ee,_.stop=V=>{_.stop=_.continue=_.continuePrimaryKey=_.advance=L,Y(V)}}),Q=()=>{if(b.result)try{N()}catch(Y){_.fail(Y)}else _.done=!0,_.start=()=>{throw new Error("Cursor behind last entry")},_.stop()};return b.onsuccess=fa(Y=>{b.onsuccess=Q,Q()}),_.continue=U,_.continuePrimaryKey=I,_.advance=R,Q(),P},x(_)},y)})},count({query:f,trans:p}){const{index:u,range:g}=f;return new Promise((h,x)=>{const y=p.objectStore(d),v=u.isPrimaryKey?y:y.index(u.name),E=a(g),k=E?v.count(E):v.count();k.onsuccess=fa(S=>h(S.target.result)),k.onerror=co(x)})}}}(c)),l={};return o.forEach(c=>l[c.name]=c),{stack:"dbcore",transaction:e.transaction.bind(e),table(c){if(!l[c])throw new Error(`Table '${c}' not found`);return l[c]},MIN_KEY:-1/0,MAX_KEY:Ff(t),schema:n}}function gx({_novip:e},t){const r=t.db,a=function(n,i,{IDBKeyRange:o,indexedDB:l},c){return{dbcore:function(d,f){return f.reduce((p,{create:u})=>({...p,...u(p)}),d)}(jI(i,o,c),n.dbcore)}}(e._middlewares,r,e._deps,t);e.core=a.dbcore,e.tables.forEach(n=>{const i=n.name;e.core.schema.tables.some(o=>o.name===i)&&(n.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=n.core))})}function _h({_novip:e},t,r,a){r.forEach(n=>{const i=a[n];t.forEach(o=>{const l=T2(o,n);(!l||"value"in l&&l.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?$o(o,n,{get(){return this.table(n)},set(c){Gb(this,n,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):o[n]=new e.Table(n,i))})})}function xx({_novip:e},t){t.forEach(r=>{for(let a in r)r[a]instanceof e.Table&&delete r[a]})}function LI(e,t){return e._cfg.version-t._cfg.version}function UI(e,t,r,a){const n=e._dbSchema,i=e._createTransaction("readwrite",e._storeNames,n);i.create(r),i._completion.catch(a);const o=i._reject.bind(i),l=qt.transless||qt;tc(()=>{qt.trans=i,qt.transless=l,t===0?(Xa(n).forEach(c=>{Og(r,c,n[c].primKey,n[c].indexes)}),gx(e,r),Nt.follow(()=>e.on.populate.fire(i)).catch(o)):function({_novip:c},A,d,f){const p=[],u=c._versions;let g=c._dbSchema=vx(c,c.idbdb,f),h=!1;const x=u.filter(v=>v._cfg.version>=A);function y(){return p.length?Nt.resolve(p.shift()(d.idbtrans)).then(y):Nt.resolve()}return x.forEach(v=>{p.push(()=>{const E=g,k=v._cfg.dbschema;wx(c,E,f),wx(c,k,f),g=c._dbSchema=k;const S=x_(E,k);S.add.forEach(b=>{Og(f,b[0],b[1].primKey,b[1].indexes)}),S.change.forEach(b=>{if(b.recreate)throw new Xt.Upgrade("Not yet support for changing primary key");{const O=f.objectStore(b.name);b.add.forEach(_=>yx(O,_)),b.change.forEach(_=>{O.deleteIndex(_.name),yx(O,_)}),b.del.forEach(_=>O.deleteIndex(_))}});const B=v._cfg.contentUpgrade;if(B&&v._cfg.version>A){gx(c,f),d._memoizedTables={},h=!0;let b=Yb(k);S.del.forEach(I=>{b[I]=E[I]}),xx(c,[c.Transaction.prototype]),_h(c,[c.Transaction.prototype],Xa(b),b),d.schema=b;const O=O2(B);let _;O&&zd();const U=Nt.follow(()=>{if(_=B(d),_&&O){var I=rl.bind(null,null);_.then(I,I)}});return _&&typeof _.then=="function"?Nt.resolve(_):U.then(()=>_)}}),p.push(E=>{(!h||!SI)&&function(k,S){[].slice.call(S.db.objectStoreNames).forEach(B=>k[B]==null&&S.db.deleteObjectStore(B))}(v._cfg.dbschema,E),xx(c,[c.Transaction.prototype]),_h(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),d.schema=c._dbSchema})}),y().then(()=>{var v,E;E=f,Xa(v=g).forEach(k=>{E.db.objectStoreNames.contains(k)||Og(E,k,v[k].primKey,v[k].indexes)})})}(e,t,i,r).catch(o)})}function x_(e,t){const r={del:[],add:[],change:[]};let a;for(a in e)t[a]||r.del.push(a);for(a in t){const n=e[a],i=t[a];if(n){const o={name:a,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(n.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||n.primKey.auto!==i.primKey.auto&&!hm)o.recreate=!0,r.change.push(o);else{const l=n.idxByName,c=i.idxByName;let A;for(A in l)c[A]||o.del.push(A);for(A in c){const d=l[A],f=c[A];d?d.src!==f.src&&o.change.push(f):o.add.push(f)}(o.del.length>0||o.add.length>0||o.change.length>0)&&r.change.push(o)}}else r.add.push([a,i])}return r}function Og(e,t,r,a){const n=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return a.forEach(i=>yx(n,i)),n}function yx(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function vx(e,t,r){const a={};return xh(t.objectStoreNames,0).forEach(n=>{const i=r.objectStore(n);let o=i.keyPath;const l=hx(m_(o),o||"",!1,!1,!!i.autoIncrement,o&&typeof o!="string",!0),c=[];for(let d=0;d<i.indexNames.length;++d){const f=i.index(i.indexNames[d]);o=f.keyPath;var A=hx(f.name,o,!!f.unique,!!f.multiEntry,!1,o&&typeof o!="string",!1);c.push(A)}a[n]=g_(n,l,c)}),a}function wx({_novip:e},t,r){const a=r.db.objectStoreNames;for(let n=0;n<a.length;++n){const i=a[n],o=r.objectStore(i);e._hasGetAll="getAll"in o;for(let l=0;l<o.indexNames.length;++l){const c=o.indexNames[l],A=o.index(c).keyPath,d=typeof A=="string"?A:"["+xh(A).join("+")+"]";if(t[i]){const f=t[i].idxByName[d];f&&(f.name=c,delete t[i].idxByName[d],t[i].idxByName[c]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ia.WorkerGlobalScope&&ia instanceof ia.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class MI{_parseStoresSpec(t,r){Xa(t).forEach(a=>{if(t[a]!==null){var n=t[a].split(",").map((o,l)=>{const c=(o=o.trim()).replace(/([&*]|\+\+)/g,""),A=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return hx(c,A||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),Xn(A),l===0)}),i=n.shift();if(i.multi)throw new Xt.Schema("Primary key cannot be multi-valued");n.forEach(o=>{if(o.auto)throw new Xt.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new Xt.Schema("Index must have a name and cannot be an empty string")}),r[a]=g_(a,i,n)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?gs(this._cfg.storesSource,t):t;const a=r._versions,n={};let i={};return a.forEach(o=>{gs(n,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(n,i)}),r._dbSchema=i,xx(r,[r._allTables,r,r.Transaction.prototype]),_h(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Xa(i),i),r._storeNames=Xa(i),this}upgrade(t){return this._cfg.contentUpgrade=F2(this._cfg.contentUpgrade||Zr,t),this}}function j2(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new zc(mm,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function L2(e){return e&&typeof e.databases=="function"}function Ex(e){return tc(function(){return qt.letThrough=!0,e()})}function PI(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function QI(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?on(t.dbOpenError):e);yo&&(t.openCanceller._stackHolder=uA()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const a=t.openCanceller;function n(){if(t.openCanceller!==a)throw new Xt.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,o=null,l=!1;const c=()=>new Nt((A,d)=>{if(n(),!r)throw new Xt.MissingAPI;const f=e.name,p=t.autoSchema?r.open(f):r.open(f,Math.round(10*e.verno));if(!p)throw new Xt.MissingAPI;p.onerror=co(d),p.onblocked=fa(e._fireOnBlocked),p.onupgradeneeded=fa(u=>{if(o=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=If,o.abort(),p.result.close();const h=r.deleteDatabase(f);h.onsuccess=h.onerror=fa(()=>{d(new Xt.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{o.onerror=co(d);var g=u.oldVersion>Math.pow(2,62)?0:u.oldVersion;l=g<1,e._novip.idbdb=p.result,UI(e,g/10,o,d)}},d),p.onsuccess=fa(()=>{o=null;const u=e._novip.idbdb=p.result,g=xh(u.objectStoreNames);if(g.length>0)try{const x=u.transaction((h=g).length===1?h[0]:h,"readonly");t.autoSchema?function({_novip:y},v,E){y.verno=v.version/10;const k=y._dbSchema=vx(0,v,E);y._storeNames=xh(v.objectStoreNames,0),_h(y,[y._allTables],Xa(k),k)}(e,u,x):(wx(e,e._dbSchema,x),function(y,v){const E=x_(vx(0,y.idbdb,v),y._dbSchema);return!(E.add.length||E.change.some(k=>k.add.length||k.change.length))}(e,x)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),gx(e,x)}catch{}var h;sf.push(e),u.onversionchange=fa(x=>{t.vcFired=!0,e.on("versionchange").fire(x)}),u.onclose=fa(x=>{e.on("close").fire(x)}),l&&function({indexedDB:x,IDBKeyRange:y},v){!L2(x)&&v!==mm&&j2(x,y).put({name:v}).catch(Zr)}(e._deps,f),A()},d)}).catch(A=>A&&A.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):Nt.reject(A));return Nt.race([a,(typeof navigator>"u"?Nt.resolve():PI()).then(c)]).then(()=>(n(),t.onReadyBeingFired=[],Nt.resolve(Ex(()=>e.on.ready.fire(e.vip))).then(function A(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(F2,Zr);return t.onReadyBeingFired=[],Nt.resolve(Ex(()=>d(e.vip))).then(A)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(A=>{t.dbOpenError=A;try{o&&o.abort()}catch{}return a===t.openCanceller&&e._close(),on(A)}).finally(()=>{t.openComplete=!0,i()})}function bx(e){var t=i=>e.next(i),r=n(t),a=n(i=>e.throw(i));function n(i){return o=>{var l=i(o),c=l.value;return l.done?c:c&&typeof c.then=="function"?c.then(r,a):Xn(c)?Promise.all(c).then(r,a):r(c)}}return n(t)()}function qI(e,t,r){var a=arguments.length;if(a<2)throw new Xt.InvalidArgument("Too few arguments");for(var n=new Array(a-1);--a;)n[a-1]=arguments[a];return r=n.pop(),[e,Wb(n),r]}function y_(e,t,r,a,n){return Nt.resolve().then(()=>{const i=qt.transless||qt,o=e._createTransaction(t,r,e._dbSchema,a),l={trans:o,transless:i};if(a)o.idbtrans=a.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===N2.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>y_(e,t,r,null,n))):on(f)}const c=O2(n);let A;c&&zd();const d=Nt.follow(()=>{if(A=n.call(o,o),A)if(c){var f=rl.bind(null,null);A.then(f,f)}else typeof A.next=="function"&&typeof A.throw=="function"&&(A=bx(A))},l);return(A&&typeof A.then=="function"?Nt.resolve(A).then(f=>o.active?f:on(new Xt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>A)).then(f=>(a&&o._resolve(),o._completion.then(()=>f))).catch(f=>(o._reject(f),on(f)))})}function ip(e,t,r){const a=Xn(e)?e.slice():[e];for(let n=0;n<r;++n)a.push(t);return a}const KI={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:a}=r,n={},i=[];function o(d,f,p){const u=lf(d),g=n[u]=n[u]||[],h=d==null?0:typeof d=="string"?1:d.length,x=f>0,y={...p,isVirtual:x,keyTail:f,keyLength:h,extractKey:mx(d),unique:!x&&p.unique};return g.push(y),y.isPrimaryKey||i.push(y),h>1&&o(h===2?d[0]:d.slice(0,h-1),f+1,p),g.sort((v,E)=>v.keyTail-E.keyTail),y}const l=o(a.primaryKey.keyPath,0,a.primaryKey);n[":id"]=[l];for(const d of a.indexes)o(d.keyPath,0,d);function c(d){const f=d.query.index;return f.isVirtual?{...d,query:{index:f,range:(p=d.query.range,u=f.keyTail,{type:p.type===1?2:p.type,lower:ip(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,u),lowerOpen:!0,upper:ip(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,u),upperOpen:!0})}}:d;var p,u}return{...r,schema:{...a,primaryKey:l,indexes:i,getIndexByKeyPath:function(d){const f=n[lf(d)];return f&&f[0]}},count:d=>r.count(c(d)),query:d=>r.query(c(d)),openCursor(d){const{keyTail:f,isVirtual:p,keyLength:u}=d.query.index;return p?r.openCursor(c(d)).then(g=>g&&function(h){return Object.create(h,{continue:{value:function(y){y!=null?h.continue(ip(y,d.reverse?e.MAX_KEY:e.MIN_KEY,f)):d.unique?h.continue(h.key.slice(0,u).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,f)):h.continue()}},continuePrimaryKey:{value(y,v){h.continuePrimaryKey(ip(y,e.MAX_KEY,f),v)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const y=h.key;return u===1?y[0]:y.slice(0,u)}},value:{get:()=>h.value}})}(g)):r.openCursor(d)}}}}}};function U2(e,t,r,a){return r=r||{},a=a||"",Xa(e).forEach(n=>{if(ai(t,n)){var i=e[n],o=t[n];if(typeof i=="object"&&typeof o=="object"&&i&&o){const l=rx(i);l!==rx(o)?r[a+n]=t[n]:l==="Object"?U2(i,o,r,a+n+"."):i!==o&&(r[a+n]=t[n])}else i!==o&&(r[a+n]=t[n])}else r[a+n]=void 0}),Xa(t).forEach(n=>{ai(e,n)||(r[a+n]=t[n])}),r}const HI={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:a}=r.schema;return{...r,mutate(i){const o=qt.trans,{deleting:l,creating:c,updating:A}=o.table(t).hook;switch(i.type){case"add":if(c.fire===Zr)break;return o._promise("readwrite",()=>d(i),!0);case"put":if(c.fire===Zr&&A.fire===Zr)break;return o._promise("readwrite",()=>d(i),!0);case"delete":if(l.fire===Zr)break;return o._promise("readwrite",()=>d(i),!0);case"deleteRange":if(l.fire===Zr)break;return o._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(i),!0)}return r.mutate(i);function d(p){const u=qt.trans,g=p.keys||function(h,x){return x.type==="delete"?x.keys:x.keys||x.values.map(h.extractKey)}(a,p);if(!g)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:g}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(h,x,y){return x.type==="add"?Promise.resolve([]):h.getMany({trans:x.trans,keys:y,cache:"immutable"})}(r,p,g).then(h=>{const x=g.map((y,v)=>{const E=h[v],k={onerror:null,onsuccess:null};if(p.type==="delete")l.fire.call(k,y,E,u);else if(p.type==="add"||E===void 0){const S=c.fire.call(k,y,p.values[v],u);y==null&&S!=null&&(y=S,p.keys[v]=y,a.outbound||Ki(p.values[v],a.keyPath,y))}else{const S=U2(E,p.values[v]),B=A.fire.call(k,S,y,E,u);if(B){const b=p.values[v];Object.keys(B).forEach(O=>{ai(b,O)?b[O]=B[O]:Ki(b,O,B[O])})}}return k});return r.mutate(p).then(({failures:y,results:v,numFailures:E,lastResult:k})=>{for(let S=0;S<g.length;++S){const B=v?v[S]:g[S],b=x[S];B==null?b.onerror&&b.onerror(y[S]):b.onsuccess&&b.onsuccess(p.type==="put"&&h[S]?p.values[S]:B)}return{failures:y,results:v,numFailures:E,lastResult:k}}).catch(y=>(x.forEach(v=>v.onerror&&v.onerror(y)),Promise.reject(y)))})}function f(p,u,g){return r.query({trans:p,values:!1,query:{index:a,range:u},limit:g}).then(({result:h})=>d({type:"delete",keys:h,trans:p}).then(x=>x.numFailures>0?Promise.reject(x.failures[0]):h.length<g?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...u,lower:h[h.length-1],lowerOpen:!0},g)))}}}}})};function v_(e,t,r){try{if(!t||t.keys.length<e.length)return null;const a=[];for(let n=0,i=0;n<t.keys.length&&i<e.length;++n)hs(t.keys[n],e[i])===0&&(a.push(r?r0(t.values[n]):t.values[n]),++i);return a.length===e.length?a:null}catch{return null}}const GI={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:a=>{if(!a.cache)return r.getMany(a);const n=v_(a.keys,a.trans._cache,a.cache==="clone");return n?Nt.resolve(n):r.getMany(a).then(i=>(a.trans._cache={keys:a.keys,values:a.cache==="clone"?r0(i):i},i))},mutate:a=>(a.type!=="add"&&(a.trans._cache=null),r.mutate(a))}}})};function M2(e){return!("from"in e)}const qo=function(e,t){if(!this){const r=new qo;return e&&"d"in e&&gs(r,e),r}gs(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Rf(e,t,r){const a=hs(t,r);if(isNaN(a))return;if(a>0)throw RangeError();if(M2(e))return gs(e,{from:t,to:r,d:1});const n=e.l,i=e.r;if(hs(r,e.from)<0)return n?Rf(n,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Jv(e);if(hs(t,e.to)>0)return i?Rf(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Jv(e);hs(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),hs(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const o=!e.r;n&&!e.l&&Ch(e,n),i&&o&&Ch(e,i)}function Ch(e,t){M2(t)||function r(a,{from:n,to:i,l:o,r:l}){Rf(a,n,i),o&&r(a,o),l&&r(a,l)}(e,t)}function zI(e,t){const r=_x(t);let a=r.next();if(a.done)return!1;let n=a.value;const i=_x(e);let o=i.next(n.from),l=o.value;for(;!a.done&&!o.done;){if(hs(l.from,n.to)<=0&&hs(l.to,n.from)>=0)return!0;hs(n.from,l.from)<0?n=(a=r.next(l.from)).value:l=(o=i.next(n.from)).value}return!1}function _x(e){let t=M2(e)?null:{s:0,n:e};return{next(r){const a=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,a)for(;t.n.l&&hs(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!a||hs(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Jv(e){var t,r;const a=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),n=a>1?"r":a<-1?"l":"";if(n){const i=n==="r"?"l":"r",o={...e},l=e[n];e.from=l.from,e.to=l.to,e[n]=l[n],o[n]=l[i],e[i]=o,o.d=Zv(o)}e.d=Zv(e)}function Zv({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Pd(qo.prototype,{add(e){return Ch(this,e),this},addKey(e){return Rf(this,e,e),this},addKeys(e){return e.forEach(t=>Rf(this,t,t)),this},[ax](){return _x(this)}});const VI={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new qo(e.MIN_KEY,e.MAX_KEY);return{...e,table:a=>{const n=e.table(a),{schema:i}=n,{primaryKey:o}=i,{extractKey:l,outbound:c}=o,A={...n,mutate:p=>{const u=p.trans,g=u.mutatedParts||(u.mutatedParts={}),h=B=>{const b=`idb://${t}/${a}/${B}`;return g[b]||(g[b]=new qo)},x=h(""),y=h(":dels"),{type:v}=p;let[E,k]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const S=p.trans._cache;return n.mutate(p).then(B=>{if(Xn(E)){v!=="delete"&&(E=B.results),x.addKeys(E);const b=v_(E,S);b||v==="add"||y.addKeys(E),(b||k)&&function(O,_,U,I){function R(L){const N=O(L.name||"");function P(Y){return Y!=null?L.extractKey(Y):null}const Q=Y=>L.multiEntry&&Xn(Y)?Y.forEach(ee=>N.addKey(ee)):N.addKey(Y);(U||I).forEach((Y,ee)=>{const V=U&&P(U[ee]),G=I&&P(I[ee]);hs(V,G)!==0&&(V!=null&&Q(V),G!=null&&Q(G))})}_.indexes.forEach(R)}(h,i,b,k)}else if(E){const b={from:E.lower,to:E.upper};y.add(b),x.add(b)}else x.add(r),y.add(r),i.indexes.forEach(b=>h(b.name).add(r));return B})}},d=({query:{index:p,range:u}})=>{var g,h;return[p,new qo((g=u.lower)!==null&&g!==void 0?g:e.MIN_KEY,(h=u.upper)!==null&&h!==void 0?h:e.MAX_KEY)]},f={get:p=>[o,new qo(p.key)],getMany:p=>[o,new qo().addKeys(p.keys)],count:d,query:d,openCursor:d};return Xa(f).forEach(p=>{A[p]=function(u){const{subscr:g}=qt;if(g){const h=k=>{const S=`idb://${t}/${a}/${k}`;return g[S]||(g[S]=new qo)},x=h(""),y=h(":dels"),[v,E]=f[p](u);if(h(v.name||"").add(E),!v.isPrimaryKey){if(p!=="count"){const k=p==="query"&&c&&u.values&&n.query({...u,values:!1});return n[p].apply(this,arguments).then(S=>{if(p==="query"){if(c&&u.values)return k.then(({result:b})=>(x.addKeys(b),S));const B=u.values?S.result.map(l):S.result;u.values?x.addKeys(B):y.addKeys(B)}else if(p==="openCursor"){const B=S,b=u.values;return B&&Object.create(B,{key:{get:()=>(y.addKey(B.primaryKey),B.key)},primaryKey:{get(){const O=B.primaryKey;return y.addKey(O),O}},value:{get:()=>(b&&x.addKey(B.primaryKey),B.value)}})}return S})}y.add(r)}}return n[p].apply(this,arguments)}}),A}}}};class zc{constructor(t,r){this._middlewares={},this.verno=0;const a=zc.dependencies;this._options=r={addons:zc.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:n}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Zr,dbReadyPromise:null,cancelOpen:Zr,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new Nt(l=>{i.dbReadyResolve=l}),i.openCanceller=new Nt((l,c)=>{i.cancelOpen=c}),this._state=i,this.name=t,this.on=of(this,"populate","blocked","versionchange","close",{ready:[F2,Zr]}),this.on.ready.subscribe=zb(this.on.ready.subscribe,l=>(c,A)=>{zc.vip(()=>{const d=this._state;if(d.openComplete)d.dbOpenError||Nt.resolve().then(c),A&&l(c);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(c),A&&l(c);else{l(c);const f=this;A||l(function p(){f.on.ready.unsubscribe(c),f.on.ready.unsubscribe(p)})}})}),this.Collection=(o=this,Su(II.prototype,function(l,c){this.db=o;let A=f_,d=null;if(c)try{A=c()}catch(g){d=g}const f=l._ctx,p=f.table,u=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:A,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:f.or,valueMapper:u!==Tf?u:null}})),this.Table=function(l){return Su(OI.prototype,function(c,A,d){this.db=l,this._tx=d,this.name=c,this.schema=A,this.hook=l._allTables[c]?l._allTables[c].hook:of(null,{creating:[gI,Zr],reading:[mI,Tf],updating:[yI,Zr],deleting:[xI,Zr]})})}(this),this.Transaction=function(l){return Su(kI.prototype,function(c,A,d,f,p){this.db=l,this.mode=c,this.storeNames=A,this.schema=d,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=of(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Nt((u,g)=>{this._resolve=u,this._reject=g}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},u=>{var g=this.active;return this.active=!1,this.on.error.fire(u),this.parent?this.parent._reject(u):g&&this.idbtrans&&this.idbtrans.abort(),on(u)})})}(this),this.Version=function(l){return Su(MI.prototype,function(c){this.db=l,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(l){return Su(h_.prototype,function(c,A,d){this.db=l,this._ctx={table:c,index:A===":id"?null:A,or:d};const f=l._deps.indexedDB;if(!f)throw new Xt.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,u)=>f.cmp(u,p),this._max=(p,u)=>f.cmp(p,u)>0?p:u,this._min=(p,u)=>f.cmp(p,u)<0?p:u,this._IDBKeyRange=l._deps.IDBKeyRange})}(this),this.on("versionchange",l=>{l.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",l=>{!l.newVersion||l.newVersion<l.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${l.oldVersion/10}`)}),this._maxKey=Ff(r.IDBKeyRange),this._createTransaction=(l,c,A,d)=>new this.Transaction(l,c,A,this._options.chromeTransactionDurability,d),this._fireOnBlocked=l=>{this.on("blocked").fire(l),sf.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(l))},this.use(KI),this.use(HI),this.use(VI),this.use(GI),this.vip=Object.create(this,{_vip:{value:!0}}),n.forEach(l=>l(this))}version(t){if(isNaN(t)||t<.1)throw new Xt.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Xt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var a=r.filter(n=>n._cfg.version===t)[0];return a||(a=new this.Version(t),r.push(a),r.sort(LI),a.stores({}),this._state.autoSchema=!1,a)}_whenReady(t){return this.idbdb&&(this._state.openComplete||qt.letThrough||this._vip)?t():new Nt((r,a)=>{if(this._state.openComplete)return a(new Xt.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void a(new Xt.DatabaseClosed);this.open().catch(Zr)}this._state.dbReadyPromise.then(r,a)}).then(t)}use({stack:t,create:r,level:a,name:n}){n&&this.unuse({stack:t,name:n});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:r,level:a??10,name:n}),i.sort((o,l)=>o.level-l.level),this}unuse({stack:t,name:r,create:a}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(n=>a?n.create!==a:!!r&&n.name!==r)),this}open(){return QI(this)}_close(){const t=this._state,r=sf.indexOf(this);if(r>=0&&sf.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new Nt(a=>{t.dbReadyResolve=a}),t.openCanceller=new Nt((a,n)=>{t.cancelOpen=n})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Xt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new Nt((a,n)=>{const i=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=fa(()=>{(function({indexedDB:l,IDBKeyRange:c},A){!L2(l)&&A!==mm&&j2(l,c).delete(A).catch(Zr)})(this._deps,this.name),a()}),o.onerror=co(n),o.onblocked=this._fireOnBlocked};if(t)throw new Xt.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Xa(this._allTables).map(t=>this._allTables[t])}transaction(){const t=qI.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,a){let n=qt.trans;n&&n.db===this&&t.indexOf("!")===-1||(n=null);const i=t.indexOf("?")!==-1;let o,l;t=t.replace("!","").replace("?","");try{if(l=r.map(A=>{var d=A instanceof this.Table?A.name:A;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),t=="r"||t===_g)o=_g;else{if(t!="rw"&&t!=Cg)throw new Xt.InvalidArgument("Invalid transaction mode: "+t);o=Cg}if(n){if(n.mode===_g&&o===Cg){if(!i)throw new Xt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");n=null}n&&l.forEach(A=>{if(n&&n.storeNames.indexOf(A)===-1){if(!i)throw new Xt.SubTransaction("Table "+A+" not included in parent transaction.");n=null}}),i&&n&&!n.active&&(n=null)}}catch(A){return n?n._promise(null,(d,f)=>{f(A)}):on(A)}const c=y_.bind(null,this,o,l,n,a);return n?n._promise(o,c,"lock"):qt.trans?Vd(qt.transless,()=>this._whenReady(c)):this._whenReady(c)}table(t){if(!ai(this._allTables,t))throw new Xt.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const $I=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class YI{constructor(t){this._subscribe=t}subscribe(t,r,a){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:a})}[$I](){return this}}function w_(e,t){return Xa(t).forEach(r=>{Ch(e[r]||(e[r]=new qo),t[r])}),e}function WI(e){let t,r=!1;const a=new YI(n=>{const i=O2(e);let o=!1,l={},c={};const A={get closed(){return o},unsubscribe:()=>{o=!0,ac.storagemutated.unsubscribe(u)}};n.start&&n.start(A);let d=!1,f=!1;function p(){return Xa(c).some(h=>l[h]&&zI(l[h],c[h]))}const u=h=>{w_(l,h),p()&&g()},g=()=>{if(d||o)return;l={};const h={},x=function(y){i&&zd();const v=()=>tc(e,{subscr:y,trans:null}),E=qt.trans?Vd(qt.transless,v):v();return i&&E.then(rl,rl),E}(h);f||(ac(Nf,u),f=!0),d=!0,Promise.resolve(x).then(y=>{r=!0,t=y,d=!1,o||(p()?g():(l={},c=h,n.next&&n.next(y)))},y=>{d=!1,r=!1,n.error&&n.error(y),A.unsubscribe()})};return g(),A});return a.hasValue=()=>r,a.getValue=()=>t,a}let Cx;try{Cx={indexedDB:ia.indexedDB||ia.mozIndexedDB||ia.webkitIndexedDB||ia.msIndexedDB,IDBKeyRange:ia.IDBKeyRange||ia.webkitIDBKeyRange}}catch{Cx={indexedDB:null,IDBKeyRange:null}}const Sc=zc;function sh(e){let t=Go;try{Go=!0,ac.storagemutated.fire(e)}finally{Go=t}}Pd(Sc,{...Zp,delete:e=>new Sc(e,{addons:[]}).delete(),exists:e=>new Sc(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return L2(t)?Promise.resolve(t.databases()).then(a=>a.map(n=>n.name).filter(n=>n!==mm)):j2(t,r).toCollection().primaryKeys()}(Sc.dependencies).then(e)}catch{return on(new Xt.MissingAPI)}},defineClass:()=>function(e){gs(this,e)},ignoreTransaction:e=>qt.trans?Vd(qt.transless,e):e(),vip:Ex,async:function(e){return function(){try{var t=bx(e.apply(this,arguments));return t&&typeof t.then=="function"?t:Nt.resolve(t)}catch(r){return on(r)}}},spawn:function(e,t,r){try{var a=bx(e.apply(r,t||[]));return a&&typeof a.then=="function"?a:Nt.resolve(a)}catch(n){return on(n)}},currentTransaction:{get:()=>qt.trans||null},waitFor:function(e,t){const r=Nt.resolve(typeof e=="function"?Sc.ignoreTransaction(e):e).timeout(t||6e4);return qt.trans?qt.trans.waitFor(r):r},Promise:Nt,debug:{get:()=>yo,set:e=>{Jb(e,e==="dexie"?()=>!0:u_)}},derive:_d,extend:gs,props:Pd,override:zb,Events:of,on:ac,liveQuery:WI,extendObservabilitySet:w_,getByKeyPath:Yo,setByKeyPath:Ki,delByKeyPath:function(e,t){typeof t=="string"?Ki(e,t,void 0):"length"in t&&[].map.call(t,function(r){Ki(e,r,void 0)})},shallowClone:Yb,deepClone:r0,getObjectDiff:U2,cmp:hs,asap:Vb,minKey:px,addons:[],connections:sf,errnames:N2,dependencies:Cx,semVer:zv,version:zv.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),Sc.maxKey=Ff(Sc.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ac(Nf,e=>{if(!Go){let t;hm?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Ll,!0,!0,e)):t=new CustomEvent(Ll,{detail:e}),Go=!0,dispatchEvent(t),Go=!1}}),addEventListener(Ll,({detail:e})=>{Go||sh(e)}));let Go=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Ll);typeof e.unref=="function"&&e.unref(),ac(Nf,t=>{Go||e.postMessage(t)}),e.onmessage=t=>{t.data&&sh(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ac(Nf,t=>{try{Go||(typeof localStorage<"u"&&localStorage.setItem(Ll,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Ll,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Ll){const r=JSON.parse(t.newValue);r&&sh(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Ll&&sh(t.changedParts)})}Nt.rejectionMapper=function(e,t){if(!e||e instanceof Cd||e instanceof TypeError||e instanceof SyntaxError||!e.name||!qv[e.name])return e;var r=new qv[e.name](t||e.message,e);return"stack"in e&&$o(r,"stack",{get:function(){return this.inner.stack}}),r},Jb(yo,u_);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kf={};kf.version="0.18.5";var ei=1200,nA=1252,XI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],P2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gm=function(e){XI.indexOf(e)!=-1&&(nA=P2[0]=e)};function JI(){gm(1252)}var Ci=function(e){ei=e,gm(e)};function xm(){Ci(1200),JI()}function Bh(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function ZI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function E_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var yd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?ZI(e.slice(2)):t==254&&r==255?E_(e.slice(2)):t==65279?e.slice(1):e},Hu=function(t){return String.fromCharCode(t)},Bx=function(t){return String.fromCharCode(t)},_r;function e3(e){_r=e,Ci=function(t){ei=t,gm(t)},yd=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?_r.utils.decode(1200,Bh(t.slice(2))):t},Hu=function(r){return ei===1200?String.fromCharCode(r):_r.utils.decode(ei,[r&255,r>>8])[0]},Bx=function(r){return _r.utils.decode(nA,[r])[0]},X_()}var Pl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Df(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0,A=0;A<e.length;)r=e.charCodeAt(A++),i=r>>2,a=e.charCodeAt(A++),o=(r&3)<<4|a>>4,n=e.charCodeAt(A++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),t+=Pl.charAt(i)+Pl.charAt(o)+Pl.charAt(l)+Pl.charAt(c);return t}function ni(e){var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<e.length;)i=Pl.indexOf(e.charAt(A++)),o=Pl.indexOf(e.charAt(A++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Pl.indexOf(e.charAt(A++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=Pl.indexOf(e.charAt(A++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var ur=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),sl=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function nc(e){return ur?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function e4(e){return ur?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ys=function(t){return ur?sl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s0(e){if(typeof ArrayBuffer>"u")return Ys(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function uc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function t3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Q2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Q2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xn=ur?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:sl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function r3(e){for(var t=[],r=0,a=e.length+250,n=nc(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=nc(65535),a=65530)}return t.push(n.slice(0,r)),xn(t)}var Jn=/\u0000/g,Gu=/[\u0001-\u0006]/g;function Sd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function qi(e,t){var r=""+e;return r.length>=t?r:Ca("0",t-r.length)+r}function q2(e,t){var r=""+e;return r.length>=t?r:Ca(" ",t-r.length)+r}function Sh(e,t){var r=""+e;return r.length>=t?r:r+Ca(" ",t-r.length)}function a3(e,t){var r=""+Math.round(e);return r.length>=t?r:Ca("0",t-r.length)+r}function n3(e,t){var r=""+e;return r.length>=t?r:Ca("0",t-r.length)+r}var t4=Math.pow(2,32);function GA(e,t){if(e>t4||e<-t4)return a3(e,t);var r=Math.round(e);return n3(r,t)}function Th(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var r4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ig=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},a4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Oh(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,o=1,l=0,c=1,A=0,d=0,f=Math.floor(n);A<t&&(f=Math.floor(n),l=f*o+i,d=f*A+c,!(n-f<5e-8));)n=1/(n-f),i=o,o=l,c=A,A=d;if(d>t&&(A>t?(d=c,l=i):(d=A,l=o)),!r)return[0,a*l,d];var p=Math.floor(a*l/d);return[p,a*l-p*d,d]}function Ql(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=u3(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var b_=new Date(1899,11,31,0,0,0),o3=b_.getTime(),l3=new Date(1900,2,1,0,0,0);function __(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=l3&&(r+=24*60*60*1e3),(r-(o3+(e.getTimezoneOffset()-b_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function K2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function c3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function A3(e){var t=e<0?12:11,r=K2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function d3(e){var t=K2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function jf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=A3(e):t===10?r=e.toFixed(10).substr(0,12):r=d3(e),K2(c3(r.toUpperCase()))}function sA(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):jf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return si(14,__(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function u3(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function f3(e,t,r,a){var n="",i=0,o=0,l=r.y,c,A=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,A=t.length;break;case 3:return Ig[r.m-1][1];case 5:return Ig[r.m-1][0];default:return Ig[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,A=t.length;break;case 3:return r4[r.q][0];default:return r4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,A=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,A=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,A=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?qi(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=qi(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}A=t.length===3?1:2;break;case 101:c=l,A=1;break}var d=A>0?qi(c,A):"";return d}function ql(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var C_=/%/g;function p3(e,t,r){var a=t.replace(C_,""),n=t.length-a.length;return Wo(e,a,r*Math.pow(10,2*n))+Ca("%",n)}function h3(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wo(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function B_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+B_(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,d){return c+A+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S_=/# (\?+)( ?)\/( ?)(\d+)/;function m3(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),o=n-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?Ca(" ",e[1].length+1+e[4].length):q2(o,e[1].length)+e[2]+"/"+e[3]+qi(l,e[4].length))}function g3(e,t,r){return r+(t===0?"":""+t)+Ca(" ",e[1].length+2+e[4].length)}var T_=/^#*0*\.([0#]+)/,O_=/\).*[0#]/,I_=/\(###\) ###\\?-####/;function ds(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function n4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function s4(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function x3(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function y3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(O_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xi("n",a,r):"("+xi("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return h3(e,t,r);if(t.indexOf("%")!==-1)return p3(e,t,r);if(t.indexOf("E")!==-1)return B_(t,r);if(t.charCodeAt(0)===36)return"$"+xi(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+GA(c,t.length);if(t.match(/^[#?]+$/))return n=GA(r,0),n==="0"&&(n=""),n.length>t.length?n:ds(t.substr(0,t.length-n.length))+n;if(i=t.match(S_))return m3(i,c,A);if(t.match(/^#+0+$/))return A+GA(c,t.length-t.indexOf("0"));if(i=t.match(T_))return n=n4(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ds(i[1])).replace(/\.$/,"."+ds(i[1])).replace(/\.(\d*)$/,function(g,h){return"."+h+Ca("0",ds(i[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return A+n4(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return A+ql(GA(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xi(e,t,-r):ql(""+(Math.floor(r)+x3(r,i[1].length)))+"."+qi(s4(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return xi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Sd(xi(e,t.replace(/[\\-]/g,""),r)),o=0,Sd(Sd(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(I_))return n=xi(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Oh(c,Math.pow(10,o)-1,!1),n=""+A,d=Wo("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Sh(l[2],o),d.length<i[4].length&&(d=ds(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Oh(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?q2(l[1],o)+i[2]+"/"+i[3]+Sh(l[2],o):Ca(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=GA(r,0),t.length<=n.length?n:ds(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,p=t.length-n.length-f;return ds(t.substr(0,f)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=s4(r,i[1].length),r<0?"-"+xi(e,t,-r):ql(y3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?qi(0,3-g.length):"")+g})+"."+qi(o,i[1].length);switch(t){case"###,##0.00":return xi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=ql(GA(c,0));return u!=="0"?A+u:"";case"###,###.00":return xi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function v3(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wo(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function w3(e,t,r){var a=t.replace(C_,""),n=t.length-a.length;return Wo(e,a,r*Math.pow(10,2*n))+Ca("%",n)}function N_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N_(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,d){return c+A+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function so(e,t,r){if(e.charCodeAt(0)===40&&!t.match(O_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?so("n",a,r):"("+so("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return v3(e,t,r);if(t.indexOf("%")!==-1)return w3(e,t,r);if(t.indexOf("E")!==-1)return N_(t,r);if(t.charCodeAt(0)===36)return"$"+so(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+qi(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ds(t.substr(0,t.length-n.length))+n;if(i=t.match(S_))return g3(i,c,A);if(t.match(/^#+0+$/))return A+qi(c,t.length-t.indexOf("0"));if(i=t.match(T_))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ds(i[1])).replace(/\.$/,"."+ds(i[1])),n=n.replace(/\.(\d*)$/,function(g,h){return"."+h+Ca("0",ds(i[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return A+ql(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+so(e,t,-r):ql(""+r)+"."+Ca("0",i[1].length);if(i=t.match(/^#,#*,#0/))return so(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Sd(so(e,t.replace(/[\\-]/g,""),r)),o=0,Sd(Sd(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(I_))return n=so(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Oh(c,Math.pow(10,o)-1,!1),n=""+A,d=Wo("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Sh(l[2],o),d.length<i[4].length&&(d=ds(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Oh(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?q2(l[1],o)+i[2]+"/"+i[3]+Sh(l[2],o):Ca(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ds(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,p=t.length-n.length-f;return ds(t.substr(0,f)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+so(e,t,-r):ql(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?qi(0,3-g.length):"")+g})+"."+qi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=ql(""+c);return u!=="0"?A+u:"";default:if(t.match(/\.[0#?]*$/))return so(e,t.slice(0,t.lastIndexOf(".")),r)+ds(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wo(e,t,r){return(r|0)===r?so(e,t,r):xi(e,t,r)}function E3(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var F_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fA(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Th(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(F_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function b3(e,t,r,a){for(var n=[],i="",o=0,l="",c="t",A,d,f,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Th(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);n[n.length]={t:"t",v:i},++o;break;case"\\":var u=e.charAt(++o),g=u==="("||u===")"?u:"t";n[n.length]={t:g,v:u},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(A==null&&(A=Ql(t,r,e.charAt(o+1)==="2"),A==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||A==null&&(A=Ql(t,r),A==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var h={t:l,v:l};if(A==null&&(A=Ql(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(h.v=A.H>=12?"P":"A"),h.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(h.v=A.H>=12?"PM":"AM"),h.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(A!=null&&(h.v=A.H>=12?"下午":"上午"),h.t="T",o+=5,p="h"):(h.t="t",++o),A==null&&h.t==="T")return"";n[n.length]=h,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(F_)){if(A==null&&(A=Ql(t,r),A==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",fA(e)||(n[n.length]={t:"t",v:i}));break;case".":if(A!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var x=0,y=0,v;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=p,c="h",x<1&&(x=1);break;case"s":(v=n[o].v.match(/\.0+$/))&&(y=Math.max(y,v[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[o].v.match(/[Hh]/)&&(x=1),x<2&&n[o].v.match(/[Mm]/)&&(x=2),x<3&&n[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var E="",k;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=f3(n[o].t.charCodeAt(0),n[o].v,A,y),n[o].t="t";break;case"n":case"?":for(k=o+1;n[k]!=null&&((l=n[k].t)==="?"||l==="D"||(l===" "||l==="t")&&n[k+1]!=null&&(n[k+1].t==="?"||n[k+1].t==="t"&&n[k+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[k].v==="/"||n[k].v===" "&&n[k+1]!=null&&n[k+1].t=="?"));)n[o].v+=n[k].v,n[k]={v:"",t:";"},++k;E+=n[o].v,o=k-1;break;case"G":n[o].t="t",n[o].v=sA(t,r);break}var S="",B,b;if(E.length>0){E.charCodeAt(0)==40?(B=t<0&&E.charCodeAt(0)===45?-t:t,b=Wo("n",E,B)):(B=t<0&&a>1?-t:t,b=Wo("n",E,B),B<0&&n[0]&&n[0].t=="t"&&(b=b.substr(1),n[0].v="-"+n[0].v)),k=b.length-1;var O=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){O=o;break}var _=n.length;if(O===n.length&&b.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(k>=n[o].v.length-1?(k-=n[o].v.length,n[o].v=b.substr(k+1,n[o].v.length)):k<0?n[o].v="":(n[o].v=b.substr(0,k+1),k=-1),n[o].t="t",_=o);k>=0&&_<n.length&&(n[_].v=b.substr(0,k+1)+n[_].v)}else if(O!==n.length&&b.indexOf("E")===-1){for(k=b.indexOf(".")-1,o=O;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===O?n[o].v.indexOf(".")-1:n[o].v.length-1,S=n[o].v.substr(d+1);d>=0;--d)k>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(S=b.charAt(k--)+S);n[o].v=S,n[o].t="t",_=o}for(k>=0&&_<n.length&&(n[_].v=b.substr(0,k+1)+n[_].v),k=b.indexOf(".")+1,o=O;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==O)){for(d=n[o].v.indexOf(".")>-1&&o===O?n[o].v.indexOf(".")+1:0,S=n[o].v.substr(0,d);d<n[o].v.length;++d)k<b.length&&(S+=b.charAt(k++));n[o].v=S,n[o].t="t",_=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(B=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Wo(n[o].t,n[o].v,B),n[o].t="t");var U="";for(o=0;o!==n.length;++o)n[o]!=null&&(U+=n[o].v);return U}var i4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function o4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _3(e,t){var r=E3(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(i4),l=r[1].match(i4);return o4(t,o)?[a,r[0]]:o4(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function si(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:zt)[e],a==null&&(a=r.table&&r.table[a4[e]]||zt[a4[e]]),a==null&&(a=i3[e]||"General");break}if(Th(a,0))return sA(t,r);t instanceof Date&&(t=__(t,r.date1904));var n=_3(a,t);if(Th(n[1]))return sA(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return b3(n[1],t,r,n[0])}function ho(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(zt[r]==null){t<0&&(t=r);continue}if(zt[r]==e){t=r;break}}t<0&&(t=391)}return zt[t]=e,t}function i0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ho(e[t],t)}function $d(){zt=s3()}var R_={format:si,load:ho,_table:zt,load_table:i0,parse_date_code:Ql,is_date:fA,get_table:function(){return R_._table=zt}},C3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function B3(e){var t=typeof e=="number"?zt[e]:e;return t=t.replace(k_,"(\\d+)"),new RegExp("^"+t+"$")}function S3(e,t,r){var a=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(t.match(k_)||[]).forEach(function(f,p){var u=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=u;break;case"d":i=u;break;case"h":o=u;break;case"s":c=u;break;case"m":o>=0?l=u:n=u;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var A=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:a==-1&&n==-1&&i==-1?d:A+"T"+d}var T3=function(){var e={};e.version="1.2.0";function t(){for(var b=0,O=new Array(256),_=0;_!=256;++_)b=_,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,O[_]=b;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function a(b){var O=0,_=0,U=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)I[U]=b[U];for(U=0;U!=256;++U)for(_=b[U],O=256+U;O<4096;O+=256)_=I[O]=_>>>8^b[_&255];var R=[];for(U=1;U!=16;++U)R[U-1]=typeof Int32Array<"u"?I.subarray(U*256,U*256+256):I.slice(U*256,U*256+256);return R}var n=a(r),i=n[0],o=n[1],l=n[2],c=n[3],A=n[4],d=n[5],f=n[6],p=n[7],u=n[8],g=n[9],h=n[10],x=n[11],y=n[12],v=n[13],E=n[14];function k(b,O){for(var _=O^-1,U=0,I=b.length;U<I;)_=_>>>8^r[(_^b.charCodeAt(U++))&255];return~_}function S(b,O){for(var _=O^-1,U=b.length-15,I=0;I<U;)_=E[b[I++]^_&255]^v[b[I++]^_>>8&255]^y[b[I++]^_>>16&255]^x[b[I++]^_>>>24]^h[b[I++]]^g[b[I++]]^u[b[I++]]^p[b[I++]]^f[b[I++]]^d[b[I++]]^A[b[I++]]^c[b[I++]]^l[b[I++]]^o[b[I++]]^i[b[I++]]^r[b[I++]];for(U+=15;I<U;)_=_>>>8^r[(_^b[I++])&255];return~_}function B(b,O){for(var _=O^-1,U=0,I=b.length,R=0,L=0;U<I;)R=b.charCodeAt(U++),R<128?_=_>>>8^r[(_^R)&255]:R<2048?(_=_>>>8^r[(_^(192|R>>6&31))&255],_=_>>>8^r[(_^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,L=b.charCodeAt(U++)&1023,_=_>>>8^r[(_^(240|R>>8&7))&255],_=_>>>8^r[(_^(128|R>>2&63))&255],_=_>>>8^r[(_^(128|L>>6&15|(R&3)<<4))&255],_=_>>>8^r[(_^(128|L&63))&255]):(_=_>>>8^r[(_^(224|R>>12&15))&255],_=_>>>8^r[(_^(128|R>>6&63))&255],_=_>>>8^r[(_^(128|R&63))&255]);return~_}return e.table=r,e.bstr=k,e.buf=S,e.str=B,e}(),Ut=function(){var t={};t.version="1.2.1";function r(H,le){for(var ae=H.split("/"),Z=le.split("/"),oe=0,de=0,Oe=Math.min(ae.length,Z.length);oe<Oe;++oe){if(de=ae[oe].length-Z[oe].length)return de;if(ae[oe]!=Z[oe])return ae[oe]<Z[oe]?-1:1}return ae.length-Z.length}function a(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:a(H.slice(0,-1));var le=H.lastIndexOf("/");return le===-1?H:H.slice(0,le+1)}function n(H){if(H.charAt(H.length-1)=="/")return n(H.slice(0,-1));var le=H.lastIndexOf("/");return le===-1?H:H.slice(le+1)}function i(H,le){typeof le=="string"&&(le=new Date(le));var ae=le.getHours();ae=ae<<6|le.getMinutes(),ae=ae<<5|le.getSeconds()>>>1,H.write_shift(2,ae);var Z=le.getFullYear()-1980;Z=Z<<4|le.getMonth()+1,Z=Z<<5|le.getDate(),H.write_shift(2,Z)}function o(H){var le=H.read_shift(2)&65535,ae=H.read_shift(2)&65535,Z=new Date,oe=ae&31;ae>>>=5;var de=ae&15;ae>>>=4,Z.setMilliseconds(0),Z.setFullYear(ae+1980),Z.setMonth(de-1),Z.setDate(oe);var Oe=le&31;le>>>=5;var Pe=le&63;return le>>>=6,Z.setHours(le),Z.setMinutes(Pe),Z.setSeconds(Oe<<1),Z}function l(H){Sn(H,0);for(var le={},ae=0;H.l<=H.length-4;){var Z=H.read_shift(2),oe=H.read_shift(2),de=H.l+oe,Oe={};switch(Z){case 21589:ae=H.read_shift(1),ae&1&&(Oe.mtime=H.read_shift(4)),oe>5&&(ae&2&&(Oe.atime=H.read_shift(4)),ae&4&&(Oe.ctime=H.read_shift(4))),Oe.mtime&&(Oe.mt=new Date(Oe.mtime*1e3));break}H.l=de,le[Z]=Oe}return le}var c;function A(){return c||(c={})}function d(H,le){if(H[0]==80&&H[1]==75)return Lr(H,le);if((H[0]|32)==109&&(H[1]|32)==105)return ws(H,le);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var ae=3,Z=512,oe=0,de=0,Oe=0,Pe=0,Ce=0,De=[],Me=H.slice(0,512);Sn(Me,0);var $e=f(Me);switch(ae=$e[0],ae){case 3:Z=512;break;case 4:Z=4096;break;case 0:if($e[1]==0)return Lr(H,le);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}Z!==512&&(Me=H.slice(0,Z),Sn(Me,28));var ft=H.slice(0,Z);p(Me,ae);var xt=Me.read_shift(4,"i");if(ae===3&&xt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xt);Me.l+=4,Oe=Me.read_shift(4,"i"),Me.l+=4,Me.chk("00100000","Mini Stream Cutoff Size: "),Pe=Me.read_shift(4,"i"),oe=Me.read_shift(4,"i"),Ce=Me.read_shift(4,"i"),de=Me.read_shift(4,"i");for(var ot=-1,mt=0;mt<109&&(ot=Me.read_shift(4,"i"),!(ot<0));++mt)De[mt]=ot;var Kt=u(H,Z);x(Ce,de,Kt,Z,De);var yr=v(Kt,Oe,De,Z);yr[Oe].name="!Directory",oe>0&&Pe!==L&&(yr[Pe].name="!MiniFAT"),yr[De[0]].name="!FAT",yr.fat_addrs=De,yr.ssz=Z;var Cr={},ya=[],Es=[],bs=[];E(Oe,yr,Kt,ya,oe,Cr,Es,Pe),g(Es,bs,ya),ya.shift();var Fn={FileIndex:Es,FullPaths:bs};return le&&le.raw&&(Fn.raw={header:ft,sectors:Kt}),Fn}function f(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(N,"Header Signature: "),H.l+=16;var le=H.read_shift(2,"u");return[H.read_shift(2,"u"),le]}function p(H,le){var ae=9;switch(H.l+=2,ae=H.read_shift(2)){case 9:if(le!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(le!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function u(H,le){for(var ae=Math.ceil(H.length/le)-1,Z=[],oe=1;oe<ae;++oe)Z[oe-1]=H.slice(oe*le,(oe+1)*le);return Z[ae-1]=H.slice(ae*le),Z}function g(H,le,ae){for(var Z=0,oe=0,de=0,Oe=0,Pe=0,Ce=ae.length,De=[],Me=[];Z<Ce;++Z)De[Z]=Me[Z]=Z,le[Z]=ae[Z];for(;Pe<Me.length;++Pe)Z=Me[Pe],oe=H[Z].L,de=H[Z].R,Oe=H[Z].C,De[Z]===Z&&(oe!==-1&&De[oe]!==oe&&(De[Z]=De[oe]),de!==-1&&De[de]!==de&&(De[Z]=De[de])),Oe!==-1&&(De[Oe]=Z),oe!==-1&&Z!=De[Z]&&(De[oe]=De[Z],Me.lastIndexOf(oe)<Pe&&Me.push(oe)),de!==-1&&Z!=De[Z]&&(De[de]=De[Z],Me.lastIndexOf(de)<Pe&&Me.push(de));for(Z=1;Z<Ce;++Z)De[Z]===Z&&(de!==-1&&De[de]!==de?De[Z]=De[de]:oe!==-1&&De[oe]!==oe&&(De[Z]=De[oe]));for(Z=1;Z<Ce;++Z)if(H[Z].type!==0){if(Pe=Z,Pe!=De[Pe])do Pe=De[Pe],le[Z]=le[Pe]+"/"+le[Z];while(Pe!==0&&De[Pe]!==-1&&Pe!=De[Pe]);De[Z]=-1}for(le[0]+="/",Z=1;Z<Ce;++Z)H[Z].type!==2&&(le[Z]+="/")}function h(H,le,ae){for(var Z=H.start,oe=H.size,de=[],Oe=Z;ae&&oe>0&&Oe>=0;)de.push(le.slice(Oe*R,Oe*R+R)),oe-=R,Oe=Dc(ae,Oe*4);return de.length===0?Je(0):xn(de).slice(0,H.size)}function x(H,le,ae,Z,oe){var de=L;if(H===L){if(le!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var Oe=ae[H],Pe=(Z>>>2)-1;if(!Oe)return;for(var Ce=0;Ce<Pe&&(de=Dc(Oe,Ce*4))!==L;++Ce)oe.push(de);x(Dc(Oe,Z-4),le-1,ae,Z,oe)}}function y(H,le,ae,Z,oe){var de=[],Oe=[];oe||(oe=[]);var Pe=Z-1,Ce=0,De=0;for(Ce=le;Ce>=0;){oe[Ce]=!0,de[de.length]=Ce,Oe.push(H[Ce]);var Me=ae[Math.floor(Ce*4/Z)];if(De=Ce*4&Pe,Z<4+De)throw new Error("FAT boundary crossed: "+Ce+" 4 "+Z);if(!H[Me])break;Ce=Dc(H[Me],De)}return{nodes:de,data:y4([Oe])}}function v(H,le,ae,Z){var oe=H.length,de=[],Oe=[],Pe=[],Ce=[],De=Z-1,Me=0,$e=0,ft=0,xt=0;for(Me=0;Me<oe;++Me)if(Pe=[],ft=Me+le,ft>=oe&&(ft-=oe),!Oe[ft]){Ce=[];var ot=[];for($e=ft;$e>=0;){ot[$e]=!0,Oe[$e]=!0,Pe[Pe.length]=$e,Ce.push(H[$e]);var mt=ae[Math.floor($e*4/Z)];if(xt=$e*4&De,Z<4+xt)throw new Error("FAT boundary crossed: "+$e+" 4 "+Z);if(!H[mt]||($e=Dc(H[mt],xt),ot[$e]))break}de[ft]={nodes:Pe,data:y4([Ce])}}return de}function E(H,le,ae,Z,oe,de,Oe,Pe){for(var Ce=0,De=Z.length?2:0,Me=le[H].data,$e=0,ft=0,xt;$e<Me.length;$e+=128){var ot=Me.slice($e,$e+128);Sn(ot,64),ft=ot.read_shift(2),xt=Em(ot,0,ft-De),Z.push(xt);var mt={name:xt,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},Kt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);Kt!==0&&(mt.ct=k(ot,ot.l-8));var yr=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);yr!==0&&(mt.mt=k(ot,ot.l-8)),mt.start=ot.read_shift(4,"i"),mt.size=ot.read_shift(4,"i"),mt.size<0&&mt.start<0&&(mt.size=mt.type=0,mt.start=L,mt.name=""),mt.type===5?(Ce=mt.start,oe>0&&Ce!==L&&(le[Ce].name="!StreamData")):mt.size>=4096?(mt.storage="fat",le[mt.start]===void 0&&(le[mt.start]=y(ae,mt.start,le.fat_addrs,le.ssz)),le[mt.start].name=mt.name,mt.content=le[mt.start].data.slice(0,mt.size)):(mt.storage="minifat",mt.size<0?mt.size=0:Ce!==L&&mt.start!==L&&le[Ce]&&(mt.content=h(mt,le[Ce].data,(le[Pe]||{}).data))),mt.content&&Sn(mt.content,0),de[xt]=mt,Oe.push(mt)}}function k(H,le){return new Date((gn(H,le+4)/1e7*Math.pow(2,32)+gn(H,le)/1e7-11644473600)*1e3)}function S(H,le){return A(),d(c.readFileSync(H),le)}function B(H,le){var ae=le&&le.type;switch(ae||ur&&Buffer.isBuffer(H)&&(ae="buffer"),ae||"base64"){case"file":return S(H,le);case"base64":return d(Ys(ni(H)),le);case"binary":return d(Ys(H),le)}return d(H,le)}function b(H,le){var ae=le||{},Z=ae.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=Z+"/",H.FileIndex[0]={name:Z,type:5}),ae.CLSID&&(H.FileIndex[0].clsid=ae.CLSID),O(H)}function O(H){var le="Sh33tJ5";if(!Ut.find(H,"/"+le)){var ae=Je(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,H.FileIndex.push({name:le,type:2,content:ae,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+le),_(H)}}function _(H,le){b(H);for(var ae=!1,Z=!1,oe=H.FullPaths.length-1;oe>=0;--oe){var de=H.FileIndex[oe];switch(de.type){case 0:Z?ae=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(de.R*de.L*de.C)&&(ae=!0),de.R>-1&&de.L>-1&&de.R==de.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!le)){var Oe=new Date(1987,1,19),Pe=0,Ce=Object.create?Object.create(null):{},De=[];for(oe=0;oe<H.FullPaths.length;++oe)Ce[H.FullPaths[oe]]=!0,H.FileIndex[oe].type!==0&&De.push([H.FullPaths[oe],H.FileIndex[oe]]);for(oe=0;oe<De.length;++oe){var Me=a(De[oe][0]);Z=Ce[Me],Z||(De.push([Me,{name:n(Me).replace("/",""),type:1,clsid:Q,ct:Oe,mt:Oe,content:null}]),Ce[Me]=!0)}for(De.sort(function(xt,ot){return r(xt[0],ot[0])}),H.FullPaths=[],H.FileIndex=[],oe=0;oe<De.length;++oe)H.FullPaths[oe]=De[oe][0],H.FileIndex[oe]=De[oe][1];for(oe=0;oe<De.length;++oe){var $e=H.FileIndex[oe],ft=H.FullPaths[oe];if($e.name=n(ft).replace("/",""),$e.L=$e.R=$e.C=-($e.color=1),$e.size=$e.content?$e.content.length:0,$e.start=0,$e.clsid=$e.clsid||Q,oe===0)$e.C=De.length>1?1:-1,$e.size=0,$e.type=5;else if(ft.slice(-1)=="/"){for(Pe=oe+1;Pe<De.length&&a(H.FullPaths[Pe])!=ft;++Pe);for($e.C=Pe>=De.length?-1:Pe,Pe=oe+1;Pe<De.length&&a(H.FullPaths[Pe])!=a(ft);++Pe);$e.R=Pe>=De.length?-1:Pe,$e.type=1}else a(H.FullPaths[oe+1]||"")==a(ft)&&($e.R=oe+1),$e.type=2}}}function U(H,le){var ae=le||{};if(ae.fileType=="mad")return Dt(H,ae);switch(_(H),ae.fileType){case"zip":return Ds(H,ae)}var Z=function(xt){for(var ot=0,mt=0,Kt=0;Kt<xt.FileIndex.length;++Kt){var yr=xt.FileIndex[Kt];if(yr.content){var Cr=yr.content.length;Cr>0&&(Cr<4096?ot+=Cr+63>>6:mt+=Cr+511>>9)}}for(var ya=xt.FullPaths.length+3>>2,Es=ot+7>>3,bs=ot+127>>7,Fn=Es+mt+ya+bs,js=Fn+127>>7,oi=js<=109?0:Math.ceil((js-109)/127);Fn+js+oi+127>>7>js;)oi=++js<=109?0:Math.ceil((js-109)/127);var ss=[1,oi,js,bs,ya,mt,ot,0];return xt.FileIndex[0].size=ot<<6,ss[7]=(xt.FileIndex[0].start=ss[0]+ss[1]+ss[2]+ss[3]+ss[4]+ss[5])+(ss[6]+7>>3),ss}(H),oe=Je(Z[7]<<9),de=0,Oe=0;{for(de=0;de<8;++de)oe.write_shift(1,P[de]);for(de=0;de<8;++de)oe.write_shift(2,0);for(oe.write_shift(2,62),oe.write_shift(2,3),oe.write_shift(2,65534),oe.write_shift(2,9),oe.write_shift(2,6),de=0;de<3;++de)oe.write_shift(2,0);for(oe.write_shift(4,0),oe.write_shift(4,Z[2]),oe.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),oe.write_shift(4,0),oe.write_shift(4,4096),oe.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:L),oe.write_shift(4,Z[3]),oe.write_shift(-4,Z[1]?Z[0]-1:L),oe.write_shift(4,Z[1]),de=0;de<109;++de)oe.write_shift(-4,de<Z[2]?Z[1]+de:-1)}if(Z[1])for(Oe=0;Oe<Z[1];++Oe){for(;de<236+Oe*127;++de)oe.write_shift(-4,de<Z[2]?Z[1]+de:-1);oe.write_shift(-4,Oe===Z[1]-1?L:Oe+1)}var Pe=function(xt){for(Oe+=xt;de<Oe-1;++de)oe.write_shift(-4,de+1);xt&&(++de,oe.write_shift(-4,L))};for(Oe=de=0,Oe+=Z[1];de<Oe;++de)oe.write_shift(-4,Y.DIFSECT);for(Oe+=Z[2];de<Oe;++de)oe.write_shift(-4,Y.FATSECT);Pe(Z[3]),Pe(Z[4]);for(var Ce=0,De=0,Me=H.FileIndex[0];Ce<H.FileIndex.length;++Ce)Me=H.FileIndex[Ce],Me.content&&(De=Me.content.length,!(De<4096)&&(Me.start=Oe,Pe(De+511>>9)));for(Pe(Z[6]+7>>3);oe.l&511;)oe.write_shift(-4,Y.ENDOFCHAIN);for(Oe=de=0,Ce=0;Ce<H.FileIndex.length;++Ce)Me=H.FileIndex[Ce],Me.content&&(De=Me.content.length,!(!De||De>=4096)&&(Me.start=Oe,Pe(De+63>>6)));for(;oe.l&511;)oe.write_shift(-4,Y.ENDOFCHAIN);for(de=0;de<Z[4]<<2;++de){var $e=H.FullPaths[de];if(!$e||$e.length===0){for(Ce=0;Ce<17;++Ce)oe.write_shift(4,0);for(Ce=0;Ce<3;++Ce)oe.write_shift(4,-1);for(Ce=0;Ce<12;++Ce)oe.write_shift(4,0);continue}Me=H.FileIndex[de],de===0&&(Me.start=Me.size?Me.start-1:L);var ft=de===0&&ae.root||Me.name;if(De=2*(ft.length+1),oe.write_shift(64,ft,"utf16le"),oe.write_shift(2,De),oe.write_shift(1,Me.type),oe.write_shift(1,Me.color),oe.write_shift(-4,Me.L),oe.write_shift(-4,Me.R),oe.write_shift(-4,Me.C),Me.clsid)oe.write_shift(16,Me.clsid,"hex");else for(Ce=0;Ce<4;++Ce)oe.write_shift(4,0);oe.write_shift(4,Me.state||0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,Me.start),oe.write_shift(4,Me.size),oe.write_shift(4,0)}for(de=1;de<H.FileIndex.length;++de)if(Me=H.FileIndex[de],Me.size>=4096)if(oe.l=Me.start+1<<9,ur&&Buffer.isBuffer(Me.content))Me.content.copy(oe,oe.l,0,Me.size),oe.l+=Me.size+511&-512;else{for(Ce=0;Ce<Me.size;++Ce)oe.write_shift(1,Me.content[Ce]);for(;Ce&511;++Ce)oe.write_shift(1,0)}for(de=1;de<H.FileIndex.length;++de)if(Me=H.FileIndex[de],Me.size>0&&Me.size<4096)if(ur&&Buffer.isBuffer(Me.content))Me.content.copy(oe,oe.l,0,Me.size),oe.l+=Me.size+63&-64;else{for(Ce=0;Ce<Me.size;++Ce)oe.write_shift(1,Me.content[Ce]);for(;Ce&63;++Ce)oe.write_shift(1,0)}if(ur)oe.l=oe.length;else for(;oe.l<oe.length;)oe.write_shift(1,0);return oe}function I(H,le){var ae=H.FullPaths.map(function(Ce){return Ce.toUpperCase()}),Z=ae.map(function(Ce){var De=Ce.split("/");return De[De.length-(Ce.slice(-1)=="/"?2:1)]}),oe=!1;le.charCodeAt(0)===47?(oe=!0,le=ae[0].slice(0,-1)+le):oe=le.indexOf("/")!==-1;var de=le.toUpperCase(),Oe=oe===!0?ae.indexOf(de):Z.indexOf(de);if(Oe!==-1)return H.FileIndex[Oe];var Pe=!de.match(Gu);for(de=de.replace(Jn,""),Pe&&(de=de.replace(Gu,"!")),Oe=0;Oe<ae.length;++Oe)if((Pe?ae[Oe].replace(Gu,"!"):ae[Oe]).replace(Jn,"")==de||(Pe?Z[Oe].replace(Gu,"!"):Z[Oe]).replace(Jn,"")==de)return H.FileIndex[Oe];return null}var R=64,L=-2,N="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:N,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(H,le,ae){A();var Z=U(H,ae);c.writeFileSync(le,Z)}function V(H){for(var le=new Array(H.length),ae=0;ae<H.length;++ae)le[ae]=String.fromCharCode(H[ae]);return le.join("")}function G(H,le){var ae=U(H,le);switch(le&&le.type||"buffer"){case"file":return A(),c.writeFileSync(le.filename,ae),ae;case"binary":return typeof ae=="string"?ae:V(ae);case"base64":return Df(typeof ae=="string"?ae:V(ae));case"buffer":if(ur)return Buffer.isBuffer(ae)?ae:sl(ae);case"array":return typeof ae=="string"?Ys(ae):ae}return ae}var z;function C(H){try{var le=H.InflateRaw,ae=new le;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)z=H;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function D(H,le){if(!z)return nr(H,le);var ae=z.InflateRaw,Z=new ae,oe=Z._processChunk(H.slice(H.l),Z._finishFlushFlag);return H.l+=Z.bytesRead,oe}function j(H){return z?z.deflateRawSync(H):ut(H)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(H){var le=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(le>>16|le>>8|le)&255}for(var he=typeof Uint8Array<"u",ve=he?new Uint8Array(256):[],we=0;we<256;++we)ve[we]=ue(we);function se(H,le){var ae=ve[H&255];return le<=8?ae>>>8-le:(ae=ae<<8|ve[H>>8&255],le<=16?ae>>>16-le:(ae=ae<<8|ve[H>>16&255],ae>>>24-le))}function He(H,le){var ae=le&7,Z=le>>>3;return(H[Z]|(ae<=6?0:H[Z+1]<<8))>>>ae&3}function Ee(H,le){var ae=le&7,Z=le>>>3;return(H[Z]|(ae<=5?0:H[Z+1]<<8))>>>ae&7}function pe(H,le){var ae=le&7,Z=le>>>3;return(H[Z]|(ae<=4?0:H[Z+1]<<8))>>>ae&15}function ce(H,le){var ae=le&7,Z=le>>>3;return(H[Z]|(ae<=3?0:H[Z+1]<<8))>>>ae&31}function Ge(H,le){var ae=le&7,Z=le>>>3;return(H[Z]|(ae<=1?0:H[Z+1]<<8))>>>ae&127}function et(H,le,ae){var Z=le&7,oe=le>>>3,de=(1<<ae)-1,Oe=H[oe]>>>Z;return ae<8-Z||(Oe|=H[oe+1]<<8-Z,ae<16-Z)||(Oe|=H[oe+2]<<16-Z,ae<24-Z)||(Oe|=H[oe+3]<<24-Z),Oe&de}function Ye(H,le,ae){var Z=le&7,oe=le>>>3;return Z<=5?H[oe]|=(ae&7)<<Z:(H[oe]|=ae<<Z&255,H[oe+1]=(ae&7)>>8-Z),le+3}function tt(H,le,ae){var Z=le&7,oe=le>>>3;return ae=(ae&1)<<Z,H[oe]|=ae,le+1}function je(H,le,ae){var Z=le&7,oe=le>>>3;return ae<<=Z,H[oe]|=ae&255,ae>>>=8,H[oe+1]=ae,le+8}function _e(H,le,ae){var Z=le&7,oe=le>>>3;return ae<<=Z,H[oe]|=ae&255,ae>>>=8,H[oe+1]=ae&255,H[oe+2]=ae>>>8,le+16}function At(H,le){var ae=H.length,Z=2*ae>le?2*ae:le+5,oe=0;if(ae>=le)return H;if(ur){var de=e4(Z);if(H.copy)H.copy(de);else for(;oe<H.length;++oe)de[oe]=H[oe];return de}else if(he){var Oe=new Uint8Array(Z);if(Oe.set)Oe.set(H);else for(;oe<ae;++oe)Oe[oe]=H[oe];return Oe}return H.length=Z,H}function Ct(H){for(var le=new Array(H),ae=0;ae<H;++ae)le[ae]=0;return le}function _t(H,le,ae){var Z=1,oe=0,de=0,Oe=0,Pe=0,Ce=H.length,De=he?new Uint16Array(32):Ct(32);for(de=0;de<32;++de)De[de]=0;for(de=Ce;de<ae;++de)H[de]=0;Ce=H.length;var Me=he?new Uint16Array(Ce):Ct(Ce);for(de=0;de<Ce;++de)De[oe=H[de]]++,Z<oe&&(Z=oe),Me[de]=0;for(De[0]=0,de=1;de<=Z;++de)De[de+16]=Pe=Pe+De[de-1]<<1;for(de=0;de<Ce;++de)Pe=H[de],Pe!=0&&(Me[de]=De[Pe+16]++);var $e=0;for(de=0;de<Ce;++de)if($e=H[de],$e!=0)for(Pe=se(Me[de],Z)>>Z-$e,Oe=(1<<Z+4-$e)-1;Oe>=0;--Oe)le[Pe|Oe<<$e]=$e&15|de<<4;return Z}var Et=he?new Uint16Array(512):Ct(512),Pt=he?new Uint16Array(32):Ct(32);if(!he){for(var Lt=0;Lt<512;++Lt)Et[Lt]=0;for(Lt=0;Lt<32;++Lt)Pt[Lt]=0}(function(){for(var H=[],le=0;le<32;le++)H.push(5);_t(H,Pt,32);var ae=[];for(le=0;le<=143;le++)ae.push(8);for(;le<=255;le++)ae.push(9);for(;le<=279;le++)ae.push(7);for(;le<=287;le++)ae.push(8);_t(ae,Et,288)})();var Bt=function(){for(var le=he?new Uint8Array(32768):[],ae=0,Z=0;ae<Ae.length-1;++ae)for(;Z<Ae[ae+1];++Z)le[Z]=ae;for(;Z<32768;++Z)le[Z]=29;var oe=he?new Uint8Array(259):[];for(ae=0,Z=0;ae<W.length-1;++ae)for(;Z<W[ae+1];++Z)oe[Z]=ae;function de(Pe,Ce){for(var De=0;De<Pe.length;){var Me=Math.min(65535,Pe.length-De),$e=De+Me==Pe.length;for(Ce.write_shift(1,+$e),Ce.write_shift(2,Me),Ce.write_shift(2,~Me&65535);Me-- >0;)Ce[Ce.l++]=Pe[De++]}return Ce.l}function Oe(Pe,Ce){for(var De=0,Me=0,$e=he?new Uint16Array(32768):[];Me<Pe.length;){var ft=Math.min(65535,Pe.length-Me);if(ft<10){for(De=Ye(Ce,De,+(Me+ft==Pe.length)),De&7&&(De+=8-(De&7)),Ce.l=De/8|0,Ce.write_shift(2,ft),Ce.write_shift(2,~ft&65535);ft-- >0;)Ce[Ce.l++]=Pe[Me++];De=Ce.l*8;continue}De=Ye(Ce,De,+(Me+ft==Pe.length)+2);for(var xt=0;ft-- >0;){var ot=Pe[Me];xt=(xt<<5^ot)&32767;var mt=-1,Kt=0;if((mt=$e[xt])&&(mt|=Me&-32768,mt>Me&&(mt-=32768),mt<Me))for(;Pe[mt+Kt]==Pe[Me+Kt]&&Kt<250;)++Kt;if(Kt>2){ot=oe[Kt],ot<=22?De=je(Ce,De,ve[ot+1]>>1)-1:(je(Ce,De,3),De+=5,je(Ce,De,ve[ot-23]>>5),De+=3);var yr=ot<8?0:ot-4>>2;yr>0&&(_e(Ce,De,Kt-W[ot]),De+=yr),ot=le[Me-mt],De=je(Ce,De,ve[ot]>>3),De-=3;var Cr=ot<4?0:ot-2>>1;Cr>0&&(_e(Ce,De,Me-mt-Ae[ot]),De+=Cr);for(var ya=0;ya<Kt;++ya)$e[xt]=Me&32767,xt=(xt<<5^Pe[Me])&32767,++Me;ft-=Kt-1}else ot<=143?ot=ot+48:De=tt(Ce,De,1),De=je(Ce,De,ve[ot]),$e[xt]=Me&32767,++Me}De=je(Ce,De,0)-1}return Ce.l=(De+7)/8|0,Ce.l}return function(Ce,De){return Ce.length<8?de(Ce,De):Oe(Ce,De)}}();function ut(H){var le=Je(50+Math.floor(H.length*1.1)),ae=Bt(H,le);return le.slice(0,ae)}var ct=he?new Uint16Array(32768):Ct(32768),wr=he?new Uint16Array(32768):Ct(32768),Rt=he?new Uint16Array(128):Ct(128),$r=1,hr=1;function vt(H,le){var ae=ce(H,le)+257;le+=5;var Z=ce(H,le)+1;le+=5;var oe=pe(H,le)+4;le+=4;for(var de=0,Oe=he?new Uint8Array(19):Ct(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ce=1,De=he?new Uint8Array(8):Ct(8),Me=he?new Uint8Array(8):Ct(8),$e=Oe.length,ft=0;ft<oe;++ft)Oe[K[ft]]=de=Ee(H,le),Ce<de&&(Ce=de),De[de]++,le+=3;var xt=0;for(De[0]=0,ft=1;ft<=Ce;++ft)Me[ft]=xt=xt+De[ft-1]<<1;for(ft=0;ft<$e;++ft)(xt=Oe[ft])!=0&&(Pe[ft]=Me[xt]++);var ot=0;for(ft=0;ft<$e;++ft)if(ot=Oe[ft],ot!=0){xt=ve[Pe[ft]]>>8-ot;for(var mt=(1<<7-ot)-1;mt>=0;--mt)Rt[xt|mt<<ot]=ot&7|ft<<3}var Kt=[];for(Ce=1;Kt.length<ae+Z;)switch(xt=Rt[Ge(H,le)],le+=xt&7,xt>>>=3){case 16:for(de=3+He(H,le),le+=2,xt=Kt[Kt.length-1];de-- >0;)Kt.push(xt);break;case 17:for(de=3+Ee(H,le),le+=3;de-- >0;)Kt.push(0);break;case 18:for(de=11+Ge(H,le),le+=7;de-- >0;)Kt.push(0);break;default:Kt.push(xt),Ce<xt&&(Ce=xt);break}var yr=Kt.slice(0,ae),Cr=Kt.slice(ae);for(ft=ae;ft<286;++ft)yr[ft]=0;for(ft=Z;ft<30;++ft)Cr[ft]=0;return $r=_t(yr,ct,286),hr=_t(Cr,wr,30),le}function Or(H,le){if(H[0]==3&&!(H[1]&3))return[nc(le),2];for(var ae=0,Z=0,oe=e4(le||1<<18),de=0,Oe=oe.length>>>0,Pe=0,Ce=0;!(Z&1);){if(Z=Ee(H,ae),ae+=3,Z>>>1)Z>>1==1?(Pe=9,Ce=5):(ae=vt(H,ae),Pe=$r,Ce=hr);else{ae&7&&(ae+=8-(ae&7));var De=H[ae>>>3]|H[(ae>>>3)+1]<<8;if(ae+=32,De>0)for(!le&&Oe<de+De&&(oe=At(oe,de+De),Oe=oe.length);De-- >0;)oe[de++]=H[ae>>>3],ae+=8;continue}for(;;){!le&&Oe<de+32767&&(oe=At(oe,de+32767),Oe=oe.length);var Me=et(H,ae,Pe),$e=Z>>>1==1?Et[Me]:ct[Me];if(ae+=$e&15,$e>>>=4,!($e>>>8&255))oe[de++]=$e;else{if($e==256)break;$e-=257;var ft=$e<8?0:$e-4>>2;ft>5&&(ft=0);var xt=de+W[$e];ft>0&&(xt+=et(H,ae,ft),ae+=ft),Me=et(H,ae,Ce),$e=Z>>>1==1?Pt[Me]:wr[Me],ae+=$e&15,$e>>>=4;var ot=$e<4?0:$e-2>>1,mt=Ae[$e];for(ot>0&&(mt+=et(H,ae,ot),ae+=ot),!le&&Oe<xt&&(oe=At(oe,xt+100),Oe=oe.length);de<xt;)oe[de]=oe[de-mt],++de}}}return le?[oe,ae+7>>>3]:[oe.slice(0,de),ae+7>>>3]}function nr(H,le){var ae=H.slice(H.l||0),Z=Or(ae,le);return H.l+=Z[1],Z[0]}function cn(H,le){if(H)typeof console<"u"&&console.error(le);else throw new Error(le)}function Lr(H,le){var ae=H;Sn(ae,0);var Z=[],oe=[],de={FileIndex:Z,FullPaths:oe};b(de,{root:le.root});for(var Oe=ae.length-4;(ae[Oe]!=80||ae[Oe+1]!=75||ae[Oe+2]!=5||ae[Oe+3]!=6)&&Oe>=0;)--Oe;ae.l=Oe+4,ae.l+=4;var Pe=ae.read_shift(2);ae.l+=6;var Ce=ae.read_shift(4);for(ae.l=Ce,Oe=0;Oe<Pe;++Oe){ae.l+=20;var De=ae.read_shift(4),Me=ae.read_shift(4),$e=ae.read_shift(2),ft=ae.read_shift(2),xt=ae.read_shift(2);ae.l+=8;var ot=ae.read_shift(4),mt=l(ae.slice(ae.l+$e,ae.l+$e+ft));ae.l+=$e+ft+xt;var Kt=ae.l;ae.l=ot+4,as(ae,De,Me,de,mt),ae.l=Kt}return de}function as(H,le,ae,Z,oe){H.l+=2;var de=H.read_shift(2),Oe=H.read_shift(2),Pe=o(H);if(de&8257)throw new Error("Unsupported ZIP encryption");for(var Ce=H.read_shift(4),De=H.read_shift(4),Me=H.read_shift(4),$e=H.read_shift(2),ft=H.read_shift(2),xt="",ot=0;ot<$e;++ot)xt+=String.fromCharCode(H[H.l++]);if(ft){var mt=l(H.slice(H.l,H.l+ft));(mt[21589]||{}).mt&&(Pe=mt[21589].mt),((oe||{})[21589]||{}).mt&&(Pe=oe[21589].mt)}H.l+=ft;var Kt=H.slice(H.l,H.l+De);switch(Oe){case 8:Kt=D(H,Me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Oe)}var yr=!1;de&8&&(Ce=H.read_shift(4),Ce==134695760&&(Ce=H.read_shift(4),yr=!0),De=H.read_shift(4),Me=H.read_shift(4)),De!=le&&cn(yr,"Bad compressed size: "+le+" != "+De),Me!=ae&&cn(yr,"Bad uncompressed size: "+ae+" != "+Me),Ja(Z,xt,Kt,{unsafe:!0,mt:Pe})}function Ds(H,le){var ae=le||{},Z=[],oe=[],de=Je(1),Oe=ae.compression?8:0,Pe=0,Ce=0,De=0,Me=0,$e=0,ft=H.FullPaths[0],xt=ft,ot=H.FileIndex[0],mt=[],Kt=0;for(Ce=1;Ce<H.FullPaths.length;++Ce)if(xt=H.FullPaths[Ce].slice(ft.length),ot=H.FileIndex[Ce],!(!ot.size||!ot.content||xt=="Sh33tJ5")){var yr=Me,Cr=Je(xt.length);for(De=0;De<xt.length;++De)Cr.write_shift(1,xt.charCodeAt(De)&127);Cr=Cr.slice(0,Cr.l),mt[$e]=T3.buf(ot.content,0);var ya=ot.content;Oe==8&&(ya=j(ya)),de=Je(30),de.write_shift(4,67324752),de.write_shift(2,20),de.write_shift(2,Pe),de.write_shift(2,Oe),ot.mt?i(de,ot.mt):de.write_shift(4,0),de.write_shift(-4,mt[$e]),de.write_shift(4,ya.length),de.write_shift(4,ot.content.length),de.write_shift(2,Cr.length),de.write_shift(2,0),Me+=de.length,Z.push(de),Me+=Cr.length,Z.push(Cr),Me+=ya.length,Z.push(ya),de=Je(46),de.write_shift(4,33639248),de.write_shift(2,0),de.write_shift(2,20),de.write_shift(2,Pe),de.write_shift(2,Oe),de.write_shift(4,0),de.write_shift(-4,mt[$e]),de.write_shift(4,ya.length),de.write_shift(4,ot.content.length),de.write_shift(2,Cr.length),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(4,0),de.write_shift(4,yr),Kt+=de.l,oe.push(de),Kt+=Cr.length,oe.push(Cr),++$e}return de=Je(22),de.write_shift(4,101010256),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,$e),de.write_shift(2,$e),de.write_shift(4,Kt),de.write_shift(4,Me),de.write_shift(2,0),xn([xn(Z),xn(oe),de])}var Ur={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $t(H,le){if(H.ctype)return H.ctype;var ae=H.name||"",Z=ae.match(/\.([^\.]+)$/);return Z&&Ur[Z[1]]||le&&(Z=(ae=le).match(/[\.\\]([^\.\\])+$/),Z&&Ur[Z[1]])?Ur[Z[1]]:"application/octet-stream"}function Er(H){for(var le=Df(H),ae=[],Z=0;Z<le.length;Z+=76)ae.push(le.slice(Z,Z+76));return ae.join(`\r
`)+`\r
`}function ii(H){var le=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(De){var Me=De.charCodeAt(0).toString(16).toUpperCase();return"="+(Me.length==1?"0"+Me:Me)});le=le.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),le.charAt(0)==`
`&&(le="=0D"+le.slice(1)),le=le.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],Z=le.split(`\r
`),oe=0;oe<Z.length;++oe){var de=Z[oe];if(de.length==0){ae.push("");continue}for(var Oe=0;Oe<de.length;){var Pe=76,Ce=de.slice(Oe,Oe+Pe);Ce.charAt(Pe-1)=="="?Pe--:Ce.charAt(Pe-2)=="="?Pe-=2:Ce.charAt(Pe-3)=="="&&(Pe-=3),Ce=de.slice(Oe,Oe+Pe),Oe+=Pe,Oe<de.length&&(Ce+="="),ae.push(Ce)}}return ae.join(`\r
`)}function xa(H){for(var le=[],ae=0;ae<H.length;++ae){for(var Z=H[ae];ae<=H.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+H[++ae];le.push(Z)}for(var oe=0;oe<le.length;++oe)le[oe]=le[oe].replace(/[=][0-9A-Fa-f]{2}/g,function(de){return String.fromCharCode(parseInt(de.slice(1),16))});return Ys(le.join(`\r
`))}function vs(H,le,ae){for(var Z="",oe="",de="",Oe,Pe=0;Pe<10;++Pe){var Ce=le[Pe];if(!Ce||Ce.match(/^\s*$/))break;var De=Ce.match(/^(.*?):\s*([^\s].*)$/);if(De)switch(De[1].toLowerCase()){case"content-location":Z=De[2].trim();break;case"content-type":de=De[2].trim();break;case"content-transfer-encoding":oe=De[2].trim();break}}switch(++Pe,oe.toLowerCase()){case"base64":Oe=Ys(ni(le.slice(Pe).join("")));break;case"quoted-printable":Oe=xa(le.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+oe)}var Me=Ja(H,Z.slice(ae.length),Oe,{unsafe:!0});de&&(Me.ctype=de)}function ws(H,le){if(V(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=le&&le.root||"",Z=(ur&&Buffer.isBuffer(H)?H.toString("binary"):V(H)).split(`\r
`),oe=0,de="";for(oe=0;oe<Z.length;++oe)if(de=Z[oe],!!/^Content-Location:/i.test(de)&&(de=de.slice(de.indexOf("file")),ae||(ae=de.slice(0,de.lastIndexOf("/")+1)),de.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),de.slice(0,ae.length)!=ae););var Oe=(Z[1]||"").match(/boundary="(.*?)"/);if(!Oe)throw new Error("MAD cannot find boundary");var Pe="--"+(Oe[1]||""),Ce=[],De=[],Me={FileIndex:Ce,FullPaths:De};b(Me);var $e,ft=0;for(oe=0;oe<Z.length;++oe){var xt=Z[oe];xt!==Pe&&xt!==Pe+"--"||(ft++&&vs(Me,Z.slice($e,oe),ae),$e=oe)}return Me}function Dt(H,le){var ae=le||{},Z=ae.boundary||"SheetJS";Z="------="+Z;for(var oe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],de=H.FullPaths[0],Oe=de,Pe=H.FileIndex[0],Ce=1;Ce<H.FullPaths.length;++Ce)if(Oe=H.FullPaths[Ce].slice(de.length),Pe=H.FileIndex[Ce],!(!Pe.size||!Pe.content||Oe=="Sh33tJ5")){Oe=Oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Kt){return"_x"+Kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Kt){return"_u"+Kt.charCodeAt(0).toString(16)+"_"});for(var De=Pe.content,Me=ur&&Buffer.isBuffer(De)?De.toString("binary"):V(De),$e=0,ft=Math.min(1024,Me.length),xt=0,ot=0;ot<=ft;++ot)(xt=Me.charCodeAt(ot))>=32&&xt<128&&++$e;var mt=$e>=ft*4/5;oe.push(Z),oe.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Oe),oe.push("Content-Transfer-Encoding: "+(mt?"quoted-printable":"base64")),oe.push("Content-Type: "+$t(Pe,Oe)),oe.push(""),oe.push(mt?ii(Me):Er(Me))}return oe.push(Z+`--\r
`),oe.join(`\r
`)}function ns(H){var le={};return b(le,H),le}function Ja(H,le,ae,Z){var oe=Z&&Z.unsafe;oe||b(H);var de=!oe&&Ut.find(H,le);if(!de){var Oe=H.FullPaths[0];le.slice(0,Oe.length)==Oe?Oe=le:(Oe.slice(-1)!="/"&&(Oe+="/"),Oe=(Oe+le).replace("//","/")),de={name:n(le),type:2},H.FileIndex.push(de),H.FullPaths.push(Oe),oe||Ut.utils.cfb_gc(H)}return de.content=ae,de.size=ae?ae.length:0,Z&&(Z.CLSID&&(de.clsid=Z.CLSID),Z.mt&&(de.mt=Z.mt),Z.ct&&(de.ct=Z.ct)),de}function Za(H,le){b(H);var ae=Ut.find(H,le);if(ae){for(var Z=0;Z<H.FileIndex.length;++Z)if(H.FileIndex[Z]==ae)return H.FileIndex.splice(Z,1),H.FullPaths.splice(Z,1),!0}return!1}function Aa(H,le,ae){b(H);var Z=Ut.find(H,le);if(Z){for(var oe=0;oe<H.FileIndex.length;++oe)if(H.FileIndex[oe]==Z)return H.FileIndex[oe].name=n(ae),H.FullPaths[oe]=ae,!0}return!1}function ge(H){_(H,!0)}return t.find=I,t.read=B,t.parse=d,t.write=G,t.writeFile=ee,t.utils={cfb_new:ns,cfb_add:Ja,cfb_del:Za,cfb_mov:Aa,cfb_gc:ge,ReadShift:cf,CheckField:J_,prep_blob:Sn,bconcat:xn,use_zlib:C,_deflateRaw:ut,_inflateRaw:nr,consts:Y},t}();let Kl;function O3(e){Kl=e}function I3(e){return typeof e=="string"?s0(e):Array.isArray(e)?t3(e):e}function o0(e,t,r){if(typeof Kl<"u"&&Kl.writeFileSync)return r?Kl.writeFileSync(e,t,r):Kl.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?uo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([I3(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=uc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function N3(e){if(typeof Kl<"u")return Kl.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Oa(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function l4(e,t){for(var r=[],a=Oa(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function ym(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function vm(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function F3(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Ih=new Date(1899,11,30,0,0,0);function ln(e,t){var r=e.getTime(),a=Ih.getTime()+(e.getTimezoneOffset()-Ih.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var D_=new Date,R3=Ih.getTime()+(D_.getTimezoneOffset()-Ih.getTimezoneOffset())*6e4,c4=D_.getTimezoneOffset();function wm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+R3),t.getTimezoneOffset()!==c4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-c4)*6e4),t}function k3(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var A4=new Date("2017-02-19T19:06:09.000Z"),j_=isNaN(A4.getFullYear())?new Date("2/19/17"):A4,D3=j_.getFullYear()==2017;function ca(e,t){var r=new Date(e);if(D3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(j_.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function iA(e,t){if(ur&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return uo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return uo(E_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return uo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return uo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function ta(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ta(e[r]));return t}function Ca(e,t){for(var r="";r.length<t;)r+=e;return r}function Hi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var j3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qd(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&j3.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var L3=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}}();function L_(e){return e?e.content&&e.type?iA(e.content,!0):e.data?yd(e.data):e.asNodeBuffer&&ur?yd(e.asNodeBuffer().toString("binary")):e.asBinary?yd(e.asBinary()):e._data&&e._data.getContent?yd(iA(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function U_(e){if(!e)return null;if(e.data)return Bh(e.data);if(e.asNodeBuffer&&ur)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Bh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function U3(e){return e&&e.name.slice(-4)===".bin"?U_(e):L_(e)}function wi(e,t){for(var r=e.FullPaths||Oa(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function H2(e,t){var r=wi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function $a(e,t,r){if(!r)return U3(H2(e,t));if(!t)return null;try{return $a(e,t)}catch{return null}}function Ws(e,t,r){if(!r)return L_(H2(e,t));if(!t)return null;try{return Ws(e,t)}catch{return null}}function M3(e,t,r){return U_(H2(e,t))}function d4(e){for(var t=e.FullPaths||Oa(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ar(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return ur?a=sl(r):a=r3(r),Ut.utils.cfb_add(e,t,a)}Ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function G2(){return Ut.utils.cfb_new()}function M_(e,t){switch(t.type){case"base64":return Ut.read(e,{type:"base64"});case"binary":return Ut.read(e,{type:"binary"});case"buffer":case"array":return Ut.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function zu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Qa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,P3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,u4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Q3=/<[^>]*>/g,rs=Qa.match(u4)?u4:Q3,q3=/<\w*:/,K3=/<(\/?)\w+:/;function Jt(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(P3),l=0,c="",A=0,d="",f="",p=1;if(o)for(A=0;A!=o.length;++A){for(f=o[A],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(p=(n=f.charCodeAt(i+1))==34||n==39?1:0,c=f.slice(i+1+p,f.length-p),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,a[d.toLowerCase()]=c;else{var u=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(a[u]&&d.slice(l-3,l)=="ext")continue;a[u]=c,a[u.toLowerCase()]=c}}return a}function vo(e){return e.replace(K3,"<$1")}var P_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},z2=ym(P_),Tr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(l,c){return P_[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}}(),V2=/[&<>'"]/g,H3=/[\u0000-\u0008\u000b-\u001f]/g;function Hr(e){var t=e+"";return t.replace(V2,function(r){return z2[r]}).replace(H3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function f4(e){return Hr(e).replace(/ /g,"_x0020_")}var Q_=/[\u0000-\u001f]/g;function $2(e){var t=e+"";return t.replace(V2,function(r){return z2[r]}).replace(/\n/g,"<br/>").replace(Q_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function G3(e){var t=e+"";return t.replace(V2,function(r){return z2[r]}).replace(Q_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var p4=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function z3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sa(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ng(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function h4(e){var t=nc(2*e.length),r,a,n=1,i=0,o=0,l;for(a=0;a<e.length;a+=n)n=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function m4(e){return sl(e,"binary").toString("utf8")}var op="foo bar bazâð£",Vr=ur&&(m4(op)==Ng(op)&&m4||h4(op)==Ng(op)&&h4)||Ng,uo=ur?function(e){return sl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Lf=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),q_=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),V3=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),$3=/<\/?(?:vt:)?variant>/g,Y3=/<(?:vt:)([^>]*)>([\s\S]*)</;function g4(e,t){var r=Jt(e),a=e.match(V3(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var o=i.replace($3,"").match(Y3);o&&n.push({v:Vr(o[2]),t:o[1]})}),n}var K_=/(^\s|\s$|\n)/;function On(e,t){return"<"+e+(t.match(K_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Uf(e){return Oa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function gt(e,t,r){return"<"+e+(r!=null?Uf(r):"")+(t!=null?(t.match(K_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function W3(e,t){switch(typeof e){case"string":var r=gt("vt:lpwstr",Hr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return gt((e|0)==e?"vt:i4":"vt:r8",Hr(String(e)));case"boolean":return gt("vt:bool",e?"true":"false")}if(e instanceof Date)return gt("vt:filetime",Sx(e));throw new Error("Unable to serialize "+e)}function Y2(e){if(ur&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Vr(uc(Q2(e)));throw new Error("Bad input format: expected Buffer or string")}var Mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X3(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function J3(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=a?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var x4=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},y4=ur?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:sl(t)})):x4(e)}:x4,v4=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(zo(e,n)));return a.join("").replace(Jn,"")},Em=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Jn,""):v4(e,t,r)}:v4,w4=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},H_=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):w4(e,t,r)}:w4,E4=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(ud(e,n)));return a.join("")},Yd=ur?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):E4(t,r,a)}:E4,G_=function(e,t){var r=gn(e,t);return r>0?Yd(e,t+4,t+4+r-1):""},W2=G_,z_=function(e,t){var r=gn(e,t);return r>0?Yd(e,t+4,t+4+r-1):""},X2=z_,V_=function(e,t){var r=2*gn(e,t);return r>0?Yd(e,t+4,t+4+r-1):""},J2=V_,$_=function(t,r){var a=gn(t,r);return a>0?Em(t,r+4,r+4+a):""},Z2=$_,Y_=function(e,t){var r=gn(e,t);return r>0?Yd(e,t+4,t+4+r):""},ey=Y_,W_=function(e,t){return X3(e,t)},Nh=W_,ty=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ur&&(W2=function(t,r){if(!Buffer.isBuffer(t))return G_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},X2=function(t,r){if(!Buffer.isBuffer(t))return z_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},J2=function(t,r){if(!Buffer.isBuffer(t))return V_(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Z2=function(t,r){if(!Buffer.isBuffer(t))return $_(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},ey=function(t,r){if(!Buffer.isBuffer(t))return Y_(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Nh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):W_(t,r)},ty=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function X_(){Em=function(e,t,r){return _r.utils.decode(1200,e.slice(t,r)).replace(Jn,"")},Yd=function(e,t,r){return _r.utils.decode(65001,e.slice(t,r))},W2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(nA,e.slice(t+4,t+4+r-1)):""},X2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(ei,e.slice(t+4,t+4+r-1)):""},J2=function(e,t){var r=2*gn(e,t);return r>0?_r.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Z2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(1200,e.slice(t+4,t+4+r)):""},ey=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof _r<"u"&&X_();var ud=function(e,t){return e[t]},zo=function(e,t){return e[t+1]*256+e[t]},Z3=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},gn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Dc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function cf(e,t){var r="",a,n,i=[],o,l,c,A;switch(t){case"dbcs":if(A=this.l,ur&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(zo(this,A)),A+=2;e*=2;break;case"utf8":r=Yd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Em(this,this.l,this.l+e);break;case"wstr":if(typeof _r<"u")r=_r.utils.decode(ei,this.slice(this.l,this.l+2*e));else return cf.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=W2(this,this.l),e=4+gn(this,this.l);break;case"lpstr-cp":r=X2(this,this.l),e=4+gn(this,this.l);break;case"lpwstr":r=J2(this,this.l),e=4+2*gn(this,this.l);break;case"lpp4":e=4+gn(this,this.l),r=Z2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+gn(this,this.l),r=ey(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ud(this,this.l+e++))!==0;)i.push(Hu(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=zo(this,this.l+e))!==0;)i.push(Hu(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=ud(this,A),this.l=A+1,l=cf.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Hu(zo(this,A))),A+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof _r<"u"){r=_r.utils.decode(ei,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",A=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=ud(this,A),this.l=A+1,l=cf.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Hu(ud(this,A))),A+=1}r=i.join("");break;default:switch(e){case 1:return a=ud(this,this.l),this.l++,a;case 2:return a=(t==="i"?Z3:zo)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Dc:eN)(this,this.l),this.l+=4,a):(n=gn(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Nh(this,this.l):n=Nh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=H_(this,this.l,e);break}}return this.l+=e,r}var tN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},rN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},aN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function nN(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)aN(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){if(typeof _r<"u"&&nA==874)for(n=0;n!=t.length;++n){var i=_r.utils.encode(nA,t.charAt(n));this[this.l+n]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,tN(this,t,this.l);break;case 8:if(a=8,r==="f"){J3(this,t,this.l);break}case 16:break;case-4:a=4,rN(this,t,this.l);break}return this.l+=a,this}function J_(e,t){var r=H_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Sn(e,t){e.l=t,e.read_shift=cf,e.chk=J_,e.write_shift=nN}function ts(e,t){e.l+=t}function Je(e){var t=nc(e);return Sn(t,0),t}function il(e,t,r){if(e){var a,n,i;Sn(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var A=Gf[l]||Gf[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=A.f&&A.f(e,i,r);if(e.l=c,t(d,A,l))return}}}function Fs(){var e=[],t=ur?256:2048,r=function(A){var d=Je(A);return Sn(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(A){return a&&A<a.length-a.l?a:(n(),a=r(Math.max(A+1,t)))},o=function(){return n(),xn(e)},l=function(A){n(),a=A,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function st(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=Gf[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&ty(r)&&e.push(r)}}function Af(e,t,r){var a=ta(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function b4(e,t,r){var a=ta(e);return a.s=Af(a.s,t.s,r),a.e=Af(a.e,t.s,r),a}function df(e,t){if(e.cRel&&e.c<0)for(e=ta(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ta(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Wt(e);return!e.cRel&&e.cRel!=null&&(r=oN(r)),!e.rRel&&e.rRel!=null&&(r=sN(r)),r}function Fg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+la(e.s.c)+":"+(e.e.cRel?"":"$")+la(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sa(e.s.r)+":"+(e.e.rRel?"":"$")+Sa(e.e.r):df(e.s,t.biff)+":"+df(e.e,t.biff)}function ry(e){return parseInt(iN(e),10)-1}function Sa(e){return""+(e+1)}function sN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iN(e){return e.replace(/\$(\d+)$/,"$1")}function ay(e){for(var t=lN(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function la(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oN(e){return e.replace(/^([A-Z])/,"$$$1")}function lN(e){return e.replace(/^\$([A-Z])/,"$1")}function cN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ga(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Wt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function xs(e){var t=e.indexOf(":");return t==-1?{s:ga(e),e:ga(e)}:{s:ga(e.slice(0,t)),e:ga(e.slice(t+1))}}function lr(e,t){return typeof t>"u"||typeof t=="number"?lr(e.s,e.e):(typeof e!="string"&&(e=Wt(e)),typeof t!="string"&&(t=Wt(t)),e==t?e:e+":"+t)}function xr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function _4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=si(e.z,r?ln(t):t)}catch{}try{return e.w=si((e.XF||{}).numFmtId||(r?14:0),r?ln(t):t)}catch{return""+t}}function xo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ol[e.v]||e.v:t==null?_4(e,e.v):_4(e,t))}function fc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Z_(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?ga(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=xr(i["!ref"]);A.s.c=d.s.c,A.s.r=d.s.r,A.e.c=Math.max(A.e.c,d.e.c),A.e.r=Math.max(A.e.r,d.e.r),o==-1&&(A.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var u={v:t[f][p]},g=o+f,h=l+p;if(A.s.r>g&&(A.s.r=g),A.s.c>h&&(A.s.c=h),A.e.r<g&&(A.e.r=g),A.e.c<h&&(A.e.c=h),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))u=t[f][p];else if(Array.isArray(u.v)&&(u.f=t[f][p][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(a.nullError)u.t="e",u.v=0;else if(a.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=a.dateNF||zt[14],a.cellDates?(u.t="d",u.w=si(u.z,ln(u.v))):(u.t="n",u.v=ln(u.v),u.w=si(u.z,u.v))):u.t="s";if(n)i[g]||(i[g]=[]),i[g][h]&&i[g][h].z&&(u.z=i[g][h].z),i[g][h]=u;else{var x=Wt({c:h,r:g});i[x]&&i[x].z&&(u.z=i[x].z),i[x]=u}}}return A.s.c<1e7&&(i["!ref"]=lr(A)),i}function Wd(e,t){return Z_(null,e,t)}function AN(e){return e.read_shift(4,"i")}function Gi(e,t){return t||(t=Je(4)),t.write_shift(4,e),t}function Zn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function vn(e,t){var r=!1;return t==null&&(r=!0,t=Je(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function uN(e,t){return t||(t=Je(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ny(e,t){var r=e.l,a=e.read_shift(1),n=Zn(e),i=[],o={t:n,h:n};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(dN(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function fN(e,t){var r=!1;return t==null&&(r=!0,t=Je(15+4*e.t.length)),t.write_shift(1,0),vn(e.t,t),r?t.slice(0,t.l):t}var pN=ny;function hN(e,t){var r=!1;return t==null&&(r=!0,t=Je(23+4*e.t.length)),t.write_shift(1,1),vn(e.t,t),t.write_shift(4,1),uN({},t),r?t.slice(0,t.l):t}function Ni(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function hA(e,t){return t==null&&(t=Je(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function mA(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function gA(e,t){return t==null&&(t=Je(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var mN=Zn,e5=vn;function sy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fh(e,t){var r=!1;return t==null&&(r=!0,t=Je(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var gN=Zn,Tx=sy,iy=Fh;function oy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Nh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Dc(t,0)>>2;return r?n/100:n}function t5(e,t){t==null&&(t=Je(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function r5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function xN(e,t){return t||(t=Je(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var xA=r5,Xd=xN;function Yn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oA(e,t){return(t||Je(8)).write_shift(8,e,"f")}function yN(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var A=Vc[n];A&&(t.rgb=Qf(A));break;case 2:t.rgb=Qf([o,l,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Rh(e,t){if(t||(t=Je(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function vN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function wN(e,t){t||(t=Je(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function a5(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function EN(e){return a5(e,1)}function bN(e){return a5(e,2)}var ly=2,Os=3,lp=11,C4=12,kh=19,cp=64,_N=65,CN=71,BN=4108,SN=4126,hn=80,n5=81,TN=[hn,n5],Ox={1:{n:"CodePage",t:ly},2:{n:"Category",t:hn},3:{n:"PresentationFormat",t:hn},4:{n:"ByteCount",t:Os},5:{n:"LineCount",t:Os},6:{n:"ParagraphCount",t:Os},7:{n:"SlideCount",t:Os},8:{n:"NoteCount",t:Os},9:{n:"HiddenCount",t:Os},10:{n:"MultimediaClipCount",t:Os},11:{n:"ScaleCrop",t:lp},12:{n:"HeadingPairs",t:BN},13:{n:"TitlesOfParts",t:SN},14:{n:"Manager",t:hn},15:{n:"Company",t:hn},16:{n:"LinksUpToDate",t:lp},17:{n:"CharacterCount",t:Os},19:{n:"SharedDoc",t:lp},22:{n:"HyperlinksChanged",t:lp},23:{n:"AppVersion",t:Os,p:"version"},24:{n:"DigSig",t:_N},26:{n:"ContentType",t:hn},27:{n:"ContentStatus",t:hn},28:{n:"Language",t:hn},29:{n:"Version",t:hn},255:{},2147483648:{n:"Locale",t:kh},2147483651:{n:"Behavior",t:kh},1919054434:{}},Ix={1:{n:"CodePage",t:ly},2:{n:"Title",t:hn},3:{n:"Subject",t:hn},4:{n:"Author",t:hn},5:{n:"Keywords",t:hn},6:{n:"Comments",t:hn},7:{n:"Template",t:hn},8:{n:"LastAuthor",t:hn},9:{n:"RevNumber",t:hn},10:{n:"EditTime",t:cp},11:{n:"LastPrinted",t:cp},12:{n:"CreatedDate",t:cp},13:{n:"ModifiedDate",t:cp},14:{n:"PageCount",t:Os},15:{n:"WordCount",t:Os},16:{n:"CharCount",t:Os},17:{n:"Thumbnail",t:CN},18:{n:"Application",t:hn},19:{n:"DocSecurity",t:Os},255:{},2147483648:{n:"Locale",t:kh},2147483651:{n:"Behavior",t:kh},1919054434:{}},B4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ON=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var NN=IN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vc=ta(NN),ol={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},s5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Nx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ap={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FN(e){var t=cy();if(!e||!e.match)return t;var r={};if((e.match(rs)||[]).forEach(function(a){var n=Jt(a);switch(n[0].replace(q3,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Nx[n.ContentType]]!==void 0&&t[Nx[n.ContentType]].push(n.PartName);break}}),t.xmlns!==sn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function i5(e,t){var r=F3(Nx),a=[],n;a[a.length]=Qa,a[a.length]=gt("Types",null,{xmlns:sn.CT,"xmlns:xsd":sn.xsd,"xmlns:xsi":sn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return gt("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=gt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Ap[c][t.bookType]||Ap[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(A){a[a.length]=gt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:Ap[c][t.bookType]||Ap[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(A){a[a.length]=gt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var fr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function uf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(rs)||[]).forEach(function(n){var i=Jt(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:zu(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function Td(e){var t=[Qa,gt("Relationships",null,{xmlns:sn.RELS})];return Oa(e["!id"]).forEach(function(r){t[t.length]=gt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function qr(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[fr.HLINK,fr.XPATH,fr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var RN="application/vnd.oasis.opendocument.spreadsheet";function kN(e,t){for(var r=Y2(e),a,n;a=Mf.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Jt(a[0],!1),n.path=="/"&&n.type!==RN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function DN(e){var t=[Qa];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function S4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function LN(e){var t=[Qa];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(S4(e[r][0],e[r][1])),t.push(jN("",e[r][0]));return t.push(S4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function o5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kf.version+"</meta:generator></office:meta></office:document-meta>"}var Ti=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],UN=function(){for(var e=new Array(Ti.length),t=0;t<Ti.length;++t){var r=Ti[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function l5(e){var t={};e=Vr(e);for(var r=0;r<Ti.length;++r){var a=Ti[r],n=e.match(UN[r]);n!=null&&n.length>0&&(t[a[1]]=Tr(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=ca(t[a[1]]))}return t}function Rg(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Hr(t),a[a.length]=r?gt(e,t,r):On(e,t))}function c5(e,t){var r=t||{},a=[Qa,gt("cp:coreProperties",null,{"xmlns:cp":sn.CORE_PROPS,"xmlns:dc":sn.dc,"xmlns:dcterms":sn.dcterms,"xmlns:dcmitype":sn.dcmitype,"xmlns:xsi":sn.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Rg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sx(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Rg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sx(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Ti.length;++i){var o=Ti[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Rg(o[0],l,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var $c=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],A5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function d5(e,t,r,a){var n=[];if(typeof e=="string")n=g4(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?g4(t,a).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var A=0;A!==n.length;A+=2){switch(c=+n[A+1].v,n[A].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function MN(e,t,r){var a={};return t||(t={}),e=Vr(e),$c.forEach(function(n){var i=(e.match(Lf(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Tr(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&d5(a.HeadingPairs,a.TitlesOfParts,t,r),t}function u5(e){var t=[],r=gt;return e||(e={}),e.Application="SheetJS",t[t.length]=Qa,t[t.length]=gt("Properties",null,{xmlns:sn.EXT_PROPS,"xmlns:vt":sn.vt}),$c.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Hr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Hr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var PN=/<[^>]+>[^<]*/g;function QN(e,t){var r={},a="",n=e.match(PN);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=Jt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Tr(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),d=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[a]=Tr(d);break;case"bool":r[a]=sa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=ca(d);break;case"cy":case"error":r[a]=Tr(d);break;default:if(A.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function f5(e){var t=[Qa,gt("Properties",null,{xmlns:sn.CUST_PROPS,"xmlns:vt":sn.vt})];if(!e)return t.join("");var r=1;return Oa(e).forEach(function(n){++r,t[t.length]=gt("property",W3(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Hr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Fx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},kg;function qN(e,t,r){kg||(kg=ym(Fx)),t=kg[t]||t,e[t]=r}function KN(e,t){var r=[];return Oa(Fx).map(function(a){for(var n=0;n<Ti.length;++n)if(Ti[n][1]==a)return Ti[n];for(n=0;n<$c.length;++n)if($c[n][1]==a)return $c[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(On(Fx[a[1]]||a[1],n))}}),gt("DocumentProperties",r.join(""),{xmlns:Vs.o})}function HN(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Oa(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ti.length;++o)if(i==Ti[o][1])return;for(o=0;o<$c.length;++o)if(i==$c[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(gt(f4(i),l,{"dt:dt":c}))}}),t&&Oa(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(gt(f4(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+Vs.o+'">'+n.join("")+"</"+a+">"}function Ay(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function GN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var o=Je(8);return o.write_shift(4,a),o.write_shift(4,n),o}function p5(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function h5(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function m5(e,t,r){return t===31?h5(e):p5(e,t,r)}function Rx(e,t,r){return m5(e,t,r===!1?0:4)}function zN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return m5(e,t,0)}function VN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Jn,""),e.l-n&2&&(e.l+=2)}return r}function $N(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Jn,"");return r}function YN(e){var t=e.l,r=Dh(e,n5);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Dh(e,Os);return[r,a]}function WN(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(YN(e));return r}function T4(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Jn,"").replace(Gu,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function g5(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function XN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Dh(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==C4&&a!==t&&TN.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===C4?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return p5(e,a,4).replace(Jn,"");case 31:return h5(e);case 64:return Ay(e);case 65:return g5(e);case 71:return XN(e);case 80:return Rx(e,a,!i.raw).replace(Jn,"");case 81:return zN(e,a).replace(Jn,"");case 4108:return WN(e);case 4126:case 4127:return a==4127?VN(e):$N(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function O4(e,t){var r=Je(4),a=Je(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Je(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=GN(t);break;case 31:case 80:for(a=Je(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xn([r,a])}function I4(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0,l=0,c=-1,A={};for(o=0;o!=n;++o){var d=e.read_shift(4),f=e.read_shift(4);i[o]=[d,f+r]}i.sort(function(v,E){return v[1]-E[1]});var p={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var u=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,u=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],u=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],u=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(u=!1,e.l=i[o][1]),u)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[i[o][0]];if(p[g.n]=Dh(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ci(l=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(i[o][0]===1){if(l=p.CodePage=Dh(e,ly),Ci(l),c!==-1){var h=e.l;e.l=i[c][1],A=T4(e,l),e.l=h}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}A=T4(e,l)}else{var x=A[i[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=g5(e);break;case 30:e.l+=4,y=Rx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Rx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Ra(e,4);break;case 64:e.l+=4,y=ca(Ay(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[x]=y}}return e.l=r+a,p}var x5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function N4(e,t,r){var a=Je(8),n=[],i=[],o=8,l=0,c=Je(8),A=Je(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),i.push(c),n.push(A),o+=8+c.length,!t){A=Je(8),A.write_shift(4,0),n.unshift(A);var d=[Je(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=Je(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=xn(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(x5.indexOf(e[l][0])>-1||A5.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],u=0;if(t){u=+t[e[l][0]];var g=r[u];if(g.p=="version"&&typeof p=="string"){var h=p.split(".");p=(+h[0]<<16)+(+h[1]||0)}c=O4(g.t,p)}else{var x=JN(p);x==-1&&(x=31,p=String(p)),c=O4(x,p)}i.push(c),A=Je(8),A.write_shift(4,t?u:2+l),n.push(A),o+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,y),y+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),xn([a].concat(n).concat(i))}function F4(e,t,r){var a=e.content;if(!a)return{};Sn(a,0);var n,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var A=a.read_shift(4),d=a.read_shift(16);if(d!==Ut.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=I4(a,t),p={SystemIdentifier:A};for(var u in f)p[u]=f[u];if(p.FMTID=i,n===1)return p;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var g;try{g=I4(a,null)}catch{}for(u in g)p[u]=g[u];return p.FMTID=[i,o],p}function R4(e,t,r,a,n,i){var o=Je(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ut.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=N4(e,r,a);if(l.push(c),n){var A=N4(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(A)}return xn(l)}function Cl(e,t){return e.read_shift(t),null}function ZN(e,t){t||(t=Je(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function eF(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Ra(e,t){return e.read_shift(t)===1}function us(e,t){return t||(t=Je(2)),t.write_shift(2,+!!e),t}function Ya(e){return e.read_shift(2,"u")}function bi(e,t){return t||(t=Je(2)),t.write_shift(2,e),t}function y5(e,t){return eF(e,t,Ya)}function tF(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function v5(e,t,r){return r||(r=Je(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function l0(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",i=ei;if(r&&r.biff>=8&&(ei=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return ei=i,l}function rF(e){var t=ei;ei=1200;var r=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,o=1+(a&1),l=0,c,A={};i&&(l=e.read_shift(2)),n&&(c=e.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*l),n&&(e.l+=c),A.t=f,i||(A.raw="<t>"+A.t+"</t>",A.r=A.t),ei=t,A}function aF(e){var t=e.t||"",r=Je(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Je(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return xn(n)}function lA(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function c0(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):lA(e,a,r)}function yA(e,t,r){if(r.biff>5)return c0(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function w5(e,t,r){return r||(r=Je(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function nF(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sF(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Jn,"");return a&&(e.l+=24),n}function iF(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Jn,"");return r+o}function oF(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sF(e);case"0303000000000000c000000000000046":return iF(e);default:throw new Error("Unsupported Moniker "+r)}}function dp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Jn,""):"";return r}function k4(e,t){t||(t=Je(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function lF(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,o,l,c,A="",d,f;n&16&&(i=dp(e,r-e.l)),n&128&&(o=dp(e,r-e.l)),(n&257)===257&&(l=dp(e,r-e.l)),(n&257)===1&&(c=oF(e,r-e.l)),n&8&&(A=dp(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Ay(e)),e.l=r;var p=o||l||c||"";p&&A&&(p+="#"+A),p||(p="#"+A),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var u={Target:p};return d&&(u.guid=d),f&&(u.time=f),i&&(u.Tooltip=i),u}function cF(e){var t=Je(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),k4(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&k4(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function E5(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function b5(e,t){var r=E5(e);return r[3]=0,r}function wo(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function cA(e,t,r,a){return a||(a=Je(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function AF(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dF(e,t,r){return t===0?"":yA(e,t,r)}function uF(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,i,o]}function _5(e){var t=e.read_shift(2),r=oy(e);return[t,r]}function fF(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=l0(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function bm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function C5(e,t){return t||(t=Je(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function B5(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var pF=B5;function S5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function hF(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function mF(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function jn(e){e.l+=2,e.l+=e.read_shift(2)}var gF={0:jn,4:jn,5:jn,6:jn,7:mF,8:jn,9:jn,10:jn,11:jn,12:jn,13:hF,14:jn,15:jn,16:jn,17:jn,18:jn,19:jn,20:jn,21:S5};function xF(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(gF[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function up(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function dy(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Je(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function yF(e,t){return t===0||e.read_shift(2),1200}function vF(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=yA(e,0,r);return e.read_shift(t+a-e.l),n}function wF(e,t){var r=!t||t.biff==8,a=Je(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function EF(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function bF(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=l0(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:i,name:o}}function _F(e,t){var r=!t||t.biff>=8?2:1,a=Je(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function CF(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(rF(e));return i.Count=a,i.Unique=n,i}function BF(e,t){var r=Je(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=aF(e[n]);var i=xn([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function SF(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function TF(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function OF(e){var t=AF(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function IF(e){return e.read_shift(2),e.read_shift(4)}function D4(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function NF(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),A=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function FF(){var e=Je(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RF(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function kF(e){var t=Je(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DF(){}function jF(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=l0(e,0,r),a}function LF(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=Je(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function UF(e){var t=wo(e);return t.isst=e.read_shift(4),t}function MF(e,t,r,a){var n=Je(10);return cA(e,t,a,n),n.write_shift(4,r),n}function PF(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=wo(e);r.biff==2&&e.l++;var i=c0(e,a-e.l,r);return n.val=i,n}function QF(e,t,r,a,n){var i=!n||n.biff==8,o=Je(8+ +i+(1+i)*r.length);return cA(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function qF(e,t,r){var a=e.read_shift(2),n=yA(e,0,r);return[a,n]}function KF(e,t,r,a){var n=r&&r.biff==5;a||(a=Je(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var HF=yA;function j4(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function GF(e,t){var r=t.biff==8||!t.biff?4:2,a=Je(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function zF(e){var t=e.read_shift(2),r=e.read_shift(2),a=_5(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function VF(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(_5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:i}}function $F(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:i}}function YF(e,t,r,a){var n={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=ON[l>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function WF(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=YF(e,t,a.fStyle,r),a}function L4(e,t,r,a){var n=r&&r.biff==5;a||(a=Je(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function XF(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function JF(e){var t=Je(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function U4(e,t,r){var a=wo(e);(r.biff==2||t==9)&&++e.l;var n=tF(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function ZF(e,t,r,a,n,i){var o=Je(8);return cA(e,t,a,o),v5(r,i,o),o}function eR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=wo(e),n=Yn(e);return a.val=n,a}function tR(e,t,r,a){var n=Je(14);return cA(e,t,a,n),oA(r,n),n}var M4=dF;function rR(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=lA(e,i),l=[];a>e.l;)l.push(c0(e));return[i,n,o,l]}function P4(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=fF(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var aR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Q4(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var A=lA(e,o,r);n&32&&(A=aR[A.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var f=a==e.l||l===0||!(d>0)?[]:xj(e,d,r,l);return{chKey:i,Name:A,itab:c,rgce:f}}function T5(e,t,r){if(r.biff<8)return nR(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(uF(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function nR(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=l0(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function sR(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=lA(e,a,r),o=lA(e,n,r);return[i,o]}function iR(e,t,r){var a=B5(e);e.l++;var n=e.read_shift(1);return t-=8,[yj(e,t,r),n,a]}function q4(e,t,r){var a=pF(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,mj(e,t,r)]}function oR(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function lR(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=yA(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,o,i]}}function cR(e,t,r){return lR(e,t,r)}function AR(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(bm(e));return r}function dR(e){var t=Je(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)C5(e[r],t);return t}function uR(e,t,r){if(r&&r.biff<8)return pR(e,t,r);var a=S5(e),n=xF(e,t-22,a[1]);return{cmo:a,ft:n}}var fR={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function pR(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((fR[a]||ts)(e,t,r)),{cmo:[n,a,i],ft:o}}function hR(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=nF(e,6,r);var l=e.read_shift(2);e.read_shift(2),Ya(e,2);var c=e.read_shift(2);e.l+=c;for(var A=1;A<e.lens.length-1;++A){if(e.l-a!=e.lens[A])throw new Error("TxO: bad continue record");var d=e[e.l],f=lA(e,e.lens[A+1]-e.lens[A]-1);if(n+=f,n.length>=(d?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function mR(e,t){var r=bm(e);e.l+=16;var a=lF(e,t-24);return[r,a]}function gR(e){var t=Je(24),r=ga(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return xn([t,cF(e[1])])}function xR(e,t){e.read_shift(2);var r=bm(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Jn,""),[r,a]}function yR(e){var t=e[1].Tooltip,r=Je(10+2*(t.length+1));r.write_shift(2,2048);var a=ga(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function vR(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=B4[r]||r,r=e.read_shift(2),t[1]=B4[r]||r,t}function wR(e){return e||(e=Je(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ER(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(b5(e));return r}function bR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(b5(e));return r}function _R(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function O5(e,t,r){if(!r.cellStyles)return ts(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var A={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function CR(e,t){var r=Je(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function BR(e,t){var r={};return t<32||(e.l+=16,r.header=Yn(e),r.footer=Yn(e),e.l+=2),r}function SR(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function TR(e){for(var t=Je(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var OR=wo,IR=y5,NR=c0;function FR(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function RR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=wo(e);++e.l;var n=yA(e,t-7,r);return a.t="str",a.val=n,a}function kR(e){var t=wo(e);++e.l;var r=Yn(e);return t.t="n",t.val=r,t}function DR(e,t,r){var a=Je(15);return f0(a,e,t),a.write_shift(8,r,"f"),a}function jR(e){var t=wo(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function LR(e,t,r){var a=Je(9);return f0(a,e,t),a.write_shift(2,r),a}function UR(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function MR(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function PR(e,t,r){var a=e.l+t,n=wo(e),i=e.read_shift(2),o=lA(e,i,r);return e.l=a,n.t="str",n.val=o,n}var QR=[2,3,48,49,131,139,140,245],kx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ym({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],d=nc(1);switch(c.type){case"base64":d=Ys(ni(l));break;case"binary":d=Ys(l);break;case"buffer":case"array":d=l;break}Sn(d,0);var f=d.read_shift(1),p=!!(f&136),u=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:u=!0,p=!0;break;case 49:u=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var h=0,x=521;f==2&&(h=d.read_shift(2)),d.l+=3,f!=2&&(h=d.read_shift(4)),h>1048576&&(h=1e6),f!=2&&(x=d.read_shift(2));var y=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var E=[],k={},S=Math.min(d.length,f==2?521:x-10-(u?264:0)),B=g?32:11;d.l<S&&d[d.l]!=13;)switch(k={},k.name=_r.utils.decode(v,d.slice(d.l,d.l+B)).replace(/[\u0000\r\n].*$/g,""),d.l+=B,k.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),f==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&E.push(k),f!=2&&(d.l+=g?13:14),k.type){case"B":(!u||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var b=0,O=0;for(A[0]=[],O=0;O!=E.length;++O)A[0][O]=E[O].name;for(;h-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,A[++b]=[],O=0,O=0;O!=E.length;++O){var _=d.slice(d.l,d.l+E[O].len);d.l+=E[O].len,Sn(_,0);var U=_r.utils.decode(v,_);switch(E[O].type){case"C":U.trim().length&&(A[b][O]=U.replace(/\s+$/,""));break;case"D":U.length===8?A[b][O]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):A[b][O]=U;break;case"F":A[b][O]=parseFloat(U.trim());break;case"+":case"I":A[b][O]=g?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":A[b][O]=!0;break;case"N":case"F":A[b][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));A[b][O]="##MEMO##"+(g?parseInt(U.trim(),10):_.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(A[b][O]=+U||0);break;case"@":A[b][O]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":A[b][O]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":A[b][O]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[b][O]=-_.read_shift(-8,"f");break;case"B":if(u&&E[O].len==8){A[b][O]=_.read_shift(8,"f");break}case"G":case"P":_.l+=E[O].len;break;case"0":if(E[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[O].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=E,A}function a(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var d=Wd(r(l,A),A);return d["!cols"]=A.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete A.DBF,d}function n(l,c){try{return fc(a(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&Ci(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var d=Fs(),f=Mh(l,{header:1,raw:!0,cellDates:!0}),p=f[0],u=f.slice(1),g=l["!cols"]||[],h=0,x=0,y=0,v=1;for(h=0;h<p.length;++h){if(((g[h]||{}).DBF||{}).name){p[h]=g[h].DBF.name,++y;continue}if(p[h]!=null){if(++y,typeof p[h]=="number"&&(p[h]=p[h].toString(10)),typeof p[h]!="string")throw new Error("DBF Invalid column name "+p[h]+" |"+typeof p[h]+"|");if(p.indexOf(p[h])!==h){for(x=0;x<1024;++x)if(p.indexOf(p[h]+"_"+x)==-1){p[h]+="_"+x;break}}}}var E=xr(l["!ref"]),k=[],S=[],B=[];for(h=0;h<=E.e.c-E.s.c;++h){var b="",O="",_=0,U=[];for(x=0;x<u.length;++x)u[x][h]!=null&&U.push(u[x][h]);if(U.length==0||p[h]==null){k[h]="?";continue}for(x=0;x<U.length;++x){switch(typeof U[x]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=U[x]instanceof Date?"D":"C";break;default:O="C"}_=Math.max(_,String(U[x]).length),b=b&&b!=O?"C":O}_>250&&(_=250),O=((g[h]||{}).DBF||{}).type,O=="C"&&g[h].DBF.len>_&&(_=g[h].DBF.len),b=="B"&&O=="N"&&(b="N",B[h]=g[h].DBF.dec,_=g[h].DBF.len),S[h]=b=="C"||O=="N"?_:i[b]||0,v+=S[h],k[h]=b}var I=d.next(32);for(I.write_shift(4,318902576),I.write_shift(4,u.length),I.write_shift(2,296+32*y),I.write_shift(2,v),h=0;h<4;++h)I.write_shift(4,0);for(I.write_shift(4,0|(+t[nA]||3)<<8),h=0,x=0;h<p.length;++h)if(p[h]!=null){var R=d.next(32),L=(p[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,L,"sbcs"),R.write_shift(1,k[h]=="?"?"C":k[h],"sbcs"),R.write_shift(4,x),R.write_shift(1,S[h]||i[k[h]]||0),R.write_shift(1,B[h]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),x+=S[h]||i[k[h]]||0}var N=d.next(264);for(N.write_shift(4,13),h=0;h<65;++h)N.write_shift(4,0);for(h=0;h<u.length;++h){var P=d.next(v);for(P.write_shift(1,0),x=0;x<p.length;++x)if(p[x]!=null)switch(k[x]){case"L":P.write_shift(1,u[h][x]==null?63:u[h][x]?84:70);break;case"B":P.write_shift(8,u[h][x]||0,"f");break;case"N":var Q="0";for(typeof u[h][x]=="number"&&(Q=u[h][x].toFixed(B[x]||0)),y=0;y<S[x]-Q.length;++y)P.write_shift(1,32);P.write_shift(1,Q,"sbcs");break;case"D":u[h][x]?(P.write_shift(4,("0000"+u[h][x].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(u[h][x].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+u[h][x].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(u[h][x]!=null?u[h][x]:"").slice(0,S[x]);for(P.write_shift(1,Y,"sbcs"),y=0;y<S[x]-Y.length;++y)P.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),I5=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Oa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,u){var g=e[u];return typeof g=="number"?Bx(g):g},a=function(p,u,g){var h=u.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return h==59?p:Bx(h)};e["|"]=254;function n(p,u){switch(u.type){case"base64":return i(ni(p),u);case"binary":return i(p,u);case"buffer":return i(ur&&Buffer.isBuffer(p)?p.toString("binary"):uc(p),u);case"array":return i(iA(p),u)}throw new Error("Unrecognized type "+u.type)}function i(p,u){var g=p.split(/[\n\r]+/),h=-1,x=-1,y=0,v=0,E=[],k=[],S=null,B={},b=[],O=[],_=[],U=0,I;for(+u.codepage>=0&&Ci(+u.codepage);y!==g.length;++y){U=0;var R=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),L=R.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),N=L[0],P;if(R.length>0)switch(N){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&k.push(R.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,Y=!1,ee=!1,V=!1,G=-1,z=-1;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"A":break;case"X":x=parseInt(L[v].slice(1))-1,Y=!0;break;case"Y":for(h=parseInt(L[v].slice(1))-1,Y||(x=0),I=E.length;I<=h;++I)E[I]=[];break;case"K":P=L[v].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(Hi(P))?isNaN(Qd(P).getDate())||(P=ca(P)):(P=Hi(P),S!==null&&fA(S)&&(P=wm(P))),typeof _r<"u"&&typeof P=="string"&&(u||{}).type!="string"&&(u||{}).codepage&&(P=_r.utils.decode(u.codepage,P)),Q=!0;break;case"E":V=!0;var C=Od(L[v].slice(1),{r:h,c:x});E[h][x]=[E[h][x],C];break;case"S":ee=!0,E[h][x]=[E[h][x],"S5S"];break;case"G":break;case"R":G=parseInt(L[v].slice(1))-1;break;case"C":z=parseInt(L[v].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}if(Q&&(E[h][x]&&E[h][x].length==2?E[h][x][0]=P:E[h][x]=P,S=null),ee){if(V)throw new Error("SYLK shared formula cannot have own formula");var D=G>-1&&E[G][z];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");E[h][x][1]=$5(D[1],{r:h-G,c:x-z})}break;case"F":var j=0;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"X":x=parseInt(L[v].slice(1))-1,++j;break;case"Y":for(h=parseInt(L[v].slice(1))-1,I=E.length;I<=h;++I)E[I]=[];break;case"M":U=parseInt(L[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=k[parseInt(L[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=L[v].slice(1).split(" "),I=parseInt(_[0],10);I<=parseInt(_[1],10);++I)U=parseInt(_[2],10),O[I-1]=U===0?{hidden:!0}:{wch:U},sc(O[I-1]);break;case"C":x=parseInt(L[v].slice(1))-1,O[x]||(O[x]={});break;case"R":h=parseInt(L[v].slice(1))-1,b[h]||(b[h]={}),U>0?(b[h].hpt=U,b[h].hpx=Kd(U)):U===0&&(b[h].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}j<1&&(S=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}}return b.length>0&&(B["!rows"]=b),O.length>0&&(B["!cols"]=O),u&&u.sheetRows&&(E=E.slice(0,u.sheetRows)),[E,B]}function o(p,u){var g=n(p,u),h=g[0],x=g[1],y=Wd(h,u);return Oa(x).forEach(function(v){y[v]=x[v]}),y}function l(p,u){return fc(o(p,u),u)}function c(p,u,g,h){var x="C;Y"+(g+1)+";X"+(h+1)+";K";switch(p.t){case"n":x+=p.v||0,p.f&&!p.F&&(x+=";E"+gy(p.f,{r:g,c:h}));break;case"b":x+=p.v?"TRUE":"FALSE";break;case"e":x+=p.w||p.v;break;case"d":x+='"'+(p.w||p.v)+'"';break;case"s":x+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function A(p,u){u.forEach(function(g,h){var x="F;W"+(h+1)+" "+(h+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=qf(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Kf(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&p.push(x)})}function d(p,u){u.forEach(function(g,h){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*Hf(g.hpx)+";"),x.length>2&&p.push(x+"R"+(h+1))})}function f(p,u){var g=["ID;PWXL;N;E"],h=[],x=xr(p["!ref"]),y,v=Array.isArray(p),E=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&A(g,p["!cols"]),p["!rows"]&&d(g,p["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var S=x.s.c;S<=x.e.c;++S){var B=Wt({r:k,c:S});y=v?(p[k]||[])[S]:p[B],!(!y||y.v==null&&(!y.f||y.F))&&h.push(c(y,p,k,S))}return g.join(E)+E+h.join(E)+E+"E"+E}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),N5=function(){function e(i,o){switch(o.type){case"base64":return t(ni(i),o);case"binary":return t(i,o);case"buffer":return t(ur&&Buffer.isBuffer(i)?i.toString("binary"):uc(i),o);case"array":return t(iA(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,A=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],A=0;continue}if(!(c<0)){var p=l[d].trim().split(","),u=p[0],g=p[1];++d;for(var h=l[d]||"";(h.match(/["]/g)||[]).length&1&&d<l.length-1;)h+=`
`+l[++d];switch(h=h.trim(),+u){case-1:if(h==="BOT"){f[++c]=[],A=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?f[c][A]=!0:h==="FALSE"?f[c][A]=!1:isNaN(Hi(g))?isNaN(Qd(g).getDate())?f[c][A]=g:f[c][A]=ca(g):f[c][A]=Hi(g),++A;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),f[c][A++]=h!==""?h:null;break}if(h==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return Wd(e(i,o),o)}function a(i,o){return fc(r(i,o),o)}var n=function(){var i=function(c,A,d,f,p){c.push(A),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,A,d,f){c.push(A+","+d),c.push(A==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var A=[],d=xr(c["!ref"]),f,p=Array.isArray(c);i(A,"TABLE",0,1,"sheetjs"),i(A,"VECTORS",0,d.e.r-d.s.r+1,""),i(A,"TUPLES",0,d.e.c-d.s.c+1,""),i(A,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){o(A,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var h=Wt({r:u,c:g});if(f=p?(c[u]||[])[g]:c[h],!f){o(A,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(A,1,0,"="+f.f):o(A,1,0,""):o(A,0,x,"V");break;case"b":o(A,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=si(f.z||zt[14],ln(ca(f.v)))),o(A,0,f.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var y=`\r
`,v=A.join(y);return v}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),F5=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var u=f.split(`
`),g=-1,h=-1,x=0,y=[];x!==u.length;++x){var v=u[x].trim().split(":");if(v[0]==="cell"){var E=ga(v[1]);if(y.length<=E.r)for(g=y.length;g<=E.r;++g)y[g]||(y[g]=[]);switch(g=E.r,h=E.c,v[2]){case"t":y[g][h]=e(v[3]);break;case"v":y[g][h]=+v[3];break;case"vtf":var k=v[v.length-1];case"vtc":switch(v[3]){case"nl":y[g][h]=!!+v[4];break;default:y[g][h]=+v[4];break}v[2]=="vtf"&&(y[g][h]=[y[g][h],k])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function a(f,p){return Wd(r(f,p),p)}function n(f,p){return fc(a(f,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(f){if(!f||!f["!ref"])return"";for(var p=[],u=[],g,h="",x=xs(f["!ref"]),y=Array.isArray(f),v=x.s.r;v<=x.e.r;++v)for(var E=x.s.c;E<=x.e.c;++E)if(h=Wt({r:v,c:E}),g=y?(f[v]||[])[E]:f[h],!(!g||g.v==null||g.t==="z")){switch(u=["cell",h,"t"],g.t){case"s":case"str":u.push(t(g.v));break;case"n":g.f?(u[2]="vtf",u[3]="n",u[4]=g.v,u[5]=t(g.f)):(u[2]="v",u[3]=g.v);break;case"b":u[2]="vt"+(g.f?"f":"c"),u[3]="nl",u[4]=g.v?"1":"0",u[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var k=ln(ca(g.v));u[2]="vtc",u[3]="nd",u[4]=""+k,u[5]=g.w||si(g.z||zt[14],k);break;case"e":continue}p.push(u.join(":"))}return p.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[i,o,l,o,A(f),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}}(),qd=function(){function e(d,f,p,u,g){g.raw?f[p][u]=d:d===""||(d==="TRUE"?f[p][u]=!0:d==="FALSE"?f[p][u]=!1:isNaN(Hi(d))?isNaN(Qd(d).getDate())?f[p][u]=d:f[p][u]=ca(d):f[p][u]=Hi(d))}function t(d,f){var p=f||{},u=[];if(!d||d.length===0)return u;for(var g=d.split(/[\r\n]/),h=g.length-1;h>=0&&g[h].length===0;)--h;for(var x=10,y=0,v=0;v<=h;++v)y=g[v].indexOf(" "),y==-1?y=g[v].length:y++,x=Math.max(x,y);for(v=0;v<=h;++v){u[v]=[];var E=0;for(e(g[v].slice(0,x).trim(),u,v,E,p),E=1;E<=(g[v].length-x)/10+1;++E)e(g[v].slice(x+(E-1)*10,x+E*10).trim(),u,v,E,p)}return p.sheetRows&&(u=u.slice(0,p.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var f={},p=!1,u=0,g=0;u<d.length;++u)(g=d.charCodeAt(u))==34?p=!p:!p&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u]);if(!g.length){f=a;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u])}return g.sort(function(h,x){return h[0]-x[0]||a[h[1]]-a[x[1]]}),r[g.pop()[1]]||44}function i(d,f){var p=f||{},u="",g=p.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=n(d.slice(0,1024)):p&&p.FS?u=p.FS:u=n(d.slice(0,1024));var x=0,y=0,v=0,E=0,k=0,S=u.charCodeAt(0),B=!1,b=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var _=p.dateNF!=null?B3(p.dateNF):null;function U(){var I=d.slice(E,k),R={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)R.t="z";else if(p.raw)R.t="s",R.v=I;else if(I.trim().length===0)R.t="s",R.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(R.t="s",R.v=I.slice(2,-1).replace(/""/g,'"')):rD(I)?(R.t="n",R.f=I.slice(1)):(R.t="s",R.v=I);else if(I=="TRUE")R.t="b",R.v=!0;else if(I=="FALSE")R.t="b",R.v=!1;else if(!isNaN(v=Hi(I)))R.t="n",p.cellText!==!1&&(R.w=I),R.v=v;else if(!isNaN(Qd(I).getDate())||_&&I.match(_)){R.z=p.dateNF||zt[14];var L=0;_&&I.match(_)&&(I=S3(I,p.dateNF,I.match(_)||[]),L=1),p.cellDates?(R.t="d",R.v=ca(I,L)):(R.t="n",R.v=ln(ca(I,L))),p.cellText!==!1&&(R.w=si(R.z,R.v instanceof Date?ln(R.v):R.v)),p.cellNF||delete R.z}else R.t="s",R.v=I;if(R.t=="z"||(p.dense?(g[x]||(g[x]=[]),g[x][y]=R):g[Wt({c:y,r:x})]=R),E=k+1,O=d.charCodeAt(E),h.e.c<y&&(h.e.c=y),h.e.r<x&&(h.e.r=x),b==S)++y;else if(y=0,++x,p.sheetRows&&p.sheetRows<=x)return!0}e:for(;k<d.length;++k)switch(b=d.charCodeAt(k)){case 34:O===34&&(B=!B);break;case S:case 10:case 13:if(!B&&U())break e;break}return k-E>0&&U(),g["!ref"]=lr(h),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Wd(t(d,f),f)}function l(d,f){var p="",u=f.type=="string"?[0,0,0,0]:By(d,f);switch(f.type){case"base64":p=ni(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof _r<"u"?p=_r.utils.decode(f.codepage,d):p=ur&&Buffer.isBuffer(d)?d.toString("binary"):uc(d);break;case"array":p=iA(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return u[0]==239&&u[1]==187&&u[2]==191?p=Vr(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Vr(p):f.type=="binary"&&typeof _r<"u"&&f.codepage&&(p=_r.utils.decode(f.codepage,_r.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?F5.to_sheet(f.type=="string"?p:Vr(p),f):o(p,f)}function c(d,f){return fc(l(d,f),f)}function A(d){for(var f=[],p=xr(d["!ref"]),u,g=Array.isArray(d),h=p.s.r;h<=p.e.r;++h){for(var x=[],y=p.s.c;y<=p.e.c;++y){var v=Wt({r:h,c:y});if(u=g?(d[h]||[])[y]:d[v],!u||u.v==null){x.push("          ");continue}for(var E=(u.w||(xo(u),u.w)||"").slice(0,10);E.length<10;)E+=" ";x.push(E+(y===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function qR(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=I5.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return qd.to_workbook(e,t)}}var Yc=function(){function e(C,D,j){if(C){Sn(C,C.l||0);for(var K=j.Enum||G;C.l<C.length;){var W=C.read_shift(2),Ae=K[W]||K[65535],ue=C.read_shift(2),he=C.l+ue,ve=Ae.f&&Ae.f(C,ue,j);if(C.l=he,D(ve,Ae,W))return}}}function t(C,D){switch(D.type){case"base64":return r(Ys(ni(C)),D);case"binary":return r(Ys(C),D);case"buffer":case"array":return r(C,D)}throw"Unsupported type "+D.type}function r(C,D){if(!C)return C;var j=D||{},K=j.dense?[]:{},W="Sheet1",Ae="",ue=0,he={},ve=[],we=[],se={s:{r:0,c:0},e:{r:0,c:0}},He=j.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)j.Enum=G,e(C,function(Ge,et,Ye){switch(Ye){case 0:j.vers=Ge,Ge>=4096&&(j.qpro=!0);break;case 6:se=Ge;break;case 204:Ge&&(Ae=Ge);break;case 222:Ae=Ge;break;case 15:case 51:j.qpro||(Ge[1].v=Ge[1].v.slice(1));case 13:case 14:case 16:Ye==14&&(Ge[2]&112)==112&&(Ge[2]&15)>1&&(Ge[2]&15)<15&&(Ge[1].z=j.dateNF||zt[14],j.cellDates&&(Ge[1].t="d",Ge[1].v=wm(Ge[1].v))),j.qpro&&Ge[3]>ue&&(K["!ref"]=lr(se),he[W]=K,ve.push(W),K=j.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},ue=Ge[3],W=Ae||"Sheet"+(ue+1),Ae="");var tt=j.dense?(K[Ge[0].r]||[])[Ge[0].c]:K[Wt(Ge[0])];if(tt){tt.t=Ge[1].t,tt.v=Ge[1].v,Ge[1].z!=null&&(tt.z=Ge[1].z),Ge[1].f!=null&&(tt.f=Ge[1].f);break}j.dense?(K[Ge[0].r]||(K[Ge[0].r]=[]),K[Ge[0].r][Ge[0].c]=Ge[1]):K[Wt(Ge[0])]=Ge[1];break}},j);else if(C[2]==26||C[2]==14)j.Enum=z,C[2]==14&&(j.qpro=!0,C.l=0),e(C,function(Ge,et,Ye){switch(Ye){case 204:W=Ge;break;case 22:Ge[1].v=Ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ge[3]>ue&&(K["!ref"]=lr(se),he[W]=K,ve.push(W),K=j.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},ue=Ge[3],W="Sheet"+(ue+1)),He>0&&Ge[0].r>=He)break;j.dense?(K[Ge[0].r]||(K[Ge[0].r]=[]),K[Ge[0].r][Ge[0].c]=Ge[1]):K[Wt(Ge[0])]=Ge[1],se.e.c<Ge[0].c&&(se.e.c=Ge[0].c),se.e.r<Ge[0].r&&(se.e.r=Ge[0].r);break;case 27:Ge[14e3]&&(we[Ge[14e3][0]]=Ge[14e3][1]);break;case 1537:we[Ge[0]]=Ge[1],Ge[0]==ue&&(W=Ge[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(K["!ref"]=lr(se),he[Ae||W]=K,ve.push(Ae||W),!we.length)return{SheetNames:ve,Sheets:he};for(var Ee={},pe=[],ce=0;ce<we.length;++ce)he[ve[ce]]?(pe.push(we[ce]||ve[ce]),Ee[we[ce]]=he[we[ce]]||he[ve[ce]]):(pe.push(we[ce]),Ee[we[ce]]={"!ref":"A1"});return{SheetNames:pe,Sheets:Ee}}function a(C,D){var j=D||{};if(+j.codepage>=0&&Ci(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Fs(),W=xr(C["!ref"]),Ae=Array.isArray(C),ue=[];yt(K,0,i(1030)),yt(K,6,c(W));for(var he=Math.min(W.e.r,8191),ve=W.s.r;ve<=he;++ve)for(var we=Sa(ve),se=W.s.c;se<=W.e.c;++se){ve===W.s.r&&(ue[se]=la(se));var He=ue[se]+we,Ee=Ae?(C[ve]||[])[se]:C[He];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?yt(K,13,u(ve,se,Ee.v)):yt(K,14,h(ve,se,Ee.v));else{var pe=xo(Ee);yt(K,15,f(ve,se,pe.slice(0,239)))}}return yt(K,1),K.end()}function n(C,D){var j=D||{};if(+j.codepage>=0&&Ci(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Fs();yt(K,0,o(C));for(var W=0,Ae=0;W<C.SheetNames.length;++W)(C.Sheets[C.SheetNames[W]]||{})["!ref"]&&yt(K,27,V(C.SheetNames[W],Ae++));var ue=0;for(W=0;W<C.SheetNames.length;++W){var he=C.Sheets[C.SheetNames[W]];if(!(!he||!he["!ref"])){for(var ve=xr(he["!ref"]),we=Array.isArray(he),se=[],He=Math.min(ve.e.r,8191),Ee=ve.s.r;Ee<=He;++Ee)for(var pe=Sa(Ee),ce=ve.s.c;ce<=ve.e.c;++ce){Ee===ve.s.r&&(se[ce]=la(ce));var Ge=se[ce]+pe,et=we?(he[Ee]||[])[ce]:he[Ge];if(!(!et||et.t=="z"))if(et.t=="n")yt(K,23,U(Ee,ce,ue,et.v));else{var Ye=xo(et);yt(K,22,b(Ee,ce,ue,Ye.slice(0,239)))}}++ue}}return yt(K,1),K.end()}function i(C){var D=Je(2);return D.write_shift(2,C),D}function o(C){var D=Je(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var j=0,K=0,W=0,Ae=0;Ae<C.SheetNames.length;++Ae){var ue=C.SheetNames[Ae],he=C.Sheets[ue];if(!(!he||!he["!ref"])){++W;var ve=xs(he["!ref"]);j<ve.e.r&&(j=ve.e.r),K<ve.e.c&&(K=ve.e.c)}}return j>8191&&(j=8191),D.write_shift(2,j),D.write_shift(1,W),D.write_shift(1,K),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function l(C,D,j){var K={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&j.qpro?(K.s.c=C.read_shift(1),C.l++,K.s.r=C.read_shift(2),K.e.c=C.read_shift(1),C.l++,K.e.r=C.read_shift(2),K):(K.s.c=C.read_shift(2),K.s.r=C.read_shift(2),D==12&&j.qpro&&(C.l+=2),K.e.c=C.read_shift(2),K.e.r=C.read_shift(2),D==12&&j.qpro&&(C.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function c(C){var D=Je(8);return D.write_shift(2,C.s.c),D.write_shift(2,C.s.r),D.write_shift(2,C.e.c),D.write_shift(2,C.e.r),D}function A(C,D,j){var K=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(K[0].c=C.read_shift(1),K[3]=C.read_shift(1),K[0].r=C.read_shift(2),C.l+=2):(K[2]=C.read_shift(1),K[0].c=C.read_shift(2),K[0].r=C.read_shift(2)),K}function d(C,D,j){var K=C.l+D,W=A(C,D,j);if(W[1].t="s",j.vers==20768){C.l++;var Ae=C.read_shift(1);return W[1].v=C.read_shift(Ae,"utf8"),W}return j.qpro&&C.l++,W[1].v=C.read_shift(K-C.l,"cstr"),W}function f(C,D,j){var K=Je(7+j.length);K.write_shift(1,255),K.write_shift(2,D),K.write_shift(2,C),K.write_shift(1,39);for(var W=0;W<K.length;++W){var Ae=j.charCodeAt(W);K.write_shift(1,Ae>=128?95:Ae)}return K.write_shift(1,0),K}function p(C,D,j){var K=A(C,D,j);return K[1].v=C.read_shift(2,"i"),K}function u(C,D,j){var K=Je(7);return K.write_shift(1,255),K.write_shift(2,D),K.write_shift(2,C),K.write_shift(2,j,"i"),K}function g(C,D,j){var K=A(C,D,j);return K[1].v=C.read_shift(8,"f"),K}function h(C,D,j){var K=Je(13);return K.write_shift(1,255),K.write_shift(2,D),K.write_shift(2,C),K.write_shift(8,j,"f"),K}function x(C,D,j){var K=C.l+D,W=A(C,D,j);if(W[1].v=C.read_shift(8,"f"),j.qpro)C.l=K;else{var Ae=C.read_shift(2);k(C.slice(C.l,C.l+Ae),W),C.l+=Ae}return W}function y(C,D,j){var K=D&32768;return D&=-32769,D=(K?C:0)+(D>=8192?D-16384:D),(K?"":"$")+(j?la(D):Sa(D))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(C,D){Sn(C,0);for(var j=[],K=0,W="",Ae="",ue="",he="";C.l<C.length;){var ve=C[C.l++];switch(ve){case 0:j.push(C.read_shift(8,"f"));break;case 1:Ae=y(D[0].c,C.read_shift(2),!0),W=y(D[0].r,C.read_shift(2),!1),j.push(Ae+W);break;case 2:{var we=y(D[0].c,C.read_shift(2),!0),se=y(D[0].r,C.read_shift(2),!1);Ae=y(D[0].c,C.read_shift(2),!0),W=y(D[0].r,C.read_shift(2),!1),j.push(we+se+":"+Ae+W)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(C.read_shift(2));break;case 6:{for(var He="";ve=C[C.l++];)He+=String.fromCharCode(ve);j.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:he=j.pop(),ue=j.pop(),j.push(["AND","OR"][ve-20]+"("+ue+","+he+")");break;default:if(ve<32&&E[ve])he=j.pop(),ue=j.pop(),j.push(ue+E[ve]+he);else if(v[ve]){if(K=v[ve][1],K==69&&(K=C[C.l++]),K>j.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+j.join("|")+"|");return}var Ee=j.slice(-K);j.length-=K,j.push(v[ve][0]+"("+Ee.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}j.length==1?D[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function S(C){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=C.read_shift(2),D[3]=C[C.l++],D[0].c=C[C.l++],D}function B(C,D){var j=S(C);return j[1].t="s",j[1].v=C.read_shift(D-4,"cstr"),j}function b(C,D,j,K){var W=Je(6+K.length);W.write_shift(2,C),W.write_shift(1,j),W.write_shift(1,D),W.write_shift(1,39);for(var Ae=0;Ae<K.length;++Ae){var ue=K.charCodeAt(Ae);W.write_shift(1,ue>=128?95:ue)}return W.write_shift(1,0),W}function O(C,D){var j=S(C);j[1].v=C.read_shift(2);var K=j[1].v>>1;if(j[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return j[1].v=K,j}function _(C,D){var j=S(C),K=C.read_shift(4),W=C.read_shift(4),Ae=C.read_shift(2);if(Ae==65535)return K===0&&W===3221225472?(j[1].t="e",j[1].v=15):K===0&&W===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ue=Ae&32768;return Ae=(Ae&32767)-16446,j[1].v=(1-ue*2)*(W*Math.pow(2,Ae+32)+K*Math.pow(2,Ae)),j}function U(C,D,j,K){var W=Je(14);if(W.write_shift(2,C),W.write_shift(1,j),W.write_shift(1,D),K==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var Ae=0,ue=0,he=0,ve=0;return K<0&&(Ae=1,K=-K),ue=Math.log2(K)|0,K/=Math.pow(2,ue-31),ve=K>>>0,ve&2147483648||(K/=2,++ue,ve=K>>>0),K-=ve,ve|=2147483648,ve>>>=0,K*=Math.pow(2,32),he=K>>>0,W.write_shift(4,he),W.write_shift(4,ve),ue+=16383+(Ae?32768:0),W.write_shift(2,ue),W}function I(C,D){var j=_(C);return C.l+=D-14,j}function R(C,D){var j=S(C),K=C.read_shift(4);return j[1].v=K>>6,j}function L(C,D){var j=S(C),K=C.read_shift(8,"f");return j[1].v=K,j}function N(C,D){var j=L(C);return C.l+=D-10,j}function P(C,D){return C[C.l+D-1]==0?C.read_shift(D,"cstr"):""}function Q(C,D){var j=C[C.l++];j>D-1&&(j=D-1);for(var K="";K.length<j;)K+=String.fromCharCode(C[C.l++]);return K}function Y(C,D,j){if(!(!j.qpro||D<21)){var K=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var W=C.read_shift(D-21,"cstr");return[K,W]}}function ee(C,D){for(var j={},K=C.l+D;C.l<K;){var W=C.read_shift(2);if(W==14e3){for(j[W]=[0,""],j[W][0]=C.read_shift(2);C[C.l];)j[W][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return j}function V(C,D){var j=Je(5+C.length);j.write_shift(2,14e3),j.write_shift(2,D);for(var K=0;K<C.length;++K){var W=C.charCodeAt(K);j[j.l++]=W>127?95:W}return j[j.l++]=0,j}var G={0:{n:"BOF",f:Ya},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:N},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function KR(e){var t={},r=e.match(rs),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=Jt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=P2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var HR=function(){var e=Lf("t"),t=Lf("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Tr(o[1])},c=i.match(t);return c&&(l.s=KR(c[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(l){return l.v})}}(),GR=function(){var t=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),zR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,VR=/<(?:\w+:)?r>/,$R=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function uy(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Tr(Vr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Vr(e),r&&(a.h=$2(a.t))):e.match(VR)&&(a.r=Vr(e),a.t=Tr(Vr((e.replace($R,"").match(zR)||[]).join("").replace(rs,""))),r&&(a.h=GR(HR(a.r)))),a):{t:""}}var YR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,WR=/<(?:\w+:)?(?:si|sstItem)>/g,XR=/<\/(?:\w+:)?(?:si|sstItem)>/;function JR(e,t){var r=[],a="";if(!e)return r;var n=e.match(YR);if(n){a=n[2].replace(WR,"").split(XR);for(var i=0;i!=a.length;++i){var o=uy(a[i].trim(),t);o!=null&&(r[r.length]=o)}n=Jt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var ZR=/^\s|\s$|[\t\n\r]/;function R5(e,t){if(!t.bookSST)return"";var r=[Qa];r[r.length]=gt("sst",null,{xmlns:pA[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(ZR)&&(i+=' xml:space="preserve"'),i+=">"+Hr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function e6(e){return[e.read_shift(4),e.read_shift(4)]}function t6(e,t){var r=[],a=!1;return il(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function r6(e,t){return t||(t=Je(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var a6=fN;function n6(e){var t=Fs();st(t,159,r6(e));for(var r=0;r<e.length;++r)st(t,19,a6(e[r]));return st(t,160),t.end()}function k5(e){if(typeof _r<"u")return _r.utils.encode(nA,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Xo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function s6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xo(e,4),t.U=Xo(e,4),t.W=Xo(e,4),t}function i6(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function o6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(i6(e));return t}function l6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function c6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xo(e,4),t.U=Xo(e,4),t.W=Xo(e,4),t}function A6(e){var t=c6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function D5(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function j5(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function d6(e){var t=Xo(e);switch(t.Minor){case 2:return[t.Minor,u6(e)];case 3:return[t.Minor,f6()];case 4:return[t.Minor,p6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function u6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=D5(e,r),n=j5(e,e.length-e.l);return{t:"Std",h:a,v:n}}function f6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function p6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(rs,function(i){var o=Jt(i);switch(vo(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function h6(e,t){var r={},a=r.EncryptionVersionInfo=Xo(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=D5(e,n),t-=n,r.EncryptionVerifier=j5(e,t),r}function m6(e){var t={},r=t.EncryptionVersionInfo=Xo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function fy(e){var t=0,r,a=k5(e),n=a.length+1,i,o,l,c,A;for(r=nc(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,A=l|c,t=A^o;return t^52811}var L5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var d=o[A],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=k5(o),c=i(l),A=l.length,d=nc(16),f=0;f!=16;++f)d[f]=0;var p,u,g;for((A&1)===1&&(p=c>>8,d[A]=n(e[0],p),--A,p=c&255,u=l[l.length-1],d[A]=n(u,p));A>0;)--A,p=c>>8,d[A]=n(l[A],p),--A,p=c&255,d[A]=n(l[A],p);for(A=15,g=15-l.length;g>0;)p=c>>8,d[A]=n(e[g],p),--A,--g,p=c&255,d[A]=n(l[A],p),--A,--g;return d}}(),g6=function(e,t,r,a,n){n||(n=t),a||(a=L5(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,a]},x6=function(e){var t=0,r=L5(e);return function(a){var n=g6("",a,t,r);return t=n[1],n[0]}};function y6(e,t,r,a){var n={key:Ya(e),verificationBytes:Ya(e)};return r.password&&(n.verifier=fy(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=x6(r.password)),n}function v6(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=m6(e):a.Data=h6(e,t),a}function w6(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?v6(e,t-2,a):y6(e,r.biff>=8?t:t-2,r,a),a}var U5=function(){function e(n,i){switch(i.type){case"base64":return t(ni(n),i);case"binary":return t(n,i);case"buffer":return t(ur&&Buffer.isBuffer(n)?n.toString("binary"):uc(n),i);case"array":return t(iA(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var p=/\\\w+\b/g,u=0,g,h=-1;g=p.exec(d);){switch(g[0]){case"\\cell":var x=d.slice(u,p.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++h,x.length){var y={v:x,t:"s"};Array.isArray(l)?l[f][h]=y:l[Wt({r:f,c:h})]=y}break}u=p.lastIndex}h>A.e.c&&(A.e.c=h)}),l["!ref"]=lr(A),l}function r(n,i){return fc(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],o=xr(n["!ref"]),l,c=Array.isArray(n),A=o.s.r;A<=o.e.r;++A){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Wt({r:A,c:d});l=c?(n[A]||[])[d]:n[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(xo(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function E6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function b6(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),o=n-i;if(o===0)return[0,0,t];var l=0,c=0,A=n+i;switch(c=o/(A>1?2-A:A),n){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,A/2]}function _6(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function jh(e,t){if(t===0)return e;var r=b6(E6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qf(_6(r))}var M5=6,C6=15,B6=1,zn=M5;function qf(e){return Math.floor((e+Math.round(128/zn)/256)*zn)}function Kf(e){return Math.floor((e-5)/zn*100+.5)/100}function Lh(e){return Math.round((e*zn+5)/zn*256)/256}function Dg(e){return Lh(Kf(qf(e)))}function py(e){var t=Math.abs(e-Dg(e)),r=zn;if(t>.005)for(zn=B6;zn<C6;++zn)Math.abs(e-Dg(e))<=t&&(t=Math.abs(e-Dg(e)),r=zn);zn=r}function sc(e){e.width?(e.wpx=qf(e.width),e.wch=Kf(e.wpx),e.MDW=zn):e.wpx?(e.wch=Kf(e.wpx),e.width=Lh(e.wch),e.MDW=zn):typeof e.wch=="number"&&(e.width=Lh(e.wch),e.wpx=qf(e.width),e.MDW=zn),e.customWidth&&delete e.customWidth}var S6=96,P5=S6;function Hf(e){return e*96/P5}function Kd(e){return e*P5/96}var T6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function O6(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(rs)||[]).forEach(function(o){var l=Jt(o);switch(vo(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=sa(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=sa(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function I6(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(rs)||[]).forEach(function(o){var l=Jt(o);switch(vo(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function N6(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(rs)||[]).forEach(function(o){var l=Jt(o);switch(vo(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Vr(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?sa(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?sa(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?sa(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?sa(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?sa(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?sa(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?sa(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=P2[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=sa(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Vc[n.color.index];n.color.index==81&&(c=Vc[1]),c||(c=Vc[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=jh(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function F6(e,t,r){t.NumberFmt=[];for(var a=Oa(zt),n=0;n<a.length;++n)t.NumberFmt[a[n]]=zt[a[n]];var i=e[0].match(rs);if(i)for(n=0;n<i.length;++n){var o=Jt(i[n]);switch(vo(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Tr(Vr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}ho(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function R6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=gt("numFmt",null,{numFmtId:a,formatCode:Hr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=gt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var fp=["numFmtId","fillId","fontId","borderId","xfId"],pp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function k6(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(rs)||[]).forEach(function(i){var o=Jt(i),l=0;switch(vo(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<fp.length;++l)a[fp[l]]&&(a[fp[l]]=parseInt(a[fp[l]],10));for(l=0;l<pp.length;++l)a[pp[l]]&&(a[pp[l]]=sa(a[pp[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=sa(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function D6(e){var t=[];return t[t.length]=gt("cellXfs",null),e.forEach(function(r){t[t.length]=gt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=gt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var j6=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&F6(f,d,A),(f=l.match(n))&&N6(f,d,c,A),(f=l.match(a))&&I6(f,d,c,A),(f=l.match(i))&&O6(f,d,c,A),(f=l.match(r))&&k6(f,d,A),d}}();function Q5(e,t){var r=[Qa,gt("styleSheet",null,{xmlns:pA[0],"xmlns:vt":sn.vt})],a;return e.SSF&&(a=R6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=D6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function L6(e,t){var r=e.read_shift(2),a=Zn(e);return[r,a]}function U6(e,t,r){r||(r=Je(6+4*t.length)),r.write_shift(2,e),vn(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function M6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=vN(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=yN(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Zn(e),a}function P6(e,t){t||(t=Je(25+4*32)),t.write_shift(2,e.sz*20),wN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Rh(e.color,t);var a=0;return a=2,t.write_shift(1,a),vn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Q6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jg,q6=ts;function K4(e,t){t||(t=Je(4*3+8*7+16*1)),jg||(jg=ym(Q6));var r=jg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Rh({auto:1},t),Rh({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function K6(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function q5(e,t,r){r||(r=Je(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Tu(e,t){return t||(t=Je(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var H6=ts;function G6(e,t){return t||(t=Je(51)),t.write_shift(1,0),Tu(null,t),Tu(null,t),Tu(null,t),Tu(null,t),Tu(null,t),t.length>t.l?t.slice(0,t.l):t}function z6(e,t){return t||(t=Je(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function V6(e,t,r){var a=Je(2052);return a.write_shift(4,e),Fh(t,a),Fh(r,a),a.length>a.l?a.slice(0,a.l):a}function $6(e,t,r){var a={};a.NumberFmt=[];for(var n in zt)a.NumberFmt[n]=zt[n];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return il(e,function(c,A,d){switch(d){case 44:a.NumberFmt[c[0]]=c[1],ho(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=jh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(A.T>0)i.push(d);else if(A.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Y6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(st(e,615,Gi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&st(e,44,U6(n,t[n]))}),st(e,616))}}function W6(e){var t=1;st(e,611,Gi(t)),st(e,43,P6({sz:12,color:{theme:1},name:"Calibri",family:2})),st(e,612)}function X6(e){var t=2;st(e,603,Gi(t)),st(e,45,K4({patternType:"none"})),st(e,45,K4({patternType:"gray125"})),st(e,604)}function J6(e){var t=1;st(e,613,Gi(t)),st(e,46,G6()),st(e,614)}function Z6(e){var t=1;st(e,626,Gi(t)),st(e,47,q5({numFmtId:0},65535)),st(e,627)}function ek(e,t){st(e,617,Gi(t.length)),t.forEach(function(r){st(e,47,q5(r,0))}),st(e,618)}function tk(e){var t=1;st(e,619,Gi(t)),st(e,48,z6({xfId:0,name:"Normal"})),st(e,620)}function rk(e){var t=0;st(e,505,Gi(t)),st(e,506)}function ak(e){var t=0;st(e,508,V6(t,"TableStyleMedium9","PivotStyleMedium4")),st(e,509)}function nk(e,t){var r=Fs();return st(r,278),Y6(r,e.SSF),W6(r),X6(r),J6(r),Z6(r),ek(r,t.cellXfs),tk(r),rk(r),ak(r),st(r,279),r.end()}var sk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ik(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(rs)||[]).forEach(function(n){var i=Jt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sk.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function ok(){}function lk(){}var ck=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ak=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uk(e,t,r){t.themeElements={};var a;[["clrScheme",ck,ik],["fontScheme",Ak,ok],["fmtScheme",dk,lk]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var fk=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function K5(e,t){(!e||e.length===0)&&(e=hy());var r,a={};if(!(r=e.match(fk)))throw new Error("themeElements not found in theme");return uk(r[0],a,t),a.raw=e,a}function hy(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qa];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pk(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=M_(i,{type:"array"})}catch{return}var l=Ws(o,"theme/theme/theme1.xml",!0);if(l)return K5(l,r)}}function hk(e){return e.read_shift(4)}function mk(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=gk(e,4);break;case 2:t.xclrValue=E5(e);break;case 3:t.xclrValue=hk(e);break;case 4:e.l+=4;break}return e.l+=8,t}function gk(e,t){return ts(e,t)}function xk(e,t){return ts(e,t)}function yk(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=mk(e);break;case 6:a[1]=xk(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function vk(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(yk(e,r-e.l));return{ixfe:a,ext:i}}function wk(e,t){t.forEach(function(r){switch(r[0]){}})}function Ek(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zn(e)}}function bk(e){var t=Je(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vn(e.name,t),t.slice(0,t.l)}function _k(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Ck(e){var t=Je(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Bk(e,t){var r=Je(8+2*t.length);return r.write_shift(4,e),vn(t,r),r.slice(0,r.l)}function Sk(e){return e.l+=4,e.read_shift(4)!=0}function Tk(e,t){var r=Je(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Ok(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return il(e,function(c,A,d){switch(d){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!A.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function Ik(){var e=Fs();return st(e,332),st(e,334,Gi(1)),st(e,335,bk({name:"XLDAPR",version:12e4,flags:3496657072})),st(e,336),st(e,339,Bk(1,"XLDAPR")),st(e,52),st(e,35,Gi(514)),st(e,4096,Gi(0)),st(e,4097,bi(1)),st(e,36),st(e,53),st(e,340),st(e,337,Tk(1)),st(e,51,Ck([[1,0]])),st(e,338),st(e,333),e.end()}function Nk(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,o;return e.replace(rs,function(l){var c=Jt(l);switch(vo(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<a.Types.length;++A)a.Types[A].name==c.name&&(o=a.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function H5(){var e=[Qa];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Fk(e){var t=[];if(!e)return t;var r=1;return(e.match(rs)||[]).forEach(function(a){var n=Jt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function Rk(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Wt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function kk(e,t,r){var a=[];return il(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function Dk(e,t,r,a){if(!e)return e;var n=a||{},i=!1;il(e,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},n)}function jk(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var vd=1024;function G5(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[gt("xml",null,{"xmlns:v":Vs.v,"xmlns:o":Vs.o,"xmlns:x":Vs.x,"xmlns:mv":Vs.mv}).replace(/\/>/,">"),gt("o:shapelayout",gt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),gt("v:shapetype",[gt("v:stroke",null,{joinstyle:"miter"}),gt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];vd<e*1e3;)vd+=1e3;return t.forEach(function(i){var o=ga(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?gt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=gt("v:fill",c,l),d={on:"t",obscured:"t"};++vd,n=n.concat(["<v:shape"+Uf({id:"_x0000_s"+vd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,gt("v:shadow",null,d),gt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",On("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),On("x:AutoFill","False"),On("x:Row",String(o.r)),On("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function H4(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(o){var l=ga(o.ref);if(n?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},n?e[l.r][l.c]=i:e[o.ref]=i;var c=xr(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=lr(c);A!==e["!ref"]&&(e["!ref"]=A)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}i.c.push(d)})}function Lk(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Jt(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ga(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&uy(f[1])||{r:"",t:"",h:""};A.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),A.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(A.h=p.h),a.push(A)}}}}),a}function z5(e){var t=[Qa,gt("comments",null,{xmlns:pA[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Hr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(Hr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(On("t",Hr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(On("t",Hr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Uk(e,t){var r=[],a=!1,n={},i=0;return e.replace(rs,function(l,c){var A=Jt(l);switch(vo(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function Mk(e,t,r){var a=[Qa,gt("ThreadedComments",null,{xmlns:sn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(gt("threadedComment",On("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function Pk(e,t){var r=[],a=!1;return e.replace(rs,function(i){var o=Jt(i);switch(vo(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Qk(e){var t=[Qa,gt("personList",null,{xmlns:sn.TCMNT,"xmlns:x":pA[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(gt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function qk(e){var t={};t.iauthor=e.read_shift(4);var r=xA(e);return t.rfx=r.s,t.ref=Wt(r.s),e.l+=16,t}function Kk(e,t){return t==null&&(t=Je(36)),t.write_shift(4,e[1].iauthor),Xd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Hk=Zn;function Gk(e){return vn(e.slice(0,54))}function zk(e,t){var r=[],a=[],n={},i=!1;return il(e,function(l,c,A){switch(A){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function Vk(e){var t=Fs(),r=[];return st(t,628),st(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),st(t,632,Gk(n.a)))})}),st(t,631),st(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:ga(a[0]),e:ga(a[0])};st(t,635,Kk([i,n])),n.t&&n.t.length>0&&st(t,637,hN(n)),st(t,636),delete n.iauthor})}),st(t,634),st(t,629),t.end()}var $k="application/vnd.ms-office.vbaProject";function Yk(e){var t=Ut.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ut.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Ut.write(t)}function Wk(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ut.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var V5=["xlsb","xlsm","xlam","biff8","xla"];function Xk(){return{"!type":"dialog"}}function Jk(){return{"!type":"dialog"}}function Zk(){return{"!type":"macro"}}function eD(){return{"!type":"macro"}}var Od=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?A+=t.r:--A,n+(l?"":"$")+la(d)+(c?"":"$")+Sa(A)}return function(n,i){return t=i,n.replace(e,r)}}(),my=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gy=function(){return function(t,r){return t.replace(my,function(a,n,i,o,l,c){var A=ay(o)-(i?0:r.c),d=ry(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",p=A==0?"":i?A+1:"["+A+"]";return n+"R"+f+"C"+p})}}();function $5(e,t){return e.replace(my,function(r,a,n,i,o,l){return a+(n=="$"?n+i:la(ay(i)+t.c))+(o=="$"?o+l:Sa(ry(l)+t.r))})}function tD(e,t,r){var a=xs(t),n=a.s,i=ga(r),o={r:i.r-n.r,c:i.c-n.c};return $5(e,o)}function rD(e){return e.length!=1}function G4(e){return e.replace(/_xlfn\./g,"")}function Ga(e){e.l+=1}function ic(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Y5(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return W5(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),o=ic(e),l=ic(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function W5(e){var t=ic(e),r=ic(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function aD(e,t,r){if(r.biff<8)return W5(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=ic(e),o=ic(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function X5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return nD(e);var a=e.read_shift(r&&r.biff==12?4:2),n=ic(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function nD(e){var t=ic(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sD(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iD(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return oD(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function oD(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function lD(e,t,r){var a=(e[e.l++]&96)>>5,n=Y5(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function cD(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Y5(e,i,r);return[a,n,o]}function AD(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function dD(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function uD(e,t,r){var a=(e[e.l++]&96)>>5,n=aD(e,t-1,r);return[a,n]}function fD(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function z4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function pD(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function hD(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function mD(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function gD(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function xD(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function J5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function yD(e){return e.read_shift(2),J5(e)}function vD(e){return e.read_shift(2),J5(e)}function wD(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=X5(e,0,r);return[a,n]}function ED(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=iD(e,0,r);return[a,n]}function bD(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=X5(e,0,r);return[a,n,i]}function _D(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Sj[n],tC[n],a]}function CD(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:BD(e);return[n,(i[0]===0?tC:Bj)[i[1]]]}function BD(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function SD(e,t,r){e.l+=r&&r.biff==2?3:4}function TD(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function OD(e){return e.l++,ol[e.read_shift(1)]}function ID(e){return e.l++,e.read_shift(2)}function ND(e){return e.l++,e.read_shift(1)!==0}function FD(e){return e.l++,Yn(e)}function RD(e,t,r){return e.l++,l0(e,t-1,r)}function kD(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ra(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ol[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Yn(e);break;case 2:r[1]=yA(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DD(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?xA:bm)(e));return n}function jD(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=kD(e,r.biff);return o}function LD(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function UD(e,t,r){if(r.biff==5)return MD(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function MD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function PD(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function QD(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function qD(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function KD(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var HD=ts,GD=ts,zD=ts;function A0(e,t,r){return e.l+=2,[sD(e)]}function xy(e){return e.l+=6,[]}var VD=A0,$D=xy,YD=xy,WD=A0;function Z5(e){return e.l+=2,[Ya(e),e.read_shift(2)&1]}var XD=A0,JD=Z5,ZD=xy,ej=A0,tj=A0,rj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=rj[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:i}}function nj(e){return e.l+=2,[e.read_shift(4)]}function sj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ij(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cj(e){return e.l+=4,[0,0]}var V4={1:{n:"PtgExp",f:TD},2:{n:"PtgTbl",f:zD},3:{n:"PtgAdd",f:Ga},4:{n:"PtgSub",f:Ga},5:{n:"PtgMul",f:Ga},6:{n:"PtgDiv",f:Ga},7:{n:"PtgPower",f:Ga},8:{n:"PtgConcat",f:Ga},9:{n:"PtgLt",f:Ga},10:{n:"PtgLe",f:Ga},11:{n:"PtgEq",f:Ga},12:{n:"PtgGe",f:Ga},13:{n:"PtgGt",f:Ga},14:{n:"PtgNe",f:Ga},15:{n:"PtgIsect",f:Ga},16:{n:"PtgUnion",f:Ga},17:{n:"PtgRange",f:Ga},18:{n:"PtgUplus",f:Ga},19:{n:"PtgUminus",f:Ga},20:{n:"PtgPercent",f:Ga},21:{n:"PtgParen",f:Ga},22:{n:"PtgMissArg",f:Ga},23:{n:"PtgStr",f:RD},26:{n:"PtgSheet",f:sj},27:{n:"PtgEndSheet",f:ij},28:{n:"PtgErr",f:OD},29:{n:"PtgBool",f:ND},30:{n:"PtgInt",f:ID},31:{n:"PtgNum",f:FD},32:{n:"PtgArray",f:fD},33:{n:"PtgFunc",f:_D},34:{n:"PtgFuncVar",f:CD},35:{n:"PtgName",f:LD},36:{n:"PtgRef",f:wD},37:{n:"PtgArea",f:lD},38:{n:"PtgMemArea",f:PD},39:{n:"PtgMemErr",f:HD},40:{n:"PtgMemNoMem",f:GD},41:{n:"PtgMemFunc",f:QD},42:{n:"PtgRefErr",f:qD},43:{n:"PtgAreaErr",f:AD},44:{n:"PtgRefN",f:ED},45:{n:"PtgAreaN",f:uD},46:{n:"PtgMemAreaN",f:oj},47:{n:"PtgMemNoMemN",f:lj},57:{n:"PtgNameX",f:UD},58:{n:"PtgRef3d",f:bD},59:{n:"PtgArea3d",f:cD},60:{n:"PtgRefErr3d",f:KD},61:{n:"PtgAreaErr3d",f:dD},255:{}},Aj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dj={1:{n:"PtgElfLel",f:Z5},2:{n:"PtgElfRw",f:ej},3:{n:"PtgElfCol",f:VD},6:{n:"PtgElfRwV",f:tj},7:{n:"PtgElfColV",f:WD},10:{n:"PtgElfRadical",f:XD},11:{n:"PtgElfRadicalS",f:ZD},13:{n:"PtgElfColS",f:$D},15:{n:"PtgElfColSV",f:YD},16:{n:"PtgElfRadicalLel",f:JD},25:{n:"PtgList",f:aj},29:{n:"PtgSxName",f:nj},255:{}},uj={0:{n:"PtgAttrNoop",f:cj},1:{n:"PtgAttrSemi",f:xD},2:{n:"PtgAttrIf",f:mD},4:{n:"PtgAttrChoose",f:pD},8:{n:"PtgAttrGoto",f:hD},16:{n:"PtgAttrSum",f:SD},32:{n:"PtgAttrBaxcel",f:z4},33:{n:"PtgAttrBaxcel",f:z4},64:{n:"PtgAttrSpace",f:yD},65:{n:"PtgAttrSpaceSemi",f:vD},128:{n:"PtgAttrIfError",f:gD},255:{}};function d0(e,t,r,a){if(a.biff<8)return ts(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jD(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=DD(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(ts(e,t)),i}function u0(e,t,r){for(var a=e.l+t,n,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],n=V4[i]||V4[Aj[i]],(i===24||i===25)&&(n=(i===24?dj:uj)[e[e.l+1]]),!n||!n.f?ts(e,t):o.push([n.n,n.f(e,t,r)]);return o}function fj(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var pj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hj(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function eC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function $4(e,t,r){var a=eC(e,t,r);return a=="#REF"?a:hj(a,r)}function Hn(e,t,r,a,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,A,d,f=0,p=0,u,g="";if(!e[0]||!e[0][0])return"";for(var h=-1,x="",y=0,v=e[0].length;y<v;++y){var E=e[0][y];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),h>=0){switch(e[0][h][1][0]){case 0:x=Ca(" ",e[0][h][1][1]);break;case 1:x=Ca("\r",e[0][h][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}A=A+x,h=-1}l.push(A+pj[E[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Af(E[1][1],o,n),l.push(df(d,i));break;case"PtgRefN":d=r?Af(E[1][1],r,n):E[1][1],l.push(df(d,i));break;case"PtgRef3d":f=E[1][1],d=Af(E[1][2],o,n),g=$4(a,f,n),l.push(g+"!"+df(d,i));break;case"PtgFunc":case"PtgFuncVar":var k=E[1][0],S=E[1][1];k||(k=0),k&=127;var B=k==0?[]:l.slice(-k);l.length-=k,S==="User"&&(S=B.shift()),l.push(S+"("+B.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":u=b4(E[1][1],r?{s:r}:o,n),l.push(Fg(u,n));break;case"PtgArea":u=b4(E[1][1],o,n),l.push(Fg(u,n));break;case"PtgArea3d":f=E[1][1],u=E[1][2],g=$4(a,f,n),l.push(g+"!"+Fg(u,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=E[1][2];var b=(a.names||[])[p-1]||(a[0]||[])[p],O=b?b.Name:"SH33TJSNAME"+String(p);O&&O.slice(0,6)=="_xlfn."&&!n.xlfn&&(O=O.slice(6)),l.push(O);break;case"PtgNameX":var _=E[1][1];p=E[1][2];var U;if(n.biff<=5)_<0&&(_=-_),a[_]&&(U=a[_][p]);else{var I="";if(((a[_]||[])[0]||[])[0]==14849||(((a[_]||[])[0]||[])[0]==1025?a[_][p]&&a[_][p].itab>0&&(I=a.SheetNames[a[_][p].itab-1]+"!"):I=a.SheetNames[p-1]+"!"),a[_]&&a[_][p])I+=a[_][p].Name;else if(a[0]&&a[0][p])I+=a[0][p].Name;else{var R=(eC(a,_,n)||"").split(";;");R[p-1]?I=R[p-1]:I+="SH33TJSERRX"}l.push(I);break}U||(U={Name:"SH33TJSERRY"}),l.push(U.Name);break;case"PtgParen":var L="(",N=")";if(h>=0){switch(x="",e[0][h][1][0]){case 2:L=Ca(" ",e[0][h][1][1])+L;break;case 3:L=Ca("\r",e[0][h][1][1])+L;break;case 4:N=Ca(" ",e[0][h][1][1])+N;break;case 5:N=Ca("\r",e[0][h][1][1])+N;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}l.push(L+l.pop()+N);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:E[1][1],r:E[1][0]};var P={c:r.c,r:r.r};if(a.sharedf[Wt(d)]){var Q=a.sharedf[Wt(d)];l.push(Hn(Q,o,P,a,n))}else{var Y=!1;for(c=0;c!=a.arrayf.length;++c)if(A=a.arrayf[c],!(d.c<A[0].s.c||d.c>A[0].e.c)&&!(d.r<A[0].s.r||d.r>A[0].e.r)){l.push(Hn(A[1],o,P,a,n)),Y=!0;break}Y||l.push(E[1])}break;case"PtgArray":l.push("{"+fj(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&h>=0&&ee.indexOf(e[0][y][0])==-1){E=e[0][h];var V=!0;switch(E[1][0]){case 4:V=!1;case 0:x=Ca(" ",E[1][1]);break;case 5:V=!1;case 1:x=Ca("\r",E[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((V?x:"")+l.pop()+(V?"":x)),h=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function mj(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],ts(e,t-2)];var l=u0(e,o,r);return t!==o+n&&(i=d0(e,t-o-n,l,r)),e.l=a,[l,i]}function gj(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],ts(e,t-2)];var l=u0(e,o,r);return t!==o+n&&(i=d0(e,t-o-n,l,r)),e.l=a,[l,i]}function xj(e,t,r,a){var n=e.l+t,i=u0(e,a,r),o;return n!==e.l&&(o=d0(e,n-e.l,i,r)),[i,o]}function yj(e,t,r){var a=e.l+t,n,i=e.read_shift(2),o=u0(e,i,r);return i==65535?[[],ts(e,t-2)]:(t!==i+2&&(n=d0(e,a-i-2,o,r)),[o,n])}function vj(e){var t;if(zo(e,e.l+6)!==65535)return[Yn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function wj(e){if(e==null){var t=Je(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return oA(e);return oA(0)}function Lg(e,t,r){var a=e.l+t,n=wo(e);r.biff==2&&++e.l;var i=vj(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=gj(e,a-e.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Ej(e,t,r,a,n){var i=cA(t,r,n),o=wj(e.v),l=Je(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=Je(e.bf.length),d=0;d<e.bf.length;++d)A[d]=e.bf[d];var f=xn([i,o,l,A]);return f}function _m(e,t,r){var a=e.read_shift(4),n=u0(e,a,r),i=e.read_shift(4),o=i>0?d0(e,i,n,r):null;return[n,o]}var bj=_m,Cm=_m,_j=_m,Cj=_m,Bj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Sj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Y4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Tj(e){var t="of:="+e.replace(my,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ug(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Oj(e){return e.replace(/\./,"!")}var ff={},Id={},pf=typeof Map<"u";function yy(e,t,r){var a=0,n=e.length;if(r){if(pf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=pf?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(pf?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Bm(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(zn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Kf(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Lh(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Wc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function pc(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){ho(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function rC(e,t,r,a,n,i){try{a.cellNF&&(e.z=zt[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ca(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(zt[t]==null&&ho(C3[t]||"General",t),e.t==="e")e.w=e.w||ol[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jf(e.v);else if(e.t==="d"){var o=ln(e.v);(o|0)===o?e.w=o.toString(10):e.w=jf(o)}else{if(e.v===void 0)return"";e.w=sA(e.v,Id)}else e.t==="d"?e.w=si(t,ln(e.v),Id):e.w=si(t,e.v,Id)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=jh(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=jh(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function Ij(e,t,r){if(e&&e["!ref"]){var a=xr(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Nj(e,t){var r=xr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=lr(r))}var Fj=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,kj=/<(?:\w:)?hyperlink [^>]*>/mg,Dj=/"(\w*:\w*)"/,jj=/<(?:\w:)?col\b[^>]*[\/]?>/g,Lj=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Uj=/<(?:\w:)?pageMargins[^>]*\/>/g,aC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Mj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Pj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Qj(e,t,r,a,n,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",d="",f=e.match(Rj);f?(A=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):A=d=e;var p=A.match(aC);p?vy(p[0],l,n,r):(p=A.match(Mj))&&Kj(p[0],p[1]||"",l,n,r);var u=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var g=A.slice(u,u+50).match(Dj);g&&Nj(l,g[1])}var h=A.match(Pj);h&&h[1]&&r8(h[1],n);var x=[];if(t.cellStyles){var y=A.match(jj);y&&Xj(x,y)}f&&s8(f[1],l,t,c,i,o);var v=d.match(Lj);v&&(l["!autofilter"]=Zj(v[0]));var E=[],k=d.match(Fj);if(k)for(u=0;u!=k.length;++u)E[u]=xr(k[u].slice(k[u].indexOf('"')+1));var S=d.match(kj);S&&$j(l,S,a);var B=d.match(Uj);if(B&&(l["!margins"]=Yj(Jt(B[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=lr(c)),t.sheetRows>0&&l["!ref"]){var b=xr(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>c.e.r&&(b.e.r=c.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>c.e.c&&(b.e.c=c.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=lr(b))}return x.length>0&&(l["!cols"]=x),E.length>0&&(l["!merges"]=E),l}function qj(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+lr(e[r])+'"/>';return t+"</mergeCells>"}function vy(e,t,r,a){var n=Jt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Tr(Vr(n.codeName)))}function Kj(e,t,r,a,n){vy(e.slice(0,e.indexOf(">")),r,a,n)}function Hj(e,t,r,a,n){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=uo(Hr(c))}if(e&&e["!outline"]){var A={summaryBelow:1,summaryRight:1};e["!outline"].above&&(A.summaryBelow=0),e["!outline"].left&&(A.summaryRight=0),l=(l||"")+gt("outlinePr",null,A)}!i&&!l||(n[n.length]=gt("sheetPr",l,o))}var Gj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],zj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Vj(e){var t={sheet:1};return Gj.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),zj.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=fy(e.password).toString(16).toUpperCase()),gt("sheetProtection",null,t)}function $j(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=Jt(Vr(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Tr(i.location))):(i.Target="#"+Tr(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=xr(i.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var d=Wt({c:A,r:c});a?(e[c]||(e[c]=[]),e[c][A]||(e[c][A]={t:"z",v:void 0}),e[c][A].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function Yj(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Wj(e){return Wc(e),gt("pageMargins",null,e)}function Xj(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Jt(t[a],!0);n.hidden&&(n.hidden=sa(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,py(n.width)),sc(n);i<=o;)e[i++]=ta(n)}}function Jj(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=gt("col",null,Bm(n,a)));return r[r.length]="</cols>",r.join("")}function Zj(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function e8(e,t,r,a){var n=typeof e.ref=="string"?e.ref:lr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=xs(n);o.s.r==o.e.r&&(o.e.r=xs(t["!ref"]).e.r,n=lr(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),gt("autoFilter",null,{ref:n})}var t8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function r8(e,t){t.Views||(t.Views=[{}]),(e.match(t8)||[]).forEach(function(r,a){var n=Jt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),sa(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function a8(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),gt("sheetViews",gt("sheetView",null,n),{})}function n8(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=ol[e.v];break;case"d":a&&a.cellDates?n=ca(e.v,-1).toISOString():(e=ta(e),e.t="n",n=""+(e.v=ln(ca(e.v)))),typeof e.z>"u"&&(e.z=zt[14]);break;default:n=e.v;break}var l=On("v",Hr(n)),c={r:t},A=pc(a.cellXfs,e,a);switch(A!==0&&(c.s=A),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=On("v",""+yy(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=gt("f",Hr(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),gt("c",l,c)}var s8=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=Lf("v"),o=Lf("f");return function(c,A,d,f,p,u){for(var g=0,h="",x=[],y=[],v=0,E=0,k=0,S="",B,b,O=0,_=0,U,I,R=0,L=0,N=Array.isArray(u.CellXf),P,Q=[],Y=[],ee=Array.isArray(A),V=[],G={},z=!1,C=!!d.sheetStubs,D=c.split(t),j=0,K=D.length;j!=K;++j){h=D[j].trim();var W=h.length;if(W!==0){var Ae=0;e:for(g=0;g<W;++g)switch(h[g]){case">":if(h[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(b=Jt(h.slice(Ae,g),!0),O=b.r!=null?parseInt(b.r,10):O+1,_=-1,d.sheetRows&&d.sheetRows<O)continue;G={},z=!1,b.ht&&(z=!0,G.hpt=parseFloat(b.ht),G.hpx=Kd(G.hpt)),b.hidden=="1"&&(z=!0,G.hidden=!0),b.outlineLevel!=null&&(z=!0,G.level=+b.outlineLevel),z&&(V[O-1]=G)}break;case"<":Ae=g;break}if(Ae>=g)break;if(b=Jt(h.slice(Ae,g),!0),O=b.r!=null?parseInt(b.r,10):O+1,_=-1,!(d.sheetRows&&d.sheetRows<O)){f.s.r>O-1&&(f.s.r=O-1),f.e.r<O-1&&(f.e.r=O-1),d&&d.cellStyles&&(G={},z=!1,b.ht&&(z=!0,G.hpt=parseFloat(b.ht),G.hpx=Kd(G.hpt)),b.hidden=="1"&&(z=!0,G.hidden=!0),b.outlineLevel!=null&&(z=!0,G.level=+b.outlineLevel),z&&(V[O-1]=G)),x=h.slice(g).split(e);for(var ue=0;ue!=x.length&&x[ue].trim().charAt(0)=="<";++ue);for(x=x.slice(ue),g=0;g!=x.length;++g)if(h=x[g].trim(),h.length!==0){if(y=h.match(r),v=g,E=0,k=0,h="<c "+(h.slice(0,1)=="<"?">":"")+h,y!=null&&y.length===2){for(v=0,S=y[1],E=0;E!=S.length&&!((k=S.charCodeAt(E)-64)<1||k>26);++E)v=26*v+k;--v,_=v}else++_;for(E=0;E!=h.length&&h.charCodeAt(E)!==62;++E);if(++E,b=Jt(h.slice(0,E),!0),b.r||(b.r=Wt({r:O-1,c:_})),S=h.slice(E),B={t:""},(y=S.match(i))!=null&&y[1]!==""&&(B.v=Tr(y[1])),d.cellFormula){if((y=S.match(o))!=null&&y[1]!==""){if(B.f=Tr(Vr(y[1])).replace(/\r\n/g,`
`),d.xlfn||(B.f=G4(B.f)),y[0].indexOf('t="array"')>-1)B.F=(S.match(n)||[])[1],B.F.indexOf(":")>-1&&Q.push([xr(B.F),B.F]);else if(y[0].indexOf('t="shared"')>-1){I=Jt(y[0]);var he=Tr(Vr(y[1]));d.xlfn||(he=G4(he)),Y[parseInt(I.si,10)]=[I,he,b.r]}}else(y=S.match(/<f[^>]*\/>/))&&(I=Jt(y[0]),Y[I.si]&&(B.f=tD(Y[I.si][1],Y[I.si][2],b.r)));var ve=ga(b.r);for(E=0;E<Q.length;++E)ve.r>=Q[E][0].s.r&&ve.r<=Q[E][0].e.r&&ve.c>=Q[E][0].s.c&&ve.c<=Q[E][0].e.c&&(B.F=Q[E][1])}if(b.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(C)B.t="z";else continue;else B.t=b.t||"n";switch(f.s.c>_&&(f.s.c=_),f.e.c<_&&(f.e.c=_),B.t){case"n":if(B.v==""||B.v==null){if(!C)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!C)continue;B.t="z"}else U=ff[parseInt(B.v,10)],B.v=U.t,B.r=U.r,d.cellHTML&&(B.h=U.h);break;case"str":B.t="s",B.v=B.v!=null?Vr(B.v):"",d.cellHTML&&(B.h=$2(B.v));break;case"inlineStr":y=S.match(a),B.t="s",y!=null&&(U=uy(y[1]))?(B.v=U.t,d.cellHTML&&(B.h=U.h)):B.v="";break;case"b":B.v=sa(B.v);break;case"d":d.cellDates?B.v=ca(B.v,1):(B.v=ln(ca(B.v,1)),B.t="n");break;case"e":(!d||d.cellText!==!1)&&(B.w=B.v),B.v=s5[B.v];break}if(R=L=0,P=null,N&&b.s!==void 0&&(P=u.CellXf[b.s],P!=null&&(P.numFmtId!=null&&(R=P.numFmtId),d.cellStyles&&P.fillId!=null&&(L=P.fillId))),rC(B,R,L,d,p,u),d.cellDates&&N&&B.t=="n"&&fA(zt[R])&&(B.t="d",B.v=wm(B.v)),b.cm&&d.xlmeta){var we=(d.xlmeta.Cell||[])[+b.cm-1];we&&we.type=="XLDAPR"&&(B.D=!0)}if(ee){var se=ga(b.r);A[se.r]||(A[se.r]=[]),A[se.r][se.c]=B}else A[b.r]=B}}}}V.length>0&&(A["!rows"]=V)}}();function i8(e,t,r,a){var n=[],i=[],o=xr(e["!ref"]),l="",c,A="",d=[],f=0,p=0,u=e["!rows"],g=Array.isArray(e),h={r:A},x,y=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=la(p);for(f=o.s.r;f<=o.e.r;++f){for(i=[],A=Sa(f),p=o.s.c;p<=o.e.c;++p){c=d[p]+A;var v=g?(e[f]||[])[p]:e[c];v!==void 0&&(l=n8(v,c,e,t))!=null&&i.push(l)}(i.length>0||u&&u[f])&&(h={r:A},u&&u[f]&&(x=u[f],x.hidden&&(h.hidden=1),y=-1,x.hpx?y=Hf(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(h.ht=y,h.customHeight=1),x.level&&(h.outlineLevel=x.level)),n[n.length]=gt("row",i.join(""),h))}if(u)for(;f<u.length;++f)u&&u[f]&&(h={r:f+1},x=u[f],x.hidden&&(h.hidden=1),y=-1,x.hpx?y=Hf(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(h.ht=y,h.customHeight=1),x.level&&(h.outlineLevel=x.level),n[n.length]=gt("row","",h));return n.join("")}function nC(e,t,r,a){var n=[Qa,gt("worksheet",null,{xmlns:pA[0],"xmlns:r":sn.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var A=c["!ref"]||"A1",d=xr(A);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),A=lr(d)}a||(a={}),c["!comments"]=[];var f=[];Hj(c,r,e,t,n),n[n.length]=gt("dimension",null,{ref:A}),n[n.length]=a8(c,t,e,r),t.sheetFormat&&(n[n.length]=gt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Jj(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=i8(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=Vj(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=e8(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=qj(c["!merges"]));var p=-1,u,g=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(u={ref:h[0]},h[1].Target.charAt(0)!="#"&&(g=qr(a,-1,Hr(h[1].Target).replace(/#.*$/,""),fr.HLINK),u["r:id"]="rId"+g),(p=h[1].Target.indexOf("#"))>-1&&(u.location=Hr(h[1].Target.slice(p+1))),h[1].Tooltip&&(u.tooltip=Hr(h[1].Tooltip)),n[n.length]=gt("hyperlink",null,u))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=Wj(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=On("ignoredErrors",gt("ignoredError",null,{numberStoredAsText:1,sqref:A}))),f.length>0&&(g=qr(a,-1,"../drawings/drawing"+(e+1)+".xml",fr.DRAW),n[n.length]=gt("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=qr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",fr.VML),n[n.length]=gt("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function o8(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function l8(e,t,r){var a=Je(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=Hf(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var A={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,p=-1,u=d<<10;u<d+1<<10;++u){A.c=u;var g=Array.isArray(r)?(r[A.r]||[])[A.c]:r[Wt(A)];g&&(f<0&&(f=u),p=u)}f<0||(++l,a.write_shift(4,f),a.write_shift(4,p))}var h=a.l;return a.l=c,a.write_shift(4,l),a.l=h,a.length>a.l?a.slice(0,a.l):a}function c8(e,t,r,a){var n=l8(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&st(e,0,n)}var A8=xA,d8=Xd;function u8(){}function f8(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=mN(e),r}function p8(e,t,r){r==null&&(r=Je(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Rh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),e5(e,r),r.slice(0,r.l)}function h8(e){var t=Ni(e);return[t]}function m8(e,t,r){return r==null&&(r=Je(8)),hA(t,r)}function g8(e){var t=mA(e);return[t]}function x8(e,t,r){return r==null&&(r=Je(4)),gA(t,r)}function y8(e){var t=Ni(e),r=e.read_shift(1);return[t,r,"b"]}function v8(e,t,r){return r==null&&(r=Je(9)),hA(t,r),r.write_shift(1,e.v?1:0),r}function w8(e){var t=mA(e),r=e.read_shift(1);return[t,r,"b"]}function E8(e,t,r){return r==null&&(r=Je(5)),gA(t,r),r.write_shift(1,e.v?1:0),r}function b8(e){var t=Ni(e),r=e.read_shift(1);return[t,r,"e"]}function _8(e,t,r){return r==null&&(r=Je(9)),hA(t,r),r.write_shift(1,e.v),r}function C8(e){var t=mA(e),r=e.read_shift(1);return[t,r,"e"]}function B8(e,t,r){return r==null&&(r=Je(8)),gA(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function S8(e){var t=Ni(e),r=e.read_shift(4);return[t,r,"s"]}function T8(e,t,r){return r==null&&(r=Je(12)),hA(t,r),r.write_shift(4,t.v),r}function O8(e){var t=mA(e),r=e.read_shift(4);return[t,r,"s"]}function I8(e,t,r){return r==null&&(r=Je(8)),gA(t,r),r.write_shift(4,t.v),r}function N8(e){var t=Ni(e),r=Yn(e);return[t,r,"n"]}function F8(e,t,r){return r==null&&(r=Je(16)),hA(t,r),oA(e.v,r),r}function sC(e){var t=mA(e),r=Yn(e);return[t,r,"n"]}function R8(e,t,r){return r==null&&(r=Je(12)),gA(t,r),oA(e.v,r),r}function k8(e){var t=Ni(e),r=oy(e);return[t,r,"n"]}function D8(e,t,r){return r==null&&(r=Je(12)),hA(t,r),t5(e.v,r),r}function j8(e){var t=mA(e),r=oy(e);return[t,r,"n"]}function L8(e,t,r){return r==null&&(r=Je(8)),gA(t,r),t5(e.v,r),r}function U8(e){var t=Ni(e),r=ny(e);return[t,r,"is"]}function M8(e){var t=Ni(e),r=Zn(e);return[t,r,"str"]}function P8(e,t,r){return r==null&&(r=Je(12+4*e.v.length)),hA(t,r),vn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Q8(e){var t=mA(e),r=Zn(e);return[t,r,"str"]}function q8(e,t,r){return r==null&&(r=Je(8+4*e.v.length)),gA(t,r),vn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function K8(e,t,r){var a=e.l+t,n=Ni(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=Cm(e,a-e.l,r);o[3]=Hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function H8(e,t,r){var a=e.l+t,n=Ni(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=Cm(e,a-e.l,r);o[3]=Hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function G8(e,t,r){var a=e.l+t,n=Ni(e);n.r=r["!row"];var i=Yn(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=Cm(e,a-e.l,r);o[3]=Hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function z8(e,t,r){var a=e.l+t,n=Ni(e);n.r=r["!row"];var i=Zn(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=Cm(e,a-e.l,r);o[3]=Hn(l,null,n,r.supbooks,r)}else e.l=a;return o}var V8=xA,$8=Xd;function Y8(e,t){return t==null&&(t=Je(4)),t.write_shift(4,e),t}function W8(e,t){var r=e.l+t,a=xA(e),n=sy(e),i=Zn(e),o=Zn(e),l=Zn(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function X8(e,t){var r=Je(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Xd({s:ga(e[0]),e:ga(e[0])},r),iy("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return vn(n||"",r),vn(e[1].Tooltip||"",r),vn("",r),r.slice(0,r.l)}function J8(){}function Z8(e,t,r){var a=e.l+t,n=r5(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=bj(e,a-e.l,r);o[1]=l}else e.l=a;return o}function eL(e,t,r){var a=e.l+t,n=xA(e),i=[n];if(r.cellFormula){var o=Cj(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function tL(e,t,r){r==null&&(r=Je(18));var a=Bm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var iC=["left","right","top","bottom","header","footer"];function rL(e){var t={};return iC.forEach(function(r){t[r]=Yn(e)}),t}function aL(e,t){return t==null&&(t=Je(6*8)),Wc(e),iC.forEach(function(r){oA(e[r],t)}),t}function nL(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sL(e,t,r){r==null&&(r=Je(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iL(e){var t=Je(24);return t.write_shift(4,4),t.write_shift(4,1),Xd(e,t),t}function oL(e,t){return t==null&&(t=Je(16*4+2)),t.write_shift(2,e.password?fy(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lL(){}function cL(){}function AL(e,t,r,a,n,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},A,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,u,g,h,x,y,v,E,k,S,B=[];l.biff=12,l["!row"]=0;var b=0,O=!1,_=[],U={},I=l.supbooks||n.supbooks||[[]];if(I.sharedf=U,I.arrayf=_,I.SheetNames=n.SheetNames||n.Sheets.map(function(ee){return ee.name}),!l.supbooks&&(l.supbooks=I,n.Names))for(var R=0;R<n.Names.length;++R)I[0][R+1]=n.Names[R];var L=[],N=[],P=!1;Gf[16]={n:"BrtShortReal",f:sC};var Q;if(il(e,function(V,G,z){if(!p)switch(z){case 148:A=V;break;case 0:u=V,l.sheetRows&&l.sheetRows<=u.r&&(p=!0),k=Sa(x=u.r),l["!row"]=u.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Kd(V.hpt)),N[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:V[2]},V[2]){case"n":g.v=V[1];break;case"s":E=ff[V[1]],g.v=E.t,g.r=E.r;break;case"b":g.v=!!V[1];break;case"e":g.v=V[1],l.cellText!==!1&&(g.w=ol[g.v]);break;case"str":g.t="s",g.v=V[1];break;case"is":g.t="s",g.v=V[1].t;break}if((h=o.CellXf[V[0].iStyleRef])&&rC(g,h.numFmtId,null,l,i,o),y=V[0].c==-1?y+1:V[0].c,l.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[la(y)+k]=g,l.cellFormula){for(O=!1,b=0;b<_.length;++b){var C=_[b];u.r>=C[0].s.r&&u.r<=C[0].e.r&&y>=C[0].s.c&&y<=C[0].e.c&&(g.F=lr(C[0]),O=!0)}!O&&V.length>3&&(g.f=V[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>y&&(d.s.c=y),d.e.r<u.r&&(d.e.r=u.r),d.e.c<y&&(d.e.c=y),l.cellDates&&h&&g.t=="n"&&fA(zt[h.numFmtId])){var D=Ql(g.v);D&&(g.t="d",g.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}Q&&(Q.type=="XLDAPR"&&(g.D=!0),Q=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;g={t:"z",v:void 0},y=V[0].c==-1?y+1:V[0].c,l.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[la(y)+k]=g,d.s.r>u.r&&(d.s.r=u.r),d.s.c>y&&(d.s.c=y),d.e.r<u.r&&(d.e.r=u.r),d.e.c<y&&(d.e.c=y),Q&&(Q.type=="XLDAPR"&&(g.D=!0),Q=void 0);break;case 176:B.push(V);break;case 49:Q=((l.xlmeta||{}).Cell||[])[V-1];break;case 494:var j=a["!id"][V.relId];for(j?(V.Target=j.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=j):V.relId==""&&(V.Target="#"+V.loc),x=V.rfx.s.r;x<=V.rfx.e.r;++x)for(y=V.rfx.s.c;y<=V.rfx.e.c;++y)l.dense?(c[x]||(c[x]=[]),c[x][y]||(c[x][y]={t:"z",v:void 0}),c[x][y].l=V):(v=Wt({c:y,r:x}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=V);break;case 426:if(!l.cellFormula)break;_.push(V),S=l.dense?c[x][y]:c[la(y)+k],S.f=Hn(V[1],d,{r:u.r,c:y},I,l),S.F=lr(V[0]);break;case 427:if(!l.cellFormula)break;U[Wt(V[0].s)]=V[1],S=l.dense?c[x][y]:c[la(y)+k],S.f=Hn(V[1],d,{r:u.r,c:y},I,l);break;case 60:if(!l.cellStyles)break;for(;V.e>=V.s;)L[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},P||(P=!0,py(V.w/256)),sc(L[V.e+1]);break;case 161:c["!autofilter"]={ref:lr(V)};break;case 476:c["!margins"]=V;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),V.name&&(n.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!G.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=lr(A||d)),l.sheetRows&&c["!ref"]){var Y=xr(c["!ref"]);l.sheetRows<=+Y.e.r&&(Y.e.r=l.sheetRows-1,Y.e.r>d.e.r&&(Y.e.r=d.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>d.e.c&&(Y.e.c=d.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=lr(Y))}return B.length>0&&(c["!merges"]=B),L.length>0&&(c["!cols"]=L),N.length>0&&(c["!rows"]=N),c}function dL(e,t,r,a,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ta(t),t.z=t.z||zt[14],t.v=ln(ca(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=pc(n.cellXfs,t,n),t.l&&i["!links"].push([Wt(c),t.l]),t.c&&i["!comments"].push([Wt(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=yy(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?st(e,18,I8(t,c)):st(e,7,T8(t,c))):(c.t="str",o?st(e,17,q8(t,c)):st(e,6,P8(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?st(e,13,L8(t,c)):st(e,2,D8(t,c)):o?st(e,16,R8(t,c)):st(e,5,F8(t,c)),!0;case"b":return c.t="b",o?st(e,15,E8(t,c)):st(e,4,v8(t,c)),!0;case"e":return c.t="e",o?st(e,14,B8(t,c)):st(e,3,_8(t,c)),!0}return o?st(e,12,x8(t,c)):st(e,1,m8(t,c)),!0}function uL(e,t,r,a){var n=xr(t["!ref"]||"A1"),i,o="",l=[];st(e,145);var c=Array.isArray(t),A=n.e.r;t["!rows"]&&(A=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=A;++d){o=Sa(d),c8(e,t,n,d);var f=!1;if(d<=n.e.r)for(var p=n.s.c;p<=n.e.c;++p){d===n.s.r&&(l[p]=la(p)),i=l[p]+o;var u=c?(t[d]||[])[p]:t[i];if(!u){f=!1;continue}f=dL(e,u,d,p,a,t,f)}}st(e,146)}function fL(e,t){!t||!t["!merges"]||(st(e,177,Y8(t["!merges"].length)),t["!merges"].forEach(function(r){st(e,176,$8(r))}),st(e,178))}function pL(e,t){!t||!t["!cols"]||(st(e,390),t["!cols"].forEach(function(r,a){r&&st(e,60,tL(a,r))}),st(e,391))}function hL(e,t){!t||!t["!ref"]||(st(e,648),st(e,649,iL(xr(t["!ref"]))),st(e,650))}function mL(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=qr(r,-1,a[1].Target.replace(/#.*$/,""),fr.HLINK);st(e,494,X8(a,n))}}),delete t["!links"]}function gL(e,t,r,a){if(t["!comments"].length>0){var n=qr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",fr.VML);st(e,551,iy("rId"+n)),t["!legacy"]=n}}function xL(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:lr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=xs(i);l.s.r==l.e.r&&(l.e.r=xs(t["!ref"]).e.r,i=lr(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==a){A.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),st(e,161,Xd(xr(i))),st(e,162)}}function yL(e,t,r){st(e,133),st(e,137,sL(t,r)),st(e,138),st(e,134)}function vL(e,t){t["!protect"]&&st(e,535,oL(t["!protect"]))}function wL(e,t,r,a){var n=Fs(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=xr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],st(n,129),(r.vbaraw||o["!outline"])&&st(n,147,p8(l,o["!outline"])),st(n,148,d8(c)),yL(n,o,r.Workbook),pL(n,o),uL(n,o,e,t),vL(n,o),xL(n,o,r,e),fL(n,o),mL(n,o,a),o["!margins"]&&st(n,476,aL(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&hL(n,o),gL(n,o,e,a),st(n,130),n.end()}function EL(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Tr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function bL(e,t,r,a,n,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,A="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=EL(f);d.s.r=d.s.c=0,d.e.c=l,A=la(l),p[0].forEach(function(u,g){o[A+Sa(g)]={t:"n",v:u,z:p[1]},c=g}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=lr(d)),o}function _L(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(aC);return l&&vy(l[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function CL(e,t){e.l+=10;var r=Zn(e);return{name:r}}function BL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return il(e,function(c,A,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var wy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],SL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TL=[],OL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function W4(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=sa(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function X4(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=sa(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function oC(e){X4(e.WBProps,wy),X4(e.CalcPr,OL),W4(e.WBView,SL),W4(e.Sheets,TL),Id.date1904=sa(e.WBProps.date1904)}function IL(e){return!e.Workbook||!e.Workbook.WBProps?"false":sa(e.Workbook.WBProps.date1904)?"true":"false"}var NL="][*?/\\".split("");function lC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NL.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function FL(e,t,r){e.forEach(function(a,n){lC(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function cC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];FL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Ij(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var RL=/<\w+:workbook/;function kL(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},o=0;if(e.replace(rs,function(c,A){var d=Jt(c);switch(vo(d[0])){case"<?xml":break;case"<workbook":c.match(RL)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":wy.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=sa(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Vr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Tr(Vr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Vr(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),sa(d.hidden||"0")&&(i.Hidden=!0),o=A+c.length;break;case"</definedName>":i.Ref=Tr(Vr(e.slice(o,A))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),pA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return oC(r),r}function AC(e){var t=[Qa];t[t.length]=gt("workbook",null,{xmlns:pA[0],"xmlns:r":sn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(wy.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=gt("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Hr(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=gt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=gt("definedName",Hr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function DL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Tx(e),r.name=Zn(e),r}function jL(e,t){return t||(t=Je(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),iy(e.strRelID,t),vn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function LL(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Zn(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function UL(e,t){t||(t=Je(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),e5(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ML(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function PL(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=gN(e),o=_j(e,0,r),l=sy(e);e.l=a;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function QL(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Gf[16]={n:"BrtFRTArchID$",f:ML},il(e,function(c,A,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Hn(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!A.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),oC(r),r.Names=i,r.supbooks=o,r}function qL(e,t){st(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};st(e,156,jL(n))}st(e,144)}function KL(e,t){t||(t=Je(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return vn("SheetJS",t),vn(kf.version,t),vn(kf.version,t),vn("7262",t),t.length>t.l?t.slice(0,t.l):t}function HL(e,t){t||(t=Je(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function GL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(st(e,135),st(e,158,HL(n)),st(e,136))}}function zL(e,t){var r=Fs();return st(r,131),st(r,128,KL()),st(r,153,UL(e.Workbook&&e.Workbook.WBProps||null)),GL(r,e),qL(r,e),st(r,132),r.end()}function VL(e,t,r){return t.slice(-4)===".bin"?QL(e,r):kL(e,r)}function $L(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?AL(e,a,r,n,i,o,l):Qj(e,a,r,n,i,o,l)}function YL(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?BL(e,a,r,n,i):_L(e,a,r,n,i)}function WL(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?Zk():eD()}function XL(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?Xk():Jk()}function JL(e,t,r,a){return t.slice(-4)===".bin"?$6(e,r,a):j6(e,r,a)}function ZL(e,t,r){return K5(e,r)}function eU(e,t,r){return t.slice(-4)===".bin"?t6(e,r):JR(e,r)}function tU(e,t,r){return t.slice(-4)===".bin"?zk(e,r):Lk(e,r)}function rU(e,t,r){return t.slice(-4)===".bin"?kk(e):Fk(e)}function aU(e,t,r,a){return r.slice(-4)===".bin"?Dk(e,t,r,a):void 0}function nU(e,t,r){return t.slice(-4)===".bin"?Ok(e,t,r):Nk(e,t,r)}function sU(e,t,r){return(t.slice(-4)===".bin"?zL:AC)(e)}function iU(e,t,r,a,n){return(t.slice(-4)===".bin"?wL:nC)(e,r,a,n)}function oU(e,t,r){return(t.slice(-4)===".bin"?nk:Q5)(e,r)}function lU(e,t,r){return(t.slice(-4)===".bin"?n6:R5)(e,r)}function cU(e,t,r){return(t.slice(-4)===".bin"?Vk:z5)(e)}function AU(e){return(e.slice(-4)===".bin"?Ik:H5)()}var dC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ji(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(dC),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(uC),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function dU(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(dC),n,i,o,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(uC),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var hf;function uU(e,t){var r=hf[e]||Tr(e);return r==="General"?sA(t):si(r,t)}function fU(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=sa(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=ca(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Tr(t)]=n}function pU(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ol[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jf(e.v):e.w=sA(e.v):e.w=uU(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=hf[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&fA(a)){var n=Ql(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function hU(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=T6[a.Pattern]||a.Pattern)}e[t.ID]=t}function mU(e,t,r,a,n,i,o,l,c,A){var d="General",f=a.StyleID,p={};A=A||{};var u=[],g=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&u.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=sa(e);break;case"String":a.t="s",a.r=p4(Tr(e)),a.v=e.indexOf("<")>-1?Tr(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(ca(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Tr(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=s5[e],A.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=p4(t||e));break}if(pU(a,d,A),A.cellFormula!==!1)if(a.Formula){var h=Tr(a.Formula);h.charCodeAt(0)==61&&(h=h.slice(1)),a.f=Od(h,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Od("RC:RC",n):a.ArrayRange&&(a.F=Od(a.ArrayRange,n),c.push([xr(a.F),a.F]))}else for(g=0;g<c.length;++g)n.r>=c[g][0].s.r&&n.r<=c[g][0].e.r&&n.c>=c[g][0].s.c&&n.c<=c[g][0].e.c&&(a.F=c[g][1]);A.cellStyles&&(u.forEach(function(x){!p.patternType&&x.patternType&&(p.patternType=x.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function gU(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Mg(e,t){var r=t||{};$d();var a=yd(Y2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof _r<"u"?a=_r.utils.decode(65001,Bh(a)):a=Vr(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=ta(r);return o.type="string",qd.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(et){n.indexOf("<"+et)>=0&&(i=!0)}),i)return ZU(a,r);hf={"General Number":"General","General Date":zt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":zt[15],"Short Date":zt[14],"Long Time":zt[19],"Medium Time":zt[18],"Short Time":zt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:zt[2],Standard:zt[4],Percent:zt[10],Scientific:zt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,d={},f=[],p=r.dense?[]:{},u="",g={},h={},x=ji('<Data ss:Type="String">'),y=0,v=0,E=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},B={},b="",O=0,_=[],U={},I={},R=0,L=[],N=[],P={},Q=[],Y,ee=!1,V=[],G=[],z={},C=0,D=0,j={Sheets:[],WBProps:{date1904:!1}},K={};Mf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";l=Mf.exec(a);)switch(l[3]=(W=l[3]).toLowerCase()){case"data":if(W=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?mU(a.slice(y,l.index),b,x,c[c.length-1][0]=="comment"?P:g,{c:v,r:E},S,Q[v],h,V,r):(b="",x=ji(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(N.length>0&&(g.c=N),(!r.sheetRows||r.sheetRows>E)&&g.v!==void 0&&(r.dense?(p[E]||(p[E]=[]),p[E][v]=g):p[la(v)+Sa(E)]=g),g.HRef&&(g.l={Target:Tr(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(C=v+(parseInt(g.MergeAcross,10)|0),D=E+(parseInt(g.MergeDown,10)|0),_.push({s:{c:v,r:E},e:{c:C,r:D}})),!r.sheetStubs)g.MergeAcross?v=C+1:++v;else if(g.MergeAcross||g.MergeDown){for(var Ae=v;Ae<=C;++Ae)for(var ue=E;ue<=D;++ue)(Ae>v||ue>E)&&(r.dense?(p[ue]||(p[ue]=[]),p[ue][Ae]={t:"z"}):p[la(Ae)+Sa(ue)]={t:"z"});v=C+1}else++v;else g=dU(l[0]),g.Index&&(v=+g.Index-1),v<k.s.c&&(k.s.c=v),v>k.e.c&&(k.e.c=v),l[0].slice(-2)==="/>"&&++v,N=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(E<k.s.r&&(k.s.r=E),E>k.e.r&&(k.e.r=E),l[0].slice(-2)==="/>"&&(h=ji(l[0]),h.Index&&(E=+h.Index-1)),v=0,++E):(h=ji(l[0]),h.Index&&(E=+h.Index-1),z={},(h.AutoFitHeight=="0"||h.Height)&&(z.hpx=parseInt(h.Height,10),z.hpt=Hf(z.hpx),G[E]=z),h.Hidden=="1"&&(z.hidden=!0,G[E]=z));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));f.push(u),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(p["!ref"]=lr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=r.sheetRows-1,p["!ref"]=lr(k))),_.length&&(p["!merges"]=_),Q.length>0&&(p["!cols"]=Q),G.length>0&&(p["!rows"]=G),d[u]=p}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=v=0,c.push([l[3],!1]),A=ji(l[0]),u=Tr(A.Name),p=r.dense?[]:{},_=[],V=[],G=[],K={name:u,Hidden:0},j.Sheets.push(K);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),Q=[],ee=!1}break;case"style":l[1]==="/"?hU(S,B,r):B=ji(l[0]);break;case"numberformat":B.nf=Tr(ji(l[0]).Format||"General"),hf[B.nf]&&(B.nf=hf[B.nf]);for(var he=0;he!=392&&zt[he]!=B.nf;++he);if(he==392){for(he=57;he!=392;++he)if(zt[he]==null){ho(B.nf,he);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=ji(l[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!ee&&Y.wpx>10){ee=!0,zn=M5;for(var ve=0;ve<Q.length;++ve)Q[ve]&&sc(Q[ve])}ee&&sc(Y),Q[Y.Index-1||Q.length]=Y;for(var we=0;we<+Y.Span;++we)Q[Q.length]=ta(Y);break;case"namedrange":if(l[1]==="/")break;j.Names||(j.Names=[]);var se=Jt(l[0]),He={Name:se.Name,Ref:Od(se.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(He.Sheet=j.Sheets.length-1),j.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=a.slice(O,l.index):O=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=ji(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?qN(U,W,a.slice(R,l.index)):R=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));gU(P),N.push(P)}else c.push([l[3],!1]),A=ji(l[0]),P={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ee=ji(l[0]);p["!autofilter"]={ref:Od(Ee.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return rw(a,r);var pe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:pe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:pe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:pe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:pe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(R,l.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else R=l.index+l[0].length;break;case"header":p["!margins"]||Wc(p["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(p["!margins"].header=+Jt(l[0]).Margin);break;case"footer":p["!margins"]||Wc(p["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(p["!margins"].footer=+Jt(l[0]).Margin);break;case"pagemargins":var ce=Jt(l[0]);p["!margins"]||Wc(p["!margins"]={},"xlml"),isNaN(+ce.Top)||(p["!margins"].top=+ce.Top),isNaN(+ce.Left)||(p["!margins"].left=+ce.Left),isNaN(+ce.Right)||(p["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(p["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:pe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:pe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:pe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:pe=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:pe=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:pe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:pe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:pe=!1}break;case"smarttags":break;default:pe=!1;break}if(pe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?fU(I,W,L,a.slice(R,l.index)):(L=l,R=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Ge={};return!r.bookSheets&&!r.bookProps&&(Ge.Sheets=d),Ge.SheetNames=f,Ge.Workbook=j,Ge.SSF=ta(zt),Ge.Props=U,Ge.Custprops=I,Ge}function Dx(e,t){switch(_y(t=t||{}),t.type||"base64"){case"base64":return Mg(ni(e),t);case"binary":case"buffer":case"file":return Mg(e,t);case"array":return Mg(uc(e),t)}}function xU(e,t){var r=[];return e.Props&&r.push(KN(e.Props,t)),e.Custprops&&r.push(HN(e.Props,e.Custprops)),r.join("")}function yU(){return""}function vU(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(gt("NumberFormat",null,{"ss:Format":Hr(zt[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(gt("Style",i.join(""),o))}),gt("Styles",r.join(""))}function fC(e){return gt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+gy(e.Ref,{r:0,c:0})})}function wU(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(fC(n)))}return gt("Names",r.join(""))}function EU(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(fC(l)))}return i.join("")}function bU(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(gt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(gt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(gt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(gt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(On("ProtectContents","True")),e["!protect"].objects&&n.push(On("ProtectObjects","True")),e["!protect"].scenarios&&n.push(On("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(On("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(On("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":gt("WorksheetOptions",n.join(""),{xmlns:Vs.x})}function _U(e){return e.map(function(t){var r=z3(t.t||""),a=gt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return gt("Comment",a,{"ss:Author":t.a})}).join("")}function CU(e,t,r,a,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Hr(gy(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=ga(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Hr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Hr(e.l.Tooltip))),r["!merges"])for(var A=r["!merges"],d=0;d!=A.length;++d)A[d].s.c!=o.c||A[d].s.r!=o.r||(A[d].e.c>A[d].s.c&&(l["ss:MergeAcross"]=A[d].e.c-A[d].s.c),A[d].e.r>A[d].s.r&&(l["ss:MergeDown"]=A[d].e.r-A[d].s.r));var f="",p="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=ol[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||zt[14]);break;case"s":f="String",p=G3(e.v||"");break}var u=pc(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+u),l["ss:Index"]=o.c+1;var g=e.v!=null?p:"",h=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(h+=_U(e.c)),gt("Cell",h,l)}function BU(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Kd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function SU(e,t,r,a){if(!e["!ref"])return"";var n=xr(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(x,y){sc(x);var v=!!x.width,E=Bm(y,x),k={"ss:Index":y+1};v&&(k["ss:Width"]=qf(E.width)),x.hidden&&(k["ss:Hidden"]="1"),l.push(gt("Column",null,k))});for(var c=Array.isArray(e),A=n.s.r;A<=n.e.r;++A){for(var d=[BU(A,(e["!rows"]||[])[A])],f=n.s.c;f<=n.e.c;++f){var p=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>A)&&!(i[o].e.c<f)&&!(i[o].e.r<A)){(i[o].s.c!=f||i[o].s.r!=A)&&(p=!0);break}if(!p){var u={r:A,c:f},g=Wt(u),h=c?(e[A]||[])[f]:e[g];d.push(CU(h,g,e,t,r,a,u))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function TU(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?EU(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?SU(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(bU(i,t,e,r)),a.join("")}function OU(e,t){t||(t={}),e.SSF||(e.SSF=ta(zt)),e.SSF&&($d(),i0(e.SSF),t.revssf=vm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],pc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xU(e,t)),r.push(yU()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(gt("Worksheet",TU(a,t,e),{"ss:Name":Hr(e.SheetNames[a])}));return r[2]=vU(e,t),r[3]=wU(e),Qa+gt("Workbook",r.join(""),{xmlns:Vs.ss,"xmlns:o":Vs.o,"xmlns:x":Vs.x,"xmlns:ss":Vs.ss,"xmlns:dt":Vs.dt,"xmlns:html":Vs.html})}function IU(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=EN(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=bN(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var NU=[60,1084,2066,2165,2175];function FU(e,t,r,a,n){var i=a,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=zo(r,r.l),A=jx[c],d=0;A!=null&&NU.indexOf(c)>-1;)i=zo(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+i),o.push(l),r.l+=4+i,A=jx[c=zo(r,r.l)];var f=xn(o);Sn(f,0);var p=0;f.lens=[];for(var u=0;u<o.length;++u)f.lens.push(p),p+=o[u].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,n)}function ro(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=zt[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ol[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=jf(e.v):e.w=sA(e.v):e.w=si(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&fA(zt[a]||String(a))){var n=Ql(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function hp(e,t,r){return{v:e,ixfe:t,t:r}}function RU(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},o={},l=null,c=[],A="",d={},f,p="",u,g,h,x,y={},v=[],E,k,S=[],B=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},_=function(ut){return ut<8?Vc[ut]:ut<64&&B[ut-8]||Vc[ut]},U=function(ut,ct,wr){var Rt=ct.XF.data;if(!(!Rt||!Rt.patternType||!wr||!wr.cellStyles)){ct.s={},ct.s.patternType=Rt.patternType;var $r;($r=Qf(_(Rt.icvFore)))&&(ct.s.fgColor={rgb:$r}),($r=Qf(_(Rt.icvBack)))&&(ct.s.bgColor={rgb:$r})}},I=function(ut,ct,wr){if(!(z>1)&&!(wr.sheetRows&&ut.r>=wr.sheetRows)){if(wr.cellStyles&&ct.XF&&ct.XF.data&&U(ut,ct,wr),delete ct.ixfe,delete ct.XF,f=ut,p=Wt(ut),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<o.s.r&&(o.s.r=ut.r),ut.c<o.s.c&&(o.s.c=ut.c),ut.r+1>o.e.r&&(o.e.r=ut.r+1),ut.c+1>o.e.c&&(o.e.c=ut.c+1),wr.cellFormula&&ct.f){for(var Rt=0;Rt<v.length;++Rt)if(!(v[Rt][0].s.c>ut.c||v[Rt][0].s.r>ut.r)&&!(v[Rt][0].e.c<ut.c||v[Rt][0].e.r<ut.r)){ct.F=lr(v[Rt][0]),(v[Rt][0].s.c!=ut.c||v[Rt][0].s.r!=ut.r)&&delete ct.f,ct.f&&(ct.f=""+Hn(v[Rt][1],o,ut,V,R));break}}wr.dense?(n[ut.r]||(n[ut.r]=[]),n[ut.r][ut.c]=ct):n[p]=ct}},R={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var L,N=[],P=[],Q=[],Y=[],ee=!1,V=[];V.SheetNames=R.snames,V.sharedf=R.sharedf,V.arrayf=R.arrayf,V.names=[],V.XTI=[];var G=0,z=0,C=0,D=[],j=[],K;R.codepage=1200,Ci(1200);for(var W=!1;e.l<e.length-1;){var Ae=e.l,ue=e.read_shift(2);if(ue===0&&G===10)break;var he=e.l===e.length?0:e.read_shift(2),ve=jx[ue];if(ve&&ve.f){if(t.bookSheets&&G===133&&ue!==133)break;if(G=ue,ve.r===2||ve.r==12){var we=e.read_shift(2);if(he-=2,!R.enc&&we!==ue&&((we&255)<<8|we>>8)!==ue)throw new Error("rt mismatch: "+we+"!="+ue);ve.r==12&&(e.l+=10,he-=10)}var se={};if(ue===10?se=ve.f(e,he,R):se=FU(ue,ve,e,he,R),z==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(ue){case 34:r.opts.Date1904=b.WBProps.date1904=se;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=se,!t.password)throw new Error("File is password-protected");if(se.valid==null)throw new Error("Encryption scheme unsupported");if(!se.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=se;break;case 66:var He=Number(se);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}Ci(R.codepage=He),W=!0;break;case 317:R.rrtabid=se;break;case 25:R.winlocked=se;break;case 439:r.opts.RefreshAll=se;break;case 12:r.opts.CalcCount=se;break;case 16:r.opts.CalcDelta=se;break;case 17:r.opts.CalcIter=se;break;case 13:r.opts.CalcMode=se;break;case 14:r.opts.CalcPrecision=se;break;case 95:r.opts.CalcSaveRecalc=se;break;case 15:R.CalcRefMode=se;break;case 2211:r.opts.FullCalc=se;break;case 129:se.fDialog&&(n["!type"]="dialog"),se.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),se.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(se);break;case 430:V.push([se]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(se);break;case 24:case 536:K={Name:se.Name,Ref:Hn(se.rgce,o,null,V,R)},se.itab>0&&(K.Sheet=se.itab-1),V.names.push(K),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(se),se.Name=="_xlnm._FilterDatabase"&&se.itab>0&&se.rgce&&se.rgce[0]&&se.rgce[0][0]&&se.rgce[0][0][0]=="PtgArea3d"&&(j[se.itab-1]={ref:lr(se.rgce[0][0][1][2])});break;case 22:R.ExternCount=se;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(se),V.XTI=V.XTI.concat(se);break;case 2196:if(R.biff<8)break;K!=null&&(K.Comment=se[1]);break;case 18:n["!protect"]=se;break;case 19:se!==0&&R.WTF&&console.error("Password verifier: "+se);break;case 133:i[se.pos]=se,R.snames.push(se.name);break;case 10:{if(--z)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=lr(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ee=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=lr(o),o.e.r=Ee}o.e.r++,o.e.c++}N.length>0&&(n["!merges"]=N),P.length>0&&(n["!objects"]=P),Q.length>0&&(n["!cols"]=Q),Y.length>0&&(n["!rows"]=Y),b.Sheets.push(O)}A===""?d=n:a[A]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[se.BIFFVer]||8),R.biffguess=se.BIFFVer==0,se.BIFFVer==0&&se.dt==4096&&(R.biff=5,W=!0,Ci(R.codepage=28591)),R.biff==8&&se.BIFFVer==0&&se.dt==16&&(R.biff=2),z++)break;if(n=t.dense?[]:{},R.biff<8&&!W&&(W=!0,Ci(R.codepage=t.codepage||1252)),R.biff<5||se.BIFFVer==0&&se.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var pe={pos:e.l-he,name:A};i[pe.pos]=pe,R.snames.push(A)}else A=(i[Ae]||{name:""}).name;se.dt==32&&(n["!type"]="chart"),se.dt==64&&(n["!type"]="macro"),N=[],P=[],R.arrayf=v=[],Q=[],Y=[],ee=!1,O={Hidden:(i[Ae]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[se.r]||[])[se.c]:n[Wt({c:se.c,r:se.r})])&&++se.c,E={ixfe:se.ixfe,XF:S[se.ixfe]||{},v:se.val,t:"n"},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t);break;case 5:case 517:E={ixfe:se.ixfe,XF:S[se.ixfe],v:se.val,t:se.t},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t);break;case 638:E={ixfe:se.ixfe,XF:S[se.ixfe],v:se.rknum,t:"n"},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t);break;case 189:for(var ce=se.c;ce<=se.C;++ce){var Ge=se.rkrec[ce-se.c][0];E={ixfe:Ge,XF:S[Ge],v:se.rkrec[ce-se.c][1],t:"n"},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:ce,r:se.r},E,t)}break;case 6:case 518:case 1030:{if(se.val=="String"){l=se;break}if(E=hp(se.val,se.cell.ixfe,se.tt),E.XF=S[E.ixfe],t.cellFormula){var et=se.formula;if(et&&et[0]&&et[0][0]&&et[0][0][0]=="PtgExp"){var Ye=et[0][0][1][0],tt=et[0][0][1][1],je=Wt({r:Ye,c:tt});y[je]?E.f=""+Hn(se.formula,o,se.cell,V,R):E.F=((t.dense?(n[Ye]||[])[tt]:n[je])||{}).F}else E.f=""+Hn(se.formula,o,se.cell,V,R)}C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I(se.cell,E,t),l=se}break;case 7:case 519:if(l)l.val=se,E=hp(se,l.cell.ixfe,"s"),E.XF=S[E.ixfe],t.cellFormula&&(E.f=""+Hn(l.formula,o,l.cell,V,R)),C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I(l.cell,E,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(se);var _e=Wt(se[0].s);if(u=t.dense?(n[se[0].s.r]||[])[se[0].s.c]:n[_e],t.cellFormula&&u){if(!l||!_e||!u)break;u.f=""+Hn(se[1],o,se[0],V,R),u.F=lr(se[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;y[Wt(l.cell)]=se[0],u=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[Wt(l.cell)],(u||{}).f=""+Hn(se[0],o,f,V,R)}}break;case 253:E=hp(c[se.isst].t,se.ixfe,"s"),c[se.isst].h&&(E.h=c[se.isst].h),E.XF=S[E.ixfe],C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:se.ixfe,XF:S[se.ixfe],t:"z"},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t));break;case 190:if(t.sheetStubs)for(var At=se.c;At<=se.C;++At){var Ct=se.ixfe[At-se.c];E={ixfe:Ct,XF:S[Ct],t:"z"},C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:At,r:se.r},E,t)}break;case 214:case 516:case 4:E=hp(se.val,se.ixfe,"s"),E.XF=S[E.ixfe],C>0&&(E.z=D[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),I({c:se.c,r:se.r},E,t);break;case 0:case 512:z===1&&(o=se);break;case 252:c=se;break;case 1054:if(R.biff==4){D[C++]=se[1];for(var _t=0;_t<C+163&&zt[_t]!=se[1];++_t);_t>=163&&ho(se[1],C+163)}else ho(se[1],se[0]);break;case 30:{D[C++]=se;for(var Et=0;Et<C+163&&zt[Et]!=se;++Et);Et>=163&&ho(se,C+163)}break;case 229:N=N.concat(se);break;case 93:P[se.cmo[0]]=R.lastobj=se;break;case 438:R.lastobj.TxO=se;break;case 127:R.lastobj.ImData=se;break;case 440:for(x=se[0].s.r;x<=se[0].e.r;++x)for(h=se[0].s.c;h<=se[0].e.c;++h)u=t.dense?(n[x]||[])[h]:n[Wt({c:h,r:x})],u&&(u.l=se[1]);break;case 2048:for(x=se[0].s.r;x<=se[0].e.r;++x)for(h=se[0].s.c;h<=se[0].e.c;++h)u=t.dense?(n[x]||[])[h]:n[Wt({c:h,r:x})],u&&u.l&&(u.l.Tooltip=se[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;u=t.dense?(n[se[0].r]||[])[se[0].c]:n[Wt(se[0])];var Pt=P[se[2]];u||(t.dense?(n[se[0].r]||(n[se[0].r]=[]),u=n[se[0].r][se[0].c]={t:"z"}):u=n[Wt(se[0])]={t:"z"},o.e.r=Math.max(o.e.r,se[0].r),o.s.r=Math.min(o.s.r,se[0].r),o.e.c=Math.max(o.e.c,se[0].c),o.s.c=Math.min(o.s.c,se[0].c)),u.c||(u.c=[]),g={a:se[1],t:Pt.TxO.t},u.c.push(g)}break;case 2173:wk(S[se.ixfe],se.ext);break;case 125:{if(!R.cellStyles)break;for(;se.e>=se.s;)Q[se.e--]={width:se.w/256,level:se.level||0,hidden:!!(se.flags&1)},ee||(ee=!0,py(se.w/256)),sc(Q[se.e+1])}break;case 520:{var Lt={};se.level!=null&&(Y[se.r]=Lt,Lt.level=se.level),se.hidden&&(Y[se.r]=Lt,Lt.hidden=!0),se.hpt&&(Y[se.r]=Lt,Lt.hpt=se.hpt,Lt.hpx=Kd(se.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Wc(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=se;break;case 161:n["!margins"]||Wc(n["!margins"]={}),n["!margins"].header=se.header,n["!margins"].footer=se.footer;break;case 574:se.RTL&&(b.Views[0].RTL=!0);break;case 146:B=se;break;case 2198:L=se;break;case 140:k=se;break;case 442:A?O.CodeName=se||O.name:b.WBProps.CodeName=se||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=he}return r.SheetNames=Oa(i).sort(function(Bt,ut){return Number(Bt)-Number(ut)}).map(function(Bt){return i[Bt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&j.forEach(function(Bt,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=Bt}),r.Strings=c,r.SSF=ta(zt),R.enc&&(r.Encryption=R.enc),L&&(r.Themes=L),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),V.names.length>0&&(b.Names=V.names),r.Workbook=b,r}var mf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kU(e,t,r){var a=Ut.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=F4(a,Ox,mf.DSI);for(var i in n)t[i]=n[i]}catch(A){if(r.WTF)throw A}var o=Ut.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=F4(o,Ix,mf.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(A){if(r.WTF)throw A}t.HeadingPairs&&t.TitlesOfParts&&(d5(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function DU(e,t){var r=[],a=[],n=[],i=0,o,l=l4(Ox,"n"),c=l4(Ix,"n");if(e.Props)for(o=Oa(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Oa(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Custprops[o[i]]]);var A=[];for(i=0;i<n.length;++i)x5.indexOf(n[i][0])>-1||A5.indexOf(n[i][0])>-1||n[i][1]!=null&&A.push(n[i]);a.length&&Ut.utils.cfb_add(t,"/SummaryInformation",R4(a,mf.SI,c,Ix)),(r.length||A.length)&&Ut.utils.cfb_add(t,"/DocumentSummaryInformation",R4(r,mf.DSI,l,Ox,A.length?A:null,mf.UDI))}function Ey(e,t){t||(t={}),_y(t),xm(),t.codepage&&gm(t.codepage);var r,a;if(e.FullPaths){if(Ut.find(e,"/encryption"))throw new Error("File is password-protected");r=Ut.find(e,"!CompObj"),a=Ut.find(e,"/Workbook")||Ut.find(e,"/Book")}else{switch(t.type){case"base64":e=Ys(ni(e));break;case"binary":e=Ys(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Sn(e,0),a={content:e}}var n,i;if(r&&IU(r),t.bookProps&&!t.bookSheets)n={};else{var o=ur?"buffer":"array";if(a&&a.content)n=RU(a.content,t);else if((i=Ut.find(e,"PerfectOffice_MAIN"))&&i.content)n=Yc.to_workbook(i.content,(t.type=o,t));else if((i=Ut.find(e,"NativeContent_MAIN"))&&i.content)n=Yc.to_workbook(i.content,(t.type=o,t));else throw(i=Ut.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ut.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Yk(e))}var l={};return e.FullPaths&&kU(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function jU(e,t){var r=t||{},a=Ut.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ut.utils.cfb_add(a,n,pC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&DU(e,a),r.biff==8&&e.vbaraw&&Wk(a,Ut.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Gf={0:{f:o8},1:{f:h8},2:{f:k8},3:{f:b8},4:{f:y8},5:{f:N8},6:{f:M8},7:{f:S8},8:{f:z8},9:{f:G8},10:{f:K8},11:{f:H8},12:{f:g8},13:{f:j8},14:{f:C8},15:{f:w8},16:{f:sC},17:{f:Q8},18:{f:O8},19:{f:ny},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PL},40:{},42:{},43:{f:M6},44:{f:L6},45:{f:q6},46:{f:H6},47:{f:K6},48:{},49:{f:AN},50:{},51:{f:_k},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O5},62:{f:U8},63:{f:Rk},64:{f:lL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ts,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:f8},148:{f:A8,p:16},151:{f:J8},152:{},153:{f:LL},154:{},155:{},156:{f:DL},157:{},158:{},159:{T:1,f:e6},160:{T:-1},161:{T:1,f:xA},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:V8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ek},336:{T:-1},337:{f:Sk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Tx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:T5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Z8},427:{f:eL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:u8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:W8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Tx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Hk},633:{T:1},634:{T:-1},635:{T:1,f:qk},636:{T:-1},637:{f:pN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jx={6:{f:Lg},10:{f:Cl},12:{f:Ya},13:{f:Ya},14:{f:Ra},15:{f:Ra},16:{f:Yn},17:{f:Ra},18:{f:Ra},19:{f:Ya},20:{f:M4},21:{f:M4},23:{f:T5},24:{f:Q4},25:{f:Ra},26:{},27:{},28:{f:cR},29:{},34:{f:Ra},35:{f:P4},38:{f:Yn},39:{f:Yn},40:{f:Yn},41:{f:Yn},42:{f:Ra},43:{f:Ra},47:{f:w6},49:{f:jF},51:{f:Ya},60:{},61:{f:NF},64:{f:Ra},65:{f:DF},66:{f:Ya},77:{},80:{},81:{},82:{},85:{f:Ya},89:{},90:{},91:{},92:{f:vF},93:{f:uR},94:{},95:{f:Ra},96:{},97:{},99:{f:Ra},125:{f:O5},128:{f:XF},129:{f:EF},130:{f:Ya},131:{f:Ra},132:{f:Ra},133:{f:bF},134:{},140:{f:vR},141:{f:Ya},144:{},146:{f:bR},151:{},152:{},153:{},154:{},155:{},156:{f:Ya},157:{},158:{},160:{f:IR},161:{f:BR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:VF},190:{f:$F},193:{f:Cl},197:{},198:{},199:{},200:{},201:{},202:{f:Ra},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ya},220:{},221:{f:Ra},222:{},224:{f:WF},225:{f:yF},226:{f:Cl},227:{},229:{f:AR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CF},253:{f:UF},255:{f:SF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:y5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ra},353:{f:Cl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rR},431:{f:Ra},432:{},433:{},434:{},437:{},438:{f:hR},439:{f:Ra},440:{f:mR},441:{},442:{f:c0},443:{},444:{f:Ya},445:{},446:{},448:{f:Cl},449:{f:IF,r:2},450:{f:Cl},512:{f:j4},513:{f:OR},515:{f:eR},516:{f:PF},517:{f:U4},519:{f:NR},520:{f:TF},523:{},545:{f:q4},549:{f:D4},566:{},574:{f:RF},638:{f:zF},659:{},1048:{},1054:{f:qF},1084:{},1212:{f:iR},2048:{f:xR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:up},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Cl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_R,r:12},2173:{f:vk,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ra,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sR,r:12},2197:{},2198:{f:pk,r:12},2199:{},2200:{},2201:{},2202:{f:oR,r:12},2203:{f:Cl},2204:{},2205:{},2206:{},2207:{},2211:{f:OF},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ya},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ER},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:j4},1:{},2:{f:jR},3:{f:kR},4:{f:RR},5:{f:U4},7:{f:UR},8:{},9:{f:up},11:{},22:{f:Ya},30:{f:HF},31:{},32:{},33:{f:q4},36:{},37:{f:D4},50:{f:MR},62:{},52:{},67:{},68:{f:Ya},69:{},86:{},126:{},127:{f:FR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PR},223:{},234:{},354:{},421:{},518:{f:Lg},521:{f:up},536:{f:Q4},547:{f:P4},561:{},579:{},1030:{f:Lg},1033:{f:up},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function yt(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&ty(r)&&e.push(r)}}function LU(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return yt(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A;c<n;){for(d=e.next(4),d.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;d.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A}}}function f0(e,t,r){return e||(e=Je(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function UU(e,t,r,a){var n=Je(9);return f0(n,e,t),v5(r,a||"b",n),n}function MU(e,t,r){var a=Je(8+2*r.length);return f0(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function PU(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?ln(ca(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?yt(e,2,LR(r,a,n)):yt(e,3,DR(r,a,n));return;case"b":case"e":yt(e,5,UU(r,a,t.v,t.t));return;case"s":case"str":yt(e,4,MU(r,a,(t.v||"").slice(0,255)));return}yt(e,1,f0(null,r,a))}function QU(e,t,r,a){var n=Array.isArray(t),i=xr(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=lr(i)}for(var A=i.s.r;A<=i.e.r;++A){l=Sa(A);for(var d=i.s.c;d<=i.e.c;++d){A===i.s.r&&(c[d]=la(d)),o=c[d]+l;var f=n?(t[A]||[])[d]:t[o];f&&PU(e,f,A,d)}}}function qU(e,t){for(var r=t||{},a=Fs(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return yt(a,r.biff==4?1033:r.biff==3?521:9,dy(e,16,r)),QU(a,e.Sheets[e.SheetNames[n]],n,r),yt(a,10),a.end()}function KU(e,t,r){yt(e,49,LF({sz:12,name:"Arial"},r))}function HU(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&yt(e,1054,KF(n,t[n],r))})}function GU(e,t){var r=Je(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),yt(e,2151,r),r=Je(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),C5(xr(t["!ref"]||"A1"),r),r.write_shift(4,4),yt(e,2152,r)}function zU(e,t){for(var r=0;r<16;++r)yt(e,224,L4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){yt(e,224,L4(a,0,t))})}function VU(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];yt(e,440,gR(a)),a[1].Tooltip&&yt(e,2048,yR(a))}delete t["!links"]}function $U(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&yt(e,125,CR(Bm(n,a),n))})}}function YU(e,t,r,a,n){var i=16+pc(n.cellXfs,t,n);if(t.v==null&&!t.bf){yt(e,513,cA(r,a,i));return}if(t.bf)yt(e,6,Ej(t,r,a,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?ln(ca(t.v)):t.v;yt(e,515,tR(r,a,o,i));break;case"b":case"e":yt(e,517,ZF(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=yy(n.Strings,t.v,n.revStrings);yt(e,253,MF(r,a,l,i))}else yt(e,516,QF(r,a,(t.v||"").slice(0,255),i,n));break;default:yt(e,513,cA(r,a,i))}}function WU(e,t,r){var a=Fs(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),A=t.biff==8,d,f="",p=[],u=xr(i["!ref"]||"A1"),g=A?65536:16384;if(u.e.c>255||u.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,g-1)}yt(a,2057,dy(r,16,t)),yt(a,13,bi(1)),yt(a,12,bi(100)),yt(a,15,us(!0)),yt(a,17,us(!1)),yt(a,16,oA(.001)),yt(a,95,us(!0)),yt(a,42,us(!1)),yt(a,43,us(!1)),yt(a,130,bi(1)),yt(a,128,JF()),yt(a,131,us(!1)),yt(a,132,us(!1)),A&&$U(a,i["!cols"]),yt(a,512,GF(u,t)),A&&(i["!links"]=[]);for(var h=u.s.r;h<=u.e.r;++h){f=Sa(h);for(var x=u.s.c;x<=u.e.c;++x){h===u.s.r&&(p[x]=la(x)),d=p[x]+f;var y=c?(i[h]||[])[x]:i[d];y&&(YU(a,y,h,x,t),A&&y.l&&i["!links"].push([d,y.l]))}}var v=l.CodeName||l.name||n;return A&&yt(a,574,kF((o.Views||[])[0])),A&&(i["!merges"]||[]).length&&yt(a,229,dR(i["!merges"])),A&&VU(a,i),yt(a,442,w5(v)),A&&GU(a,i),yt(a,10),a.end()}function XU(e,t,r){var a=Fs(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(yt(a,2057,dy(e,5,r)),r.bookType=="xla"&&yt(a,135),yt(a,225,l?bi(1200):null),yt(a,193,ZN(2)),c&&yt(a,191),c&&yt(a,192),yt(a,226),yt(a,92,wF("SheetJS",r)),yt(a,66,bi(l?1200:1252)),l&&yt(a,353,bi(0)),l&&yt(a,448),yt(a,317,TR(e.SheetNames.length)),l&&e.vbaraw&&yt(a,211),l&&e.vbaraw){var A=o.CodeName||"ThisWorkbook";yt(a,442,w5(A))}yt(a,156,bi(17)),yt(a,25,us(!1)),yt(a,18,us(!1)),yt(a,19,bi(0)),l&&yt(a,431,us(!1)),l&&yt(a,444,bi(0)),yt(a,61,FF()),yt(a,64,us(!1)),yt(a,141,bi(0)),yt(a,34,us(IL(e)=="true")),yt(a,14,us(!0)),l&&yt(a,439,us(!1)),yt(a,218,bi(0)),KU(a,e,r),HU(a,e.SSF,r),zU(a,r),l&&yt(a,352,us(!1));var d=a.end(),f=Fs();l&&yt(f,140,wR()),l&&r.Strings&&LU(f,252,BF(r.Strings)),yt(f,10);var p=f.end(),u=Fs(),g=0,h=0;for(h=0;h<e.SheetNames.length;++h)g+=(l?12:11)+(l?2:1)*e.SheetNames[h].length;var x=d.length+g+p.length;for(h=0;h<e.SheetNames.length;++h){var y=i[h]||{};yt(u,133,_F({pos:x,hs:y.Hidden||0,dt:0,name:e.SheetNames[h]},r)),x+=t[h].length}var v=u.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var E=[];return d.length&&E.push(d),v.length&&E.push(v),p.length&&E.push(p),xn(E)}function JU(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=ta(zt)),e&&e.SSF&&($d(),i0(e.SSF),r.revssf=vm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Cy(r),r.cellXfs=[],pc(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=WU(n,r,e);return a.unshift(XU(e,a,r)),xn(a)}function pC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=xs(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return JU(e,t);case 4:case 3:case 2:return qU(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function J4(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,l=i&&i.index||e.length,c=L3(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,d=0,f=0,p=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var h=c[o].trim(),x=h.slice(0,3).toLowerCase();if(x=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}d=0;continue}if(!(x!="<td"&&x!="<th")){var y=h.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var v=y[l].trim();if(v.match(/<t[dh]/i)){for(var E=v,k=0;E.charAt(0)=="<"&&(k=E.indexOf(">"))>-1;)E=E.slice(k+1);for(var S=0;S<g.length;++S){var B=g[S];B.s.c==d&&B.s.r<A&&A<=B.e.r&&(d=B.e.c+1,S=-1)}var b=Jt(v.slice(0,v.indexOf(">")));p=b.colspan?+b.colspan:1,((f=+b.rowspan)>1||p>1)&&g.push({s:{r:A,c:d},e:{r:A+(f||1)-1,c:d+p-1}});var O=b.t||b["data-t"]||"";if(!E.length){d+=p;continue}if(E=q_(E),u.s.r>A&&(u.s.r=A),u.e.r<A&&(u.e.r=A),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!E.length){d+=p;continue}var _={t:"s",v:E};r.raw||!E.trim().length||O=="s"||(E==="TRUE"?_={t:"b",v:!0}:E==="FALSE"?_={t:"b",v:!1}:isNaN(Hi(E))?isNaN(Qd(E).getDate())||(_={t:"d",v:ca(E)},r.cellDates||(_={t:"n",v:ln(_.v)}),_.z=r.dateNF||zt[14]):_={t:"n",v:Hi(E)}),r.dense?(a[A]||(a[A]=[]),a[A][d]=_):a[Wt({r:A,c:d})]=_,d+=p}}}}return a["!ref"]=lr(u),g.length&&(a["!merges"]=g),a}function hC(e,t,r,a){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,A=0;A<n.length;++A)if(!(n[A].s.r>r||n[A].s.c>o)&&!(n[A].e.r<r||n[A].e.c<o)){if(n[A].s.r<r||n[A].s.c<o){l=-1;break}l=n[A].e.r-n[A].s.r+1,c=n[A].e.c-n[A].s.c+1;break}if(!(l<0)){var d=Wt({r,c:o}),f=a.dense?(e[r]||[])[o]:e[d],p=f&&f.v!=null&&(f.h||$2(f.w||(xo(f),f.w)||""))||"",u={};l>1&&(u.rowspan=l),c>1&&(u.colspan=c),a.editable?p='<span contenteditable="true">'+p+"</span>":f&&(u["data-t"]=f&&f.t||"z",f.v!=null&&(u["data-v"]=f.v),f.z!=null&&(u["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),u.id=(a.id||"sjs")+"-"+d,i.push(gt("td",p,u))}}var g="<tr>";return g+i.join("")+"</tr>"}var mC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gC="</body></html>";function ZU(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return fc(J4(r[0],t),t);var a=Iy();return r.forEach(function(n,i){Ny(a,J4(n,t),"Sheet"+(i+1))}),a}function xC(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yC(e,t){var r=t||{},a=r.header!=null?r.header:mC,n=r.footer!=null?r.footer:gC,i=[a],o=xs(e["!ref"]);r.dense=Array.isArray(e),i.push(xC(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(hC(e,o,l,r));return i.push("</table>"+n),i.join("")}function vC(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?ga(a.origin):a.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=xs(e["!ref"]);A.s.r=Math.min(A.s.r,d.s.r),A.s.c=Math.min(A.s.c,d.s.c),A.e.r=Math.max(A.e.r,d.e.r),A.e.c=Math.max(A.e.c,d.e.c),n==-1&&(A.e.r=n=d.e.r+1)}var f=[],p=0,u=e["!rows"]||(e["!rows"]=[]),g=0,h=0,x=0,y=0,v=0,E=0;for(e["!cols"]||(e["!cols"]=[]);g<l.length&&h<c;++g){var k=l[g];if(Z4(k)){if(a.display)continue;u[h]={hidden:!0}}var S=k.children;for(x=y=0;x<S.length;++x){var B=S[x];if(!(a.display&&Z4(B))){var b=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):q_(B.innerHTML),O=B.getAttribute("data-z")||B.getAttribute("z");for(p=0;p<f.length;++p){var _=f[p];_.s.c==y+i&&_.s.r<h+n&&h+n<=_.e.r&&(y=_.e.c+1-i,p=-1)}E=+B.getAttribute("colspan")||1,((v=+B.getAttribute("rowspan")||1)>1||E>1)&&f.push({s:{r:h+n,c:y+i},e:{r:h+n+(v||1)-1,c:y+i+(E||1)-1}});var U={t:"s",v:b},I=B.getAttribute("data-t")||B.getAttribute("t")||"";b!=null&&(b.length==0?U.t=I||"z":a.raw||b.trim().length==0||I=="s"||(b==="TRUE"?U={t:"b",v:!0}:b==="FALSE"?U={t:"b",v:!1}:isNaN(Hi(b))?isNaN(Qd(b).getDate())||(U={t:"d",v:ca(b)},a.cellDates||(U={t:"n",v:ln(U.v)}),U.z=a.dateNF||zt[14]):U={t:"n",v:Hi(b)})),U.z===void 0&&O!=null&&(U.z=O);var R="",L=B.getElementsByTagName("A");if(L&&L.length)for(var N=0;N<L.length&&!(L[N].hasAttribute("href")&&(R=L[N].getAttribute("href"),R.charAt(0)!="#"));++N);R&&R.charAt(0)!="#"&&(U.l={Target:R}),a.dense?(e[h+n]||(e[h+n]=[]),e[h+n][y+i]=U):e[Wt({c:y+i,r:h+n})]=U,A.e.c<y+i&&(A.e.c=y+i),y+=E}}++h}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),A.e.r=Math.max(A.e.r,h-1+n),e["!ref"]=lr(A),h>=c&&(e["!fullref"]=lr((A.e.r=l.length-g+h-1+n,A))),e}function wC(e,t){var r=t||{},a=r.dense?[]:{};return vC(a,e,t)}function e7(e,t){return fc(wC(e,t),t)}function Z4(e){var t="",r=t7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function t7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function r7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Tr(t.replace(/<[^>]*>/g,""));return[r]}var ew={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function EC(e,t){var r=t||{},a=Y2(e),n=[],i,o,l={name:""},c="",A=0,d,f,p={},u=[],g=r.dense?[]:{},h,x,y={value:""},v="",E=0,k=[],S=-1,B=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,_={},U=[],I={},R=0,L=0,N=[],P=1,Q=1,Y=[],ee={Names:[]},V={},G=["",""],z=[],C={},D="",j=0,K=!1,W=!1,Ae=0;for(Mf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=Mf.exec(a);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"工作表":h[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?g["!ref"]=lr(b):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(g["!fullref"]=g["!ref"],b.e.r=r.sheetRows-1,g["!ref"]=lr(b)),U.length&&(g["!merges"]=U),N.length&&(g["!rows"]=N),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),p[d.name]=g,W=!1):h[0].charAt(h[0].length-2)!=="/"&&(d=Jt(h[0],!1),S=B=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,g=r.dense?[]:{},U=[],N=[],W=!0);break;case"table-row-group":h[1]==="/"?--O:++O;break;case"table-row":case"行":if(h[1]==="/"){S+=P,P=1;break}if(f=Jt(h[0],!1),f.行号?S=f.行号-1:S==-1&&(S=0),P=+f["number-rows-repeated"]||1,P<10)for(Ae=0;Ae<P;++Ae)O>0&&(N[S+Ae]={level:O});B=-1;break;case"covered-table-cell":h[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(g[S]||(g[S]=[]),g[S][B]={t:"z"}):g[Wt({r:S,c:B})]={t:"z"}),v="",k=[];break;case"table-cell":case"数据":if(h[0].charAt(h[0].length-2)==="/")++B,y=Jt(h[0],!1),Q=parseInt(y["number-columns-repeated"]||"1",10),x={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(x.f=Y4(Tr(y.formula))),(y.数据类型||y["value-type"])=="string"&&(x.t="s",x.v=Tr(y["string-value"]||""),r.dense?(g[S]||(g[S]=[]),g[S][B]=x):g[Wt({r:S,c:B})]=x),B+=Q-1;else if(h[1]!=="/"){++B,v="",E=0,k=[],Q=1;var ue=P?S+P-1:S;if(B>b.e.c&&(b.e.c=B),B<b.s.c&&(b.s.c=B),S<b.s.r&&(b.s.r=S),ue>b.e.r&&(b.e.r=ue),y=Jt(h[0],!1),z=[],C={},x={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Tr(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(R=parseInt(y["number-matrix-rows-spanned"],10)||0,L=parseInt(y["number-matrix-columns-spanned"],10)||0,I={s:{r:S,c:B},e:{r:S+R-1,c:B+L-1}},x.F=lr(I),Y.push([I,x.F])),y.formula)x.f=Y4(y.formula);else for(Ae=0;Ae<Y.length;++Ae)S>=Y[Ae][0].s.r&&S<=Y[Ae][0].e.r&&B>=Y[Ae][0].s.c&&B<=Y[Ae][0].e.c&&(x.F=Y[Ae][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(R=parseInt(y["number-rows-spanned"],10)||0,L=parseInt(y["number-columns-spanned"],10)||0,I={s:{r:S,c:B},e:{r:S+R-1,c:B+L-1}},U.push(I)),y["number-columns-repeated"]&&(Q=parseInt(y["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=sa(y["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(y.value);break;case"percentage":x.t="n",x.v=parseFloat(y.value);break;case"currency":x.t="n",x.v=parseFloat(y.value);break;case"date":x.t="d",x.v=ca(y["date-value"]),r.cellDates||(x.t="n",x.v=ln(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=k3(y["time-value"])/86400,r.cellDates&&(x.t="d",x.v=wm(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(y.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",y["string-value"]!=null&&(v=Tr(y["string-value"]),k=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(K=!1,x.t==="s"&&(x.v=v||"",k.length&&(x.R=k),K=E==0),V.Target&&(x.l=V),z.length>0&&(x.c=z,z=[]),v&&r.cellText!==!1&&(x.w=v),K&&(x.t="z",delete x.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var he=0;he<P;++he){if(Q=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[S+he]||(g[S+he]=[]),g[S+he][B]=he==0?x:ta(x);--Q>0;)g[S+he][B+Q]=ta(x);else for(g[Wt({r:S+he,c:B})]=x;--Q>0;)g[Wt({r:S+he,c:B+Q})]=ta(x);b.e.c<=B&&(b.e.c=B)}Q=parseInt(y["number-columns-repeated"]||"1",10),B+=Q-1,Q=0,x={},v="",k=[]}V={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!0]);break;case"annotation":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i;C.t=v,k.length&&(C.R=k),C.a=D,z.push(C)}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);D="",j=0,v="",E=0,k=[];break;case"creator":h[1]==="/"?D=a.slice(j,h.index):j=h.index+h[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(h[1]==="/"){if((i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);v="",E=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(h[1]==="/"){if(_[l.name]=c,(i=n.pop())[0]!==h[3])throw"Bad state: "+i}else h[0].charAt(h[0].length-2)!=="/"&&(c="",l=Jt(h[0],!1),n.push([h[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Jt(h[0],!1),c+=ew[h[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Jt(h[0],!1),c+=ew[h[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(h[0].slice(-2)==="/>")break;if(h[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(A,h.index);break}else A=h.index+h[0].length;break;case"named-range":o=Jt(h[0],!1),G=Ug(o["cell-range-address"]);var ve={Name:o.name,Ref:G[0]+"!"+G[1]};W&&(ve.Sheet=u.length),ee.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(h[1]==="/"&&(!y||!y["string-value"])){var we=r7(a.slice(E,h.index));v=(v.length>0?v+`
`:"")+we[0]}else Jt(h[0],!1),E=h.index+h[0].length;break;case"s":break;case"database-range":if(h[1]==="/")break;try{G=Ug(Jt(h[0])["target-range-address"]),p[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(h[1]!=="/"){if(V=Jt(h[0],!1),!V.href)break;V.Target=Tr(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(G=Ug(V.Target.slice(1)),V.Target="#"+G[0]+"!"+G[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(h)}}var se={Sheets:p,SheetNames:u,Workbook:ee};return r.bookSheets&&delete se.Sheets,se}function tw(e,t){t=t||{},wi(e,"META-INF/manifest.xml")&&kN($a(e,"META-INF/manifest.xml"),t);var r=Ws(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=EC(Vr(r),t);return wi(e,"meta.xml")&&(a.Props=l5($a(e,"meta.xml"))),a}function rw(e,t){return EC(e,t)}var a7=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qa+t}}(),aw=function(){var e=function(i){return Hr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Hr(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,d=0,f=xs(i["!ref"]||"A1"),p=i["!merges"]||[],u=0,g=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var h="",x=i["!rows"]||[];for(A=0;A<f.s.r;++A)h=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;A<=f.e.r;++A){for(h=x[A]?' table:style-name="ro'+x[A].ods+'"':"",c.push("        <table:table-row"+h+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,v={},E="";for(u=0;u!=p.length;++u)if(!(p[u].s.c>d)&&!(p[u].s.r>A)&&!(p[u].e.c<d)&&!(p[u].e.r<A)){(p[u].s.c!=d||p[u].s.r!=A)&&(y=!0),v["table:number-columns-spanned"]=p[u].e.c-p[u].s.c+1,v["table:number-rows-spanned"]=p[u].e.r-p[u].s.r+1;break}if(y){c.push(r);continue}var k=Wt({r:A,c:d}),S=g?(i[A]||[])[d]:i[k];if(S&&S.f&&(v["table:formula"]=Hr(Tj(S.f)),S.F&&S.F.slice(0,k.length)==k)){var B=xs(S.F);v["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,v["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":E=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":E=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":E=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":E=S.w||ca(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=ca(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var b=e(E);if(S.l&&S.l.Target){var O=S.l.Target;O=O.charAt(0)=="#"?"#"+Oj(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),b=gt("text:a",b,{"xlink:href":O.replace(/&/g,"&amp;")})}c.push("          "+gt("table:table-cell",gt("text:p",b,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var d=0;d<A["!cols"].length;++d)if(A["!cols"][d]){var f=A["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;sc(f),f.ods=l;var p=A["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var d=0;d<A["!rows"].length;++d)if(A["!rows"][d]){A["!rows"][d].ods=c;var f=A["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Qa],A=Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Uf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+d+`>
`),c.push(o5().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function bC(e,t){if(t.bookType=="fods")return aw(e,t);var r=G2(),a="",n=[],i=[];return a="mimetype",Ar(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ar(r,a,aw(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Ar(r,a,a7(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Ar(r,a,Qa+o5()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Ar(r,a,LN(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ar(r,a,DN(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function AA(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Lx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Vr(uc(e))}function n7(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ys(uo(e))}function s7(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function oc(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function nw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function i7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function o7(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function zf(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Qr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ta(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ir(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=zf(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=zf(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var A={data:l,type:i};t[n]==null?t[n]=[A]:t[n].push(A)}return t}function _n(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Qr(a*8+n.type)),n.type==2&&t.push(Qr(n.data.length)),t.push(n.data))})}),oc(t)}function by(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function yi(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=zf(e,a),i=Ir(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:Ta(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ir(l.data),A=Ta(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+A)}),a[0]+=A}),(t=i[3])!=null&&t[0]&&(o.merge=Ta(i[3][0].data)>>>0>0),r.push(o)}return r}function zA(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Qr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Qr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Qr(o.data.length)}],a[2].push({data:_n(o.meta),type:2})});var i=_n(a);t.push(Qr(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),oc(t)}function l7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=zf(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(i==1?(A=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(A=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[oc(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(n.push(n[0].slice(-c)),A-=c;A>=n[n.length-1].length;)n.push(n[n.length-1]),A-=n[n.length-1].length;n.push(n[0].slice(-c,-c+A))}}var d=oc(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function vi(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(l7(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return oc(t)}function VA(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Qr(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return oc(t)}function c7(e,t,r,a){var n=AA(e),i=n.getUint32(4,!0),o=(a>1?12:8)+nw(i&(a>1?3470:398))*4,l=-1,c=-1,A=NaN,d=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=nw(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(A=n.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:A};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(A))f={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function A7(e,t,r){var a=AA(e),n=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,A=NaN,d=new Date(2001,0,1);n&1&&(c=i7(e,i),i+=16),n&2&&(A=a.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=a.getUint32(i,!0),i+=4),n&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function Pg(e,t){var r=new Uint8Array(32),a=AA(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,o7(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Qg(e,t){var r=new Uint8Array(32),a=AA(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function d7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return c7(e,t,r,e[0]);case 5:return A7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Kn(e){var t=Ir(e);return zf(t[1][0].data)}function sw(e,t){var r=Ir(t.data),a=Ta(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=Ir(o.data),c=Ta(l[1][0].data)>>>0;switch(a){case 1:i[c]=Lx(l[3][0].data);break;case 8:{var A=e[Kn(l[9][0].data)][0],d=Ir(A.data),f=e[Kn(d[1][0].data)][0],p=Ta(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var u=Ir(f.data);i[c]=u[3].map(function(g){return Lx(g.data)}).join("")}break}}),i}function u7(e,t){var r,a,n,i,o,l,c,A,d,f,p,u,g,h,x=Ir(e),y=Ta(x[1][0].data)>>>0,v=Ta(x[2][0].data)>>>0,E=((a=(r=x[8])==null?void 0:r[0])==null?void 0:a.data)&&Ta(x[8][0].data)>0||!1,k,S;if((i=(n=x[7])==null?void 0:n[0])!=null&&i.data&&t!=0)k=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,S=(A=(c=x[6])==null?void 0:c[0])==null?void 0:A.data;else if((f=(d=x[4])==null?void 0:d[0])!=null&&f.data&&t!=1)k=(u=(p=x[4])==null?void 0:p[0])==null?void 0:u.data,S=(h=(g=x[3])==null?void 0:g[0])==null?void 0:h.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var B=E?4:1,b=AA(k),O=[],_=0;_<k.length/2;++_){var U=b.getUint16(_*2,!0);U<65535&&O.push([_,U])}if(O.length!=v)throw"Expected ".concat(v," cells, found ").concat(O.length);var I=[];for(_=0;_<O.length-1;++_)I[O[_][0]]=S.subarray(O[_][1]*B,O[_+1][1]*B);return O.length>=1&&(I[O[O.length-1][0]]=S.subarray(O[O.length-1][1]*B)),{R:y,cells:I}}function f7(e,t){var r,a=Ir(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Ta(a[7][0].data)>>>0>0?1:0:-1,i=by(a[5],function(o){return u7(o,n)});return{nrows:Ta(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function p7(e,t,r){var a,n=Ir(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ta(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Ta(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=lr(i);var o=Ir(n[4][0].data),l=sw(e,e[Kn(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?sw(e,e[Kn(o[17][0].data)][0]):[],A=Ir(o[3][0].data),d=0;A[1].forEach(function(f){var p=Ir(f.data),u=e[Kn(p[2][0].data)][0],g=Ta(u.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var h=f7(e,u);h.data.forEach(function(x,y){x.forEach(function(v,E){var k=Wt({r:d+y,c:E}),S=d7(v,l,c);S&&(r[k]=S)})}),d+=h.nrows})}function h7(e,t){var r=Ir(t.data),a={"!ref":"A1"},n=e[Kn(r[2][0].data)],i=Ta(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return p7(e,n[0],a),a}function m7(e,t){var r,a=Ir(t.data),n={name:(r=a[1])!=null&&r[0]?Lx(a[1][0].data):"",sheets:[]},i=by(a[2],Kn);return i.forEach(function(o){e[o].forEach(function(l){var c=Ta(l.meta[1][0].data);c==6e3&&n.sheets.push(h7(e,l))})}),n}function g7(e,t){var r=Iy(),a=Ir(t.data),n=by(a[1],Kn);if(n.forEach(function(i){e[i].forEach(function(o){var l=Ta(o.meta[1][0].data);if(l==2){var c=m7(e,o);c.sheets.forEach(function(A,d){Ny(r,A,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function qg(e){var t,r,a,n,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=vi(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=yi(A)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Ta(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(A){var d=Ta(A.meta[1][0].data)>>>0;if(d==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return g7(i,l)}function x7(e,t,r){var a,n,i,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Ta(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=AA(e[7][0].data),d=0,f=[],p=AA(e[4][0].data),u=0,g=[],h=0;h<t.length;++h){if(t[h]==null){A.setUint16(h*2,65535,!0),p.setUint16(h*2,65535);continue}A.setUint16(h*2,d,!0),p.setUint16(h*2,u,!0);var x,y;switch(typeof t[h]){case"string":x=Pg({t:"s",v:t[h]},r),y=Qg({t:"s",v:t[h]},r);break;case"number":x=Pg({t:"n",v:t[h]},r),y=Qg({t:"n",v:t[h]},r);break;case"boolean":x=Pg({t:"b",v:t[h]},r),y=Qg({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}f.push(x),d+=x.length,g.push(y),u+=y.length,++c}for(e[2][0].data=Qr(c);h<e[7][0].data.length/2;++h)A.setUint16(h*2,65535,!0),p.setUint16(h*2,65535,!0);return e[6][0].data=oc(f),e[3][0].data=oc(g),c}function y7(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=xs(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(lr(a)));var i=Mh(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(D){return D.forEach(function(j){typeof j=="string"&&o.push(j)})});var l={},c=[],A=Ut.read(t.numbers,{type:"base64"});A.FileIndex.map(function(D,j){return[D,A.FullPaths[j]]}).forEach(function(D){var j=D[0],K=D[1];if(j.type==2&&j.name.match(/\.iwa/)){var W=j.content,Ae=vi(W),ue=yi(Ae);ue.forEach(function(he){c.push(he.id),l[he.id]={deps:[],location:K,type:Ta(he.messages[0].meta[1][0].data)}})}}),c.sort(function(D,j){return D-j});var d=c.filter(function(D){return D>1}).map(function(D){return[D,Qr(D)]});A.FileIndex.map(function(D,j){return[D,A.FullPaths[j]]}).forEach(function(D){var j=D[0];if(D[1],!!j.name.match(/\.iwa/)){var K=yi(vi(j.content));K.forEach(function(W){W.messages.forEach(function(Ae){d.forEach(function(ue){W.messages.some(function(he){return Ta(he.meta[1][0].data)!=11006&&s7(he.data,ue[1])})&&l[ue[0]].deps.push(W.id)})})})}});for(var f=Ut.find(A,l[1].location),p=yi(vi(f.content)),u,g=0;g<p.length;++g){var h=p[g];h.id==1&&(u=h)}var x=Kn(Ir(u.messages[0].data)[1][0].data);for(f=Ut.find(A,l[x].location),p=yi(vi(f.content)),g=0;g<p.length;++g)h=p[g],h.id==x&&(u=h);for(x=Kn(Ir(u.messages[0].data)[2][0].data),f=Ut.find(A,l[x].location),p=yi(vi(f.content)),g=0;g<p.length;++g)h=p[g],h.id==x&&(u=h);for(x=Kn(Ir(u.messages[0].data)[2][0].data),f=Ut.find(A,l[x].location),p=yi(vi(f.content)),g=0;g<p.length;++g)h=p[g],h.id==x&&(u=h);var y=Ir(u.messages[0].data);{y[6][0].data=Qr(a.e.r+1),y[7][0].data=Qr(a.e.c+1);var v=Kn(y[46][0].data),E=Ut.find(A,l[v].location),k=yi(vi(E.content));{for(var S=0;S<k.length&&k[S].id!=v;++S);if(k[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var B=Ir(k[S].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var b=0;b<=a.e.c;++b){var O=[];O[1]=O[2]=[{type:0,data:Qr(b+420690)}],B[1].push({type:2,data:_n(O)}),B[2].push({type:0,data:Qr(b)}),B[3].push({type:0,data:Qr(b)})}B[4]=[],B[5]=[],B[6]=[];for(var _=0;_<=a.e.r;++_)O=[],O[1]=O[2]=[{type:0,data:Qr(_+726270)}],B[4].push({type:2,data:_n(O)}),B[5].push({type:0,data:Qr(_)}),B[6].push({type:0,data:Qr(_)});k[S].messages[0].data=_n(B)}E.content=VA(zA(k)),E.size=E.content.length,delete y[46];var U=Ir(y[4][0].data);{U[7][0].data=Qr(a.e.r+1);var I=Ir(U[1][0].data),R=Kn(I[2][0].data);E=Ut.find(A,l[R].location),k=yi(vi(E.content));{if(k[0].id!=R)throw"Bad HeaderStorageBucket";var L=Ir(k[0].messages[0].data);for(_=0;_<i.length;++_){var N=Ir(L[2][0].data);N[1][0].data=Qr(_),N[4][0].data=Qr(i[_].length),L[2][_]={type:L[2][0].type,data:_n(N)}}k[0].messages[0].data=_n(L)}E.content=VA(zA(k)),E.size=E.content.length;var P=Kn(U[2][0].data);E=Ut.find(A,l[P].location),k=yi(vi(E.content));{if(k[0].id!=P)throw"Bad HeaderStorageBucket";for(L=Ir(k[0].messages[0].data),b=0;b<=a.e.c;++b)N=Ir(L[2][0].data),N[1][0].data=Qr(b),N[4][0].data=Qr(a.e.r+1),L[2][b]={type:L[2][0].type,data:_n(N)};k[0].messages[0].data=_n(L)}E.content=VA(zA(k)),E.size=E.content.length;var Q=Kn(U[4][0].data);(function(){for(var D=Ut.find(A,l[Q].location),j=yi(vi(D.content)),K,W=0;W<j.length;++W){var Ae=j[W];Ae.id==Q&&(K=Ae)}var ue=Ir(K.messages[0].data);{ue[3]=[];var he=[];o.forEach(function(se,He){he[1]=[{type:0,data:Qr(He)}],he[2]=[{type:0,data:Qr(1)}],he[3]=[{type:2,data:n7(se)}],ue[3].push({type:2,data:_n(he)})})}K.messages[0].data=_n(ue);var ve=zA(j),we=VA(ve);D.content=we,D.size=D.content.length})();var Y=Ir(U[3][0].data);{var ee=Y[1][0];delete Y[2];var V=Ir(ee.data);{var G=Kn(V[2][0].data);(function(){for(var D=Ut.find(A,l[G].location),j=yi(vi(D.content)),K,W=0;W<j.length;++W){var Ae=j[W];Ae.id==G&&(K=Ae)}var ue=Ir(K.messages[0].data);{delete ue[6],delete Y[7];var he=new Uint8Array(ue[5][0].data);ue[5]=[];for(var ve=0,we=0;we<=a.e.r;++we){var se=Ir(he);ve+=x7(se,i[we],o),se[1][0].data=Qr(we),ue[5].push({data:_n(se),type:2})}ue[1]=[{type:0,data:Qr(a.e.c+1)}],ue[2]=[{type:0,data:Qr(a.e.r+1)}],ue[3]=[{type:0,data:Qr(ve)}],ue[4]=[{type:0,data:Qr(a.e.r+1)}]}K.messages[0].data=_n(ue);var He=zA(j),Ee=VA(He);D.content=Ee,D.size=D.content.length})()}ee.data=_n(V)}U[3][0].data=_n(Y)}y[4][0].data=_n(U)}u.messages[0].data=_n(y);var z=zA(p),C=VA(z);return f.content=C,f.size=f.content.length,A}function _C(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function _y(e){_C([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Cy(e){_C([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function v7(e){return fr.WS.indexOf(e)>-1?"sheet":e==fr.CS?"chart":e==fr.DS?"dialog":e==fr.MS?"macro":e&&e.length?e:"sheet"}function w7(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,v7(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function E7(e,t,r,a,n,i,o,l,c,A,d,f){try{i[a]=uf(Ws(e,r,!0),t);var p=$a(e,t),u;switch(l){case"sheet":u=$L(p,t,n,c,i[a],A,d,f);break;case"chart":if(u=YL(p,t,n,c,i[a],A,d,f),!u||!u["!drawel"])break;var g=zu(u["!drawel"].Target,t),h=Pf(g),x=jk(Ws(e,g,!0),uf(Ws(e,h,!0),g)),y=zu(x,g),v=Pf(y);u=bL(Ws(e,y,!0),y,c,uf(Ws(e,v,!0),y),A,u);break;case"macro":u=WL(p,t,n,c,i[a],A,d,f);break;case"dialog":u=XL(p,t,n,c,i[a],A,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=u;var E=[];i&&i[a]&&Oa(i[a]).forEach(function(k){var S="";if(i[a][k].Type==fr.CMNT){S=zu(i[a][k].Target,t);var B=tU($a(e,S,!0),S,c);if(!B||!B.length)return;H4(u,B,!1)}i[a][k].Type==fr.TCMNT&&(S=zu(i[a][k].Target,t),E=E.concat(Uk($a(e,S,!0),c)))}),E&&E.length&&H4(u,E,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function mi(e){return e.charAt(0)=="/"?e.slice(1):e}function CC(e,t){if($d(),t=t||{},_y(t),wi(e,"META-INF/manifest.xml")||wi(e,"objectdata.xml"))return tw(e,t);if(wi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof qg<"u"){if(e.FileIndex)return qg(e);var r=Ut.utils.cfb_new();return d4(e).forEach(function(N){Ar(r,N,M3(e,N))}),qg(r)}throw new Error("Unsupported NUMBERS file")}if(!wi(e,"[Content_Types].xml"))throw wi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):wi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=d4(e),n=FN(Ws(e,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",$a(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!$a(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},A={};if(!t.bookSheets&&!t.bookProps){if(ff=[],n.sst)try{ff=eU($a(e,mi(n.sst)),n.sst,t)}catch(N){if(t.WTF)throw N}t.cellStyles&&n.themes.length&&(c=ZL(Ws(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(A=JL($a(e,mi(n.style)),n.style,c,t))}n.links.map(function(N){try{var P=uf(Ws(e,Pf(mi(N))),N);return aU($a(e,mi(N)),P,N,t)}catch{}});var d=VL($a(e,mi(n.workbooks[0])),n.workbooks[0],t),f={},p="";n.coreprops.length&&(p=$a(e,mi(n.coreprops[0]),!0),p&&(f=l5(p)),n.extprops.length!==0&&(p=$a(e,mi(n.extprops[0]),!0),p&&MN(p,f,t)));var u={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(p=Ws(e,mi(n.custprops[0]),!0),p&&(u=QN(p,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(P){return P.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=u),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var h={};t.bookDeps&&n.calcchain&&(h=rU($a(e,mi(n.calcchain)),n.calcchain));var x=0,y={},v,E;{var k=d.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var S=0;S!=k.length;++S)f.SheetNames[S]=k[S].name}var B=i?"bin":"xml",b=n.workbooks[0].lastIndexOf("/"),O=(n.workbooks[0].slice(0,b+1)+"_rels/"+n.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");wi(e,O)||(O="xl/_rels/workbook."+B+".rels");var _=uf(Ws(e,O,!0),O.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=nU($a(e,mi(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=Pk($a(e,mi(n.people[0])),t)),_&&(_=w7(_,d.Sheets));var U=$a(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var I="sheet";if(_&&_[x]?(v="xl/"+_[x][1].replace(/[\/]?xl\//,""),wi(e,v)||(v=_[x][1]),wi(e,v)||(v=O.replace(/_rels\/.*$/,"")+_[x][1]),I=_[x][2]):(v="xl/worksheets/sheet"+(x+1-U)+"."+B,v=v.replace(/sheet0\./,"sheet.")),E=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==x&&(R=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[x].toLowerCase()&&(R=1);if(!R)continue e}}E7(e,v,E,f.SheetNames[x],x,y,o,I,t,d,c,A)}return g={Directory:n,Workbook:d,Props:f,Custprops:u,Deps:h,Sheets:o,SheetNames:f.SheetNames,Strings:ff,Styles:A,Themes:c,SSF:ta(zt)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(N,P){N=N.replace(/^Root Entry[\/]/,""),g.keys.push(N),g.files[N]=e.FileIndex[P]}))),t&&t.bookVBA&&(n.vba.length>0?g.vbaraw=$a(e,mi(n.vba[0]),!0):n.defaults&&n.defaults.bin===$k&&(g.vbaraw=$a(e,"xl/vbaProject.bin",!0))),g}function b7(e,t){var r=t||{},a="Workbook",n=Ut.find(e,a);try{if(a="/!DataSpaces/Version",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(s6(n.content),a="/!DataSpaces/DataSpaceMap",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=o6(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=l6(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);A6(n.content)}catch{}if(a="/EncryptionInfo",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=d6(n.content);if(a="/EncryptedPackage",n=Ut.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function _7(e,t){return t.bookType=="ods"?bC(e,t):t.bookType=="numbers"?y7(e,t):t.bookType=="xlsb"?C7(e,t):BC(e,t)}function C7(e,t){vd=1024,e&&!e.SSF&&(e.SSF=ta(zt)),e&&e.SSF&&($d(),i0(e.SSF),t.revssf=vm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=V5.indexOf(t.bookType)>-1,n=cy();Cy(t=t||{});var i=G2(),o="",l=0;if(t.cellXfs=[],pc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ar(i,o,c5(e.Props,t)),n.coreprops.push(o),qr(t.rels,2,o,fr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ar(i,o,u5(e.Props)),n.extprops.push(o),qr(t.rels,3,o,fr.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(i,o,f5(e.Custprops)),n.custprops.push(o),qr(t.rels,4,o,fr.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ar(i,o,iU(l-1,o,t,e,d)),n.sheets.push(o),qr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,fr.WS[0])}if(f){var u=f["!comments"],g=!1,h="";u&&u.length>0&&(h="xl/comments"+l+"."+r,Ar(i,h,cU(u,h)),n.comments.push(h),qr(d,-1,"../comments"+l+"."+r,fr.CMNT),g=!0),f["!legacy"]&&g&&Ar(i,"xl/drawings/vmlDrawing"+l+".vml",G5(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ar(i,Pf(o),Td(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(i,o,lU(t.Strings,o,t)),n.strs.push(o),qr(t.wbrels,-1,"sharedStrings."+r,fr.SST)),o="xl/workbook."+r,Ar(i,o,sU(e,o)),n.workbooks.push(o),qr(t.rels,1,o,fr.WB),o="xl/theme/theme1.xml",Ar(i,o,hy(e.Themes,t)),n.themes.push(o),qr(t.wbrels,-1,"theme/theme1.xml",fr.THEME),o="xl/styles."+r,Ar(i,o,oU(e,o,t)),n.styles.push(o),qr(t.wbrels,-1,"styles."+r,fr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(i,o,e.vbaraw),n.vba.push(o),qr(t.wbrels,-1,"vbaProject.bin",fr.VBA)),o="xl/metadata."+r,Ar(i,o,AU(o)),n.metadata.push(o),qr(t.wbrels,-1,"metadata."+r,fr.XLMETA),Ar(i,"[Content_Types].xml",i5(n,t)),Ar(i,"_rels/.rels",Td(t.rels)),Ar(i,"xl/_rels/workbook."+r+".rels",Td(t.wbrels)),delete t.revssf,delete t.ssf,i}function BC(e,t){vd=1024,e&&!e.SSF&&(e.SSF=ta(zt)),e&&e.SSF&&($d(),i0(e.SSF),t.revssf=vm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=V5.indexOf(t.bookType)>-1,n=cy();Cy(t=t||{});var i=G2(),o="",l=0;if(t.cellXfs=[],pc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ar(i,o,c5(e.Props,t)),n.coreprops.push(o),qr(t.rels,2,o,fr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ar(i,o,u5(e.Props)),n.extprops.push(o),qr(t.rels,3,o,fr.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(i,o,f5(e.Custprops)),n.custprops.push(o),qr(t.rels,4,o,fr.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],u=(p||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ar(i,o,nC(l-1,t,e,f)),n.sheets.push(o),qr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,fr.WS[0])}if(p){var g=p["!comments"],h=!1,x="";if(g&&g.length>0){var y=!1;g.forEach(function(v){v[1].forEach(function(E){E.T==!0&&(y=!0)})}),y&&(x="xl/threadedComments/threadedComment"+l+"."+r,Ar(i,x,Mk(g,d,t)),n.threadedcomments.push(x),qr(f,-1,"../threadedComments/threadedComment"+l+"."+r,fr.TCMNT)),x="xl/comments"+l+"."+r,Ar(i,x,z5(g)),n.comments.push(x),qr(f,-1,"../comments"+l+"."+r,fr.CMNT),h=!0}p["!legacy"]&&h&&Ar(i,"xl/drawings/vmlDrawing"+l+".vml",G5(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Ar(i,Pf(o),Td(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(i,o,R5(t.Strings,t)),n.strs.push(o),qr(t.wbrels,-1,"sharedStrings."+r,fr.SST)),o="xl/workbook."+r,Ar(i,o,AC(e)),n.workbooks.push(o),qr(t.rels,1,o,fr.WB),o="xl/theme/theme1.xml",Ar(i,o,hy(e.Themes,t)),n.themes.push(o),qr(t.wbrels,-1,"theme/theme1.xml",fr.THEME),o="xl/styles."+r,Ar(i,o,Q5(e,t)),n.styles.push(o),qr(t.wbrels,-1,"styles."+r,fr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(i,o,e.vbaraw),n.vba.push(o),qr(t.wbrels,-1,"vbaProject.bin",fr.VBA)),o="xl/metadata."+r,Ar(i,o,H5()),n.metadata.push(o),qr(t.wbrels,-1,"metadata."+r,fr.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ar(i,o,Qk(d)),n.people.push(o),qr(t.wbrels,-1,"persons/person.xml",fr.PEOPLE)),Ar(i,"[Content_Types].xml",i5(n,t)),Ar(i,"_rels/.rels",Td(t.rels)),Ar(i,"xl/_rels/workbook."+r+".rels",Td(t.wbrels)),delete t.revssf,delete t.ssf,i}function By(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ni(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function B7(e,t){return Ut.find(e,"EncryptedPackage")?b7(e,t):Ey(e,t)}function S7(e,t){var r,a=e,n=t||{};return n.type||(n.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r=M_(a,n),CC(r,n)}function SC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Dx(e.slice(r),t);default:break e}return qd.to_workbook(e,t)}function T7(e,t){var r="",a=By(e,t);switch(t.type){case"base64":r=ni(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=iA(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Vr(r)),t.type="binary",SC(r,t)}function O7(e,t){var r=e;return t.type=="base64"&&(r=ni(r)),r=_r.utils.decode(1200,r.slice(2),"str"),t.type="binary",SC(r,t)}function I7(e){return e.match(/[^\x00-\x7F]/)?uo(e):e}function Kg(e,t,r,a){return a?(r.type="string",qd.to_workbook(e,r)):qd.to_workbook(t,r)}function dA(e,t){xm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return dA(new Uint8Array(e),(r=ta(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Id={},r.dateNF&&(Id.dateNF=r.dateNF),r.type||(r.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ur?"buffer":"binary",a=N3(e),typeof Uint8Array<"u"&&!ur&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=I7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ta(r),r.type="array",dA(Q2(a),r)}switch((n=By(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return B7(Ut.read(a,r),r);break;case 9:if(n[1]<=8)return Ey(a,r);break;case 60:return Dx(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return qR(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return N5.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?S7(a,r):Kg(e,a,r,i);case 239:return n[3]===60?Dx(a,r):Kg(e,a,r,i);case 255:if(n[1]===254)return O7(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Yc.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Yc.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return kx.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return U5.to_workbook(a,r);break;case 10:case 13:case 32:return T7(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return QR.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?kx.to_workbook(a,r):Kg(e,a,r,i)}function iw(e,t){var r=t||{};return r.type="file",dA(e,r)}function TC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return o0(t.file,Ut.write(e,{type:ur?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ut.write(e,t)}function N7(e,t){var r=ta(t||{}),a=_7(e,r);return OC(a,r)}function F7(e,t){var r=ta(t||{}),a=BC(e,r);return OC(a,r)}function OC(e,t){var r={},a=ur?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Ut.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(s0(n))}return t.password&&typeof encrypt_agile<"u"?TC(encrypt_agile(n,t.password),t):t.type==="file"?o0(t.file,n):t.type=="string"?Vr(n):n}function R7(e,t){var r=t||{},a=jU(e,r);return TC(a,r)}function io(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Df(uo(a));case"binary":return uo(a);case"string":return e;case"file":return o0(t.file,a,"utf8");case"buffer":return ur?sl(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):io(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function k7(e,t){switch(t.type){case"base64":return Df(e);case"binary":return e;case"string":return e;case"file":return o0(t.file,e,"binary");case"buffer":return ur?sl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Df(r):t.type=="string"?Vr(r):r;case"file":return o0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Sy(e,t){xm(),cC(e);var r=ta(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Sy(e,r);return r.type="array",s0(a)}return F7(e,r)}function Sm(e,t){xm(),cC(e);var r=ta(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Sm(e,r);return r.type="array",s0(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return io(OU(e,r),r);case"slk":case"sylk":return io(I5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return io(yC(e.Sheets[e.SheetNames[n]],r),r);case"txt":return k7(FC(e.Sheets[e.SheetNames[n]],r),r);case"csv":return io(Oy(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return io(N5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return mp(kx.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return io(qd.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return io(U5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return io(F5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return io(bC(e,r),r);case"wk1":return mp(Yc.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return mp(Yc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),mp(pC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),R7(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return N7(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Ty(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Uh(e,t,r){var a=r||{};return a.type="file",a.file=t,Ty(a),Sm(e,a)}function D7(e,t,r){var a=r||{};return a.type="file",a.file=t,Ty(a),Sy(e,a)}function j7(e,t,r,a){var n=r||{};n.type="file",n.file=e,Ty(n),n.type="buffer";var i=a;return i instanceof Function||(i=r),Kl.writeFile(e,Sm(t,n),i)}function IC(e,t,r,a,n,i,o,l){var c=Sa(r),A=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var u=t.s.c;u<=t.e.c;++u){var g=o?e[r][u]:e[a[u]+c];if(g===void 0||g.t===void 0){if(A===void 0)continue;i[u]!=null&&(p[i[u]]=A);continue}var h=g.v;switch(g.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[u]!=null){if(h==null)if(g.t=="e"&&h===null)p[i[u]]=null;else if(A!==void 0)p[i[u]]=A;else if(d&&h===null)p[i[u]]=null;else continue;else p[i[u]]=d&&(g.t!=="n"||g.t==="n"&&l.rawNumbers!==!1)?h:xo(g,h,l);h!=null&&(f=!1)}}return{row:p,isempty:f}}function Mh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=t||{},d=A.range!=null?A.range:e["!ref"];switch(A.header===1?a=1:A.header==="A"?a=2:Array.isArray(A.header)?a=3:A.header==null&&(a=0),typeof d){case"string":c=xr(d);break;case"number":c=xr(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var f=Sa(c.s.r),p=[],u=[],g=0,h=0,x=Array.isArray(e),y=c.s.r,v=0,E={};x&&!e[y]&&(e[y]=[]);var k=A.skipHidden&&e["!cols"]||[],S=A.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(k[v]||{}).hidden)switch(p[v]=la(v),r=x?e[y][v]:e[p[v]+f],a){case 1:i[v]=v-c.s.c;break;case 2:i[v]=p[v];break;case 3:i[v]=A.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=xo(r,null,A),h=E[o]||0,!h)E[o]=1;else{do l=o+"_"+h++;while(E[l]);E[o]=h,E[l]=1}i[v]=l}for(y=c.s.r+n;y<=c.e.r;++y)if(!(S[y]||{}).hidden){var B=IC(e,c,y,p,a,i,x,A);(B.isempty===!1||(a===1?A.blankrows!==!1:A.blankrows))&&(u[g++]=B.row)}return u.length=g,u}var ow=/"/g;function NC(e,t,r,a,n,i,o,l){for(var c=!0,A=[],d="",f=Sa(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var u=l.dense?(e[r]||[])[p]:e[a[p]+f];if(u==null)d="";else if(u.v!=null){c=!1,d=""+(l.rawNumbers&&u.t=="n"?u.v:xo(u,null,l));for(var g=0,h=0;g!==d.length;++g)if((h=d.charCodeAt(g))===n||h===i||h===34||l.forceQuotes){d='"'+d.replace(ow,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(c=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(ow,'""')+'"')):d="";A.push(d)}return l.blankrows===!1&&c?null:A.join(o)}function Oy(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=xr(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),A=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(f[g]=la(g));for(var h=0,x=n.s.r;x<=n.e.r;++x)(u[x]||{}).hidden||(d=NC(e,n,x,f,o,c,i,a),d!=null&&(a.strip&&(d=d.replace(A,"")),(d||a.blankrows!==!1)&&r.push((h++?l:"")+d)));return delete a.dense,r.join("")}function FC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Oy(e,t);if(typeof _r>"u"||t.type=="string")return r;var a=_r.utils.encode(1200,r,"str");return"ÿþ"+a}function L7(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=xr(e["!ref"]),i="",o=[],l,c=[],A=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=la(l);for(var d=n.s.r;d<=n.e.r;++d)for(i=Sa(d),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=A?(e[d]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function RC(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?ga(a.origin):a.origin;o=c.r,l=c.c}var A,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var f=xr(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+n)}else o==-1&&(o=0,d.e.r=t.length-1+n);var p=a.header||[],u=0;t.forEach(function(h,x){Oa(h).forEach(function(y){(u=p.indexOf(y))==-1&&(p[u=p.length]=y);var v=h[y],E="z",k="",S=Wt({c:l+u,r:o+x+n});A=Vf(i,S),v&&typeof v=="object"&&!(v instanceof Date)?i[S]=v:(typeof v=="number"?E="n":typeof v=="boolean"?E="b":typeof v=="string"?E="s":v instanceof Date?(E="d",a.cellDates||(E="n",v=ln(v)),k=a.dateNF||zt[14]):v===null&&a.nullError&&(E="e",v=0),A?(A.t=E,A.v=v,delete A.w,delete A.R,k&&(A.z=k)):i[S]=A={t:E,v},k&&(A.z=k))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var g=Sa(o);if(n)for(u=0;u<p.length;++u)i[la(u+l)+g]={t:"s",v:p[u]};return i["!ref"]=lr(d),i}function U7(e,t){return RC(null,e,t)}function Vf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=ga(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Vf(e,Wt(t)):Vf(e,Wt({r:t,c:r||0}))}function M7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Iy(){return{SheetNames:[],Sheets:{}}}function Ny(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(lC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function P7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=M7(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function Q7(e,t){return e.z=t,e}function kC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function q7(e,t,r){return kC(e,"#"+t,r)}function K7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function H7(e,t,r,a){for(var n=typeof t!="string"?t:xr(t),i=typeof t=="string"?t:lr(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=Vf(e,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var fs={encode_col:la,encode_row:Sa,encode_cell:Wt,encode_range:lr,decode_col:ay,decode_row:ry,split_cell:cN,decode_cell:ga,decode_range:xs,format_cell:xo,sheet_add_aoa:Z_,sheet_add_json:RC,sheet_add_dom:vC,aoa_to_sheet:Wd,json_to_sheet:U7,table_to_sheet:wC,table_to_book:e7,sheet_to_csv:Oy,sheet_to_txt:FC,sheet_to_json:Mh,sheet_to_html:yC,sheet_to_formulae:L7,sheet_to_row_object_array:Mh,sheet_get_cell:Vf,book_new:Iy,book_append_sheet:Ny,book_set_sheet_visibility:P7,cell_set_number_format:Q7,cell_set_hyperlink:kC,cell_set_internal_link:q7,cell_add_comment:K7,sheet_set_array_formula:H7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Tm;function G7(e){Tm=e}function z7(e,t){var r=Tm(),a=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var n=xr(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),A=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(f[g]=la(g));var h=n.s.r,x=!1,y=0;return r._read=function(){if(!x)return x=!0,r.push("\uFEFF");for(;h<=n.e.r;)if(++h,!(u[h-1]||{}).hidden&&(d=NC(e,n,h-1,f,o,c,i,a),d!=null&&(a.strip&&(d=d.replace(A,"")),d||a.blankrows!==!1)))return r.push((y++?l:"")+d);return r.push(null)},r}function V7(e,t){var r=Tm(),a=t||{},n=a.header!=null?a.header:mC,i=a.footer!=null?a.footer:gC;r.push(n);var o=xs(e["!ref"]);a.dense=Array.isArray(e),r.push(xC(e,o,a));var l=o.s.r,c=!1;return r._read=function(){if(l>o.e.r)return c||(c=!0,r.push("</table>"+i)),r.push(null);for(;l<=o.e.r;){r.push(hC(e,o,l,a)),++l;break}},r}function $7(e,t){var r=Tm({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var a={t:"n",v:0},n=0,i=1,o=[],l=0,c="",A={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)&&(n=3),typeof f){case"string":A=xr(f);break;case"number":A=xr(e["!ref"]),A.s.r=f;break;default:A=f}n>0&&(i=0);var p=Sa(A.s.r),u=[],g=0,h=Array.isArray(e),x=A.s.r,y=0,v={};h&&!e[x]&&(e[x]=[]);var E=d.skipHidden&&e["!cols"]||[],k=d.skipHidden&&e["!rows"]||[];for(y=A.s.c;y<=A.e.c;++y)if(!(E[y]||{}).hidden)switch(u[y]=la(y),a=h?e[x][y]:e[u[y]+p],n){case 1:o[y]=y-A.s.c;break;case 2:o[y]=u[y];break;case 3:o[y]=d.header[y-A.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),c=l=xo(a,null,d),g=v[l]||0,!g)v[l]=1;else{do c=l+"_"+g++;while(v[c]);v[l]=g,v[c]=1}o[y]=c}return x=A.s.r+i,r._read=function(){for(;x<=A.e.r;)if(!(k[x-1]||{}).hidden){var S=IC(e,A,x,u,n,o,h,d);if(++x,S.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows)){r.push(S.row);return}}return r.push(null)},r}var Y7={to_json:$7,to_html:V7,to_csv:z7,set_readable:G7};const W7=kf.version,X7=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ut,SSF:R_,parse_xlscfb:Ey,parse_zip:CC,read:dA,readFile:iw,readFileSync:iw,set_cptable:e3,set_fs:O3,stream:Y7,utils:fs,version:W7,write:Sm,writeFile:Uh,writeFileAsync:j7,writeFileSync:Uh,writeFileXLSX:D7,writeXLSX:Sy},Symbol.toStringTag,{value:"Module"}));class J7 extends zc{constructor(){super("CMSDatabase");tr(this,"collateralCards");tr(this,"partners");tr(this,"documents");tr(this,"settings");tr(this,"inspections");tr(this,"documentIndexes");tr(this,"documentChunks");tr(this,"knowledgeTopics");tr(this,"knowledgeCategories");tr(this,"knowledgeSearchIndex");tr(this,"tasks");tr(this,"workflowCases");tr(this,"workflowTemplates");this.version(2).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id"}).upgrade(async()=>{console.log("Upgrading database to version 2...")}),this.version(3).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt"}).upgrade(async()=>{console.log("Upgrading database to version 3...")}),this.version(4).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page"}).upgrade(async()=>{console.log("Upgrading database to version 4...")}),this.version(5).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page",knowledgeTopics:"id, category",knowledgeCategories:"id",knowledgeSearchIndex:"keyword"}).upgrade(async()=>{console.log("Upgrading database to version 5...")}),this.version(6).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page",knowledgeTopics:"id, category",knowledgeCategories:"id",knowledgeSearchIndex:"keyword",tasks:"id, employeeId, region, status, type, dueDate, createdAt"}).upgrade(async r=>{console.log("Upgrading database to version 6: migrating tasks from localStorage...");try{let a=null;try{a=localStorage.getItem("zadachnik_tasks")}catch{console.warn("Не удалось прочитать задачи из localStorage (возможно, данные слишком большие), пропускаем миграцию");return}if(a)try{const n=JSON.parse(a);if(Array.isArray(n)&&n.length>0){for(let o=0;o<n.length;o+=1e3){const l=n.slice(o,o+1e3);await r.table("tasks").bulkPut(l)}console.log(`✅ Мигрировано ${n.length} задач из localStorage в IndexedDB`);try{localStorage.removeItem("zadachnik_tasks")}catch{console.warn("Не удалось удалить задачи из localStorage (не критично)")}}}catch(n){console.error("Ошибка парсинга задач из localStorage:",n);try{localStorage.removeItem("zadachnik_tasks")}catch{}}}catch(a){console.error("Ошибка миграции задач:",a)}}),this.version(7).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page",knowledgeTopics:"id, category",knowledgeCategories:"id",knowledgeSearchIndex:"keyword",tasks:"id, employeeId, region, status, type, dueDate, createdAt",workflowCases:"id, objectId, stage, updatedAt",workflowTemplates:"id, type, updatedAt"}).upgrade(async()=>{console.log("Upgrading database to version 7: adding workflow tables")})}}const Jr=new J7;class Z7{constructor(){tr(this,"db");this.db=Jr}async initDatabase(){try{await this.db.open(),console.log("Extended database initialized successfully"),await this.db.settings.get("app-settings")||await this.db.settings.add({id:"app-settings",theme:"light",language:"ru",sidebarCollapsed:!1})}catch(t){throw console.error("Failed to initialize database:",t),t}}async saveExtendedCard(t){try{const r=new Date,a={...t,updatedAt:r,createdAt:t.createdAt||r};return await this.db.collateralCards.put(a),a.id}catch(r){throw console.error("Failed to save collateral card:",r),r}}async getExtendedCards(t){try{let r=this.db.collateralCards.toCollection();if(t){if(t.mainCategory&&(r=this.db.collateralCards.where("mainCategory").equals(t.mainCategory)),t.status&&(r=r.filter(a=>a.status===t.status)),t.searchQuery){const a=t.searchQuery.toLowerCase();r=r.filter(n=>{var i,o,l;return n.name.toLowerCase().includes(a)||n.number.toLowerCase().includes(a)||((o=(i=n.address)==null?void 0:i.fullAddress)==null?void 0:o.toLowerCase().includes(a))||((l=n.partners)==null?void 0:l.some(c=>{var A,d,f;return((A=c.lastName)==null?void 0:A.toLowerCase().includes(a))||((d=c.firstName)==null?void 0:d.toLowerCase().includes(a))||((f=c.organizationName)==null?void 0:f.toLowerCase().includes(a))}))||!1})}t.dateFrom&&(r=r.filter(a=>a.createdAt>=t.dateFrom)),t.dateTo&&(r=r.filter(a=>a.createdAt<=t.dateTo)),t.region&&(r=r.filter(a=>{var n,i;return!!((i=(n=a.address)==null?void 0:n.region)!=null&&i.toLowerCase().includes(t.region.toLowerCase()))})),t.objectType&&(r=r.filter(()=>!0)),t.hasDocuments!==void 0&&(r=r.filter(a=>{var n,i;return t.hasDocuments?(((n=a.documents)==null?void 0:n.length)||0)>0:(((i=a.documents)==null?void 0:i.length)||0)===0})),t.areaFrom!==void 0&&(r=r.filter(a=>{var i,o;const n=((i=a.characteristics)==null?void 0:i.totalArea)||((o=a.characteristics)==null?void 0:o.area);return n&&n>=t.areaFrom})),t.areaTo!==void 0&&(r=r.filter(a=>{var i,o;const n=((i=a.characteristics)==null?void 0:i.totalArea)||((o=a.characteristics)==null?void 0:o.area);return n&&n<=t.areaTo}))}return await r.toArray()}catch(r){throw console.error("Failed to get collateral cards:",r),r}}async getExtendedCardById(t){try{return await this.db.collateralCards.get(t)}catch(r){throw console.error("Failed to get collateral card:",r),r}}async deleteExtendedCard(t){try{await this.db.collateralCards.delete(t)}catch(r){throw console.error("Failed to delete collateral card:",r),r}}async deleteExtendedCards(t){try{await this.db.collateralCards.bulkDelete(t)}catch(r){throw console.error("Failed to delete collateral cards:",r),r}}async savePartner(t){try{return await this.db.partners.put(t),t.id}catch(r){throw console.error("Failed to save partner:",r),r}}async getPartners(){try{return await this.db.partners.toArray()}catch(t){throw console.error("Failed to get partners:",t),t}}async searchPartners(t){try{const r=t.toLowerCase();return await this.db.partners.filter(a=>{var n,i,o,l;return!!((n=a.lastName)!=null&&n.toLowerCase().includes(r)||(i=a.firstName)!=null&&i.toLowerCase().includes(r)||(o=a.organizationName)!=null&&o.toLowerCase().includes(r)||(l=a.inn)!=null&&l.includes(t))}).toArray()}catch(r){throw console.error("Failed to search partners:",r),r}}async saveDocument(t){try{return await this.db.documents.put(t),t.id}catch(r){throw console.error("Failed to save document:",r),r}}async getDocuments(){try{return await this.db.documents.toArray()}catch(t){throw console.error("Failed to get documents:",t),t}}async getSettings(){try{return await this.db.settings.get("app-settings")||{theme:"light",language:"ru",sidebarCollapsed:!1}}catch(t){throw console.error("Failed to get settings:",t),t}}async saveSettings(t){try{const r=await this.getSettings();await this.db.settings.put({id:"app-settings",...r,...t})}catch(r){throw console.error("Failed to save settings:",r),r}}async getTasks(){try{return await this.db.tasks.toArray()}catch(t){throw console.error("Failed to get tasks:",t),t}}async saveTasks(t){try{await this.db.tasks.clear();const r=1e3;for(let a=0;a<t.length;a+=r){const n=t.slice(a,a+r);await this.db.tasks.bulkPut(n)}}catch(r){throw console.error("Failed to save tasks:",r),r}}async saveTask(t){try{await this.db.tasks.put(t)}catch(r){throw console.error("Failed to save task:",r),r}}async deleteTask(t){try{await this.db.tasks.delete(t)}catch(r){throw console.error("Failed to delete task:",r),r}}async getTasksByEmployeeId(t){try{return await this.db.tasks.where("employeeId").equals(t).toArray()}catch(r){throw console.error("Failed to get tasks by employeeId:",r),r}}async getTasksByRegion(t){try{return await this.db.tasks.where("region").equals(t).toArray()}catch(r){throw console.error("Failed to get tasks by region:",r),r}}async exportToExcel(t,r){try{const a=t.map(l=>{var c,A,d,f,p;return{ID:l.id,Номер:l.number,Название:l.name,Категория:this.translateCategory(l.mainCategory),"Вид объекта":l.classification.level1,Тип:l.classification.level2,"Код ЦБ":l.cbCode,Статус:l.status==="editing"?"Редактирование":"Утвержден",Адрес:((c=l.address)==null?void 0:c.fullAddress)||"",Собственники:((A=l.partners)==null?void 0:A.filter(u=>u.role==="owner").map(u=>this.getPartnerName(u)).join(", "))||"",Площадь:((d=l.characteristics)==null?void 0:d.totalArea)||((f=l.characteristics)==null?void 0:f.area)||"",Документов:((p=l.documents)==null?void 0:p.length)||0,"Дата создания":new Date(l.createdAt).toLocaleString("ru-RU"),"Дата обновления":new Date(l.updatedAt).toLocaleString("ru-RU")}}),n=fs.json_to_sheet(a),i=fs.book_new();fs.book_append_sheet(i,n,"Карточки");const o=30;return n["!cols"]=Object.keys(a[0]||{}).map(()=>({wch:o})),Uh(i,`${r}.xlsx`),{success:!0,message:`Экспортировано ${t.length} записей`,filename:`${r}.xlsx`}}catch(a){return console.error("Failed to export to Excel:",a),{success:!1,message:"Ошибка при экспорте данных"}}}async exportBackup(){try{const t=await this.db.collateralCards.toArray(),r=await this.db.partners.toArray(),a=await this.db.documents.toArray(),n=await this.getSettings(),i={version:2,timestamp:new Date().toISOString(),data:{cards:t,partners:r,documents:a,settings:n}};return new Blob([JSON.stringify(i,null,2)],{type:"application/json"})}catch(t){throw console.error("Failed to export backup:",t),t}}async importBackup(t){try{const r=await t.text(),a=JSON.parse(r);if(!a.version||!a.data)throw new Error("Некорректный формат файла резервной копии");if(await this.db.collateralCards.clear(),await this.db.partners.clear(),await this.db.documents.clear(),a.data.cards&&Array.isArray(a.data.cards))for(const n of a.data.cards)n.createdAt=new Date(n.createdAt),n.updatedAt=new Date(n.updatedAt),await this.saveExtendedCard(n);if(a.data.partners&&Array.isArray(a.data.partners))for(const n of a.data.partners)await this.savePartner(n);if(a.data.documents&&Array.isArray(a.data.documents))for(const n of a.data.documents)await this.saveDocument(n);a.data.settings&&await this.saveSettings(a.data.settings),console.log("Backup imported successfully")}catch(r){throw console.error("Failed to import backup:",r),r}}translateCategory(t){return{real_estate:"Недвижимость",movable:"Движимое имущество",property_rights:"Имущественные права"}[t]||t}getPartnerName(t){return t.type==="individual"?[t.lastName,t.firstName,t.middleName].filter(Boolean).join(" "):t.organizationName||""}async getStatistics(){try{const t=await this.db.collateralCards.toArray();return{total:t.length,byCategory:{real_estate:t.filter(r=>r.mainCategory==="real_estate").length,movable:t.filter(r=>r.mainCategory==="movable").length,property_rights:t.filter(r=>r.mainCategory==="property_rights").length},byStatus:{editing:t.filter(r=>r.status==="editing").length,approved:t.filter(r=>r.status==="approved").length},withDocuments:t.filter(r=>{var a;return(((a=r.documents)==null?void 0:a.length)||0)>0}).length,withPartners:t.filter(r=>{var a;return(((a=r.partners)==null?void 0:a.length)||0)>0}).length}}catch(t){throw console.error("Failed to get statistics:",t),t}}async getWorkflowCases(){return await this.db.workflowCases.toArray()}async saveWorkflowCases(t){await this.db.workflowCases.clear(),t.length>0&&await this.db.workflowCases.bulkPut(t)}async getWorkflowTemplates(){return await this.db.workflowTemplates.toArray()}async saveWorkflowTemplates(t){await this.db.workflowTemplates.clear(),t.length>0&&await this.db.workflowTemplates.bulkPut(t)}async ensureDefaultWorkflowTemplates(t){const r=await this.db.workflowTemplates.toArray();(!r||r.length===0)&&await this.saveWorkflowTemplates(t)}}const kt=new Z7,eM=Object.freeze(Object.defineProperty({__proto__:null,default:kt,extendedDb:Jr,extendedStorageService:kt},Symbol.toStringTag,{value:"Module"})),Xs=[{code:"ЦО",name:"Центральный округ",cities:["Москва","Московская область","Ярославль","Воронеж","Тула","Калуга","Рязань","Тверь"]},{code:"СЗРЦ",name:"Северозападный Региональный центр",cities:["Санкт-Петербург","Ленинградская область","Мурманск","Архангельск","Псков","Великий Новгород"]},{code:"ЮРЦ",name:"Южный региональный центр",cities:["Краснодар","Ростов-на-Дону","Майкоп","Ставрополь","Анапа","Волгоград","Сочи","Новороссийск","Таганрог"]},{code:"СРЦ",name:"Сибирский региональный центр",cities:["Новосибирск","Омск","Красноярск","Иркутск","Барнаул","Томск"]},{code:"ЕКЦ",name:"Уральский региональный центр",cities:["Екатеринбург","Челябинск","Пермь","Уфа","Тюмень","Курган"]},{code:"ДВЦ",name:"Дальневосточный центр",cities:["Владивосток","Хабаровск","Южно-Сахалинск","Благовещенск","Петропавловск-Камчатский"]},{code:"ПРЦ",name:"Приволжский региональный центр",cities:["Казань","Нижний Новгород","Самара","Саратов","Ульяновск","Пенза"]},{code:"СЗРЦ2",name:"Северо-Кавказский региональный центр",cities:["Махачкала","Грозный","Нальчик","Владикавказ","Элиста"]}],Fy=e=>Xs.find(t=>t.cities.some(r=>r.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(r.toLowerCase())))||null,lw="cms_employees";class tM{getEmployees(){try{const t=localStorage.getItem(lw);if(!t)return this.getDefaultEmployees();const r=JSON.parse(t);return!Array.isArray(r)||r.length<100?(console.warn("Обнаружено недостаточное количество сотрудников, пересоздаем базу..."),this.getDefaultEmployees()):r}catch(t){return console.error("Ошибка загрузки сотрудников:",t),this.getDefaultEmployees()}}regenerateEmployees(){return console.log("Принудительная регенерация базы сотрудников..."),this.getDefaultEmployees()}saveEmployees(t){try{localStorage.setItem(lw,JSON.stringify(t))}catch(r){console.error("Ошибка сохранения сотрудников:",r)}}getEmployeeById(t){return this.getEmployees().find(a=>a.id===t)}addEmployee(t){const r=this.getEmployees(),a={...t,id:`emp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveEmployees(r),a}updateEmployee(t,r){const a=this.getEmployees(),n=a.findIndex(i=>i.id===t);return n===-1?null:(a[n]={...a[n],...r,updatedAt:new Date().toISOString()},this.saveEmployees(a),a[n])}deleteEmployee(t){const r=this.getEmployees(),a=r.filter(n=>n.id!==t);return a.length===r.length?!1:(this.saveEmployees(a),!0)}getEmployeesByRegion(t){return this.getEmployees().filter(a=>a.region===t&&a.isActive)}getRegions(){const t=this.getEmployees(),r=new Set(t.map(a=>a.region));return Array.from(r).sort()}getMonitoringEmployees(){return this.getEmployees().filter(r=>r.isActive&&r.canMonitor===!0)}getAppraisalEmployees(){return this.getEmployees().filter(r=>r.isActive&&r.canAppraise===!0)}getMonitoringEmployeesByRegion(t){return this.getMonitoringEmployees().filter(r=>r.region===t)}getAppraisalEmployeesByRegion(t){return this.getAppraisalEmployees().filter(r=>r.region===t)}updateWorkload(t,r,a){const n=this.getEmployees(),i=n.findIndex(o=>o.id===t);i!==-1&&(r!==void 0&&(n[i].monitoringWorkload=r),a!==void 0&&(n[i].appraisalWorkload=a),this.saveEmployees(n))}getDefaultEmployees(){const t=[],r=["Иванов","Петров","Сидоров","Смирнов","Кузнецов","Попов","Соколов","Лебедев","Козлов","Новиков","Морозов","Волков","Соловьев","Васильев","Зайцев","Павлов","Семенов","Голубев","Виноградов","Богданов","Воробьев","Федоров","Михайлов","Белов","Тарасов","Беляев","Комаров","Орлов","Киселев","Макаров","Андреев","Ковалев","Ильин","Гусев","Титов","Кузьмин","Кудрявцев","Баранов","Куликов","Алексеев"],a=["Иван","Петр","Сергей","Александр","Дмитрий","Андрей","Михаил","Николай","Владимир","Алексей","Мария","Елена","Анна","Ольга","Татьяна","Наталья","Ирина","Светлана","Екатерина","Юлия","Анастасия","Дарья","Виктория","Евгения","Кристина","Ангелина","Валентина","Галина","Людмила","Надежда"],n=["Иванович","Петрович","Сергеевич","Александрович","Дмитриевич","Андреевич","Михайлович","Николаевич","Владимирович","Алексеевич","Ивановна","Петровна","Сергеевна","Александровна","Дмитриевна","Андреевна","Михайловна","Николаевна","Владимировна","Алексеевна"],i=["Менеджер по работе с залогами","Специалист по мониторингу","Специалист по оценке","Руководитель отдела","Ведущий специалист","Главный специалист","Эксперт","Аналитик"],o=["Отдел залогового обеспечения","Отдел мониторинга","Отдел оценки","Отдел рисков","Отдел кредитования"];let l=1;const c={ЦО:{monitoring:2,appraisal:7},СЗРЦ:{monitoring:6,appraisal:9},ЮРЦ:{monitoring:7,appraisal:10},СРЦ:{monitoring:10,appraisal:4},ЕКЦ:{monitoring:5,appraisal:12},ДВЦ:{monitoring:8,appraisal:9},ПРЦ:{monitoring:6,appraisal:6},СЗРЦ2:{monitoring:4,appraisal:6}};return Xs.forEach((A,d)=>{const p=Array.from({length:30},(y,v)=>v);for(let y=p.length-1;y>0;y--){const v=Math.floor(Math.random()*(y+1));[p[y],p[v]]=[p[v],p[y]]}const u=c[A.code]||{monitoring:5,appraisal:10},g=new Set(p.slice(0,u.monitoring)),h=new Set(p.slice(u.monitoring,u.monitoring+u.appraisal));let x=0;A.cities.forEach((y,v)=>{const E=Math.floor(30/A.cities.length),k=30%A.cities.length,S=E+(v<k?1:0);for(let B=0;B<S;B++){const b=x,O=b===0,_=(l-1)%r.length,U=r[_],I=a[(l-1)%a.length],R=n[(l-1)%n.length],L=g.has(b),N=h.has(b);let P=L?1:N?2:0,Q=L?1:N?2:0;O&&(P=3,Q=0);const Y=i[P],ee=o[Q],G=`${`${U.toLowerCase()}.${I.toLowerCase()}`}${l}@bank.ru`,C=`+7 (${495+d*10+v}) ${String(100+l%900).padStart(3,"0")}-${String(10+l%90).padStart(2,"0")}-${String(10+l%90).padStart(2,"0")}`,D=1970+l%30,j=l%12+1,K=l%28+1,W=`${D}-${String(j).padStart(2,"0")}-${String(K).padStart(2,"0")}`,Ae=String(1e5+l).padStart(6,"0"),ue=Math.random(),he=ue<.85?"working":ue<.9?"sick_leave":ue<.95?"vacation":"business_trip";t.push({id:`emp-${l}`,lastName:U,firstName:I,middleName:R,position:Y,region:y,email:G,phone:C,department:ee,permissions:O?["registry_view","registry_edit","portfolio_view","portfolio_edit","tasks_view","tasks_edit","reports_view","reports_export","settings_view"]:["registry_view","portfolio_view","tasks_view"],isActive:!0,canMonitor:L,canAppraise:N,monitoringWorkload:0,appraisalWorkload:0,isManager:O,birthDate:W,employeeNumber:Ae,status:he,hireDate:`202${Math.floor(l/100)}-${String(l%12+1).padStart(2,"0")}-${String(l%28+1).padStart(2,"0")}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),l++,x++}})}),this.saveEmployees(t),t}}const pr=new tM,rM={token:{colorBgBase:"#1a1a1a",colorBgContainer:"#2d2d2d",colorTextBase:"#e6e6e6",colorPrimary:"#1890ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1890ff",borderRadius:6,boxShadow:"0 3px 6px -4px rgba(0, 0, 0, 0.48), 0 6px 16px 0 rgba(0, 0, 0, 0.32), 0 9px 28px 8px rgba(0, 0, 0, 0.2)"},components:{Layout:{bodyBg:"#1a1a1a",headerBg:"#2d2d2d",siderBg:"#262626"},Table:{headerBg:"#3a3a3a",rowHoverBg:"rgba(255, 255, 255, 0.06)"},Menu:{itemSelectedBg:"rgba(24, 144, 255, 0.15)"},Card:{colorBgContainer:"#2d2d2d"},Button:{colorPrimary:"#1890ff"}}},aM={token:{colorBgBase:"#ece9d8",colorBgContainer:"#ffffff",colorTextBase:"#000000",colorPrimary:"#0054e3",colorSuccess:"#00a651",colorWarning:"#ff8c00",colorError:"#d13438",colorInfo:"#0078d4",borderRadius:3,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"},components:{Button:{colorPrimary:"#0054e3"},Layout:{bodyBg:"#ece9d8",headerBg:"#0054e3"},Card:{colorBgContainer:"#ffffff"}}},nM={token:{colorBgBase:"#000000",colorBgContainer:"#0a0a0a",colorTextBase:"#ffffff",colorPrimary:"#ffffff",colorSuccess:"#ffffff",colorWarning:"#ffffff",colorError:"#ffffff",colorInfo:"#ffffff",colorTextLightSolid:"#000000",borderRadius:4,boxShadow:"0 2px 8px rgba(255, 255, 255, 0.1)"},components:{Layout:{bodyBg:"#000000",headerBg:"#0a0a0a",siderBg:"#050505"},Menu:{darkItemBg:"#050505",darkSubMenuItemBg:"#0a0a0a",darkItemSelectedBg:"#1a1a1a",darkItemColor:"#ffffff",darkItemHoverBg:"#151515"},Button:{colorPrimary:"#ffffff",colorPrimaryHover:"#e0e0e0"},Card:{colorBgContainer:"#0a0a0a"},Table:{headerBg:"#0a0a0a"},Modal:{contentBg:"#0a0a0a"},Drawer:{colorBgElevated:"#0a0a0a"},Input:{colorBgContainer:"#050505",colorBorder:"#ffffff",colorText:"#ffffff"},Select:{colorBgContainer:"#050505",colorBorder:"#ffffff",colorText:"#ffffff"},Switch:{colorPrimary:"#ffffff"},Tag:{colorBgContainer:"#1a1a1a",colorText:"#ffffff"}}},sM={token:{colorBgBase:"#000000",colorBgContainer:"#001100",colorTextBase:"#00ff00",colorPrimary:"#00ff00",colorSuccess:"#00ff00",colorWarning:"#ffff00",colorError:"#ff0000",colorInfo:"#00ffff",borderRadius:0,boxShadow:"0 0 10px rgba(0, 255, 0, 0.3), inset 0 0 10px rgba(0, 255, 0, 0.1)"},components:{Layout:{bodyBg:"#000000",headerBg:"#001100",siderBg:"#000800"},Menu:{darkItemBg:"#000800",darkSubMenuItemBg:"#001100",darkItemSelectedBg:"#002200",darkItemColor:"#00ff00",darkItemHoverBg:"#001a00"},Button:{colorPrimary:"#00ff00",colorPrimaryHover:"#00cc00"},Card:{colorBgContainer:"#001100"},Table:{headerBg:"#001100"},Modal:{contentBg:"#001100"},Drawer:{colorBgElevated:"#001100"},Input:{colorBgContainer:"#000800",colorBorder:"#00ff00",colorText:"#00ff00"},Select:{colorBgContainer:"#000800",colorBorder:"#00ff00",colorText:"#00ff00"},Switch:{colorPrimary:"#00ff00"}}},iM={token:{colorBgBase:"#f2f2f7",colorBgContainer:"#ffffff",colorTextBase:"#000000",colorPrimary:"#007aff",colorSuccess:"#34c759",colorWarning:"#ff9500",colorError:"#ff3b30",colorInfo:"#5ac8fa",borderRadius:12,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.08)",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", sans-serif'},components:{Layout:{bodyBg:"#f2f2f7",headerBg:"#ffffff",siderBg:"#f8f8f8"},Menu:{itemBg:"transparent",itemSelectedBg:"#007aff",itemHoverBg:"rgba(0, 122, 255, 0.1)",itemColor:"#000000",itemSelectedColor:"#ffffff",darkItemBg:"transparent",darkItemColor:"#000000",darkItemSelectedBg:"#007aff",darkItemSelectedColor:"#ffffff",darkItemHoverBg:"rgba(0, 122, 255, 0.1)"},Button:{colorPrimary:"#007aff",colorPrimaryHover:"#0051d5",borderRadius:12,controlHeight:44},Card:{colorBgContainer:"#ffffff",borderRadiusLG:16},Table:{headerBg:"#f9f9f9",borderRadiusLG:12},Modal:{contentBg:"#ffffff",borderRadiusLG:16},Drawer:{colorBgElevated:"#f2f2f7"},Input:{colorBgContainer:"#ffffff",colorBorder:"#d1d1d6",colorText:"#000000",borderRadius:10,controlHeight:44},Select:{colorBgContainer:"#ffffff",colorBorder:"#d1d1d6",colorText:"#000000",borderRadius:10,controlHeight:44},Switch:{colorPrimary:"#34c759"},Tag:{colorBgContainer:"#e5e5ea",colorText:"#000000",borderRadiusLG:8}}},oM={token:{colorBgBase:"#c0c0c0",colorBgContainer:"#c0c0c0",colorTextBase:"#000000",colorPrimary:"#000080",colorSuccess:"#008000",colorWarning:"#808000",colorError:"#800000",colorInfo:"#000080",borderRadius:0,boxShadow:"inset -1px -1px 0px #000000, inset 1px 1px 0px #ffffff, inset -2px -2px 0px #808080, inset 2px 2px 0px #dfdfdf"},components:{Layout:{bodyBg:"#008080",headerBg:"#000080",siderBg:"#c0c0c0"},Menu:{darkItemBg:"#c0c0c0",darkSubMenuItemBg:"#c0c0c0",darkItemSelectedBg:"#000080",darkItemColor:"#000000",darkItemHoverBg:"#0000a0"},Button:{colorPrimary:"#000080",colorPrimaryHover:"#0000a0",borderRadius:0},Card:{colorBgContainer:"#c0c0c0",borderRadiusLG:0},Table:{headerBg:"#000080",borderRadiusLG:0},Modal:{contentBg:"#c0c0c0",borderRadiusLG:0},Drawer:{colorBgElevated:"#c0c0c0"},Input:{colorBgContainer:"#ffffff",colorBorder:"#808080",colorText:"#000000",borderRadius:0},Select:{colorBgContainer:"#ffffff",colorBorder:"#808080",colorText:"#000000",borderRadius:0},Switch:{colorPrimary:"#000080"},Tag:{colorBgContainer:"#c0c0c0",colorText:"#000000",borderRadiusLG:0}}},DC=M.createContext(void 0),lM=({children:e})=>{const[t,r]=M.useState(()=>localStorage.getItem("cms-theme")||"dark-gray");M.useEffect(()=>{localStorage.setItem("cms-theme",t),document.documentElement.classList.add("theme-transitioning"),requestAnimationFrame(()=>{document.documentElement.setAttribute("data-theme",t),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},500)})},[t]);const a=()=>{switch(t){case"dark-gray":return{...rM,algorithm:Ul.darkAlgorithm};case"windows-xp":return aM;case"windows-97":return oM;case"ios":return iM;case"matrix":return{...sM,algorithm:Ul.darkAlgorithm};case"dark":return{...nM,algorithm:Ul.darkAlgorithm};case"light":default:return{algorithm:Ul.defaultAlgorithm}}};return s.jsx(DC.Provider,{value:{currentTheme:t,setTheme:r},children:s.jsx(fb,{theme:a(),children:e})})},Hg=()=>`demo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Rc=(e,t)=>new Date(e.getTime()+Math.random()*(t.getTime()-e.getTime())),Gg=e=>{const t=["Ленина","Пушкина","Гагарина","Мира","Советская","Кирова","Первомайская"],r=t[Math.floor(Math.random()*t.length)],a=Math.floor(Math.random()*200)+1,n=Math.floor(Math.random()*100)+1;return{fullAddress:`г. ${e}, ул. ${r}, д. ${a}, кв. ${n}`,postalCode:`${1e5+Math.floor(Math.random()*99999)}`,region:e,city:e,street:`ул. ${r}`,house:a.toString(),apartment:n.toString(),coordinates:{lat:55.7558+(Math.random()-.5)*.1,lon:37.6173+(Math.random()-.5)*.1}}},cM=[{level0:"Коммерческая недвижимость",level1:"Офис",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Торговое помещение",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Склад",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Производственное помещение",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Квартира",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Комната",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Дом",level2:"Здание"},{level0:"Жилая недвижимость",level1:"Дача",level2:"Здание"},{level0:"Промышленная недвижимость",level1:"Цех",level2:"Помещение"},{level0:"Промышленная недвижимость",level1:"Ангар",level2:"Сооружение"},{level0:"Коммерческая недвижимость",level1:"Парковочное место",level2:"Помещение"}],AM=[{level0:"Транспорт",level1:"Легковой автомобиль",level2:"Транспортное средство"},{level0:"Транспорт",level1:"Грузовой автомобиль",level2:"Транспортное средство"},{level0:"Транспорт",level1:"Спецтехника",level2:"Транспортное средство"},{level0:"Оборудование",level1:"Производственное оборудование",level2:"Станок"},{level0:"Оборудование",level1:"Офисное оборудование",level2:"Техника"},{level0:"Оборудование",level1:"Компьютерная техника",level2:"Техника"}],dM=[{level0:"Ценные бумаги",level1:"Акции",level2:"Долевые"},{level0:"Ценные бумаги",level1:"Облигации",level2:"Долговые"},{level0:"Права требования",level1:"Дебиторская задолженность",level2:"Требование"},{level0:"Интеллектуальная собственность",level1:"Патент",level2:"Право"},{level0:"Интеллектуальная собственность",level1:"Товарный знак",level2:"Право"}],uM=e=>{const r={area:(Math.floor(Math.random()*500)+20).toString(),floor:Math.floor(Math.random()*20)+1,totalFloors:Math.floor(Math.random()*25)+1,roomsCount:Math.floor(Math.random()*5)+1,cadastralNumber:`77:${Math.floor(Math.random()*99)}:${Math.floor(Math.random()*999999)}:${Math.floor(Math.random()*9999)}`,buildYear:Math.floor(Math.random()*50)+1970};return(e==="Квартира"||e==="Комната")&&(r.hasBalcony=Math.random()>.5,r.renovation=["Без ремонта","Косметический","Евроремонт","Дизайнерский"][Math.floor(Math.random()*4)]),(e==="Дом"||e==="Дача")&&(r.landArea=Math.floor(Math.random()*1e3)+100,r.hasGarage=Math.random()>.5),r},fM=()=>{const e=["Toyota","Mercedes-Benz","BMW","Volkswagen","Ford","Hyundai","KIA"];return{brand:e[Math.floor(Math.random()*e.length)],model:`Model-${Math.floor(Math.random()*100)}`,year:Math.floor(Math.random()*10)+2014,vin:`VIN${Math.random().toString(36).substr(2,14).toUpperCase()}`,mileage:Math.floor(Math.random()*2e5)+1e4,color:["Черный","Белый","Серебристый","Синий","Красный"][Math.floor(Math.random()*5)],engineVolume:(Math.random()*3+1).toFixed(1),fuelType:["Бензин","Дизель","Электро","Гибрид"][Math.floor(Math.random()*4)]}},pM=()=>({manufacturer:["Siemens","ABB","Schneider","GE","Mitsubishi"][Math.floor(Math.random()*5)],model:`EQ-${Math.floor(Math.random()*1e4)}`,serialNumber:`SN${Math.random().toString(36).substr(2,10).toUpperCase()}`,productionYear:Math.floor(Math.random()*15)+2009,condition:["Новое","Хорошее","Удовлетворительное","Требует ремонта"][Math.floor(Math.random()*4)],power:`${Math.floor(Math.random()*100)+10} кВт`}),zg=(e,t)=>{let r=1e6;return e==="real_estate"?r=Math.floor(Math.random()*5e7)+5e6:e==="movable"?t.includes("автомобиль")?r=Math.floor(Math.random()*5e6)+5e5:r=Math.floor(Math.random()*2e6)+1e5:r=Math.floor(Math.random()*1e7)+1e6,{marketValue:r,pledgeValue:Math.floor(r*(.6+Math.random()*.3)),evaluationDate:Rc(new Date(2023,0,1),new Date).toISOString().split("T")[0]}},hM=()=>{const e=[],t=["Москва","Санкт-Петербург","Новосибирск","Екатеринбург"],r=["editing","approved"];let a=1;return cM.forEach((n,i)=>{const o=t[i%t.length],l=r[i%r.length],c=Rc(new Date(2023,0,1),new Date);e.push({id:Hg(),number:`RE-${a.toString().padStart(4,"0")}`,name:`${n.level1} в ${o}`,mainCategory:"real_estate",classification:n,cbCode:100+i,status:l,address:Gg(o),characteristics:uM(n.level1),...zg("real_estate",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Компания ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[{id:"1",name:"Свидетельство о собственности",type:"ownership",uploadDate:c.toISOString().split("T")[0]},{id:"2",name:"Кадастровый паспорт",type:"cadastral",uploadDate:c.toISOString().split("T")[0]}],photos:[],notes:"Демо-карточка недвижимости для тестирования системы"}),a++}),AM.forEach((n,i)=>{const o=t[i%t.length],l=r[i%r.length],c=Rc(new Date(2023,0,1),new Date);let A,d;n.level0==="Транспорт"?(A=fM(),d=`${n.level1} - ${A.brand}`):(A=pM(),d=`${n.level1} - ${A.manufacturer}`),e.push({id:Hg(),number:`MV-${a.toString().padStart(4,"0")}`,name:d,mainCategory:"movable",classification:n,cbCode:200+i,status:l,address:Gg(o),characteristics:A,...zg("movable",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Транспорт ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[{id:"1",name:"ПТС",type:"pts",uploadDate:c.toISOString().split("T")[0]}],photos:[],notes:"Демо-карточка движимого имущества для тестирования системы"}),a++}),dM.forEach((n,i)=>{const o=t[i%t.length],l=r[i%r.length],c=Rc(new Date(2023,0,1),new Date);e.push({id:Hg(),number:`PR-${a.toString().padStart(4,"0")}`,name:`${n.level1} - ${o}`,mainCategory:"property_rights",classification:n,cbCode:300+i,status:l,address:Gg(o),characteristics:{nominalValue:Math.floor(Math.random()*1e7)+1e5,quantity:Math.floor(Math.random()*1e3)+1,issuer:`ПАО "Эмитент ${i+1}"`},...zg("property_rights",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Инвестор ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[],photos:[],notes:"Демо-карточка имущественных прав для тестирования системы"}),a++}),e},jC=M.createContext(void 0),mM=({children:e})=>{const t=nl(),[r,a]=M.useState(!1),n=async()=>{try{a(!0);const o=hM();Ne.loading({content:"Загрузка демо-данных...",key:"demo"});for(const l of o)await kt.saveExtendedCard(l);t(J1(o)),Ne.success({content:`Загружено ${o.length} демо-карточек`,key:"demo",duration:3})}catch(o){Ne.error({content:"Ошибка загрузки демо-данных",key:"demo"}),console.error(o)}finally{a(!1)}},i=async()=>{try{a(!0),Ne.loading({content:"Удаление демо-данных...",key:"clear"});const o=await kt.getExtendedCards();for(const l of o)await kt.deleteExtendedCard(l.id);t(J1([])),Ne.success({content:"Все демо-данные удалены",key:"clear",duration:3})}catch(o){Ne.error({content:"Ошибка удаления демо-данных",key:"clear"}),console.error(o)}finally{a(!1)}};return s.jsx(jC.Provider,{value:{loadDemoData:n,clearDemoData:i,isLoading:r},children:e})},gM=()=>{const e=M.useContext(DC);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},{Sider:xM}=_f,yM=({collapsed:e,onLoadDemoData:t,onClearDemoData:r,hasCards:a=!1,isMobile:n=!1})=>{const i=$i(),o=dc(),{currentTheme:l,setTheme:c}=gM(),A=[{key:"registry",label:"Реестр объектов",icon:s.jsx(el,{}),path:"/registry"},{key:"portfolio",label:"Залоговый портфель",icon:s.jsx(pb,{}),path:"/portfolio"},{key:"tasks",label:"Задачи",icon:s.jsx(go,{}),path:"/tasks"},{key:"kpi",label:"KPI",icon:s.jsx(RT,{}),path:"/kpi",tooltip:"KPI и аналитика"},{key:"reports",label:"Отчеты",icon:s.jsx(qc,{}),path:"/reports",tooltip:"Агрегирование отчетности"},{key:"collateral-dossier",label:"Залоговое досье",icon:s.jsx(z1,{}),path:"/collateral-dossier"},{key:"collateral-conclusions",label:"Залоговые заключения",icon:s.jsx(jr,{}),path:"/collateral-conclusions"},{key:"insurance",label:"Страхование",icon:s.jsx(kT,{}),path:"/insurance"},{key:"fnp",label:"ФНП",icon:s.jsx(hb,{}),path:"/fnp",tooltip:"Регистрация залога движимого имущества ФНП"},{key:"analytics",label:"Аналитика",icon:s.jsx(tA,{}),path:"/analytics"},{key:"credit-risk",label:"Модуль мониторинга",icon:s.jsx(DT,{}),path:"/credit-risk",tooltip:"Модуль мониторинга"},{key:"appraisal",label:"Модуль оценки",icon:s.jsx(Zf,{}),path:"/appraisal",tooltip:"Автоматическая оценка объектов залога"},{key:"cms-check",label:"CMS Check",icon:s.jsx(Ao,{}),path:"/cms-check",tooltip:"Система дистанционных осмотров"},{key:"egrn",label:"ЕГРН",icon:s.jsx(jr,{}),path:"/egrn",tooltip:"Регистрация ипотеки, снятие обременений, выписки ЕГРН"},{key:"upload",label:"Загрузка",icon:s.jsx(jT,{}),path:"/upload"},{key:"monitoring",label:"Мониторинг",icon:s.jsx(LT,{}),path:"/monitoring"},{key:"reference",label:"Справочная с ИИ",icon:s.jsx(Cf,{}),path:"/reference",tooltip:"Консультации по нормативным документам, оценке и рабочим вопросам"},{key:"workflow",label:"Внесудебная реализация",icon:s.jsx(jr,{}),path:"/workflow",tooltip:"Workflow внесудебной реализации залога"},{key:"settings",label:"Настройки",icon:s.jsx(Kc,{}),path:"/settings"}],d=u=>{const g=A.find(h=>h.key===u);g&&(g.external&&g.path?window.open(g.path,"_blank","noopener,noreferrer"):g.path&&i(g.path))},f=A.map(u=>({key:u.key,icon:u.icon,label:u.tooltip?s.jsx(Kr,{title:u.tooltip,placement:"right",children:s.jsx("span",{children:u.label})}):u.label})),p=()=>{const u=o.pathname.split("/").filter(Boolean);return u.length===0?"registry":u[0]};return s.jsxs(xM,{collapsible:!0,collapsed:e,trigger:null,width:250,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,zIndex:1e3,transform:n&&e?"translateX(-100%)":"translateX(0)",transition:"transform 0.2s"},children:[s.jsxs("div",{className:"sidebar-logo",onClick:()=>i("/"),style:{height:"64px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:e?"16px":"20px",fontWeight:"bold",transition:"all 0.2s",gap:"8px",padding:e?"8px":"12px",cursor:"pointer"},children:[s.jsx("img",{src:"/logo.png",alt:"CMS Logo",style:{height:e?"32px":"40px",width:"auto",objectFit:"contain",transition:"all 0.2s"}}),!e&&s.jsx("span",{style:{marginLeft:"8px"},children:"CMS"})]}),s.jsx(FT,{theme:"dark",mode:"inline",selectedKeys:[p()],items:f,onClick:({key:u})=>d(u),style:{flex:1,borderRight:0}}),!e&&s.jsx("div",{style:{padding:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"small",children:[s.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"14px"},children:"Настройки"}),s.jsxs("div",{style:{color:"#fff",fontSize:"12px"},children:["Тема:",s.jsx(Ve,{value:l,onChange:c,size:"small",style:{width:"100%",marginTop:"4px"},options:[{value:"light",label:"Светлая"},{value:"dark",label:"Темная"},{value:"dark-gray",label:"Темно-серая"},{value:"ios",label:"iOS"},{value:"windows-xp",label:"Windows XP"},{value:"windows-97",label:"Windows 97"},{value:"matrix",label:"Матрица"}]})]}),t&&s.jsx("div",{style:{marginTop:"8px"},children:s.jsx(Kr,{title:a?"Перезагрузить демо-данные (44)":"Загрузить демо-данные (44)",children:s.jsx(Be,{icon:s.jsx(el,{}),onClick:t,type:a?"dashed":"primary",danger:a,size:"small",style:{width:"100%"}})})}),r&&a&&s.jsx("div",{style:{marginTop:"8px"},children:s.jsx(Kr,{title:"Удалить все демо-данные",children:s.jsx(Be,{icon:s.jsx(Oi,{}),onClick:r,type:"dashed",danger:!0,size:"small",style:{width:"100%"}})})}),s.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[s.jsx("div",{style:{color:"#fff",fontSize:"12px",marginBottom:"8px",opacity:.7},children:"Техническая поддержка:"}),s.jsx("a",{href:"mailto:cmsauto@bk.ru",style:{color:"#1890ff",fontSize:"12px",textDecoration:"none",display:"block",wordBreak:"break-all"},onMouseEnter:u=>u.currentTarget.style.textDecoration="underline",onMouseLeave:u=>u.currentTarget.style.textDecoration="none",children:"cmsauto@bk.ru"})]})]})})]})},{Header:vM}=_f,{Text:gp}=ht,wM=e=>{switch(e){case"owner":return"залогодателю (название, ИНН)";case"identifier":return"идентификатору (кадастровый номер, VIN, серийный номер, ID)";case"name":return"наименованию";case"type":return"типу объекта";case"kind":return"виду объекта";default:return"наименованию"}},EM=({onCreateCard:e,onExport:t,onImport:r,onSearch:a,onSearchAttributeChange:n,onToggleHeader:i,searchText:o="",searchAttribute:l="name",headerVisible:c=!0,contextTitle:A,isRegistry:d=!1,isMobile:f=!1})=>{const p=nl(),{sidebarCollapsed:u}=Vi(_=>_.app),[g,h]=M.useState({total:0,overdue:0,nearestDeadline:void 0,newCount:0,completed:0}),[x,y]=M.useState(!1),v=()=>{p(PO())};M.useEffect(()=>{(async()=>{try{const U=await kt.getTasks(),I=Date.now(),R=U.filter(Y=>Y.status!=="completed"),L=R.filter(Y=>new Date(Y.dueDate).getTime()<I),N=R.filter(Y=>new Date(Y.dueDate).getTime()>=I).sort((Y,ee)=>new Date(Y.dueDate).getTime()-new Date(ee.dueDate).getTime())[0],P=R.filter(Y=>Y.status==="new").length,Q=U.filter(Y=>Y.status==="completed").length;h({total:R.length,overdue:L.length,nearestDeadline:N?new Date(N.dueDate).toLocaleDateString("ru-RU"):void 0,newCount:P,completed:Q})}catch(U){console.warn("Не удалось загрузить задачи для хедера:",U)}})()},[]);const E=[{key:"profile",icon:s.jsx(ti,{}),label:"Профиль"},{type:"divider"},{key:"logout",icon:s.jsx(QT,{}),label:"Выход",danger:!0}],k=({key:_})=>{_==="profile"&&y(!0)},S=g.total+g.completed,B=S>0?Math.round(g.completed/S*100):100,b=S>0?Math.round(100-g.overdue/Math.max(1,S)*100):100,O=Math.round((B+b)/2);return s.jsxs(vM,{style:{position:"fixed",top:0,left:u?"80px":"250px",right:0,zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"left 0.2s"},children:[s.jsxs(Te,{size:"large",children:[s.jsx(Be,{type:"text",icon:u?s.jsx(mb,{}):s.jsx(gb,{}),onClick:v,style:{fontSize:"16px",width:40,height:40}}),s.jsx(Be,{type:"text",icon:c?s.jsx(UT,{}):s.jsx(xb,{}),onClick:i,style:{fontSize:"16px",width:40,height:40},title:c?"Скрыть шапку":"Показать шапку"}),A&&s.jsx("span",{style:{fontWeight:600,fontSize:16},children:A}),d&&s.jsxs(s.Fragment,{children:[s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:e,children:"Создать карточку"}),s.jsx(Be,{icon:s.jsx(MT,{}),onClick:t,children:"Экспорт в Excel"}),s.jsx(Be,{icon:s.jsx(PT,{}),onClick:r,children:"Импорт"})]})]}),s.jsxs(Te,{size:"middle",children:[d&&s.jsxs(s.Fragment,{children:[s.jsx(Ve,{value:l,onChange:n,style:{width:f?120:150},options:[{value:"owner",label:"Залогодатель"},{value:"identifier",label:"Идентификатор"},{value:"name",label:"Наименование"},{value:"type",label:"Тип"},{value:"kind",label:"Вид"}]}),s.jsx(Re,{placeholder:`Поиск по ${wM(l)}...`,prefix:s.jsx(Pa,{}),value:o,onChange:_=>a==null?void 0:a(_.target.value),style:{width:f?180:280},allowClear:!0})]}),!d&&s.jsxs(Te,{size:16,align:"center",children:[s.jsxs(Te,{size:4,align:"center",children:[s.jsx(Iv,{style:{fontSize:18,color:"#52c41a"}}),s.jsx(gp,{children:g.total})]}),s.jsxs(Te,{size:4,align:"center",children:[s.jsx(Iv,{style:{fontSize:18,color:"#ff4d4f"}}),s.jsx(gp,{type:g.overdue>0?"danger":"secondary",children:g.overdue})]}),s.jsxs(gp,{type:O>=90?"success":O>=70?"warning":"danger",children:["KPI ",O,"%"]})]}),s.jsx(Kr,{title:`Новые уведомления: ${g.newCount}`,children:s.jsx(Bf,{count:g.newCount,size:"small",children:s.jsx(V1,{style:{fontSize:18,color:"#52c41a"}})})}),s.jsx(yb,{menu:{items:E,onClick:k},placement:"bottomRight",children:s.jsxs(Te,{children:[s.jsx(nm,{icon:s.jsx(ti,{}),style:{cursor:"pointer",backgroundColor:"#1890ff"}}),s.jsx(gp,{children:"Администратор"})]})})]}),s.jsx(cr,{title:"Профиль сотрудника",open:x,onCancel:()=>y(!1),onOk:()=>y(!1),okText:"Закрыть",cancelButtonProps:{style:{display:"none"}},children:s.jsxs(ye,{column:1,size:"small",bordered:!0,children:[s.jsx(ye.Item,{label:"ФИО",children:"Администратор"}),s.jsx(ye.Item,{label:"Роль",children:"Администратор системы"}),s.jsxs(ye.Item,{label:"Задачи сейчас",children:[g.total," активных · ",g.overdue," просроченных"]}),s.jsx(ye.Item,{label:"Ближайший дедлайн",children:g.nearestDeadline||"—"}),s.jsx(ye.Item,{label:"Выполнено задач (всего)",children:g.completed}),s.jsxs(ye.Item,{label:"KPI по задачам (completion)",children:[B,"%"]}),s.jsxs(ye.Item,{label:"SLA по срокам",children:[b,"%"]}),s.jsxs(ye.Item,{label:"% выполнения MBO (оценка)",children:[O,"%"]}),s.jsx(ye.Item,{label:"Рейтинг сотрудника",children:"Топ-10% по нагрузке (оценочно)"})]})})]})},bM=()=>{const e=M.useContext(jC);if(!e)throw new Error("useDemoData must be used within DemoDataProvider");return e},{Content:_M}=_f,CM=()=>{const e=dc(),t=Vi(U=>U.app.sidebarCollapsed),r=Vi(U=>{var I;return((I=U.extendedCards)==null?void 0:I.filteredItems)||[]}),{loadDemoData:a,clearDemoData:n}=bM(),[i,o]=M.useState(""),[l,c]=M.useState("name"),[A,d]=M.useState(!0),[f,p]=M.useState(window.innerWidth<768);M.useEffect(()=>{const U=()=>{p(window.innerWidth<768)};return window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]);const h=(e.pathname||e.hash.replace("#","")).split("/").filter(Boolean)[0]||"registry",x=()=>{switch(h){case"registry":return"Реестр объектов";case"portfolio":return"Залоговый портфель";case"tasks":return"Задачи";case"kpi":return"KPI и аналитика";case"reports":return"Отчеты";case"collateral-dossier":return"Залоговое досье";case"collateral-conclusions":return"Залоговые заключения";case"insurance":return"Страхование";case"fnp":return"ФНП";case"analytics":return"Аналитика";case"credit-risk":return"Модуль мониторинга";case"appraisal":return"Модуль оценки";case"cms-check":return"CMS Check";case"egrn":return"ЕГРН";case"upload":return"Загрузка и миграция";case"monitoring":return"Мониторинг";case"reference":return"Справочная с ИИ";case"workflow":return"Внесудебная реализация (Workflow)";case"settings":return"Настройки";default:return"Система управления залоговым имуществом"}},y=()=>{},v=()=>{},E=()=>{},k=()=>{d(!A)},S=h==="registry",B=h==="projects-portfolio",b=A&&!B,O=!B,_=B||f?0:t?80:250;return s.jsxs(_f,{className:"main-layout",children:[O&&s.jsx(yM,{collapsed:t,isMobile:f,onLoadDemoData:a,onClearDemoData:n,hasCards:r.length>0}),s.jsxs(_f,{style:{marginLeft:_,transition:"margin-left 0.2s"},children:[b&&s.jsx(EM,{onCreateCard:y,onExport:v,onImport:E,onSearch:o,onSearchAttributeChange:c,onToggleHeader:k,searchText:i,searchAttribute:l,headerVisible:A,contextTitle:x(),isRegistry:S,isMobile:f}),s.jsxs(_M,{className:"main-content",style:{marginTop:b?64:0},children:[!b&&!B&&s.jsx("div",{style:{position:"fixed",top:16,left:t?96:266,zIndex:1001,transition:"left 0.2s"},children:s.jsx(Be,{type:"primary",icon:s.jsx(xb,{}),onClick:k,style:{boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"50%",width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center"},title:"Показать шапку"})}),s.jsx(bT,{})]})]})]})},Ry={"Коммерческая недвижимость":{АЗС:["Здание","Помещение","Сооружение"],Автосалоны:["Здание","Помещение"],Апартаменты:["Помещение"],Гаражи:["Здание","Помещение"],Гостиницы:["Здание","Помещение"],"Кафе/рестораны":["Здание","Помещение"],"Медицинские центры":["Здание","Помещение"],"Офисные здания":["Здание"],"Офисные помещения":["Помещение"],"Производственные помещения":["Помещение"],Склады:["Здание","Помещение","Сооружение"],"Торговые центры":["Здание"],"Торговые помещения":["Помещение"],"Торгово-развлекательные центры":["Здание"],"Здания свободного назначения":["Здание"],"Помещения свободного назначения":["Помещение"]},"Жилая недвижимость":{Квартира:["Помещение"],Комната:["Помещение"],"Жилой дом":["Здание"],Таунхаус:["Здание"],Дача:["Здание"],"Земельный участок":["Земельный участок"]},"Промышленная недвижимость":{"Производственные здания":["Здание"],"Производственные сооружения":["Сооружение"],Цеха:["Здание","Помещение"],Ангары:["Здание","Сооружение"],Элеваторы:["Сооружение"],Резервуары:["Сооружение"]}},BM={Квартира_Помещение:"apartment",Комната_Помещение:"room","Жилой дом_Здание":"house",Таунхаус_Здание:"townhouse",Дача_Здание:"house","Земельный участок_Земельный участок":"land_residential","Офисные помещения_Помещение":"office","Офисные здания_Здание":"office","Торговые помещения_Помещение":"retail","Торговые центры_Здание":"retail",Склады_Здание:"warehouse",Склады_Помещение:"warehouse",Склады_Сооружение:"warehouse",Гостиницы_Здание:"hotel",Гостиницы_Помещение:"hotel","Кафе/рестораны_Здание":"catering","Кафе/рестораны_Помещение":"catering",АЗС_Здание:"gas_station",АЗС_Помещение:"gas_station",АЗС_Сооружение:"gas_station",Автосалоны_Здание:"car_dealership",Автосалоны_Помещение:"car_dealership","Производственные здания_Здание":"industrial_building","Производственные сооружения_Сооружение":"industrial_building",Цеха_Здание:"workshop",Цеха_Помещение:"workshop"},ky={Квартира_Помещение:2010,Комната_Помещение:2030,"Жилой дом_Здание":2020,Таунхаус_Здание:2040,Дача_Здание:2050,"Земельный участок_Земельный участок":2060,"Офисные помещения_Помещение":1010,"Офисные здания_Здание":1011,"Торговые помещения_Помещение":1020,"Торговые центры_Здание":1021,Склады_Здание:1031,Склады_Помещение:1030,Склады_Сооружение:1032,Гостиницы_Здание:1040,Гостиницы_Помещение:1041,"Кафе/рестораны_Здание":1051,"Кафе/рестораны_Помещение":1050,АЗС_Здание:1060,АЗС_Помещение:1061,АЗС_Сооружение:1062,Автосалоны_Здание:1070,Автосалоны_Помещение:1071,Апартаменты_Помещение:1080,Гаражи_Здание:1090,Гаражи_Помещение:1091,"Медицинские центры_Здание":1100,"Медицинские центры_Помещение":1101,"Здания свободного назначения_Здание":1110,"Помещения свободного назначения_Помещение":1111,"Производственные помещения_Помещение":1120,"Торгово-развлекательные центры_Здание":1130,"Производственные здания_Здание":3010,"Производственные сооружения_Сооружение":3011,Цеха_Здание:3021,Цеха_Помещение:3020,Ангары_Здание:3030,Ангары_Сооружение:3031,Элеваторы_Сооружение:3040,Резервуары_Сооружение:3050},SM=Object.entries(Ry).map(([e,t])=>({value:e,label:e,children:Object.entries(t).map(([r,a])=>({value:r,label:r,children:a.map(n=>{const i=`${r}_${n}`,o=ky[i]||0;return{value:n,label:n,cbCode:o}})}))})),LC=(e,t,r)=>{const a=`${t}_${r}`;return ky[a]||0},cw=(e,t)=>{const r=`${e}_${t}`;return BM[r]||null},TM=e=>{const t=Ry[e];return t?Object.keys(t).map(r=>({value:r,label:r})):[]},OM=(e,t)=>{const r=Ry[e];if(!r)return[];const a=r[t];return a?a.map(n=>{const i=`${t}_${n}`,o=ky[i]||0;return{value:n,label:n,cbCode:o}}):[]},IM=(e,t,r)=>LC(e,t,r)!==0,NM=({value:e,onChange:t,disabled:r=!1})=>{const[a,n]=M.useState((e==null?void 0:e.level0)||""),[i,o]=M.useState((e==null?void 0:e.level1)||""),[l,c]=M.useState((e==null?void 0:e.level2)||""),[A,d]=M.useState(0),[f,p]=M.useState(!0);M.useEffect(()=>{e&&(n(e.level0||""),o(e.level1||""),c(e.level2||""))},[e]),M.useEffect(()=>{if(a&&i&&l){const v=LC(a,i,l),E=IM(a,i,l);d(v),p(E),E&&t&&t({level0:a,level1:i,level2:l},v)}else d(0),p(!0)},[a,i,l,t]);const u=v=>{n(v),o(""),c(""),d(0)},g=v=>{o(v),c(""),d(0)},h=v=>{c(v)},x=a?TM(a):[],y=a&&i?OM(a,i):[];return s.jsxs(Te,{direction:"vertical",style:{width:"100%"},children:[s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"middle",children:[s.jsxs("div",{style:{width:"100%"},children:[s.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Категория (Уровень 0)"}),s.jsx(Ve,{placeholder:"Выберите категорию",value:a||void 0,onChange:u,disabled:r,style:{width:"100%"},options:SM.map(v=>({value:v.value,label:v.label}))})]}),s.jsxs("div",{style:{width:"100%"},children:[s.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Вид объекта (Уровень 1)"}),s.jsx(Ve,{placeholder:"Выберите вид объекта",value:i||void 0,onChange:g,disabled:r||!a,style:{width:"100%"},options:x.map(v=>({value:v.value,label:v.label}))})]}),s.jsxs("div",{style:{width:"100%"},children:[s.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Тип (Уровень 2)"}),s.jsx(Ve,{placeholder:"Выберите тип",value:l||void 0,onChange:h,disabled:r||!i,style:{width:"100%"},options:y.map(v=>({value:v.value,label:v.label}))})]})]}),a&&i&&l&&s.jsx(s.Fragment,{children:f?s.jsx(Nr,{message:`Код ЦБ: ${A}`,type:"success",showIcon:!0}):s.jsx(Nr,{message:"Некорректная комбинация классификации",type:"error",showIcon:!0})})]})},zi=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,FM=e=>(typeof e=="string"?new Date(e):e).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),RM=({value:e=[],onChange:t,disabled:r=!1})=>{const[a,n]=M.useState(e),[i,o]=M.useState(!1),[l,c]=M.useState(null),[A]=re.useForm(),d=[{value:"individual",label:"Физическое лицо"},{value:"legal",label:"Юридическое лицо"}],f=[{value:"owner",label:"Собственник"},{value:"pledgor",label:"Залогодатель"},{value:"appraiser",label:"Оценщик"},{value:"other",label:"Другое"}],p=()=>{A.resetFields(),c(null),o(!0)},u=E=>{c(E),A.setFieldsValue(E),o(!0)},g=E=>{const k=a.filter(S=>S.id!==E);n(k),t==null||t(k)},h=async()=>{try{const E=await A.validateFields(),k=new Date,S={id:(l==null?void 0:l.id)||zi(),type:E.type,role:E.role,lastName:E.lastName,firstName:E.firstName,middleName:E.middleName,organizationName:E.organizationName,inn:E.inn,share:E.share,showInRegistry:E.showInRegistry!==void 0?E.showInRegistry:!0,createdAt:(l==null?void 0:l.createdAt)||k,updatedAt:k};let B;l?B=a.map(b=>b.id===l.id?S:b):B=[...a,S],n(B),t==null||t(B),o(!1),A.resetFields()}catch(E){console.error("Validation failed:",E)}},x=E=>E.type==="individual"?[E.lastName,E.firstName,E.middleName].filter(Boolean).join(" "):E.organizationName||"",y=E=>{const k={owner:"blue",pledgor:"green",appraiser:"orange",other:"default"},S={owner:"Собственник",pledgor:"Залогодатель",appraiser:"Оценщик",other:"Другое"};return s.jsx(Ze,{color:k[E],children:S[E]})},v=[{title:"Тип",dataIndex:"type",key:"type",width:80,render:E=>E==="individual"?s.jsx(ti,{style:{fontSize:18}}):s.jsx(hb,{style:{fontSize:18}})},{title:"Наименование/ФИО",key:"name",render:(E,k)=>x(k)},{title:"ИНН",dataIndex:"inn",key:"inn",width:150},{title:"Роль",dataIndex:"role",key:"role",width:150,render:E=>y(E)},{title:"Доля (%)",dataIndex:"share",key:"share",width:100,render:E=>E!==void 0?`${E}%`:"-"},{title:"В реестре",dataIndex:"showInRegistry",key:"showInRegistry",width:100,render:E=>E?"Да":"Нет"},{title:"Действия",key:"actions",width:120,fixed:"right",render:(E,k)=>s.jsxs(Te,{size:"small",children:[s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),onClick:()=>u(k),disabled:r,children:"Изменить"}),s.jsx(po,{title:"Удалить партнера?",onConfirm:()=>g(k.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),disabled:r,children:"Удалить"})})]})}];return s.jsxs("div",{children:[s.jsx(Te,{style:{marginBottom:16},children:s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:p,disabled:r,children:"Добавить партнера"})}),s.jsx(ir,{columns:v,dataSource:a,rowKey:"id",pagination:!1,size:"small"}),s.jsx(cr,{title:l?"Редактирование партнера":"Добавление партнера",open:i,onOk:h,onCancel:()=>{o(!1),A.resetFields()},width:700,okText:"Сохранить",cancelText:"Отмена",children:s.jsxs(re,{form:A,layout:"vertical",initialValues:{showInRegistry:!0,type:"individual"},children:[s.jsx(re.Item,{name:"type",label:"Тип партнера",rules:[{required:!0,message:"Выберите тип"}],children:s.jsx(Ve,{options:d})}),s.jsx(re.Item,{noStyle:!0,shouldUpdate:(E,k)=>E.type!==k.type,children:({getFieldValue:E})=>E("type")==="individual"?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"lastName",label:"Фамилия",rules:[{required:!0,message:"Введите фамилию"}],children:s.jsx(Re,{placeholder:"Иванов"})}),s.jsx(re.Item,{name:"firstName",label:"Имя",rules:[{required:!0,message:"Введите имя"}],children:s.jsx(Re,{placeholder:"Иван"})}),s.jsx(re.Item,{name:"middleName",label:"Отчество",children:s.jsx(Re,{placeholder:"Иванович"})})]}):s.jsx(re.Item,{name:"organizationName",label:"Наименование организации",rules:[{required:!0,message:"Введите наименование"}],children:s.jsx(Re,{placeholder:"ООО Рога и Копыта"})})}),s.jsx(re.Item,{name:"inn",label:"ИНН",children:s.jsx(Re,{placeholder:"1234567890",maxLength:12})}),s.jsx(re.Item,{name:"role",label:"Роль",rules:[{required:!0,message:"Выберите роль"}],children:s.jsx(Ve,{options:f})}),s.jsx(re.Item,{name:"share",label:"Доля права (%)",children:s.jsx(pa,{min:0,max:100,step:.01,style:{width:"100%"}})}),s.jsx(re.Item,{name:"showInRegistry",label:"Показывать в реестре",valuePropName:"checked",children:s.jsx(ms,{})})]})})]})};class kM{constructor(){tr(this,"API_KEY","8369d552d89563916982831fbb6ddb90b7d38fe2");tr(this,"BASE_URL","https://suggestions.dadata.ru/suggestions/api/4_1/rs");tr(this,"requestCount",0);tr(this,"DAILY_LIMIT",1e4);tr(this,"lastResetDate",new Date().toDateString())}checkAndResetLimit(){const t=new Date().toDateString();t!==this.lastResetDate&&(this.requestCount=0,this.lastResetDate=t)}incrementRequestCount(){return this.checkAndResetLimit(),this.requestCount>=this.DAILY_LIMIT?(console.warn("DaData API daily limit reached"),!1):(this.requestCount++,!0)}getRemainingRequests(){return this.checkAndResetLimit(),this.DAILY_LIMIT-this.requestCount}async suggestAddress(t,r=10){if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");if(!t||t.length<3)return[];try{const a={query:t,count:r,from_bound:{value:"region"},to_bound:{value:"flat"}},n=await fetch(`${this.BASE_URL}/suggest/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify(a)});if(!n.ok)throw new Error(`DaData API error: ${n.status} ${n.statusText}`);return(await n.json()).suggestions||[]}catch(a){throw console.error("Error fetching address suggestions from DaData:",a),a}}async geolocateAddress(t,r,a=100){if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");try{const n={lat:t,lon:r,radius_meters:a,count:5},i=await fetch(`${this.BASE_URL}/geolocate/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify(n)});if(!i.ok)throw new Error(`DaData geolocate error: ${i.status}`);return(await i.json()).suggestions||[]}catch(n){throw console.error("Error geolocating address:",n),n}}async findByFiasId(t){var r;if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");try{const a=await fetch(`${this.BASE_URL}/findById/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify({query:t,count:1})});if(!a.ok)throw new Error(`DaData findById error: ${a.status}`);return((r=(await a.json()).suggestions)==null?void 0:r[0])||null}catch(a){throw console.error("Error finding address by FIAS ID:",a),a}}async standardizeAddress(t){return(await this.suggestAddress(t,1))[0]||null}async validateAddress(t){try{const r=await this.standardizeAddress(t);if(!r)return{isValid:!1,qc:3,suggestion:null};const a=parseInt(r.data.qc||"3",10);return{isValid:a<=1,qc:a,suggestion:r}}catch{return{isValid:!1,qc:3,suggestion:null}}}}const Vu=new kM,Ux=(e,t)=>({id:t||`addr-${Date.now()}`,region:e.data.region_with_type||void 0,district:e.data.area||void 0,city:e.data.city||void 0,settlement:e.data.settlement||void 0,street:e.data.street||void 0,house:e.data.house||void 0,building:e.data.block||void 0,apartment:e.data.flat||void 0,postalCode:e.data.postal_code||void 0,fullAddress:e.value,cadastralNumber:void 0,fias:e.data.fias_id,countryIsoCode:e.data.country_iso_code,regionFiasId:e.data.region_fias_id,regionKladrId:e.data.region_kladr_id,regionIsoCode:e.data.region_iso_code,regionType:e.data.region_type,cityFiasId:e.data.city_fias_id||void 0,cityType:e.data.city_type||void 0,cityDistrict:e.data.city_district||void 0,streetFiasId:e.data.street_fias_id||void 0,streetType:e.data.street_type||void 0,houseFiasId:e.data.house_fias_id||void 0,houseType:e.data.house_type||void 0,flatArea:e.data.flat_area?parseFloat(e.data.flat_area):void 0,squareMeterPrice:e.data.square_meter_price?parseFloat(e.data.square_meter_price):void 0,flatPrice:e.data.flat_price?parseFloat(e.data.flat_price):void 0,geoLat:e.data.geo_lat?parseFloat(e.data.geo_lat):void 0,geoLon:e.data.geo_lon?parseFloat(e.data.geo_lon):void 0,timezone:e.data.timezone||void 0,okato:e.data.okato,oktmo:e.data.oktmo,taxOffice:e.data.tax_office,taxOfficeLegal:e.data.tax_office_legal,metro:e.data.metro||void 0,qc:e.data.qc||void 0,qcGeo:e.data.qc_geo||void 0,qcComplete:e.data.qc_complete||void 0,qcHouse:e.data.qc_house||void 0,source:"dadata"}),Aw=(e,t)=>{let r=null;return function(...n){const i=()=>{r=null,e(...n)};r&&clearTimeout(r),r=setTimeout(i,t)}},DM=({value:e,onChange:t,disabled:r=!1,placeholder:a="Начните вводить адрес (мин. 3 символа)...",showDetails:n=!0})=>{const[i,o]=M.useState((e==null?void 0:e.fullAddress)||""),[l,c]=M.useState([]),[A,d]=M.useState(!1),[f,p]=M.useState(null),[u,g]=M.useState(e),[h,x]=M.useState(0),y=M.useRef(Aw(async b=>{if(b.length<3){c([]);return}d(!0),p(null);try{const O=await Vu.suggestAddress(b,10);c(O),x(Vu.getRemainingRequests())}catch(O){p("Ошибка при получении подсказок адреса. Проверьте подключение к интернету."),console.error("DaData suggestion error:",O),c([])}finally{d(!1)}},500));M.useEffect(()=>{y.current=Aw(async b=>{if(b.length<3){c([]);return}d(!0),p(null);try{const O=await Vu.suggestAddress(b,10);c(O),x(Vu.getRemainingRequests())}catch(O){p("Ошибка при получении подсказок адреса. Проверьте подключение к интернету."),console.error("DaData suggestion error:",O),c([])}finally{d(!1)}},500)},[]);const v=b=>{o(b),b.length>=3?y.current(b):c([])},E=b=>{const O=l.find(_=>_.value===b);if(O){const _=Ux(O,e==null?void 0:e.id);g(_),o(b),c([]),t&&t(_)}},k=b=>{switch(b){case"0":return"green";case"1":return"orange";case"2":return"red";case"3":return"red";default:return"default"}},S=b=>{switch(b){case"0":return"Адрес проверен";case"1":return"Требует уточнения";case"2":return"Плохое качество";case"3":return"Не распознан";default:return"Неизвестно"}},B=l.map(b=>({value:b.value,label:s.jsxs("div",{style:{padding:"4px 0"},children:[s.jsx("div",{children:b.value}),s.jsxs(Te,{size:"small",style:{marginTop:4},children:[b.data.postal_code&&s.jsx(Ze,{color:"blue",style:{fontSize:11},children:b.data.postal_code}),b.data.qc&&s.jsx(Ze,{color:k(b.data.qc),style:{fontSize:11},children:S(b.data.qc)})]})]})}));return s.jsxs("div",{className:"dadata-address-input",children:[s.jsx(qT,{value:i,options:B,onSelect:E,onSearch:v,disabled:r,notFoundContent:A?s.jsx(es,{size:"small",tip:"Поиск адресов..."}):"Введите минимум 3 символа",style:{width:"100%"},dropdownStyle:{minWidth:400},children:s.jsx(Re,{prefix:s.jsx(Pa,{}),suffix:A&&s.jsx(es,{size:"small"}),placeholder:a,allowClear:!0})}),f&&s.jsx(Nr,{message:f,type:"error",showIcon:!0,closable:!0,onClose:()=>p(null),style:{marginTop:8}}),u&&n&&s.jsxs(Ue,{size:"small",style:{marginTop:12},title:"Детали адреса",children:[s.jsx(dt,{gutter:[8,8],children:s.jsx(be,{span:24,children:s.jsxs(Te,{size:"small",wrap:!0,children:[u.qc&&s.jsx(Ze,{color:k(u.qc),icon:u.qc==="0"?s.jsx(yn,{}):s.jsx(hh,{}),children:S(u.qc)}),u.postalCode&&s.jsxs(Ze,{color:"blue",children:["Индекс: ",u.postalCode]}),u.fias&&s.jsxs(Ze,{color:"green",children:["ФИАС: ",u.fias.substring(0,8),"..."]}),u.geoLat&&u.geoLon&&s.jsxs(Ze,{color:"orange",icon:s.jsx(tl,{}),children:[u.geoLat.toFixed(4),", ",u.geoLon.toFixed(4)]})]})})}),s.jsxs(dt,{gutter:[12,8],style:{marginTop:12},children:[s.jsxs(be,{span:12,children:[s.jsx("div",{style:{fontSize:12,color:"#666"},children:"Регион:"}),s.jsx("div",{style:{fontWeight:500},children:u.region||"-"})]}),s.jsxs(be,{span:12,children:[s.jsx("div",{style:{fontSize:12,color:"#666"},children:"Город:"}),s.jsx("div",{style:{fontWeight:500},children:u.city||u.settlement||"-"})]}),s.jsxs(be,{span:12,children:[s.jsx("div",{style:{fontSize:12,color:"#666"},children:"Улица:"}),s.jsx("div",{style:{fontWeight:500},children:u.street||"-"})]}),s.jsxs(be,{span:12,children:[s.jsx("div",{style:{fontSize:12,color:"#666"},children:"Дом/Квартира:"}),s.jsx("div",{style:{fontWeight:500},children:[u.house,u.building,u.apartment].filter(Boolean).join(", ")||"-"})]})]}),u.metro&&u.metro.length>0&&s.jsxs("div",{style:{marginTop:12},children:[s.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Ближайшее метро:"}),s.jsx(Te,{size:"small",wrap:!0,children:u.metro.map((b,O)=>s.jsxs(Ze,{color:"purple",children:[b.name," (",b.distance,"м)"]},O))})]}),s.jsxs("div",{style:{marginTop:12,fontSize:11,color:"#999"},children:["Осталось запросов сегодня: ",h," / 10000"]})]})]})};class jM{async getCurrentPosition(){return new Promise(t=>{if(!("geolocation"in navigator)){console.warn("Geolocation is not supported by this browser"),t(null);return}navigator.geolocation.getCurrentPosition(r=>{t({coordinates:{lat:r.coords.latitude,lon:r.coords.longitude},accuracy:r.coords.accuracy,timestamp:r.timestamp})},r=>{console.error("Error getting current position:",r);let a="Не удалось определить местоположение";switch(r.code){case r.PERMISSION_DENIED:a="Доступ к геолокации запрещен. Разрешите доступ в настройках браузера.";break;case r.POSITION_UNAVAILABLE:a="Информация о местоположении недоступна.";break;case r.TIMEOUT:a="Время ожидания определения местоположения истекло.";break}console.warn(a),t(null)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})}async getAddressFromCoordinates(t){try{return await Vu.geolocateAddress(t.lat,t.lon)}catch(r){return console.error("Error getting address from coordinates:",r),[]}}async getCurrentLocationWithAddress(){const t=await this.getCurrentPosition();if(!t)return null;const r=await this.getAddressFromCoordinates(t.coordinates);return{coordinates:t.coordinates,addresses:r}}calculateDistance(t,r){const n=this.deg2rad(r.lat-t.lat),i=this.deg2rad(r.lon-t.lon),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this.deg2rad(t.lat))*Math.cos(this.deg2rad(r.lat))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}deg2rad(t){return t*(Math.PI/180)}formatDistance(t){return t<1?`${Math.round(t*1e3)} м`:`${t.toFixed(1)} км`}isGeolocationSupported(){return"geolocation"in navigator}async checkPermission(){if(!("permissions"in navigator))return null;try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(t){return console.error("Error checking geolocation permission:",t),null}}}const dw=new jM,LM=({onAddressSelect:e,initialCoordinates:t})=>{const[r,a]=M.useState(t||null),[n,i]=M.useState([]),[o,l]=M.useState(!1),[c,A]=M.useState(null),[d,f]=M.useState(null),p=async()=>{l(!0),A(null),i([]);try{const h=await dw.getCurrentLocationWithAddress();if(h){if(a(h.coordinates),i(h.addresses),f(h.coordinates?50:null),h.addresses.length>0){const x=Ux(h.addresses[0]);e==null||e(x)}}else A("Не удалось определить местоположение. Проверьте разрешения браузера.")}catch(h){A(h.message||"Ошибка при определении местоположения"),console.error("Geolocation error:",h)}finally{l(!1)}},u=h=>{const x=Ux(h);e==null||e(x)};return dw.isGeolocationSupported()?s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(tl,{}),s.jsx("span",{children:"Определение местоположения"})]}),extra:s.jsx(Be,{type:"primary",icon:s.jsx(KT,{}),onClick:p,loading:o,disabled:o,children:o?"Определение...":"Определить местоположение"}),children:[c&&s.jsx(Nr,{message:c,type:"error",showIcon:!0,closable:!0,onClose:()=>A(null),style:{marginBottom:16}}),o&&s.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:s.jsx(es,{size:"large",tip:"Определение вашего местоположения..."})}),!o&&r&&s.jsx("div",{children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsx(Ue,{size:"small",type:"inner",title:"Ваши координаты",children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsxs(Ze,{color:"blue",children:["Широта: ",r.lat.toFixed(6)]}),s.jsxs(Ze,{color:"green",children:["Долгота: ",r.lon.toFixed(6)]}),d&&s.jsxs(Ze,{color:"orange",children:["Точность: ~",d,"м"]})]}),s.jsx("a",{href:`https://yandex.ru/maps/?ll=${r.lon},${r.lat}&z=16`,target:"_blank",rel:"noopener noreferrer",children:"Открыть на Я.Картах"})]})}),n.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{style:{margin:"8px 0"},children:"Найденные адреса"}),s.jsx("div",{children:n.map((h,x)=>s.jsx(Ue,{size:"small",hoverable:!0,style:{marginBottom:8,cursor:"pointer"},onClick:()=>u(h),children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:h.value}),h.data.postal_code&&s.jsx(Ze,{color:"blue",style:{marginTop:4,fontSize:11},children:h.data.postal_code})]}),s.jsx(yn,{style:{fontSize:20,color:"#52c41a"}})]})},x))})]}),n.length===0&&r&&!o&&s.jsx(Nr,{message:"Адреса не найдены",description:"Не удалось найти адреса рядом с вашим местоположением. Попробуйте ввести адрес вручную.",type:"info",showIcon:!0})]})}),!o&&!r&&!c&&s.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:[s.jsx(tl,{style:{fontSize:64,color:"#d9d9d9"}}),s.jsx("div",{style:{marginTop:16},children:'Нажмите кнопку "Определить местоположение" для автоматического поиска адреса'}),s.jsx("div",{style:{marginTop:8,fontSize:12},children:"Браузер запросит разрешение на доступ к вашему местоположению"})]}),s.jsx(Nr,{message:"Примечание",description:"Для работы геолокации необходимо разрешение браузера на доступ к местоположению. Функция работает лучше всего на мобильных устройствах.",type:"info",showIcon:!0,style:{marginTop:16}})]}):s.jsx(Nr,{message:"Геолокация не поддерживается",description:"Ваш браузер не поддерживает определение местоположения. Используйте ввод адреса вручную.",type:"warning",showIcon:!0})},UM=({value:e,onChange:t,disabled:r=!1,useDaData:a=!1,showGeoPicker:n=!1})=>{const[i,o]=M.useState({id:(e==null?void 0:e.id)||"",region:(e==null?void 0:e.region)||"",district:(e==null?void 0:e.district)||"",city:(e==null?void 0:e.city)||"",settlement:(e==null?void 0:e.settlement)||"",street:(e==null?void 0:e.street)||"",house:(e==null?void 0:e.house)||"",building:(e==null?void 0:e.building)||"",apartment:(e==null?void 0:e.apartment)||"",postalCode:(e==null?void 0:e.postalCode)||"",fullAddress:(e==null?void 0:e.fullAddress)||"",cadastralNumber:(e==null?void 0:e.cadastralNumber)||"",fias:(e==null?void 0:e.fias)||""});M.useEffect(()=>{e&&o(e)},[e]),M.useEffect(()=>{const d=[i.region,i.district,i.city,i.settlement,i.street,i.house&&`д. ${i.house}`,i.building&&`к. ${i.building}`,i.apartment&&`кв. ${i.apartment}`].filter(Boolean).join(", ");if(d!==i.fullAddress){const f={...i,fullAddress:d};o(f),t==null||t(f)}},[i.region,i.district,i.city,i.settlement,i.street,i.house,i.building,i.apartment]);const l=(A,d)=>{const f={...i,[A]:d};o(f),t==null||t(f)},c=A=>{const d={id:A.id||i.id||"",region:A.region,district:A.district,city:A.city,settlement:A.settlement,street:A.street,house:A.house,building:A.building,apartment:A.apartment,postalCode:A.postalCode,fullAddress:A.fullAddress,cadastralNumber:A.cadastralNumber,fias:A.fias};o(d),t==null||t(d)};return s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a&&s.jsxs(s.Fragment,{children:[s.jsx(DM,{value:e,onChange:c,disabled:r,showDetails:!0}),s.jsx(jt,{style:{margin:"12px 0"},children:"или введите вручную"})]}),n&&s.jsxs(s.Fragment,{children:[s.jsx(LM,{onAddressSelect:c,initialCoordinates:(e!=null&&e.fias,void 0)}),s.jsx(jt,{style:{margin:"12px 0"},children:"Детали адреса"})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Регион",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"Московская область",value:i.region,onChange:A=>l("region",A.target.value),disabled:r,prefix:s.jsx(tl,{})})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Район",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"Одинцовский район",value:i.district,onChange:A=>l("district",A.target.value),disabled:r})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Город",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"Москва",value:i.city,onChange:A=>l("city",A.target.value),disabled:r})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Населенный пункт",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"пос. Лесной",value:i.settlement,onChange:A=>l("settlement",A.target.value),disabled:r})})})]}),s.jsx(dt,{gutter:16,children:s.jsx(be,{span:24,children:s.jsx(re.Item,{label:"Улица",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"ул. Ленина",value:i.street,onChange:A=>l("street",A.target.value),disabled:r})})})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{label:"Дом",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"15",value:i.house,onChange:A=>l("house",A.target.value),disabled:r})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{label:"Корпус/Строение",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"1",value:i.building,onChange:A=>l("building",A.target.value),disabled:r})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{label:"Квартира/Офис",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"10",value:i.apartment,onChange:A=>l("apartment",A.target.value),disabled:r})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Почтовый индекс",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"123456",value:i.postalCode,onChange:A=>l("postalCode",A.target.value),disabled:r,maxLength:6})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Кадастровый номер",style:{marginBottom:8},children:s.jsx(Re,{placeholder:"77:01:0001001:1234",value:i.cadastralNumber,onChange:A=>l("cadastralNumber",A.target.value),disabled:r})})})]}),s.jsx(dt,{gutter:16,children:s.jsx(be,{span:24,children:s.jsx(re.Item,{label:"Полный адрес (автозаполнение)",style:{marginBottom:8},children:s.jsx(Re.TextArea,{value:i.fullAddress,onChange:A=>l("fullAddress",A.target.value),disabled:r,rows:2,placeholder:"Будет сформирован автоматически"})})})})]})},MM=({value:e=[],onChange:t,disabled:r=!1})=>{const[a,n]=M.useState(e),[i,o]=M.useState(!1),[l,c]=M.useState(!1),[A,d]=M.useState(null),[f]=re.useForm(),[p,u]=M.useState([]),g=["Правоустанавливающие документы","Технические документы","Отчеты об оценке","Фотографии","Договоры","Прочее"],h=()=>{o(!0),f.resetFields(),u([])},x=async()=>{try{const O=await f.validateFields();if(p.length===0){Ne.error("Выберите файл для загрузки");return}const _=[];for(const I of p){const R=new FileReader,L=await new Promise((P,Q)=>{R.onload=()=>P(R.result),R.onerror=Q,R.readAsDataURL(I.originFileObj)}),N={id:zi(),name:I.name,type:O.type||"Прочее",size:I.size,mimeType:I.type,uploadDate:new Date,category:O.category,description:O.description,fileData:L};_.push(N)}const U=[...a,..._];n(U),t==null||t(U),o(!1),Ne.success(`Загружено документов: ${_.length}`)}catch(O){console.error("Upload failed:",O)}},y=O=>{const _=a.filter(U=>U.id!==O);n(_),t==null||t(_),Ne.success("Документ удален")},v=O=>{if(!O.fileData){Ne.error("Данные файла недоступны");return}const _=document.createElement("a");_.href=O.fileData,_.download=O.name,document.body.appendChild(_),_.click(),document.body.removeChild(_),Ne.success("Файл скачан")},E=O=>{d(O),c(!0)},k=O=>{if(O===0)return"0 Bytes";const _=1024,U=["Bytes","KB","MB","GB"],I=Math.floor(Math.log(O)/Math.log(_));return Math.round(O/Math.pow(_,I)*100)/100+" "+U[I]},S=O=>O.startsWith("image/")?s.jsx(kl,{style:{color:"#52c41a"}}):O.includes("pdf")?s.jsx(kl,{style:{color:"#f5222d"}}):O.includes("word")?s.jsx(kl,{style:{color:"#1890ff"}}):O.includes("excel")||O.includes("spreadsheet")?s.jsx(kl,{style:{color:"#52c41a"}}):s.jsx(kl,{}),B=[{title:"Тип",dataIndex:"mimeType",key:"mimeType",width:60,render:O=>S(O)},{title:"Название",dataIndex:"name",key:"name"},{title:"Категория",dataIndex:"category",key:"category",width:200,render:O=>s.jsx(Ze,{children:O})},{title:"Размер",dataIndex:"size",key:"size",width:100,render:O=>k(O)},{title:"Дата загрузки",dataIndex:"uploadDate",key:"uploadDate",width:180,render:O=>FM(O)},{title:"Действия",key:"actions",width:200,fixed:"right",render:(O,_)=>s.jsxs(Te,{size:"small",children:[s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>E(_),size:"small",children:"Просмотр"}),s.jsx(Be,{type:"link",icon:s.jsx(In,{}),onClick:()=>v(_),size:"small",children:"Скачать"}),s.jsx(po,{title:"Удалить документ?",onConfirm:()=>y(_.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),size:"small",disabled:r,children:"Удалить"})})]})}],b={multiple:!0,fileList:p,onChange:({fileList:O})=>{u(O)},beforeUpload:()=>!1,onRemove:O=>{const _=p.indexOf(O),U=p.slice();U.splice(_,1),u(U)}};return s.jsxs("div",{children:[s.jsxs(Te,{style:{marginBottom:16},children:[s.jsx(Be,{type:"primary",icon:s.jsx(Ns,{}),onClick:h,disabled:r,children:"Загрузить документы"}),a.length>0&&s.jsxs("span",{style:{color:"#999"},children:["Всего документов: ",a.length," (",k(a.reduce((O,_)=>O+_.size,0)),")"]})]}),s.jsx(ir,{columns:B,dataSource:a,rowKey:"id",pagination:!1,size:"small"}),s.jsx(cr,{title:"Загрузка документов",open:i,onOk:x,onCancel:()=>{o(!1),f.resetFields(),u([])},width:600,okText:"Загрузить",cancelText:"Отмена",children:s.jsxs(re,{form:f,layout:"vertical",children:[s.jsx(re.Item,{label:"Выберите файлы",children:s.jsxs(Js.Dragger,{...b,children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(Ns,{})}),s.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файлы в эту область"}),s.jsx("p",{className:"ant-upload-hint",children:"Поддерживается загрузка одного или нескольких файлов"})]})}),s.jsx(re.Item,{name:"category",label:"Категория документа",rules:[{required:!0,message:"Выберите категорию"}],children:s.jsx(Ve,{options:g.map(O=>({label:O,value:O})),placeholder:"Выберите категорию"})}),s.jsx(re.Item,{name:"type",label:"Тип документа",children:s.jsx(Re,{placeholder:"Например: Свидетельство о праве собственности"})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(Re.TextArea,{rows:3,placeholder:"Краткое описание документа"})})]})}),s.jsx(cr,{title:A==null?void 0:A.name,open:l,onCancel:()=>c(!1),footer:[s.jsx(Be,{icon:s.jsx(In,{}),onClick:()=>A&&v(A),children:"Скачать"},"download"),s.jsx(Be,{onClick:()=>c(!1),children:"Закрыть"},"close")],width:800,children:A&&A.fileData&&s.jsx("div",{style:{textAlign:"center"},children:A.mimeType.startsWith("image/")?s.jsx("img",{src:A.fileData,alt:A.name,style:{maxWidth:"100%",maxHeight:"600px"}}):A.mimeType==="application/pdf"?s.jsx("iframe",{src:A.fileData,style:{width:"100%",height:"600px",border:"none"},title:A.name}):s.jsxs("div",{style:{padding:"40px"},children:[s.jsx(kl,{style:{fontSize:64,color:"#999"}}),s.jsx("p",{style:{marginTop:16,color:"#999"},children:"Предпросмотр недоступен для данного типа файла"})]})})})]})},uw="cms_reference_data";class PM{async syncCollateralAttributesFromUnified(t=!1){var r,a;try{const n="cms_refdata_zalog_synced_at";if(!t&&localStorage.getItem(n))return!1;const i=((a=(r=import.meta)==null?void 0:r.env)==null?void 0:a.BASE_URL)??"/",o=new URL(i,window.location.origin),l=o.pathname.endsWith("/")?o.pathname:`${o.pathname}/`,c=`${o.origin}${l}Spravochniki/str/unified-attributes.json?v=${Date.now()}`,A=await fetch(c,{cache:"no-store"});if(!A.ok)return console.warn("Не удалось загрузить unified-attributes.json:",A.status,A.statusText),!1;const f=((await A.json()).attributes||[]).map((h,x)=>({id:h.id||`attr-${x}`,code:h.code||`code_${x}`,name:h.name||h.code||`Атрибут ${x+1}`,isActive:!0,sortOrder:x+1,metadata:{type:h.type||"string",group:h.code||"",section:h.level?`level_${h.level}`:"",sourceFiles:h.sourceFile||"",dependencyHints:h.dependencyHints||[],valuesCount:h.valuesCount||0}})),p=this.getDictionaries(),u=p.findIndex(h=>h.code==="collateral_attributes_zalog"),g=new Date().toISOString();return u>=0?p[u]={...p[u],name:"Атрибуты залога (обновлено из Spravochniki)",description:"Сформировано из Spravochniki/str/unified-attributes.json",items:f,updatedAt:g}:p.push({id:"dict-collateral-attributes-zalog",name:"Атрибуты залога (обновлено из Spravochniki)",code:"collateral_attributes_zalog",description:"Сформировано из Spravochniki/str/unified-attributes.json",items:f,createdAt:g,updatedAt:g}),this.saveDictionaries(p),localStorage.setItem(n,new Date().toISOString()),console.log(`Справочник collateral_attributes_zalog обновлен из unified-attributes.json. Элементов: ${f.length}`),!0}catch(n){return console.error("Ошибка синхронизации атрибутов залога из unified-attributes.json:",n),!1}}async syncAttributeLevelsFromPublic(t=!1){var r,a;try{const n="cms_refdata_attr_levels_synced_at";if(!t&&localStorage.getItem(n))return!1;const i=((a=(r=import.meta)==null?void 0:r.env)==null?void 0:a.BASE_URL)??"/",o=new URL(i,window.location.origin),l=o.pathname.endsWith("/")?o.pathname:`${o.pathname}/`,c=`${o.origin}${l}attribute-levels.json?v=${Date.now()}`,A=await fetch(c,{cache:"no-store"});if(!A.ok)return console.warn("Не удалось загрузить attribute-levels.json:",A.status,A.statusText),!1;const d=await A.json(),f=Array.isArray(d.items)?d.items:[],p=this.getDictionaries(),u=p.findIndex(h=>h.code==="attribute_levels"),g=new Date().toISOString();return u>=0?p[u]={...p[u],name:"Уровни атрибутов",description:"Иерархия уровней для атрибутов обеспечения",items:f,updatedAt:g}:p.push({id:"dict-attribute-levels",name:"Уровни атрибутов",code:"attribute_levels",description:"Иерархия уровней для атрибутов обеспечения",items:f,createdAt:g,updatedAt:g}),this.saveDictionaries(p),localStorage.setItem(n,new Date().toISOString()),console.log(`Справочник attribute_levels обновлен. Элементов: ${f.length}`),!0}catch(n){return console.error("Ошибка синхронизации уровней атрибутов:",n),!1}}getDictionaries(){try{const t=localStorage.getItem(uw);if(!t)return this.getDefaultDictionaries();const r=JSON.parse(t);if(!r.some(n=>n.code==="collateral_attributes_zalog")){const i=this.getDefaultDictionaries().find(o=>o.code==="collateral_attributes_zalog");i&&(r.push(i),this.saveDictionaries(r),console.log('Добавлен отсутствующий справочник "Атрибуты залога"'))}return r}catch(t){return console.error("Ошибка загрузки справочников:",t),this.getDefaultDictionaries()}}saveDictionaries(t){try{localStorage.setItem(uw,JSON.stringify(t))}catch(r){console.error("Ошибка сохранения справочников:",r)}}getDictionaryById(t){return this.getDictionaries().find(a=>a.id===t)}getDictionaryByCode(t){return this.getDictionaries().find(a=>a.code===t)}updateDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(i=>i.id===t);return n===-1?null:(a[n]={...a[n],...r,updatedAt:new Date().toISOString()},this.saveDictionaries(a),a[n])}addItemToDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(o=>o.id===t);if(n===-1)return null;const i={...r,id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};return a[n].items.push(i),a[n].updatedAt=new Date().toISOString(),this.saveDictionaries(a),i}updateItemInDictionary(t,r,a){const n=this.getDictionaries(),i=n.findIndex(l=>l.id===t);if(i===-1)return null;const o=n[i].items.findIndex(l=>l.id===r);return o===-1?null:(n[i].items[o]={...n[i].items[o],...a},n[i].updatedAt=new Date().toISOString(),this.saveDictionaries(n),n[i].items[o])}deleteItemFromDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(o=>o.id===t);if(n===-1)return!1;const i=a[n].items.length;return a[n].items=a[n].items.filter(o=>o.id!==r),a[n].items.length===i?!1:(a[n].updatedAt=new Date().toISOString(),this.saveDictionaries(a),!0)}getActiveItemsByCode(t){const r=this.getDictionaryByCode(t);return r?r.items.filter(a=>a.isActive).sort((a,n)=>(a.sortOrder||0)-(n.sortOrder||0)):[]}getDefaultDictionaries(){const t=new Date().toISOString(),r=[{id:"dict-regions",name:"Регионы",code:"regions",description:"Справочник регионов",items:[{id:"reg-1",name:"Москва",isActive:!0,sortOrder:1},{id:"reg-2",name:"Санкт-Петербург",isActive:!0,sortOrder:2},{id:"reg-3",name:"Новосибирск",isActive:!0,sortOrder:3},{id:"reg-4",name:"Екатеринбург",isActive:!0,sortOrder:4},{id:"reg-5",name:"Казань",isActive:!0,sortOrder:5},{id:"reg-6",name:"Нижний Новгород",isActive:!0,sortOrder:6}],createdAt:t,updatedAt:t},{id:"dict-segments",name:"Сегменты бизнеса",code:"segments",description:"Сегменты бизнеса для портфеля",items:[{id:"seg-1",code:"МБ",name:"МБ (Малый бизнес)",isActive:!0,sortOrder:1},{id:"seg-2",code:"СРБ",name:"СРБ (Средний бизнес)",isActive:!0,sortOrder:2},{id:"seg-3",code:"КБ",name:"КБ (Крупный бизнес)",isActive:!0,sortOrder:3},{id:"seg-4",name:"Корпоративный",isActive:!0,sortOrder:4},{id:"seg-5",name:"Розничный",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-groups",name:"Группы",code:"groups",description:"Группы портфеля",items:[{id:"grp-1",name:"Группа 1",isActive:!0,sortOrder:1},{id:"grp-2",name:"Группа 2",isActive:!0,sortOrder:2},{id:"grp-3",name:"Группа 3",isActive:!0,sortOrder:3}],createdAt:t,updatedAt:t},{id:"dict-liquidity",name:"Ликвидность",code:"liquidity",description:"Уровни ликвидности обеспечения",items:[{id:"liq-1",name:"высокая (срок реализации до 90 дней)",isActive:!0,sortOrder:1},{id:"liq-2",name:"удовлетворительная (срок реализации до 365 дней)",isActive:!0,sortOrder:2},{id:"liq-3",name:"низкая (срок реализации свыше 365 дней)",isActive:!0,sortOrder:3},{id:"liq-4",name:"малоудовлетворительная",isActive:!0,sortOrder:4}],createdAt:t,updatedAt:t},{id:"dict-collateral-categories",name:"Категории обеспечения",code:"collateral_categories",description:"Категории обеспечения из карточек сделок",items:[{id:"cat-1",name:"договор залога движимого имущества/оборудования",isActive:!0,sortOrder:1},{id:"cat-2",name:"договор залога недвижимого имущества",isActive:!0,sortOrder:2},{id:"cat-3",name:"договор ипотеки",isActive:!0,sortOrder:3},{id:"cat-4",name:"договор залога транспортных средств",isActive:!0,sortOrder:4},{id:"cat-5",name:"договор залога товаров в обороте",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-monitoring-types",name:"Типы мониторинга",code:"monitoring_types",description:"Типы мониторинга обеспечения",items:[{id:"mon-1",name:"Плановый",isActive:!0,sortOrder:1},{id:"mon-2",name:"Внеплановый",isActive:!0,sortOrder:2},{id:"mon-3",name:"Внеочередной",isActive:!0,sortOrder:3}],createdAt:t,updatedAt:t},{id:"dict-quality-categories",name:"Категории качества обеспечения",code:"quality_categories",description:"Категории качества обеспечения",items:[{id:"qual-1",name:"I категория",isActive:!0,sortOrder:1},{id:"qual-2",name:"II категория",isActive:!0,sortOrder:2},{id:"qual-3",name:"III категория",isActive:!0,sortOrder:3},{id:"qual-4",name:"IV категория",isActive:!0,sortOrder:4},{id:"qual-5",name:"V категория",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-collateral-attributes",name:"Атрибуты залогового имущества",code:"collateral_attributes",description:"Справочник атрибутов для различных типов залогового имущества",items:[{id:"attr-1",code:"GROUP_WHICH_CULTURE_BELONGS",name:"Группа, к которой относится культура",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10, Естественный ключ",isActive:!0,sortOrder:1,metadata:{type:"text",group:"Будущий урожай",required:!0,section:"4.10"}},{id:"attr-2",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10, Естественный ключ",isActive:!0,sortOrder:2,metadata:{type:"text",group:"Будущий урожай",required:!0,section:"4.10"}},{id:"attr-3",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:3,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-4",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:4,metadata:{type:"boolean",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-5",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:5,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-6",code:"GROUP_WHICH_CULTURE_BELONGS_OTHER",name:"Группа, к которой относится культура, иное",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:6,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-7",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:7,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-8",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:8,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-9",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:9,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-10",code:"QUANTITY",name:"Количество слитков, шт.",description:"Тип: number, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:10,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-11",code:"WEIGHT",name:"Масса, г.",description:"Тип: number, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:11,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-12",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:12,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-13",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:13,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-14",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:14,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-15",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:15,metadata:{type:"boolean",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-16",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:16,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-17",code:"NUMBER_OF_DOCUMENT_OF_INTEL_ACT",name:"Номер документа, удостоверяющего исключительное право на результат интеллектуальной деятельности",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12, Естественный ключ",isActive:!0,sortOrder:17,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!0,section:"4.12"}},{id:"attr-18",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:18,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-19",code:"REGISTRATION_NUMBER_OF_RIGHTS",name:"Регистрационный номер прав на интеллектуальную собственность",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:19,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-20",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:20,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-21",code:"RIGHTS_EXPIRATION_DATE",name:"Дата окончания прав на результат интеллектуальной собственностиа",description:"Тип: date, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:21,metadata:{type:"date",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-22",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:22,metadata:{type:"boolean",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-23",code:"NUMBER_OF_PLEDGE_ACCOUNT",name:"Номер залогового счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13, Естественный ключ",isActive:!0,sortOrder:23,metadata:{type:"text",group:"Права по договору банковского счета",required:!0,section:"4.13"}},{id:"attr-24",code:"SUM_OF_DEPOSIT",name:"Сумма депозита/вклада, передаваемая в залог",description:"Тип: number, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:24,metadata:{type:"number",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-25",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:25,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-26",code:"DATEEND_OF_ARRENGEMENT",name:"Дата окончания договора депозита/вклада",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:26,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-27",code:"NAME_OF_BANK",name:"Наименование банка, в котором открыт депозит/вклад",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:27,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-28",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:28,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-29",code:"DATE_OF_ARRENGEMENT",name:"Дата заключения договора депозита/вклада",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:29,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-30",code:"PR_OF_PLEDGE_ACCOUNT",name:"Признак наличия залогового счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:30,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-31",code:"BANK_ACCOUNT_AGREEMENT_DATE",name:"Дата договора банковского счета",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:31,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-32",code:"BANK_ACCOUNT_AGREEMENT_NUMBER",name:"Номер договора банковского счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:32,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-33",code:"INFORMATION_ABOUT_AMOUNT_MONEY",name:"Сведения о денежной сумме",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:33,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-34",code:"CURRENCY_OF_SUM",name:"Валюта депозита/вклада",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:34,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-35",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:35,metadata:{type:"boolean",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-36",code:"ACC_NUM_FOR_ACC_OF_DEP",name:"Номер счета по учету депозита/вклада",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:36,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-37",code:"ID_OOO",name:"id клиента",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:37,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-38",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14, Естественный ключ",isActive:!0,sortOrder:38,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14"}},{id:"attr-39",code:"SHARE_INFORMATION",name:"Значение идентификационного кода ООО",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14, Естественный ключ",isActive:!0,sortOrder:39,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14"}},{id:"attr-40",code:"NAME_OOO",name:"Наименование ООО",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:40,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-41",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:41,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-42",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:42,metadata:{type:"boolean",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-43",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:43,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-44",code:"TYPE_CODE_OOO",name:"Тип идентификационного кода субъекта (ООО)",description:"Тип: select, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:44,metadata:{type:"select",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-45",code:"PERCENTAGE_AUTHORIZED_CAPITAL",name:"Процент уставного капитала общества с ограниченной ответственностью, который составляет доля (часть доли)",description:"Тип: number, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:45,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-46",code:"ID_OOO",name:"Идентификационный код субъекта (ООО) или ID субъекта (ООО)",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:46,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-47",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:47,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-48",code:"NUMBER_OF_VEKSEL",name:"Номер векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:48,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-49",code:"RELEASE_DATE_VEKSEL",name:"Дата выпуска векселя",description:"Тип: date, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:49,metadata:{type:"date",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-50",code:"INN_ISSUER",name:"Значение идентификационного  кода субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:50,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-51",code:"DENOMINATION_VEKSEL",name:"Номинал векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:51,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-52",code:"NUMBER_BLANK_OF_VEKSEL",name:"Номер бланка векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:52,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-53",code:"SERIA_VEKSEL",name:"Серия векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:53,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-54",code:"CODE_VEKSELEDERZHATEL_NONRESIDENT",name:"Признак кода векселедержателя (собственника) нерезидента",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:54,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-55",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:55,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-56",code:"VALUE_DEPOSITORY",name:"Значение идентификационного  кода субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:56,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-57",code:"CURRENCY_CODE_VEKSEL",name:"Код валюты векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:57,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-58",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:58,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-59",code:"NAME_DEPOSITORY",name:"Наименование субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:59,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-60",code:"SUBJECT_AVALIZATION",name:"Субъект авалирования/акцептования векселя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:60,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-61",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:61,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-62",code:"NAME_ISSUER",name:"Наименование субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:62,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-63",code:"VEKSEL_TYPE",name:"Тип векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:63,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-64",code:"VEKSEL_CURRENCY",name:"Валюта векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:64,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-65",code:"VEKSELEDATEL",name:"Векселедатель",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:65,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-66",code:"VEKSELEDERZHATEL",name:"Векселедержатель",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:66,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-67",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:67,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-68",code:"PERCENT_OF_VEKSEL",name:"Процентная ставка по векселю",description:"Тип: number, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:68,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-69",code:"VEKSEL_SIGN",name:"Признак векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:69,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-70",code:"DISCOUNT_OF_VEKSEL",name:"Дисконт по векселю",description:"Тип: number, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:70,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-71",code:"MATURITY_OF_VEKSEL",name:"Срок погашения векселя",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:71,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-72",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:72,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-73",code:"PLACE_OF_COMPILATION",name:"Место составления",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:73,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-74",code:"PLACE_OF_PAYMENT",name:"Место платежа",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:74,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-75",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:75,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-76",code:"SIGN_LEGAL_VEKSELEDATEL",name:"Признак юр. лица субъекта (векселедателя)",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:76,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-77",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:77,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-78",code:"VEKSEL_CONDITION",name:"Состояние векселя на отчетную дату",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:78,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-79",code:"RECEIPT_DATE",name:"Дата поступления",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:79,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-80",code:"TERM_CONDITIONS_PAYMENT",name:"Срок и условия платежа (Дата 2)",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:80,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-81",code:"CONDITIONS_PAYMENT",name:"Условия платежа",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:81,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-82",code:"SECURITY_TYPE",name:"Код типа ценной бумаги",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:82,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-83",code:"OKSM_COUNTRY_VEKSELEDATEL",name:"Код ОКСМ страны векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:83,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-84",code:"OGRN_VEKSELEDATEL",name:"ОГРН векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:84,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-85",code:"TYPE_CODE_VEKSELEDATEL",name:"Тип идентификационного кода субъекта (векселедателя)",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:85,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-86",code:"CODE_VEKSELEDATEL_NONRESIDENT",name:"Признак кода векселедателя нерезидента",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:86,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-87",code:"SIGN_VEKSELEDATEL",name:"Признак векселедателя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:87,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-88",code:"ID_VEKSEL",name:"Идентификационный код векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:88,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-89",code:"ID_VEKSELEDATEL",name:"Идентификационный код субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:89,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-90",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:90,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-91",code:"TYPE_DEPOSITORY",name:"Тип идентификационного кода субъекта (депозитария)",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:91,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-92",code:"LOCATION_OF_VEKSEL",name:"Местонахождения векселя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:92,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-93",code:"ID_DEPOSITORY",name:"Идентификационный код субъекта (депозитария) или ID субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:93,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-94",code:"attr_94",name:"Тип векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:94,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-95",code:"attr_95",name:"Код ОКСМ страны векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:95,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-96",code:"attr_96",name:"Тип идентификационного кода векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:96,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-97",code:"RATING_VEKSEL",name:"Номинал векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:97,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-98",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16, Естественный ключ",isActive:!0,sortOrder:98,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!0,section:"4.16"}},{id:"attr-99",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:99,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-100",code:"GOVERNMENT_NUM_OF_SECURITIES",name:"Государственный регистрационный номер выпуска ценных бумаг",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:100,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-101",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:101,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-102",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип: date, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:102,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-103",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:103,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-104",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:104,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-105",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:105,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-106",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:106,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-107",code:"ISSUE_SECURITY_TYPE",name:"Код типа эмиссионной ценной бумаги",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:107,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-108",code:"COUNTRY_CODE_ISSUER",name:"Код ОКСМ страны эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:108,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-109",code:"OGRN_ISSUER",name:"ОГРН эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:109,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-110",code:"KPP_ISSUER",name:"КПП эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:110,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-111",code:"CODE_ISSUER_NONRESIDENT",name:"Признак кода эмитента нерезидента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:111,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-112",code:"SIGN_ISSUER",name:"Признак эмитента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:112,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-113",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:113,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-114",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:114,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-115",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:115,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-116",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:116,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-117",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:117,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-118",code:"AMOUNT_OF_SECURITIES",name:"Количество эмиссионных ценных бумаг, шт.",description:"Тип: number, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:118,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-119",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:119,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-120",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:120,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-121",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:121,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-122",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:122,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-123",code:"ID_NUM_SECURITIES",name:"Идентификационный номер выпуска ценных бумаг",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:123,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-124",code:"CLASS_SECURITIES",name:"Класс ценной бумаги",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:124,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-125",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:125,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-126",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:126,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-127",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:127,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-128",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:128,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-129",code:"REG_NUM_OF_PIE_FUND",name:"Регистрационный номер правил доверительного управления паевым инвестиционным фондом",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17, Естественный ключ",isActive:!0,sortOrder:129,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17"}},{id:"attr-130",code:"AMOUNT_OF_PIES",name:"Количество паев паевого инвестиционного фонда, шт.",description:"Тип: number, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17, Естественный ключ",isActive:!0,sortOrder:130,metadata:{type:"number",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17"}},{id:"attr-131",code:"DATE_END_CONTRACT_OF_PIE_FUND",name:"Дата окончания срока действия договора доверительного управления паевым инвестиционным фондом",description:"Тип: date, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:131,metadata:{type:"date",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-132",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:132,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-133",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:133,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-134",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:134,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-135",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:135,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-136",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:136,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-137",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:137,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-138",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:138,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-139",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:139,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-140",code:"IND_DES_OF_MORTG_PART_CERT",name:"Индивидуальное обозначение ипотечных сертификатов участия",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18, Естественный ключ",isActive:!0,sortOrder:140,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!0,section:"4.18"}},{id:"attr-141",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:141,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-142",code:"DATE_END_TERM_CONTRACT_TRUST_MANAGEMENT_MORTGAGE_COVERAGE",name:"Дата окончания срока действия договора доверительного управления ипотечным покрытием",description:"Тип: date, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:142,metadata:{type:"date",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-143",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:143,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-144",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:144,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-145",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:145,metadata:{type:"boolean",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-146",code:"NUM_OF_MORTG_PART_CERTIF",name:"Количество ипотечных сертификатов участия, шт.",description:"Тип: number, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:146,metadata:{type:"number",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-147",code:"REGISTR_NUM",name:"Регистрационный номер правил доверительного управления ипотечным покрытием",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:147,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-148",code:"SERIA_SEC_PAPER",name:"Серия ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19, Естественный ключ",isActive:!0,sortOrder:148,metadata:{type:"text",group:"Прочие ценные бумаги",required:!0,section:"4.19"}},{id:"attr-149",code:"NUM_SECURITIES",name:"Номер ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19, Естественный ключ",isActive:!0,sortOrder:149,metadata:{type:"text",group:"Прочие ценные бумаги",required:!0,section:"4.19"}},{id:"attr-150",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:150,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-151",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:151,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-152",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:152,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-153",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:153,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-154",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:154,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-155",code:"AMOUNT_SHARE",name:"Количество ценных бумаг, шт.",description:"Тип: number, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:155,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-156",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:156,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-157",code:"TYPE_SECURITIES",name:"Вид ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:157,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-158",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:158,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-159",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:159,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-160",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:160,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-161",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:161,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-162",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:162,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-163",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:163,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-164",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:164,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-165",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:165,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-166",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:166,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-167",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:167,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-168",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип: date, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:168,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-169",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:169,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-170",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:170,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-171",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:171,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-172",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:172,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-173",code:"attr_173",name:"Код ОКСМ страны эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:173,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-174",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2, Естественный ключ",isActive:!0,sortOrder:174,metadata:{type:"text",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!0,section:"4.2"}},{id:"attr-175",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:175,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-176",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:176,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-177",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:177,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-178",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20, Естественный ключ",isActive:!0,sortOrder:178,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!0,section:"4.20"}},{id:"attr-179",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20, Естественный ключ",isActive:!0,sortOrder:179,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!0,section:"4.20"}},{id:"attr-180",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:180,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-181",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:181,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-182",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:182,metadata:{type:"boolean",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-183",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:183,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-184",code:"DATE_CONTRACT",name:"Дата договора/ контакта/ доп соглашения",description:"Тип: date, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:184,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-185",code:"SUBJECT_OF_CONTRACT",name:"Предмет контракта/договора",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:185,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-186",code:"COUNTERPARTY_UNDER_CONTRACT",name:"Контрагент по договору/контракту",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:186,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-187",code:"NUMBER_CONTRACT",name:"Номер договора/контракта/доп. соглашения",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:187,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-188",code:"DATE_END_CONTRACT",name:"Дата окончания срока действия договора/ контракта/ доп соглашения",description:"Тип: date, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:188,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-189",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Здание, Раздел: 4.2.1, Естественный ключ",isActive:!0,sortOrder:189,metadata:{type:"text",group:"Здание",required:!0,section:"4.2.1"}},{id:"attr-190",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:190,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-191",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:191,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-192",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:192,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-193",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:193,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-194",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:194,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-195",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:195,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-196",code:"STREET",name:"Улица",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:196,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-197",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:197,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-198",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:198,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-199",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:199,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-200",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:200,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-201",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:201,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-202",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:202,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-203",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:203,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-204",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:204,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-205",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:205,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-206",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:206,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-207",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:207,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-208",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:208,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-209",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:209,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-210",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:210,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-211",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:211,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-212",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:212,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-213",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:213,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-214",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:214,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-215",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:215,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-216",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:216,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-217",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:217,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-218",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:218,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-219",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:219,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-220",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:220,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-221",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:221,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-222",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:222,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-223",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:223,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-224",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:224,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-225",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:225,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-226",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:226,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-227",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:227,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-228",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:228,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-229",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:229,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-230",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:230,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-231",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:231,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-232",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:232,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-233",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:233,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-234",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:234,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-235",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:235,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-236",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:236,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-237",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:237,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-238",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:238,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-239",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:239,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-240",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:240,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-241",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:241,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-242",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:242,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-243",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:243,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-244",code:"REGION",name:"Регион",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:244,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-245",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21, Естественный ключ",isActive:!0,sortOrder:245,metadata:{type:"text",group:"Прочие движимые вещи",required:!0,section:"4.21"}},{id:"attr-246",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21, Естественный ключ",isActive:!0,sortOrder:246,metadata:{type:"text",group:"Прочие движимые вещи",required:!0,section:"4.21"}},{id:"attr-247",code:"LOCATION_OTHER_MOVABLE_PROPERTY",name:"Местонахождение прочего движимого имущества",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:247,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-248",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:248,metadata:{type:"boolean",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-249",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:249,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-250",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:250,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-251",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2, Естественный ключ",isActive:!0,sortOrder:251,metadata:{type:"text",group:"Сооружение",required:!0,section:"4.2.2"}},{id:"attr-252",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:252,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-253",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:253,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-254",code:"STREET",name:"Улица",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:254,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-255",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:255,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-256",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:256,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-257",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:257,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-258",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:258,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-259",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:259,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-260",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:260,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-261",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:261,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-262",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:262,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-263",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:263,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-264",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:264,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-265",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:265,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-266",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:266,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-267",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:267,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-268",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:268,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-269",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:269,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-270",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:270,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-271",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:271,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-272",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:272,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-273",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:273,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-274",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:274,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-275",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:275,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-276",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:276,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-277",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:277,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-278",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:278,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-279",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:279,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-280",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:280,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-281",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:281,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-282",code:"REGION",name:"Регион",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:282,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-283",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:283,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-284",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:284,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-285",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:285,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-286",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:286,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-287",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:287,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-288",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:288,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-289",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:289,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-290",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:290,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-291",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:291,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-292",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:292,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-293",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:293,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-294",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:294,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-295",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:295,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-296",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:296,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-297",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:297,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-298",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:298,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-299",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:299,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-300",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:300,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-301",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:301,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-302",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:302,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-303",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:303,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-304",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:304,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-305",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:305,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-306",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:306,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-307",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3, Естественный ключ",isActive:!0,sortOrder:307,metadata:{type:"text",group:"Помещение",required:!0,section:"4.2.3"}},{id:"attr-308",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:308,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-309",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:309,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-310",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:310,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-311",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:311,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-312",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:312,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-313",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:313,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-314",code:"REGION",name:"Регион",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:314,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-315",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:315,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-316",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:316,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-317",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:317,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-318",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:318,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-319",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:319,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-320",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:320,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-321",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:321,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-322",code:"STREET",name:"Улица",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:322,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-323",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:323,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-324",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:324,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-325",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:325,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-326",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:326,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-327",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:327,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-328",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:328,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-329",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:329,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-330",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:330,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-331",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:331,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-332",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:332,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-333",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:333,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-334",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:334,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-335",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:335,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-336",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:336,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-337",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:337,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-338",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:338,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-339",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:339,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-340",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:340,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-341",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:341,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-342",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:342,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-343",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:343,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-344",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:344,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-345",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:345,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-346",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:346,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-347",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:347,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-348",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:348,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-349",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:349,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-350",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:350,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-351",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:351,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-352",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:352,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-353",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:353,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-354",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:354,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-355",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:355,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-356",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:356,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-357",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:357,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-358",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:358,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-359",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:359,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-360",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:360,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-361",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:361,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-362",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:362,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-363",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4, Естественный ключ",isActive:!0,sortOrder:363,metadata:{type:"text",group:"Машино-место",required:!0,section:"4.2.4"}},{id:"attr-364",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:364,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-365",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:365,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-366",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:366,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-367",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:367,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-368",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:368,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-369",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:369,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-370",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:370,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-371",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:371,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-372",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:372,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-373",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:373,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-374",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:374,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-375",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:375,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-376",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:376,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-377",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:377,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-378",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:378,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-379",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:379,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-380",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:380,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-381",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:381,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-382",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:382,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-383",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:383,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-384",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:384,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-385",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:385,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-386",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:386,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-387",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:387,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-388",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:388,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-389",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:389,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-390",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:390,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-391",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:391,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-392",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:392,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-393",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:393,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-394",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:394,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-395",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:395,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-396",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:396,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-397",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:397,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-398",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:398,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-399",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:399,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-400",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:400,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-401",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:401,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-402",code:"STREET",name:"Улица",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:402,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-403",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:403,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-404",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:404,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-405",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:405,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-406",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:406,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-407",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:407,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-408",code:"REGION",name:"Регион",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:408,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-409",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:409,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-410",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:410,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-411",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:411,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-412",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:412,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-413",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:413,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-414",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:414,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-415",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:415,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-416",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:416,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-417",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:417,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-418",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:418,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-419",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5, Естественный ключ",isActive:!0,sortOrder:419,metadata:{type:"text",group:"Объект незавершенного строительства",required:!0,section:"4.2.5"}},{id:"attr-420",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:420,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-421",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:421,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-422",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:422,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-423",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:423,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-424",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:424,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-425",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:425,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-426",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:426,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-427",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:427,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-428",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:428,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-429",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:429,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-430",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:430,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-431",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:431,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-432",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:432,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-433",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:433,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-434",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:434,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-435",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:435,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-436",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:436,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-437",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:437,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-438",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:438,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-439",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:439,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-440",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:440,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-441",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:441,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-442",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:442,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-443",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:443,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-444",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:444,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-445",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:445,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-446",code:"REGION",name:"Регион",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:446,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-447",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:447,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-448",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:448,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-449",code:"STREET",name:"Улица",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:449,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-450",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:450,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-451",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:451,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-452",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:452,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-453",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:453,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-454",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:454,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-455",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:455,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-456",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:456,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-457",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:457,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-458",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:458,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-459",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:459,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-460",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:460,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-461",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:461,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-462",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:462,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-463",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:463,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-464",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:464,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-465",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:465,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-466",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:466,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-467",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:467,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-468",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:468,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-469",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:469,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-470",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:470,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-471",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:471,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-472",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:472,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-473",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:473,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-474",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:474,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-475",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6, Естественный ключ",isActive:!0,sortOrder:475,metadata:{type:"text",group:"Земельный участок",required:!0,section:"4.2.6"}},{id:"attr-476",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:476,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-477",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:477,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-478",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:478,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-479",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:479,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-480",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:480,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-481",code:"TYPE_OF_USE_OF_THE_LAND",name:"Вид разрешенного использования земельного участка",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:481,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-482",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:482,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-483",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:483,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-484",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:484,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-485",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:485,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-486",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:486,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-487",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:487,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-488",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:488,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-489",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:489,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-490",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:490,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-491",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:491,metadata:{type:"select",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-492",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:492,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-493",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:493,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-494",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:494,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-495",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:495,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-496",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:496,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-497",code:"AREA_DEVIATION",name:"Отклонение площади, +/-, (м²)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:497,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-498",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:498,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-499",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:499,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-500",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:500,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-501",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:501,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-502",code:"BUILDINGS_NOT_INCLUDED",name:"Признак наличия на земельном участке зданий/ строений/ сооружений Залогодателя, не включенных в предмет ипотеки",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:502,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-503",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:503,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-504",code:"NAME_LANDLORD",name:"Наименование арендодателя",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:504,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-505",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:505,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-506",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:506,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-507",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:507,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-508",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:508,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-509",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:509,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-510",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:510,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-511",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:511,metadata:{type:"select",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-512",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:512,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-513",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:513,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-514",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:514,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-515",code:"REGION",name:"Регион",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:515,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-516",code:"STREET",name:"Улица",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:516,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-517",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:517,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-518",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:518,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-519",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:519,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-520",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:520,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-521",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:521,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-522",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:522,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-523",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7, Естественный ключ",isActive:!0,sortOrder:523,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!0,section:"4.2.7"}},{id:"attr-524",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:524,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-525",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:525,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-526",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:526,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-527",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:527,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-528",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:528,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-529",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:529,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-530",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:530,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-531",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:531,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-532",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:532,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-533",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:533,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-534",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:534,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-535",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:535,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-536",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:536,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-537",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:537,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-538",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:538,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-539",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:539,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-540",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:540,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-541",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:541,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-542",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:542,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-543",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:543,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-544",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:544,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-545",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:545,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-546",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:546,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-547",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:547,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-548",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:548,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-549",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:549,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-550",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:550,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-551",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:551,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-552",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:552,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-553",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:553,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-554",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:554,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-555",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:555,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-556",code:"STREET",name:"Улица",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:556,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-557",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:557,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-558",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:558,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-559",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:559,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-560",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:560,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-561",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:561,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-562",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:562,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-563",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:563,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-564",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:564,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-565",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:565,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-566",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:566,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-567",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:567,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-568",code:"REGION",name:"Регион",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:568,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-569",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:569,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-570",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:570,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-571",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:571,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-572",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:572,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-573",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:573,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-574",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:574,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-575",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:575,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-576",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:576,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-577",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:577,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-578",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:578,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-579",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8, Естественный ключ",isActive:!0,sortOrder:579,metadata:{type:"text",group:"Имущественный комплекс",required:!0,section:"4.2.8"}},{id:"attr-580",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:580,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-581",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:581,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-582",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:582,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-583",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:583,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-584",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:584,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-585",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:585,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-586",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:586,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-587",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:587,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-588",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:588,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-589",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:589,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-590",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:590,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-591",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:591,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-592",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:592,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-593",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:593,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-594",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:594,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-595",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:595,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-596",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:596,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-597",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:597,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-598",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:598,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-599",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:599,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-600",code:"REGION",name:"Регион",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:600,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-601",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:601,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-602",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:602,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-603",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:603,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-604",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:604,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-605",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:605,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-606",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:606,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-607",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:607,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-608",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:608,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-609",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:609,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-610",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:610,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-611",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:611,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-612",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:612,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-613",code:"FINANCIAL_MODEL_VALUATION",name:"Оценка с учетом финансовой модели заемщика ('N' - нет, 'Y' - да)",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:613,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-614",code:"STREET",name:"Улица",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:614,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-615",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:615,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-616",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:616,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-617",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:617,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-618",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:618,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-619",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:619,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-620",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:620,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-621",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:621,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-622",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:622,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-623",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:623,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-624",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:624,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-625",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:625,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-626",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:626,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-627",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:627,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-628",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:628,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-629",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:629,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-630",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:630,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-631",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:631,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-632",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:632,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-633",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:633,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-634",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:634,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-635",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:635,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-636",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:636,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-637",code:"VIN",name:"VIN",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:637,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-638",code:"FRAME_CHASSIS_NUMBER",name:"Номер шасси/рамы",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:638,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-639",code:"MILEAGE",name:"Пробег, км",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:639,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-640",code:"COLOR_BODY",name:"Цвет кузова (кабины)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:640,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-641",code:"PRICE_OF_NEW_CAR",name:"Цена нового ТС",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:641,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-642",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:642,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-643",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:643,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-644",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:644,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-645",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:645,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-646",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:646,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-647",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:647,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-648",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:648,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-649",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:649,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-650",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:650,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-651",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:651,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-652",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:652,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-653",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:653,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-654",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:654,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-655",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:655,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-656",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:656,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-657",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:657,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-658",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:658,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-659",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:659,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-660",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:660,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-661",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:661,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-662",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:662,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-663",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:663,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-664",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:664,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-665",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:665,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-666",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:666,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-667",code:"ENGINE_VOLUME_SM",name:"Объем двигателя, см3",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:667,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-668",code:"BODY_NUMBER",name:"Номер кузова (кабины, прицепа)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:668,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-669",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:669,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-670",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:670,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-671",code:"MOTOR_NUMBER",name:"Номер двигателя",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:671,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-672",code:"NAME_OF_CERTIFICATE_TS",name:"Наименование свидетельства о регистрации ТС",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:672,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-673",code:"NAME_OF_TS",name:"Наименование паспорта ТС",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:673,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-674",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:674,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-675",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:675,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-676",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:676,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-677",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:677,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-678",code:"BRAND",name:"Марка",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:678,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-679",code:"COUNT_RTA",name:"Количество ДТП",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:679,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-680",code:"ACCIDENT_INVESTIGATION",name:"Следствие ДТП",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:680,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-681",code:"COLLATERAL_CONDITION",name:"Состояние ПЗ",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:681,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-682",code:"IDENTIFIED_DEFECTS",name:"Выявленные дефекты",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:682,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-683",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:683,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-684",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:684,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-685",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:685,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-686",code:"DATE_OF_CERTIFICATE_TS",name:"Дата свидетельства о регистрации ТС",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:686,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-687",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:687,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-688",code:"DATE_OF_PASSPORT_TS",name:"Дата паспорта ТС",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:688,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-689",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:689,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-690",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:690,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-691",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:691,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-692",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:692,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-693",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:693,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-694",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:694,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-695",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:695,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-696",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:696,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-697",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:697,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-698",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:698,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-699",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:699,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-700",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:700,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-701",code:"TYPE_INCIDENTS",name:"Тип происшествия",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:701,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-702",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:702,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-703",code:"MOTOR_TYPE",name:"Тип двигателя",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:703,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-704",code:"SERIA_NUMBER_OF_CERTIFICATE_TS",name:"Серия и номер свидетельства о регистрации ТС",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:704,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-705",code:"SERIAS_NUMBER_PASSPORT_TS",name:"Серия и номер паспорта ТС",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:705,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-706",code:"STATE",name:"Состояние",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:706,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-707",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:707,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-708",code:"PSEUDO_KEY",name:"Операция между группой 1 и 2(псевдо атрибут)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:708,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-709",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:709,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-710",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:710,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-711",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:711,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-712",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:712,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-713",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:713,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-714",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:714,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-715",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:715,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-716",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:716,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-717",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:717,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-718",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:718,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-719",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:719,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-720",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:720,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-721",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:721,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-722",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:722,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-723",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:723,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-724",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:724,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-725",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:725,metadata:{type:"select",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-726",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:726,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-727",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:727,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-728",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:728,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-729",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:729,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-730",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:730,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-731",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:731,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-732",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:732,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-733",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:733,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-734",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:734,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-735",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:735,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-736",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:736,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-737",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:737,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-738",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:738,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-739",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:739,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-740",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:740,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-741",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:741,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-742",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:742,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-743",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:743,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-744",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:744,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-745",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:745,metadata:{type:"select",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-746",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:746,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-747",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:747,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-748",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:748,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-749",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:749,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-750",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:750,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-751",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:751,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-752",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:752,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-753",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:753,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-754",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:754,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-755",code:"BRAND",name:"Марка",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:755,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-756",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:756,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-757",code:"SERIAL_FACTORY_NUMBER",name:"Серийный (заводской) номер",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5, Естественный ключ",isActive:!0,sortOrder:757,metadata:{type:"text",group:"Воздушные суда",required:!0,section:"4.5"}},{id:"attr-758",code:"GLIDER_NUMBER",name:"Номер планера",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:758,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-759",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:759,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-760",code:"NAME_OF_MANUFACTURER",name:"Наименование изготовителя",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:760,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-761",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:761,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-762",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:762,metadata:{type:"boolean",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-763",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:763,metadata:{type:"number",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-764",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:764,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-765",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:765,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-766",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Плавучие сооружения, Раздел: 4.6, Естественный ключ",isActive:!0,sortOrder:766,metadata:{type:"text",group:"Плавучие сооружения",required:!0,section:"4.6"}},{id:"attr-767",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Плавучие сооружения, Раздел: 4.6, Естественный ключ",isActive:!0,sortOrder:767,metadata:{type:"text",group:"Плавучие сооружения",required:!0,section:"4.6"}},{id:"attr-768",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2, Естественный ключ",isActive:!0,sortOrder:768,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!0,section:"4.6.2"}},{id:"attr-769",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:769,metadata:{type:"number",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-770",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:770,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-771",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:771,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-772",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:772,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-773",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:773,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-774",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:774,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-775",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:775,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-776",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:776,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-777",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:777,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-778",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:778,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-779",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:779,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-780",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:780,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-781",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:781,metadata:{type:"number",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-782",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:782,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-783",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:783,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-784",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:784,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-785",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4, Естественный ключ",isActive:!0,sortOrder:785,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!0,section:"4.6.4"}},{id:"attr-786",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:786,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-787",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:787,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-788",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:788,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-789",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:789,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-790",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:790,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-791",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:791,metadata:{type:"number",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-792",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:792,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-793",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:793,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-794",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:794,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-795",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:795,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-796",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3, Естественный ключ",isActive:!0,sortOrder:796,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!0,section:"4.6.3"}},{id:"attr-797",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:797,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-798",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:798,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-799",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:799,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-800",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:800,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-801",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:801,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-802",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:802,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-803",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:803,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-804",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:804,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-805",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5, Естественный ключ",isActive:!0,sortOrder:805,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!0,section:"4.6.5"}},{id:"attr-806",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:806,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-807",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:807,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-808",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:808,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-809",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:809,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-810",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:810,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-811",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:811,metadata:{type:"number",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-812",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:812,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-813",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:813,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-814",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:814,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-815",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:815,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-816",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:816,metadata:{type:"number",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-817",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:817,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-818",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1, Естественный ключ",isActive:!0,sortOrder:818,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!0,section:"4.6.1"}},{id:"attr-819",code:"PASSENGER_CAPACITY_OF_THE_VESSEL",name:"Пассажировместимость судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:819,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-820",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:820,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-821",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:821,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-822",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:822,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-823",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:823,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-824",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:824,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-825",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:825,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-826",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:826,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-827",code:"NAME_OF_OTHER_TYPE",name:"Наименование иного типа маломерного судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:827,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-828",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:828,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-829",code:"LENGTH_SHIP",name:"Длина судна в метрах",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:829,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-830",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:830,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-831",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:831,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-832",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:832,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-833",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:833,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-834",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:834,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-835",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:835,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-836",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:836,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-837",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:837,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-838",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:838,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-839",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:839,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-840",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:840,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-841",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:841,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-842",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:842,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-843",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:843,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-844",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:844,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-845",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:845,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-846",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:846,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-847",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:847,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-848",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:848,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-849",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:849,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-850",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:850,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-851",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:851,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-852",code:"WEIGHT_OF_SHIP",name:"Масса судна в кг",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:852,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-853",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:853,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-854",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:854,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-855",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:855,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-856",code:"NET_ADDRESS",name:"Сетевой номер",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7, Естественный ключ",isActive:!0,sortOrder:856,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!0,section:"4.7"}},{id:"attr-857",code:"RZHD_MPS",name:"Заводской номер/ номер РЖД/МПС",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7, Естественный ключ",isActive:!0,sortOrder:857,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!0,section:"4.7"}},{id:"attr-858",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:858,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-859",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:859,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-860",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:860,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-861",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:861,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-862",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:862,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-863",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:863,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-864",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:864,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-865",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:865,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-866",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:866,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-867",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:867,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-868",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:868,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-869",code:"DATE_WAGON_TECHNICAL_PASSPORT",name:"Дата технического паспорта вагона",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:869,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-870",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:870,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-871",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:871,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-872",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:872,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-873",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:873,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-874",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:874,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-875",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:875,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-876",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:876,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-877",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:877,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-878",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:878,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-879",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:879,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-880",code:"WAGON_TECHNICAL_PASSPORT_NUMBER",name:"Номер технического паспорта вагона",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:880,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-881",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:881,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-882",code:"ADDRESS_LOCATION",name:"Адрес места нахождения (депо приписки)",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:882,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-883",code:"CARRIAGE_NUMBER",name:"Номер вагона",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:883,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-884",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:884,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-885",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8, Естественный ключ",isActive:!0,sortOrder:885,metadata:{type:"text",group:"Космические объекты",required:!0,section:"4.8"}},{id:"attr-886",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:886,metadata:{type:"boolean",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-887",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:887,metadata:{type:"number",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-888",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:888,metadata:{type:"text",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-889",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:889,metadata:{type:"text",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-890",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:890,metadata:{type:"text",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-891",code:"NUMBER_OF_PRODUCT_UNITS",name:"Количество единиц измерения товара",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:891,metadata:{type:"number",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-892",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:892,metadata:{type:"text",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-893",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:893,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-894",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:894,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-895",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:895,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-896",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:896,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-897",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:897,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-898",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:898,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-899",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:899,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-900",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:900,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-901",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:901,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-902",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:902,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-903",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:903,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-904",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:904,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-905",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:905,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-906",code:"UNIT",name:"Единица измерения товара",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:906,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-907",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:907,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-908",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:908,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-909",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:909,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-910",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:910,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-911",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:911,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-912",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:912,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-913",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:913,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-914",code:"COST_PER_UNIT_OF_MEASURE_GOODS",name:"Стоимость за единицу измерения товара в руб.",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:914,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-915",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:915,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-916",code:"STORAGE_SPACE",name:"Количество места хранения",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:916,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-917",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:917,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-918",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:918,metadata:{type:"select",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-919",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:919,metadata:{type:"boolean",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-920",code:"NUMBER_OF_STORAGE_LOCATIONS",name:"Количество мест хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:920,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-921",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:921,metadata:{type:"select",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-922",code:"ACTUAL_BALANCE_OF_GOODS",name:"Фактический остаток товара, тыс.руб.",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:922,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-923",code:"VENDOR_CODE",name:"Артикул",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:923,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-924",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:924,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-925",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Все имущество залогодателя, Естественный ключ",isActive:!0,sortOrder:925,metadata:{type:"text",group:"Все имущество залогодателя",required:!0,section:""}},{id:"attr-926",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Все имущество залогодателя, Естественный ключ",isActive:!0,sortOrder:926,metadata:{type:"text",group:"Все имущество залогодателя",required:!0,section:""}},{id:"attr-927",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Все имущество залогодателя",isActive:!0,sortOrder:927,metadata:{type:"boolean",group:"Все имущество залогодателя",required:!1,section:""}},{id:"attr-928",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Все имущество залогодателя",isActive:!0,sortOrder:928,metadata:{type:"text",group:"Все имущество залогодателя",required:!1,section:""}},{id:"attr-929",code:"id",name:"Идентификатор кредитной операции",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:929,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-930",code:"operationType",name:"Тип кредитной операции(сделка,лимит и пр)",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:930,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-931",code:"salePoint",name:"Точка продаж",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:931,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-932",code:"_",name:"Сегмент бизнеса",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:932,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-933",code:"___",name:"Сотрудник инициирующего подразделения (исполнитель) (КМ)",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:933,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-934",code:"_____",name:"Признак: объект залога является элементом группы",description:"Тип: boolean, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:934,metadata:{type:"boolean",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-935",code:"attr_935",name:"Группа",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:935,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-936",code:"type",name:"Вид/тип обеспечения",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:936,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-937",code:"collateralGuids",name:"Предмет залога",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:937,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-938",code:"status",name:"Статус",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:938,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-939",code:"category",name:"Категория Качества",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:939,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-940",code:"нет (рассмотреть перенос в динамические)",name:"Признак обеспечения",description:"Тип: boolean, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:940,metadata:{type:"boolean",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-941",code:"нет (рассмотреть перенос в динамические)",name:"Причины невозможности учета обеспечения для целей Инструкции о формировании РВПС",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:941,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-942",code:"нет (рассмотреть перенос в динамические)",name:"Залог выступает обеспечением обязательств",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:942,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-943",code:"id",name:"ID Залогодателя",description:"Тип: date, Группа: Владельцы",isActive:!0,sortOrder:943,metadata:{type:"date",group:"Владельцы",required:!1,section:""}},{id:"attr-944",code:"signLegal",name:"Признак юридического лица",description:"Тип: boolean, Группа: Владельцы",isActive:!0,sortOrder:944,metadata:{type:"boolean",group:"Владельцы",required:!1,section:""}},{id:"attr-945",code:"basicType",name:"Право владения",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:945,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-946",code:"additionalType",name:"Вид иного права",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:946,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-947",code:"share",name:"Размер доли в праве общей долевой собственности",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:947,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-948",code:"rentDueDate",name:"Дата окончания срока аренды",description:"Тип: date, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:948,metadata:{type:"date",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-949",code:"isPrimaryOwner",name:"Признак основного владельца",description:"Тип: boolean, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:949,metadata:{type:"boolean",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-950",code:"name",name:"Наименование документа-основания возникновения права владения у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:950,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-951",code:"number",name:"Номер документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:951,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-952",code:"startDate",name:"Дата документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:952,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-953",code:"dueDate",name:"Дата окончания документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:953,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-954",code:"basicType",name:"Вид обременения",description:"Тип: text, Группа: Внешние обременения",isActive:!0,sortOrder:954,metadata:{type:"text",group:"Внешние обременения",required:!1,section:""}},{id:"attr-955",code:"additionalType",name:"Вид иного обременения",description:"Тип: text, Группа: Внешние обременения",isActive:!0,sortOrder:955,metadata:{type:"text",group:"Внешние обременения",required:!1,section:""}},{id:"attr-956",code:"name",name:"Наименование документа, порождающего обременение",description:"Тип: text, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:956,metadata:{type:"text",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-957",code:"number",name:"Номер документа, порождающего обременение",description:"Тип: text, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:957,metadata:{type:"text",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-958",code:"startDate",name:"Дата документа, порождающего обременение",description:"Тип: date, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:958,metadata:{type:"date",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-959",code:"dueDate",name:"Дата окончания документа, порождающего обременение",description:"Тип: date, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:959,metadata:{type:"date",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-960",code:"name",name:"Полное наименование стороны по документу, порождающему обременение",description:"Тип: text, Группа: Внешние обременения. Субьект",isActive:!0,sortOrder:960,metadata:{type:"text",group:"Внешние обременения. Субьект",required:!1,section:""}},{id:"attr-961",code:"itin",name:"ИНН стороны по документу, порождающему обременение",description:"Тип: text, Группа: Внешние обременения. Субьект",isActive:!0,sortOrder:961,metadata:{type:"text",group:"Внешние обременения. Субьект",required:!1,section:""}},{id:"attr-962",code:"valuationSubject.name",name:"Субъект оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:962,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-963",code:"evaluator.name",name:"Наименование оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:963,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-964",code:"evaluator.inn",name:"ИНН оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:964,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-965",code:"evaluator.reportNumber",name:"Номер отчета об оценке оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:965,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-966",code:"evaluator.reportDate",name:"Дата отчета об оценке оценщика",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:966,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-967",code:"assessmentSubject.name",name:"Субъект экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:967,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-968",code:"__",name:"Сотрудник проводивший оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:968,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-969",code:"____",name:"Наименование структурного подразделения Банка, проводившего оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:969,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-970",code:"valuationDate",name:"Дата оценки",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:970,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-971",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:971,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-972",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:972,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-973",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:973,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-974",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:974,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-975",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:975,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-976",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:976,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-977",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:977,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-978",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:978,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-979",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:979,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-980",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:980,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-981",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:981,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-982",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:982,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-983",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:983,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-984",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:984,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-985",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:985,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-986",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:986,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-987",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:987,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-988",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:988,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-989",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:989,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-990",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:990,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-991",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:991,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-992",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:992,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-993",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:993,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-994",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:994,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-995",code:"currency.code",name:"Код валюты",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:995,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-996",code:"currency.rate",name:"Курс валюты к рублю на дату оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:996,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-997",code:"discount",name:"Залоговый дисконт",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:997,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-998",code:"isRevaluationRequired",name:"Признак требования переоценки",description:"Тип: boolean, Группа: Оценка",isActive:!0,sortOrder:998,metadata:{type:"boolean",group:"Оценка",required:!1,section:""}},{id:"attr-999",code:"startDate",name:"Дата начала действия справедливой стоимости",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:999,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-1000",code:"needInsurance",name:"Признак необходимости страхования",description:"Тип: boolean, Группа: страхование",isActive:!0,sortOrder:1e3,metadata:{type:"boolean",group:"страхование",required:!1,section:""}},{id:"attr-1001",code:"number",name:"Номер договора страхования",description:"Тип: text, Группа: страхование",isActive:!0,sortOrder:1001,metadata:{type:"text",group:"страхование",required:!1,section:""}},{id:"attr-1002",code:"date",name:"Дата договора страхования",description:"Тип: date, Группа: страхование",isActive:!0,sortOrder:1002,metadata:{type:"date",group:"страхование",required:!1,section:""}},{id:"attr-1003",code:"name",name:"Наименование страховой компании",description:"Тип: text, Группа: страхование. Компания",isActive:!0,sortOrder:1003,metadata:{type:"text",group:"страхование. Компания",required:!1,section:""}},{id:"attr-1004",code:"itin",name:"ИНН страховой компании",description:"Тип: text, Группа: страхование. Компания",isActive:!0,sortOrder:1004,metadata:{type:"text",group:"страхование. Компания",required:!1,section:""}},{id:"attr-1005",code:"value",name:"Страховая сумма по договору в руб.",description:"Тип: number, Группа: страхование. Страховая сумма",isActive:!0,sortOrder:1005,metadata:{type:"number",group:"страхование. Страховая сумма",required:!1,section:""}},{id:"attr-1006",code:"includedInLoan",name:"Страховая премия по договору, если включена в сумму кредита в руб.",description:"Тип: text, Группа: страхование. Страховая сумма",isActive:!0,sortOrder:1006,metadata:{type:"text",group:"страхование. Страховая сумма",required:!1,section:""}},{id:"attr-1007",code:"lossRiskInsurance",name:"Страхование от риска утраты или повреждения",description:"Тип: text, Группа: страхование. Тип страхования",isActive:!0,sortOrder:1007,metadata:{type:"text",group:"страхование. Тип страхования",required:!1,section:""}},{id:"attr-1008",code:"titleInsurance",name:"Страхование титула",description:"Тип: text, Группа: страхование. Тип страхования",isActive:!0,sortOrder:1008,metadata:{type:"text",group:"страхование. Тип страхования",required:!1,section:""}},{id:"attr-1009",code:"start",name:"Период страхования с",description:"Тип: text, Группа: страхование. Страховой период",isActive:!0,sortOrder:1009,metadata:{type:"text",group:"страхование. Страховой период",required:!1,section:""}},{id:"attr-1010",code:"end",name:"Период страхования по",description:"Тип: text, Группа: страхование. Страховой период",isActive:!0,sortOrder:1010,metadata:{type:"text",group:"страхование. Страховой период",required:!1,section:""}},{id:"attr-1011",code:"start",name:"Оплаченный период страхования с",description:"Тип: text, Группа: страхование. Оплаченный период",isActive:!0,sortOrder:1011,metadata:{type:"text",group:"страхование. Оплаченный период",required:!1,section:""}},{id:"attr-1012",code:"end",name:"Оплаченный период страхования по",description:"Тип: text, Группа: страхование. Оплаченный период",isActive:!0,sortOrder:1012,metadata:{type:"text",group:"страхование. Оплаченный период",required:!1,section:""}},{id:"attr-1013",code:"name",name:"Наименование выгодоприобретателя",description:"Тип: date, Группа: страхование. Наименование выгодоприобретателя",isActive:!0,sortOrder:1013,metadata:{type:"date",group:"страхование. Наименование выгодоприобретателя",required:!1,section:""}},{id:"attr-1014",code:"______",name:"Признак необходимости отчеты об оценке для мониторинга (да/нет)",description:"Тип: boolean, Группа: мониторинг",isActive:!0,sortOrder:1014,metadata:{type:"boolean",group:"мониторинг",required:!1,section:""}},{id:"attr-1015",code:"____",name:"Структурное подразделение ответственное за мониторинг залоговой сделки",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1015,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1016",code:"__",name:"Периодичность мониторинга, срок",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1016,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1017",code:"__",name:"Периодичность мониторинга, срок",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1017,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1018",code:"__",name:"Периодичность мониторинга, дни",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1018,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1019",code:"__",name:"Дата фактической проверки",description:"Тип: date, Группа: мониторинг, Естественный ключ",isActive:!0,sortOrder:1019,metadata:{type:"date",group:"мониторинг",required:!0,section:""}},{id:"attr-1020",code:"__",name:"Дата планируемой проверки",description:"Тип: date, Группа: мониторинг",isActive:!0,sortOrder:1020,metadata:{type:"date",group:"мониторинг",required:!1,section:""}},{id:"attr-1021",code:"_",name:"Инициирующее подразделение",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1021,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1022",code:"attr_1022",name:"Исполнитель",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1022,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1023",code:"type",name:"Тип",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1023,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1024",code:"value",name:"Значение",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1024,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1025",code:"currency",name:"Валюта",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1025,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1026",code:"type",name:"Id валюты из справочника Currency",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1026,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1027",code:"isoType",name:"Код валюты",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1027,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1028",code:"date",name:"Дата курса валюты",description:"Тип: date, Группа: стоимость. Валюта",isActive:!0,sortOrder:1028,metadata:{type:"date",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1029",code:"rate",name:"Курс валюты к рублю на дату оценки",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1029,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1030",code:"name",name:"Наименование",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1030,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1031",code:"date",name:"Дата оценки",description:"Тип: date, Группа: стоимость",isActive:!0,sortOrder:1031,metadata:{type:"date",group:"стоимость",required:!1,section:""}},{id:"attr-1032",code:"discount",name:"Дисконт",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1032,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1033",code:"message",name:'Признак "по ВНД переоценка не требуется"',description:"Тип: boolean, Группа: стоимость",isActive:!0,sortOrder:1033,metadata:{type:"boolean",group:"стоимость",required:!1,section:""}},{id:"attr-1034",code:"subjectValuation",name:"Субъект оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1034,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1035",code:"subjectAssessment",name:"Субъект залоговой экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1035,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1036",code:"__",name:"Сотрудник проводивший оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1036,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1037",code:"____",name:"Наименование структурного подразделения Банка, проводившего оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1037,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1038",code:"status",name:"Статус залога",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1038,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1039",code:"category",name:"Категория качества",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1039,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1040",code:"type",name:"Тип субъекта оценки",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1040,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1041",code:"name",name:"Наименование субъекта оценки",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1041,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1042",code:"inn",name:"ИНН независимого оценщика",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1042,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1043",code:"number",name:"Номер",description:"Тип: text, Группа: Отчет об оценке",isActive:!0,sortOrder:1043,metadata:{type:"text",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1044",code:"attr_1044",name:"Дата",description:"Тип: date, Группа: Отчет об оценке",isActive:!0,sortOrder:1044,metadata:{type:"date",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1045",code:"verificationPerformerName",name:"Субъект верификации Отчета",description:"Тип: text, Группа: Отчет об оценке",isActive:!0,sortOrder:1045,metadata:{type:"text",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1046",code:"documentType",name:"Документ оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1046,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1047",code:"assessmentAuthority",name:"Субъект залоговой экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1047,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1048",code:"isValuationRequired",name:"Признак переоценки",description:"Тип: boolean, Группа: Оценка",isActive:!0,sortOrder:1048,metadata:{type:"boolean",group:"Оценка",required:!1,section:""}},{id:"attr-1049",code:"name",name:"Название компании",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1049,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1050",code:"inn",name:"ИНН организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1050,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1051",code:"address",name:"Юридический адрес организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1051,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1052",code:"email",name:"Адрес электронной почты организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1052,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1053",code:"director",name:"Руководитель организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1053,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1054",code:"website",name:"Официальный вебсайт компании",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1054,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1055",code:"note",name:"Примечания",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1055,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1056",code:"jurisdiction",name:"Регионы, с которыми ассоциирована РОК",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1056,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1057",code:"nonresidentialProperty",name:"Флаг, говорящий о том, что РОК поддерживает оценку объектов нежилой недвижимости, в том числе земельных участков",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1057,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1058",code:"residentialPropertyWithLand",name:"Флаг, говорящий о том, что РОК поддерживает оценку жилых домов с земельным участком",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1058,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1059",code:"equipment",name:"Флаг, говорящий о том, что РОК поддерживает оценку оборудования",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1059,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1060",code:"otherMovableProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочего" движимого имущества',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1060,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1061",code:"otherProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочего" имущества',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1061,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1062",code:"otherResidentialProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочих" объектов жилой недвижимости',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1062,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1063",code:"Список документов",name:"documents",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1063,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1064",code:"Id документа в сервисе Оценка",name:"id",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1064,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1065",code:"Тип документа",name:"type",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1065,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1066",code:"Наименование документа",name:"name",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1066,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1067",code:"Дата документа",name:"date",description:"Тип: date, Группа: Список документов",isActive:!0,sortOrder:1067,metadata:{type:"date",group:"Список документов",required:!1,section:""}},{id:"attr-1068",code:"Номер документа",name:"number",description:"Тип: number, Группа: Список документов",isActive:!0,sortOrder:1068,metadata:{type:"number",group:"Список документов",required:!1,section:""}},{id:"attr-1069",code:"Ссылка на документ",name:"link",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1069,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1070",code:"Id документа в сервисе документов",name:"documentId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1070,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1071",code:"Id ПЗ",name:"collateralId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1071,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1072",code:"Id документа в СХК",name:"cssId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1072,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1073",code:"pledgeAgreementId",name:"Идентификатор договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1073,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1074",code:"pledgeAgreementName",name:"Наименование договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1074,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1075",code:"pledgeAgreementNumber",name:"Номер договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1075,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1076",code:"pledgeAgreementStartDate",name:"Дата начала договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1076,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1077",code:"pledgeAgreementDueDate",name:"Дата окончания договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1077,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1078",code:"pledgeAgreementPlanDate",name:"Плановая дата окончания договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1078,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1079",code:"pledgeAgreementAmount",name:"Сумма договора залога в АБС",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1079,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1080",code:"pledgeAgreementCurrency",name:"Валюта договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1080,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1081",code:"loanAgreementId",name:"Идентификатор договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1081,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1082",code:'loanAgreementNumber"',name:"Номер договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1082,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1083",code:"loanAgreementStartDate",name:"Дата начала договора основного обязательства(кредитного) в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1083,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1084",code:"loanAgreementDueDate",name:"Дата окончания договора основного обязательства(кредитного) в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1084,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1085",code:"loanAgreementTerm",name:"Срок в месяцах договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1085,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1086",code:"loanAgreementLink",name:"Процент покрытия договора основного обязательства(кредитного) в АБС",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1086,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1087",code:"registrationNumber",name:"Номер регистрации обременения",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1087,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1088",code:"registrationDate",name:"Дата регистрации обременения",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1088,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1089",code:"accountNumber",name:"Внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1089,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1090",code:"offBalanceCost",name:"Баланс внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1090,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1091",code:"fairCost",name:"Справедливая стоимость категорируемого имущества на договоре залога",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1091,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1092",code:"status",name:"Статус обременения",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1092,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1093",code:"pledgeAccountingStartDate",name:"Дата постановки залога на учет",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1093,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1094",code:"pledgeAccountingRemovalDate",name:"Дата снятия залога с учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1094,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1095",code:"pledgeAgreementType",name:"Тип договора залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1095,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1096",code:"loanAgreementName",name:"Наименование договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1096,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1097",code:"loanAgreementStatus",name:"Статус договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1097,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1098",code:"loanAgreementType",name:"Тип договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1098,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1099",code:"salePoint",name:"Точка продаж в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1099,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1100",code:"linkType",name:"Характер связи залога с договором",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1100,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1101",code:"linkTypeChangeDate",name:"Дата закрытия связи залога с договором",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1101,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1102",code:"offBalanceAccount",name:"Внебалансовый счет",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1102,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1103",code:"idCft",name:"Идентификатор внебалансового счета в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1103,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1104",code:"accountNumber",name:"Внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1104,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1105",code:"offBalanceCost",name:"Баланс внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1105,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1106",code:"pledgeAccountingStartDate",name:"Дата открытия счета учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1106,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1107",code:"pledgeAccountingRemovalDate",name:"Дата закрытия счета учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1107,metadata:{type:"date",group:"Прочие",required:!1,section:""}}],createdAt:t,updatedAt:t},{id:"dict-collateral-attributes-zalog",name:"Атрибуты залога",code:"collateral_attributes_zalog",description:"Справочник атрибутов залога из файла atr1.xlsx",items:[{id:"zalog-attr-1",code:"GROUP_WHICH_CULTURE_BELONGS",name:"Группа, к которой относится культура",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:1,metadata:{type:"string",group:"Будущий урожай",required:!0,section:"4.10",naturalKey:!0}},{id:"zalog-attr-2",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:2,metadata:{type:"string",group:"Будущий урожай",required:!0,section:"4.10",naturalKey:!0}},{id:"zalog-attr-3",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:3,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-4",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: BOOLEAN",isActive:!0,sortOrder:4,metadata:{type:"boolean",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-5",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:5,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-6",code:"GROUP_WHICH_CULTURE_BELONGS_OTHER",name:"Группа, к которой относится культура, иное",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:6,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-7",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:7,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-8",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:8,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-9",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:9,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-10",code:"QUANTITY",name:"Количество слитков, шт.",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:10,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-11",code:"WEIGHT",name:"Масса, г.",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:11,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-12",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:12,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-13",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:13,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-14",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:14,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-15",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: BOOLEAN",isActive:!0,sortOrder:15,metadata:{type:"boolean",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-16",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:16,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-17",code:"NUMBER_OF_DOCUMENT_OF_INTEL_ACT",name:"Номер документа, удостоверяющего исключительное право на результат интеллектуальной деятельности",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:17,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!0,section:"4.12",naturalKey:!0}},{id:"zalog-attr-18",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:18,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-19",code:"REGISTRATION_NUMBER_OF_RIGHTS",name:"Регистрационный номер прав на интеллектуальную собственность",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:19,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-20",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:20,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-21",code:"RIGHTS_EXPIRATION_DATE",name:"Дата окончания прав на результат интеллектуальной собственностиа",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: DATE",isActive:!0,sortOrder:21,metadata:{type:"date",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-22",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: BOOLEAN",isActive:!0,sortOrder:22,metadata:{type:"boolean",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-23",code:"NUMBER_OF_PLEDGE_ACCOUNT",name:"Номер залогового счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:23,metadata:{type:"string",group:"Права по договору банковского счета",required:!0,section:"4.13",naturalKey:!0}},{id:"zalog-attr-24",code:"SUM_OF_DEPOSIT",name:"Сумма депозита/вклада, передаваемая в залог",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: NUMBER",isActive:!0,sortOrder:24,metadata:{type:"number",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-25",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:25,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-26",code:"DATEEND_OF_ARRENGEMENT",name:"Дата окончания договора депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:26,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-27",code:"NAME_OF_BANK",name:"Наименование банка, в котором открыт депозит/вклад",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:27,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-28",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:28,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-29",code:"DATE_OF_ARRENGEMENT",name:"Дата заключения договора депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:29,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-30",code:"PR_OF_PLEDGE_ACCOUNT",name:"Признак наличия залогового счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:30,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-31",code:"BANK_ACCOUNT_AGREEMENT_DATE",name:"Дата договора банковского счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:31,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-32",code:"BANK_ACCOUNT_AGREEMENT_NUMBER",name:"Номер договора банковского счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:32,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-33",code:"INFORMATION_ABOUT_AMOUNT_MONEY",name:"Сведения о денежной сумме",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:33,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-34",code:"CURRENCY_OF_SUM",name:"Валюта депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:34,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-35",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: BOOLEAN",isActive:!0,sortOrder:35,metadata:{type:"boolean",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-36",code:"ACC_NUM_FOR_ACC_OF_DEP",name:"Номер счета по учету депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:36,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-37",code:"ID_OOO",name:"id клиента",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:37,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-38",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:38,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14",naturalKey:!0}},{id:"zalog-attr-39",code:"SHARE_INFORMATION",name:"Значение идентификационного кода ООО",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:39,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14",naturalKey:!0}},{id:"zalog-attr-40",code:"NAME_OOO",name:"Наименование ООО",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:40,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-41",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: NUMBER",isActive:!0,sortOrder:41,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-42",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: BOOLEAN",isActive:!0,sortOrder:42,metadata:{type:"boolean",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-43",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:43,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-44",code:"TYPE_CODE_OOO",name:"Тип идентификационного кода субъекта (ООО)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: DIRECTORY",isActive:!0,sortOrder:44,metadata:{type:"directory",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-45",code:"PERCENTAGE_AUTHORIZED_CAPITAL",name:"Процент уставного капитала общества с ограниченной ответственностью, который составляет доля (часть доли)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: NUMBER",isActive:!0,sortOrder:45,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-46",code:"ID_OOO",name:"Идентификационный код субъекта (ООО) или ID субъекта (ООО)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:46,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-47",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:47,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-48",code:"NUMBER_OF_VEKSEL",name:"Номер векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:48,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-49",code:"RELEASE_DATE_VEKSEL",name:"Дата выпуска векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE; Ключевой атрибут: Да",isActive:!0,sortOrder:49,metadata:{type:"date",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-50",code:"INN_ISSUER",name:"Значение идентификационного  кода субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:50,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-51",code:"DENOMINATION_VEKSEL",name:"Номинал векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:51,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-52",code:"NUMBER_BLANK_OF_VEKSEL",name:"Номер бланка векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:52,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-53",code:"SERIA_VEKSEL",name:"Серия векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:53,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-54",code:"CODE_VEKSELEDERZHATEL_NONRESIDENT",name:"Признак кода векселедержателя (собственника) нерезидента",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:54,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-55",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:55,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-56",code:"VALUE_DEPOSITORY",name:"Значение идентификационного  кода субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:56,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-57",code:"CURRENCY_CODE_VEKSEL",name:"Код валюты векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:57,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-58",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:58,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-59",code:"NAME_DEPOSITORY",name:"Наименование субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:59,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-60",code:"SUBJECT_AVALIZATION",name:"Субъект авалирования/акцептования векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:60,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-61",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:61,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-62",code:"NAME_ISSUER",name:"Наименование субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:62,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-63",code:"VEKSEL_TYPE",name:"Тип векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:63,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-64",code:"VEKSEL_CURRENCY",name:"Валюта векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:64,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-65",code:"VEKSELEDATEL",name:"Векселедатель",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:65,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-66",code:"VEKSELEDERZHATEL",name:"Векселедержатель",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:66,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-67",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:67,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-68",code:"PERCENT_OF_VEKSEL",name:"Процентная ставка по векселю",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: NUMBER",isActive:!0,sortOrder:68,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-69",code:"VEKSEL_SIGN",name:"Признак векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:69,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-70",code:"DISCOUNT_OF_VEKSEL",name:"Дисконт по векселю",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: NUMBER",isActive:!0,sortOrder:70,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-71",code:"MATURITY_OF_VEKSEL",name:"Срок погашения векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:71,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-72",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:72,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-73",code:"PLACE_OF_COMPILATION",name:"Место составления",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:73,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-74",code:"PLACE_OF_PAYMENT",name:"Место платежа",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:74,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-75",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:75,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-76",code:"SIGN_LEGAL_VEKSELEDATEL",name:"Признак юр. лица субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:76,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-77",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:77,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-78",code:"VEKSEL_CONDITION",name:"Состояние векселя на отчетную дату",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:78,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-79",code:"RECEIPT_DATE",name:"Дата поступления",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:79,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-80",code:"TERM_CONDITIONS_PAYMENT",name:"Срок и условия платежа (Дата 2)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:80,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-81",code:"CONDITIONS_PAYMENT",name:"Условия платежа",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:81,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-82",code:"SECURITY_TYPE",name:"Код типа ценной бумаги",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:82,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-83",code:"OKSM_COUNTRY_VEKSELEDATEL",name:"Код ОКСМ страны векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:83,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-84",code:"OGRN_VEKSELEDATEL",name:"ОГРН векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:84,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-85",code:"TYPE_CODE_VEKSELEDATEL",name:"Тип идентификационного кода субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:85,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-86",code:"CODE_VEKSELEDATEL_NONRESIDENT",name:"Признак кода векселедателя нерезидента",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:86,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-87",code:"SIGN_VEKSELEDATEL",name:"Признак векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:87,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-88",code:"ID_VEKSEL",name:"Идентификационный код векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:88,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-89",code:"ID_VEKSELEDATEL",name:"Идентификационный код субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:89,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-90",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:90,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-91",code:"TYPE_DEPOSITORY",name:"Тип идентификационного кода субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:91,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-92",code:"LOCATION_OF_VEKSEL",name:"Местонахождения векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:92,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-93",code:"ID_DEPOSITORY",name:"Идентификационный код субъекта (депозитария) или ID субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:93,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-97",code:"RATING_VEKSEL",name:"Номинал векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:97,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-98",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:98,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!0,section:"4.16",naturalKey:!0}},{id:"zalog-attr-99",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:99,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-100",code:"GOVERNMENT_NUM_OF_SECURITIES",name:"Государственный регистрационный номер выпуска ценных бумаг",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:100,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-101",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:101,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-102",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DATE",isActive:!0,sortOrder:102,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-103",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:103,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-104",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:104,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-105",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:105,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-106",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:106,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-107",code:"ISSUE_SECURITY_TYPE",name:"Код типа эмиссионной ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:107,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-108",code:"COUNTRY_CODE_ISSUER",name:"Код ОКСМ страны эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:108,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-109",code:"OGRN_ISSUER",name:"ОГРН эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:109,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-110",code:"KPP_ISSUER",name:"КПП эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:110,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-111",code:"CODE_ISSUER_NONRESIDENT",name:"Признак кода эмитента нерезидента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:111,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-112",code:"SIGN_ISSUER",name:"Признак эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:112,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-113",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:113,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-114",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:114,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-115",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:115,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-116",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:116,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-117",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:117,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-118",code:"AMOUNT_OF_SECURITIES",name:"Количество эмиссионных ценных бумаг, шт.",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: NUMBER",isActive:!0,sortOrder:118,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-119",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:119,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-120",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:120,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-121",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: NUMBER",isActive:!0,sortOrder:121,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-122",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:122,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-123",code:"ID_NUM_SECURITIES",name:"Идентификационный номер выпуска ценных бумаг",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:123,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-124",code:"CLASS_SECURITIES",name:"Класс ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:124,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-125",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:125,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-126",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DATE",isActive:!0,sortOrder:126,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-127",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:127,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-128",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:128,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-129",code:"REG_NUM_OF_PIE_FUND",name:"Регистрационный номер правил доверительного управления паевым инвестиционным фондом",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:129,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17",naturalKey:!0}},{id:"zalog-attr-130",code:"AMOUNT_OF_PIES",name:"Количество паев паевого инвестиционного фонда, шт.",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:130,metadata:{type:"number",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17",naturalKey:!0}},{id:"zalog-attr-131",code:"DATE_END_CONTRACT_OF_PIE_FUND",name:"Дата окончания срока действия договора доверительного управления паевым инвестиционным фондом",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: DATE",isActive:!0,sortOrder:131,metadata:{type:"date",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-132",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: BOOLEAN",isActive:!0,sortOrder:132,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-133",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: BOOLEAN",isActive:!0,sortOrder:133,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-134",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:134,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-135",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:135,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-136",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:136,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-137",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:137,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-138",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:138,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-139",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:139,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-140",code:"IND_DES_OF_MORTG_PART_CERT",name:"Индивидуальное обозначение ипотечных сертификатов участия",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:140,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!0,section:"4.18",naturalKey:!0}},{id:"zalog-attr-141",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:141,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-142",code:"DATE_END_TERM_CONTRACT_TRUST_MANAGEMENT_MORTGAGE_COVERAGE",name:"Дата окончания срока действия договора доверительного управления ипотечным покрытием",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: DATE",isActive:!0,sortOrder:142,metadata:{type:"date",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-143",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:143,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-144",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:144,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-145",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: BOOLEAN",isActive:!0,sortOrder:145,metadata:{type:"boolean",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-146",code:"NUM_OF_MORTG_PART_CERTIF",name:"Количество ипотечных сертификатов участия, шт.",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: NUMBER",isActive:!0,sortOrder:146,metadata:{type:"number",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-147",code:"REGISTR_NUM",name:"Регистрационный номер правил доверительного управления ипотечным покрытием",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:147,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-148",code:"SERIA_SEC_PAPER",name:"Серия ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:148,metadata:{type:"string",group:"Прочие ценные бумаги",required:!0,section:"4.19",naturalKey:!0}},{id:"zalog-attr-149",code:"NUM_SECURITIES",name:"Номер ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:149,metadata:{type:"string",group:"Прочие ценные бумаги",required:!0,section:"4.19",naturalKey:!0}},{id:"zalog-attr-150",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:150,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-151",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:151,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-152",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:152,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-153",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:153,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-154",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:154,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-155",code:"AMOUNT_SHARE",name:"Количество ценных бумаг, шт.",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: NUMBER",isActive:!0,sortOrder:155,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-156",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:156,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-157",code:"TYPE_SECURITIES",name:"Вид ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:157,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-158",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: NUMBER",isActive:!0,sortOrder:158,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-159",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:159,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-160",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:160,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-161",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:161,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-162",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:162,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-163",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:163,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-164",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:164,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-165",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DATE",isActive:!0,sortOrder:165,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-166",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:166,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-167",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:167,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-168",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DATE",isActive:!0,sortOrder:168,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-169",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:169,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-170",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:170,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-171",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:171,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-172",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:172,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-174",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:174,metadata:{type:"string",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!0,section:"4.2",naturalKey:!0}},{id:"zalog-attr-175",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:175,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-176",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:176,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-177",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:177,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-178",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:178,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!0,section:"4.20",naturalKey:!0}},{id:"zalog-attr-179",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:179,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!0,section:"4.20",naturalKey:!0}},{id:"zalog-attr-180",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:180,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-181",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:181,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-182",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: BOOLEAN",isActive:!0,sortOrder:182,metadata:{type:"boolean",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-183",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:183,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-184",code:"DATE_CONTRACT",name:"Дата договора/ контакта/ доп соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: DATE",isActive:!0,sortOrder:184,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-185",code:"SUBJECT_OF_CONTRACT",name:"Предмет контракта/договора",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:185,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-186",code:"COUNTERPARTY_UNDER_CONTRACT",name:"Контрагент по договору/контракту",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:186,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-187",code:"NUMBER_CONTRACT",name:"Номер договора/контракта/доп. соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:187,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-188",code:"DATE_END_CONTRACT",name:"Дата окончания срока действия договора/ контракта/ доп соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: DATE",isActive:!0,sortOrder:188,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-189",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:189,metadata:{type:"string",group:"Здание",required:!0,section:"4.2.1",naturalKey:!0}},{id:"zalog-attr-190",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:190,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-191",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:191,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-192",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:192,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-193",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:193,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-194",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:194,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-195",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:195,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-196",code:"STREET",name:"Улица",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:196,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-197",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:197,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-198",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:198,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-199",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:199,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-200",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:200,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-201",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:201,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-202",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:202,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-203",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:203,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-204",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:204,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-205",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:205,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-206",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:206,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-207",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:207,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-208",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:208,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-209",code:"BUILDING",name:"дом",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:209,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-210",code:"INDEX",name:"Индекс",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:210,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-211",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:211,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-212",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:212,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-213",code:"ROOM",name:"Квартира",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:213,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-214",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:214,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-215",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:215,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-216",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:216,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-217",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:217,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-218",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:218,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-219",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:219,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-220",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:220,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-221",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:221,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-222",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:222,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-223",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:223,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-224",code:"LETTER",name:"Литера",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:224,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-225",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:225,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-226",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:226,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-227",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:227,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-228",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:228,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-229",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:229,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-230",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:230,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-231",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:231,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-232",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:232,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-233",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:233,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-234",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:234,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-235",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:235,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-236",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:236,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-237",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:237,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-238",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:238,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-239",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:239,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-240",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:240,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-241",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:241,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-242",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:242,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-243",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:243,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-244",code:"REGION",name:"Регион",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:244,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-245",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:245,metadata:{type:"string",group:"Прочие движимые вещи",required:!0,section:"4.21",naturalKey:!0}},{id:"zalog-attr-246",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:246,metadata:{type:"string",group:"Прочие движимые вещи",required:!0,section:"4.21",naturalKey:!0}},{id:"zalog-attr-247",code:"LOCATION_OTHER_MOVABLE_PROPERTY",name:"Местонахождение прочего движимого имущества",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:247,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-248",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: BOOLEAN",isActive:!0,sortOrder:248,metadata:{type:"boolean",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-249",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:249,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-250",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:250,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-251",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:251,metadata:{type:"string",group:"Сооружение",required:!0,section:"4.2.2",naturalKey:!0}},{id:"zalog-attr-252",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:252,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-253",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:253,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-254",code:"STREET",name:"Улица",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:254,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-255",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:255,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-256",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:256,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-257",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:257,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-258",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:258,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-259",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:259,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-260",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:260,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-261",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:261,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-262",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:262,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-263",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:263,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-264",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:264,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-265",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:265,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-266",code:"INDEX",name:"Индекс",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:266,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-267",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:267,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-268",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:268,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-269",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:269,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-270",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:270,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-271",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:271,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-272",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:272,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-273",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:273,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-274",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:274,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-275",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:275,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-276",code:"ROOM",name:"Квартира",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:276,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-277",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:277,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-278",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:278,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-279",code:"BUILDING",name:"дом",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:279,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-280",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:280,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-281",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:281,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-282",code:"REGION",name:"Регион",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:282,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-283",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:283,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-284",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:284,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-285",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:285,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-286",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:286,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-287",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:287,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-288",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:288,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-289",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:289,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-290",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:290,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-291",code:"LETTER",name:"Литера",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:291,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-292",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:292,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-293",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:293,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-294",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:294,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-295",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:295,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-296",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:296,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-297",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:297,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-298",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:298,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-299",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:299,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-300",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:300,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-301",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:301,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-302",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:302,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-303",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:303,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-304",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:304,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-305",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:305,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-306",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:306,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-307",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:307,metadata:{type:"string",group:"Помещение",required:!0,section:"4.2.3",naturalKey:!0}},{id:"zalog-attr-308",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:308,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-309",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:309,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-310",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:310,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-311",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:311,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-312",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:312,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-313",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:313,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-314",code:"REGION",name:"Регион",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:314,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-315",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:315,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-316",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:316,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-317",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:317,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-318",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:318,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-319",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:319,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-320",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:320,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-321",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:321,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-322",code:"STREET",name:"Улица",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:322,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-323",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:323,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-324",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:324,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-325",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:325,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-326",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:326,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-327",code:"INDEX",name:"Индекс",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:327,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-328",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:328,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-329",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:329,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-330",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:330,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-331",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:331,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-332",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:332,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-333",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:333,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-334",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:334,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-335",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:335,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-336",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:336,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-337",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:337,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-338",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:338,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-339",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:339,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-340",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:340,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-341",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:341,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-342",code:"LETTER",name:"Литера",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:342,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-343",code:"BUILDING",name:"дом",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:343,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-344",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:344,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-345",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:345,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-346",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:346,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-347",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:347,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-348",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:348,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-349",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:349,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-350",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:350,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-351",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:351,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-352",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:352,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-353",code:"ROOM",name:"Квартира",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:353,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-354",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:354,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-355",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:355,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-356",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:356,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-357",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:357,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-358",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:358,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-359",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:359,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-360",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:360,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-361",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:361,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-362",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:362,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-363",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:363,metadata:{type:"string",group:"Машино-место",required:!0,section:"4.2.4",naturalKey:!0}},{id:"zalog-attr-364",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:364,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-365",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:365,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-366",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:366,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-367",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:367,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-368",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:368,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-369",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:369,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-370",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:370,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-371",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:371,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-372",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:372,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-373",code:"LETTER",name:"Литера",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:373,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-374",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:374,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-375",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:375,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-376",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:376,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-377",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:377,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-378",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:378,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-379",code:"INDEX",name:"Индекс",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:379,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-380",code:"BUILDING",name:"дом",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:380,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-381",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:381,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-382",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:382,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-383",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:383,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-384",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:384,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-385",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:385,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-386",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:386,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-387",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:387,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-388",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:388,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-389",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:389,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-390",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:390,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-391",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:391,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-392",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:392,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-393",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:393,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-394",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:394,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-395",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:395,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-396",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:396,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-397",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:397,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-398",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:398,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-399",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:399,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-400",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:400,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-401",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:401,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-402",code:"STREET",name:"Улица",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:402,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-403",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:403,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-404",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:404,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-405",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:405,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-406",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:406,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-407",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:407,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-408",code:"REGION",name:"Регион",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:408,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-409",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:409,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-410",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:410,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-411",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:411,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-412",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:412,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-413",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:413,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-414",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:414,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-415",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:415,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-416",code:"ROOM",name:"Квартира",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:416,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-417",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:417,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-418",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:418,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-419",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:419,metadata:{type:"string",group:"Объект незавершенного строительства",required:!0,section:"4.2.5",naturalKey:!0}},{id:"zalog-attr-420",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:420,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-421",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:421,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-422",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:422,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-423",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:423,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-424",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:424,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-425",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:425,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-426",code:"BUILDING",name:"дом",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:426,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-427",code:"INDEX",name:"Индекс",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:427,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-428",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:428,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-429",code:"ROOM",name:"Квартира",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:429,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-430",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:430,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-431",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:431,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-432",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:432,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-433",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:433,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-434",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:434,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-435",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:435,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-436",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:436,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-437",code:"LETTER",name:"Литера",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:437,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-438",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:438,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-439",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:439,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-440",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:440,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-441",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:441,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-442",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:442,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-443",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:443,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-444",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:444,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-445",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:445,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-446",code:"REGION",name:"Регион",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:446,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-447",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:447,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-448",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:448,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-449",code:"STREET",name:"Улица",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:449,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-450",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:450,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-451",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:451,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-452",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:452,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-453",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:453,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-454",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:454,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-455",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:455,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-456",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:456,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-457",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:457,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-458",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:458,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-459",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:459,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-460",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:460,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-461",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:461,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-462",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:462,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-463",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:463,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-464",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:464,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-465",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:465,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-466",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:466,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-467",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:467,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-468",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:468,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-469",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:469,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-470",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:470,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-471",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:471,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-472",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:472,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-473",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:473,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-474",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:474,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-475",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:475,metadata:{type:"string",group:"Земельный участок",required:!0,section:"4.2.6",naturalKey:!0}},{id:"zalog-attr-476",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:476,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-477",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:477,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-478",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:478,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-479",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:479,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-480",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:480,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-481",code:"TYPE_OF_USE_OF_THE_LAND",name:"Вид разрешенного использования земельного участка",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:481,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-482",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:482,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-483",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:483,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-484",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:484,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-485",code:"INDEX",name:"Индекс",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:485,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-486",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:486,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-487",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:487,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-488",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:488,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-489",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:489,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-490",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:490,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-491",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DIRECTORY",isActive:!0,sortOrder:491,metadata:{type:"directory",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-492",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:492,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-493",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:493,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-494",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:494,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-495",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:495,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-496",code:"ROOM",name:"Квартира",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:496,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-497",code:"AREA_DEVIATION",name:"Отклонение площади, +/-, (м²)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:497,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-498",code:"LETTER",name:"Литера",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:498,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-499",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:499,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-500",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:500,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-501",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:501,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-502",code:"BUILDINGS_NOT_INCLUDED",name:"Признак наличия на земельном участке зданий/ строений/ сооружений Залогодателя, не включенных в предмет ипотеки",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:502,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-503",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:503,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-504",code:"NAME_LANDLORD",name:"Наименование арендодателя",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:504,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-505",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:505,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-506",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:506,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-507",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:507,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-508",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:508,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-509",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:509,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-510",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:510,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-511",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DIRECTORY",isActive:!0,sortOrder:511,metadata:{type:"directory",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-512",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:512,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-513",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:513,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-514",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:514,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-515",code:"REGION",name:"Регион",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:515,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-516",code:"STREET",name:"Улица",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:516,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-517",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:517,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-518",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:518,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-519",code:"BUILDING",name:"дом",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:519,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-520",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:520,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-521",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:521,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-522",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:522,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-523",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:523,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!0,section:"4.2.7",naturalKey:!0}},{id:"zalog-attr-524",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:524,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-525",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:525,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-526",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:526,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-527",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:527,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-528",code:"BUILDING",name:"дом",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:528,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-529",code:"INDEX",name:"Индекс",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:529,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-530",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:530,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-531",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:531,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-532",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:532,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-533",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:533,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-534",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:534,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-535",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:535,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-536",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:536,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-537",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:537,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-538",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:538,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-539",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:539,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-540",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:540,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-541",code:"LETTER",name:"Литера",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:541,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-542",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:542,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-543",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:543,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-544",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:544,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-545",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:545,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-546",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:546,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-547",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:547,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-548",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:548,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-549",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:549,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-550",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:550,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-551",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:551,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-552",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:552,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-553",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:553,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-554",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:554,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-555",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:555,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-556",code:"STREET",name:"Улица",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:556,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-557",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:557,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-558",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:558,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-559",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:559,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-560",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:560,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-561",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:561,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-562",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:562,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-563",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:563,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-564",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:564,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-565",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:565,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-566",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:566,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-567",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:567,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-568",code:"REGION",name:"Регион",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:568,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-569",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:569,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-570",code:"ROOM",name:"Квартира",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:570,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-571",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:571,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-572",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:572,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-573",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:573,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-574",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:574,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-575",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:575,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-576",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:576,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-577",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:577,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-578",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:578,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-579",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:579,metadata:{type:"string",group:"Имущественный комплекс",required:!0,section:"4.2.8",naturalKey:!0}},{id:"zalog-attr-580",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:580,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-581",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:581,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-582",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:582,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-583",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:583,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-584",code:"INDEX",name:"Индекс",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:584,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-585",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:585,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-586",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:586,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-587",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:587,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-588",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:588,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-589",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:589,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-590",code:"BUILDING",name:"дом",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:590,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-591",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:591,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-592",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:592,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-593",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:593,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-594",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:594,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-595",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:595,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-596",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:596,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-597",code:"ROOM",name:"Квартира",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:597,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-598",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:598,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-599",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:599,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-600",code:"REGION",name:"Регион",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:600,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-601",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:601,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-602",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:602,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-603",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:603,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-604",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:604,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-605",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:605,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-606",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:606,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-607",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:607,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-608",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:608,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-609",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:609,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-610",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:610,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-611",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:611,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-612",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:612,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-613",code:"FINANCIAL_MODEL_VALUATION",name:"Оценка с учетом финансовой модели заемщика ('N' - нет, 'Y' - да)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:613,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-614",code:"STREET",name:"Улица",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:614,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-615",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:615,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-616",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:616,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-617",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:617,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-618",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:618,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-619",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:619,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-620",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:620,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-621",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:621,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-622",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:622,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-623",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:623,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-624",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:624,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-625",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:625,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-626",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:626,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-627",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:627,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-628",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:628,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-629",code:"LETTER",name:"Литера",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:629,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-630",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:630,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-631",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:631,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-632",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:632,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-633",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:633,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-634",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:634,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-635",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:635,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-636",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:636,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-637",code:"VIN",name:"VIN",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:637,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-638",code:"FRAME_CHASSIS_NUMBER",name:"Номер шасси/рамы",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:638,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-639",code:"MILEAGE",name:"Пробег, км",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:639,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-640",code:"COLOR_BODY",name:"Цвет кузова (кабины)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:640,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-641",code:"PRICE_OF_NEW_CAR",name:"Цена нового ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:641,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-642",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:642,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-643",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:643,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-644",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:644,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-645",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:645,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-646",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:646,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-647",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:647,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-648",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:648,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-649",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:649,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-650",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:650,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-651",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:651,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-652",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:652,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-653",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:653,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-654",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:654,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-655",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:655,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-656",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:656,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-657",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:657,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-658",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:658,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-659",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:659,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-660",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:660,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-661",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:661,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-662",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:662,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-663",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:663,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-664",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:664,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-665",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:665,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-666",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:666,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-667",code:"ENGINE_VOLUME_SM",name:"Объем двигателя, см3",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:667,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-668",code:"BODY_NUMBER",name:"Номер кузова (кабины, прицепа)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:668,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-669",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:669,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-670",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:670,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-671",code:"MOTOR_NUMBER",name:"Номер двигателя",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:671,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-672",code:"NAME_OF_CERTIFICATE_TS",name:"Наименование свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:672,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-673",code:"NAME_OF_TS",name:"Наименование паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:673,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-674",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:674,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-675",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:675,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-676",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:676,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-677",code:"MODEL",name:"Модель",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:677,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-678",code:"BRAND",name:"Марка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:678,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-679",code:"COUNT_RTA",name:"Количество ДТП",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:679,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-680",code:"ACCIDENT_INVESTIGATION",name:"Следствие ДТП",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:680,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-681",code:"COLLATERAL_CONDITION",name:"Состояние ПЗ",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:681,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-682",code:"IDENTIFIED_DEFECTS",name:"Выявленные дефекты",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:682,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-683",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:683,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-684",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:684,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-685",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:685,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-686",code:"DATE_OF_CERTIFICATE_TS",name:"Дата свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:686,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-687",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:687,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-688",code:"DATE_OF_PASSPORT_TS",name:"Дата паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:688,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-689",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:689,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-690",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:690,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-691",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:691,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-692",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:692,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-693",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:693,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-694",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:694,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-695",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:695,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-696",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:696,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-697",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:697,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-698",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:698,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-699",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:699,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-700",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:700,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-701",code:"TYPE_INCIDENTS",name:"Тип происшествия",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:701,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-702",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:702,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-703",code:"MOTOR_TYPE",name:"Тип двигателя",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:703,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-704",code:"SERIA_NUMBER_OF_CERTIFICATE_TS",name:"Серия и номер свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:704,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-705",code:"SERIAS_NUMBER_PASSPORT_TS",name:"Серия и номер паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:705,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-706",code:"STATE",name:"Состояние",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:706,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-707",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:707,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-708",code:"PSEUDO_KEY",name:"Операция между группой 1 и 2(псевдо атрибут)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:708,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-709",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:709,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-710",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:710,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-711",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:711,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-712",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:712,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-713",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:713,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-714",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:714,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-715",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:715,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-716",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:716,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-717",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:717,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-718",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:718,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-719",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:719,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-720",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:720,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-721",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:721,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-722",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:722,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-723",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:723,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-724",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:724,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-725",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:725,metadata:{type:"directory",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-726",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:726,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-727",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:727,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-728",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:728,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-729",code:"MODEL",name:"Модель",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:729,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-730",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:730,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-731",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:731,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-732",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:732,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-733",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:733,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-734",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:734,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-735",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:735,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-736",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:736,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-737",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:737,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-738",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:738,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-739",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: NUMBER",isActive:!0,sortOrder:739,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-740",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:740,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-741",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:741,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-742",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:742,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-743",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:743,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-744",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:744,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-745",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:745,metadata:{type:"directory",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-746",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: NUMBER",isActive:!0,sortOrder:746,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-747",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:747,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-748",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:748,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-749",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:749,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-750",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:750,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-751",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:751,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-752",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:752,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-753",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:753,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-754",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:754,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-755",code:"BRAND",name:"Марка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:755,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-756",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:756,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-757",code:"SERIAL_FACTORY_NUMBER",name:"Серийный (заводской) номер",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:757,metadata:{type:"string",group:"Воздушные суда",required:!0,section:"4.5",naturalKey:!0}},{id:"zalog-attr-758",code:"GLIDER_NUMBER",name:"Номер планера",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:758,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-759",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:759,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-760",code:"NAME_OF_MANUFACTURER",name:"Наименование изготовителя",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:760,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-761",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:761,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-762",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:762,metadata:{type:"boolean",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-763",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: NUMBER",isActive:!0,sortOrder:763,metadata:{type:"number",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-764",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:764,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-765",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:765,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-766",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Плавучие сооружения; Раздел отчета: 4.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:766,metadata:{type:"string",group:"Плавучие сооружения",required:!0,section:"4.6",naturalKey:!0}},{id:"zalog-attr-767",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Плавучие сооружения; Раздел отчета: 4.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:767,metadata:{type:"string",group:"Плавучие сооружения",required:!0,section:"4.6",naturalKey:!0}},{id:"zalog-attr-768",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:768,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!0,section:"4.6.2",naturalKey:!0}},{id:"zalog-attr-769",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: NUMBER",isActive:!0,sortOrder:769,metadata:{type:"number",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-770",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:770,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-771",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:771,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-772",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:772,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-773",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:773,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-774",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:774,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-775",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:775,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-776",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:776,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-777",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:777,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-778",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:778,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-779",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:779,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-780",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:780,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-781",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: NUMBER",isActive:!0,sortOrder:781,metadata:{type:"number",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-782",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:782,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-783",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:783,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-784",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:784,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-785",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:785,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!0,section:"4.6.4",naturalKey:!0}},{id:"zalog-attr-786",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:786,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-787",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:787,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-788",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:788,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-789",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:789,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-790",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:790,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-791",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: NUMBER",isActive:!0,sortOrder:791,metadata:{type:"number",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-792",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:792,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-793",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:793,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-794",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:794,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-795",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:795,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-796",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:796,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!0,section:"4.6.3",naturalKey:!0}},{id:"zalog-attr-797",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:797,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-798",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:798,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-799",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:799,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-800",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:800,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-801",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:801,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-802",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:802,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-803",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:803,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-804",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:804,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-805",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:805,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!0,section:"4.6.5",naturalKey:!0}},{id:"zalog-attr-806",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:806,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-807",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:807,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-808",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:808,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-809",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:809,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-810",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:810,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-811",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: NUMBER",isActive:!0,sortOrder:811,metadata:{type:"number",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-812",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:812,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-813",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:813,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-814",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:814,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-815",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:815,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-816",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: NUMBER",isActive:!0,sortOrder:816,metadata:{type:"number",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-817",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:817,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-818",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:818,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!0,section:"4.6.1",naturalKey:!0}},{id:"zalog-attr-819",code:"PASSENGER_CAPACITY_OF_THE_VESSEL",name:"Пассажировместимость судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:819,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-820",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:820,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-821",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:821,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-822",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:822,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-823",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:823,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-824",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:824,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-825",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:825,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-826",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:826,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-827",code:"NAME_OF_OTHER_TYPE",name:"Наименование иного типа маломерного судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:827,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-828",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:828,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-829",code:"LENGTH_SHIP",name:"Длина судна в метрах",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:829,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-830",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:830,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-831",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:831,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-832",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:832,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-833",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:833,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-834",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:834,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-835",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:835,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-836",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:836,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-837",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:837,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-838",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:838,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-839",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:839,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-840",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:840,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-841",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:841,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-842",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:842,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-843",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:843,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-844",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:844,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-845",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:845,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-846",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:846,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-847",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:847,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-848",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:848,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-849",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:849,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-850",code:"MODEL",name:"Модель",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:850,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-851",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:851,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-852",code:"WEIGHT_OF_SHIP",name:"Масса судна в кг",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:852,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-853",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:853,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-854",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:854,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-855",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:855,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-856",code:"NET_ADDRESS",name:"Сетевой номер",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:856,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!0,section:"4.7",naturalKey:!0}},{id:"zalog-attr-857",code:"RZHD_MPS",name:"Заводской номер/ номер РЖД/МПС",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:857,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!0,section:"4.7",naturalKey:!0}},{id:"zalog-attr-858",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:858,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-859",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:859,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-860",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:860,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-861",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: NUMBER",isActive:!0,sortOrder:861,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-862",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:862,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-863",code:"MODEL",name:"Модель",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:863,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-864",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:864,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-865",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:865,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-866",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:866,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-867",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:867,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-868",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:868,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-869",code:"DATE_WAGON_TECHNICAL_PASSPORT",name:"Дата технического паспорта вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:869,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-870",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:870,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-871",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:871,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-872",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:872,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-873",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:873,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-874",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:874,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-875",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:875,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-876",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:876,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-877",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:877,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-878",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:878,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-879",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:879,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-880",code:"WAGON_TECHNICAL_PASSPORT_NUMBER",name:"Номер технического паспорта вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:880,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-881",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: NUMBER",isActive:!0,sortOrder:881,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-882",code:"ADDRESS_LOCATION",name:"Адрес места нахождения (депо приписки)",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:882,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-883",code:"CARRIAGE_NUMBER",name:"Номер вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:883,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-884",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:884,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-885",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:885,metadata:{type:"string",group:"Космические объекты",required:!0,section:"4.8",naturalKey:!0}},{id:"zalog-attr-886",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:886,metadata:{type:"boolean",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-887",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: NUMBER",isActive:!0,sortOrder:887,metadata:{type:"number",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-888",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING",isActive:!0,sortOrder:888,metadata:{type:"string",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-889",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING",isActive:!0,sortOrder:889,metadata:{type:"string",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-890",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:890,metadata:{type:"string",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-891",code:"NUMBER_OF_PRODUCT_UNITS",name:"Количество единиц измерения товара",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:891,metadata:{type:"number",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-892",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:892,metadata:{type:"string",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-893",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:893,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-894",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:894,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-895",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:895,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-896",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:896,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-897",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:897,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-898",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:898,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-899",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:899,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-900",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:900,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-901",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:901,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-902",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:902,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-903",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:903,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-904",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:904,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-905",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:905,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-906",code:"UNIT",name:"Единица измерения товара",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:906,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-907",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:907,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-908",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:908,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-909",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:909,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-910",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DATE",isActive:!0,sortOrder:910,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-911",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:911,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-912",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:912,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-913",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DATE",isActive:!0,sortOrder:913,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-914",code:"COST_PER_UNIT_OF_MEASURE_GOODS",name:"Стоимость за единицу измерения товара в руб.",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:914,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-915",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:915,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-916",code:"STORAGE_SPACE",name:"Количество места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:916,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-917",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:917,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-918",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DIRECTORY",isActive:!0,sortOrder:918,metadata:{type:"directory",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-919",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: BOOLEAN",isActive:!0,sortOrder:919,metadata:{type:"boolean",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-920",code:"NUMBER_OF_STORAGE_LOCATIONS",name:"Количество мест хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:920,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-921",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DIRECTORY",isActive:!0,sortOrder:921,metadata:{type:"directory",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-922",code:"ACTUAL_BALANCE_OF_GOODS",name:"Фактический остаток товара, тыс.руб.",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:922,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-923",code:"VENDOR_CODE",name:"Артикул",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:923,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-924",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:924,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-925",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:925,metadata:{type:"string",group:"Все имущество залогодателя",required:!0,section:"",naturalKey:!0}},{id:"zalog-attr-926",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:926,metadata:{type:"string",group:"Все имущество залогодателя",required:!0,section:"",naturalKey:!0}},{id:"zalog-attr-927",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Все имущество залогодателя; Тип значения: BOOLEAN",isActive:!0,sortOrder:927,metadata:{type:"boolean",group:"Все имущество залогодателя",required:!1,section:"",naturalKey:!1}},{id:"zalog-attr-928",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING",isActive:!0,sortOrder:928,metadata:{type:"string",group:"Все имущество залогодателя",required:!1,section:"",naturalKey:!1}}],createdAt:t,updatedAt:t}];return this.saveDictionaries(r),r}}const Tn=new PM,Dy=()=>{const e=Tn.getDictionaryByCode("collateral_attributes_zalog");if(!e)return["Недвижимость","Движимое имущество","Имущественные права"];const t=new Set;e.items.forEach(a=>{var n;(n=a.metadata)!=null&&n.group&&t.add(a.metadata.group)});const r=Array.from(t).sort();return r.length===0?["Недвижимость","Движимое имущество","Имущественные права"]:r},Ph=e=>{const t=Tn.getDictionaryByCode("collateral_attributes_zalog");if(!t)return fw(e);let r=t.items.filter(a=>{var n;return((n=a.metadata)==null?void 0:n.group)===e});return r.length===0&&(r=t.items.filter(a=>{var i;const n=((i=a.metadata)==null?void 0:i.group)||"";return n.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(n.toLowerCase())})),r.length===0&&(r=t.items.filter(a=>{const n=a.code||"",i=a.name||"";return n.toLowerCase().includes(e.toLowerCase())||i.toLowerCase().includes(e.toLowerCase())})),r.length===0?fw(e):r.map(a=>{var n,i,o,l,c,A;return{code:a.code||"",name:a.name,type:(((n=a.metadata)==null?void 0:n.type)||"string").toLowerCase(),required:((i=a.metadata)==null?void 0:i.required)===!0||((o=a.metadata)==null?void 0:o.naturalKey)===!0,naturalKey:((l=a.metadata)==null?void 0:l.naturalKey)===!0,group:((c=a.metadata)==null?void 0:c.group)||"",section:((A=a.metadata)==null?void 0:A.section)||""}}).sort((a,n)=>a.naturalKey&&!n.naturalKey?-1:!a.naturalKey&&n.naturalKey?1:a.name.localeCompare(n.name))};function fw(e){return[{code:"NAME_OF_PROPERTY",name:"Наименование объекта",type:"string",required:!0,naturalKey:!0,group:e,section:"main"},{code:"OWNER_TIN",name:"ИНН собственника/залогодателя",type:"string",required:!0,naturalKey:!1,group:e,section:"main"},{code:"ADDRESS_BASE",name:"Адрес объекта",type:"string",required:!0,naturalKey:!1,group:e,section:"main"},{code:"TYPE_COLLATERAL",name:"Тип залога",type:"string",required:!0,naturalKey:!1,group:e,section:"evaluation"},{code:"HAVEL_MARKET",name:"Рыночная стоимость",type:"number",required:!0,naturalKey:!1,group:e,section:"evaluation"}]}const UC=e=>{const t=[],r=[],a=[],n=[],i=["NAME_OF_PROPERTY","OWNER_TIN","ADDRESS_BASE"],o=["TYPE_COLLATERAL","HAVEL_MARKET"];return e.forEach(l=>{i.includes(l.code)?t.push(l):o.includes(l.code)?a.push(l):l.code.includes("DOCUMENT")||l.code.includes("FILE")?n.push(l):r.push(l)}),{main:t,characteristics:r,evaluation:a,documents:n}},QM=({initialValues:e,onSubmit:t,onCancel:r,loading:a=!1})=>{const n=$i(),[i]=re.useForm(),[o,l]=M.useState("1"),[c,A]=M.useState((e==null?void 0:e.cbCode)||0),[d,f]=M.useState(null),[p,u]=M.useState(e==null?void 0:e.propertyType),[g,h]=M.useState(!1),[x,y]=M.useState((e==null?void 0:e.partners)||[]),[v,E]=M.useState(e==null?void 0:e.address),[k,S]=M.useState((e==null?void 0:e.characteristics)||{}),[B,b]=M.useState((e==null?void 0:e.documents)||[]),[O,_]=M.useState(!1),[U,I]=M.useState([]),[R,L]=M.useState(""),N=M.useMemo(()=>g?Dy():[],[g]),P=M.useMemo(()=>p?Ph(p):[],[p]),Q=M.useMemo(()=>UC(P),[P]);M.useEffect(()=>{let we=!0;return(async()=>{try{await Tn.syncCollateralAttributesFromUnified()}catch(se){console.warn("Не удалось синхронизировать атрибуты залога из unified-attributes.json",se)}finally{we&&h(!0)}})(),()=>{we=!1}},[]),M.useEffect(()=>{if(e&&(i.setFieldsValue({...e,egrnStatementDate:e.egrnStatementDate?We(e.egrnStatementDate):void 0}),e.classification)){const we=cw(e.classification.level1,e.classification.level2);f(we)}},[e,i]);const Y=(we,se)=>{i.setFieldsValue({classification:we}),A(se);const He=cw(we.level1,we.level2);f(He),He!==d&&(S({}),i.setFieldsValue({characteristics:{}}))},ee=we=>{u(we),S({}),i.setFieldsValue({characteristics:{}})},V=M.useMemo(()=>{if(!(e!=null&&e.egrnStatementDate)||!e.mainCategory||e.mainCategory!=="real_estate")return!1;const we=We(e.egrnStatementDate);return We().diff(we,"days")>30},[e==null?void 0:e.egrnStatementDate,e==null?void 0:e.mainCategory]),G=()=>{const we=e==null?void 0:e.id,se=(v==null?void 0:v.cadastralNumber)||(k==null?void 0:k.objectCadastralNumber),He=i.getFieldValue("name");n(`/egrn?objectId=${we}&cadastralNumber=${se}&objectName=${encodeURIComponent(He||"")}`),Ne.info("Переход в модуль ЕГРН для заказа выписки")},z=()=>{const we=i.getFieldValue("reference");we?window.open(`#/portfolio?reference=${we}`,"_blank"):Ne.warning("Не указан REFERENCE сделки")};M.useEffect(()=>{O&&(async()=>{try{const se="/",He=new URL(se,window.location.origin),Ee=He.pathname.endsWith("/")?He.pathname:`${He.pathname}/`,pe=`${He.origin}${Ee}portfolioData.json?v=${Date.now()}`,ce=await fetch(pe,{cache:"no-store"});if(ce.ok){const Ge=await ce.json();I(Ge)}}catch(se){console.warn("Не удалось загрузить договоры из портфеля",se)}})()},[O]);const C=we=>{if(i.setFieldsValue({reference:we.reference,contractNumber:we.contractNumber,contractId:we.contractNumber}),we.borrower&&we.inn){const se={id:zi(),type:"legal",role:"owner",organizationName:we.borrower,inn:String(we.inn),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},He=x.filter(Ee=>Ee.role!=="owner");y([...He,se])}if(we.pledger){const se={id:zi(),type:"legal",role:"pledgor",organizationName:we.pledger,inn:String(we.inn||""),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},He=x.filter(Ee=>Ee.role!=="pledgor");y([...He,se])}_(!1),Ne.success("Договор выбран, данные заемщика и залогодателя заполнены")},D=M.useMemo(()=>{if(!R)return U.slice(0,50);const we=R.toLowerCase();return U.filter(se=>{var He,Ee,pe,ce;return((He=se.contractNumber)==null?void 0:He.toLowerCase().includes(we))||((Ee=se.reference)==null?void 0:Ee.toString().toLowerCase().includes(we))||((pe=se.borrower)==null?void 0:pe.toLowerCase().includes(we))||((ce=se.pledger)==null?void 0:ce.toLowerCase().includes(we))}).slice(0,50)},[U,R]),j=()=>{const we=i.getFieldValue("contractId"),se=i.getFieldValue("contractNumber"),He=i.getFieldValue("reference");we?n(`/portfolio?contractId=${we}`):se?n(`/portfolio?contractNumber=${se}`):He?n(`/portfolio?reference=${He}`):Ne.warning("Не указан договор")},K=[{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120},{title:"Номер договора",dataIndex:"contractNumber",key:"contractNumber",width:150},{title:"Заемщик",dataIndex:"borrower",key:"borrower",width:200},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200},{title:"ИНН",dataIndex:"inn",key:"inn",width:120},{title:"Действия",key:"actions",width:100,render:(we,se)=>s.jsx(Be,{type:"link",size:"small",onClick:()=>C(se),children:"Выбрать"})}],W=async()=>{try{const we=await i.validateFields(),se=new Date,He={id:(e==null?void 0:e.id)||zi(),...we,cbCode:c,partners:x,address:v||void 0,characteristics:k,documents:B,propertyType:p,egrnStatementDate:we.egrnStatementDate?we.egrnStatementDate.format("YYYY-MM-DD"):void 0,createdAt:(e==null?void 0:e.createdAt)||se,updatedAt:se};t(He)}catch(we){console.error("Validation failed:",we),Ne.error("Пожалуйста, заполните все обязательные поля")}},Ae=M.useMemo(()=>x.find(we=>we.role==="owner"||we.role==="pledgor"),[x]),ue=M.useMemo(()=>x.find(we=>we.role==="pledgor"),[x]),he=i.getFieldValue("mainCategory")==="real_estate",ve=[{key:"1",label:"Главная",children:s.jsxs("div",{children:[s.jsx(re.Item,{name:"name",label:"Наименование имущества (NAME_OF_PROPERTY)",rules:[{required:!0,message:"Введите наименование"}],children:s.jsx(Re,{placeholder:"Наименование имущества"})}),s.jsx(re.Item,{label:"Адрес",children:s.jsx(UM,{value:v,onChange:E,useDaData:!0,showGeoPicker:!1})}),s.jsx(jt,{orientation:"left",children:"Клиент"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Заемщик",children:s.jsx(Re,{value:(Ae==null?void 0:Ae.organizationName)||`${(Ae==null?void 0:Ae.lastName)||""} ${(Ae==null?void 0:Ae.firstName)||""} ${(Ae==null?void 0:Ae.middleName)||""}`.trim(),disabled:!0,placeholder:"Выберите заемщика во вкладке партнеры"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"ИНН заемщика",children:s.jsx(Re,{value:Ae==null?void 0:Ae.inn,disabled:!0,placeholder:"ИНН"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"Залогодатель (OWNER_TIN)",children:s.jsx(Re,{value:(ue==null?void 0:ue.organizationName)||`${(ue==null?void 0:ue.lastName)||""} ${(ue==null?void 0:ue.firstName)||""} ${(ue==null?void 0:ue.middleName)||""}`.trim(),disabled:!0,placeholder:"Выберите залогодателя во вкладке партнеры"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{label:"ИНН залогодателя (OWNER_TIN)",children:s.jsx(Re,{value:ue==null?void 0:ue.inn,disabled:!0,placeholder:"ИНН залогодателя"})})})]}),s.jsx(re.Item,{name:"propertyType",label:"Тип имущества (из справочника атрибутов залога)",children:s.jsx(Ve,{placeholder:"Выберите тип имущества",onChange:ee,value:p,children:N.map(we=>s.jsx(Ve.Option,{value:we,children:we},we))})}),s.jsx(re.Item,{name:"mainCategory",label:"Основная категория",rules:[{required:!0,message:"Выберите категорию"}],children:s.jsxs(Ve,{placeholder:"Выберите категорию",children:[s.jsx(Ve.Option,{value:"real_estate",children:"Недвижимость"}),s.jsx(Ve.Option,{value:"movable",children:"Движимое имущество"}),s.jsx(Ve.Option,{value:"property_rights",children:"Имущественные права"})]})}),s.jsx(re.Item,{name:"classification",label:"Классификация объекта",rules:[{validator:async(we,se)=>!se||!se.level0||!se.level1||!se.level2?Promise.reject(new Error("Заполните все уровни классификации")):c===0?Promise.reject(new Error("Некорректная комбинация классификации")):Promise.resolve()}],children:s.jsx(NM,{onChange:Y})})]})},{key:"2",label:"Характеристики",children:s.jsxs("div",{children:[s.jsx("p",{style:{marginBottom:16,color:"#666"},children:"Все характеристики объекта согласно справочнику атрибутов залога"}),p?s.jsxs("div",{children:[Q.characteristics.map(we=>s.jsx(re.Item,{name:["characteristics",we.code],label:we.name,rules:we.required?[{required:!0,message:`Заполните ${we.name}`}]:[],children:we.type==="number"?s.jsx(Re,{type:"number",placeholder:we.name}):we.type==="boolean"?s.jsx(ms,{}):we.type==="date"?s.jsx(Dr,{style:{width:"100%"}}):s.jsx(Re,{placeholder:we.name})},we.code)),Q.characteristics.length===0&&s.jsx("p",{style:{color:"#999",textAlign:"center",padding:"20px"},children:"Характеристики определяются после выбора типа имущества на главной вкладке"})]}):s.jsx("p",{style:{color:"#999",textAlign:"center",padding:"20px"},children:"Выберите тип имущества на главной вкладке для отображения характеристик"})]})},{key:"3",label:"Документы",children:s.jsxs("div",{children:[s.jsx(MM,{value:B,onChange:b}),s.jsx(jt,{}),s.jsxs(Te,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Be,{type:"link",icon:s.jsx(go,{}),onClick:z,style:{paddingLeft:0},children:"Перейти в Залоговое досье"}),he&&s.jsxs("div",{children:[s.jsx(re.Item,{name:"egrnStatementDate",label:"Дата выписки ЕГРН",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),V&&s.jsx(re.Item,{children:s.jsx(Be,{type:"primary",danger:!0,icon:s.jsx($1,{}),onClick:G,children:"Заказать выписку ЕГРН (выписка более 30 дней)"})})]})]})]})},{key:"4",label:"Заметки",children:s.jsxs("div",{children:[s.jsx(re.Item,{name:"notes",label:"Комментарии",children:s.jsx(Re.TextArea,{rows:6,placeholder:"Комментарии по данному имуществу"})}),s.jsx(re.Item,{name:"suspensiveConditions",label:"Отлагательные условия",children:s.jsx(Re.TextArea,{rows:6,placeholder:"Отлагательные условия по данному имуществу"})})]})},{key:"5",label:"Оценка",children:s.jsxs("div",{children:[s.jsx(re.Item,{name:"marketValue",label:"Стоимость (рыночная)",children:s.jsx(Re,{type:"number",placeholder:"Рыночная стоимость, руб.",addonAfter:"₽"})}),s.jsx(re.Item,{name:"pledgeValue",label:"Залоговая стоимость",children:s.jsx(Re,{type:"number",placeholder:"Залоговая стоимость, руб.",addonAfter:"₽"})}),s.jsx(re.Item,{name:["characteristics","HAVEL_MARKET"],label:"Наличие ликвидного рынка (HAVEL_MARKET)",valuePropName:"checked",children:s.jsx(ms,{})}),s.jsx(re.Item,{name:["characteristics","TYPE_COLLATERAL"],label:"Тип обеспечения (TYPE_COLLATERAL - основной/дополнительный)",children:s.jsxs(Ve,{placeholder:"Выберите тип обеспечения",children:[s.jsx(Ve.Option,{value:"основной",children:"Основной"}),s.jsx(Ve.Option,{value:"дополнительный",children:"Дополнительный"})]})}),Q.evaluation.map(we=>s.jsx(re.Item,{name:["characteristics",we.code],label:we.name,rules:we.required?[{required:!0,message:`Заполните ${we.name}`}]:[],children:we.type==="number"?s.jsx(Re,{type:"number",placeholder:we.name}):we.type==="boolean"?s.jsx(ms,{}):we.type==="date"?s.jsx(Dr,{style:{width:"100%"}}):s.jsx(Re,{placeholder:we.name})},we.code))]})},{key:"6",label:"Договор",children:s.jsx("div",{children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"middle",children:[s.jsx(Be,{type:"primary",icon:s.jsx(Pa,{}),onClick:()=>_(!0),children:"Выбрать договор из портфеля"}),s.jsx(re.Item,{name:"reference",label:"REFERENCE сделки",children:s.jsx(Re,{placeholder:"REFERENCE сделки из портфеля"})}),s.jsx(re.Item,{name:"contractNumber",label:"Номер договора",children:s.jsx(Re,{placeholder:"Номер договора залога"})}),s.jsx(re.Item,{name:"contractId",label:"ID договора (для навигации)",hidden:!0,children:s.jsx(Re,{})}),(i.getFieldValue("reference")||i.getFieldValue("contractNumber"))&&s.jsx(Be,{type:"default",icon:s.jsx(go,{}),onClick:j,children:"Перейти к договору в портфеле"})]})})},{key:"7",label:"Партнеры",children:s.jsxs("div",{children:[s.jsx("p",{style:{marginBottom:16,color:"#666"},children:"Добавьте информацию о собственниках, залогодателях и других участниках сделки"}),s.jsx(RM,{value:x,onChange:y})]})}];return g?s.jsxs(re,{form:i,layout:"vertical",initialValues:e,size:"middle",style:{padding:"0 8px"},children:[s.jsx(ri,{activeKey:o,onChange:l,items:ve,style:{minHeight:"400px"},size:"small"}),s.jsx("div",{style:{marginTop:16,textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:12,position:"sticky",bottom:0,background:"#fff",zIndex:10},children:s.jsxs(Te,{children:[s.jsx(Be,{onClick:r,icon:s.jsx(vb,{}),children:"Отмена"}),s.jsx(Be,{type:"primary",onClick:W,loading:a,icon:s.jsx(sm,{}),children:e?"Сохранить изменения":"Создать карточку"})]})}),s.jsxs(cr,{title:"Выбор договора из портфеля",open:O,onCancel:()=>_(!1),footer:null,width:800,children:[s.jsx(Re,{placeholder:"Поиск по REFERENCE, номеру договора, заемщику, залогодателю",prefix:s.jsx(Pa,{}),value:R,onChange:we=>L(we.target.value),style:{marginBottom:16}}),s.jsx(ir,{columns:K,dataSource:D,rowKey:we=>`${we.reference}-${we.contractNumber}`,pagination:{pageSize:10},size:"small"})]})]}):null};class qM{constructor(){tr(this,"db",Jr)}async initDatabase(){try{this.db.isOpen()||await this.db.open(),console.log("Inspection database initialized successfully")}catch(t){throw console.error("Failed to initialize inspection database:",t),t}}async getInspections(){try{return await this.db.inspections.toArray()}catch(t){return console.error("Failed to get inspections:",t),[]}}async getInspectionById(t){try{return await this.db.inspections.get(t)}catch(r){console.error("Failed to get inspection:",r);return}}async getInspectionsByCardId(t){try{return await this.db.inspections.where("collateralCardId").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by card ID:",r),[]}}async getInspectionsByType(t){try{return await this.db.inspections.where("inspectionType").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by type:",r),[]}}async getInspectionsByStatus(t){try{return await this.db.inspections.where("status").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by status:",r),[]}}async getInspectionsByInspector(t){try{return await this.db.inspections.where("inspectorId").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by inspector:",r),[]}}async createInspection(t){try{const r=new Date,a={...t,id:`insp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:r,updatedAt:r,history:t.history||[]};return await this.db.inspections.add(a),a.id}catch(r){throw console.error("Failed to create inspection:",r),r}}async generateClientLink(t){try{const r=await this.getInspectionById(t);if(!r)throw new Error("Inspection not found");const a=`${t}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n=new Date;n.setDate(n.getDate()+7);const i="/",o=i.endsWith("/")?i:`${i}/`,l=`${window.location.origin}${o}#/inspection/${a}`;await this.updateInspection(t,{clientLink:l,clientLinkExpiresAt:n,status:"sent_to_client",history:[...r.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"sent_to_client",user:r.createdByUser||"Система",userRole:"creator",comment:"Ссылка отправлена клиенту",status:"sent_to_client"}]});const c=JSON.parse(localStorage.getItem("inspection_tokens")||"{}");return c[a]={inspectionId:t,expiresAt:n.toISOString()},localStorage.setItem("inspection_tokens",JSON.stringify(c)),l}catch(r){throw console.error("Failed to generate client link:",r),r}}async getInspectionByToken(t){try{const a=JSON.parse(localStorage.getItem("inspection_tokens")||"{}")[t];return!a||new Date(a.expiresAt)<new Date?null:await this.getInspectionById(a.inspectionId)||null}catch(r){return console.error("Failed to get inspection by token:",r),null}}async submitForReview(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");await this.updateInspection(t,{status:"submitted_for_review",history:[...a.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"submitted",user:r,userRole:"inspector",comment:"Осмотр отправлен на проверку",status:"submitted_for_review"}]})}catch(a){throw console.error("Failed to submit for review:",a),a}}async approveInspection(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");await this.updateInspection(t,{status:"approved",approvedBy:r,approvedAt:new Date,history:[...a.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"approved",user:r,userRole:"approver",comment:"Осмотр согласован",status:"approved"}]})}catch(a){throw console.error("Failed to approve inspection:",a),a}}async requestRevision(t,r,a){try{const n=await this.getInspectionById(t);if(!n)throw new Error("Inspection not found");await this.updateInspection(t,{status:"needs_revision",revisionRequestedBy:r,revisionRequestedAt:new Date,revisionComment:a,history:[...n.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"revision_requested",user:r,userRole:"reviewer",comment:a||"Требуется доработка",status:"needs_revision"}]})}catch(n){throw console.error("Failed to request revision:",n),n}}async addPhoto(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");const n={id:`photo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...r,takenAt:new Date};await this.updateInspection(t,{photos:[...a.photos||[],n]})}catch(a){throw console.error("Failed to add photo:",a),a}}async updateInspection(t,r){try{if(!await this.db.inspections.get(t))throw new Error("Inspection not found");await this.db.inspections.update(t,{...r,updatedAt:new Date})}catch(a){throw console.error("Failed to update inspection:",a),a}}async deleteInspection(t){try{await this.db.inspections.delete(t)}catch(r){throw console.error("Failed to delete inspection:",r),r}}async deleteInspectionsByCardId(t){try{await this.db.inspections.where("collateralCardId").equals(t).delete()}catch(r){throw console.error("Failed to delete inspections by card ID:",r),r}}async getInspectionStats(){try{const t=await this.db.inspections.toArray(),r={total:t.length,byType:{},byStatus:{},byCondition:{}};return t.forEach(a=>{r.byType[a.inspectionType]=(r.byType[a.inspectionType]||0)+1,r.byStatus[a.status]=(r.byStatus[a.status]||0)+1,r.byCondition[a.condition]=(r.byCondition[a.condition]||0)+1}),r}catch(t){return console.error("Failed to get inspection stats:",t),{total:0,byType:{},byStatus:{},byCondition:{}}}}}const Ba=new qM,KM=Object.freeze(Object.defineProperty({__proto__:null,default:Ba},Symbol.toStringTag,{value:"Module"}));function HM(e){var i,o,l,c,A,d;if(!e)return"default";const t=e.mainCategory,r=((i=e.classification)==null?void 0:i.level0)||((l=(o=e.classification)==null?void 0:o.hierarchy)==null?void 0:l.level0)||"",a=((c=e.classification)==null?void 0:c.level1)||((d=(A=e.classification)==null?void 0:A.hierarchy)==null?void 0:d.level1)||"",n=e.propertyType||"";if(t==="real_estate")return r!=null&&r.includes("Жилая")||r!=null&&r.includes("жилая")?"residential_real_estate":r!=null&&r.includes("Коммерческая")||r!=null&&r.includes("коммерческая")?"commercial_real_estate":"real_estate";if(t==="movable"){const f=(a==null?void 0:a.toLowerCase())||"",p=(n==null?void 0:n.toLowerCase())||"";return f.includes("автомобиль")||f.includes("транспорт")||p.includes("автомобиль")||p.includes("транспорт")?"vehicle":f.includes("оборудование")||p.includes("оборудование")?"equipment":f.includes("судно")||f.includes("морск")||f.includes("речн")||p.includes("судно")||p.includes("морск")||p.includes("речн")?"vessel":f.includes("воздушн")||f.includes("самолет")||f.includes("вертолет")||p.includes("воздушн")||p.includes("самолет")||p.includes("вертолет")?"aircraft":f.includes("железнодорожн")||f.includes("вагон")||f.includes("локомотив")||p.includes("железнодорожн")||p.includes("вагон")||p.includes("локомотив")?"railway":f.includes("самоходн")||f.includes("техника")||p.includes("самоходн")||p.includes("техника")?"self_propelled":f.includes("тмц")||f.includes("товар")||f.includes("материал")||p.includes("тмц")||p.includes("товар")||p.includes("материал")?"inventory":"equipment"}if(t==="property_rights"){const f=(a==null?void 0:a.toLowerCase())||"",p=(n==null?void 0:n.toLowerCase())||"";return f.includes("дол")||f.includes("ук")||p.includes("дол")||p.includes("ук")?"shares":f.includes("товарн")||f.includes("знак")||p.includes("товарн")||p.includes("знак")?"trademark":"property_rights"}return"default"}function GM(e,t){if(!e)return"";switch(HM(e)){case"residential_real_estate":return VM(e);case"commercial_real_estate":return $M(e);case"vehicle":return YM(e);case"equipment":return WM(e);case"vessel":return XM(e,t);case"aircraft":return JM(e,t);case"railway":return ZM(e,t);case"self_propelled":return eP(e);case"inventory":return tP(e);case"shares":return rP(e);case"trademark":return aP(e);default:return""}}const zM=(e,t)=>{var E,k,S,B,b,O;const r=window.open("","_blank");if(!r){alert("Не удалось открыть окно для печати. Разрешите всплывающие окна.");return}const a=(E=t==null?void 0:t.partners)==null?void 0:E.find(_=>_.role==="pledgor"),n=(k=t==null?void 0:t.partners)==null?void 0:k.find(_=>_.role==="owner"),i=a?a.type==="legal"?a.organizationName||"":`${a.lastName||""} ${a.firstName||""} ${a.middleName||""}`.trim():"",o=n?n.type==="legal"?n.organizationName||"":`${n.lastName||""} ${n.firstName||""} ${n.middleName||""}`.trim():"",l=(t==null?void 0:t.pledgeContractId)||((S=t==null?void 0:t.characteristics)==null?void 0:S.pledgeContractNumber)||"",c=((B=t==null?void 0:t.characteristics)==null?void 0:B.pledgeContractDate)||"",A=(t==null?void 0:t.loanContractId)||((b=t==null?void 0:t.characteristics)==null?void 0:b.loanContractNumber)||"",d=((O=t==null?void 0:t.characteristics)==null?void 0:O.loanContractDate)||"",f=e.inspectionMethod||"Визуальный осмотр",p=e.inspectionType==="primary"?"Первичный осмотр":e.inspectionType==="periodic"?"Периодический осмотр":e.inspectionType==="monitoring"?"Мониторинг":e.inspectionType==="unscheduled"?"Внеплановый осмотр":"Выборочный осмотр",u=e.propertyPresence||(e.condition!=="critical"?"Наличие имущества подтверждается":"Наличие имущества не подтверждается"),g=e.propertyCondition||(e.condition==="excellent"?"Имущество в отличном состоянии":e.condition==="good"?"Имущество в хорошем состоянии":e.condition==="satisfactory"?"Имущество в удовлетворительном состоянии":e.condition==="poor"?"Имущество в плохом состоянии":"Имущество в критическом состоянии"),h=e.storageConditions||e.overallCondition||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",x=e.conclusions||e.notes||(e.condition==="critical"?"Предлагаемое в залог имущество не возможно рассмотреть в качестве обеспечения":"Имущество соответствует требованиям для принятия в залог"),y=e.proposals||(e.recommendations&&e.recommendations.length>0?e.recommendations.map(_=>_.description).join("; "):"-"),v=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Акт проверки наличия и состояния залога ${e.id}</title>
      <style>
        @media print {
          @page {
            size: A4;
            margin: 2cm;
          }
        }
        body {
          font-family: 'Times New Roman', serif;
          font-size: 12pt;
          line-height: 1.6;
          margin: 0;
          padding: 20px;
        }
        .header {
          text-align: center;
          margin-bottom: 30px;
        }
        .header .number {
          text-align: right;
          margin-bottom: 10px;
          font-size: 12pt;
        }
        .header h1 {
          font-size: 14pt;
          font-weight: bold;
          margin-bottom: 5px;
          text-transform: uppercase;
        }
        .header .subtitle {
          font-size: 12pt;
          margin-bottom: 20px;
        }
        .section {
          margin-bottom: 20px;
        }
        .section-row {
          margin-bottom: 15px;
          display: flex;
          align-items: flex-start;
        }
        .section-label {
          font-weight: bold;
          min-width: 300px;
          margin-right: 10px;
        }
        .section-value {
          flex: 1;
        }
        .contract-info {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin: 15px 0;
        }
        .contract-block {
          border: 1px solid #000;
          padding: 10px;
        }
        .contract-block .label {
          font-weight: bold;
          margin-bottom: 5px;
        }
        .info-table {
          width: 100%;
          border-collapse: collapse;
          margin-bottom: 15px;
        }
        .info-table td {
          padding: 8px 10px;
          border: 1px solid #000;
          vertical-align: top;
        }
        .info-table td:first-child {
          font-weight: bold;
          width: 40%;
          background-color: #f0f0f0;
        }
        .info-table thead td {
          font-weight: bold;
          background-color: #e8e8e8;
          text-align: center;
          vertical-align: middle;
        }
        .info-table tbody td {
          vertical-align: top;
        }
        .attachment-table {
          width: 100%;
          border-collapse: collapse;
          margin: 15px 0;
          font-size: 9pt;
        }
        .attachment-table td {
          border: 1px solid #000;
          padding: 4px 6px;
          vertical-align: top;
        }
        .attachment-table thead td {
          font-weight: bold;
          background-color: #e8e8e8;
          text-align: center;
          vertical-align: middle;
        }
        .photos-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
          margin: 15px 0;
        }
        .photo-item {
          border: 1px solid #000;
          padding: 5px;
          text-align: center;
        }
        .photo-item img {
          max-width: 100%;
          height: auto;
          max-height: 200px;
        }
        .photo-item .photo-desc {
          font-size: 10pt;
          margin-top: 5px;
        }
        .signatures {
          margin-top: 40px;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 40px;
        }
        .signature-block {
          text-align: left;
        }
        .signature-line {
          border-top: 1px solid #000;
          margin-top: 50px;
          padding-top: 5px;
          min-height: 60px;
        }
        .footer {
          margin-top: 30px;
          font-size: 9pt;
          text-align: left;
          color: #666;
          line-height: 1.4;
        }
        .underline {
          border-bottom: 1px solid #000;
          display: inline-block;
          min-width: 200px;
          margin: 0 5px;
        }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="number">№ <span class="underline">${e.id}</span></div>
        <h1>Акт*</h1>
        <div class="subtitle">проверки наличия и состояния залога</div>
      </div>

      <div class="section">
        <div class="section-row">
          <div class="section-label">Наименование Залогодателя</div>
          <div class="section-value">${i||"________________"}</div>
        </div>
        <div class="section-row">
          <div class="section-label">Наименование Заемщика</div>
          <div class="section-value">${o||"________________"}</div>
        </div>
      </div>

      <div class="section">
        <p>Проведена проверка состояния принятого обеспечения по договору залога: 
        <span class="underline">${l||""}</span> 
        оформленного в обеспечение кредитного договора: 
        <span class="underline">${A||""}</span></p>
        
        <div class="contract-info">
          <div class="contract-block">
            <div class="label">Договор залога</div>
            <div>Номер: ${l||"________________"}</div>
            <div>Дата: ${c?We(c).format("DD.MM.YYYY"):"________________"}</div>
          </div>
          <div class="contract-block">
            <div class="label">Кредитный договор</div>
            <div>Номер: ${A||"________________"}</div>
            <div>Дата: ${d?We(d).format("DD.MM.YYYY"):"________________"}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-row">
          <div class="section-label">Способ проверки:</div>
          <div class="section-value">${f}</div>
        </div>
        <div class="section-row">
          <div class="section-label">Тип осмотра:</div>
          <div class="section-value">${p}</div>
        </div>
      </div>

      <div class="section">
        <p><em>К Акту Проверки прикладывается Приложение 1 с описанием осматриваемого имущества</em></p>
        <p style="font-size: 10pt; color: #666; margin-top: 5px;">
          Приложения к актам осмотра могут дополняться/изменяться и не требуют дополнительного согласования
        </p>
      </div>

      <div class="section">
        <table class="info-table">
          <tr>
            <td>Наличие заложенного имущества</td>
            <td>${u}</td>
          </tr>
          <tr>
            <td>Состояние заложенного имущества</td>
            <td>${g}. ${e.overallCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению"}</td>
          </tr>
          <tr>
            <td>Соответствие условий хранения/эксплуатации заложенного имущества</td>
            <td>${h}</td>
          </tr>
          <tr>
            <td>Выводы</td>
            <td>${x}</td>
          </tr>
          <tr>
            <td>Предложения</td>
            <td>${y}</td>
          </tr>
        </table>
      </div>

      ${e.photos&&e.photos.length>0?`
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Приложение 1. Фотографии осматриваемого имущества (${e.photos.length})</div>
        <div class="photos-grid">
          ${e.photos.map((_,U)=>`
            <div class="photo-item">
              <img src="${_.url}" alt="Фото ${U+1}" />
              <div class="photo-desc">
                ${_.location||_.step||`Фото ${U+1}`}
                ${_.description?`<br>${_.description}`:""}
                ${_.takenAt?`<br>${We(_.takenAt).format("DD.MM.YYYY HH:mm")}`:""}
              </div>
            </div>
          `).join("")}
        </div>
      </div>
      `:""}

      ${GM(t,e)}

      ${e.defects&&e.defects.length>0?`
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Приложение 2. Выявленные дефекты</div>
        <table class="info-table">
          ${e.defects.map((_,U)=>`
            <tr>
              <td>Дефект ${U+1}</td>
              <td>${_.description} (${_.severity})${_.location?`, Местоположение: ${_.location}`:""}</td>
            </tr>
          `).join("")}
        </table>
      </div>
      `:""}

      <div class="section">
        <div class="section-row">
          <div class="section-label">Дата проведения проверки</div>
          <div class="section-value">${We(e.inspectionDate).format("DD.MM.YYYY")}</div>
        </div>
      </div>

      <div class="signatures">
        <div class="signature-block">
          <div class="signature-line">
            Сотрудник проводивший осмотр<br>
            ${e.inspectorName||"________________"}<br>
            ${e.inspectorPosition?`${e.inspectorPosition}`:""}
          </div>
        </div>
        <div class="signature-block">
          <div class="signature-line">
            Руководитель/заместитель руководителя<br>
            ${e.approvedBy||"________________"}<br>
            ${e.approvedAt?We(e.approvedAt).format("DD.MM.YYYY"):""}
          </div>
        </div>
      </div>

      <div class="footer">
        <p>*Акт осмотра составляется в электронном виде, подписывается ЭЦП работника, осуществившим осмотр и его руководителем подразделения. Актуализация данной формы и приложений к ней может проводиться без внесения изменений в настоящее Положение по согласованию с Директором/заместителем директора департамента управления рисками.</p>
        <p style="margin-top: 10px;">Документ сгенерирован автоматически ${We().format("DD.MM.YYYY HH:mm")}</p>
      </div>

      <script>
        window.onload = function() {
          window.print();
        };
      <\/script>
    </body>
    </html>
  `;r.document.write(v),r.document.close()};function VM(e){const t=e.characteristics||{},r=e.address||{},a=r.cadastralNumber||t.cadastralNumber||"",n=t.totalAreaSqm||t.totalArea||"",i=t.buildYear||t.yearOfConstruction||"",o=t.wallMaterial||"",l=t.floorMaterial||t.overlapMaterial||"",c=t.buildingCondition||t.condition||"",A=t.finishLevel||t.finishingLevel||"",d=t.finishCondition||"",f=t.bookValue||t.balanceValue||0;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Жилая недвижимость)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Общая площадь объекта, кв. м.<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Кадастровый номер объекта</td>
            <td style="text-align: center; font-weight: bold;">Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Год строительства</td>
            <td style="text-align: center; font-weight: bold;">Материал стен</td>
            <td style="text-align: center; font-weight: bold;">Материал перекрытий</td>
            <td style="text-align: center; font-weight: bold;">Состояние конструктивных элементов здания</td>
            <td style="text-align: center; font-weight: bold;">Уровень отделки</td>
            <td style="text-align: center; font-weight: bold;">Состояние отделки</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${n||""}</td>
            <td>${a||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
            <td style="text-align: center;">${i||""}</td>
            <td>${o||""}</td>
            <td>${l||""}</td>
            <td>${c||""}</td>
            <td>${A||""}</td>
            <td>${d||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function $M(e){var h,x,y,v,E,k;const t=e.characteristics||{},r=e.address||{},a=r.cadastralNumber||t.cadastralNumber||"",n=t.totalAreaSqm||t.totalArea||"",i=t.buildYear||t.yearOfConstruction||"",o=t.wallMaterial||"",l=t.floorMaterial||t.overlapMaterial||"",c=t.buildingCondition||t.condition||"",A=t.finishLevel||t.finishingLevel||"",d=t.finishCondition||"",f=t.bookValue||t.balanceValue||0,p=((h=e.classification)==null?void 0:h.level1)||((y=(x=e.classification)==null?void 0:x.hierarchy)==null?void 0:y.level1)||"",u=((v=e.classification)==null?void 0:v.level2)||((k=(E=e.classification)==null?void 0:E.hierarchy)==null?void 0:k.level2)||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Коммерческая недвижимость)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Общая площадь объекта, кв. м.<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Кадастровый номер объекта</td>
            <td style="text-align: center; font-weight: bold;">Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Год строительства</td>
            <td style="text-align: center; font-weight: bold;">Материал стен</td>
            <td style="text-align: center; font-weight: bold;">Материал перекрытий</td>
            <td style="text-align: center; font-weight: bold;">Состояние конструктивных элементов здания</td>
            <td style="text-align: center; font-weight: bold;">Уровень отделки</td>
            <td style="text-align: center; font-weight: bold;">Состояние отделки</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||`${p}, назначение: нежилое ${(u==null?void 0:u.toLowerCase())||"здание"}, площадь: ${n||""} кв.м.`}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${n||""}</td>
            <td>${a||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
            <td style="text-align: center;">${i||""}</td>
            <td>${o||""}</td>
            <td>${l||""}</td>
            <td>${c||""}</td>
            <td>${A||""}</td>
            <td>${d||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function YM(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",i=t.vin||t.identificationNumber||"",o=t.chassisNumber||"",l=t.bodyNumber||"",c=t.color||"",A=t.year||t.yearOfManufacture||"",d=t.inventoryNumber||"",f=t.registrationNumber||t.licensePlate||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (автотранспорт)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка</td>
            <td style="text-align: center; font-weight: bold;">Модель ТС</td>
            <td style="text-align: center; font-weight: bold;">Идентификационный номер (VIN)</td>
            <td style="text-align: center; font-weight: bold;">Номер шасси</td>
            <td style="text-align: center; font-weight: bold;">Номер кузова</td>
            <td style="text-align: center; font-weight: bold;">Цвет</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Регистрационный знак</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${i}</td>
            <td>${o}</td>
            <td>${l}</td>
            <td>${c}</td>
            <td style="text-align: center;">${A}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td>${r.fullAddress||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function WM(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",i=t.serialNumber||t.factoryNumber||"",o=t.year||t.yearOfManufacture||"",l=t.manufacturer||"",c=t.country||t.manufacturerCountry||"",A=t.inventoryNumber||"",d=t.bookValue||t.balanceValue||t.residualValue||0,f=t.additionalCharacteristics||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (оборудование)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка</td>
            <td style="text-align: center; font-weight: bold;">Модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Страна - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Производитель</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Остаточная балансовая стоимость, руб.</td>
            <td style="text-align: center; font-weight: bold;">Дополнительные характеристики</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${i}</td>
            <td style="text-align: center;">${o}</td>
            <td>${c}</td>
            <td>${l}</td>
            <td>${A}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${d?d.toLocaleString("ru-RU"):"0.00"}</td>
            <td>${f}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function XM(e,t){const r=e.characteristics||{},a=r.vesselName||e.name||"",n=r.imo||"",i=r.vesselType||"",o=r.callSign||"",l=r.portOfRegistration||"",c=r.placeOfConstruction||"",A=r.yearOfConstruction||"",d=r.hullMaterial||"",f=r.enginesCount||"",p=r.enginesPower||"",u=r.length||"",g=r.width||"",h=r.boardHeight||"",x=r.grossTonnage||"",y=r.netTonnage||"",v=r.deadweight||"",E=r.vesselClass||"",k=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (морские/речные суда)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Состояние имущества</td>
            <td style="text-align: center; font-weight: bold;">Наличие обременений</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена/выявленные разночтения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${`Судно "${a}", ИМО ${n}. Тип судна: ${i}. Позывной сигнал: ${o}. Морской порт регистрации: ${l}. Место и год постройки: ${c}, ${A}. Главный материал корпуса: ${d}. Число и мощность главных двигателей: ${f}, ${p} кВт. Главные размерения: Длина ${u} м. Ширина ${g} м. Высота борта ${h} м. Вместимость валовая ${x}. Вместимость чистая ${y}. Дедвейт ${v} р.т. Класс судна: ${E}.`}</td>
            <td>${(t==null?void 0:t.propertyCondition)||""}</td>
            <td></td>
            <td style="background-color: ${k?"#ffff00":"transparent"};">${k||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function JM(e,t){const r=e.characteristics||{},a=e.address||{},n=r.aircraftType||e.name||"",i=r.serialNumber||r.factoryNumber||"",o=r.gliderNumber||"",l=r.year||r.yearOfManufacture||"",c=r.manufacturer||"",A=r.model||"",d=r.operatingHours||r.flightHours||"",f=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"",p=(t==null?void 0:t.propertyCondition)||"",u=f;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (воздушное судно)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Вид воздушного судна</td>
            <td style="text-align: center; font-weight: bold;">Серийный (заводской номер)</td>
            <td style="text-align: center; font-weight: bold;">Номер планера</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Наименование изготовителя</td>
            <td style="text-align: center; font-weight: bold;">Тип (наименование)</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Наработка /налет часов</td>
            <td style="text-align: center; font-weight: bold;">Работоспособность подтверждена/не подтверждена</td>
            <td style="text-align: center; font-weight: bold;">Наличие/отсутствие повреждений</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${n}</td>
            <td>${i}</td>
            <td>${o}</td>
            <td style="text-align: center;">${l}</td>
            <td>${c}</td>
            <td>${A}</td>
            <td>${a.fullAddress||""}</td>
            <td>${d}</td>
            <td>${f||""}</td>
            <td>${p||""}</td>
            <td>${u||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function ZM(e,t){const r=e.characteristics||{},a=r.make||r.brand||"",n=r.model||"",i=r.serialNumber||r.factoryNumber||"",o=r.year||r.yearOfConstruction||"",l=r.identificationMarks||"",c=r.wagonNumber||"",A=r.depot||"",d=r.inventoryNumber||"",f=r.country||r.manufacturerCountry||"",p=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Железнодорожный транспорт)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка, модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер</td>
            <td style="text-align: center; font-weight: bold;">Год постройки</td>
            <td style="text-align: center; font-weight: bold;">Идентификационные признаки</td>
            <td style="text-align: center; font-weight: bold;">Номер вагона</td>
            <td style="text-align: center; font-weight: bold;">Депо приписки</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Страна - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена /выявленные разночтения</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Комментарии</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a} ${n}</td>
            <td>${i}</td>
            <td style="text-align: center;">${o}</td>
            <td>${l}</td>
            <td>${c}</td>
            <td>${A}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td style="background-color: ${p?"#ffff00":"transparent"};">${p||""}</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function eP(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",i=t.serialNumber||t.factoryNumber||"",o=t.color||"",l=t.year||t.yearOfManufacture||"",c=t.manufacturer||"",A=t.inventoryNumber||"",d=t.registrationNumber||"",f=t.bookValue||t.balanceValue||t.residualValue||0;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Самоходная техника)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка машины</td>
            <td style="text-align: center; font-weight: bold;">Модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер машины (рамы)</td>
            <td style="text-align: center; font-weight: bold;">Цвет</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Предприятие - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Регистрационный знак</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Остаточная балансовая стоимость единицы, руб.</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${i}</td>
            <td>${o}</td>
            <td style="text-align: center;">${l}</td>
            <td>${c}</td>
            <td>${A}</td>
            <td>${d}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function tP(e){const t=e.characteristics||{},r=e.address||{},a=t.unit||t.unitOfMeasurement||"",n=t.quantity||"",i=r.fullAddress||"",o="",l="",c=t.storageLocation||"",A=t.storageSystem||"",d=t.securityAlarm||"",f=t.storageConditions||"",p=t.features||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (ТМЦ)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование имущества/товаров</td>
            <td style="text-align: center; font-weight: bold;">Единица измерения</td>
            <td style="text-align: center; font-weight: bold;">Количество</td>
            <td style="text-align: center; font-weight: bold;">Местонахождение имущества</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Соответствие товара количественным характеристикам</td>
            <td style="text-align: center; font-weight: bold;">Характеристики места хранения</td>
            <td style="text-align: center; font-weight: bold;">Система хранения</td>
            <td style="text-align: center; font-weight: bold;">Наличие охранно-пожарной сигнализации</td>
            <td style="text-align: center; font-weight: bold;">Условия хранения</td>
            <td style="text-align: center; font-weight: bold;">Особенности</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td style="text-align: right;">${n}</td>
            <td>${i}</td>
            <td>${o}</td>
            <td>${l}</td>
            <td>${c}</td>
            <td>${A}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td>${p}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function rP(e){var o;const t=(o=e.partners)==null?void 0:o.find(l=>l.role==="owner"),r=t?t.type==="legal"?t.organizationName||"":`${t.lastName||""} ${t.firstName||""} ${t.middleName||""}`.trim():"",a=(t==null?void 0:t.share)||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (доли в УК)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование собственника</td>
            <td style="text-align: center; font-weight: bold;">Доля в УК</td>
            <td style="text-align: center; font-weight: bold;">Подтверждение собственника и доли в УК выписок из ЕГРЮЛ</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${r}</td>
            <td style="text-align: right;">${a}%</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function aP(e){const t=e.characteristics||{},r=t.certificateNumber||"",a=t.certificateIssuedBy||"",n=e.name||"",i=t.applicationNumber||"",o=t.priority||"",l=t.registrationDate||"",c=t.registrationPeriod||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра на исключительные права на товарные знаки (знаки обслуживания)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Свидетельство на товарный знак (знак обслуживания) (№, кем выдано)</td>
            <td style="text-align: center; font-weight: bold;">Наименование товарного знака (знака обслуживания)</td>
            <td style="text-align: center; font-weight: bold;">Номер заявки</td>
            <td style="text-align: center; font-weight: bold;">Приоритет товарного знака</td>
            <td style="text-align: center; font-weight: bold;">Дата регистрации</td>
            <td style="text-align: center; font-weight: bold;">Срок действия регистрации</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Комментарии</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${r}${a?`, ${a}`:""}</td>
            <td>${n}</td>
            <td>${i}</td>
            <td>${o}</td>
            <td>${l?We(l).format("DD.MM.YYYY"):""}</td>
            <td>${c}</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}const{Text:Lo}=ht,{TextArea:nP}=Re,MC=({visible:e,inspectionId:t,onClose:r,onApprove:a,onRequestRevision:n})=>{var b;const[i,o]=M.useState(null),[l,c]=M.useState(null),[A,d]=M.useState(!1),[f,p]=M.useState("");M.useEffect(()=>{console.log("InspectionCardModal props changed:",{visible:e,inspectionId:t})},[e,t]);const u=M.useCallback(async()=>{if(!t){console.warn("loadInspection called without inspectionId");return}console.log("Loading inspection:",t),d(!0);try{const O=await Ba.getInspectionById(t);if(console.log("Loaded inspection:",O),o(O||null),!O)Ne.warning("Осмотр не найден");else if(O.collateralCardId)try{const _=await kt.getExtendedCardById(O.collateralCardId);_&&c(_)}catch(_){console.error("Failed to load collateral card:",_)}}catch(O){console.error("Ошибка загрузки осмотра:",O),Ne.error("Не удалось загрузить осмотр")}finally{d(!1)}},[t]);M.useEffect(()=>{console.log("InspectionCardModal useEffect:",{visible:e,inspectionId:t}),e&&t?u():(o(null),p(""))},[e,t,u]);const g=()=>{t&&a&&(a(t),u())},h=()=>{t&&n&&f.trim()&&(n(t,f),p(""),u())},x=()=>{i?zM(i,l||void 0):Ne.error("Осмотр не загружен")},y=O=>({scheduled:"blue",sent_to_client:"cyan",in_progress:"orange",submitted_for_review:"purple",needs_revision:"red",approved:"green",completed:"green",cancelled:"red"})[O]||"default",v=O=>({scheduled:"Запланирован",sent_to_client:"Отправлен клиенту",in_progress:"В процессе",submitted_for_review:"На проверке",needs_revision:"Требует доработки",approved:"Согласован",completed:"Завершен",cancelled:"Отменен"})[O]||O,E=O=>{switch(O){case"created":return s.jsx(Vn,{style:{color:"#1890ff"}});case"sent_to_client":return s.jsx(Vn,{style:{color:"#13c2c2"}});case"submitted":return s.jsx(Vn,{style:{color:"#722ed1"}});case"reviewed":return s.jsx(yn,{style:{color:"#52c41a"}});case"approved":return s.jsx(yn,{style:{color:"#52c41a"}});case"revision_requested":return s.jsx(Jl,{style:{color:"#ff4d4f"}});default:return s.jsx(Vn,{})}},k=[{key:"info",label:"Информация",children:i?s.jsxs(ye,{bordered:!0,column:2,children:[s.jsx(ye.Item,{label:"Тип осмотра",children:i.inspectionType}),s.jsx(ye.Item,{label:"Статус",children:s.jsx(Ze,{color:y(i.status),children:v(i.status)})}),s.jsx(ye.Item,{label:"Дата осмотра",children:i.inspectionDate?We(i.inspectionDate instanceof Date?i.inspectionDate:new Date(i.inspectionDate)).format("DD.MM.YYYY HH:mm"):"Не указана"}),s.jsx(ye.Item,{label:"Объект",children:i.collateralName}),s.jsx(ye.Item,{label:"Адрес",children:i.address||"Не указан"}),s.jsxs(ye.Item,{label:"Исполнитель",children:[i.inspectorName,i.inspectorType==="client"&&s.jsx(Ze,{color:"orange",style:{marginLeft:8},children:"Клиент"}),i.inspectorType==="employee"&&s.jsx(Ze,{color:"blue",style:{marginLeft:8},children:"Сотрудник"})]}),i.inspectorPhone&&s.jsx(ye.Item,{label:"Телефон",children:i.inspectorPhone}),i.inspectorEmail&&s.jsx(ye.Item,{label:"Email",children:i.inspectorEmail}),s.jsx(ye.Item,{label:"Состояние",children:s.jsx(Ze,{color:i.condition==="excellent"?"green":i.condition==="good"?"blue":i.condition==="satisfactory"?"orange":"red",children:i.condition})}),i.notes&&s.jsx(ye.Item,{label:"Примечания",span:2,children:i.notes}),i.latitude&&i.longitude&&s.jsx(ye.Item,{label:"Геолокация",span:2,children:s.jsxs(Te,{children:[s.jsx(tl,{}),s.jsxs(Lo,{children:[i.latitude.toFixed(6),", ",i.longitude.toFixed(6)]}),s.jsx(Be,{type:"link",size:"small",onClick:()=>{window.open(`https://yandex.ru/maps/?pt=${i.longitude},${i.latitude}&z=16`,"_blank")},children:"Открыть на карте"})]})})]}):s.jsx(Sr,{description:"Данные не загружены"})},{key:"photos",label:s.jsxs(Te,{children:[s.jsx(Ao,{}),"Фотографии (",((b=i==null?void 0:i.photos)==null?void 0:b.length)||0,")"]}),children:i!=null&&i.photos&&i.photos.length>0?s.jsx(dt,{gutter:[16,16],children:i.photos.map(O=>s.jsx(be,{xs:24,sm:12,md:8,lg:6,children:s.jsx(Ue,{hoverable:!0,cover:s.jsx(im,{src:O.url,alt:O.description||"Фото осмотра",preview:{mask:"Просмотр"},style:{height:200,objectFit:"cover"}}),children:s.jsx(Ue.Meta,{title:O.location||O.step||"Фото",description:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsx(Lo,{type:"secondary",style:{fontSize:12},children:O.takenAt?We(O.takenAt instanceof Date?O.takenAt:new Date(O.takenAt)).format("DD.MM.YYYY HH:mm"):"Не указана"}),O.latitude&&O.longitude&&s.jsxs(Lo,{type:"secondary",style:{fontSize:12},children:[s.jsx(tl,{})," ",O.latitude.toFixed(4),", ",O.longitude.toFixed(4)]}),O.description&&s.jsx(Lo,{style:{fontSize:12},children:O.description})]})})})},O.id))}):s.jsx(Sr,{description:"Фотографии отсутствуют"})},{key:"history",label:"Хронология",children:i!=null&&i.history&&i.history.length>0?s.jsx(Y1,{children:i.history.map(O=>s.jsx(Y1.Item,{dot:E(O.action),children:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs(Te,{children:[s.jsx(Lo,{strong:!0,children:O.user}),s.jsx(Ze,{color:y(O.status),children:v(O.status)})]}),s.jsx(Lo,{type:"secondary",children:O.date?We(O.date instanceof Date?O.date:new Date(O.date)).format("DD.MM.YYYY HH:mm"):"Не указана"}),s.jsx(Lo,{children:O.action==="created"?"Создал осмотр":O.action==="sent_to_client"?"Отправил клиенту":O.action==="submitted"?"Отправил на проверку":O.action==="reviewed"?"Проверил":O.action==="approved"?"Согласовал":O.action==="revision_requested"?"Запросил доработку":O.action}),O.comment&&s.jsx(Lo,{type:"secondary",style:{display:"block",marginTop:4},children:O.comment})]})},O.id))}):s.jsx(Sr,{description:"Хронология отсутствует"})}],S=(i==null?void 0:i.status)==="submitted_for_review",B=(i==null?void 0:i.status)==="submitted_for_review";return console.log("InspectionCardModal render:",{visible:e,inspectionId:t,hasInspection:!!i}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(jr,{}),s.jsx("span",{children:"Карточка осмотра"}),i&&s.jsx(Ze,{color:y(i.status),children:v(i.status)})]}),open:e,onCancel:()=>{console.log("Modal onCancel called"),r()},footer:[s.jsx(Be,{icon:s.jsx(In,{}),onClick:x,children:"Скачать PDF"},"pdf"),B&&s.jsx(Be,{danger:!0,onClick:h,disabled:!f.trim(),children:"Запросить доработку"},"revision"),S&&s.jsx(Be,{type:"primary",onClick:g,children:"Согласовать"},"approve"),s.jsx(Be,{onClick:r,children:"Закрыть"},"close")].filter(Boolean),width:900,className:"inspection-card-modal",children:A?s.jsx(es,{size:"large",style:{display:"block",textAlign:"center",padding:"40px"}}):i?s.jsxs(s.Fragment,{children:[B&&s.jsx(Ue,{size:"small",style:{marginBottom:16},children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Lo,{strong:!0,children:"Комментарий к доработке:"}),s.jsx(nP,{rows:3,value:f,onChange:O=>p(O.target.value),placeholder:"Укажите, что нужно доработать в осмотре"})]})}),s.jsx(ri,{items:k})]}):s.jsx(Sr,{description:"Осмотр не найден"})})},Qh={Здание:{typeName:"Здание",requiresInspection:!0,requiresEgrn:!0},"Земельный участок":{typeName:"Земельный участок",requiresInspection:!0,requiresEgrn:!0},Помещение:{typeName:"Помещение",requiresInspection:!0,requiresEgrn:!0},Сооружение:{typeName:"Сооружение",requiresInspection:!0,requiresEgrn:!0},"Машино-место":{typeName:"Машино-место",requiresInspection:!0,requiresEgrn:!0},"Единый недвижимый комплекс":{typeName:"Единый недвижимый комплекс",requiresInspection:!0,requiresEgrn:!0},"Имущественный комплекс":{typeName:"Имущественный комплекс",requiresInspection:!0,requiresEgrn:!0},"Объект незавершенного строительства":{typeName:"Объект незавершенного строительства",requiresInspection:!0,requiresEgrn:!0},"Недвижимое имущество и права аренды недвижимого имущества":{typeName:"Недвижимое имущество и права аренды недвижимого имущества",requiresInspection:!0,requiresEgrn:!0},"Воздушные суда":{typeName:"Воздушные суда",requiresInspection:!0,requiresEgrn:!1},"Все имущество залогодателя":{typeName:"Все имущество залогодателя",requiresInspection:!0,requiresEgrn:!1},"Железнодорожный подвижной состав":{typeName:"Железнодорожный подвижной состав",requiresInspection:!0,requiresEgrn:!1},"Космические объекты":{typeName:"Космические объекты",requiresInspection:!0,requiresEgrn:!1},"Машины и оборудование":{typeName:"Машины и оборудование",requiresInspection:!0,requiresEgrn:!1},"Наземные безрельсовые механические транспортные средства, прицепы":{typeName:"Наземные безрельсовые механические транспортные средства, прицепы",requiresInspection:!0,requiresEgrn:!1},"Плавучие сооружения":{typeName:"Плавучие сооружения",requiresInspection:!0,requiresEgrn:!1},"Плавучие сооружения, не являющиеся судами":{typeName:"Плавучие сооружения, не являющиеся судами",requiresInspection:!0,requiresEgrn:!1},"Прочие движимые вещи":{typeName:"Прочие движимые вещи",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для иных целей":{typeName:"Суда, используемые для иных целей",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов":{typeName:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для перевозки пассажиров и их багажа":{typeName:"Суда, используемые для перевозки пассажиров и их багажа",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для рыболовства":{typeName:"Суда, используемые для рыболовства",requiresInspection:!0,requiresEgrn:!1},"Товары в обороте":{typeName:"Товары в обороте",requiresInspection:!0,requiresEgrn:!1},"Аффинированные драгоценные металлы в слитках":{typeName:"Аффинированные драгоценные металлы в слитках",requiresInspection:!1,requiresEgrn:!1},"Будущий урожай":{typeName:"Будущий урожай",requiresInspection:!1,requiresEgrn:!1},Векселя:{typeName:"Векселя",requiresInspection:!1,requiresEgrn:!1},"Доли в уставных капиталах обществ с ограниченной ответственностью":{typeName:"Доли в уставных капиталах обществ с ограниченной ответственностью",requiresInspection:!1,requiresEgrn:!1},"Инвестиционные паи (паи инвестиционных фондов)":{typeName:"Инвестиционные паи (паи инвестиционных фондов)",requiresInspection:!1,requiresEgrn:!1},"Ипотечные сертификаты участия":{typeName:"Ипотечные сертификаты участия",requiresInspection:!1,requiresEgrn:!1},"Исключительные права на интеллектуальную собственность":{typeName:"Исключительные права на интеллектуальную собственность",requiresInspection:!1,requiresEgrn:!1},"Права по договору банковского счета":{typeName:"Права по договору банковского счета",requiresInspection:!1,requiresEgrn:!1},"Прочие имущественные Права требования":{typeName:"Прочие имущественные Права требования",requiresInspection:!1,requiresEgrn:!1},"Прочие ценные бумаги":{typeName:"Прочие ценные бумаги",requiresInspection:!1,requiresEgrn:!1},"Эмиссионные ценные бумаги":{typeName:"Эмиссионные ценные бумаги",requiresInspection:!1,requiresEgrn:!1}};function sP(e){if(!e)return!1;const t=Qh[e];if(t)return t.requiresInspection;const r=e.trim();for(const[a,n]of Object.entries(Qh))if(r.includes(a)||a.includes(r))return n.requiresInspection;return!!(r.toLowerCase().includes("здание")||r.toLowerCase().includes("помещение")||r.toLowerCase().includes("участок")||r.toLowerCase().includes("сооружение"))}function iP(e){if(!e)return!1;const t=Qh[e];if(t)return t.requiresEgrn;const r=e.trim();for(const[a,n]of Object.entries(Qh))if(r.includes(a)||a.includes(r))return n.requiresEgrn;return!!(r.toLowerCase().includes("здание")||r.toLowerCase().includes("помещение")||r.toLowerCase().includes("участок")||r.toLowerCase().includes("сооружение")||r.toLowerCase().includes("машино-место"))}class oP{constructor(){tr(this,"STORAGE_KEY","ai_feedback")}saveFeedback(t){try{const r=this.getAllFeedbacks();r.push({...t,timestamp:t.timestamp});let a=r;a.length>1e3&&(a=a.slice(-1e3));const n=JSON.stringify(a);try{localStorage.setItem(this.STORAGE_KEY,n)}catch(i){if(i instanceof DOMException&&i.name==="QuotaExceededError")try{const o=a.slice(-200);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(o)),console.warn("localStorage для ai_feedback переполнен, старые отзывы удалены. Оставлено:",o.length)}catch(o){console.error("Повторная ошибка QuotaExceededError при сохранении обратной связи, очищаем ai_feedback.",o),localStorage.removeItem(this.STORAGE_KEY)}else console.error("Ошибка сохранения обратной связи:",i)}}catch(r){console.error("Ошибка подготовки обратной связи к сохранению:",r)}}getAllFeedbacks(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t).map(a=>({...a,timestamp:new Date(a.timestamp)})):[]}catch(t){return console.error("Ошибка загрузки обратной связи:",t),[]}}getFeedbackStats(){const t=this.getAllFeedbacks(),r=t.filter(n=>n.rating==="like").length,a=t.filter(n=>n.rating==="dislike").length;return{likes:r,dislikes:a,total:t.length}}getGoodExamples(t=5){return this.getAllFeedbacks().filter(a=>a.rating==="like").slice(-t).reverse()}getBadExamples(t=5){return this.getAllFeedbacks().filter(a=>a.rating==="dislike").slice(-t).reverse()}analyzeDislikes(){const t=this.getBadExamples(20),r=new Map;t.forEach(i=>{i.question.toLowerCase().split(/\s+/).forEach(l=>{l.length>3&&r.set(l,(r.get(l)||0)+1)})});const a=Array.from(r.entries()).sort((i,o)=>o[1]-i[1]).slice(0,5).map(([i])=>i),n=[];return t.length>0&&n.push("Обратите внимание на вопросы, связанные с: "+a.join(", ")),{commonTopics:a,suggestions:n}}clearAll(){localStorage.removeItem(this.STORAGE_KEY)}}const Xc=new oP;class lP{constructor(){tr(this,"indexes",new Map);tr(this,"chunks",[]);tr(this,"workerInitialized",!1)}async initializeWorker(){if(!(this.workerInitialized||typeof window>"u"))try{const t=await ps(()=>import("./pdf-CHhNo-mi.js"),[]);if(t.GlobalWorkerOptions.workerSrc=`https://unpkg.com/pdfjs-dist@${t.version}/build/pdf.worker.min.mjs`,typeof window<"u"&&window.console){const r=console.warn;console.warn=(...a)=>{const n=a.join(" ");n.includes("TT: undefined function")||n.includes("Warning: TT:")||n.includes("Missing or invalid font")||r.apply(console,a)}}this.workerInitialized=!0}catch(t){console.error("Ошибка инициализации PDF.js worker:",t);try{const r=await ps(()=>import("./pdf-CHhNo-mi.js"),[]);r.GlobalWorkerOptions.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${r.version}/build/pdf.worker.min.mjs`,this.workerInitialized=!0,console.log("PDF.js worker инициализирован (fallback):",r.GlobalWorkerOptions.workerSrc)}catch(r){console.error("Критическая ошибка инициализации PDF.js worker:",r)}}}createChunks(t,r,a=1){const n=[];if(!t||t.trim().length===0)return n;const i=t.split(/[.!?]\s+/).filter(c=>c.trim().length>0);let o="",l=0;for(let c=0;c<i.length;c++){const A=i[c].trim(),d=o?`${o}. ${A}`:A;if(d.length>1e3&&o){const f=this.extractKeywords(o);n.push({id:`${r}-${a}-${l}`,documentName:r,page:a,text:o,keywords:f}),o=A,l=c}else o=d}if(o.trim().length>0){const c=this.extractKeywords(o);n.push({id:`${r}-${a}-${l}-final`,documentName:r,page:a,text:o,keywords:c})}return n}async indexPDF(t){const r=console.warn;try{await this.initializeWorker();const a=await t.arrayBuffer(),o=await(await ps(()=>import("./pdf-CHhNo-mi.js"),[])).getDocument({data:a,verbosity:0,stopAtErrors:!1,isEvalSupported:!1,disableFontFace:!1,useSystemFonts:!0}).promise;console.warn=(...f)=>{const p=f.join(" ");p.includes("TT: undefined function")||p.includes("Warning: TT:")||p.includes("Missing or invalid font")||p.includes("pdf.worker")||r.apply(console,f)};const l=o.numPages,c=[],A=[];for(let f=1;f<=l;f++){const g=(await(await o.getPage(f)).getTextContent()).items.map(h=>h.str).join(" ").trim();if(g.length>0){A.push(g);const h=this.createChunks(g,t.name,f);c.push(...h)}}const d={documentName:t.name,chunks:c,totalPages:l,indexedAt:new Date};return this.indexes.set(t.name,d),this.chunks.push(...c),this.saveToStorage().catch(f=>console.error("Ошибка сохранения индекса PDF:",f)),console.warn=r,d}catch(a){throw console.warn=r,console.error("Ошибка индексации PDF:",a),a}}async indexDOCX(t){try{const r=await ps(()=>import("./index-DnynsFSl.js").then(d=>d.i),__vite__mapDeps([0,1])),a=await t.arrayBuffer(),i=(await r.extractRawText({arrayBuffer:a})).value;if(!i||i.trim().length===0)throw new Error("Документ не содержит текста");const o=2e3,l=[];for(let d=0;d<i.length;d+=o)l.push(i.slice(d,d+o));const c=[];l.forEach((d,f)=>{const p=this.createChunks(d,t.name,f+1);c.push(...p)});const A={documentName:t.name,chunks:c,totalPages:l.length,indexedAt:new Date};return this.indexes.set(t.name,A),this.chunks.push(...c),this.saveToStorage(t.name).catch(d=>console.error("Ошибка сохранения индекса DOCX:",d)),A}catch(r){throw console.error("Ошибка индексации DOCX:",r),r}}async indexXLSX(t){try{const r=await ps(()=>Promise.resolve().then(()=>X7),void 0),a=await t.arrayBuffer(),n=r.read(a,{type:"array"}),i=[];let o=0;const l=[];if(n.SheetNames.forEach((A,d)=>{const f=n.Sheets[A],u=r.utils.sheet_to_json(f,{header:1,defval:""}).map(g=>Array.isArray(g)?g.filter(h=>h&&String(h).trim()).join(" | "):String(g).trim()).filter(g=>g.length>0).join(`
`);if(u.trim().length>0){l.push(`Лист "${A}":
${u}`);const g=this.createChunks(u,t.name,d+1);i.push(...g),o++}}),i.length===0)throw new Error("Документ не содержит данных");const c={documentName:t.name,chunks:i,totalPages:o||1,indexedAt:new Date};return this.indexes.set(t.name,c),this.chunks.push(...i),this.saveToStorage(t.name).catch(A=>console.error("Ошибка сохранения индекса XLSX:",A)),c}catch(r){throw console.error("Ошибка индексации XLSX:",r),r}}async indexImage(t){try{const r=await new Promise((i,o)=>{const l=new FileReader;l.onload=()=>{const c=l.result;i(c)},l.onerror=o,l.readAsDataURL(t)}),a={id:`${t.name}-image-1`,documentName:t.name,page:1,text:`[Изображение: ${t.name}]`,keywords:this.extractKeywordsFromImageName(t.name),imageData:r,isImage:!0},n={documentName:t.name,chunks:[a],totalPages:1,indexedAt:new Date};return this.indexes.set(t.name,n),this.chunks.push(a),this.saveToStorage(t.name).catch(i=>console.error("Ошибка сохранения индекса изображения:",i)),n}catch(r){throw console.error("Ошибка индексации изображения:",r),r}}extractKeywordsFromImageName(t){const r=[],a=t.toLowerCase(),n=["залог","ипотека","недвижимость","квартира","дом","офис","склад","автомобиль","транспорт","документ","договор","свидетельство","выписка","егрн","кадастр","оценка","отчет","акт","осмотр"];for(const i of n)a.includes(i)&&r.push(i);return r}async indexDocument(t){const r=t.name.toLowerCase();if(r.endsWith(".pdf"))return await this.indexPDF(t);if(r.endsWith(".docx"))return await this.indexDOCX(t);if(r.endsWith(".xlsx")||r.endsWith(".xls"))return await this.indexXLSX(t);if(this.isImageFile(r))return await this.indexImage(t);throw new Error(`Неподдерживаемый формат файла: ${t.name}. Поддерживаются: PDF, DOCX, XLSX, XLS, JPG, JPEG, PNG, GIF, BMP, WEBP`)}isImageFile(t){return[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(a=>t.endsWith(a))}extractKeywords(t){const r=[],a=t.toLowerCase(),n=["залог","залоговое имущество","залогодатель","залогодержатель","залоговое право","ипотека","ипотечное кредитование","ипотечный договор","ипотечное жилищное кредитование","ltv","loan-to-value","залоговая стоимость","рыночная стоимость","кадастровая стоимость","оценка","оценщик","отчет об оценке","переоценка","независимая оценка","договор залога","договор ипотеки","залоговое право","право залога","обременение","снятие обременения","регистрация залога","государственная регистрация","недвижимость","квартира","дом","земельный участок","коммерческая недвижимость","транспортное средство","автомобиль","оборудование","движимое имущество","росреестр","егрн","кадастровый номер","кадастровый учет","кредит","кредитный договор","задолженность","основной долг","проценты","нормативный документ","регламент","инструкция","положение","политика","риск","управление рисками","мониторинг","контроль","анализ рисков","страхование","страховой полис","страховая сумма","обращение взыскания","реализация залога","продажа залога","проверка залога","осмотр залога","мониторинг залога"];for(const i of n)a.includes(i.toLowerCase())&&r.push(i);return[...new Set(r)]}search(t,r=5){const a=t.toLowerCase(),n=a.split(/\s+/).filter(o=>o.length>2);return this.chunks.map(o=>{let l=0;const c=o.text.toLowerCase();for(const A of o.keywords)a.includes(A.toLowerCase())&&(l+=10);for(const A of n){const d=(c.match(new RegExp(A,"g"))||[]).length;l+=d*2}return c.includes(a)&&(l+=20),{chunk:o,score:l}}).filter(o=>o.score>0).sort((o,l)=>l.score-o.score).slice(0,r).map(o=>o.chunk)}getIndexedDocuments(){return Array.from(this.indexes.values())}async saveToStorage(t){try{if(t){const r=this.indexes.get(t);if(!r)return;const a={documentName:r.documentName,totalPages:r.totalPages,indexedAt:r.indexedAt};await Promise.all([Jr.documentChunks.where("documentName").equals(t).delete(),Jr.documentIndexes.where("documentName").equals(t).delete()]),await Jr.documentIndexes.put(a);const n=r.chunks.map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,imageData:o.imageData,isImage:o.isImage})),i=1e3;for(let o=0;o<n.length;o+=i){const l=n.slice(o,o+i);await Jr.documentChunks.bulkPut(l)}}else{const r=Array.from(this.indexes.values()).map(o=>({documentName:o.documentName,totalPages:o.totalPages,indexedAt:o.indexedAt}));if(r.length===0)return;const a=r.map(o=>o.documentName);await Promise.all([Jr.documentChunks.where("documentName").anyOf(a).delete(),Jr.documentIndexes.where("documentName").anyOf(a).delete()]),await Jr.documentIndexes.bulkPut(r);const n=this.chunks.map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,imageData:o.imageData,isImage:o.isImage})),i=1e3;for(let o=0;o<n.length;o+=i){const l=n.slice(o,o+i);await Jr.documentChunks.bulkPut(l)}}}catch(r){console.error("Ошибка сохранения индексов в IndexedDB:",r);try{const a={indexes:Array.from(this.indexes.values()).map(n=>({documentName:n.documentName,totalPages:n.totalPages,indexedAt:n.indexedAt.toISOString()}))};localStorage.setItem("documentIndexes_fallback",JSON.stringify(a))}catch(a){console.error("Ошибка сохранения в localStorage (fallback):",a)}}}async loadFromStorage(){try{const t=await Jr.documentIndexes.toArray(),r=await Jr.documentChunks.toArray();this.indexes.clear(),this.chunks=[];const a=new Map;for(const n of r)a.has(n.documentName)||a.set(n.documentName,[]),a.get(n.documentName).push({id:n.id,documentName:n.documentName,page:n.page,text:n.text,keywords:n.keywords,imageData:n.imageData,isImage:n.isImage});for(const n of t){const i=a.get(n.documentName)||[],o={documentName:n.documentName,chunks:i,totalPages:n.totalPages,indexedAt:n.indexedAt instanceof Date?n.indexedAt:new Date(n.indexedAt)};this.indexes.set(o.documentName,o),this.chunks.push(...i)}if(t.length===0){const n=localStorage.getItem("documentIndexes");if(n)try{const i=JSON.parse(n);this.indexes.clear(),this.chunks=[];for(const o of i.indexes||[]){const l={...o,indexedAt:new Date(o.indexedAt)};this.indexes.set(l.documentName,l),this.chunks.push(...l.chunks)}await this.saveToStorage(),localStorage.removeItem("documentIndexes")}catch(i){console.error("Ошибка миграции из localStorage:",i)}}}catch(t){console.error("Ошибка загрузки индексов из IndexedDB:",t);try{const r=localStorage.getItem("documentIndexes_fallback");if(r){const a=JSON.parse(r);this.indexes.clear(),this.chunks=[];for(const n of a.indexes||[]){const i={documentName:n.documentName,chunks:(a.chunks||[]).filter(o=>o.documentName===n.documentName).map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,isImage:o.isImage})),totalPages:n.totalPages,indexedAt:new Date(n.indexedAt)};this.indexes.set(i.documentName,i),this.chunks.push(...i.chunks)}}}catch(r){console.error("Ошибка загрузки из localStorage (fallback):",r)}}}async clearIndexes(){this.indexes.clear(),this.chunks=[];try{await Jr.documentIndexes.clear(),await Jr.documentChunks.clear(),localStorage.removeItem("documentIndexes"),localStorage.removeItem("documentIndexes_fallback")}catch(t){console.error("Ошибка очистки индексов:",t)}}updateDocumentIndex(t){this.indexes.set(t.documentName,t);const r=this.chunks.filter(a=>a.documentName!==t.documentName);this.chunks=[...r,...t.chunks],this.saveToStorage(t.documentName).catch(a=>console.error("Ошибка обновления индекса:",a))}extractKeywordsPublic(t){return this.extractKeywords(t)}}const $s=new lP;class cP{constructor(){tr(this,"topics",new Map);tr(this,"categories",new Map);tr(this,"searchIndex",new Map);tr(this,"searchCache",null)}async buildFromDocuments(){const t=$s.getIndexedDocuments();for(const r of t){const a=this.extractTopics(r.chunks);for(const n of a){this.topics.set(n.id,n);for(const i of n.keywords){const o=i.toLowerCase();this.searchIndex.has(o)||this.searchIndex.set(o,[]),this.searchIndex.get(o).push(n.id)}this.categories.has(n.category)||this.categories.set(n.category,{id:n.category,name:this.getCategoryName(n.category),description:"",topics:[]}),this.categories.get(n.category).topics.push(n)}}this.saveToStorage().catch(r=>console.error("Ошибка сохранения базы знаний:",r)),this.searchCache=null}extractTopics(t){const r=[],a=new Set;for(const n of t){if(a.has(n.id))continue;const i=this.detectCategory(n),o=this.findRelatedChunks(n,t,a),l=o.map(f=>f.text).join(" ").trim();if(l.length<100)continue;const c=this.extractTitle(l),A=this.extractKeywords(l,n.keywords),d={id:`topic-${n.id}`,title:c,category:i,keywords:A,content:this.cleanText(l),page:n.page};r.push(d),o.forEach(f=>a.add(f.id))}return r}detectCategory(t){const r=t.text.toLowerCase(),a=t.keywords.map(n=>n.toLowerCase());return r.includes("понятие залога")||r.includes("сущность залога")||r.includes("определение залога")||r.includes("залог как способ")||r.includes("залог")&&(r.includes("понятие")||r.includes("сущность")||r.includes("определение"))?"collateral_concept":r.includes("виды залога")||r.includes("типы залога")||r.includes("классификация залога")||r.includes("разновидности залога")||r.includes("залог")&&(r.includes("вид")||r.includes("тип")||r.includes("классификац"))?"collateral_types":a.some(n=>["ипотека","ипотечный","ипотечное"].includes(n))||r.includes("ипотечн")||r.includes("ипотечное кредитование")||r.includes("ипотечный договор")||r.includes("ипотечное жилищное кредитование")?"mortgage":r.includes("договор залога")||r.includes("залоговый договор")||r.includes("заключение договора залога")||r.includes("условия договора залога")||a.some(n=>["договор","соглашение"].includes(n))&&r.includes("залог")?"pledge_contract":r.includes("предмет залога")||r.includes("объект залога")||r.includes("имущество в залоге")||r.includes("залоговое имущество")||r.includes("предмет")&&r.includes("залог")?"collateral_object":a.some(n=>["оценка","оценить","стоимость"].includes(n))||r.includes("оценк")||r.includes("независимая оценка")||r.includes("отчет об оценке")||r.includes("оценщик")||r.includes("рыночная стоимость")||r.includes("залоговая стоимость")?"appraisal":a.some(n=>["ltv","loan-to-value"].includes(n))||r.includes("ltv")||r.includes("loan-to-value")||r.includes("соотношение займа к стоимости")||r.includes("залоговая стоимость")&&(r.includes("расчет")||r.includes("определение"))?"ltv_calculation":a.some(n=>["регистрация","росреестр","егрн"].includes(n))||r.includes("регистрац")||r.includes("росреестр")||r.includes("государственная регистрация")||r.includes("регистрация залога")||r.includes("егрн")||r.includes("кадастровый учет")?"registration":r.includes("обременение")||r.includes("снятие обременения")||r.includes("прекращение обременения")||r.includes("освобождение от обременения")?"encumbrance":a.some(n=>["риск","риски"].includes(n))||r.includes("риск")||r.includes("управление рисками")||r.includes("анализ рисков")||r.includes("контроль рисков")||r.includes("минимизация рисков")?"risks":r.includes("мониторинг залога")||r.includes("контроль залога")||r.includes("проверка залога")||r.includes("осмотр залога")||r.includes("проверка наличия залога")?"monitoring":r.includes("обращение взыскания")||r.includes("взыскание на залог")||r.includes("реализация залога")||r.includes("продажа залога")||r.includes("обращение взыскания на предмет залога")?"enforcement":r.includes("страхование залога")||r.includes("страхование залогового имущества")||a.some(n=>["страхование","страховой полис"].includes(n))||r.includes("страхование")&&r.includes("залог")?"insurance":a.some(n=>["норматив","регламент","инструкция","закон","кодекс"].includes(n))||r.includes("норматив")||r.includes("регламент")||r.includes("гражданский кодекс")||r.includes("федеральный закон")||r.includes("нормативно-правовой")||r.includes("законодательство")?"regulations":(r.includes("недвижимость")||r.includes("квартира")||r.includes("дом")||r.includes("земельный участок"))&&r.includes("залог")?"real_estate_collateral":(r.includes("движимое имущество")||r.includes("автомобиль")||r.includes("транспортное средство")||r.includes("оборудование"))&&r.includes("залог")?"movable_collateral":r.includes("права залогодателя")||r.includes("права залогодержателя")||r.includes("обязанности залогодателя")||r.includes("обязанности залогодержателя")||r.includes("права и обязанности")||r.includes("право")&&r.includes("залог")?"rights_obligations":r.includes("залогодатель")||r.includes("залогодержатель")||r.includes("стороны")&&r.includes("договор залога")?"parties":r.includes("залог")||a.some(n=>["залоговое имущество"].includes(n))?"collateral_general":"general"}findRelatedChunks(t,r,a){const n=[t],i=new Set(t.keywords.map(o=>o.toLowerCase()));for(const o of r)if(!(a.has(o.id)||o.id===t.id)&&Math.abs(o.page-t.page)<=2){const l=new Set(o.keywords.map(A=>A.toLowerCase()));[...i].filter(A=>l.has(A)).length>0&&n.push(o)}return n}extractTitle(t){const r=t.split(`
`).filter(o=>o.trim().length>0),a=[/^(?:Глава|Раздел|§|Часть)\s*\d+[.\s]*(.+)$/i,/^\d+[.\s]+\d*[.\s]*([А-ЯЁ][^.!?]{10,80})$/,/^([А-ЯЁ][А-Яа-яё\s]{10,80})$/,/^([А-ЯЁ][^:]{10,80}):/];for(let o=0;o<Math.min(5,r.length);o++){const l=r[o].trim();for(const c of a){const A=l.match(c);if(A){const d=A[1]||A[0];if(d.length>10&&d.length<100&&!d.endsWith(".")&&d.split(" ").length<15)return d.trim()}}if(l.length>10&&l.length<100&&/^[А-ЯЁ]/.test(l)&&l.split(" ").length<15&&!l.endsWith(".")&&!l.endsWith(",")&&!l.includes("что")&&!l.includes("как")&&!l.includes("когда"))return l}const n=t.split(/[.!?]/)[0].trim();if(n.length>10&&n.length<100)return n;const i=t.split(/\s+/).slice(0,12).join(" ");return i.length>80?i.slice(0,77)+"...":i}extractKeywords(t,r){const a=new Set(r),n=t.toLowerCase(),i=["залог","залоговое имущество","залогодатель","залогодержатель","ипотека","ипотечный договор","ипотечное кредитование","ltv","loan-to-value","залоговая стоимость","рыночная стоимость","оценка","оценщик","отчет об оценке","переоценка","договор залога","договор ипотеки","залоговое право","обременение","снятие обременения","регистрация залога","недвижимость","квартира","дом","земельный участок","транспортное средство","автомобиль","оборудование","росреестр","егрн","кадастровый номер","кредит","кредитный договор","задолженность","нормативный документ","регламент","инструкция","риск","управление рисками","мониторинг","страхование","страховой полис"];for(const o of i)n.includes(o.toLowerCase())&&a.add(o);return Array.from(a)}cleanText(t){return t.replace(/\s+/g," ").replace(/\n\s*\n/g,`

`).trim()}getCategoryName(t){return{collateral_concept:"Понятие и сущность залога",collateral_types:"Виды и типы залога",collateral_general:"Общие вопросы залога",collateral_object:"Предмет залога",mortgage:"Ипотека и ипотечное кредитование",pledge_contract:"Договор залога",appraisal:"Оценка залогового имущества",ltv_calculation:"LTV и залоговая стоимость",registration:"Регистрация залога",encumbrance:"Обременение и снятие обременения",risks:"Риски и управление рисками",monitoring:"Мониторинг залога",enforcement:"Обращение взыскания на залог",insurance:"Страхование залога",regulations:"Нормативные документы и законодательство",real_estate_collateral:"Недвижимость как предмет залога",movable_collateral:"Движимое имущество как предмет залога",parties:"Залогодатель и залогодержатель",rights_obligations:"Права и обязанности сторон",general:"Общие вопросы"}[t]||"Общие вопросы"}search(t,r=5){const a=`${t.toLowerCase()}-${r}`;if(this.searchCache&&this.searchCache.key===a)return this.searchCache.results;if(!t||t.trim().length===0)return[];const n=t.toLowerCase().trim(),i=n.split(/\s+/).filter(d=>d.length>2);if(i.length===0&&n.length<3)return[];const o=new Map,l=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");for(const d of i){const f=this.searchIndex.get(d);if(f)for(const p of f){const u=o.get(p)||0;o.set(p,u+10)}}const c=i.length===0||o.size<r*2?Array.from(this.topics.entries()):Array.from(o.keys()).map(d=>[d,this.topics.get(d)]).filter(([,d])=>d);for(const[d,f]of c){if(!f)continue;const p=f.content.toLowerCase(),u=f.title.toLowerCase();let g=o.get(d)||0;u.includes(n)&&(g+=30);try{const h=(p.match(l)||[]).length;g+=h*2}catch{p.includes(n)&&(g+=2)}if(i.length>0)for(const h of i)try{const x=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),y=(p.match(x)||[]).length;g+=y}catch{p.includes(h)&&(g+=1)}g>0&&o.set(d,g)}return Array.from(o.entries()).sort((d,f)=>f[1]-d[1]).slice(0,r).map(([d])=>this.topics.get(d)).filter(d=>d!==void 0)}getCategories(){return Array.from(this.categories.values())}getTopic(t){return this.topics.get(t)}getTopicsByCategory(t){const r=this.categories.get(t);return r?r.topics:[]}async saveToStorage(){try{await Promise.all([Jr.knowledgeTopics.clear(),Jr.knowledgeCategories.clear(),Jr.knowledgeSearchIndex.clear()]);const t=Array.from(this.topics.values()).map(o=>({id:o.id,title:o.title,category:o.category,keywords:o.keywords,content:o.content,page:o.page,relatedTopics:o.relatedTopics})),r=1e3;for(let o=0;o<t.length;o+=r){const l=t.slice(o,o+r);await Jr.knowledgeTopics.bulkPut(l)}const a=Array.from(this.categories.values()).map(o=>({id:o.id,name:o.name,description:o.description,topicIds:o.topics.map(l=>l.id)}));a.length>0&&await Jr.knowledgeCategories.bulkPut(a);const n=Array.from(this.searchIndex.entries()).map(([o,l])=>({keyword:o,topicIds:l})),i=1e3;for(let o=0;o<n.length;o+=i){const l=n.slice(o,o+i);await Jr.knowledgeSearchIndex.bulkPut(l)}}catch(t){console.error("Ошибка сохранения базы знаний в IndexedDB:",t);try{const r={categories:Array.from(this.categories.values()).map(a=>({id:a.id,name:a.name,description:a.description,topicCount:a.topics.length})),topicCount:this.topics.size,version:"1.0",updatedAt:new Date().toISOString()};localStorage.setItem("knowledgeBase_fallback",JSON.stringify(r))}catch(r){console.error("Ошибка сохранения в localStorage (fallback):",r)}}}async loadFromStorage(){var t;try{const r=await Jr.knowledgeTopics.toArray();this.topics.clear();for(const i of r){const o={id:i.id,title:i.title,category:i.category,keywords:i.keywords,content:i.content,page:i.page,relatedTopics:i.relatedTopics};this.topics.set(o.id,o)}const a=await Jr.knowledgeSearchIndex.toArray();this.searchIndex.clear();for(const i of a)this.searchIndex.set(i.keyword,i.topicIds);const n=await Jr.knowledgeCategories.toArray();this.categories.clear();for(const i of n){const o=i.topicIds.map(c=>this.topics.get(c)).filter(c=>c!==void 0),l={id:i.id,name:i.name,description:i.description,topics:o};this.categories.set(l.id,l)}if(r.length===0){const i=localStorage.getItem("knowledgeBase");if(i)try{const o=JSON.parse(i);this.topics.clear(),this.categories.clear(),this.searchIndex.clear();for(const l of o.topics||[]){this.topics.set(l.id,l);for(const c of l.keywords){const A=c.toLowerCase();this.searchIndex.has(A)||this.searchIndex.set(A,[]),this.searchIndex.get(A).push(l.id)}}for(const l of o.categories||[])this.categories.set(l.id,l);await this.saveToStorage(),localStorage.removeItem("knowledgeBase")}catch(o){console.error("Ошибка миграции из localStorage:",o)}}}catch(r){console.error("Ошибка загрузки базы знаний из IndexedDB:",r);try{const a=localStorage.getItem("knowledgeBase_fallback");if(a){const n=JSON.parse(a);console.log(`Загружены метаданные базы знаний: ${n.topicCount} тем, ${((t=n.categories)==null?void 0:t.length)||0} категорий`)}}catch(a){console.error("Ошибка загрузки из localStorage (fallback):",a)}}}async clear(){this.topics.clear(),this.categories.clear(),this.searchIndex.clear();try{await Promise.all([Jr.knowledgeTopics.clear(),Jr.knowledgeCategories.clear(),Jr.knowledgeSearchIndex.clear()]),localStorage.removeItem("knowledgeBase"),localStorage.removeItem("knowledgeBase_fallback")}catch(t){console.error("Ошибка очистки базы знаний:",t)}}}const Cn=new cP;class AP{constructor(){tr(this,"STORAGE_KEY","ai_learning_patterns");tr(this,"INSIGHTS_KEY","ai_document_insights");tr(this,"CATEGORY_EXPERIENCE_KEY","ai_category_experience");tr(this,"patterns",new Map);tr(this,"documentInsights",new Map);tr(this,"categoryExperience",{})}initialize(){this.loadPatterns(),this.loadDocumentInsights(),this.loadCategoryExperience()}analyzeFeedback(){const t=Xc.getAllFeedbacks();if(t.length===0)return;const r=new Map;t.forEach(a=>{const n=this.extractQuestionPattern(a.question);r.has(n)||r.set(n,[]),r.get(n).push(a)}),r.forEach((a,n)=>{const i=a.filter(c=>c.rating==="like").length,o=a.length,l=o>0?i/o:0;if(i>0&&l>=.5){const c=a.filter(u=>u.rating==="like").sort((u,g)=>g.timestamp.getTime()-u.timestamp.getTime())[0],A=this.extractKeywords(a[0].question),d=this.detectCategory(a[0].question),f={questionPattern:n,successfulAnswerTemplate:this.extractAnswerTemplate(c.answer),keywords:A,category:d,successRate:l,usageCount:o,lastUpdated:new Date},p=this.patterns.get(n);!p||l>p.successRate?this.patterns.set(n,f):p&&(p.usageCount=o,p.successRate=l,p.lastUpdated=new Date)}}),this.savePatterns()}analyzeDocuments(){const t=$s.getIndexedDocuments();console.log(`📚 Анализирую ${t.length} документов для обучения модели...`),t.forEach(r=>{const a=Cn.getCategories().flatMap(d=>d.topics),n=r.documentName.toLowerCase(),i=a.filter(d=>d.content.toLowerCase().includes(n)||r.chunks.some(p=>p.text.toLowerCase().includes(d.title.toLowerCase()))),o=i.map(d=>d.title).slice(0,15),l=new Set;r.chunks.forEach(d=>{d.keywords.forEach(u=>l.add(u));const f=d.text.toLowerCase();["оценка","стоимость","рыночная","залоговая","ltv","риск","риски","регистрация","ипотека","обременение","росреестр","егрн","кадастр","недвижимость","движимое имущество","бизнес","активы","залог","договор","соглашение","норматив","требование","процедура","метод","подход","анализ","мониторинг","осмотр","проверка"].forEach(u=>{f.includes(u)&&l.add(u)})});const c=this.generateCommonQuestions(i);if(c.length<5){const d=this.generateQuestionsFromKeywords(Array.from(l));c.push(...d.slice(0,5-c.length))}this.extractPatternsFromDocument(r);const A={documentName:r.documentName,importantTopics:o,commonQuestions:c.slice(0,10),keywords:Array.from(l).slice(0,30),lastAnalyzed:new Date};this.documentInsights.set(r.documentName,A),console.log(`✅ Проанализирован документ: ${r.documentName} (${o.length} тем, ${l.size} ключевых слов)`)}),this.saveDocumentInsights(),console.log(`🎓 Анализ документов завершен. Извлечено инсайтов: ${this.documentInsights.size}`)}generateQuestionsFromKeywords(t){const r=[],a=["Как {keyword}?","Что такое {keyword}?","Какие требования к {keyword}?","Как правильно {keyword}?","Какие особенности {keyword}?"];return t.slice(0,10).forEach(n=>{a.forEach(i=>{i.includes("{keyword}")&&r.push(i.replace("{keyword}",n))})}),r.slice(0,10)}extractPatternsFromDocument(t){t.chunks.forEach(r=>{const a=r.text.toLowerCase();(a.includes("?")||a.includes("вопрос")||a.includes("ответ"))&&r.text.split(/[.!?]+/).forEach(i=>{if(i.includes("?")||i.toLowerCase().includes("как")||i.toLowerCase().includes("что")){const o=this.extractKeywords(i);if(o.length>=2){const l=this.detectCategory(i),c=this.extractQuestionPattern(i);if(!this.patterns.has(c)){const A={questionPattern:c,successfulAnswerTemplate:i.slice(0,200),keywords:o,category:l,successRate:.7,usageCount:0,lastUpdated:new Date};this.patterns.set(c,A)}}}})})}getRecommendations(t){const r=this.extractKeywords(t),a=this.detectCategory(t),n=Array.from(this.patterns.values()).filter(c=>c.category===a?!0:c.keywords.filter(d=>r.includes(d)).length>=2).sort((c,A)=>{const d=c.successRate*Math.log(c.usageCount+1);return A.successRate*Math.log(A.usageCount+1)-d}).slice(0,3),i=n[0],o=i==null?void 0:i.successfulAnswerTemplate,l=Array.from(this.documentInsights.values()).filter(c=>c.keywords.some(d=>r.some(f=>f.toLowerCase().includes(d.toLowerCase())||d.toLowerCase().includes(f.toLowerCase())))).slice(0,2);return{suggestedTemplate:o,importantKeywords:r,relatedPatterns:n,documentInsights:l.length>0?l:void 0}}extractQuestionPattern(t){let a=t.toLowerCase().replace(/\d+/g,"[число]").replace(/"[^"]*"/g,"[строка]").replace(/'[^']*'/g,"[строка]").replace(/\b(как|что|когда|где|почему|зачем|какой|какая|какое|какие)\b/g,"[вопрос]").replace(/\b(рассчитать|определить|найти|получить|создать|сделать)\b/g,"[действие]");return a=a.replace(/\s+/g," ").trim(),a}extractKeywords(t){const r=t.toLowerCase(),a=[];return["залог","залоговое имущество","залогодатель","залогодержатель","ипотека","ипотечный договор","ltv","loan-to-value","оценка","оценщик","рыночная стоимость","залоговая стоимость","договор залога","обременение","регистрация","росреестр","егрн","риск","мониторинг","осмотр","взыскание"].forEach(o=>{r.includes(o)&&a.push(o)}),r.split(/\s+/).filter(o=>o.length>4).forEach(o=>{!a.includes(o)&&a.length<10&&a.push(o)}),[...new Set(a)].slice(0,10)}detectCategory(t){const r=t.toLowerCase();return r.includes("ltv")||r.includes("loan-to-value")||r.includes("залоговая стоимость")?"ltv_calculation":r.includes("оценк")||r.includes("оценщик")?"appraisal":r.includes("риск")?"risks":r.includes("регистрац")||r.includes("росреестр")||r.includes("егрн")?"registration":r.includes("осмотр")||r.includes("мониторинг")?"monitoring":r.includes("ипотек")?"mortgage":r.includes("договор")?"pledge_contract":"general"}extractAnswerTemplate(t){return t.replace(/\d+/g,"[число]").replace(/"[^"]*"/g,"[пример]").replace(/\b(?:https?:\/\/[^\s]+|www\.[^\s]+)/g,"[ссылка]").substring(0,500)}generateCommonQuestions(t){const r=[];return t.slice(0,5).forEach(a=>{const n=a.title.toLowerCase();n.includes("расчет")||n.includes("определение")?r.push(`Как ${n}?`):n.includes("требования")||n.includes("порядок")?r.push(`Какие ${n}?`):r.push(`Что такое ${n}?`)}),r.slice(0,5)}savePatterns(){try{const t=Array.from(this.patterns.values()).map(r=>({...r,lastUpdated:r.lastUpdated.toISOString()}));localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения паттернов обучения:",t)}}loadPatterns(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(t){const r=JSON.parse(t);this.patterns.clear(),r.forEach(a=>{this.patterns.set(a.questionPattern,{...a,lastUpdated:new Date(a.lastUpdated)})})}}catch(t){console.error("Ошибка загрузки паттернов обучения:",t)}}saveDocumentInsights(){try{const t=Array.from(this.documentInsights.values()).map(r=>({...r,lastAnalyzed:r.lastAnalyzed.toISOString()}));localStorage.setItem(this.INSIGHTS_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения инсайтов документов:",t)}}loadDocumentInsights(){try{const t=localStorage.getItem(this.INSIGHTS_KEY);if(t){const r=JSON.parse(t);this.documentInsights.clear(),r.forEach(a=>{this.documentInsights.set(a.documentName,{...a,lastAnalyzed:new Date(a.lastAnalyzed)})})}}catch(t){console.error("Ошибка загрузки инсайтов документов:",t)}}saveCategoryExperience(){try{localStorage.setItem(this.CATEGORY_EXPERIENCE_KEY,JSON.stringify(this.categoryExperience))}catch(t){console.error("Ошибка сохранения опыта по категориям:",t)}}loadCategoryExperience(){try{const t=localStorage.getItem(this.CATEGORY_EXPERIENCE_KEY);t&&(this.categoryExperience=JSON.parse(t))}catch(t){console.error("Ошибка загрузки опыта по категориям:",t),this.categoryExperience={}}}addCategoryExperience(t,r=2){const a=this.categoryExperience[t]||0,n=Math.max(0,Math.min(100,a+r));return this.categoryExperience[t]=n,this.saveCategoryExperience(),n}getCategorySkill(t){const r=this.categoryExperience[t]??0,a=Array.from(this.patterns.values()).filter(c=>c.category===t);if(a.length===0)return r;const n=a.reduce((c,A)=>c+A.successRate,0)/a.length,i=Math.min(a.reduce((c,A)=>c+A.usageCount,0)/10,20),o=n*60,l=r*.4;return Math.min(100,Math.round(l+o+i))}getLearningStats(){const t=Array.from(this.patterns.values()),r=t.length>0?t.reduce((n,i)=>n+i.successRate,0)/t.length:0,a=t.reduce((n,i)=>n+i.usageCount,0);return{patternsCount:this.patterns.size,insightsCount:this.documentInsights.size,averageSuccessRate:r,totalUsage:a}}forceUpdate(){console.log("🔄 Принудительное обновление данных для самообучения..."),this.analyzeDocuments(),this.analyzeFeedback(),console.log("✅ Данные для самообучения обновлены")}}const Va=new AP;class dP{constructor(){tr(this,"STORAGE_KEY","ai_model_evolution");tr(this,"evolution",null);tr(this,"EVOLUTION_LEVELS",[{level:1,name:"Новичок",description:"Начальный уровень, базовая база знаний",experienceRequired:0,specializations:[]},{level:2,name:"Стажер",description:"Изучает основы оценки и анализа рисков",experienceRequired:100,specializations:["Базовая оценка"]},{level:3,name:"Специалист",description:"Компетентен в оценке основных типов активов",experienceRequired:500,specializations:["Оценка недвижимости","Оценка движимого имущества","Регистрация залога"]},{level:4,name:"Эксперт",description:"Глубокие знания в оценке и анализе рисков",experienceRequired:1500,specializations:["Оценка бизнеса","Анализ рисков","Оценка интеллектуальной собственности","Регистрация ипотеки"]},{level:5,name:"Старший эксперт",description:"Мастер в оценке всех видов активов",experienceRequired:3e3,specializations:["Комплексная оценка","Сложные риски","Нетиповые активы","Регистрация всех типов залога"]},{level:6,name:"Ведущий эксперт",description:"Признанный авторитет в области оценки и анализа рисков",experienceRequired:6e3,specializations:["Экспертиза","Методология оценки","Управление рисками","Регистрация залога","Уточняющие вопросы"]},{level:7,name:"Главный эксперт",description:"Высший уровень профессионализма",experienceRequired:1e4,specializations:["Все виды активов","Все типы рисков","Регистрация залога","Методология","Обучение","Профессиональные консультации"]}])}initialize(){this.loadEvolution(),this.evolution||this.createInitialEvolution()}createInitialEvolution(){this.evolution={level:1,totalExperience:0,experiencePoints:{assetValuation:0,riskAnalysis:0,documentAnalysis:0,consultation:0,registration:0,questionEnhancement:0},specializations:[],learnedConcepts:[],bestPractices:new Map,evolutionHistory:[{date:new Date,level:1,milestone:"Инициализация модели"}],createdAt:new Date,lastEvolution:new Date},this.saveEvolution()}addExperienceFromFeedback(t,r,a){if(this.evolution||this.initialize(),!this.evolution)return;const n=t==="like"?10:2,i=a.toLowerCase();this.isAssetValuationQuestion(i,r)&&(this.evolution.experiencePoints.assetValuation+=n),this.isRiskAnalysisQuestion(i,r)&&(this.evolution.experiencePoints.riskAnalysis+=n),this.isRegistrationQuestion(i,r)&&(this.evolution.experiencePoints.registration+=n*1.5),(r==="appraisal"||r==="ltv_calculation")&&(this.evolution.experiencePoints.assetValuation+=n*1.5),(r==="risks"||r==="monitoring")&&(this.evolution.experiencePoints.riskAnalysis+=n*1.5),(r==="registration"||r==="mortgage")&&(this.evolution.experiencePoints.registration+=n*1.5),t==="like"&&a.length>50&&(this.evolution.experiencePoints.questionEnhancement+=2),this.evolution.experiencePoints.consultation+=n,this.evolution.totalExperience+=n,this.extractConcepts(a),this.checkEvolution(),this.saveEvolution()}addExperienceFromDocuments(){if(this.evolution||this.initialize(),!this.evolution)return;const t=$s.getIndexedDocuments(),r=Cn.getCategories(),a=10;this.evolution.experiencePoints.documentAnalysis+=t.length*a,this.evolution.totalExperience+=t.length*a;const n=3;this.evolution.experiencePoints.consultation+=r.length*n,this.evolution.totalExperience+=r.length*n;let i=0;r.forEach(c=>{i+=c.topics.length});const o=.5;this.evolution.experiencePoints.consultation+=i*o,this.evolution.totalExperience+=i*o;let l=0;if(t.forEach(c=>{c.chunks.forEach(A=>{const d=this.evolution.learnedConcepts.length;this.extractConceptsFromText(A.text),this.evolution.learnedConcepts.length>d&&l++})}),l>0){const c=l*2;this.evolution.experiencePoints.documentAnalysis+=c,this.evolution.totalExperience+=c,console.log(`📚 Извлечено новых концепций из документов: ${l}`)}this.evolution&&t.forEach(c=>{const A=c.documentName.toLowerCase();(A.includes("оценк")||A.includes("fso")||A.includes("стоимость"))&&(this.evolution.experiencePoints.assetValuation+=5,this.evolution.totalExperience+=5),(A.includes("риск")||A.includes("мониторинг"))&&(this.evolution.experiencePoints.riskAnalysis+=5,this.evolution.totalExperience+=5),(A.includes("регистрац")||A.includes("ипотек")||A.includes("залог"))&&(this.evolution.experiencePoints.registration+=5,this.evolution.totalExperience+=5)}),console.log(`🎓 Модель получила опыт из документов: +${t.length*a} за документы, +${r.length*n} за категории, +${i*o} за темы`),this.checkEvolution(),this.saveEvolution()}checkEvolution(){if(!this.evolution||!this.EVOLUTION_LEVELS.find(a=>a.level===this.evolution.level))return;const r=this.EVOLUTION_LEVELS.find(a=>a.level===this.evolution.level+1);r&&this.evolution.totalExperience>=r.experienceRequired&&(this.evolution.level=r.level,this.evolution.specializations=[...new Set([...this.evolution.specializations,...r.specializations])],this.evolution.lastEvolution=new Date,this.evolution.evolutionHistory.push({date:new Date,level:r.level,milestone:`Достигнут уровень: ${r.name}`}),console.log(`🎉 Модель эволюционировала до уровня ${r.level}: ${r.name}`))}isAssetValuationQuestion(t,r){return r==="appraisal"||r==="ltv_calculation"||["оценка","стоимость","рыночная","залоговая","кадастровая","ltv","loan-to-value","оценщик","отчет об оценке","недвижимость","движимое имущество","бизнес","активы"].some(n=>t.includes(n))}isRiskAnalysisQuestion(t,r){return r==="risks"||r==="monitoring"||["риск","риски","анализ рисков","управление рисками","минимизация","контроль","мониторинг","проверка","обременение","нетиповые риски"].some(n=>t.includes(n))}isRegistrationQuestion(t,r){return r==="registration"||r==="mortgage"||["регистрац","обременен","росреестр","егрн","ипотек","залог","оформлен","договор залога"].some(n=>t.includes(n))}extractConcepts(t){if(!this.evolution)return;const r=["оценка недвижимости","оценка бизнеса","оценка движимого имущества","ltv расчет","залоговая стоимость","рыночная стоимость","анализ рисков","управление рисками","мониторинг залога","регистрация обременения","договор залога","ипотека","регистрация залога","росреестр","егрн","кадастровый учет","уточняющие вопросы","профессиональные консультации"],a=t.toLowerCase();r.forEach(n=>{a.includes(n.toLowerCase())&&!this.evolution.learnedConcepts.includes(n)&&this.evolution.learnedConcepts.push(n)})}extractConceptsFromText(t){if(!this.evolution)return;const r=["федеральный стандарт оценки","фсо","методы оценки","доходный подход","сравнительный подход","затратный подход","дисконтирование","капитализация","мультипликаторы","риск-менеджмент","кредитный риск","рыночный риск"],a=t.toLowerCase();r.forEach(n=>{a.includes(n.toLowerCase())&&!this.evolution.learnedConcepts.includes(n)&&this.evolution.learnedConcepts.push(n)})}getCurrentLevel(){return this.evolution||this.initialize(),this.evolution&&this.EVOLUTION_LEVELS.find(t=>t.level===this.evolution.level)||null}getProgressToNextLevel(){if(this.evolution||this.initialize(),!this.evolution)return null;const t=this.EVOLUTION_LEVELS.find(o=>o.level===this.evolution.level+1);if(!t)return{current:this.evolution.totalExperience,required:this.evolution.totalExperience,percentage:100};const r=this.EVOLUTION_LEVELS.find(o=>o.level===this.evolution.level),a=this.evolution.totalExperience-((r==null?void 0:r.experienceRequired)||0),n=t.experienceRequired-((r==null?void 0:r.experienceRequired)||0),i=Math.min(100,Math.round(a/n*100));return{current:a,required:n,percentage:i}}getEvolutionStats(){return this.evolution||this.initialize(),this.evolution}getEnhancedPrompt(t){if(this.evolution||this.initialize(),!this.evolution)return t;const r=this.getCurrentLevel();if(!r)return t;let a=t;return a+=`

ТВОЙ УРОВЕНЬ ЭКСПЕРТИЗЫ: ${r.name} (Уровень ${this.evolution.level})`,a+=`
Твой общий опыт: ${this.evolution.totalExperience} очков опыта`,this.evolution.specializations.length>0&&(a+=`
Твои специализации: ${this.evolution.specializations.join(", ")}`),a+=`

ТВОЙ ОПЫТ:`,a+=`
- Оценка активов: ${this.evolution.experiencePoints.assetValuation} очков`,a+=`
- Анализ рисков: ${this.evolution.experiencePoints.riskAnalysis} очков`,a+=`
- Регистрация залога: ${this.evolution.experiencePoints.registration} очков`,a+=`
- Анализ документов: ${this.evolution.experiencePoints.documentAnalysis} очков`,a+=`
- Консультации: ${this.evolution.experiencePoints.consultation} очков`,a+=`
- Уточняющие вопросы: ${this.evolution.experiencePoints.questionEnhancement} очков`,this.evolution.learnedConcepts.length>0&&(a+=`

ИЗУЧЕННЫЕ КОНЦЕПЦИИ: ${this.evolution.learnedConcepts.slice(0,10).join(", ")}`),this.evolution.level>=4&&(a+=`

Ты достиг высокого уровня экспертизы. Используй глубокие знания и профессиональный опыт для комплексного анализа.`),this.evolution.level>=5&&(a+=`

Ты мастер в оценке всех видов активов. Предоставляй детальный анализ с учетом всех нюансов и рисков.`),a}saveEvolution(){if(this.evolution)try{const t={...this.evolution,bestPractices:Array.from(this.evolution.bestPractices.entries()),evolutionHistory:this.evolution.evolutionHistory.map(r=>({...r,date:r.date.toISOString()})),createdAt:this.evolution.createdAt.toISOString(),lastEvolution:this.evolution.lastEvolution.toISOString()};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения эволюции:",t)}}loadEvolution(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(t){const r=JSON.parse(t);this.evolution={...r,bestPractices:new Map(r.bestPractices||[]),evolutionHistory:(r.evolutionHistory||[]).map(a=>({...a,date:new Date(a.date)})),createdAt:new Date(r.createdAt),lastEvolution:new Date(r.lastEvolution)}}}catch(t){console.error("Ошибка загрузки эволюции:",t)}}addPassiveExperience(t,r){if(this.evolution||this.initialize(),!this.evolution)return;const a=t.toLowerCase(),n=this.detectCategoryFromQuestion(t),i=.5;this.isAssetValuationQuestion(a,n)&&(this.evolution.experiencePoints.assetValuation+=i),this.isRiskAnalysisQuestion(a,n)&&(this.evolution.experiencePoints.riskAnalysis+=i),this.isRegistrationQuestion(a,n)&&(this.evolution.experiencePoints.registration+=i),r>500&&(this.evolution.experiencePoints.consultation+=i),this.evolution.experiencePoints.consultation+=i,this.evolution.totalExperience+=i,Math.random()<.1?(this.checkEvolution(),this.saveEvolution()):this.saveEvolution()}updateExperienceFromCurrentData(){if(this.evolution||this.initialize(),!this.evolution)return;this.addExperienceFromDocuments(),Xc.getAllFeedbacks().forEach(r=>{const a=this.detectCategoryFromQuestion(r.question);this.addExperienceFromFeedback(r.rating,a,r.question)}),this.saveEvolution()}detectCategoryFromQuestion(t){const r=t.toLowerCase();return r.includes("ltv")||r.includes("залоговая стоимость")?"ltv_calculation":r.includes("оценк")||r.includes("оценщик")?"appraisal":r.includes("риск")?"risks":r.includes("регистрац")||r.includes("росреестр")?"registration":r.includes("осмотр")||r.includes("мониторинг")?"monitoring":r.includes("ипотек")?"mortgage":r.includes("договор")?"pledge_contract":"general"}}const ua=new dP;class uP{analyzeQuestion(t){const r=t.toLowerCase(),a=this.detectTopic(r),n=this.detectAssetType(r),i=this.detectRiskType(r),o=this.detectRegistrationType(r),l=this.generateClarificationQuestions(r,a,n,i,o);return{needsClarification:l.length>0,clarificationQuestions:l,detectedTopic:a,detectedAssetType:n,detectedRiskType:i,detectedRegistrationType:o}}detectTopic(t){return t.includes("оценк")||t.includes("стоимость")||t.includes("ltv")?"valuation":t.includes("риск")||t.includes("опасн")||t.includes("проблем")?"risk":t.includes("регистрац")||t.includes("обременен")||t.includes("росреестр")||t.includes("егрн")?"registration":t.includes("документ")||t.includes("оформлен")?"documentation":t.includes("осмотр")||t.includes("проверк")||t.includes("мониторинг")?"inspection":"general"}detectAssetType(t){const r=[{keywords:["недвижимость","квартир","дом","здание","помещен","участок","земл"],type:"real_estate"},{keywords:["автомобил","машин","транспорт","грузовик"],type:"vehicle"},{keywords:["оборудован","техник","станок","машин"],type:"equipment"},{keywords:["бизнес","предприяти","компани","дол"],type:"business"},{keywords:["интеллектуальн","патент","товарный знак","ноу-хау"],type:"intellectual"},{keywords:["азс","автозаправк"],type:"gas_station"},{keywords:["торгов","магазин","тц","торговый центр"],type:"retail"}];for(const a of r)if(a.keywords.some(n=>t.includes(n)))return a.type}detectRiskType(t){const r=[{keywords:["кредитн","дефолт","неплатеж"],type:"credit"},{keywords:["рыночн","ликвидн","стоимость"],type:"market"},{keywords:["юридическ","право","собственн","обременен"],type:"legal"},{keywords:["операционн","сохранн","поврежден","уничтожен"],type:"operational"},{keywords:["нетипов","специфическ","особ"],type:"atypical"}];for(const a of r)if(a.keywords.some(n=>t.includes(n)))return a.type}detectRegistrationType(t){if(t.includes("ипотек")||t.includes("недвижимость"))return"mortgage";if(t.includes("движим")||t.includes("автомобил")||t.includes("оборудован"))return"movable";if(t.includes("бизнес")||t.includes("дол"))return"business"}generateClarificationQuestions(t,r,a,n,i){const o=[];return r==="valuation"&&!a&&o.push("Какой тип актива вы хотите оценить? (недвижимость, движимое имущество, бизнес и т.д.)"),r==="valuation"&&a==="real_estate"&&!t.includes("метод")&&o.push("Какой метод оценки вас интересует? (сравнительный, доходный, затратный)"),r==="valuation"&&!t.includes("стоимость")&&!t.includes("ltv")&&o.push("Какая стоимость вас интересует? (рыночная, залоговая, кадастровая)"),r==="risk"&&!n&&o.push("Какой тип риска вас интересует? (кредитный, рыночный, юридический, операционный)"),r==="risk"&&!a&&o.push("Для какого типа актива вы хотите проанализировать риски?"),r==="registration"&&!i&&o.push("Какой тип залога вы хотите зарегистрировать? (ипотека, залог движимого имущества, залог прав)"),r==="registration"&&!t.includes("документ")&&!t.includes("процедур")&&o.push("Вас интересует процедура регистрации или необходимые документы?"),a==="real_estate"&&!t.includes("расположен")&&!t.includes("адрес")&&o.push("Где расположен объект недвижимости? (регион, город, район)"),a==="gas_station"&&!t.includes("характеристик")&&o.push("Какие характеристики АЗС важны? (количество колонок, площадь, местоположение)"),a==="retail"&&!t.includes("площад")&&o.push("Какая площадь торгового помещения? Есть ли арендаторы?"),t.includes("ltv")&&!t.includes("сумм")&&!t.includes("кредит")&&o.push("Какая сумма кредита и рыночная стоимость залога?"),t.length<20&&!o.length&&o.push("Можете уточнить ваш вопрос? Что именно вас интересует?"),o.slice(0,3)}formatClarificationQuestions(t){return t.length===0?"":`

**Для более точного ответа, уточните, пожалуйста:**
${t.map((r,a)=>`${a+1}. ${r}`).join(`
`)}`}}const pw=new uP,fP="c2stNWYwNmRiOTY5YjVmNDI4YmJlNDQ3NzY5NGU2ZDdkN2Y=";class pP{constructor(){tr(this,"MODEL","deepseek-chat");tr(this,"feedbackCache",null);tr(this,"CACHE_TTL",6e4)}getApiUrl(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/api/deepseek/chat/completions":"https://deepseek-proxy-cms.jfsagro.workers.dev/"}getApiKey(){try{return atob(fP)}catch(t){return console.error("Ошибка расшифровки API ключа:",t),""}}async chat(t,r){const a=this.getApiKey();if(!a)throw new Error("API ключ не найден");const n=this.getFeedbackAnalysis(),o=[{role:"system",content:r?this.buildSystemPromptWithContext(r,n):this.buildSystemPrompt(n)},...t];try{const l=new AbortController,c=setTimeout(()=>l.abort(),35e3),A=this.getApiUrl(),f=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"same-origin":"cors",p=await fetch(A,{method:"POST",mode:f,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({model:this.MODEL,messages:o,temperature:.4,max_tokens:900,stream:!1}),signal:l.signal});if(clearTimeout(c),!p.ok){let g=`DeepSeek API error: ${p.status} ${p.statusText}`;try{const h=await p.json();g+=` - ${JSON.stringify(h)}`}catch{const h=await p.text().catch(()=>"");h&&(g+=` - ${h}`)}throw p.status===401||p.status===403?new Error(`API ключ недействителен или отсутствует. Статус: ${p.status}`):p.status===429?new Error("Превышен лимит запросов к API. Попробуйте позже."):new Error(g)}const u=await p.json();if(u.choices&&u.choices.length>0)return u.choices[0].message.content||"Не удалось получить ответ от ИИ";throw new Error("Неожиданный формат ответа от DeepSeek API")}catch(l){if(l instanceof Error){if(l.name==="AbortError")throw new Error("Превышено время ожидания ответа от API (30 секунд). Попробуйте еще раз.");const c=l.message.toLowerCase();if(c.includes("failed to fetch")||c.includes("networkerror"))throw new Error("Не удалось выполнить запрос к DeepSeek API через прокси. Проверьте подключение к интернету или работу Cloudflare Worker прокси.")}throw l}}async analyzeImage(t,r){if(!this.getApiKey())throw new Error("API ключ не найден");try{const n=`Проанализируй это изображение (файл: ${r}) и создай подробное текстовое описание содержимого. 
      Если это документ (договор, свидетельство, выписка, акт осмотра и т.д.), опиши его содержание, ключевые данные, даты, номера, стороны.
      Если это фотография недвижимости или имущества, опиши объект, его состояние, особенности.
      Если это график, таблица или схема, опиши данные и выводы.
      Будь максимально подробным и профессиональным.`;return await this.chat([{role:"user",content:`${n}

Файл: ${r}
Размер изображения: ${Math.round(t.length/1024)}KB
[Изображение загружено, требуется анализ содержимого]`}])}catch(n){return console.error("Ошибка анализа изображения:",n),`Изображение: ${r}. Требуется ручной анализ содержимого.`}}async generateResponse(t,r){const a=pw.analyzeQuestion(t),n=Va.getRecommendations(t);let i=r;a.detectedAssetType&&(i+=`

Тип актива: ${a.detectedAssetType}`),a.detectedRiskType&&(i+=`
Тип риска: ${a.detectedRiskType}`),a.detectedRegistrationType&&(i+=`
Тип регистрации: ${a.detectedRegistrationType}`),n.suggestedTemplate&&(i+=`

Шаблон успешного ответа для подобных вопросов:
${n.suggestedTemplate}`),n.documentInsights&&n.documentInsights.length>0&&(i+=`

Важные темы из релевантных документов:
`,n.documentInsights.forEach(l=>{i+=`
Документ "${l.documentName}":
`,l.importantTopics.slice(0,3).forEach(c=>{i+=`- ${c}
`})})),n.importantKeywords.length>0&&(i+=`

Важные ключевые слова для этого вопроса: ${n.importantKeywords.join(", ")}`);let o=await this.chat([{role:"user",content:t}],i);if(a.needsClarification&&o.length<500){const l=pw.formatClarificationQuestions(a.clarificationQuestions);o+=l}return o}getFeedbackAnalysis(){const t=Date.now();if(this.feedbackCache&&t-this.feedbackCache.timestamp<this.CACHE_TTL)return this.feedbackCache.data;try{const r=Xc.getGoodExamples(3),a=Xc.getBadExamples(3),n=Xc.analyzeDislikes(),i={goodExamples:r.map(o=>`Вопрос: ${o.question}
Ответ: ${o.answer.slice(0,200)}...`),badExamples:a.map(o=>`Вопрос: ${o.question}
Ответ: ${o.answer.slice(0,200)}...`),suggestions:n.suggestions};return this.feedbackCache={data:i,timestamp:t},i}catch(r){return console.error("Ошибка анализа обратной связи:",r),{goodExamples:[],badExamples:[],suggestions:[]}}}invalidateFeedbackCache(){this.feedbackCache=null}buildSystemPromptWithContext(t,r){let a=`Ты - ПРОФЕССИОНАЛЬНЫЙ ЭКСПЕРТ-ОЦЕНЩИК и СПЕЦИАЛИСТ ПО АНАЛИЗУ РИСКОВ в Банке. Твоя основная деятельность:

1. ОЦЕНКА ВСЕХ ВИДОВ АКТИВОВ:
   - Недвижимость (квартиры, дома, земельные участки, коммерческая недвижимость, АЗС, торговые центры)
   - Движимое имущество (автомобили, оборудование, техника, спецтехника)
   - Бизнес и предприятия (оценка бизнеса, долей, акций, предприятий)
   - Интеллектуальная собственность (патенты, товарные знаки, ноу-хау, авторские права)
   - Определение рыночной, залоговой и кадастровой стоимости
   - Расчет LTV (Loan-to-Value) для всех типов активов
   - Применение методов оценки: сравнительный, доходный, затратный подходы

2. АНАЛИЗ ВСЕХ ВОЗМОЖНЫХ РИСКОВ:
   - Кредитные риски залогового обеспечения (риск дефолта, неплатежеспособности)
   - Рыночные риски (изменение стоимости активов, ликвидность, волатильность рынка)
   - Юридические риски (права собственности, обременения, споры, оспаривание сделок)
   - Операционные риски (сохранность, повреждение, уничтожение, утрата)
   - Нетиповые и специфические риски (отраслевые, региональные, сезонные)
   - Комплексная оценка рисков по сделкам с учетом всех факторов

3. РЕГИСТРАЦИЯ ЗАЛОГА И ДОКУМЕНТООБОРОТ:
   - Регистрация ипотеки (залога недвижимости) в Росреестре
   - Регистрация залога движимого имущества
   - Регистрация залога прав (доли в ООО, акции, дебиторская задолженность)
   - Работа с ЕГРН, кадастровым учетом, выписками
   - Оформление договоров залога, соглашений об ипотеке
   - Порядок регистрации, необходимые документы, сроки
   - Особенности регистрации для разных типов активов

4. МОНИТОРИНГ И КОНТРОЛЬ:
   - Визуальный осмотр обеспечения
   - Проверка наличия и состояния залога
   - Мониторинг изменений стоимости
   - Контроль обременений и прав третьих лиц

5. ГЛАВНАЯ ЦЕЛЬ: Реализовать обеспечение для возврата заемных средств с минимальными потерями.

ОЦЕНКИ СТОИМОСТИ ВСЕГДА ДЕЛАЙ ПО СОСТОЯНИЮ НА ТЕКУЩУЮ ДАТУ ОТВЕТА.
Если в вопросе явно не указана другая дата оценки, считай датой оценки дату формирования ответа (${new Date().toLocaleDateString("ru-RU")}) и указывай это явно в формулировках.

ВАЖНО - ЗАДАВАЙ УТОЧНЯЮЩИЕ ВОПРОСЫ:
Если вопрос недостаточно конкретен или не хватает информации для точного ответа, обязательно задай 1-3 уточняющих вопроса. Это поможет дать максимально профессиональный и корректный ответ.

Примеры ситуаций, когда нужны уточнения:
- Не указан тип актива (недвижимость, движимое имущество, бизнес)
- Не указан метод оценки (сравнительный, доходный, затратный)
- Не указан тип стоимости (рыночная, залоговая, кадастровая)
- Не указан тип риска (кредитный, рыночный, юридический, операционный)
- Не указан тип регистрации (ипотека, залог движимого, залог прав)
- Недостаточно данных для расчета LTV
- Общий вопрос без конкретики

Ты консультируешь коллег-профессионалов, которые работают в той же сфере. Отвечай:
- КРАТКО и ЧЕТКО - только суть, без лишних слов
- ПРОФЕССИОНАЛЬНО - используй терминологию, ссылайся на нормативные документы (ФСО, ФЗ-135)
- ПО ДЕЛУ - фокусируйся на практических аспектах работы
- СТРУКТУРИРОВАННО - используй списки, выделяй ключевые моменты
- ЭКСПЕРТНО - демонстрируй глубокие знания в оценке и анализе рисков
- ПРОАКТИВНО - задавай уточняющие вопросы для более точных ответов

Контекст из базы знаний (справочная литература "Залоговik. Все о банковских залогах" и другие документы):
${t}

Используй эту информацию для ответа. Если в контексте нет точной информации, используй свои профессиональные знания, но укажи источник.`;return r.goodExamples.length>0&&(a+=`

Примеры хороших ответов (на что ориентироваться):
${r.goodExamples.join(`

---

`)}`),r.badExamples.length>0&&(a+=`

Примеры плохих ответов (чего избегать):
${r.badExamples.join(`

---

`)}`),r.suggestions.length>0&&(a+=`

Рекомендации по улучшению:
${r.suggestions.join(`
`)}`),ua.getEnhancedPrompt(a)}buildSystemPrompt(t){const r=new Date().toLocaleDateString("ru-RU");let a=`Ты - ПРОФЕССИОНАЛЬНЫЙ ЭКСПЕРТ-ОЦЕНЩИК и СПЕЦИАЛИСТ ПО АНАЛИЗУ РИСКОВ в Банке. Твоя основная деятельность:

1. ОЦЕНКА ВСЕХ ВИДОВ АКТИВОВ:
   - Недвижимость (квартиры, дома, земельные участки, коммерческая недвижимость)
   - Движимое имущество (автомобили, оборудование, техника)
   - Бизнес и предприятия (оценка бизнеса, долей, акций)
   - Интеллектуальная собственность (патенты, товарные знаки, ноу-хау)
   - Определение рыночной, залоговой и кадастровой стоимости
   - Расчет LTV (Loan-to-Value) для всех типов активов

2. АНАЛИЗ ВСЕХ ВОЗМОЖНЫХ РИСКОВ:
   - Кредитные риски залогового обеспечения
   - Рыночные риски (изменение стоимости активов)
   - Юридические риски (права собственности, обременения)
   - Операционные риски (сохранность, ликвидность)
   - Нетиповые и специфические риски
   - Комплексная оценка рисков по сделкам

3. РЕГИСТРАЦИЯ И ДОКУМЕНТООБОРОТ:
   - Регистрация обременений в Росреестре
   - Работа с ЕГРН, кадастровым учетом
   - Оформление документов по залогу

4. МОНИТОРИНГ И КОНТРОЛЬ:
   - Визуальный осмотр обеспечения
   - Проверка наличия и состояния залога
   - Мониторинг изменений стоимости
 
5. ГЛАВНАЯ ЦЕЛЬ: Реализовать обеспечение для возврата заемных средств с минимальными потерями.

ВАЖНО: Все стоимостные оценки (рыночная, залоговая, диапазон стоимости, дисконты) нужно давать
по состоянию на текущую дату ответа. Если в вопросе не указана другая дата оценки,
считай датой оценки "${r}" и явно указывай это в тексте (например: "по состоянию на ${r}").
 
Ты консультируешь коллег-профессионалов, которые работают в той же сфере. Отвечай:
- КРАТКО и ЧЕТКО - только суть, без лишних слов
- ПРОФЕССИОНАЛЬНО - используй терминологию, ссылайся на нормативные документы (ФСО, ФЗ-135)
- ПО ДЕЛУ - фокусируйся на практических аспектах работы
- СТРУКТУРИРОВАННО - используй списки, выделяй ключевые моменты
- ЭКСПЕРТНО - демонстрируй глубокие знания в оценке и анализе рисков
 
База знаний основана на справочной литературе "Залоговik. Все о банковских залогах" и других профессиональных документах.`;return t.goodExamples.length>0&&(a+=`

Примеры хороших ответов (на что ориентироваться):
${t.goodExamples.join(`

---

`)}`),t.badExamples.length>0&&(a+=`

Примеры плохих ответов (чего избегать):
${t.badExamples.join(`

---

`)}`),t.suggestions.length>0&&(a+=`

Рекомендации по улучшению:
${t.suggestions.join(`
`)}`),ua.getEnhancedPrompt(a)}}const fd=new pP,hP=e=>{if(!e||typeof e!="string")return console.warn("Ответ ИИ пуст или не является строкой"),null;const t=e.match(/```(?:json)?\s*(\{[\s\S]*?\})\s*```/);if(t&&t[1])try{return JSON.parse(t[1])}catch(o){console.warn("Не удалось распарсить JSON из markdown блока:",o)}let r=0,a=-1,n=-1;for(let o=0;o<e.length;o++)if(e[o]==="{")a===-1&&(a=o),r++;else if(e[o]==="}"&&(r--,r===0&&a!==-1)){n=o;break}if(a!==-1&&n!==-1&&n>a){const o=e.substring(a,n+1);try{return JSON.parse(o)}catch(l){console.warn("Не удалось распарсить JSON с балансом скобок, пробуем без блока comparables:",l);try{const c=o.replace(/"comparables"\s*:\s*\[[\s\S]*?\](\s*,)?/m,"");return JSON.parse(c)}catch(c){console.warn("Не удалось распарсить JSON после удаления comparables:",c)}}}const i=e.match(/\{[\s\S]*\}/);if(i)try{return JSON.parse(i[0])}catch(o){console.warn("Не удалось распарсить JSON простым regex:",o)}try{return JSON.parse(e.trim())}catch{}return console.warn("Не удалось извлечь JSON из ответа ИИ. Ответ:",e.substring(0,200)),null},mP=e=>{if(!e||typeof e!="object")throw new Error("ИИ не вернул корректный ответ. Попробуйте повторить запрос.");const t=(l,c)=>{const A=Number(typeof l=="string"?l.replace(/[^0-9.-]+/g,""):l);return Number.isFinite(A)&&A>0?A:c},r=t(e.marketValue??e.market_price,0),a=t(e.collateralValue??e.secured_value,r*.7),n=t(e.recommendedLtv??e.ltv??a/(r||1)*100,70);if(r===0||a===0)throw new Error("ИИ не смог рассчитать стоимость объекта. Убедитесь, что предоставлены все необходимые данные и попробуйте повторить запрос.");const i=l=>{if(Array.isArray(l))return l.map(c=>{if(typeof c=="string"){const A=/https?:\/\/[^\s)\]}>"]+/,d=c.match(A);if(d){const f=d[0].replace(/[.,;:!?]+$/,"");return{description:c.replace(d[0],"").trim().replace(/\s*-\s*$/,"").trim(),url:f}}return c}else if(typeof c=="object"&&c!==null)return{description:c.description||c.text||String(c),url:c.url||c.link,imageUrl:c.imageUrl||c.image||c.photo};return String(c)})};return{summary:e.summary||e.justification||e.analysis||"Проанализируйте объект дополнительными методами.",marketValue:r,collateralValue:a,recommendedLtv:Math.min(100,Math.max(0,Math.round(n))),confidence:e.confidence||"medium",methodology:e.methodology||e.method||"Комплексный анализ с использованием доступных методов оценки",riskFactors:Array.isArray(e.riskFactors)?e.riskFactors:[],recommendedActions:Array.isArray(e.recommendations)?e.recommendations:[],assumptions:Array.isArray(e.assumptions)?e.assumptions:[],comparables:i(e.comparables)}},jy={async generateEstimate(e){var A;const t=[`Категория: ${e.assetGroup}`,`Тип: ${e.assetType}`];if(e.location&&t.push(`Локация: ${e.location}`),e.area&&t.push(`Площадь/объём: ${e.area}${e.areaUnit||"м²"}`),e.condition&&t.push(`Состояние: ${e.condition}`),e.incomePerYear&&t.push(`Чистый доход в год: ${e.incomePerYear} ₽`),e.occupancy&&t.push(`Заполняемость/использование: ${e.occupancy}`),e.purpose&&t.push(`Цель оценки: ${e.purpose}`),e.additionalFactors&&t.push(`Особенности: ${e.additionalFactors}`),e.card){const d=e.card;if(t.push(`Данные карточки: статус ${d.status}, категория ${d.mainCategory}, оценка ${d.marketValue||"—"}, залоговая ${d.pledgeValue||"—"}`),(A=d.address)!=null&&A.fullAddress&&t.push(`Адрес из карточки: ${d.address.fullAddress}`),d.characteristics){const f=["totalArea","totalAreaSqm","yearBuilt","objectCadastralNumber"].map(p=>d.characteristics[p]).filter(Boolean);f.length>0&&t.push(`Характеристики из карточки: ${f.join(", ")}`)}}const r=new Date,a=r.toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),n=r.getFullYear(),i=r.getMonth()+1;let o=`Ты действуешь как главный банковский оценщик. На основе предоставленных данных оцени объект и верни ТОЛЬКО валидный JSON без дополнительного текста, комментариев или markdown разметки.

КРИТИЧЕСКИ ВАЖНО: Верни ТОЛЬКО JSON объект, без markdown блоков, без пояснений до или после JSON. Начни ответ сразу с открывающей фигурной скобки { и закончи закрывающей }.

ВАЖНО - АКТУАЛЬНАЯ ДАТА ОЦЕНКИ:
Текущая дата: ${a} (${n} год, ${i} месяц).
Все расчеты и оценки должны быть выполнены на эту дату. Используй актуальные рыночные данные на ${n} год. При указании аналогов используй актуальные цены на ${a}. Не используй устаревшие данные из прошлых периодов.

Структура JSON:
{
  "summary": "краткое обоснование оценки",
  "marketValue": 0,
  "collateralValue": 0,
  "recommendedLtv": 0,
  "confidence": "high|medium|low",
  "methodology": "описание применённых подходов",
  "riskFactors": ["..."],
  "recommendedActions": ["..."],
  "assumptions": ["..."],
  "comparables": [
    "описание аналога 1 с URL: https://example.com/analog1",
    {
      "description": "описание аналога 2",
      "url": "https://example.com/analog2",
      "imageUrl": "https://example.com/image2.jpg"
    }
  ]
}

ВАЖНО для comparables:
- Если используешь строки, включай URL прямо в текст (например: "Nissan Teana 2.4 2004, 140тыс.км - 280 000 руб. https://avito.ru/item123")
- Если используешь объекты, указывай description, url (ссылка на источник) и imageUrl (ссылка на изображение аналога, если доступна)
- Старайся находить реальные ссылки на аналоги с сайтов объявлений (Avito, Drom, Циан и т.д.)

Указывай значения в рублях. Если данных недостаточно, делай профессиональные допущения и фиксируй их в assumptions.`;if(e.skills){const d=e.skills,f=[];d.incomeApproach>0&&(f.push(`Доходный подход (приоритет: ${d.incomeApproach}%):`),d.incomeMethods.dcf>50&&f.push(`- Дисконтирование денежных потоков (DCF) - приоритет ${d.incomeMethods.dcf}%`),d.incomeMethods.directCapitalization>50&&f.push(`- Прямая капитализация - приоритет ${d.incomeMethods.directCapitalization}%`),d.incomeMethods.grossRentMultiplier>50&&f.push(`- Множитель валового дохода - приоритет ${d.incomeMethods.grossRentMultiplier}%`)),d.comparativeApproach>0&&(f.push(`Сравнительный подход (приоритет: ${d.comparativeApproach}%):`),d.comparativeMethods.salesComparison>50&&f.push(`- Сравнение продаж - приоритет ${d.comparativeMethods.salesComparison}%`),d.comparativeMethods.marketExtraction>50&&f.push(`- Извлечение из рынка - приоритет ${d.comparativeMethods.marketExtraction}%`)),d.costApproach>0&&(f.push(`Затратный подход (приоритет: ${d.costApproach}%):`),d.costMethods.replacementCost>50&&f.push(`- Стоимость замещения - приоритет ${d.costMethods.replacementCost}%`),d.costMethods.reproductionCost>50&&f.push(`- Стоимость воспроизводства - приоритет ${d.costMethods.reproductionCost}%`),d.costMethods.depreciation>50&&f.push(`- Учет износа - приоритет ${d.costMethods.depreciation}%`)),f.length>0&&(o+=`

Настройки приоритетов методов оценки:
${f.join(`
`)}

Используй указанные методы и приоритеты при расчете оценки.`)}let l=null;const c=2;for(let d=1;d<=c;d++)try{const f=await fd.chat([{role:"user",content:`Оцени объект "${e.objectName}" и верни ТОЛЬКО валидный JSON без дополнительного текста. ОБЯЗАТЕЛЬНО используй все доступные методы оценки (доходный, сравнительный, затратный подходы) и проведи комплексный анализ. Не используй эвристические расчеты.

Данные:
${t.join(`
`)}

Верни ответ в формате чистого JSON, начиная с { и заканчивая }. Без markdown блоков, без пояснений.`}],o+`

ВАЖНО: Всегда используй профессиональные методы оценки (доходный, сравнительный, затратный подходы). Никогда не используй эвристические расчеты. Если данных недостаточно, сделай профессиональные допущения и четко укажи их в assumptions.

КРИТИЧЕСКИ ВАЖНО: Верни ТОЛЬКО JSON объект, без markdown разметки (\`\`\`json), без пояснений до или после JSON. Начни ответ сразу с { и закончи }.`),p=hP(f);if(!p)throw new Error("ИИ не вернул JSON в ответе");const u=mP(p);return Va.addCategoryExperience("appraisal",4),u}catch(f){if(l=f instanceof Error?f:new Error(String(f)),console.error(`Ошибка генерации оценки через AI (попытка ${d}/${c}):`,f),d===c)throw Va.addCategoryExperience("appraisal",1),new Error(`Не удалось получить оценку от ИИ после ${c} попыток. ${l.message}. Пожалуйста, проверьте данные и попробуйте еще раз.`);await new Promise(p=>setTimeout(p,1500*d))}throw l||new Error("Неизвестная ошибка при генерации оценки")}},PC="ai_appraisal_results",Vg=()=>{try{const e=localStorage.getItem(PC);return e?JSON.parse(e):[]}catch(e){return console.error("Ошибка загрузки AI оценок:",e),[]}},hw=e=>{try{localStorage.setItem(PC,JSON.stringify(e))}catch(t){console.error("Ошибка сохранения AI оценок:",t)}},qh={getAll(){return Vg()},getByCard(e){return Vg().filter(t=>t.cardId===e)},getLatestByCard(e){const t=qh.getByCard(e);return t.length===0?null:t.sort((r,a)=>r.createdAt>a.createdAt?-1:1)[0]},add(e){const t=Vg(),r={...e,id:`ai-appraisal-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,createdAt:new Date().toISOString()};return t.push(r),hw(t),r},clear(){hw([])}},$g=[{key:"real_estate",label:"Недвижимое имущество",description:"Здания, помещения, коммерческие объекты, АЗС, склады",keywords:["недвиж","здан","помещ","офис","торгов","склад","азс","сооруж","комплекс","жил","нежил","центр"]},{key:"land",label:"Земельные участки",description:"Земля в собственности или аренде",keywords:["земель","участ","аграр","сельск","пастбищ","кадастр"]},{key:"movable",label:"Движимое имущество",description:"Оборудование, транспорт, спецтехника, ЖД состав",keywords:["движим","оборуд","машин","транспорт","спецтех","подвиж","состав","вагон","автотранспорт","техника","суда","кораб","флот"]},{key:"metals_goods",label:"Товары и материалы",description:"Будущий урожай, товары в обороте, металлы, сырьё",keywords:["урожай","товар","сырь","металл","драгоцен","материал","запас"]},{key:"equity",label:"Доли, акции и ценные бумаги",description:"Доли в УК, акции, паи, ценные бумаги",keywords:["дол","уставн","акци","ценн","па","вексел","облигац","ипотечн","сертификат"]},{key:"rights",label:"Права и требования",description:"Права требования, интеллектуальная собственность, договоры",keywords:["прав","требован","интеллект","собствен","договор","депозит","банк","ип"]}],gP=e=>e.toLowerCase().replace(/[^a-z0-9а-яё]+/gi,"-").replace(/^-+|-+$/g,""),xP=()=>{try{return Tn.getDictionaryByCode("collateral_attributes")||null}catch(e){return console.warn("Не удалось загрузить справочник атрибутов залога для таксономии:",e),null}},yP=()=>{const e=xP();if(!e)return $g.map(n=>({key:n.key,label:n.label,description:n.description,types:[]}));const t=new Map;e.items.forEach(n=>{var c;const i=(c=n.metadata)==null?void 0:c.group;if(!i)return;const o=i.trim();if(!o)return;const l=gP(o);t.has(l)||t.set(l,{key:l,label:o,sourceGroup:o})});const r=[],a=$g.map(n=>({key:n.key,label:n.label,description:n.description,types:[]}));return t.forEach(n=>{const i=n.sourceGroup.toLowerCase(),o=a.find(l=>{var c;return l&&l.key?(c=$g.find(A=>A.key===l.key))==null?void 0:c.keywords.some(A=>i.includes(A)):!1});o?o.types.push(n):r.push(n)}),r.length>0&&a.push({key:"other",label:"Прочие активы и требования",description:"Категории активов из справочников, не вошедшие в основные группы",types:r}),a.forEach(n=>{n.types.sort((i,o)=>i.label.localeCompare(o.label,"ru"))}),a},{Title:vP,Text:cs}=ht,wP=({card:e})=>{var Ae,ue,he,ve,we,se,He;const t=$i(),[r,a]=M.useState([]),[n,i]=M.useState(!1),[o,l]=M.useState(!1),[c,A]=M.useState(null),[d,f]=M.useState([]),[p,u]=M.useState(!1),[g,h]=M.useState(!1),[x]=re.useForm(),y=M.useMemo(()=>yP(),[]),v=M.useCallback(async()=>{i(!0);try{const Ee=await Ba.getInspectionsByCardId(e.id);a(Ee)}catch(Ee){console.error("Ошибка загрузки осмотров:",Ee)}finally{i(!1)}},[e.id]);M.useEffect(()=>{v()},[v]),M.useEffect(()=>{f(qh.getByCard(e.id))},[e.id]);const E=Ee=>{A(Ee),l(!0)},k=()=>{var pe,ce,Ge,et,Ye,tt;const Ee=_;x.setFieldsValue({assetGroup:Ee.assetGroup,assetType:Ee.assetType,location:(pe=e.address)==null?void 0:pe.fullAddress,area:((ce=e.characteristics)==null?void 0:ce.totalAreaSqm)||((Ge=e.characteristics)==null?void 0:Ge.totalArea),areaUnit:"м²",condition:((et=e.characteristics)==null?void 0:et.STATE)||((Ye=e.characteristics)==null?void 0:Ye.CONDITION)||((tt=e.characteristics)==null?void 0:tt.condition),purpose:"Обновление карточки обеспечения",additionalFactors:e.notes}),u(!0)},S=async()=>{var Ee;try{const pe=await x.validateFields();h(!0);const ce=await jy.generateEstimate({objectName:e.name||pe.assetType||"Объект обеспечения",assetGroup:pe.assetGroup,assetType:pe.assetType,location:pe.location||((Ee=e.address)==null?void 0:Ee.fullAddress),area:pe.area?Number(pe.area):void 0,areaUnit:pe.areaUnit,condition:pe.condition,incomePerYear:pe.incomePerYear?Number(pe.incomePerYear):void 0,purpose:pe.purpose,additionalFactors:pe.additionalFactors,card:e}),Ge=qh.add({cardId:e.id,objectId:e.id,objectName:e.name||"Объект обеспечения",estimate:ce,input:{objectName:e.name||"Объект обеспечения",assetGroup:pe.assetGroup,assetType:pe.assetType,location:pe.location,area:pe.area?Number(pe.area):void 0,areaUnit:pe.areaUnit,condition:pe.condition,incomePerYear:pe.incomePerYear?Number(pe.incomePerYear):void 0,purpose:pe.purpose,additionalFactors:pe.additionalFactors,card:e}});f(et=>[Ge,...et]),Ne.success("AI оценка сохранена для карточки"),u(!1)}catch(pe){if(pe!=null&&pe.errorFields)return;console.error("Ошибка выполнения AI оценки карточки:",pe),Ne.error("Не удалось выполнить оценку ИИ")}finally{h(!1)}},B=Ee=>{switch(Ee){case"editing":return"orange";case"approved":return"green";default:return"default"}},b=Ee=>{switch(Ee){case"editing":return"Редактирование";case"approved":return"Согласовано";default:return Ee}},O=Ee=>{switch(Ee){case"real_estate":return"real_estate";case"movable":return"movable";case"property_rights":return"rights";default:return"real_estate"}},_=M.useMemo(()=>{if(y.length===0)return{assetGroup:void 0,assetType:void 0};const Ee=O(e.mainCategory);let pe=y.find(Ge=>Ge.key===Ee);pe||(pe=y[0]);let ce=pe==null?void 0:pe.types.find(Ge=>{var et;return Ge.label===e.propertyType||Ge.label===((et=e.classification)==null?void 0:et.level2)});return!ce&&(pe!=null&&pe.types.length)&&(ce=pe.types[0]),{assetGroup:pe==null?void 0:pe.key,assetType:ce==null?void 0:ce.key}},[e.classification,e.mainCategory,e.propertyType,y]),U=M.useMemo(()=>d.length===0?null:[...d].sort((Ee,pe)=>Ee.createdAt>pe.createdAt?-1:1)[0],[d]),I=()=>{switch(e.mainCategory){case"real_estate":return s.jsx(mh,{});case"movable":return s.jsx(GT,{});case"property_rights":return s.jsx(Zf,{});default:return s.jsx(HT,{})}},R=()=>{switch(e.mainCategory){case"real_estate":return"Недвижимость";case"movable":return"Движимое имущество";case"property_rights":return"Имущественные права";default:return"Неизвестно"}},L=Ee=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(Ee),N=M.useMemo(()=>e.propertyType?Ph(e.propertyType):[],[e.propertyType]),P=M.useMemo(()=>UC(N),[N]),Q=M.useMemo(()=>{var Ee;return(Ee=e.partners)==null?void 0:Ee.find(pe=>{var ce;return pe.role==="owner"||pe.role==="pledgor"&&!((ce=e.partners)!=null&&ce.find(Ge=>Ge.role==="owner"))})},[e.partners]),Y=M.useMemo(()=>{var Ee;return(Ee=e.partners)==null?void 0:Ee.find(pe=>pe.role==="pledgor")},[e.partners]),ee=M.useMemo(()=>{if(!e.egrnStatementDate||e.mainCategory!=="real_estate")return!1;const Ee=We(e.egrnStatementDate);return We().diff(Ee,"days")>30},[e.egrnStatementDate,e.mainCategory]),V=()=>{var pe,ce;const Ee=((pe=e.address)==null?void 0:pe.cadastralNumber)||((ce=e.characteristics)==null?void 0:ce.objectCadastralNumber);t(`/egrn?objectId=${e.id}&cadastralNumber=${Ee}&objectName=${encodeURIComponent(e.name||"")}`)},G=()=>{e.contractId?t(`/portfolio?contractId=${e.contractId}`):e.contractNumber?t(`/portfolio?contractNumber=${e.contractNumber}`):e.reference&&t(`/portfolio?reference=${e.reference}`)},z=()=>{e.reference&&window.open(`#/portfolio?reference=${e.reference}`,"_blank")},C=e.propertyType||((Ae=e.classification)==null?void 0:Ae.level2)||"",D=M.useMemo(()=>sP(C),[C]),j=M.useMemo(()=>iP(C),[C]),K=Ee=>Ee==null||Ee===""?"—":typeof Ee=="boolean"?Ee?"Да":"Нет":typeof Ee=="number"?String(Ee):typeof Ee=="string"&&Ee.match(/^\d{4}-\d{2}-\d{2}/)?We(Ee).format("DD.MM.YYYY"):String(Ee),W=[{key:"1",label:"Главная",children:s.jsxs("div",{children:[s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Наименование (NAME_OF_PROPERTY)",span:2,children:e.name||"—"}),s.jsx(ye.Item,{label:"Адрес",span:2,children:((ue=e.address)==null?void 0:ue.fullAddress)||"—"}),s.jsx(ye.Item,{label:"Заемщик",span:1,children:(Q==null?void 0:Q.organizationName)||`${(Q==null?void 0:Q.lastName)||""} ${(Q==null?void 0:Q.firstName)||""} ${(Q==null?void 0:Q.middleName)||""}`.trim()||"—"}),s.jsx(ye.Item,{label:"ИНН заемщика",span:1,children:(Q==null?void 0:Q.inn)||"—"}),s.jsx(ye.Item,{label:"Залогодатель (OWNER_TIN)",span:1,children:(Y==null?void 0:Y.organizationName)||`${(Y==null?void 0:Y.lastName)||""} ${(Y==null?void 0:Y.firstName)||""} ${(Y==null?void 0:Y.middleName)||""}`.trim()||"—"}),s.jsx(ye.Item,{label:"ИНН залогодателя (OWNER_TIN)",span:1,children:(Y==null?void 0:Y.inn)||"—"}),e.propertyType&&s.jsx(ye.Item,{label:"Тип имущества",span:2,children:e.propertyType})]}),P.characteristics.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Характеристики"}),s.jsx(ye,{bordered:!0,column:2,size:"small",children:P.characteristics.map(Ee=>{var ce;const pe=(ce=e.characteristics)==null?void 0:ce[Ee.code];return pe==null||pe===""?null:s.jsx(ye.Item,{label:Ee.name,span:Ee.code==="NAME_OF_PROPERTY"?2:1,children:K(pe)},Ee.code)})})]})]})},{key:"2",label:"Характеристики",children:s.jsx("div",{children:P.characteristics.length>0?s.jsx(ye,{bordered:!0,column:2,size:"small",children:P.characteristics.map(Ee=>{var ce;const pe=(ce=e.characteristics)==null?void 0:ce[Ee.code];return pe==null||pe===""?null:s.jsx(ye.Item,{label:Ee.name,children:K(pe)},Ee.code)})}):s.jsx(ht.Text,{type:"secondary",children:"Характеристики не указаны"})})},{key:"3",label:"Документы",children:s.jsxs("div",{children:[e.documents&&e.documents.length>0?s.jsx(Qt,{dataSource:e.documents,renderItem:Ee=>s.jsx(Qt.Item,{children:s.jsxs(Te,{children:[s.jsx(jr,{}),s.jsx(cs,{strong:!0,children:Ee.name}),s.jsxs(cs,{type:"secondary",children:["(",Ee.type,")"]}),Ee.uploadDate&&s.jsxs(cs,{type:"secondary",children:["- ",new Date(Ee.uploadDate).toLocaleDateString("ru-RU")]})]})})}):s.jsx(ht.Text,{type:"secondary",children:"Документы не загружены"}),s.jsx(jt,{}),s.jsxs(Te,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Be,{type:"link",icon:s.jsx(go,{}),onClick:z,style:{paddingLeft:0},children:"Перейти в Залоговое досье"}),j&&s.jsxs("div",{children:[s.jsx(ye,{bordered:!0,column:1,size:"small",children:s.jsx(ye.Item,{label:"Дата выписки ЕГРН",children:e.egrnStatementDate?We(e.egrnStatementDate).format("DD.MM.YYYY"):"—"})}),ee&&s.jsx(Be,{type:"primary",danger:!0,icon:s.jsx($1,{}),onClick:V,style:{marginTop:16},children:"Заказать выписку ЕГРН (выписка более 30 дней)"})]})]})]})},{key:"4",label:"Заметки",children:s.jsx("div",{children:s.jsxs(ye,{bordered:!0,column:1,size:"small",children:[s.jsx(ye.Item,{label:"Комментарии",children:e.notes||"—"}),s.jsx(ye.Item,{label:"Отлагательные условия",children:e.suspensiveConditions||"—"})]})})},{key:"5",label:"Оценка",children:s.jsxs("div",{children:[s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(pt,{title:"Рыночная стоимость",value:e.marketValue||0,formatter:Ee=>L(Number(Ee)),valueStyle:{color:"#3f8600"}})}),s.jsx(be,{span:12,children:s.jsx(pt,{title:"Залоговая стоимость",value:e.pledgeValue||0,formatter:Ee=>L(Number(Ee)),valueStyle:{color:"#1890ff"}})})]}),s.jsx(jt,{}),s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Наличие ликвидного рынка (HAVEL_MARKET)",children:(he=e.characteristics)!=null&&he.HAVEL_MARKET?"Да":"Нет"}),s.jsx(ye.Item,{label:"Тип обеспечения (TYPE_COLLATERAL)",children:((ve=e.characteristics)==null?void 0:ve.TYPE_COLLATERAL)||"—"}),P.evaluation.map(Ee=>{var ce;const pe=(ce=e.characteristics)==null?void 0:ce[Ee.code];return pe==null||pe===""?null:s.jsx(ye.Item,{label:Ee.name,children:K(pe)},Ee.code)})]})]})},{key:"6",label:"Договор",children:s.jsxs("div",{children:[s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"REFERENCE сделки",span:2,children:e.reference||"—"}),s.jsx(ye.Item,{label:"Номер договора",span:2,children:e.contractNumber||"—"})]}),(e.reference||e.contractNumber)&&s.jsx(Be,{type:"primary",icon:s.jsx(go,{}),onClick:G,style:{marginTop:16},children:"Перейти к договору в портфеле"})]})},{key:"9",label:s.jsxs(Te,{children:[s.jsx(Ml,{}),"Оценка ИИ"]}),children:s.jsxs("div",{children:[U?s.jsxs(s.Fragment,{children:[s.jsx(Nr,{type:"info",showIcon:!0,message:`Рыночная стоимость: ${L(U.estimate.marketValue)} · Залоговая: ${L(U.estimate.collateralValue)}`,description:s.jsxs("div",{children:[s.jsx(cs,{strong:!0,children:"Методология:"})," ",U.estimate.methodology,s.jsx("br",{}),s.jsx(cs,{strong:!0,children:"Уровень уверенности:"})," ",U.estimate.confidence,s.jsx("br",{}),s.jsx(cs,{strong:!0,children:"Риски:"})," ",U.estimate.riskFactors.join("; ")||"не выявлены",s.jsx("br",{}),s.jsx(cs,{strong:!0,children:"Рекомендации:"})," ",U.estimate.recommendedActions.join("; ")||"—"]}),style:{marginBottom:16}}),U.estimate.summary&&s.jsxs(ht.Paragraph,{children:[s.jsx(cs,{strong:!0,children:"Краткие выводы:"})," ",U.estimate.summary]})]}):s.jsx(Sr,{description:"Оценка ИИ ещё не выполнялась"}),s.jsx(jt,{}),s.jsx(Te,{wrap:!0,children:s.jsx(Be,{type:"primary",icon:s.jsx(Ml,{}),onClick:k,children:"Запросить новую оценку"})}),d.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{}),s.jsx(Qt,{header:"История AI оценок",dataSource:d,renderItem:Ee=>s.jsx(Qt.Item,{children:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsx(cs,{strong:!0,children:We(Ee.createdAt).format("DD.MM.YYYY HH:mm")}),s.jsxs(cs,{children:["Рыночная: ",L(Ee.estimate.marketValue)," · Залоговая:"," ",L(Ee.estimate.collateralValue)]}),s.jsx(cs,{type:"secondary",children:Ee.estimate.summary})]})})})]})]})},...D?[{key:"7",label:s.jsxs(Te,{children:[s.jsx(Ao,{}),"Осмотры (",r.length,")"]}),children:s.jsxs("div",{children:[s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between",marginBottom:16},children:[s.jsx(cs,{strong:!0,children:"Осмотры объекта"}),s.jsx(Be,{size:"small",icon:s.jsx(Ml,{}),onClick:k,children:"Оценка ИИ"})]}),n?s.jsx(Sr,{description:"Загрузка осмотров..."}):r.length===0?s.jsx(Sr,{description:"Осмотры отсутствуют"}):s.jsx(Qt,{dataSource:r,renderItem:Ee=>s.jsx(Qt.Item,{actions:[s.jsx(Be,{type:"link",onClick:()=>E(Ee.id),children:"Открыть"})],children:s.jsx(Qt.Item.Meta,{title:s.jsxs(Te,{children:[s.jsx("span",{children:Ee.inspectionType}),s.jsx(Ze,{color:Ee.status==="approved"?"green":Ee.status==="submitted_for_review"?"purple":Ee.status==="in_progress"?"orange":Ee.status==="needs_revision"?"red":"blue",children:Ee.status==="approved"?"Согласован":Ee.status==="submitted_for_review"?"На проверке":Ee.status==="in_progress"?"В процессе":Ee.status==="needs_revision"?"Требует доработки":Ee.status==="scheduled"?"Запланирован":Ee.status})]}),description:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs(cs,{type:"secondary",children:["Дата: ",We(Ee.inspectionDate).format("DD.MM.YYYY HH:mm")]}),s.jsxs(cs,{type:"secondary",children:["Исполнитель: ",Ee.inspectorName,Ee.inspectorType==="client"&&s.jsx(Ze,{color:"orange",style:{marginLeft:8},children:"Клиент"})]}),Ee.photos&&Ee.photos.length>0&&s.jsxs(cs,{type:"secondary",children:["Фотографий: ",Ee.photos.length]})]})})})}),s.jsx(jt,{}),s.jsx(Be,{type:"primary",icon:s.jsx(Ao,{}),onClick:()=>t(`/cms-check?cardId=${e.id}`),children:"Создать осмотр"})]})}]:[],...j?[{key:"8",label:s.jsxs(Te,{children:[s.jsx(tf,{}),"Выписка ЕГРН"]}),children:s.jsxs("div",{children:[s.jsxs(ye,{bordered:!0,column:1,size:"small",children:[s.jsx(ye.Item,{label:"Дата выписки ЕГРН",children:e.egrnStatementDate?We(e.egrnStatementDate).format("DD.MM.YYYY"):"—"}),s.jsx(ye.Item,{label:"Кадастровый номер",children:((we=e.address)==null?void 0:we.cadastralNumber)||((se=e.characteristics)==null?void 0:se.objectCadastralNumber)||"—"})]}),s.jsx(jt,{}),s.jsxs(Te,{direction:"vertical",style:{width:"100%"},children:[ee&&s.jsx(Be,{type:"primary",danger:!0,icon:s.jsx($1,{}),onClick:V,children:"Заказать выписку ЕГРН (выписка более 30 дней)"}),s.jsx(Be,{type:"default",icon:s.jsx(tf,{}),onClick:()=>{var pe,ce;const Ee=((pe=e.address)==null?void 0:pe.cadastralNumber)||((ce=e.characteristics)==null?void 0:ce.objectCadastralNumber);t(`/egrn?objectId=${e.id}&cadastralNumber=${Ee}&objectName=${encodeURIComponent(e.name||"")}`)},children:"Перейти в модуль ЕГРН"})]})]})}]:[]];return s.jsxs("div",{className:"collateral-card-view",children:[s.jsx(Ue,{className:"card-header-section",children:s.jsx(dt,{gutter:[16,16],align:"middle",children:s.jsx(be,{flex:"auto",children:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs(Te,{children:[I(),s.jsx(vP,{level:3,style:{margin:0},children:e.name})]}),s.jsxs(Te,{children:[s.jsx(Ze,{color:"blue",children:e.number}),s.jsx(Ze,{color:B(e.status),children:b(e.status)}),s.jsx(Ze,{children:R()}),e.propertyType&&s.jsx(Ze,{color:"purple",children:e.propertyType})]})]})})})}),s.jsx(Ue,{style:{marginTop:16},children:s.jsx(ri,{items:W,defaultActiveKey:"1"})}),s.jsx(MC,{visible:o,inspectionId:c,onClose:()=>{l(!1),A(null),v()},onApprove:async Ee=>{await Ba.approveInspection(Ee,"Система"),v()},onRequestRevision:async(Ee,pe)=>{await Ba.requestRevision(Ee,"Система",pe),v()}}),s.jsx(cr,{title:"AI-оценка объекта",open:p,onOk:S,onCancel:()=>u(!1),confirmLoading:g,okText:"Запросить оценку",cancelText:"Отмена",children:s.jsxs(re,{layout:"vertical",form:x,children:[s.jsx(re.Item,{label:"Категория",name:"assetGroup",rules:[{required:!0,message:"Выберите категорию"}],children:s.jsx(Ve,{options:y.map(Ee=>({label:Ee.label,value:Ee.key})),onChange:()=>x.setFieldsValue({assetType:void 0})})}),s.jsx(re.Item,{label:"Тип актива",name:"assetType",dependencies:["assetGroup"],rules:[{required:!0,message:"Выберите тип актива"}],children:s.jsx(Ve,{placeholder:"Выберите тип",options:((He=y.find(Ee=>Ee.key===x.getFieldValue("assetGroup")))==null?void 0:He.types.map(Ee=>({label:Ee.label,value:Ee.key})))||[]})}),s.jsx(re.Item,{label:"Локация",name:"location",children:s.jsx(Re,{placeholder:"Адрес или регион"})}),s.jsx(re.Item,{label:"Площадь / объем",name:"area",children:s.jsx(pa,{style:{width:"100%"},min:0,placeholder:"Например, 1200"})}),s.jsx(re.Item,{label:"Единица измерения",name:"areaUnit",initialValue:"м²",children:s.jsx(Re,{placeholder:"м², га, шт."})}),s.jsx(re.Item,{label:"Состояние",name:"condition",children:s.jsx(Re,{placeholder:"Например, требует ремонта"})}),s.jsx(re.Item,{label:"Чистый доход (₽/год)",name:"incomePerYear",children:s.jsx(pa,{style:{width:"100%"},min:0})}),s.jsx(re.Item,{label:"Цель оценки",name:"purpose",children:s.jsx(Re,{placeholder:"Например, актуализация стоимости"})}),s.jsx(re.Item,{label:"Дополнительные факторы",name:"additionalFactors",children:s.jsx(Re.TextArea,{rows:3,placeholder:"Обременения, особенности участка, условия эксплуатации..."})})]})})]})},EP=({data:e,loading:t,onEdit:r,onView:a,onDelete:n,onDoubleClick:i})=>{const o=e,l=[{title:"№",dataIndex:"number",key:"number",width:100,fixed:"left",sorter:(c,A)=>c.number.localeCompare(A.number)},{title:"Наименование",dataIndex:"name",key:"name",width:250,sorter:(c,A)=>c.name.localeCompare(A.name),render:(c,A)=>s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:c}),s.jsx("div",{style:{fontSize:12,color:"var(--ant-color-text-secondary)"},children:A.classification.level1})]})},{title:"Тип",dataIndex:"mainCategory",key:"mainCategory",width:120,filters:[{text:"Недвижимость",value:"real_estate"},{text:"Движимое имущество",value:"movable"},{text:"Имущественные права",value:"property_rights"}],onFilter:(c,A)=>A.mainCategory===c,render:c=>{const d={real_estate:{color:"blue",text:"Недвижимость"},movable:{color:"green",text:"Движимое"},property_rights:{color:"orange",text:"Имущественные права"}}[c]||{color:"default",text:c||"Не указано"};return s.jsx(Ze,{color:d.color,children:d.text})}},{title:"Статус",dataIndex:"status",key:"status",width:120,filters:[{text:"Редактирование",value:"editing"},{text:"Согласовано",value:"approved"},{text:"Архив",value:"archived"}],onFilter:(c,A)=>A.status===c,render:c=>{const d={editing:{color:"orange",text:"Редактирование"},approved:{color:"green",text:"Согласовано"},archived:{color:"default",text:"Архив"}}[c]||{color:"default",text:c||"Не указано"};return s.jsx(Ze,{color:d.color,children:d.text})}},{title:"Адрес",dataIndex:"addresses",key:"address",width:300,render:c=>{var A;return s.jsx("div",{children:((A=c==null?void 0:c[0])==null?void 0:A.fullAddress)||"Не указан"})}},{title:"Дата создания",dataIndex:"createdAt",key:"createdAt",width:120,sorter:(c,A)=>new Date(c.createdAt).getTime()-new Date(A.createdAt).getTime(),render:c=>new Date(c).toLocaleDateString("ru-RU")},{title:"Действия",key:"actions",width:120,fixed:"right",render:(c,A)=>s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsx(Kr,{title:"Просмотр",children:s.jsx(Be,{type:"text",icon:s.jsx(Ii,{}),size:"small",onClick:()=>a(A.id)})}),s.jsx(Kr,{title:"Редактировать",children:s.jsx(Be,{type:"text",icon:s.jsx(Rs,{}),size:"small",onClick:()=>r(A.id)})}),s.jsx(Kr,{title:"Удалить",children:s.jsx(Be,{type:"text",icon:s.jsx(Oi,{}),size:"small",danger:!0,onClick:()=>n(A.id)})})]})}];return s.jsx("div",{className:"registry-table-container",children:s.jsx(ir,{columns:l,dataSource:o,loading:t,rowKey:"id",scroll:{x:1200},pagination:{pageSize:30,showSizeChanger:!0,showQuickJumper:!0,showTotal:(c,A)=>`Показано ${A[0]}-${A[1]} из ${c} записей`,pageSizeOptions:["15","30","50","100"]},onRow:c=>({onDoubleClick:()=>i(c),style:{cursor:"pointer"}}),size:"middle",className:"registry-table"})})},ba=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,zs=e=>e[Math.floor(Math.random()*e.length)],bP=["КБ","СРБ","МСБ","КК"],_P=["СВХ","КК","МСБ","КБ"],CP=["Кредитная линия. Единый продукт.","Кредит на пополнение оборотных средств","Инвестиционный кредит","Овердрафт"],mw=['ООО "Рога и Копыта"','ООО "Вектор"','ООО "Альфа"','ООО "Бета"','ООО "Гамма"','ООО "Дельта"','ООО "Омега"','ООО "Сигма"','ООО "Тета"','ООО "Фи"','ООО "ЭНЕРГИЯ-Плюс"','ООО "Ромашка"','ООО "Протуберанец"','ООО "Сибирь-Холод"'],BP=["договор залога недвижимого имущества","договор залога движимого имущества/оборудования","договор залога транспортных средств","договор залога товаров в обороте","договор залога ценных бумаг","договор залога имущественных прав"],SP=["Основное","Дополнительное","Формальное"],TP=["Первичный","последующий"],OP=["Высокая","Средняя","Малоудовлетворительная","Низкая"],IP=["физический","документарный","комбинированный"],gw=()=>ba(1e9,9999999999),Uo=e=>{const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return`${t}.${r}.${a}`},QC=e=>{const t=e.toLowerCase();return t.includes("недвижимость")||t.includes("здание")||t.includes("помещение")||t.includes("квартира")?"договор залога недвижимого имущества":t.includes("транспорт")||t.includes("автомобиль")||t.includes("машина")?"договор залога транспортных средств":t.includes("оборудование")||t.includes("машина")||t.includes("станок")?"договор залога движимого имущества/оборудования":t.includes("товар")||t.includes("продукт")?"договор залога товаров в обороте":t.includes("ценная бумага")||t.includes("акция")||t.includes("облигация")?"договор залога ценных бумаг":t.includes("право")||t.includes("требование")?"договор залога имущественных прав":zs(BP)},NP=(e,t,r,a,n,i)=>{const o=2e7+t,l=2023+t%2,c=ba(1,12),A=ba(1,28),d=new Date(l,c-1,A),f=d,p=new Date(d);p.setFullYear(p.getFullYear()+ba(1,3));const u=`${ba(100,999)}.${ba(100,999)}/${l%100}-${ba(1,9)}`,g=`${u}-З`,h=ba(1e6,5e7),x=Math.floor(h*(.3+Math.random()*.5)),y=Math.ceil(x/.8),v=Math.ceil(x/.7),E=ba(Math.max(y,5e5),Math.max(v,h)),k=Math.floor(E*.75),S=new Date(d);S.setDate(S.getDate()+ba(1,30));const B=new Date;B.setDate(B.getDate()-ba(0,180));const b=new Date(B);return b.setMonth(b.getMonth()+ba(3,12)),{segment:zs(bP),group:zs(_P),reference:o,pledger:n,inn:i,borrower:r,contractNumber:u,contractDate:Uo(d),type:zs(CP),openDate:Uo(f),closeDate:Uo(p),debtRub:x,limitRub:h,overduePrincipal:Math.random()>.8?ba(0,Math.floor(x*.1)):0,overdueInterest:Math.random()>.9?ba(0,Math.floor(x*.05)):0,collateralReference:5e8+t,collateralContractNumber:g,collateralContractDate:Uo(S),collateralCategory:QC(e),collateralValue:k,marketValue:E,initialValuationDate:Uo(S),currentMarketValue:E+ba(-1e5,1e5),currentValuationDate:Uo(new Date(S.getTime()+ba(30,365)*24*60*60*1e3)),fairValue:Math.random()>.5?String(E+ba(-5e4,5e4)):"-",collateralType:zs(SP),collateralPurpose:`залог ${e.toLowerCase()}`,collateralInfo:`${e} (${ba(1,10)} ед.)`,collateralLocation:`г. ${zs(["Москва","Санкт-Петербург","Краснодар","Екатеринбург","Ростов-на-Дону"])}, ул. ${zs(["Ленина","Пушкина","Гагарина","Мира","Советская"])}, ${ba(1,200)}`,liquidity:zs(OP),qualityCategory:Math.random()>.7?zs(["I","II","III"]):"-",registrationDate:Math.random()>.5?Uo(new Date(d.getTime()+ba(1,30)*24*60*60*1e3)):"-",priority:zs(TP),monitoringType:zs(IP),lastMonitoringDate:Uo(B),nextMonitoringDate:Uo(b),owner:null,account9131:`9131281${String(ba(1e9,9999999999)).padStart(10,"0")}`}},FP=()=>{const e=Dy(),t=[];let r=1;const a=new Map;return e.forEach(n=>{const i=ba(5,10);for(let o=0;o<i;o++){const l=`${n}-${Math.floor(o/5)}`;let c,A,d,f;if(a.has(l)){const u=a.get(l);c=u.borrower,A=u.borrowerInn,d=u.pledger,f=u.pledgerInn}else c=zs(mw),A=gw(),d=zs(mw.filter(u=>u!==c)),f=gw(),a.set(l,{borrower:c,borrowerInn:A,pledger:d,pledgerInn:f});const p=NP(n,r,c,A,d,f);t.push(p),r++}}),t},RP=(e,t)=>{const r=QC(t);return e.filter(a=>{var n;return a.collateralCategory===r||((n=a.collateralPurpose)==null?void 0:n.toLowerCase().includes(t.toLowerCase()))})},Yg={"Легковой автомобиль":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.","Грузовой автомобиль":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Автобус:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Мотоцикл:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Трактор:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Спецтехника:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.","Транспортные средства":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Квартира:"Недвижимое имущество",Дом:"Недвижимое имущество",Здание:"Недвижимое имущество",Помещение:"Недвижимое имущество","Земельный участок":"Недвижимое имущество","Недвижимое имущество":"Недвижимое имущество",Оборудование:"Оборудование",Станки:"Оборудование","Производственное оборудование":"Оборудование","Товары в обороте":"Товары в обороте",Товары:"Товары в обороте","Ценные бумаги":"Ценные бумаги",Акции:"Ценные бумаги",Облигации:"Ценные бумаги","Имущественные права":"Имущественные права","Права требования":"Имущественные права","Будущий урожай":"Будущий урожай","Денежные средства":"Денежные средства","Драгоценные металлы":"Драгоценные металлы"},kP=e=>{if(Yg[e])return Yg[e];for(const[t,r]of Object.entries(Yg))if(e.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(e.toLowerCase()))return r;return e},Da=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,Hl=e=>e[Math.floor(Math.random()*e.length)],DP=['ООО "Рога и Копыта"','ООО "Вектор"','ООО "Альфа"','ООО "Бета"','ООО "Гамма"','ООО "Дельта"','ООО "Омега"','ООО "Сигма"','ООО "Тета"','ООО "Фи"'],jP=["Иванов","Петров","Сидоров","Смирнов","Кузнецов","Попов","Соколов","Лебедев","Козлов","Новиков"],LP=["Иван","Петр","Сергей","Александр","Дмитрий","Андрей","Михаил","Николай","Владимир","Алексей"],UP=["Иванович","Петрович","Сергеевич","Александрович","Дмитриевич","Андреевич","Михайлович","Николаевич","Владимирович","Алексеевич"],MP=["Московская область","Ленинградская область","Краснодарский край","Свердловская область","Ростовская область"],PP=["Москва","Санкт-Петербург","Краснодар","Екатеринбург","Ростов-на-Дону"],$f=(e=!0)=>e?`${Da(1e9,9999999999)}`:`${Da(1e11,999999999999)}`,qC=()=>{const e=Hl(MP),t=Hl(PP),r=`ул. ${Hl(["Ленина","Пушкина","Гагарина","Мира","Советская"])}`,a=Da(1,200).toString(),n=Da(1,10)>5?Da(1,5).toString():void 0,i=Da(1,200).toString();return{id:zi(),region:e,city:t,street:r,house:a,building:n,apartment:i,postalCode:`${Da(1e5,999999)}`,fullAddress:`${e}, ${t}, ${r}, д. ${a}${n?`, к. ${n}`:""}, кв. ${i}`}},xw=(e,t=!1)=>{if(t){const r=Hl(jP),a=Hl(LP),n=Hl(UP);return{id:zi(),type:"individual",role:e,lastName:r,firstName:a,middleName:n,inn:$f(!1),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}}else return{id:zi(),type:"legal",role:e,organizationName:Hl(DP),inn:$f(!0),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}},QP=(e,t)=>{switch(e.type){case"number":return e.code==="QUANTITY"||e.code.includes("COUNT")?Da(1,100):e.code==="WEIGHT"?Da(100,1e4):e.code.includes("SUM")||e.code.includes("VALUE")||e.code.includes("AMOUNT")?Da(1e5,1e7):Da(1,1e3);case"boolean":return Math.random()>.5;case"date":{const r=new Date;return r.setDate(r.getDate()-Da(0,365)),r.toISOString().split("T")[0]}case"string":default:return e.code==="OWNER_TIN"?$f(Math.random()>.5):e.code==="NAME_OF_PROPERTY"?`Объект ${e.group} #${t+1}`:e.code==="ADDRESS_BASE"?qC().fullAddress:e.code.includes("NUMBER")||e.code.includes("CODE")?`${Da(1e5,999999)}`:`Значение ${e.name} #${t+1}`}},qP=(e,t,r)=>{const a=kP(e),n=a?Ph(a):[],i=n.length===0?Ph(e):[],o=n.length>0?n:i,l={};return o.forEach(c=>{l[c.code]=QP(c,t)}),r&&(r.reference&&(l.CONTRACT_REFERENCE=String(r.reference)),r.contractNumber&&(l.CONTRACT_NUMBER=r.contractNumber),r.contractDate&&(l.CONTRACT_DATE=r.contractDate),r.collateralContractNumber&&(l.COLLATERAL_CONTRACT_NUMBER=r.collateralContractNumber),r.collateralContractDate&&(l.COLLATERAL_CONTRACT_DATE=r.collateralContractDate),r.limitRub&&(l.CREDIT_LIMIT=typeof r.limitRub=="number"?r.limitRub:parseFloat(String(r.limitRub))),r.debtRub&&(l.CURRENT_DEBT=typeof r.debtRub=="number"?r.debtRub:parseFloat(String(r.debtRub))),r.currentMarketValue&&(l.MARKET_VALUE=typeof r.currentMarketValue=="number"?r.currentMarketValue:parseFloat(String(r.currentMarketValue))),r.collateralValue&&(l.COLLATERAL_VALUE=typeof r.collateralValue=="number"?r.collateralValue:parseFloat(String(r.collateralValue))),r.collateralCategory&&(l.COLLATERAL_CATEGORY=r.collateralCategory),r.collateralType&&(l.COLLATERAL_TYPE=r.collateralType),r.collateralPurpose&&(l.COLLATERAL_PURPOSE=r.collateralPurpose),r.collateralInfo&&(l.COLLATERAL_INFO=r.collateralInfo),r.collateralLocation&&(l.COLLATERAL_LOCATION=r.collateralLocation),r.liquidity&&(l.LIQUIDITY=r.liquidity),r.priority&&(l.PRIORITY=r.priority),r.monitoringType&&(l.MONITORING_TYPE=r.monitoringType),r.lastMonitoringDate&&(l.LAST_MONITORING_DATE=r.lastMonitoringDate),r.nextMonitoringDate&&(l.NEXT_MONITORING_DATE=r.nextMonitoringDate),r.initialValuationDate&&(l.INITIAL_VALUATION_DATE=r.initialValuationDate),r.currentValuationDate&&(l.CURRENT_VALUATION_DATE=r.currentValuationDate),r.borrower&&(l.BORROWER_NAME=r.borrower),r.pledger&&(l.PLEDGER_NAME=r.pledger),r.inn&&(l.BORROWER_INN=String(r.inn),l.PLEDGER_INN=String(r.inn))),l},KP=(e,t=50,r)=>{const a=[],n=RP(r,e);let i="property_rights";e.includes("недвижимость")||e.includes("здание")||e.includes("помещение")?i="real_estate":(e.includes("транспорт")||e.includes("автомобиль")||e.includes("оборудование"))&&(i="movable");const o=()=>i==="real_estate"?{level0:"Жилая недвижимость",level1:"Квартира",level2:"Помещение"}:i==="movable"?{level0:"Движимое имущество",level1:"Легковой автомобиль",level2:"Помещение"}:{level0:"Имущественные права",level1:"Права требования",level2:"Помещение"};for(let l=0;l<t;l++){let c;if(n.length>0){const U=l%n.length;c=n[U]}let A,d;c?(A={id:zi(),type:"legal",role:"owner",organizationName:c.borrower||'ООО "Заемщик"',inn:String(c.inn||$f(!0)),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},d={id:zi(),type:"legal",role:"pledgor",organizationName:c.pledger||'ООО "Залогодатель"',inn:String(c.inn||$f(!0)),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}):(A=xw("owner",Math.random()>.5),d=xw("pledgor",Math.random()>.5));const f=qC(),p=qP(e,l,c);p.NAME_OF_PROPERTY||(p.NAME_OF_PROPERTY=`${e} #${l+1}`),p.OWNER_TIN||(p.OWNER_TIN=d.inn),c&&p.BORROWER_NAME&&(A.organizationName=p.BORROWER_NAME),c&&p.PLEDGER_NAME&&(d.organizationName=p.PLEDGER_NAME),c&&p.BORROWER_INN&&(A.inn=p.BORROWER_INN),c&&p.PLEDGER_INN&&(d.inn=p.PLEDGER_INN);let u;c!=null&&c.currentMarketValue?u=typeof c.currentMarketValue=="number"?c.currentMarketValue:parseInt(String(c.currentMarketValue)):c!=null&&c.marketValue?u=typeof c.marketValue=="number"?c.marketValue:parseInt(String(c.marketValue)):p.marketValue?u=typeof p.marketValue=="number"?p.marketValue:parseInt(String(p.marketValue)):u=Da(1e6,1e7);const g=Math.floor(u*.75),h=new Date,x=new Date(h);x.setDate(x.getDate()-Da(30,365));const y=i==="real_estate"?12:6,v=new Date(x);v.setMonth(v.getMonth()+y),Math.floor((v.getTime()-h.getTime())/(1e3*60*60*24))>60&&v.setDate(h.getDate()+Da(1,60));const k=new Date(h);k.setDate(k.getDate()-Da(0,180));let S=12;i==="movable"?S=6:(e.includes("товар")||e.includes("сырье"))&&(S=3);const B=new Date(k);B.setMonth(B.getMonth()+S),Math.floor((B.getTime()-h.getTime())/(1e3*60*60*24))>60&&B.setDate(h.getDate()+Da(1,60));const O=U=>{const I=String(U.getDate()).padStart(2,"0"),R=String(U.getMonth()+1).padStart(2,"0"),L=U.getFullYear();return`${I}.${R}.${L}`},_={id:zi(),number:`КО-2024-${String(l+1).padStart(4,"0")}`,name:p.NAME_OF_PROPERTY||`${e} #${l+1}`,mainCategory:i,classification:o(),cbCode:i==="real_estate"?2010:i==="movable"?3010:4010,status:Hl(["editing","approved"]),partners:[A,d],address:f,characteristics:p,documents:[],propertyType:e,marketValue:u,pledgeValue:g,evaluationDate:O(x),lastEvaluationDate:O(x),nextEvaluationDate:O(v),monitoringDate:O(k),nextMonitoringDate:O(B),monitoringFrequencyMonths:S,reference:c!=null&&c.reference?String(c.reference):`REF-${Da(1e4,99999)}`,contractNumber:(c==null?void 0:c.contractNumber)||`ДОГ-${Da(1e3,9999)}/${Da(2020,2024)}`,contractId:(c==null?void 0:c.contractNumber)||void 0,createdAt:new Date(2024,0,1+l),updatedAt:new Date(2024,0,1+l)};a.push(_)}return a},HP=async()=>{const e=Dy(),t=[];let r=1,a=[];try{const n="/",i=new URL(n,window.location.origin),o=i.pathname.endsWith("/")?i.pathname:`${i.pathname}/`,l=`${i.origin}${o}portfolioData.json?v=${Date.now()}`,c=await fetch(l,{cache:"no-store"});c.ok&&(a=await c.json())}catch(n){console.warn("Не удалось загрузить договоры из portfolioData.json, используем сгенерированные",n)}return a.length===0&&(a=FP()),e.forEach(n=>{const i=KP(n,50,a);i.forEach(o=>{o.number=`КО-2024-${String(r).padStart(4,"0")}`,r++}),t.push(...i)}),t},KC=.75,GP=.7,zP=e=>{let t=e.marketValue||0;(!t||t<=0)&&(t=1e6);const r=Math.floor(t*KC);return{...e,marketValue:t,pledgeValue:r}},VP=e=>{const t=typeof e.debtRub=="number"?e.debtRub:parseFloat(String(e.debtRub||0));let r=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0));if((!r||r<=0)&&(r=1e6),t>0&&r>0&&t/r<GP){const i=Math.ceil(t/.8),o=Math.ceil(t/.7);r<i&&(r=i),r>o&&(r=o)}const a=Math.floor(r*KC);return{...e,marketValue:r,collateralValue:a,currentMarketValue:r}},$P=e=>e.map(t=>VP(t)),YP=()=>{const e=nl(),t=$i(),r=dc(),{filteredItems:a,loading:n}=Vi(ee=>ee.extendedCards),i=Vi(ee=>ee.workflow.cases),[o,l]=M.useState(!1),[c,A]=M.useState(null),[d,f]=M.useState(null),[p,u]=M.useState(!1),[g,h]=M.useState(!1),[x,y]=M.useState([]),[v,E]=M.useState(!0),[k,S]=M.useState([]),B=async()=>{try{e(Mv(!0));const ee=await kt.getExtendedCards();e(J1(ee))}catch(ee){Ne.error("Ошибка загрузки данных"),console.error(ee)}finally{e(Mv(!1))}};M.useEffect(()=>{B()},[]),M.useEffect(()=>{if(a.length>0){const V=new URLSearchParams(r.search).get("objectId");if(V){const G=a.find(z=>z.id===V);G&&(f(G),u(!0),window.history.replaceState({},"",r.pathname))}}},[a,r.search,r.pathname]),M.useEffect(()=>{(async()=>{try{const V="/",G=new URL(V,window.location.origin),z=G.pathname.endsWith("/")?G.pathname:`${G.pathname}/`,C=`${G.origin}${z}collateralDossier.json?v=${Date.now()}`,D=await fetch(C,{cache:"no-store"});if(!D.ok)throw new Error(`Failed to load dossier (${D.status})`);const j=await D.json();y(j.documents)}catch(V){console.warn("Не удалось загрузить данные залогового досье",V)}finally{E(!1)}})()},[]);const b=ee=>{const V=a.find(G=>G.id===ee);V&&(A(V),l(!0))},O=async ee=>{try{await kt.deleteExtendedCard(ee),e(YO(ee)),Ne.success("Карточка удалена")}catch(V){Ne.error("Ошибка удаления карточки"),console.error(V)}},_=ee=>{const V=a.find(G=>G.id===ee);V&&(f(V),u(!0))},U=ee=>{_(ee.id)},I=()=>{u(!1),f(null)},R=()=>{var C;if(!d)return;const ee=i.find(D=>D.objectId===d.id);if(ee){Ne.info("Workflow уже запущен для этого объекта"),t(`/workflow/object/${ee.id}`),I();return}const V=new Date().toISOString(),G=`wf-${d.id}`,z={id:G,objectId:d.id,objectName:d.name,assetType:d.mainCategory||"Обеспечение",debtAmount:void 0,appraisedValue:void 0,stage:"ANALYSIS",manager:typeof d.owner=="string"?d.owner:((C=d.owner)==null?void 0:C.name)||"Не назначен",deadline:void 0,createdAt:V,updatedAt:V,history:[{id:`h-${V}`,stage:"ANALYSIS",user:"Система",comment:"Workflow запущен из карточки реестра",createdAt:V}],documents:[],notes:d.number?`Запущено по договору ${d.number}`:void 0};e(eI(z)),Ne.success("Workflow запущен"),t(`/workflow/object/${G}`),I()},L=()=>{if(!d)return;const ee=String(d.number??d.id??""),V=x.filter(G=>String(G.reference)===ee);S(V),h(!0)},N=a.map(ee=>({id:ee.id,number:ee.number,name:ee.name,mainCategory:ee.mainCategory,status:ee.status,classification:ee.classification,addresses:ee.address?[{fullAddress:ee.address.fullAddress}]:[],owner:ee.owner,characteristics:ee.characteristics,createdAt:ee.createdAt,updatedAt:ee.updatedAt})),P=async ee=>{try{await kt.saveExtendedCard(ee),c?(e($O(ee)),Ne.success("Карточка обновлена")):(e(VO(ee)),Ne.success("Карточка создана")),l(!1),A(null)}catch(V){Ne.error("Ошибка сохранения карточки"),console.error(V)}},Q=()=>{A(null),l(!0)},Y=async()=>{try{Ne.loading({content:"Генерация демо-карточек...",key:"generating",duration:0});const ee=await HP();let V=0,G=0;for(const z of ee)try{const C=zP(z);await kt.saveExtendedCard(C),V++}catch(C){G++,console.error(`Ошибка создания карточки ${z.number}:`,C)}await B(),Ne.destroy("generating"),Ne.success(`Создано ${V} демо-карточек${G>0?`, ошибок: ${G}`:""}`)}catch(ee){Ne.destroy("generating"),Ne.error("Ошибка генерации демо-данных"),console.error(ee)}};return s.jsxs("div",{children:[s.jsxs(Te,{style:{marginBottom:16},wrap:!0,children:[s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:Q,children:"Создать карточку"}),s.jsx(po,{title:"Генерация демо-данных",description:"Создать 50 карточек на каждый тип имущества из справочника? Это может занять некоторое время.",onConfirm:Y,okText:"Да",cancelText:"Нет",children:s.jsx(Be,{icon:s.jsx(el,{}),children:"Создать демо-данные (50 карточек на каждый тип)"})})]}),s.jsx(EP,{data:N,loading:n,onEdit:b,onView:_,onDelete:O,onDoubleClick:U}),s.jsx(cr,{title:c?"Редактирование карточки":"Создание карточки",open:o,onCancel:()=>{l(!1),A(null)},footer:null,width:"100%",style:{top:0,maxWidth:"none",padding:0},styles:{body:{height:"calc(100vh - 110px)",overflowY:"auto"}},destroyOnClose:!0,centered:!0,children:s.jsx(QM,{initialValues:c||void 0,onSubmit:P,onCancel:()=>{l(!1),A(null)}})}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx("span",{children:"Карточка объекта"}),d&&s.jsxs(ht.Text,{type:"secondary",style:{fontSize:"14px",fontWeight:"normal"},children:["ID: ",d.id]})]}),open:p,onCancel:I,footer:[s.jsx(Be,{type:"primary",onClick:R,disabled:!d,children:"Запустить workflow"},"workflow"),(d==null?void 0:d.reference)&&s.jsx(Be,{icon:s.jsx(go,{}),onClick:()=>{t(`/portfolio?q=${d.reference}`),I()},children:"Перейти в портфель"},"portfolio"),s.jsx(Be,{type:"primary",onClick:L,disabled:!d,children:"Залоговое досье"},"dossier"),s.jsx(Be,{onClick:I,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},destroyOnClose:!0,children:d&&s.jsx(wP,{card:d})}),s.jsx(cr,{title:"Залоговое досье по договору",open:g,onCancel:()=>h(!1),footer:[s.jsx(Be,{type:"primary",onClick:()=>h(!1),children:"Закрыть"},"close")],width:720,children:v?s.jsx(Sr,{description:"Загрузка документов..."}):k.length===0?s.jsx(Sr,{description:"По данному договору нет документов"}):s.jsx(Qt,{dataSource:k,renderItem:ee=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:s.jsxs(Te,{children:[s.jsx(Ze,{color:ee.statusColor||"blue",children:ee.status}),s.jsx("span",{children:ee.docType})]}),description:s.jsxs(ht.Text,{type:"secondary",children:[ee.folderPath.join(" / ")," · ",ee.lastUpdated]})}),s.jsxs("div",{children:[s.jsx("div",{children:ee.fileName}),s.jsx(ht.Text,{type:"secondary",children:ee.responsible})]})]})})})]})};var Wn=Uint8Array,Zs=Uint16Array,Ly=Int32Array,Om=new Wn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Im=new Wn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mx=new Wn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),HC=function(e,t){for(var r=new Zs(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new Ly(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},GC=HC(Om,2),zC=GC.b,Px=GC.r;zC[28]=258,Px[258]=28;var VC=HC(Im,0),WP=VC.b,yw=VC.r,Qx=new Zs(32768);for(var oa=0;oa<32768;++oa){var Bl=(oa&43690)>>1|(oa&21845)<<1;Bl=(Bl&52428)>>2|(Bl&13107)<<2,Bl=(Bl&61680)>>4|(Bl&3855)<<4,Qx[oa]=((Bl&65280)>>8|(Bl&255)<<8)>>1}var mo=function(e,t,r){for(var a=e.length,n=0,i=new Zs(t);n<a;++n)e[n]&&++i[e[n]-1];var o=new Zs(t);for(n=1;n<t;++n)o[n]=o[n-1]+i[n-1]<<1;var l;if(r){l=new Zs(1<<t);var c=15-t;for(n=0;n<a;++n)if(e[n])for(var A=n<<4|e[n],d=t-e[n],f=o[e[n]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)l[Qx[f]>>c]=A}else for(l=new Zs(a),n=0;n<a;++n)e[n]&&(l[n]=Qx[o[e[n]-1]++]>>15-e[n]);return l},lc=new Wn(288);for(var oa=0;oa<144;++oa)lc[oa]=8;for(var oa=144;oa<256;++oa)lc[oa]=9;for(var oa=256;oa<280;++oa)lc[oa]=7;for(var oa=280;oa<288;++oa)lc[oa]=8;var Yf=new Wn(32);for(var oa=0;oa<32;++oa)Yf[oa]=5;var XP=mo(lc,9,0),JP=mo(lc,9,1),ZP=mo(Yf,5,0),e9=mo(Yf,5,1),Wg=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Li=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},Xg=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Uy=function(e){return(e+7)/8|0},$C=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Wn(e.subarray(t,r))},t9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qi=function(e,t,r){var a=new Error(t||t9[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,Qi),!r)throw a;return a},r9=function(e,t,r,a){var n=e.length,i=0;if(!n||t.f&&!t.l)return r||new Wn(0);var o=!r,l=o||t.i!=2,c=t.i;o&&(r=new Wn(n*3));var A=function(we){var se=r.length;if(we>se){var He=new Wn(Math.max(se*2,we));He.set(r),r=He}},d=t.f||0,f=t.p||0,p=t.b||0,u=t.l,g=t.d,h=t.m,x=t.n,y=n*8;do{if(!u){d=Li(e,f,1);var v=Li(e,f+1,3);if(f+=3,v)if(v==1)u=JP,g=e9,h=9,x=5;else if(v==2){var B=Li(e,f,31)+257,b=Li(e,f+10,15)+4,O=B+Li(e,f+5,31)+1;f+=14;for(var _=new Wn(O),U=new Wn(19),I=0;I<b;++I)U[Mx[I]]=Li(e,f+I*3,7);f+=b*3;for(var R=Wg(U),L=(1<<R)-1,N=mo(U,R,1),I=0;I<O;){var P=N[Li(e,f,L)];f+=P&15;var E=P>>4;if(E<16)_[I++]=E;else{var Q=0,Y=0;for(E==16?(Y=3+Li(e,f,3),f+=2,Q=_[I-1]):E==17?(Y=3+Li(e,f,7),f+=3):E==18&&(Y=11+Li(e,f,127),f+=7);Y--;)_[I++]=Q}}var ee=_.subarray(0,B),V=_.subarray(B);h=Wg(ee),x=Wg(V),u=mo(ee,h,1),g=mo(V,x,1)}else Qi(1);else{var E=Uy(f)+4,k=e[E-4]|e[E-3]<<8,S=E+k;if(S>n){c&&Qi(0);break}l&&A(p+k),r.set(e.subarray(E,S),p),t.b=p+=k,t.p=f=S*8,t.f=d;continue}if(f>y){c&&Qi(0);break}}l&&A(p+131072);for(var G=(1<<h)-1,z=(1<<x)-1,C=f;;C=f){var Q=u[Xg(e,f)&G],D=Q>>4;if(f+=Q&15,f>y){c&&Qi(0);break}if(Q||Qi(2),D<256)r[p++]=D;else if(D==256){C=f,u=null;break}else{var j=D-254;if(D>264){var I=D-257,K=Om[I];j=Li(e,f,(1<<K)-1)+zC[I],f+=K}var W=g[Xg(e,f)&z],Ae=W>>4;W||Qi(3),f+=W&15;var V=WP[Ae];if(Ae>3){var K=Im[Ae];V+=Xg(e,f)&(1<<K)-1,f+=K}if(f>y){c&&Qi(0);break}l&&A(p+131072);var ue=p+j;if(p<V){var he=i-V,ve=Math.min(V,ue);for(he+p<0&&Qi(3);p<ve;++p)r[p]=a[he+p]}for(;p<ue;++p)r[p]=r[p-V]}}t.l=u,t.p=C,t.b=p,t.f=d,u&&(d=1,t.m=h,t.d=g,t.n=x)}while(!d);return p!=r.length&&o?$C(r,0,p):r.subarray(0,p)},Mo=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Ou=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Jg=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,i=r.slice();if(!n)return{t:WC,l:0};if(n==1){var o=new Wn(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(S,B){return S.f-B.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=n-1;)l=r[r[A].f<r[f].f?A++:f++],c=r[A!=d&&r[A].f<r[f].f?A++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var p=i[0].s,a=1;a<n;++a)i[a].s>p&&(p=i[a].s);var u=new Zs(p+1),g=qx(r[d-1],u,0);if(g>t){var a=0,h=0,x=g-t,y=1<<x;for(i.sort(function(B,b){return u[b.s]-u[B.s]||B.f-b.f});a<n;++a){var v=i[a].s;if(u[v]>t)h+=y-(1<<g-u[v]),u[v]=t;else break}for(h>>=x;h>0;){var E=i[a].s;u[E]<t?h-=1<<t-u[E]++-1:++a}for(;a>=0&&h;--a){var k=i[a].s;u[k]==t&&(--u[k],++h)}g=t}return{t:new Wn(u),l:g}},qx=function(e,t,r){return e.s==-1?Math.max(qx(e.l,t,r+1),qx(e.r,t,r+1)):t[e.s]=r},vw=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Zs(++t),a=0,n=e[0],i=1,o=function(c){r[a++]=c},l=1;l<=t;++l)if(e[l]==n&&l!=t)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=e[l]}return{c:r.subarray(0,a),n:t}},Iu=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},YC=function(e,t,r){var a=r.length,n=Uy(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var i=0;i<a;++i)e[n+i+4]=r[i];return(n+4+a)*8},ww=function(e,t,r,a,n,i,o,l,c,A,d){Mo(t,d++,r),++n[256];for(var f=Jg(n,15),p=f.t,u=f.l,g=Jg(i,15),h=g.t,x=g.l,y=vw(p),v=y.c,E=y.n,k=vw(h),S=k.c,B=k.n,b=new Zs(19),O=0;O<v.length;++O)++b[v[O]&31];for(var O=0;O<S.length;++O)++b[S[O]&31];for(var _=Jg(b,7),U=_.t,I=_.l,R=19;R>4&&!U[Mx[R-1]];--R);var L=A+5<<3,N=Iu(n,lc)+Iu(i,Yf)+o,P=Iu(n,p)+Iu(i,h)+o+14+3*R+Iu(b,U)+2*b[16]+3*b[17]+7*b[18];if(c>=0&&L<=N&&L<=P)return YC(t,d,e.subarray(c,c+A));var Q,Y,ee,V;if(Mo(t,d,1+(P<N)),d+=2,P<N){Q=mo(p,u,0),Y=p,ee=mo(h,x,0),V=h;var G=mo(U,I,0);Mo(t,d,E-257),Mo(t,d+5,B-1),Mo(t,d+10,R-4),d+=14;for(var O=0;O<R;++O)Mo(t,d+3*O,U[Mx[O]]);d+=3*R;for(var z=[v,S],C=0;C<2;++C)for(var D=z[C],O=0;O<D.length;++O){var j=D[O]&31;Mo(t,d,G[j]),d+=U[j],j>15&&(Mo(t,d,D[O]>>5&127),d+=D[O]>>12)}}else Q=XP,Y=lc,ee=ZP,V=Yf;for(var O=0;O<l;++O){var K=a[O];if(K>255){var j=K>>18&31;Ou(t,d,Q[j+257]),d+=Y[j+257],j>7&&(Mo(t,d,K>>23&31),d+=Om[j]);var W=K&31;Ou(t,d,ee[W]),d+=V[W],W>3&&(Ou(t,d,K>>5&8191),d+=Im[W])}else Ou(t,d,Q[K]),d+=Y[K]}return Ou(t,d,Q[256]),d+Y[256]},a9=new Ly([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),WC=new Wn(0),n9=function(e,t,r,a,n,i){var o=i.z||e.length,l=new Wn(a+o+5*(1+Math.ceil(o/7e3))+n),c=l.subarray(a,l.length-n),A=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var f=a9[t-1],p=f>>13,u=f&8191,g=(1<<r)-1,h=i.p||new Zs(32768),x=i.h||new Zs(g+1),y=Math.ceil(r/3),v=2*y,E=function(Ee){return(e[Ee]^e[Ee+1]<<y^e[Ee+2]<<v)&g},k=new Ly(25e3),S=new Zs(288),B=new Zs(32),b=0,O=0,_=i.i||0,U=0,I=i.w||0,R=0;_+2<o;++_){var L=E(_),N=_&32767,P=x[L];if(h[N]=P,x[L]=N,I<=_){var Q=o-_;if((b>7e3||U>24576)&&(Q>423||!A)){d=ww(e,c,0,k,S,B,O,U,R,_-R,d),U=b=O=0,R=_;for(var Y=0;Y<286;++Y)S[Y]=0;for(var Y=0;Y<30;++Y)B[Y]=0}var ee=2,V=0,G=u,z=N-P&32767;if(Q>2&&L==E(_-z))for(var C=Math.min(p,Q)-1,D=Math.min(32767,_),j=Math.min(258,Q);z<=D&&--G&&N!=P;){if(e[_+ee]==e[_+ee-z]){for(var K=0;K<j&&e[_+K]==e[_+K-z];++K);if(K>ee){if(ee=K,V=z,K>C)break;for(var W=Math.min(z,K-2),Ae=0,Y=0;Y<W;++Y){var ue=_-z+Y&32767,he=h[ue],ve=ue-he&32767;ve>Ae&&(Ae=ve,P=ue)}}}N=P,P=h[N],z+=N-P&32767}if(V){k[U++]=268435456|Px[ee]<<18|yw[V];var we=Px[ee]&31,se=yw[V]&31;O+=Om[we]+Im[se],++S[257+we],++B[se],I=_+ee,++b}else k[U++]=e[_],++S[e[_]]}}for(_=Math.max(_,I);_<o;++_)k[U++]=e[_],++S[e[_]];d=ww(e,c,A,k,S,B,O,U,R,_-R,d),A||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=x,i.p=h,i.i=_,i.w=I)}else{for(var _=i.w||0;_<o+A;_+=65535){var He=_+65535;He>=o&&(c[d/8|0]=A,He=o),d=YC(c,d+1,e.subarray(_,He))}i.i=o}return $C(l,0,a+Uy(d)+n)},XC=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},s9=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Wn(i.length+e.length);o.set(i),o.set(e,i.length),e=o,n.w=i.length}return n9(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},JC=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},i9=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=XC();n.p(t.dictionary),JC(e,2,n.d())}},o9=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Qi(6,"invalid zlib data"),(e[1]>>5&1)==1&&Qi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Kx(e,t){t||(t={});var r=XC();r.p(e);var a=s9(e,t,t.dictionary?6:2,4);return i9(a,t),JC(a,a.length-4,r.d()),a}function l9(e,t){return r9(e.subarray(o9(e),-4),{i:2},t,t)}var c9=typeof TextDecoder<"u"&&new TextDecoder,A9=0;try{c9.decode(WC,{stream:!0}),A9=1}catch{}var Yt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Zg(){Yt.console&&typeof Yt.console.log=="function"&&Yt.console.log.apply(Yt.console,arguments)}var Xr={log:Zg,warn:function(e){Yt.console&&(typeof Yt.console.warn=="function"?Yt.console.warn.apply(Yt.console,arguments):Zg.call(null,arguments))},error:function(e){Yt.console&&(typeof Yt.console.error=="function"?Yt.console.error.apply(Yt.console,arguments):Zg(e))}};function e1(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){kc(a.response,t,r)},a.onerror=function(){Xr.error("could not download file")},a.send()}function Ew(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function xp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var gf,Hx,kc=Yt.saveAs||((typeof window>"u"?"undefined":ea(window))!=="object"||window!==Yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Yt.URL||Yt.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?Ew(n.href)?e1(e,t,r):xp(n,n.target="_blank"):xp(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){xp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Ew(e))e1(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){xp(a)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:ea(i)!=="object"&&(Xr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return e1(e,t,r);var n=e.type==="application/octet-stream",i=/constructor/i.test(Yt.HTMLElement)||Yt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":ea(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},l.readAsDataURL(e)}else{var c=Yt.URL||Yt.webkitURL,A=c.createObjectURL(e);a?a.location=A:location.href=A,a=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function ZC(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,o=n.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function t1(e,t){var r=e[0],a=e[1],n=e[2],i=e[3];r=Ln(r,a,n,i,t[0],7,-680876936),i=Ln(i,r,a,n,t[1],12,-389564586),n=Ln(n,i,r,a,t[2],17,606105819),a=Ln(a,n,i,r,t[3],22,-1044525330),r=Ln(r,a,n,i,t[4],7,-176418897),i=Ln(i,r,a,n,t[5],12,1200080426),n=Ln(n,i,r,a,t[6],17,-1473231341),a=Ln(a,n,i,r,t[7],22,-45705983),r=Ln(r,a,n,i,t[8],7,1770035416),i=Ln(i,r,a,n,t[9],12,-1958414417),n=Ln(n,i,r,a,t[10],17,-42063),a=Ln(a,n,i,r,t[11],22,-1990404162),r=Ln(r,a,n,i,t[12],7,1804603682),i=Ln(i,r,a,n,t[13],12,-40341101),n=Ln(n,i,r,a,t[14],17,-1502002290),r=Un(r,a=Ln(a,n,i,r,t[15],22,1236535329),n,i,t[1],5,-165796510),i=Un(i,r,a,n,t[6],9,-1069501632),n=Un(n,i,r,a,t[11],14,643717713),a=Un(a,n,i,r,t[0],20,-373897302),r=Un(r,a,n,i,t[5],5,-701558691),i=Un(i,r,a,n,t[10],9,38016083),n=Un(n,i,r,a,t[15],14,-660478335),a=Un(a,n,i,r,t[4],20,-405537848),r=Un(r,a,n,i,t[9],5,568446438),i=Un(i,r,a,n,t[14],9,-1019803690),n=Un(n,i,r,a,t[3],14,-187363961),a=Un(a,n,i,r,t[8],20,1163531501),r=Un(r,a,n,i,t[13],5,-1444681467),i=Un(i,r,a,n,t[2],9,-51403784),n=Un(n,i,r,a,t[7],14,1735328473),r=Mn(r,a=Un(a,n,i,r,t[12],20,-1926607734),n,i,t[5],4,-378558),i=Mn(i,r,a,n,t[8],11,-2022574463),n=Mn(n,i,r,a,t[11],16,1839030562),a=Mn(a,n,i,r,t[14],23,-35309556),r=Mn(r,a,n,i,t[1],4,-1530992060),i=Mn(i,r,a,n,t[4],11,1272893353),n=Mn(n,i,r,a,t[7],16,-155497632),a=Mn(a,n,i,r,t[10],23,-1094730640),r=Mn(r,a,n,i,t[13],4,681279174),i=Mn(i,r,a,n,t[0],11,-358537222),n=Mn(n,i,r,a,t[3],16,-722521979),a=Mn(a,n,i,r,t[6],23,76029189),r=Mn(r,a,n,i,t[9],4,-640364487),i=Mn(i,r,a,n,t[12],11,-421815835),n=Mn(n,i,r,a,t[15],16,530742520),r=Pn(r,a=Mn(a,n,i,r,t[2],23,-995338651),n,i,t[0],6,-198630844),i=Pn(i,r,a,n,t[7],10,1126891415),n=Pn(n,i,r,a,t[14],15,-1416354905),a=Pn(a,n,i,r,t[5],21,-57434055),r=Pn(r,a,n,i,t[12],6,1700485571),i=Pn(i,r,a,n,t[3],10,-1894986606),n=Pn(n,i,r,a,t[10],15,-1051523),a=Pn(a,n,i,r,t[1],21,-2054922799),r=Pn(r,a,n,i,t[8],6,1873313359),i=Pn(i,r,a,n,t[15],10,-30611744),n=Pn(n,i,r,a,t[6],15,-1560198380),a=Pn(a,n,i,r,t[13],21,1309151649),r=Pn(r,a,n,i,t[4],6,-145523070),i=Pn(i,r,a,n,t[11],10,-1120210379),n=Pn(n,i,r,a,t[2],15,718787259),a=Pn(a,n,i,r,t[9],21,-343485551),e[0]=Gl(r,e[0]),e[1]=Gl(a,e[1]),e[2]=Gl(n,e[2]),e[3]=Gl(i,e[3])}function Nm(e,t,r,a,n,i){return t=Gl(Gl(t,e),Gl(a,i)),Gl(t<<n|t>>>32-n,r)}function Ln(e,t,r,a,n,i,o){return Nm(t&r|~t&a,e,t,n,i,o)}function Un(e,t,r,a,n,i,o){return Nm(t&a|r&~a,e,t,n,i,o)}function Mn(e,t,r,a,n,i,o){return Nm(t^r^a,e,t,n,i,o)}function Pn(e,t,r,a,n,i,o){return Nm(r^(t|~a),e,t,n,i,o)}function eB(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)t1(a,d9(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(t1(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,t1(a,n),a}function d9(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}gf=Yt.atob.bind(Yt),Hx=Yt.btoa.bind(Yt);var bw="0123456789abcdef".split("");function u9(e){for(var t="",r=0;r<4;r++)t+=bw[e>>8*r+4&15]+bw[e>>8*r&15];return t}function f9(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Gx(e){return eB(e).map(f9).join("")}var p9=function(e){for(var t=0;t<e.length;t++)e[t]=u9(e[t]);return e.join("")}(eB("hello"))!="5d41402abc4b2a76b9719d911017c592";function Gl(e,t){if(p9){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function zx(e,t){var r,a,n,i;if(e!==r){for(var o=(n=e,i=1+(256/e.length>>0),new Array(i+1).join(n)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var d=l[c];A=(A+d+o.charCodeAt(c))%256,l[c]=l[A],l[A]=d}r=e,a=l}else l=a;var f=t.length,p=0,u=0,g="";for(c=0;c<f;c++)u=(u+(d=l[p=(p+1)%256]))%256,l[p]=l[u],l[u]=d,o=l[(l[p]+l[u])%256],g+=String.fromCharCode(t.charCodeAt(c)^o);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var _w={print:4,modify:8,copy:16,"annot-forms":32};function pd(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(l){if(_w.perm!==void 0)throw new Error("Invalid permission: "+l);n+=_w[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=Gx(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=zx(this.encryptionKey,this.padding)}function hd(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?t+="#"+("0"+n.toString(16)).slice(-2):t+=e[a]}return t}function Cw(e){if(ea(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,a)}catch(l){Yt.console&&Xr.error("jsPDF PubSub Error",l.message,l)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Kh(e){if(!(this instanceof Kh))return new Kh(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function tB(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function jc(e,t,r,a,n){if(!(this instanceof jc))return new jc(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,tB.call(this,a,n)}function wd(e,t,r,a,n){if(!(this instanceof wd))return new wd(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,tB.call(this,a,n)}function Vt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],o=[],l=1,c=16,A="S",d=null;ea(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),A=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},u={internal:{},__private__:{}};u.__private__.PubSub=Cw;var g="1.3",h=u.__private__.getPdfVersion=function(){return g};u.__private__.setPdfVersion=function(T){g=T};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return x};var y=u.__private__.getPageFormat=function(T){return x[T]};n=n||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},E=v.COMPAT;function k(){this.saveGraphicsState(),ce(new Dt(ct,0,0,-ct,0,dl()*ct).toString()+" cm"),this.setFontSize(this.getFontSize()/ct),A="n",E=v.ADVANCED}function S(){this.restoreGraphicsState(),A="S",E=v.COMPAT}var B=u.__private__.combineFontStyleAndFontWeight=function(T,J){if(T=="bold"&&J=="normal"||T=="bold"&&J==400||T=="normal"&&J=="italic"||T=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(T=J==400||J==="normal"?T==="italic"?"italic":"normal":J!=700&&J!=="bold"||T!=="normal"?(J==700?"bold":J)+""+T:"bold"),T};u.advancedAPI=function(T){var J=E===v.COMPAT;return J&&k.call(this),typeof T!="function"||(T(this),J&&S.call(this)),this},u.compatAPI=function(T){var J=E===v.ADVANCED;return J&&S.call(this),typeof T!="function"||(T(this),J&&k.call(this)),this},u.isAdvancedAPI=function(){return E===v.ADVANCED};var b,O=function(T){if(E!==v.ADVANCED)throw new Error(T+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},_=u.roundToPrecision=u.__private__.roundToPrecision=function(T,J){var xe=t||J;if(isNaN(T)||isNaN(xe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return T.toFixed(xe).replace(/0+$/,"")};b=u.hpf=u.__private__.hpf=typeof c=="number"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return _(T,c)}:c==="smart"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return _(T,T>-1&&T<1?16:5)}:function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return _(T,16)};var U=u.f2=u.__private__.f2=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f2");return _(T,2)},I=u.__private__.f3=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f3");return _(T,3)},R=u.scale=u.__private__.scale=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.scale");return E===v.COMPAT?T*ct:E===v.ADVANCED?T:void 0},L=function(T){return E===v.COMPAT?dl()-T:E===v.ADVANCED?T:void 0},N=function(T){return R(L(T))};u.__private__.setPrecision=u.setPrecision=function(T){typeof parseInt(T,10)=="number"&&(t=parseInt(T,10))};var P,Q="00000000000000000000000000000000",Y=u.__private__.getFileId=function(){return Q},ee=u.__private__.setFileId=function(T){return Q=T!==void 0&&/^[a-fA-F0-9]{32}$/.test(T)?T.toUpperCase():Q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(kn=new pd(d.userPermissions,d.userPassword,d.ownerPassword,Q)),Q};u.setFileId=function(T){return ee(T),this},u.getFileId=function(){return Y()};var V=u.__private__.convertDateToPDFDate=function(T){var J=T.getTimezoneOffset(),xe=J<0?"+":"-",Se=Math.floor(Math.abs(J/60)),Qe=Math.abs(J%60),Xe=[xe,j(Se),"'",j(Qe),"'"].join("");return["D:",T.getFullYear(),j(T.getMonth()+1),j(T.getDate()),j(T.getHours()),j(T.getMinutes()),j(T.getSeconds()),Xe].join("")},G=u.__private__.convertPDFDateToDate=function(T){var J=parseInt(T.substr(2,4),10),xe=parseInt(T.substr(6,2),10)-1,Se=parseInt(T.substr(8,2),10),Qe=parseInt(T.substr(10,2),10),Xe=parseInt(T.substr(12,2),10),lt=parseInt(T.substr(14,2),10);return new Date(J,xe,Se,Qe,Xe,lt,0)},z=u.__private__.setCreationDate=function(T){var J;if(T===void 0&&(T=new Date),T instanceof Date)J=V(T);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(T))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=T}return P=J},C=u.__private__.getCreationDate=function(T){var J=P;return T==="jsDate"&&(J=G(P)),J};u.setCreationDate=function(T){return z(T),this},u.getCreationDate=function(T){return C(T)};var D,j=u.__private__.padd2=function(T){return("0"+parseInt(T)).slice(-2)},K=u.__private__.padd2Hex=function(T){return("00"+(T=T.toString())).substr(T.length)},W=0,Ae=[],ue=[],he=0,ve=[],we=[],se=!1,He=ue,Ee=function(){W=0,he=0,ue=[],Ae=[],ve=[],ae=ge(),Z=ge()};u.__private__.setCustomOutputDestination=function(T){se=!0,He=T};var pe=function(T){se||(He=T)};u.__private__.resetCustomOutputDestination=function(){se=!1,He=ue};var ce=u.__private__.out=function(T){return T=T.toString(),he+=T.length+1,He.push(T),He},Ge=u.__private__.write=function(T){return ce(arguments.length===1?T.toString():Array.prototype.join.call(arguments," "))},et=u.__private__.getArrayBuffer=function(T){for(var J=T.length,xe=new ArrayBuffer(J),Se=new Uint8Array(xe);J--;)Se[J]=T.charCodeAt(J);return xe},Ye=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return Ye};var tt=e.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(T){return tt=E===v.ADVANCED?T/ct:T,this};var je,_e=u.__private__.getFontSize=u.getFontSize=function(){return E===v.COMPAT?tt:tt*ct},At=e.R2L||!1;u.__private__.setR2L=u.setR2L=function(T){return At=T,this},u.__private__.getR2L=u.getR2L=function(){return At};var Ct,_t=u.__private__.setZoomMode=function(T){var J=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(T))je=T;else if(isNaN(T)){if(J.indexOf(T)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+T+'" is not recognized.');je=T}else je=parseInt(T,10)};u.__private__.getZoomMode=function(){return je};var Et,Pt=u.__private__.setPageMode=function(T){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(T)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+T+'" is not recognized.');Ct=T};u.__private__.getPageMode=function(){return Ct};var Lt=u.__private__.setLayoutMode=function(T){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(T)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+T+'" is not recognized.');Et=T};u.__private__.getLayoutMode=function(){return Et},u.__private__.setDisplayMode=u.setDisplayMode=function(T,J,xe){return _t(T),Lt(J),Pt(xe),this};var Bt={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(T){if(Object.keys(Bt).indexOf(T)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Bt[T]},u.__private__.getDocumentProperties=function(){return Bt},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(T){for(var J in Bt)Bt.hasOwnProperty(J)&&T[J]&&(Bt[J]=T[J]);return this},u.__private__.setDocumentProperty=function(T,J){if(Object.keys(Bt).indexOf(T)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Bt[T]=J};var ut,ct,wr,Rt,$r,hr={},vt={},Or=[],nr={},cn={},Lr={},as={},Ds=null,Ur=0,$t=[],Er=new Cw(u),ii=e.hotfixes||[],xa={},vs={},ws=[],Dt=function T(J,xe,Se,Qe,Xe,lt){if(!(this instanceof T))return new T(J,xe,Se,Qe,Xe,lt);isNaN(J)&&(J=1),isNaN(xe)&&(xe=0),isNaN(Se)&&(Se=0),isNaN(Qe)&&(Qe=1),isNaN(Xe)&&(Xe=0),isNaN(lt)&&(lt=0),this._matrix=[J,xe,Se,Qe,Xe,lt]};Object.defineProperty(Dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(Dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(Dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(Dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(Dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(Dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(Dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(Dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(Dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(Dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(Dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(Dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(Dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Dt.prototype.join=function(T){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(b).join(T)},Dt.prototype.multiply=function(T){var J=T.sx*this.sx+T.shy*this.shx,xe=T.sx*this.shy+T.shy*this.sy,Se=T.shx*this.sx+T.sy*this.shx,Qe=T.shx*this.shy+T.sy*this.sy,Xe=T.tx*this.sx+T.ty*this.shx+this.tx,lt=T.tx*this.shy+T.ty*this.sy+this.ty;return new Dt(J,xe,Se,Qe,Xe,lt)},Dt.prototype.decompose=function(){var T=this.sx,J=this.shy,xe=this.shx,Se=this.sy,Qe=this.tx,Xe=this.ty,lt=Math.sqrt(T*T+J*J),Tt=(T/=lt)*xe+(J/=lt)*Se;xe-=T*Tt,Se-=J*Tt;var Mt=Math.sqrt(xe*xe+Se*Se);return Tt/=Mt,T*(Se/=Mt)<J*(xe/=Mt)&&(T=-T,J=-J,Tt=-Tt,lt=-lt),{scale:new Dt(lt,0,0,Mt,0,0),translate:new Dt(1,0,0,1,Qe,Xe),rotate:new Dt(T,J,-J,T,0,0),skew:new Dt(1,0,Tt,1,0,0)}},Dt.prototype.toString=function(T){return this.join(" ")},Dt.prototype.inversed=function(){var T=this.sx,J=this.shy,xe=this.shx,Se=this.sy,Qe=this.tx,Xe=this.ty,lt=1/(T*Se-J*xe),Tt=Se*lt,Mt=-J*lt,sr=-xe*lt,er=T*lt;return new Dt(Tt,Mt,sr,er,-Tt*Qe-sr*Xe,-Mt*Qe-er*Xe)},Dt.prototype.applyToPoint=function(T){var J=T.x*this.sx+T.y*this.shx+this.tx,xe=T.x*this.shy+T.y*this.sy+this.ty;return new SA(J,xe)},Dt.prototype.applyToRectangle=function(T){var J=this.applyToPoint(T),xe=this.applyToPoint(new SA(T.x+T.w,T.y+T.h));return new ou(J.x,J.y,xe.x-J.x,xe.y-J.y)},Dt.prototype.clone=function(){var T=this.sx,J=this.shy,xe=this.shx,Se=this.sy,Qe=this.tx,Xe=this.ty;return new Dt(T,J,xe,Se,Qe,Xe)},u.Matrix=Dt;var ns=u.matrixMult=function(T,J){return J.multiply(T)},Ja=new Dt(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=Ja;var Za=function(T,J){if(!cn[T]){var xe=(J instanceof jc?"Sh":"P")+(Object.keys(nr).length+1).toString(10);J.id=xe,cn[T]=xe,nr[xe]=J,Er.publish("addPattern",J)}};u.ShadingPattern=jc,u.TilingPattern=wd,u.addShadingPattern=function(T,J){return O("addShadingPattern()"),Za(T,J),this},u.beginTilingPattern=function(T){O("beginTilingPattern()"),S0(T.boundingBox[0],T.boundingBox[1],T.boundingBox[2]-T.boundingBox[0],T.boundingBox[3]-T.boundingBox[1],T.matrix)},u.endTilingPattern=function(T,J){O("endTilingPattern()"),J.stream=we[D].join(`
`),Za(T,J),Er.publish("endTilingPattern",J),ws.pop().restore()};var Aa=u.__private__.newObject=function(){var T=ge();return H(T,!0),T},ge=u.__private__.newObjectDeferred=function(){return W++,Ae[W]=function(){return he},W},H=function(T,J){return J=typeof J=="boolean"&&J,Ae[T]=he,J&&ce(T+" 0 obj"),T},le=u.__private__.newAdditionalObject=function(){var T={objId:ge(),content:""};return ve.push(T),T},ae=ge(),Z=ge(),oe=u.__private__.decodeColorString=function(T){var J=T.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length===5&&(J[4]==="k"||J[4]==="K")&&(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var xe=parseFloat(J[0]);J=[xe,xe,xe,"r"]}for(var Se="#",Qe=0;Qe<3;Qe++)Se+=("0"+Math.floor(255*parseFloat(J[Qe])).toString(16)).slice(-2);return Se},de=u.__private__.encodeColorString=function(T){var J;typeof T=="string"&&(T={ch1:T});var xe=T.ch1,Se=T.ch2,Qe=T.ch3,Xe=T.ch4,lt=T.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof xe=="string"&&xe.charAt(0)!=="#"){var Tt=new ZC(xe);if(Tt.ok)xe=Tt.toHex();else if(!/^\d*\.?\d*$/.test(xe))throw new Error('Invalid color "'+xe+'" passed to jsPDF.encodeColorString.')}if(typeof xe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(xe)&&(xe="#"+xe[1]+xe[1]+xe[2]+xe[2]+xe[3]+xe[3]),typeof xe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(xe)){var Mt=parseInt(xe.substr(1),16);xe=Mt>>16&255,Se=Mt>>8&255,Qe=255&Mt}if(Se===void 0||Xe===void 0&&xe===Se&&Se===Qe)if(typeof xe=="string")J=xe+" "+lt[0];else switch(T.precision){case 2:J=U(xe/255)+" "+lt[0];break;case 3:default:J=I(xe/255)+" "+lt[0]}else if(Xe===void 0||ea(Xe)==="object"){if(Xe&&!isNaN(Xe.a)&&Xe.a===0)return J=["1.","1.","1.",lt[1]].join(" ");if(typeof xe=="string")J=[xe,Se,Qe,lt[1]].join(" ");else switch(T.precision){case 2:J=[U(xe/255),U(Se/255),U(Qe/255),lt[1]].join(" ");break;default:case 3:J=[I(xe/255),I(Se/255),I(Qe/255),lt[1]].join(" ")}}else if(typeof xe=="string")J=[xe,Se,Qe,Xe,lt[2]].join(" ");else switch(T.precision){case 2:J=[U(xe),U(Se),U(Qe),U(Xe),lt[2]].join(" ");break;case 3:default:J=[I(xe),I(Se),I(Qe),I(Xe),lt[2]].join(" ")}return J},Oe=u.__private__.getFilters=function(){return o},Pe=u.__private__.putStream=function(T){var J=(T=T||{}).data||"",xe=T.filters||Oe(),Se=T.alreadyAppliedFilters||[],Qe=T.addLength1||!1,Xe=J.length,lt=T.objectId,Tt=function(Dn){return Dn};if(d!==null&&lt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Tt=kn.encryptor(lt,0));var Mt={};xe===!0&&(xe=["FlateEncode"]);var sr=T.additionalKeyValues||[],er=(Mt=Vt.API.processDataByFilters!==void 0?Vt.API.processDataByFilters(J,xe):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(Se)?Se.join(" "):Se.toString());if(Mt.data.length!==0&&(sr.push({key:"Length",value:Mt.data.length}),Qe===!0&&sr.push({key:"Length1",value:Xe})),er.length!=0)if(er.split("/").length-1==1)sr.push({key:"Filter",value:er});else{sr.push({key:"Filter",value:"["+er+"]"});for(var br=0;br<sr.length;br+=1)if(sr[br].key==="DecodeParms"){for(var ma=[],va=0;va<Mt.reverseChain.split("/").length-1;va+=1)ma.push("null");ma.push(sr[br].value),sr[br].value="["+ma.join(" ")+"]"}}ce("<<");for(var qa=0;qa<sr.length;qa++)ce("/"+sr[qa].key+" "+sr[qa].value);ce(">>"),Mt.data.length!==0&&(ce("stream"),ce(Tt(Mt.data)),ce("endstream"))},Ce=u.__private__.putPage=function(T){var J=T.number,xe=T.data,Se=T.objId,Qe=T.contentsObjId;H(Se,!0),ce("<</Type /Page"),ce("/Parent "+T.rootDictionaryObjId+" 0 R"),ce("/Resources "+T.resourceDictionaryObjId+" 0 R"),ce("/MediaBox ["+parseFloat(b(T.mediaBox.bottomLeftX))+" "+parseFloat(b(T.mediaBox.bottomLeftY))+" "+b(T.mediaBox.topRightX)+" "+b(T.mediaBox.topRightY)+"]"),T.cropBox!==null&&ce("/CropBox ["+b(T.cropBox.bottomLeftX)+" "+b(T.cropBox.bottomLeftY)+" "+b(T.cropBox.topRightX)+" "+b(T.cropBox.topRightY)+"]"),T.bleedBox!==null&&ce("/BleedBox ["+b(T.bleedBox.bottomLeftX)+" "+b(T.bleedBox.bottomLeftY)+" "+b(T.bleedBox.topRightX)+" "+b(T.bleedBox.topRightY)+"]"),T.trimBox!==null&&ce("/TrimBox ["+b(T.trimBox.bottomLeftX)+" "+b(T.trimBox.bottomLeftY)+" "+b(T.trimBox.topRightX)+" "+b(T.trimBox.topRightY)+"]"),T.artBox!==null&&ce("/ArtBox ["+b(T.artBox.bottomLeftX)+" "+b(T.artBox.bottomLeftY)+" "+b(T.artBox.topRightX)+" "+b(T.artBox.topRightY)+"]"),typeof T.userUnit=="number"&&T.userUnit!==1&&ce("/UserUnit "+T.userUnit),Er.publish("putPage",{objId:Se,pageContext:$t[J],pageNumber:J,page:xe}),ce("/Contents "+Qe+" 0 R"),ce(">>"),ce("endobj");var Xe=xe.join(`
`);return E===v.ADVANCED&&(Xe+=`
Q`),H(Qe,!0),Pe({data:Xe,filters:Oe(),objectId:Qe}),ce("endobj"),Se},De=u.__private__.putPages=function(){var T,J,xe=[];for(T=1;T<=Ur;T++)$t[T].objId=ge(),$t[T].contentsObjId=ge();for(T=1;T<=Ur;T++)xe.push(Ce({number:T,data:we[T],objId:$t[T].objId,contentsObjId:$t[T].contentsObjId,mediaBox:$t[T].mediaBox,cropBox:$t[T].cropBox,bleedBox:$t[T].bleedBox,trimBox:$t[T].trimBox,artBox:$t[T].artBox,userUnit:$t[T].userUnit,rootDictionaryObjId:ae,resourceDictionaryObjId:Z}));H(ae,!0),ce("<</Type /Pages");var Se="/Kids [";for(J=0;J<Ur;J++)Se+=xe[J]+" 0 R ";ce(Se+"]"),ce("/Count "+Ur),ce(">>"),ce("endobj"),Er.publish("postPutPages")},Me=function(T){Er.publish("putFont",{font:T,out:ce,newObject:Aa,putStream:Pe}),T.isAlreadyPutted!==!0&&(T.objectNumber=Aa(),ce("<<"),ce("/Type /Font"),ce("/BaseFont /"+hd(T.postScriptName)),ce("/Subtype /Type1"),typeof T.encoding=="string"&&ce("/Encoding /"+T.encoding),ce("/FirstChar 32"),ce("/LastChar 255"),ce(">>"),ce("endobj"))},$e=function(){for(var T in hr)hr.hasOwnProperty(T)&&(f===!1||f===!0&&p.hasOwnProperty(T))&&Me(hr[T])},ft=function(T){T.objectNumber=Aa();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[b(T.x),b(T.y),b(T.x+T.width),b(T.y+T.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+T.matrix.toString()+"]"});var xe=T.pages[1].join(`
`);Pe({data:xe,additionalKeyValues:J,objectId:T.objectNumber}),ce("endobj")},xt=function(){for(var T in xa)xa.hasOwnProperty(T)&&ft(xa[T])},ot=function(T,J){var xe,Se=[],Qe=1/(J-1);for(xe=0;xe<1;xe+=Qe)Se.push(xe);if(Se.push(1),T[0].offset!=0){var Xe={offset:0,color:T[0].color};T.unshift(Xe)}if(T[T.length-1].offset!=1){var lt={offset:1,color:T[T.length-1].color};T.push(lt)}for(var Tt="",Mt=0,sr=0;sr<Se.length;sr++){for(xe=Se[sr];xe>T[Mt+1].offset;)Mt++;var er=T[Mt].offset,br=(xe-er)/(T[Mt+1].offset-er),ma=T[Mt].color,va=T[Mt+1].color;Tt+=K(Math.round((1-br)*ma[0]+br*va[0]).toString(16))+K(Math.round((1-br)*ma[1]+br*va[1]).toString(16))+K(Math.round((1-br)*ma[2]+br*va[2]).toString(16))}return Tt.trim()},mt=function(T,J){J||(J=21);var xe=Aa(),Se=ot(T.colors,J),Qe=[];Qe.push({key:"FunctionType",value:"0"}),Qe.push({key:"Domain",value:"[0.0 1.0]"}),Qe.push({key:"Size",value:"["+J+"]"}),Qe.push({key:"BitsPerSample",value:"8"}),Qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe({data:Se,additionalKeyValues:Qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:xe}),ce("endobj"),T.objectNumber=Aa(),ce("<< /ShadingType "+T.type),ce("/ColorSpace /DeviceRGB");var Xe="/Coords ["+b(parseFloat(T.coords[0]))+" "+b(parseFloat(T.coords[1]))+" ";T.type===2?Xe+=b(parseFloat(T.coords[2]))+" "+b(parseFloat(T.coords[3])):Xe+=b(parseFloat(T.coords[2]))+" "+b(parseFloat(T.coords[3]))+" "+b(parseFloat(T.coords[4]))+" "+b(parseFloat(T.coords[5])),ce(Xe+="]"),T.matrix&&ce("/Matrix ["+T.matrix.toString()+"]"),ce("/Function "+xe+" 0 R"),ce("/Extend [true true]"),ce(">>"),ce("endobj")},Kt=function(T,J){var xe=ge(),Se=Aa();J.push({resourcesOid:xe,objectOid:Se}),T.objectNumber=Se;var Qe=[];Qe.push({key:"Type",value:"/Pattern"}),Qe.push({key:"PatternType",value:"1"}),Qe.push({key:"PaintType",value:"1"}),Qe.push({key:"TilingType",value:"1"}),Qe.push({key:"BBox",value:"["+T.boundingBox.map(b).join(" ")+"]"}),Qe.push({key:"XStep",value:b(T.xStep)}),Qe.push({key:"YStep",value:b(T.yStep)}),Qe.push({key:"Resources",value:xe+" 0 R"}),T.matrix&&Qe.push({key:"Matrix",value:"["+T.matrix.toString()+"]"}),Pe({data:T.stream,additionalKeyValues:Qe,objectId:T.objectNumber}),ce("endobj")},yr=function(T){var J;for(J in nr)nr.hasOwnProperty(J)&&(nr[J]instanceof jc?mt(nr[J]):nr[J]instanceof wd&&Kt(nr[J],T))},Cr=function(T){for(var J in T.objectNumber=Aa(),ce("<<"),T)switch(J){case"opacity":ce("/ca "+U(T[J]));break;case"stroke-opacity":ce("/CA "+U(T[J]))}ce(">>"),ce("endobj")},ya=function(){var T;for(T in Lr)Lr.hasOwnProperty(T)&&Cr(Lr[T])},Es=function(){for(var T in ce("/XObject <<"),xa)xa.hasOwnProperty(T)&&xa[T].objectNumber>=0&&ce("/"+T+" "+xa[T].objectNumber+" 0 R");Er.publish("putXobjectDict"),ce(">>")},bs=function(){kn.oid=Aa(),ce("<<"),ce("/Filter /Standard"),ce("/V "+kn.v),ce("/R "+kn.r),ce("/U <"+kn.toHexString(kn.U)+">"),ce("/O <"+kn.toHexString(kn.O)+">"),ce("/P "+kn.P),ce(">>"),ce("endobj")},Fn=function(){for(var T in ce("/Font <<"),hr)hr.hasOwnProperty(T)&&(f===!1||f===!0&&p.hasOwnProperty(T))&&ce("/"+T+" "+hr[T].objectNumber+" 0 R");ce(">>")},js=function(){if(Object.keys(nr).length>0){for(var T in ce("/Shading <<"),nr)nr.hasOwnProperty(T)&&nr[T]instanceof jc&&nr[T].objectNumber>=0&&ce("/"+T+" "+nr[T].objectNumber+" 0 R");Er.publish("putShadingPatternDict"),ce(">>")}},oi=function(T){if(Object.keys(nr).length>0){for(var J in ce("/Pattern <<"),nr)nr.hasOwnProperty(J)&&nr[J]instanceof u.TilingPattern&&nr[J].objectNumber>=0&&nr[J].objectNumber<T&&ce("/"+J+" "+nr[J].objectNumber+" 0 R");Er.publish("putTilingPatternDict"),ce(">>")}},ss=function(){if(Object.keys(Lr).length>0){var T;for(T in ce("/ExtGState <<"),Lr)Lr.hasOwnProperty(T)&&Lr[T].objectNumber>=0&&ce("/"+T+" "+Lr[T].objectNumber+" 0 R");Er.publish("putGStateDict"),ce(">>")}},ha=function(T){H(T.resourcesOid,!0),ce("<<"),ce("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Fn(),js(),oi(T.objectOid),ss(),Es(),ce(">>"),ce("endobj")},Yr=function(){var T=[];$e(),ya(),xt(),yr(T),Er.publish("putResources"),T.forEach(ha),ha({resourcesOid:Z,objectOid:Number.MAX_SAFE_INTEGER}),Er.publish("postPutResources")},en=function(){Er.publish("putAdditionalObjects");for(var T=0;T<ve.length;T++){var J=ve[T];H(J.objId,!0),ce(J.content),ce("endobj")}Er.publish("postPutAdditionalObjects")},Co=function(T){vt[T.fontName]=vt[T.fontName]||{},vt[T.fontName][T.fontStyle]=T.id},li=function(T,J,xe,Se,Qe){var Xe={id:"F"+(Object.keys(hr).length+1).toString(10),postScriptName:T,fontName:J,fontStyle:xe,encoding:Se,isStandardFont:Qe||!1,metadata:{}};return Er.publish("addFont",{font:Xe,instance:this}),hr[Xe.id]=Xe,Co(Xe),Xe.id},wA=function(T){for(var J=0,xe=Ye.length;J<xe;J++){var Se=li.call(this,T[J][0],T[J][1],T[J][2],Ye[J][3],!0);f===!1&&(p[Se]=!0);var Qe=T[J][0].split("-");Co({id:Se,fontName:Qe[0],fontStyle:Qe[1]||""})}Er.publish("addFonts",{fonts:hr,dictionary:vt})},Rn=function(T){return T.foo=function(){try{return T.apply(this,arguments)}catch(Se){var J=Se.stack||"";~J.indexOf(" at ")&&(J=J.split(" at ")[1]);var xe="Error in function "+J.split(`
`)[0].split("<")[0]+": "+Se.message;if(!Yt.console)throw new Error(xe);Yt.console.error(xe,Se),Yt.alert&&alert(xe)}},T.foo.bar=T,T.foo},Bo=function(T,J){var xe,Se,Qe,Xe,lt,Tt,Mt,sr,er;if(Qe=(J=J||{}).sourceEncoding||"Unicode",lt=J.outputEncoding,(J.autoencode||lt)&&hr[ut].metadata&&hr[ut].metadata[Qe]&&hr[ut].metadata[Qe].encoding&&(Xe=hr[ut].metadata[Qe].encoding,!lt&&hr[ut].encoding&&(lt=hr[ut].encoding),!lt&&Xe.codePages&&(lt=Xe.codePages[0]),typeof lt=="string"&&(lt=Xe[lt]),lt)){for(Mt=!1,Tt=[],xe=0,Se=T.length;xe<Se;xe++)(sr=lt[T.charCodeAt(xe)])?Tt.push(String.fromCharCode(sr)):Tt.push(T[xe]),Tt[xe].charCodeAt(0)>>8&&(Mt=!0);T=Tt.join("")}for(xe=T.length;Mt===void 0&&xe!==0;)T.charCodeAt(xe-1)>>8&&(Mt=!0),xe--;if(!Mt)return T;for(Tt=J.noBOM?[]:[254,255],xe=0,Se=T.length;xe<Se;xe++){if((er=(sr=T.charCodeAt(xe))>>8)>>8)throw new Error("Character at position "+xe+" of string '"+T+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tt.push(er),Tt.push(sr-(er<<8))}return String.fromCharCode.apply(void 0,Tt)},An=u.__private__.pdfEscape=u.pdfEscape=function(T,J){return Bo(T,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hc=u.__private__.beginPage=function(T){we[++Ur]=[],$t[Ur]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(T[0]),topRightY:Number(T[1])}},ll(Ur),pe(we[D])},mc=function(T,J){var xe,Se,Qe;switch(r=J||r,typeof T=="string"&&(xe=y(T.toLowerCase()),Array.isArray(xe)&&(Se=xe[0],Qe=xe[1])),Array.isArray(T)&&(Se=T[0]*ct,Qe=T[1]*ct),isNaN(Se)&&(Se=n[0],Qe=n[1]),(Se>14400||Qe>14400)&&(Xr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Se=Math.min(14400,Se),Qe=Math.min(14400,Qe)),n=[Se,Qe],r.substr(0,1)){case"l":Qe>Se&&(n=[Qe,Se]);break;case"p":Se>Qe&&(n=[Qe,Se])}hc(n),E0(au),ce(Fi),su!==0&&ce(su+" J"),iu!==0&&ce(iu+" j"),Er.publish("addPage",{pageNumber:Ur})},Zd=function(T){T>0&&T<=Ur&&(we.splice(T,1),$t.splice(T,1),Ur--,D>Ur&&(D=Ur),this.setPage(D))},ll=function(T){T>0&&T<=Ur&&(D=T)},Km=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return we.length-1},g0=function(T,J,xe){var Se,Qe=void 0;return xe=xe||{},T=T!==void 0?T:hr[ut].fontName,J=J!==void 0?J:hr[ut].fontStyle,Se=T.toLowerCase(),vt[Se]!==void 0&&vt[Se][J]!==void 0?Qe=vt[Se][J]:vt[T]!==void 0&&vt[T][J]!==void 0?Qe=vt[T][J]:xe.disableWarning===!1&&Xr.warn("Unable to look up font label for font '"+T+"', '"+J+"'. Refer to getFontList() for available fonts."),Qe||xe.noFallback||(Qe=vt.times[J])==null&&(Qe=vt.times.normal),Qe},Hm=u.__private__.putInfo=function(){var T=Aa(),J=function(Se){return Se};for(var xe in d!==null&&(J=kn.encryptor(T,0)),ce("<<"),ce("/Producer ("+An(J("jsPDF "+Vt.version))+")"),Bt)Bt.hasOwnProperty(xe)&&Bt[xe]&&ce("/"+xe.substr(0,1).toUpperCase()+xe.substr(1)+" ("+An(J(Bt[xe]))+")");ce("/CreationDate ("+An(J(P))+")"),ce(">>"),ce("endobj")},eu=u.__private__.putCatalog=function(T){var J=(T=T||{}).rootDictionaryObjId||ae;switch(Aa(),ce("<<"),ce("/Type /Catalog"),ce("/Pages "+J+" 0 R"),je||(je="fullwidth"),je){case"fullwidth":ce("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ce("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ce("/OpenAction [3 0 R /Fit]");break;case"original":ce("/OpenAction [3 0 R /XYZ null null 1]");break;default:var xe=""+je;xe.substr(xe.length-1)==="%"&&(je=parseInt(je)/100),typeof je=="number"&&ce("/OpenAction [3 0 R /XYZ null null "+U(je)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":ce("/PageLayout /OneColumn");break;case"single":ce("/PageLayout /SinglePage");break;case"two":case"twoleft":ce("/PageLayout /TwoColumnLeft");break;case"tworight":ce("/PageLayout /TwoColumnRight")}Ct&&ce("/PageMode /"+Ct),Er.publish("putCatalog"),ce(">>"),ce("endobj")},Gm=u.__private__.putTrailer=function(){ce("trailer"),ce("<<"),ce("/Size "+(W+1)),ce("/Root "+W+" 0 R"),ce("/Info "+(W-1)+" 0 R"),d!==null&&ce("/Encrypt "+kn.oid+" 0 R"),ce("/ID [ <"+Q+"> <"+Q+"> ]"),ce(">>")},zm=u.__private__.putHeader=function(){ce("%PDF-"+g),ce("%ºß¬à")},Vm=u.__private__.putXRef=function(){var T="0000000000";ce("xref"),ce("0 "+(W+1)),ce("0000000000 65535 f ");for(var J=1;J<=W;J++)typeof Ae[J]=="function"?ce((T+Ae[J]()).slice(-10)+" 00000 n "):Ae[J]!==void 0?ce((T+Ae[J]).slice(-10)+" 00000 n "):ce("0000000000 00000 n ")},So=u.__private__.buildDocument=function(){Ee(),pe(ue),Er.publish("buildDocument"),zm(),De(),en(),Yr(),d!==null&&bs(),Hm(),eu();var T=he;return Vm(),Gm(),ce("startxref"),ce(""+T),ce("%%EOF"),pe(we[D]),ue.join(`
`)},EA=u.__private__.getBlob=function(T){return new Blob([et(T)],{type:"application/pdf"})},bA=u.output=u.__private__.output=Rn(function(T,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",T){case void 0:return So();case"save":u.save(J.filename);break;case"arraybuffer":return et(So());case"blob":return EA(So());case"bloburi":case"bloburl":if(Yt.URL!==void 0&&typeof Yt.URL.createObjectURL=="function")return Yt.URL&&Yt.URL.createObjectURL(EA(So()))||void 0;Xr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var xe="",Se=So();try{xe=Hx(Se)}catch{xe=Hx(unescape(encodeURIComponent(Se)))}return"data:application/pdf;filename="+J.filename+";base64,"+xe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Yt)==="[object Window]"){var Qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(Qe=J.pdfObjectUrl,Xe="");var lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Qe+'"'+Xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Tt=Yt.open();return Tt!==null&&Tt.document.write(lt),Tt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Yt)==="[object Window]"){var Mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',sr=Yt.open();if(sr!==null){sr.document.write(Mt);var er=this;sr.document.documentElement.querySelector("#pdfViewer").onload=function(){sr.document.title=J.filename,sr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(er.output("bloburl"))}}return sr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var br='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',ma=Yt.open();if(ma!==null&&(ma.document.write(br),ma.document.title=J.filename),ma||typeof safari>"u")return ma;break;case"datauri":case"dataurl":return Yt.document.location.href=this.output("datauristring",J);default:return null}}),x0=function(T){return Array.isArray(ii)===!0&&ii.indexOf(T)>-1};switch(a){case"pt":ct=1;break;case"mm":ct=72/25.4;break;case"cm":ct=72/2.54;break;case"in":ct=72;break;case"px":ct=x0("px_scaling")==1?.75:96/72;break;case"pc":case"em":ct=12;break;case"ex":ct=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ct=a}var kn=null;z(),ee();var $m=function(T){return d!==null?kn.encryptor(T,0):function(J){return J}},y0=u.__private__.getPageInfo=u.getPageInfo=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:$t[T].objId,pageNumber:T,pageContext:$t[T]}},Zt=u.__private__.getPageInfoByObjId=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in $t)if($t[J].objId===T)break;return y0(J)},Ym=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:$t[D].objId,pageNumber:D,pageContext:$t[D]}};u.addPage=function(){return mc.apply(this,arguments),this},u.setPage=function(){return ll.apply(this,arguments),pe.call(this,we[D]),this},u.insertPage=function(T){return this.addPage(),this.movePage(D,T),this},u.movePage=function(T,J){var xe,Se;if(T>J){xe=we[T],Se=$t[T];for(var Qe=T;Qe>J;Qe--)we[Qe]=we[Qe-1],$t[Qe]=$t[Qe-1];we[J]=xe,$t[J]=Se,this.setPage(J)}else if(T<J){xe=we[T],Se=$t[T];for(var Xe=T;Xe<J;Xe++)we[Xe]=we[Xe+1],$t[Xe]=$t[Xe+1];we[J]=xe,$t[J]=Se,this.setPage(J)}return this},u.deletePage=function(){return Zd.apply(this,arguments),this},u.__private__.text=u.text=function(T,J,xe,Se,Qe){var Xe,lt,Tt,Mt,sr,er,br,ma,va,qa=(Se=Se||{}).scope||this;if(typeof T=="number"&&typeof J=="number"&&(typeof xe=="string"||Array.isArray(xe))){var Dn=xe;xe=J,J=T,T=Dn}if(arguments[3]instanceof Dt?(O("The transform parameter of text() with a Matrix value"),va=Qe):(Tt=arguments[4],Mt=arguments[5],ea(br=arguments[3])==="object"&&br!==null||(typeof Tt=="string"&&(Mt=Tt,Tt=null),typeof br=="string"&&(Mt=br,br=null),typeof br=="number"&&(Tt=br,br=null),Se={flags:br,angle:Tt,align:Mt})),isNaN(J)||isNaN(xe)||T==null)throw new Error("Invalid arguments passed to jsPDF.text");if(T.length===0)return qa;var dn="",Ri=!1,Ls=typeof Se.lineHeightFactor=="number"?Se.lineHeightFactor:xc,eo=qa.internal.scaleFactor;function T0(ra){return ra=ra.split("	").join(Array(Se.TabLen||9).join(" ")),An(ra,br)}function du(ra){for(var aa,Na=ra.concat(),tn=[],Fo=Na.length;Fo--;)typeof(aa=Na.shift())=="string"?tn.push(aa):Array.isArray(ra)&&(aa.length===1||aa[1]===void 0&&aa[2]===void 0)?tn.push(aa[0]):tn.push([aa[0],aa[1],aa[2]]);return tn}function uu(ra,aa){var Na;if(typeof ra=="string")Na=aa(ra)[0];else if(Array.isArray(ra)){for(var tn,Fo,vu=ra.concat(),UA=[],R0=vu.length;R0--;)typeof(tn=vu.shift())=="string"?UA.push(aa(tn)[0]):Array.isArray(tn)&&typeof tn[0]=="string"&&(Fo=aa(tn[0],tn[1],tn[2]),UA.push([Fo[0],Fo[1],Fo[2]]));Na=UA}return Na}var OA=!1,fu=!0;if(typeof T=="string")OA=!0;else if(Array.isArray(T)){var pu=T.concat();lt=[];for(var IA,wn=pu.length;wn--;)(typeof(IA=pu.shift())!="string"||Array.isArray(IA)&&typeof IA[0]!="string")&&(fu=!1);OA=fu}if(OA===!1)throw new Error('Type of text must be string or Array. "'+T+'" is not recognized.');typeof T=="string"&&(T=T.match(/[\r?\n]/)?T.split(/\r\n|\r|\n/g):[T]);var NA=tt/qa.internal.scaleFactor,FA=NA*(Ls-1);switch(Se.baseline){case"bottom":xe-=FA;break;case"top":xe+=NA-FA;break;case"hanging":xe+=NA-2*FA;break;case"middle":xe+=NA/2-FA}if((er=Se.maxWidth||0)>0&&(typeof T=="string"?T=qa.splitTextToSize(T,er):Object.prototype.toString.call(T)==="[object Array]"&&(T=T.reduce(function(ra,aa){return ra.concat(qa.splitTextToSize(aa,er))},[]))),Xe={text:T,x:J,y:xe,options:Se,mutex:{pdfEscape:An,activeFontKey:ut,fonts:hr,activeFontSize:tt}},Er.publish("preProcessText",Xe),T=Xe.text,Tt=(Se=Xe.options).angle,!(va instanceof Dt)&&Tt&&typeof Tt=="number"){Tt*=Math.PI/180,Se.rotationDirection===0&&(Tt=-Tt),E===v.ADVANCED&&(Tt=-Tt);var RA=Math.cos(Tt),hu=Math.sin(Tt);va=new Dt(RA,hu,-hu,RA,0,0)}else Tt&&Tt instanceof Dt&&(va=Tt);E!==v.ADVANCED||va||(va=Ja),(sr=Se.charSpace||BA)!==void 0&&(dn+=b(R(sr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ma=Se.horizontalScale)!==void 0&&(dn+=b(100*ma)+` Tz
`),Se.lang;var _s=-1,sg=Se.renderingMode!==void 0?Se.renderingMode:Se.stroke,mu=qa.internal.getCurrentPageInfo().pageContext;switch(sg){case 0:case!1:case"fill":_s=0;break;case 1:case!0:case"stroke":_s=1;break;case 2:case"fillThenStroke":_s=2;break;case 3:case"invisible":_s=3;break;case 4:case"fillAndAddForClipping":_s=4;break;case 5:case"strokeAndAddPathForClipping":_s=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":_s=6;break;case 7:case"addToPathForClipping":_s=7}var O0=mu.usedRenderingMode!==void 0?mu.usedRenderingMode:-1;_s!==-1?dn+=_s+` Tr
`:O0!==-1&&(dn+=`0 Tr
`),_s!==-1&&(mu.usedRenderingMode=_s),Mt=Se.align||"left";var ci,kA=tt*Ls,I0=qa.internal.pageSize.getWidth(),N0=hr[ut];sr=Se.charSpace||BA,er=Se.maxWidth||0,br=Object.assign({autoencode:!0,noBOM:!0},Se.flags);var ul=[],wc=function(ra){return qa.getStringUnitWidth(ra,{font:N0,charSpace:sr,fontSize:tt,doKerning:!1})*tt/eo};if(Object.prototype.toString.call(T)==="[object Array]"){var Cs;lt=du(T),Mt!=="left"&&(ci=lt.map(wc));var is,fl=0;if(Mt==="right"){J-=ci[0],T=[],wn=lt.length;for(var Oo=0;Oo<wn;Oo++)Oo===0?(is=Zi(J),Cs=To(xe)):(is=R(fl-ci[Oo]),Cs=-kA),T.push([lt[Oo],is,Cs]),fl=ci[Oo]}else if(Mt==="center"){J-=ci[0]/2,T=[],wn=lt.length;for(var Io=0;Io<wn;Io++)Io===0?(is=Zi(J),Cs=To(xe)):(is=R((fl-ci[Io])/2),Cs=-kA),T.push([lt[Io],is,Cs]),fl=ci[Io]}else if(Mt==="left"){T=[],wn=lt.length;for(var DA=0;DA<wn;DA++)T.push(lt[DA])}else if(Mt==="justify"&&N0.encoding==="Identity-H"){T=[],wn=lt.length,er=er!==0?er:I0;for(var No=0,Ia=0;Ia<wn;Ia++)if(Cs=Ia===0?To(xe):-kA,is=Ia===0?Zi(J):No,Ia<wn-1){var gu=R((er-ci[Ia])/(lt[Ia].split(" ").length-1)),os=lt[Ia].split(" ");T.push([os[0]+" ",is,Cs]),No=0;for(var Ai=1;Ai<os.length;Ai++){var jA=(wc(os[Ai-1]+" "+os[Ai])-wc(os[Ai]))*eo+gu;Ai==os.length-1?T.push([os[Ai],jA,0]):T.push([os[Ai]+" ",jA,0]),No-=jA}}else T.push([lt[Ia],is,Cs]);T.push(["",No,0])}else{if(Mt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(T=[],wn=lt.length,er=er!==0?er:I0,Ia=0;Ia<wn;Ia++)Cs=Ia===0?To(xe):-kA,is=Ia===0?Zi(J):0,Ia<wn-1?ul.push(b(R((er-ci[Ia])/(lt[Ia].split(" ").length-1)))):ul.push(0),T.push([lt[Ia],is,Cs])}}var F0=typeof Se.R2L=="boolean"?Se.R2L:At;F0===!0&&(T=uu(T,function(ra,aa,Na){return[ra.split("").reverse().join(""),aa,Na]})),Xe={text:T,x:J,y:xe,options:Se,mutex:{pdfEscape:An,activeFontKey:ut,fonts:hr,activeFontSize:tt}},Er.publish("postProcessText",Xe),T=Xe.text,Ri=Xe.mutex.isHex||!1;var xu=hr[ut].encoding;xu!=="WinAnsiEncoding"&&xu!=="StandardEncoding"||(T=uu(T,function(ra,aa,Na){return[T0(ra),aa,Na]})),lt=du(T),T=[];for(var Ec,bc,pl,_c=0,LA=1,Cc=Array.isArray(lt[0])?LA:_c,hl="",yu=function(ra,aa,Na){var tn="";return Na instanceof Dt?(Na=typeof Se.angle=="number"?ns(Na,new Dt(1,0,0,1,ra,aa)):ns(new Dt(1,0,0,1,ra,aa),Na),E===v.ADVANCED&&(Na=ns(new Dt(1,0,0,-1,0,0),Na)),tn=Na.join(" ")+` Tm
`):tn=b(ra)+" "+b(aa)+` Td
`,tn},di=0;di<lt.length;di++){switch(hl="",Cc){case LA:pl=(Ri?"<":"(")+lt[di][0]+(Ri?">":")"),Ec=parseFloat(lt[di][1]),bc=parseFloat(lt[di][2]);break;case _c:pl=(Ri?"<":"(")+lt[di]+(Ri?">":")"),Ec=Zi(J),bc=To(xe)}ul!==void 0&&ul[di]!==void 0&&(hl=ul[di]+` Tw
`),di===0?T.push(hl+yu(Ec,bc,va)+pl):Cc===_c?T.push(hl+pl):Cc===LA&&T.push(hl+yu(Ec,bc,va)+pl)}T=Cc===_c?T.join(` Tj
T* `):T.join(` Tj
`),T+=` Tj
`;var ui=`BT
/`;return ui+=ut+" "+tt+` Tf
`,ui+=b(tt*Ls)+` TL
`,ui+=yc+`
`,ui+=dn,ui+=T,ce(ui+="ET"),p[ut]=!0,qa};var Wm=u.__private__.clip=u.clip=function(T){return ce(T==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return Wm("evenodd")},u.__private__.discardPath=u.discardPath=function(){return ce("n"),this};var Ji=u.__private__.isValidStyle=function(T){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(T)!==-1&&(J=!0),J};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(T){return Ji(T)&&(A=T),this};var v0=u.__private__.getStyle=u.getStyle=function(T){var J=A;switch(T){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=T}return J},w0=u.close=function(){return ce("h"),this};u.stroke=function(){return ce("S"),this},u.fill=function(T){return _A("f",T),this},u.fillEvenOdd=function(T){return _A("f*",T),this},u.fillStroke=function(T){return _A("B",T),this},u.fillStrokeEvenOdd=function(T){return _A("B*",T),this};var _A=function(T,J){ea(J)==="object"?Jm(J,T):ce(T)},tu=function(T){T===null||E===v.ADVANCED&&T===void 0||(T=v0(T),ce(T))};function Xm(T,J,xe,Se,Qe){var Xe=new wd(J||this.boundingBox,xe||this.xStep,Se||this.yStep,this.gState,Qe||this.matrix);Xe.stream=this.stream;var lt=T+"$$"+this.cloneIndex+++"$$";return Za(lt,Xe),Xe}var Jm=function(T,J){var xe=cn[T.key],Se=nr[xe];if(Se instanceof jc)ce("q"),ce(Zm(J)),Se.gState&&u.setGState(Se.gState),ce(T.matrix.toString()+" cm"),ce("/"+xe+" sh"),ce("Q");else if(Se instanceof wd){var Qe=new Dt(1,0,0,-1,0,dl());T.matrix&&(Qe=Qe.multiply(T.matrix||Ja),xe=Xm.call(Se,T.key,T.boundingBox,T.xStep,T.yStep,Qe).id),ce("q"),ce("/Pattern cs"),ce("/"+xe+" scn"),Se.gState&&u.setGState(Se.gState),ce(J),ce("Q")}},Zm=function(T){switch(T){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},ru=u.moveTo=function(T,J){return ce(b(R(T))+" "+b(N(J))+" m"),this},gc=u.lineTo=function(T,J){return ce(b(R(T))+" "+b(N(J))+" l"),this},cl=u.curveTo=function(T,J,xe,Se,Qe,Xe){return ce([b(R(T)),b(N(J)),b(R(xe)),b(N(Se)),b(R(Qe)),b(N(Xe)),"c"].join(" ")),this};u.__private__.line=u.line=function(T,J,xe,Se,Qe){if(isNaN(T)||isNaN(J)||isNaN(xe)||isNaN(Se)||!Ji(Qe))throw new Error("Invalid arguments passed to jsPDF.line");return E===v.COMPAT?this.lines([[xe-T,Se-J]],T,J,[1,1],Qe||"S"):this.lines([[xe-T,Se-J]],T,J,[1,1]).stroke()},u.__private__.lines=u.lines=function(T,J,xe,Se,Qe,Xe){var lt,Tt,Mt,sr,er,br,ma,va,qa,Dn,dn,Ri;if(typeof T=="number"&&(Ri=xe,xe=J,J=T,T=Ri),Se=Se||[1,1],Xe=Xe||!1,isNaN(J)||isNaN(xe)||!Array.isArray(T)||!Array.isArray(Se)||!Ji(Qe)||typeof Xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ru(J,xe),lt=Se[0],Tt=Se[1],sr=T.length,Dn=J,dn=xe,Mt=0;Mt<sr;Mt++)(er=T[Mt]).length===2?(Dn=er[0]*lt+Dn,dn=er[1]*Tt+dn,gc(Dn,dn)):(br=er[0]*lt+Dn,ma=er[1]*Tt+dn,va=er[2]*lt+Dn,qa=er[3]*Tt+dn,Dn=er[4]*lt+Dn,dn=er[5]*Tt+dn,cl(br,ma,va,qa,Dn,dn));return Xe&&w0(),tu(Qe),this},u.path=function(T){for(var J=0;J<T.length;J++){var xe=T[J],Se=xe.c;switch(xe.op){case"m":ru(Se[0],Se[1]);break;case"l":gc(Se[0],Se[1]);break;case"c":cl.apply(this,Se);break;case"h":w0()}}return this},u.__private__.rect=u.rect=function(T,J,xe,Se,Qe){if(isNaN(T)||isNaN(J)||isNaN(xe)||isNaN(Se)||!Ji(Qe))throw new Error("Invalid arguments passed to jsPDF.rect");return E===v.COMPAT&&(Se=-Se),ce([b(R(T)),b(N(J)),b(R(xe)),b(R(Se)),"re"].join(" ")),tu(Qe),this},u.__private__.triangle=u.triangle=function(T,J,xe,Se,Qe,Xe,lt){if(isNaN(T)||isNaN(J)||isNaN(xe)||isNaN(Se)||isNaN(Qe)||isNaN(Xe)||!Ji(lt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[xe-T,Se-J],[Qe-xe,Xe-Se],[T-Qe,J-Xe]],T,J,[1,1],lt,!0),this},u.__private__.roundedRect=u.roundedRect=function(T,J,xe,Se,Qe,Xe,lt){if(isNaN(T)||isNaN(J)||isNaN(xe)||isNaN(Se)||isNaN(Qe)||isNaN(Xe)||!Ji(lt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Tt=4/3*(Math.SQRT2-1);return Qe=Math.min(Qe,.5*xe),Xe=Math.min(Xe,.5*Se),this.lines([[xe-2*Qe,0],[Qe*Tt,0,Qe,Xe-Xe*Tt,Qe,Xe],[0,Se-2*Xe],[0,Xe*Tt,-Qe*Tt,Xe,-Qe,Xe],[2*Qe-xe,0],[-Qe*Tt,0,-Qe,-Xe*Tt,-Qe,-Xe],[0,2*Xe-Se],[0,-Xe*Tt,Qe*Tt,-Xe,Qe,-Xe]],T+Qe,J,[1,1],lt,!0),this},u.__private__.ellipse=u.ellipse=function(T,J,xe,Se,Qe){if(isNaN(T)||isNaN(J)||isNaN(xe)||isNaN(Se)||!Ji(Qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xe=4/3*(Math.SQRT2-1)*xe,lt=4/3*(Math.SQRT2-1)*Se;return ru(T+xe,J),cl(T+xe,J-lt,T+Xe,J-Se,T,J-Se),cl(T-Xe,J-Se,T-xe,J-lt,T-xe,J),cl(T-xe,J+lt,T-Xe,J+Se,T,J+Se),cl(T+Xe,J+Se,T+xe,J+lt,T+xe,J),tu(Qe),this},u.__private__.circle=u.circle=function(T,J,xe,Se){if(isNaN(T)||isNaN(J)||isNaN(xe)||!Ji(Se))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(T,J,xe,xe,Se)},u.setFont=function(T,J,xe){return xe&&(J=B(J,xe)),ut=g0(T,J,{disableWarning:!1}),this};var eg=u.__private__.getFont=u.getFont=function(){return hr[g0.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var T,J,xe={};for(T in vt)if(vt.hasOwnProperty(T))for(J in xe[T]=[],vt[T])vt[T].hasOwnProperty(J)&&xe[T].push(J);return xe},u.addFont=function(T,J,xe,Se,Qe){var Xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xe.indexOf(arguments[3])!==-1?Qe=arguments[3]:arguments[3]&&Xe.indexOf(arguments[3])==-1&&(xe=B(xe,Se)),Qe=Qe||"Identity-H",li.call(this,T,J,xe,Qe)};var xc,au=e.lineWidth||.200025,CA=u.__private__.getLineWidth=u.getLineWidth=function(){return au},E0=u.__private__.setLineWidth=u.setLineWidth=function(T){return au=T,ce(b(R(T))+" w"),this};u.__private__.setLineDash=Vt.API.setLineDash=Vt.API.setLineDashPattern=function(T,J){if(T=T||[],J=J||0,isNaN(J)||!Array.isArray(T))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return T=T.map(function(xe){return b(R(xe))}).join(" "),J=b(R(J)),ce("["+T+"] "+J+" d"),this};var b0=u.__private__.getLineHeight=u.getLineHeight=function(){return tt*xc};u.__private__.getLineHeight=u.getLineHeight=function(){return tt*xc};var _0=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(T){return typeof(T=T||1.15)=="number"&&(xc=T),this},C0=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return xc};_0(e.lineHeight);var Zi=u.__private__.getHorizontalCoordinate=function(T){return R(T)},To=u.__private__.getVerticalCoordinate=function(T){return E===v.ADVANCED?T:$t[D].mediaBox.topRightY-$t[D].mediaBox.bottomLeftY-R(T)},tg=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(T){return b(Zi(T))},Al=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(T){return b(To(T))},Fi=e.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return oe(Fi)},u.__private__.setStrokeColor=u.setDrawColor=function(T,J,xe,Se){return Fi=de({ch1:T,ch2:J,ch3:xe,ch4:Se,pdfColorType:"draw",precision:2}),ce(Fi),this};var nu=e.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return oe(nu)},u.__private__.setFillColor=u.setFillColor=function(T,J,xe,Se){return nu=de({ch1:T,ch2:J,ch3:xe,ch4:Se,pdfColorType:"fill",precision:2}),ce(nu),this};var yc=e.textColor||"0 g",rg=u.__private__.getTextColor=u.getTextColor=function(){return oe(yc)};u.__private__.setTextColor=u.setTextColor=function(T,J,xe,Se){return yc=de({ch1:T,ch2:J,ch3:xe,ch4:Se,pdfColorType:"text",precision:3}),this};var BA=e.charSpace,ag=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(BA||0)};u.__private__.setCharSpace=u.setCharSpace=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return BA=T,this};var su=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(T){var J=u.CapJoinStyles[T];if(J===void 0)throw new Error("Line cap style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return su=J,ce(J+" J"),this};var iu=0;u.__private__.setLineJoin=u.setLineJoin=function(T){var J=u.CapJoinStyles[T];if(J===void 0)throw new Error("Line join style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return iu=J,ce(J+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(T){if(T=T||0,isNaN(T))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ce(b(R(T))+" M"),this},u.GState=Kh,u.setGState=function(T){(T=typeof T=="string"?Lr[as[T]]:B0(null,T)).equals(Ds)||(ce("/"+T.id+" gs"),Ds=T)};var B0=function(T,J){if(!T||!as[T]){var xe=!1;for(var Se in Lr)if(Lr.hasOwnProperty(Se)&&Lr[Se].equals(J)){xe=!0;break}if(xe)J=Lr[Se];else{var Qe="GS"+(Object.keys(Lr).length+1).toString(10);Lr[Qe]=J,J.id=Qe}return T&&(as[T]=J.id),Er.publish("addGState",J),J}};u.addGState=function(T,J){return B0(T,J),this},u.saveGraphicsState=function(){return ce("q"),Or.push({key:ut,size:tt,color:yc}),this},u.restoreGraphicsState=function(){ce("Q");var T=Or.pop();return ut=T.key,tt=T.size,yc=T.color,Ds=null,this},u.setCurrentTransformationMatrix=function(T){return ce(T.toString()+" cm"),this},u.comment=function(T){return ce("#"+T),this};var SA=function(T,J){var xe=T||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return xe},set:function(Xe){isNaN(Xe)||(xe=parseFloat(Xe))}});var Se=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Se},set:function(Xe){isNaN(Xe)||(Se=parseFloat(Xe))}});var Qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Qe},set:function(Xe){Qe=Xe.toString()}}),this},ou=function(T,J,xe,Se){SA.call(this,T,J),this.type="rect";var Qe=xe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Qe},set:function(lt){isNaN(lt)||(Qe=parseFloat(lt))}});var Xe=Se||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xe},set:function(lt){isNaN(lt)||(Xe=parseFloat(lt))}}),this},lu=function(){this.page=Ur,this.currentPage=D,this.pages=we.slice(0),this.pagesContext=$t.slice(0),this.x=wr,this.y=Rt,this.matrix=$r,this.width=vc(D),this.height=dl(D),this.outputDestination=He,this.id="",this.objectNumber=-1};lu.prototype.restore=function(){Ur=this.page,D=this.currentPage,$t=this.pagesContext,we=this.pages,wr=this.x,Rt=this.y,$r=this.matrix,cu(D,this.width),Au(D,this.height),He=this.outputDestination};var S0=function(T,J,xe,Se,Qe){ws.push(new lu),Ur=D=0,we=[],wr=T,Rt=J,$r=Qe,hc([xe,Se])},ng=function(T){if(vs[T])ws.pop().restore();else{var J=new lu,xe="Xo"+(Object.keys(xa).length+1).toString(10);J.id=xe,vs[T]=xe,xa[xe]=J,Er.publish("addFormObject",J),ws.pop().restore()}};for(var TA in u.beginFormObject=function(T,J,xe,Se,Qe){return S0(T,J,xe,Se,Qe),this},u.endFormObject=function(T){return ng(T),this},u.doFormObject=function(T,J){var xe=xa[vs[T]];return ce("q"),ce(J.toString()+" cm"),ce("/"+xe.id+" Do"),ce("Q"),this},u.getFormObject=function(T){var J=xa[vs[T]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},u.save=function(T,J){return T=T||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(kc(EA(So()),T),typeof kc.unload=="function"&&Yt.setTimeout&&setTimeout(kc.unload,911),this):new Promise(function(xe,Se){try{var Qe=kc(EA(So()),T);typeof kc.unload=="function"&&Yt.setTimeout&&setTimeout(kc.unload,911),xe(Qe)}catch(Xe){Se(Xe.message)}})},Vt.API)Vt.API.hasOwnProperty(TA)&&(TA==="events"&&Vt.API.events.length?function(T,J){var xe,Se,Qe;for(Qe=J.length-1;Qe!==-1;Qe--)xe=J[Qe][0],Se=J[Qe][1],T.subscribe.apply(T,[xe].concat(typeof Se=="function"?[Se]:Se))}(Er,Vt.API.events):u[TA]=Vt.API[TA]);var vc=u.getPageWidth=function(T){return($t[T=T||D].mediaBox.topRightX-$t[T].mediaBox.bottomLeftX)/ct},cu=u.setPageWidth=function(T,J){$t[T].mediaBox.topRightX=J*ct+$t[T].mediaBox.bottomLeftX},dl=u.getPageHeight=function(T){return($t[T=T||D].mediaBox.topRightY-$t[T].mediaBox.bottomLeftY)/ct},Au=u.setPageHeight=function(T,J){$t[T].mediaBox.topRightY=J*ct+$t[T].mediaBox.bottomLeftY};return u.internal={pdfEscape:An,getStyle:v0,getFont:eg,getFontSize:_e,getCharSpace:ag,getTextColor:rg,getLineHeight:b0,getLineHeightFactor:C0,getLineWidth:CA,write:Ge,getHorizontalCoordinate:Zi,getVerticalCoordinate:To,getCoordinateString:tg,getVerticalCoordinateString:Al,collections:{},newObject:Aa,newAdditionalObject:le,newObjectDeferred:ge,newObjectDeferredBegin:H,getFilters:Oe,putStream:Pe,events:Er,scaleFactor:ct,pageSize:{getWidth:function(){return vc(D)},setWidth:function(T){cu(D,T)},getHeight:function(){return dl(D)},setHeight:function(T){Au(D,T)}},encryptionOptions:d,encryption:kn,getEncryptor:$m,output:bA,getNumberOfPages:Km,pages:we,out:ce,f2:U,f3:I,getPageInfo:y0,getPageInfoByObjId:Zt,getCurrentPageInfo:Ym,getPDFVersion:h,Point:SA,Rectangle:ou,Matrix:Dt,hasHotfix:x0},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return vc(D)},set:function(T){cu(D,T)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return dl(D)},set:function(T){Au(D,T)},enumerable:!0,configurable:!0}),wA.call(u,Ye),ut="F1",mc(n,r),Er.publish("initialized"),u}pd.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},pd.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},pd.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},pd.prototype.processOwnerPassword=function(e,t){return zx(Gx(t).substr(0,5),e)},pd.prototype.encryptor=function(e,t){var r=Gx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return zx(r,a)}},Kh.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||ea(e)!==ea(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},Vt.API={events:[]},Vt.version="2.5.2";var _a=Vt.API,My=1,vA=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$A=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ar=function(e){return e.toFixed(2)},Sl=function(e){return e.toFixed(5)};_a.__acroform__={};var ks=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Bw=function(e){return e*My},oo=function(e){var t=new aB,r=Ft.internal.getHeight(e)||0,a=Ft.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ar(a)),Number(ar(r))],t},h9=_a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},m9=_a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},g9=_a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},ja=_a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return g9(e,t-1)},La=_a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return h9(e,t-1)},Ua=_a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return m9(e,t-1)},x9=_a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(n)||0,c.lowerLeft_Y=a(i+l)||0,c.upperRight_X=r(n+o)||0,c.upperRight_Y=a(i)||0,[Number(ar(c.lowerLeft_X)),Number(ar(c.lowerLeft_Y)),Number(ar(c.upperRight_X)),Number(ar(c.upperRight_Y))]},y9=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=Vx(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+ar(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=oo(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Vx=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(I){return I.split(`
`)}):n.map(function(I){return[I]});var i=r,o=Ft.internal.getHeight(e)||0;o=o<0?-o:o;var l=Ft.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(I,R,L){if(I+1<n.length){var N=R+" "+n[I+1][0];return yp(N,e,L).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var A,d,f=yp("3",e,i).height,p=e.multiline?o-i:(o-f)/2,u=p+=2,g=0,h=0,x=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+yp(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",v=0,E=0;E<n.length;E++)if(n.hasOwnProperty(E)){var k=!1;if(n[E].length!==1&&x!==n[E].length-1){if((f+2)*(v+2)+2>o)continue e;y+=n[E][x],k=!0,h=E,E--}else{y=(y+=n[E][x]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var S=parseInt(E),B=c(S,y,i),b=E>=n.length-1;if(B&&!b){y+=" ",x=0;continue}if(B||b){if(b)h=S;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;h=S}}for(var O="",_=g;_<=h;_++){var U=n[_];if(e.multiline){if(_===h){O+=U[x]+" ",x=(x+1)%U.length;continue}if(_===g){O+=U[U.length-1]+" ";continue}}O+=U[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,d=yp(O,e,i).width,e.textAlign){case"right":A=l-d-2;break;case"center":A=(l-d)/2;break;case"left":default:A=2}t+=ar(A)+" "+ar(u)+` Td
`,t+="("+vA(O)+`) Tj
`,t+=-ar(A)+` 0 Td
`,u=-(i+2),d=0,g=k?h:h+1,v++,y=""}break}return a.text=t,a.fontSize=i,a},yp=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},v9={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},w9=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},E9=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),ea(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete e[a]}},b9=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Yi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(v9)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");My=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new nB,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&w9(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var i=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var l=a[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=x9(l.Rect,n)),n.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Ft.createDefaultAppearanceStream(l),ea(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=y9(l);c.push({key:"AP",value:"<</N "+d+">>"}),n.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var p in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(p)){var u=l.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var o in u)if(u.hasOwnProperty(o)){var g=u[o];typeof g=="function"&&(g=g.call(n,l)),f+="/"+o+" "+g+" ",n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g)}}else typeof(g=u)=="function"&&(g=g.call(n,l)),f+="/"+o+" "+g,n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:l.objId}),n.internal.out("endobj")}i&&E9(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},rB=_a.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var n="[",i=0;i<e.length;i++)switch(i!==0&&(n+=" "),ea(e[i])){case"boolean":case"number":case"object":n+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+vA(a(e[i].toString()))+")"):n+=e[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},r1=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+vA(a(e))+")"},fo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};fo.prototype.toString=function(){return this.objId+" 0 R"},fo.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},fo.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:rB(n,this.objId,this.scope)}):n instanceof fo?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var aB=function(){fo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ks(aB,fo);var nB=function(){fo.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+vA(r(e))+")"}},set:function(r){e=r}})};ks(nB,fo);var Yi=function e(){fo.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ja(t,3)},set:function(y){y?this.F=La(t,3):this.F=Ua(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(y){a=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(y){a[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(y){a[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(y){a[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(y){a[3]=y}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Hh)return;i="FieldObject"+e.FieldNum++}var y=function(v){return v};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+vA(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/My:A},set:function(y){A=y}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(y){d=y}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Hh||this instanceof Jc))return r1(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=y}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof mn?p:r1(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=this instanceof mn?y:y.substr(0,1)==="("?$A(y.substr(1,y.length-2)):$A(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?$A(p.substr(1,p.length-1)):p},set:function(y){y=y.toString(),p=this instanceof mn?"/"+y:y}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof mn?u:r1(u,this.objId,this.scope)},set:function(y){y=y.toString(),u=this instanceof mn?y:y.substr(0,1)==="("?$A(y.substr(1,y.length-2)):$A(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?$A(u.substr(1,u.length-1)):u},set:function(y){y=y.toString(),u=this instanceof mn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,h=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return h},set:function(y){y=!!y,h=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(y){g=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,1)},set:function(y){y?this.Ff=La(this.Ff,1):this.Ff=Ua(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,2)},set:function(y){y?this.Ff=La(this.Ff,2):this.Ff=Ua(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,3)},set:function(y){y?this.Ff=La(this.Ff,3):this.Ff=Ua(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');x=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(x){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};ks(Yi,fo);var Nd=function(){Yi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return rB(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=function(i,o,l){l||(l=1);for(var c,A=[];c=o.exec(i);)A.push(c[l]);return A}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,18)},set:function(r){r?this.Ff=La(this.Ff,18):this.Ff=Ua(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=La(this.Ff,19):this.Ff=Ua(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,20)},set:function(r){r?(this.Ff=La(this.Ff,20),t.sort()):this.Ff=Ua(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,22)},set:function(r){r?this.Ff=La(this.Ff,22):this.Ff=Ua(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,23)},set:function(r){r?this.Ff=La(this.Ff,23):this.Ff=Ua(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,27)},set:function(r){r?this.Ff=La(this.Ff,27):this.Ff=Ua(this.Ff,27)}}),this.hasAppearanceStream=!1};ks(Nd,Yi);var Fd=function(){Nd.call(this),this.fontName="helvetica",this.combo=!1};ks(Fd,Nd);var Rd=function(){Fd.call(this),this.combo=!0};ks(Rd,Fd);var ih=function(){Rd.call(this),this.edit=!0};ks(ih,Rd);var mn=function(){Yi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,15)},set:function(r){r?this.Ff=La(this.Ff,15):this.Ff=Ua(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,16)},set:function(r){r?this.Ff=La(this.Ff,16):this.Ff=Ua(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,17)},set:function(r){r?this.Ff=La(this.Ff,17):this.Ff=Ua(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,26)},set:function(r){r?this.Ff=La(this.Ff,26):this.Ff=Ua(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+vA(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){ea(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ks(mn,Yi);var oh=function(){mn.call(this),this.pushButton=!0};ks(oh,mn);var kd=function(){mn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ks(kd,mn);var Hh=function(){var e,t;Yi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+vA(n(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){ea(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ft.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ks(Hh,Yi),kd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},kd.prototype.createOption=function(e){var t=new Hh;return t.Parent=this,t.optionName=e,this.Kids.push(t),_9.call(this.scope,t),t};var lh=function(){mn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ft.CheckBox.createAppearanceStream()};ks(lh,mn);var Jc=function(){Yi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,13)},set:function(t){t?this.Ff=La(this.Ff,13):this.Ff=Ua(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,21)},set:function(t){t?this.Ff=La(this.Ff,21):this.Ff=Ua(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,23)},set:function(t){t?this.Ff=La(this.Ff,23):this.Ff=Ua(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,24)},set:function(t){t?this.Ff=La(this.Ff,24):this.Ff=Ua(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,25)},set:function(t){t?this.Ff=La(this.Ff,25):this.Ff=Ua(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,26)},set:function(t){t?this.Ff=La(this.Ff,26):this.Ff=Ua(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ks(Jc,Yi);var ch=function(){Jc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,14)},set:function(e){e?this.Ff=La(this.Ff,14):this.Ff=Ua(this.Ff,14)}}),this.password=!0};ks(ch,Jc);var Ft={CheckBox:{createAppearanceStream:function(){return{N:{On:Ft.CheckBox.YesNormal},D:{On:Ft.CheckBox.YesPushDown,Off:Ft.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=Vx(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ar(Ft.internal.getWidth(e))+" "+ar(Ft.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+ar(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],i=Ft.internal.getHeight(e),o=Ft.internal.getWidth(e),l=Vx(e,e.caption);return n.push("1 g"),n.push("0 0 "+ar(o)+" "+ar(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+ar(o-1)+" "+ar(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+ar(l.fontSize)+" Tf "+a),n.push(l.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ar(Ft.internal.getWidth(e))+" "+ar(Ft.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Ft.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Ft.RadioButton.Circle.YesNormal,t.D[e]=Ft.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Ft.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Sl(Ft.internal.getWidth(e)/2)+" "+Sl(Ft.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Ft.internal.Bezier_C).toFixed(5)),o=Number((a*Ft.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Sl(Ft.internal.getWidth(e)/2)+" "+Sl(Ft.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Sl(Ft.internal.getWidth(e)/2)+" "+Sl(Ft.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Ft.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Sl(Ft.internal.getWidth(e)/2)+" "+Sl(Ft.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Ft.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Ft.RadioButton.Cross.YesNormal,t.D[e]=Ft.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ar(Ft.internal.getWidth(e)-2)+" "+ar(Ft.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ar(a.x1.x)+" "+ar(a.x1.y)+" m"),r.push(ar(a.x2.x)+" "+ar(a.x2.y)+" l"),r.push(ar(a.x4.x)+" "+ar(a.x4.y)+" m"),r.push(ar(a.x3.x)+" "+ar(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=Ft.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+ar(Ft.internal.getWidth(e))+" "+ar(Ft.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+ar(Ft.internal.getWidth(e)-2)+" "+ar(Ft.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(ar(r.x1.x)+" "+ar(r.x1.y)+" m"),a.push(ar(r.x2.x)+" "+ar(r.x2.y)+" l"),a.push(ar(r.x4.x)+" "+ar(r.x4.y)+" m"),a.push(ar(r.x3.x)+" "+ar(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ar(Ft.internal.getWidth(e))+" "+ar(Ft.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Ft.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Ft.internal.getWidth(e),r=Ft.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Ft.internal.getWidth=function(e){var t=0;return ea(e)==="object"&&(t=Bw(e.Rect[2])),t},Ft.internal.getHeight=function(e){var t=0;return ea(e)==="object"&&(t=Bw(e.Rect[3])),t};var _9=_a.addField=function(e){if(b9(this,e),!(e instanceof Yi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};_a.AcroFormChoiceField=Nd,_a.AcroFormListBox=Fd,_a.AcroFormComboBox=Rd,_a.AcroFormEditBox=ih,_a.AcroFormButton=mn,_a.AcroFormPushButton=oh,_a.AcroFormRadioButton=kd,_a.AcroFormCheckBox=lh,_a.AcroFormTextField=Jc,_a.AcroFormPasswordField=ch,_a.AcroFormAppearance=Ft,_a.AcroForm={ChoiceField:Nd,ListBox:Fd,ComboBox:Rd,EditBox:ih,Button:mn,PushButton:oh,RadioButton:kd,CheckBox:lh,TextField:Jc,PasswordField:ch,Appearance:Ft},Vt.AcroForm={ChoiceField:Nd,ListBox:Fd,ComboBox:Rd,EditBox:ih,Button:mn,PushButton:oh,RadioButton:kd,CheckBox:lh,TextField:Jc,PasswordField:ch,Appearance:Ft};Vt.AcroForm;function sB(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(I,R){var L,N,P,Q,Y,ee=t;if((R=R||t)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(B(I))for(Y in r)for(P=r[Y],L=0;L<P.length;L+=1){for(Q=!0,N=0;N<P[L].length;N+=1)if(P[L][N]!==void 0&&P[L][N]!==I[N]){Q=!1;break}if(Q===!0){ee=Y;break}}else for(Y in r)for(P=r[Y],L=0;L<P.length;L+=1){for(Q=!0,N=0;N<P[L].length;N+=1)if(P[L][N]!==void 0&&P[L][N]!==I.charCodeAt(N)){Q=!1;break}if(Q===!0){ee=Y;break}}return ee===t&&R!==t&&(ee=R),ee},n=function I(R){for(var L=this.internal.write,N=this.internal.putStream,P=(0,this.internal.getFilters)();P.indexOf("FlateEncode")!==-1;)P.splice(P.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var Q=[];if(Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Image"}),Q.push({key:"Width",value:R.width}),Q.push({key:"Height",value:R.height}),R.colorSpace===x.INDEXED?Q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(Q.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===x.DEVICE_CMYK&&Q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Q.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&Q.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var Y="",ee=0,V=R.transparency.length;ee<V;ee++)Y+=R.transparency[ee]+" "+R.transparency[ee]+" ";Q.push({key:"Mask",value:"["+Y+"]"})}R.sMask!==void 0&&Q.push({key:"SMask",value:R.objectId+1+" 0 R"});var G=R.filter!==void 0?["/"+R.filter]:void 0;if(N({data:R.data,additionalKeyValues:Q,alreadyAppliedFilters:G,objectId:R.objectId}),L("endobj"),"sMask"in R&&R.sMask!==void 0){var z="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,C={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:z,data:R.sMask};"filter"in R&&(C.filter=R.filter),I.call(this,C)}if(R.colorSpace===x.INDEXED){var D=this.internal.newObject();N({data:O(new Uint8Array(R.palette)),objectId:D}),L("endobj")}},i=function(){var I=this.internal.collections.addImage_images;for(var R in I)n.call(this,I[R])},o=function(){var I,R=this.internal.collections.addImage_images,L=this.internal.write;for(var N in R)L("/I"+(I=R[N]).index,I.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var I=this.internal.collections.addImage_images;return l.call(this),I},A=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(I){return typeof e["process"+I.toUpperCase()]=="function"},f=function(I){return ea(I)==="object"&&I.nodeType===1},p=function(I,R){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var L=""+I.getAttribute("src");if(L.indexOf("data:image/")===0)return gf(unescape(L).split("base64,").pop());var N=e.loadFile(L,!0);if(N!==void 0)return N}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var P;switch(R){case"PNG":P="image/png";break;case"WEBP":P="image/webp";break;case"JPEG":case"JPG":default:P="image/jpeg"}return gf(I.toDataURL(P,1).split("base64,").pop())}},u=function(I){var R=this.internal.collections.addImage_images;if(R){for(var L in R)if(I===R[L].alias)return R[L]}},g=function(I,R,L){return I||R||(I=-96,R=-96),I<0&&(I=-1*L.width*72/I/this.internal.scaleFactor),R<0&&(R=-1*L.height*72/R/this.internal.scaleFactor),I===0&&(I=R*L.width/L.height),R===0&&(R=I*L.height/L.width),[I,R]},h=function(I,R,L,N,P,Q){var Y=g.call(this,L,N,P),ee=this.internal.getCoordinateString,V=this.internal.getVerticalCoordinateString,G=c.call(this);if(L=Y[0],N=Y[1],G[P.index]=P,Q){Q*=Math.PI/180;var z=Math.cos(Q),C=Math.sin(Q),D=function(K){return K.toFixed(4)},j=[D(z),D(C),D(-1*C),D(z),0,0,"cm"]}this.internal.write("q"),Q?(this.internal.write([1,"0","0",1,ee(I),V(R+N),"cm"].join(" ")),this.internal.write(j.join(" ")),this.internal.write([ee(L),"0","0",ee(N),"0","0","cm"].join(" "))):this.internal.write([ee(L),"0","0",ee(N),ee(I),V(R+N),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+P.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(I){var R,L,N=0;if(typeof I=="string")for(L=I.length,R=0;R<L;R++)N=(N<<5)-N+I.charCodeAt(R),N|=0;else if(B(I))for(L=I.byteLength/2,R=0;R<L;R++)N=(N<<5)-N+I[R],N|=0;return N},E=e.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var R=!0;return I.length===0&&(R=!1),I.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(R=!1),R},k=e.__addimage__.extractImageFromDataUrl=function(I){var R=(I=I||"").split("base64,"),L=null;if(R.length===2){var N=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(R[0]);Array.isArray(N)&&(L={mimeType:N[1],charset:N[2],data:R[1]})}return L},S=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(I){return S()&&I instanceof ArrayBuffer};var B=e.__addimage__.isArrayBufferView=function(I){return S()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},b=e.__addimage__.binaryStringToUint8Array=function(I){for(var R=I.length,L=new Uint8Array(R),N=0;N<R;N++)L[N]=I.charCodeAt(N);return L},O=e.__addimage__.arrayBufferToBinaryString=function(I){for(var R="",L=B(I)?I:new Uint8Array(I),N=0;N<L.length;N+=8192)R+=String.fromCharCode.apply(null,L.subarray(N,N+8192));return R};e.addImage=function(){var I,R,L,N,P,Q,Y,ee,V;if(typeof arguments[1]=="number"?(R=t,L=arguments[1],N=arguments[2],P=arguments[3],Q=arguments[4],Y=arguments[5],ee=arguments[6],V=arguments[7]):(R=arguments[1],L=arguments[2],N=arguments[3],P=arguments[4],Q=arguments[5],Y=arguments[6],ee=arguments[7],V=arguments[8]),ea(I=arguments[0])==="object"&&!f(I)&&"imageData"in I){var G=I;I=G.imageData,R=G.format||R||t,L=G.x||L||0,N=G.y||N||0,P=G.w||G.width||P,Q=G.h||G.height||Q,Y=G.alias||Y,ee=G.compression||ee,V=G.rotation||G.angle||V}var z=this.internal.getFilters();if(ee===void 0&&z.indexOf("FlateEncode")!==-1&&(ee="SLOW"),isNaN(L)||isNaN(N))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var C=_.call(this,I,R,Y,ee);return h.call(this,L,N,P,Q,C,V),this};var _=function(I,R,L,N){var P,Q,Y;if(typeof I=="string"&&a(I)===t){I=unescape(I);var ee=U(I,!1);(ee!==""||(ee=e.loadFile(I,!0))!==void 0)&&(I=ee)}if(f(I)&&(I=p(I,R)),R=a(I,R),!d(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((Y=L)==null||Y.length===0)&&(L=function(V){return typeof V=="string"||B(V)?v(V):B(V.data)?v(V.data):null}(I)),(P=u.call(this,L))||(S()&&(I instanceof Uint8Array||R==="RGBA"||(Q=I,I=b(I))),P=this["process"+R.toUpperCase()](I,A.call(this),L,function(V){return V&&typeof V=="string"&&(V=V.toUpperCase()),V in e.image_compression?V:y.NONE}(N),Q)),!P)throw new Error("An unknown error occurred whilst processing the image.");return P},U=e.__addimage__.convertBase64ToBinaryString=function(I,R){var L;R=typeof R!="boolean"||R;var N,P="";if(typeof I=="string"){N=(L=k(I))!==null?L.data:I;try{P=gf(N)}catch(Q){if(R)throw E(N)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return P};e.getImageProperties=function(I){var R,L,N="";if(f(I)&&(I=p(I)),typeof I=="string"&&a(I)===t&&((N=U(I,!1))===""&&(N=e.loadFile(I)||""),I=N),L=a(I),!d(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(!S()||I instanceof Uint8Array||(I=b(I)),!(R=this["process"+L.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=L,R}})(Vt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Vt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,d=!1,f=0;f<A.length&&!d;f++)switch((a=A[f]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<A.length;p++){a=A[p];var u=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var h=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(h.objId),v=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y)+"] ")+"/Contents ("+u(y(a.contents))+")",i+=" /Popup "+x.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+u(y(v))+") >>",h.content=i;var E=h.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+l(a.bounds.y)+"] ")+" /Parent "+E,a.open&&(i+=" /Open true"),i+=" >>",x.content=i,this.internal.write(h.objId,"0 R",x.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y+a.bounds.h)+"] ";var k=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+u(g(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var S=this.annotations._nameMap[a.options.name];a.options.pageNumber=S.page,a.options.top=S.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+u(g(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var B=l(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+B+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(a),w:c(r+n),h:A(a+i)},options:o,type:"link"})},e.textWithLink=function(r,a,n,i){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(A*d)}else l=c,o=A;return this.text(r,a,n,i),n+=.2*A,i.align==="center"&&(a-=c/2),i.align==="right"&&(a-=c),this.link(a,n-A,l,o,i),c},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(Vt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(h){return t[h.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(h){return typeof h=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(h)},l=e.__arabicParser__.isArabicEndLetter=function(h){return o(h)&&i(h)&&t[h.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(h){return o(h)&&n.indexOf(h.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(h){return o(h)&&i(h)&&t[h.charCodeAt(0)].length>=1};var A=e.__arabicParser__.arabicLetterHasFinalForm=function(h){return o(h)&&i(h)&&t[h.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(h){return o(h)&&i(h)&&t[h.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(h){return o(h)&&i(h)&&t[h.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(h){var x=0,y=r,v="",E=0;for(x=0;x<h.length;x+=1)y[h.charCodeAt(x)]!==void 0?(E++,typeof(y=y[h.charCodeAt(x)])=="number"&&(v+=String.fromCharCode(y),y=r,E=0),x===h.length-1&&(y=r,v+=h.charAt(x-(E-1)),x-=E-1,E=0)):(y=r,v+=h.charAt(x-E),x-=E,E=0);return v};e.__arabicParser__.isArabicDiacritic=function(h){return h!==void 0&&a[h.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(h,x,y){return o(h)?i(h)===!1?-1:!A(h)||!o(x)&&!o(y)||!o(y)&&l(x)||l(h)&&!o(x)||l(h)&&c(x)||l(h)&&l(x)?0:d(h)&&o(x)&&!l(x)&&o(y)&&A(y)?3:l(h)||!o(y)?1:2:-1},u=function(h){var x=0,y=0,v=0,E="",k="",S="",B=(h=h||"").split("\\s+"),b=[];for(x=0;x<B.length;x+=1){for(b.push(""),y=0;y<B[x].length;y+=1)E=B[x][y],k=B[x][y-1],S=B[x][y+1],o(E)?(v=p(E,k,S),b[x]+=v!==-1?String.fromCharCode(t[E.charCodeAt(0)][v]):E):b[x]+=E;b[x]=f(b[x])}return b.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var h,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(x)){var v=0;for(y=[],v=0;v<x.length;v+=1)Array.isArray(x[v])?y.push([u(x[v][0]),x[v][1],x[v][2]]):y.push([u(x[v])]);h=y}else h=u(x);return typeof arguments[0]=="string"?h:(arguments[0].text=h,arguments[0])};e.events.push(["preProcessText",g])}(Vt.API),Vt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Vt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(h){c=h}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(h){A=h}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(h){d=h}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(h){f=h}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(h){p=h}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(h){u=h}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(h){g=h}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,A){a.call(this);var d=(A=A||{}).fontSize||this.getFontSize(),f=A.font||this.getFont(),p=A.scaleFactor||this.internal.scaleFactor,u=0,g=0,h=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=A.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(E,k){return E.concat(x.splitTextToSize(k,y))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)u<(h=this.getStringUnitWidth(c[v],{font:f})*d)&&(u=h);return u!==0&&(g=c.length),{w:u/=p,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var A=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,u&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,A,d,f,p){if(a.call(this),!d)throw new Error("No data for PDF table.");var u,g,h,x,y=[],v=[],E=[],k={},S={},B=[],b=[],O=(p=p||{}).autoSize||!1,_=p.printHeaders!==!1,U=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,I=p.margins||Object.assign({width:this.getPageWidth()},t),R=typeof p.padding=="number"?p.padding:3,L=p.headerBackgroundColor||"#c8c8c8",N=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=_,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=N,this.setFontSize(U),f==null)v=y=Object.keys(d[0]),E=y.map(function(){return"left"});else if(Array.isArray(f)&&ea(f[0])==="object")for(y=f.map(function(G){return G.name}),v=f.map(function(G){return G.prompt||G.name||""}),E=f.map(function(G){return G.align||"left"}),u=0;u<f.length;u+=1)S[f[u].name]=f[u].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(v=y=f,E=y.map(function(){return"left"}));if(O||Array.isArray(f)&&typeof f[0]=="string")for(u=0;u<y.length;u+=1){for(k[x=y[u]]=d.map(function(G){return G[x]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(v[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=k[x],this.setFont(void 0,"normal"),h=0;h<g.length;h+=1)B.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);S[x]=Math.max.apply(null,B)+R+R,B=[]}if(_){var P={};for(u=0;u<y.length;u+=1)P[y[u]]={},P[y[u]].text=v[u],P[y[u]].align=E[u];var Q=l.call(this,P,S);b=y.map(function(G){return new i(c,A,S[G],Q,P[G].text,void 0,P[G].align)}),this.setTableHeaderRow(b),this.printHeaderRow(1,!1)}var Y=f.reduce(function(G,z){return G[z.name]=z.align,G},{});for(u=0;u<d.length;u+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:u,data:d[u]},this);var ee=l.call(this,d[u],S);for(h=0;h<y.length;h+=1){var V=d[u][y[h]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:u,col:h,data:V},this),o.call(this,new i(c,A,S[y[h]],ee,V,u+2,Y[y[h]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(u){var g=c[u];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,A[u]-d-d)},this).map(function(u){return this.getLineHeightFactor()*u.length*f/p+d+d},this).reduce(function(u,g){return Math.max(u,g)},0)};e.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,A){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){d=this.internal.__cell__.tableHeaderRow[u].clone(),A&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(Vt.API);var iB={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},oB=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],$x=sB(oB),lB=[100,200,300,400,500,600,700,800,900],C9=sB(lB);function Yx(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return iB[i=i||"normal"]?i:"normal"}(e.style),a=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),n=function(i){return typeof $x[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function Sw(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var B9={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Tw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ow(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function S9(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},B9,r.genericFontFamilies||{}),i=null,o=null,l=0;l<t.length;++l)if(n[(i=Yx(t[l])).family]&&(i.family=n[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[a]))throw new Error("Could not find a font-family for the rule '"+Ow(i)+"' and default family '"+a+"'.");if(o=function(c,A){if(A[c])return A[c];var d=$x[c],f=d<=$x.normal?-1:1,p=Sw(A,oB,d,f);if(!p)throw new Error("Could not find a matching font-stretch value for "+c);return p}(i.stretch,o),o=function(c,A){if(A[c])return A[c];for(var d=iB[c],f=0;f<d.length;++f)if(A[d[f]])return A[d[f]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,A){if(A[c])return A[c];if(c===400&&A[500])return A[500];if(c===500&&A[400])return A[400];var d=C9[c],f=Sw(A,lB,d,c<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+c);return f}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Ow(i)+"'.");return o}function Iw(e){return e.trimLeft()}function T9(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function O9(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var vp,Nw,Fw,a1=["times"];(function(e){var t,r,a,n,i,o,l,c,A,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=C;Object.defineProperty(this,"pdf",{get:function(){return D}});var j=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return j},set:function(pe){j=!!pe}});var K=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return K},set:function(pe){K=!!pe}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(pe){isNaN(pe)||(W=pe)}});var Ae=0;Object.defineProperty(this,"posY",{get:function(){return Ae},set:function(pe){isNaN(pe)||(Ae=pe)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(pe){var ce;typeof pe=="number"?ce=[pe,pe,pe,pe]:((ce=new Array(4))[0]=pe[0],ce[1]=pe.length>=2?pe[1]:ce[0],ce[2]=pe.length>=3?pe[2]:ce[0],ce[3]=pe.length>=4?pe[3]:ce[1]),A.margin=ce}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(pe){ue=pe}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(pe){he=pe}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(pe){ve=pe}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(pe){pe instanceof d&&(A=pe)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(pe){A.path=pe}});var we=[];Object.defineProperty(this,"ctxStack",{get:function(){return we},set:function(pe){we=pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(pe){var ce;ce=p(pe),this.ctx.fillStyle=ce.style,this.ctx.isFillTransparent=ce.a===0,this.ctx.fillOpacity=ce.a,this.pdf.setFillColor(ce.r,ce.g,ce.b,{a:ce.a}),this.pdf.setTextColor(ce.r,ce.g,ce.b,{a:ce.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(pe){var ce=p(pe);this.ctx.strokeStyle=ce.style,this.ctx.isStrokeTransparent=ce.a===0,this.ctx.strokeOpacity=ce.a,ce.a===0?this.pdf.setDrawColor(255,255,255):(ce.a,this.pdf.setDrawColor(ce.r,ce.g,ce.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(pe){["butt","round","square"].indexOf(pe)!==-1&&(this.ctx.lineCap=pe,this.pdf.setLineCap(pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(pe){isNaN(pe)||(this.ctx.lineWidth=pe,this.pdf.setLineWidth(pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(pe){["bevel","round","miter"].indexOf(pe)!==-1&&(this.ctx.lineJoin=pe,this.pdf.setLineJoin(pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(pe){isNaN(pe)||(this.ctx.miterLimit=pe,this.pdf.setMiterLimit(pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(pe){this.ctx.textBaseline=pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(pe){["right","end","center","left","start"].indexOf(pe)!==-1&&(this.ctx.textAlign=pe)}});var se=null;function He(pe,ce){if(se===null){var Ge=function(et){var Ye=[];return Object.keys(et).forEach(function(tt){et[tt].forEach(function(je){var _e=null;switch(je){case"bold":_e={family:tt,weight:"bold"};break;case"italic":_e={family:tt,style:"italic"};break;case"bolditalic":_e={family:tt,weight:"bold",style:"italic"};break;case"":case"normal":_e={family:tt}}_e!==null&&(_e.ref={name:tt,style:je},Ye.push(_e))})}),Ye}(pe.getFontList());se=function(et){for(var Ye={},tt=0;tt<et.length;++tt){var je=Yx(et[tt]),_e=je.family,At=je.stretch,Ct=je.style,_t=je.weight;Ye[_e]=Ye[_e]||{},Ye[_e][At]=Ye[_e][At]||{},Ye[_e][At][Ct]=Ye[_e][At][Ct]||{},Ye[_e][At][Ct][_t]=je}return Ye}(Ge.concat(ce))}return se}var Ee=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ee},set:function(pe){se=null,Ee=pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(pe){var ce;if(this.ctx.font=pe,(ce=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(pe))!==null){var Ge=ce[1],et=(ce[2],ce[3]),Ye=ce[4],tt=(ce[5],ce[6]),je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ye)[2];Ye=Math.floor(je==="px"?parseFloat(Ye)*this.pdf.internal.scaleFactor:je==="em"?parseFloat(Ye)*this.pdf.getFontSize():parseFloat(Ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ye);var _e=function(Bt){var ut,ct,wr=[],Rt=Bt.trim();if(Rt==="")return a1;if(Rt in Tw)return[Tw[Rt]];for(;Rt!=="";){switch(ct=null,ut=(Rt=Iw(Rt)).charAt(0)){case'"':case"'":ct=T9(Rt.substring(1),ut);break;default:ct=O9(Rt)}if(ct===null||(wr.push(ct[0]),(Rt=Iw(ct[1]))!==""&&Rt.charAt(0)!==","))return a1;Rt=Rt.replace(/^,/,"")}return wr}(tt);if(this.fontFaces){var At=S9(He(this.pdf,this.fontFaces),_e.map(function(Bt){return{family:Bt,stretch:"normal",weight:et,style:Ge}}));this.pdf.setFont(At.ref.name,At.ref.style)}else{var Ct="";(et==="bold"||parseInt(et,10)>=700||Ge==="bold")&&(Ct="bold"),Ge==="italic"&&(Ct+="italic"),Ct.length===0&&(Ct="normal");for(var _t="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Pt=0;Pt<_e.length;Pt++){if(this.pdf.internal.getFont(_e[Pt],Ct,{noFallback:!0,disableWarning:!0})!==void 0){_t=_e[Pt];break}if(Ct==="bolditalic"&&this.pdf.internal.getFont(_e[Pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_t=_e[Pt],Ct="bold";else if(this.pdf.internal.getFont(_e[Pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_t=_e[Pt],Ct="normal";break}}if(_t===""){for(var Lt=0;Lt<_e.length;Lt++)if(Et[_e[Lt]]){_t=Et[_e[Lt]];break}}_t=_t===""?"Times":_t,this.pdf.setFont(_t,Ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(pe){this.ctx.globalCompositeOperation=pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(pe){this.ctx.globalAlpha=pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(pe){this.ctx.lineDashOffset=pe,z.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(pe){this.ctx.lineDash=pe,z.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(pe){this.ctx.ignoreClearRect=!!pe}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){k.call(this,"fill",!1)},f.prototype.stroke=function(){k.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,D){if(isNaN(C)||isNaN(D))throw Xr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var j=this.ctx.transform.applyToPoint(new o(C,D));this.path.push({type:"mt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(C,D)},f.prototype.closePath=function(){var C=new o(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&ea(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){C=new o(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},f.prototype.lineTo=function(C,D){if(isNaN(C)||isNaN(D))throw Xr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var j=this.ctx.transform.applyToPoint(new o(C,D));this.path.push({type:"lt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(j.x,j.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,D,j,K){if(isNaN(j)||isNaN(K)||isNaN(C)||isNaN(D))throw Xr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new o(j,K)),Ae=this.ctx.transform.applyToPoint(new o(C,D));this.path.push({type:"qct",x1:Ae.x,y1:Ae.y,x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},f.prototype.bezierCurveTo=function(C,D,j,K,W,Ae){if(isNaN(W)||isNaN(Ae)||isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K))throw Xr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new o(W,Ae)),he=this.ctx.transform.applyToPoint(new o(C,D)),ve=this.ctx.transform.applyToPoint(new o(j,K));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:ve.x,y2:ve.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new o(ue.x,ue.y)},f.prototype.arc=function(C,D,j,K,W,Ae){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K)||isNaN(W))throw Xr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ae=!!Ae,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new o(C,D));C=ue.x,D=ue.y;var he=this.ctx.transform.applyToPoint(new o(0,j)),ve=this.ctx.transform.applyToPoint(new o(0,0));j=Math.sqrt(Math.pow(he.x-ve.x,2)+Math.pow(he.y-ve.y,2))}Math.abs(W-K)>=2*Math.PI&&(K=0,W=2*Math.PI),this.path.push({type:"arc",x:C,y:D,radius:j,startAngle:K,endAngle:W,counterclockwise:Ae})},f.prototype.arcTo=function(C,D,j,K,W){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,D,j,K){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K))throw Xr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,D),this.lineTo(C+j,D),this.lineTo(C+j,D+K),this.lineTo(C,D+K),this.lineTo(C,D),this.lineTo(C+j,D),this.lineTo(C,D)},f.prototype.fillRect=function(C,D,j,K){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K))throw Xr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,D,j,K),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},f.prototype.strokeRect=function(C,D,j,K){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K))throw Xr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(C,D,j,K),this.stroke())},f.prototype.clearRect=function(C,D,j,K){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K))throw Xr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,D,j,K))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var K=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=K}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("Q");this.pdf.setPage(D),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(C){var D,j,K,W;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))D=0,j=0,K=0,W=0;else{var Ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(Ae!==null)D=parseInt(Ae[1]),j=parseInt(Ae[2]),K=parseInt(Ae[3]),W=1;else if((Ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)D=parseInt(Ae[1]),j=parseInt(Ae[2]),K=parseInt(Ae[3]),W=parseFloat(Ae[4]);else{if(W=1,typeof C=="string"&&C.charAt(0)!=="#"){var ue=new ZC(C);C=ue.ok?ue.toHex():"#000000"}C.length===4?(D=C.substring(1,2),D+=D,j=C.substring(2,3),j+=j,K=C.substring(3,4),K+=K):(D=C.substring(1,3),j=C.substring(3,5),K=C.substring(5,7)),D=parseInt(D,16),j=parseInt(j,16),K=parseInt(K,16)}}return{r:D,g:j,b:K,a:W,style:C}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,D,j,K){if(isNaN(D)||isNaN(j)||typeof C!="string")throw Xr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(K=isNaN(K)?void 0:K,!u.call(this)){var W=ee(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;R.call(this,{text:C,x:D,y:j,scale:Ae,angle:W,align:this.textAlign,maxWidth:K})}},f.prototype.strokeText=function(C,D,j,K){if(isNaN(D)||isNaN(j)||typeof C!="string")throw Xr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){K=isNaN(K)?void 0:K;var W=ee(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;R.call(this,{text:C,x:D,y:j,scale:Ae,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:K})}},f.prototype.measureText=function(C){if(typeof C!="string")throw Xr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,j=this.pdf.internal.scaleFactor,K=D.internal.getFontSize(),W=D.getStringUnitWidth(C)*K/D.internal.scaleFactor,Ae=function(ue){var he=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this};return new Ae({width:W*=Math.round(96*j/72*1e4)/1e4})},f.prototype.scale=function(C,D){if(isNaN(C)||isNaN(D))throw Xr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var j=new c(C,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(j)},f.prototype.rotate=function(C){if(isNaN(C))throw Xr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.translate=function(C,D){if(isNaN(C)||isNaN(D))throw Xr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var j=new c(1,0,0,1,C,D);this.ctx.transform=this.ctx.transform.multiply(j)},f.prototype.transform=function(C,D,j,K,W,Ae){if(isNaN(C)||isNaN(D)||isNaN(j)||isNaN(K)||isNaN(W)||isNaN(Ae))throw Xr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new c(C,D,j,K,W,Ae);this.ctx.transform=this.ctx.transform.multiply(ue)},f.prototype.setTransform=function(C,D,j,K,W,Ae){C=isNaN(C)?1:C,D=isNaN(D)?0:D,j=isNaN(j)?0:j,K=isNaN(K)?1:K,W=isNaN(W)?0:W,Ae=isNaN(Ae)?0:Ae,this.ctx.transform=new c(C,D,j,K,W,Ae)};var h=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,D,j,K,W,Ae,ue,he,ve){var we=this.pdf.getImageProperties(C),se=1,He=1,Ee=1,pe=1;K!==void 0&&he!==void 0&&(Ee=he/K,pe=ve/W,se=we.width/K*he/K,He=we.height/W*ve/W),Ae===void 0&&(Ae=D,ue=j,D=0,j=0),K!==void 0&&he===void 0&&(he=K,ve=W),K===void 0&&he===void 0&&(he=we.width,ve=we.height);for(var ce,Ge=this.ctx.transform.decompose(),et=ee(Ge.rotate.shx),Ye=new c,tt=(Ye=(Ye=(Ye=Ye.multiply(Ge.translate)).multiply(Ge.skew)).multiply(Ge.scale)).applyToRectangle(new l(Ae-D*Ee,ue-j*pe,K*se,W*He)),je=x.call(this,tt),_e=[],At=0;At<je.length;At+=1)_e.indexOf(je[At])===-1&&_e.push(je[At]);if(E(_e),this.autoPaging)for(var Ct=_e[0],_t=_e[_e.length-1],Et=Ct;Et<_t+1;Et++){this.pdf.setPage(Et);var Pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=Et===1?this.posY+this.margin[0]:this.margin[0],Bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ct=Et===1?0:Bt+(Et-2)*ut;if(this.ctx.clip_path.length!==0){var wr=this.path;ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ce,this.posX+this.margin[3],-ct+Lt+this.ctx.prevPageLastElemOffset),S.call(this,"fill",!0),this.path=wr}var Rt=JSON.parse(JSON.stringify(tt));Rt=v([Rt],this.posX+this.margin[3],-ct+Lt+this.ctx.prevPageLastElemOffset)[0];var $r=(Et>Ct||Et<_t)&&h.call(this);$r&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,ut,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,et),$r&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,et)};var x=function(C,D,j){var K=[];D=D||this.pdf.internal.pageSize.width,j=j||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":K.push(Math.floor((C.y+W)/j)+1);break;case"arc":K.push(Math.floor((C.y+W-C.radius)/j)+1),K.push(Math.floor((C.y+W+C.radius)/j)+1);break;case"qct":var Ae=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);K.push(Math.floor((Ae.y+W)/j)+1),K.push(Math.floor((Ae.y+Ae.h+W)/j)+1);break;case"bct":var ue=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);K.push(Math.floor((ue.y+W)/j)+1),K.push(Math.floor((ue.y+ue.h+W)/j)+1);break;case"rect":K.push(Math.floor((C.y+W)/j)+1),K.push(Math.floor((C.y+C.h+W)/j)+1)}for(var he=0;he<K.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<K[he];)y.call(this);return K},y=function(){var C=this.fillStyle,D=this.strokeStyle,j=this.font,K=this.lineCap,W=this.lineWidth,Ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=D,this.font=j,this.lineCap=K,this.lineWidth=W,this.lineJoin=Ae},v=function(C,D,j){for(var K=0;K<C.length;K++)switch(C[K].type){case"bct":C[K].x2+=D,C[K].y2+=j;case"qct":C[K].x1+=D,C[K].y1+=j;case"mt":case"lt":case"arc":default:C[K].x+=D,C[K].y+=j}return C},E=function(C){return C.sort(function(D,j){return D-j})},k=function(C,D){for(var j,K,W=this.fillStyle,Ae=this.strokeStyle,ue=this.lineCap,he=this.lineWidth,ve=Math.abs(he*this.ctx.transform.scaleX),we=this.lineJoin,se=JSON.parse(JSON.stringify(this.path)),He=JSON.parse(JSON.stringify(this.path)),Ee=[],pe=0;pe<He.length;pe++)if(He[pe].x!==void 0)for(var ce=x.call(this,He[pe]),Ge=0;Ge<ce.length;Ge+=1)Ee.indexOf(ce[Ge])===-1&&Ee.push(ce[Ge]);for(var et=0;et<Ee.length;et++)for(;this.pdf.internal.getNumberOfPages()<Ee[et];)y.call(this);if(E(Ee),this.autoPaging)for(var Ye=Ee[0],tt=Ee[Ee.length-1],je=Ye;je<tt+1;je++){this.pdf.setPage(je),this.fillStyle=W,this.strokeStyle=Ae,this.lineCap=ue,this.lineWidth=ve,this.lineJoin=we;var _e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],At=je===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=je===1?0:Ct+(je-2)*_t;if(this.ctx.clip_path.length!==0){var Pt=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(j,this.posX+this.margin[3],-Et+At+this.ctx.prevPageLastElemOffset),S.call(this,C,!0),this.path=Pt}if(K=JSON.parse(JSON.stringify(se)),this.path=v(K,this.posX+this.margin[3],-Et+At+this.ctx.prevPageLastElemOffset),D===!1||je===0){var Lt=(je>Ye||je<tt)&&h.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_e,_t,null).clip().discardPath()),S.call(this,C,D),Lt&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=ve,S.call(this,C,D),this.lineWidth=he;this.path=se},S=function(C,D){if((C!=="stroke"||D||!g.call(this))&&(C==="stroke"||D||!u.call(this))){for(var j,K,W=[],Ae=this.path,ue=0;ue<Ae.length;ue++){var he=Ae[ue];switch(he.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:he,deltas:[],abs:[]});break;case"lt":var ve=W.length;if(Ae[ue-1]&&!isNaN(Ae[ue-1].x)&&(j=[he.x-Ae[ue-1].x,he.y-Ae[ue-1].y],ve>0)){for(;ve>=0;ve--)if(W[ve-1].close!==!0&&W[ve-1].begin!==!0){W[ve-1].deltas.push(j),W[ve-1].abs.push(he);break}}break;case"bct":j=[he.x1-Ae[ue-1].x,he.y1-Ae[ue-1].y,he.x2-Ae[ue-1].x,he.y2-Ae[ue-1].y,he.x-Ae[ue-1].x,he.y-Ae[ue-1].y],W[W.length-1].deltas.push(j);break;case"qct":var we=Ae[ue-1].x+2/3*(he.x1-Ae[ue-1].x),se=Ae[ue-1].y+2/3*(he.y1-Ae[ue-1].y),He=he.x+2/3*(he.x1-he.x),Ee=he.y+2/3*(he.y1-he.y),pe=he.x,ce=he.y;j=[we-Ae[ue-1].x,se-Ae[ue-1].y,He-Ae[ue-1].x,Ee-Ae[ue-1].y,pe-Ae[ue-1].x,ce-Ae[ue-1].y],W[W.length-1].deltas.push(j);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(he)}}K=D?null:C==="stroke"?"stroke":"fill";for(var Ge=!1,et=0;et<W.length;et++)if(W[et].arc)for(var Ye=W[et].abs,tt=0;tt<Ye.length;tt++){var je=Ye[tt];je.type==="arc"?O.call(this,je.x,je.y,je.radius,je.startAngle,je.endAngle,je.counterclockwise,void 0,D,!Ge):L.call(this,je.x,je.y),Ge=!0}else if(W[et].close===!0)this.pdf.internal.out("h"),Ge=!1;else if(W[et].begin!==!0){var _e=W[et].start.x,At=W[et].start.y;N.call(this,W[et].deltas,_e,At),Ge=!0}K&&_.call(this,K),D&&U.call(this)}},B=function(C){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,j=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-j;case"top":return C+D-j;case"hanging":return C+D-2*j;case"middle":return C+D/2-j;case"ideographic":return C;case"alphabetic":default:return C}},b=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(D,j){this.colorStops.push([D,j])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(C,D,j,K,W,Ae,ue,he,ve){for(var we=Q.call(this,j,K,W,Ae),se=0;se<we.length;se++){var He=we[se];se===0&&(ve?I.call(this,He.x1+C,He.y1+D):L.call(this,He.x1+C,He.y1+D)),P.call(this,C,D,He.x2,He.y2,He.x3,He.y3,He.x4,He.y4)}he?U.call(this):_.call(this,ue)},_=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(C,D){this.pdf.internal.out(r(C)+" "+a(D)+" m")},R=function(C){var D;switch(C.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var j=this.pdf.getTextDimensions(C.text),K=B.call(this,C.y),W=b.call(this,K)-j.h,Ae=this.ctx.transform.applyToPoint(new o(C.x,K)),ue=this.ctx.transform.decompose(),he=new c;he=(he=(he=he.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var ve,we,se,He=this.ctx.transform.applyToRectangle(new l(C.x,K,j.w,j.h)),Ee=he.applyToRectangle(new l(C.x,W,j.w,j.h)),pe=x.call(this,Ee),ce=[],Ge=0;Ge<pe.length;Ge+=1)ce.indexOf(pe[Ge])===-1&&ce.push(pe[Ge]);if(E(ce),this.autoPaging)for(var et=ce[0],Ye=ce[ce.length-1],tt=et;tt<Ye+1;tt++){this.pdf.setPage(tt);var je=tt===1?this.posY+this.margin[0]:this.margin[0],_e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[2],Ct=At-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],Et=_t-this.margin[3],Pt=tt===1?0:_e+(tt-2)*Ct;if(this.ctx.clip_path.length!==0){var Lt=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ve,this.posX+this.margin[3],-1*Pt+je),S.call(this,"fill",!0),this.path=Lt}var Bt=v([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-Pt+je+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*C.scale),se=this.lineWidth,this.lineWidth=se*C.scale);var ut=this.autoPaging!=="text";if(ut||Bt.y+Bt.h<=At){if(ut||Bt.y>=je&&Bt.x<=_t){var ct=ut?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||_t-Bt.x)[0],wr=v([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-Pt+je+this.ctx.prevPageLastElemOffset)[0],Rt=ut&&(tt>et||tt<Ye)&&h.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Ct,null).clip().discardPath()),this.pdf.text(ct,wr.x,wr.y,{angle:C.angle,align:D,renderingMode:C.renderingMode}),Rt&&this.pdf.restoreGraphicsState()}}else Bt.y<At&&(this.ctx.prevPageLastElemOffset+=At-Bt.y);C.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=se)}else C.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*C.scale),se=this.lineWidth,this.lineWidth=se*C.scale),this.pdf.text(C.text,Ae.x+this.posX,Ae.y+this.posY,{angle:C.angle,align:D,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=se)},L=function(C,D,j,K){j=j||0,K=K||0,this.pdf.internal.out(r(C+j)+" "+a(D+K)+" l")},N=function(C,D,j){return this.pdf.lines(C,D,j,null,null)},P=function(C,D,j,K,W,Ae,ue,he){this.pdf.internal.out([t(n(j+C)),t(i(K+D)),t(n(W+C)),t(i(Ae+D)),t(n(ue+C)),t(i(he+D)),"c"].join(" "))},Q=function(C,D,j,K){for(var W=2*Math.PI,Ae=Math.PI/2;D>j;)D-=W;var ue=Math.abs(j-D);ue<W&&K&&(ue=W-ue);for(var he=[],ve=K?-1:1,we=D;ue>1e-5;){var se=we+ve*Math.min(ue,Ae);he.push(Y.call(this,C,we,se)),ue-=Math.abs(se-we),we=se}return he},Y=function(C,D,j){var K=(j-D)/2,W=C*Math.cos(K),Ae=C*Math.sin(K),ue=W,he=-Ae,ve=ue*ue+he*he,we=ve+ue*W+he*Ae,se=4/3*(Math.sqrt(2*ve*we)-we)/(ue*Ae-he*W),He=ue-se*he,Ee=he+se*ue,pe=He,ce=-Ee,Ge=K+D,et=Math.cos(Ge),Ye=Math.sin(Ge);return{x1:C*Math.cos(D),y1:C*Math.sin(D),x2:He*et-Ee*Ye,y2:He*Ye+Ee*et,x3:pe*et-ce*Ye,y3:pe*Ye+ce*et,x4:C*Math.cos(j),y4:C*Math.sin(j)}},ee=function(C){return 180*C/Math.PI},V=function(C,D,j,K,W,Ae){var ue=C+.5*(j-C),he=D+.5*(K-D),ve=W+.5*(j-W),we=Ae+.5*(K-Ae),se=Math.min(C,W,ue,ve),He=Math.max(C,W,ue,ve),Ee=Math.min(D,Ae,he,we),pe=Math.max(D,Ae,he,we);return new l(se,Ee,He-se,pe-Ee)},G=function(C,D,j,K,W,Ae,ue,he){var ve,we,se,He,Ee,pe,ce,Ge,et,Ye,tt,je,_e,At,Ct=j-C,_t=K-D,Et=W-j,Pt=Ae-K,Lt=ue-W,Bt=he-Ae;for(we=0;we<41;we++)et=(ce=(se=C+(ve=we/40)*Ct)+ve*((Ee=j+ve*Et)-se))+ve*(Ee+ve*(W+ve*Lt-Ee)-ce),Ye=(Ge=(He=D+ve*_t)+ve*((pe=K+ve*Pt)-He))+ve*(pe+ve*(Ae+ve*Bt-pe)-Ge),we==0?(tt=et,je=Ye,_e=et,At=Ye):(tt=Math.min(tt,et),je=Math.min(je,Ye),_e=Math.max(_e,et),At=Math.max(At,Ye));return new l(Math.round(tt),Math.round(je),Math.round(_e-tt),Math.round(At-je))},z=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,D,j=(C=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:D}));this.prevLineDash!==j&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=j)}}})(Vt.API),function(e){var t=function(i){var o,l,c,A,d,f,p,u,g,h;for(l=[],c=0,A=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;A>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(f=(d=((d=((d=((d=(d-(h=d%85))/85)-(g=d%85))/85)-(u=d%85))/85)-(p=d%85))/85)%85,l.push(f+33,p+33,u+33,g+33,h+33)):l.push(122);return function(x,y){for(var v=y;v>0;v--)x.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,c,A,d,f=String,p="length",u=255,g="charCodeAt",h="slice",x="replace";for(i[h](-2),i=i[h](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],A=0,d=(i+=o="uuuuu"[h](i[p]%5||5))[p];d>A;A+=5)l=52200625*(i[g](A)-33)+614125*(i[g](A+1)-33)+7225*(i[g](A+2)-33)+85*(i[g](A+3)-33)+(i[g](A+4)-33),c.push(u&l>>24,u&l>>16,u&l>>8,u&l);return function(y,v){for(var E=v;E>0;E--)y.pop()}(c,o[p]),f.fromCharCode.apply(f,c)},a=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},n=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=Kx(o)).reduce(function(c,A){return c+String.fromCharCode(A)},"")};e.processDataByFilters=function(i,o){var l=0,c=i||"",A=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:A.reverse().join(" ")}}}(Vt.API),function(e){e.loadFile=function(t,r,a){return function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,d){var f=new XMLHttpRequest,p=0,u=function(g){var h=g.length,x=[],y=String.fromCharCode;for(p=0;p<h;p+=1)x.push(y(255&g.charCodeAt(p)));return x.join("")};if(f.open("GET",c,!A),f.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(f.onload=function(){f.status===200?d(u(this.responseText)):d(void 0)}),f.send(null),A&&f.status===200)return u(f.responseText)}(n,i,o)}catch{}return l}(t,r,a)},e.loadImageFile=e.loadFile}(Vt.API),function(e){function t(){return(Yt.html2canvas?Promise.resolve(Yt.html2canvas):ps(()=>Promise.resolve().then(()=>gz),void 0)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Yt.DOMPurify?Promise.resolve(Yt.DOMPurify):ps(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var l=ea(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},n=function(o,l){var c=document.createElement(o);for(var A in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[A]=l.style[A];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),A=o.convert(Promise.resolve(),c);return A=(A=A.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(a(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(A,d){for(var f=A.nodeType===3?document.createTextNode(A.nodeValue):A.cloneNode(!1),p=A.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(c(p,d));return A.nodeType===1&&(A.nodeName==="CANVAS"?(f.width=A.width,f.height=A.height,f.getContext("2d").drawImage(A,0,0)):A.nodeName!=="TEXTAREA"&&A.nodeName!=="SELECT"||(f.value=A.value),f.addEventListener("load",function(){f.scrollTop=A.scrollTop,f.scrollLeft=A.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,A=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=A,A)for(var p=0;p<A.length;++p){var u=A[p],g=u.src.find(function(h){return h.format==="truetype"});g&&c.addFont(g.url,u.ref.name,u.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,c.context2d.save(!0),l(this.prop.container,f)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(a(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,A){return Math.floor(c*A/72*96)}return this.then(function(){(o=o||Vt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,A){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,A){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,A?this.progress.stack.concat(A):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(A,d){return c.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(f){return c.updateProgress(null,A),f}).then(A,d).then(function(f){return c.updateProgress(1),f})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var A=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=c.call(A,o,l);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Vt.getPageSize=function(o,l,c){if(ea(o)==="object"){var A=o;o=A.orientation,l=A.unit||l,c=A.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,f=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var u,g=0,h=0;if(p.hasOwnProperty(f))g=p[f][1]/d,h=p[f][0]/d;else try{g=c[1],h=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",h>g&&(u=h,h=g,g=u);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>h&&(u=h,h=g,g=u)}return{width:h,height:g,unit:l,k:d,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Yx):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(Vt.API),Vt.API.addJS=function(e){return Fw=e,this.internal.events.subscribe("postPutResources",function(){vp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(vp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Nw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Fw+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){vp!==void 0&&Nw!==void 0&&this.internal.out("/Names <</JavaScript "+vp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],l=a.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,d=[];for(i=0;i<A;i++){var f=r.internal.newObject();d.push(f);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var u=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+u+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var o={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var A=0;A<a.children.length;A++)this.renderItems(a.children[A])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])}(Vt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,i,o,l){var c,A=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(f){for(var p,u=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,h={width:0,height:0,numcomponents:1},x=4;x<g;x+=2){if(x+=u,t.indexOf(f.charCodeAt(x+1))!==-1){p=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),h={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:p,numcomponents:f.charCodeAt(x+9)};break}u=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return h}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:a,alias:n}}return d}}(Vt.API);var YA,wp,Rw,kw,Dw,I9=function(){var e,t,r;function a(i){var o,l,c,A,d,f,p,u,g,h,x,y,v,E;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(o=this.readUInt32(),g=(function(){var k,S;for(S=[],k=0;k<4;++k)S.push(String.fromCharCode(this.data[this.pos++]));return S}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),A=this.readUInt16()||100,f.delay=1e3*d/A,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,o-=4),i=(f!=null?f.data:void 0)||this.imgData,y=0;0<=o?y<o:y>o;0<=o?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((h=c-this.transparency.indexed.length)>0)for(v=0;0<=h?v<h:v>h;0<=h?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":p=(x=this.read(o)).indexOf(0),u=String.fromCharCode.apply(String,x.slice(0,p)),this.text[u]=String.fromCharCode.apply(String,x.slice(p+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(E=this.colorType)===4||E===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,A=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(f,p,u,g){var h,x,y,v,E,k,S,B,b,O,_,U,I,R,L,N,P,Q,Y,ee,V,G=Math.ceil((A.width-f)/u),z=Math.ceil((A.height-p)/g),C=A.width==G&&A.height==z;for(R=o*G,U=C?l:new Uint8Array(R*z),k=i.length,I=0,x=0;I<z&&c<k;){switch(i[c++]){case 0:for(v=P=0;P<R;v=P+=1)U[x++]=i[c++];break;case 1:for(v=Q=0;Q<R;v=Q+=1)h=i[c++],E=v<o?0:U[x-o],U[x++]=(h+E)%256;break;case 2:for(v=Y=0;Y<R;v=Y+=1)h=i[c++],y=(v-v%o)/o,L=I&&U[(I-1)*R+y*o+v%o],U[x++]=(L+h)%256;break;case 3:for(v=ee=0;ee<R;v=ee+=1)h=i[c++],y=(v-v%o)/o,E=v<o?0:U[x-o],L=I&&U[(I-1)*R+y*o+v%o],U[x++]=(h+Math.floor((E+L)/2))%256;break;case 4:for(v=V=0;V<R;v=V+=1)h=i[c++],y=(v-v%o)/o,E=v<o?0:U[x-o],I===0?L=N=0:(L=U[(I-1)*R+y*o+v%o],N=y&&U[(I-1)*R+(y-1)*o+v%o]),S=E+L-N,B=Math.abs(S-E),O=Math.abs(S-L),_=Math.abs(S-N),b=B<=O&&B<=_?E:O<=_?L:N,U[x++]=(h+b)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!C){var D=((p+I*g)*A.width+f)*o,j=I*R;for(v=0;v<G;v+=1){for(var K=0;K<o;K+=1)l[D++]=U[j++];D+=(u-1)*o}}I++}}return i=l9(i),A.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},a.prototype.decodePalette=function(){var i,o,l,c,A,d,f,p,u;for(l=this.palette,d=this.transparency.indexed||[],A=new Uint8Array((d.length||0)+l.length),c=0,i=0,o=f=0,p=l.length;f<p;o=f+=3)A[c++]=l[o],A[c++]=l[o+1],A[c++]=l[o+2],A[c++]=(u=d[i++])!=null?u:255;return A},a.prototype.copyToImageData=function(i,o){var l,c,A,d,f,p,u,g,h,x,y;if(c=this.colors,h=null,l=this.hasAlphaChannel,this.palette.length&&(h=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),c=4,l=!0),g=(A=i.data||i).length,f=h||o,d=p=0,c===1)for(;d<g;)u=h?4*o[d/4]:p,x=f[u++],A[d++]=x,A[d++]=x,A[d++]=x,A[d++]=l?f[u++]:255,p=u;else for(;d<g;)u=h?4*o[d/4]:p,A[d++]=f[u++],A[d++]=f[u++],A[d++]=f[u++],A[d++]=l?f[u++]:255,p=u},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(Yt)==="[object Window]"){try{t=Yt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return n(),e=function(i){var o;if(n()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var o,l,c,A,d,f,p,u;if(this.animation){for(u=[],l=d=0,f=(p=this.animation.frames).length;d<f;l=++d)o=p[l],c=i.createImageData(o.width,o.height),A=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,A),o.imageData=c,u.push(o.image=e(c));return u}},a.prototype.renderFrame=function(i,o){var l,c,A;return l=(c=this.animation.frames)[o],A=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(A!=null?A.disposeOp:void 0)===1?i.clearRect(A.xOffset,A.yOffset,A.width,A.height):(A!=null?A.disposeOp:void 0)===2&&i.putImageData(A.imageData,A.xOffset,A.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},a.prototype.animate=function(i){var o,l,c,A,d,f,p=this;return l=0,f=this.animation,A=f.numFrames,c=f.frames,d=f.numPlays,(o=function(){var u,g;if(u=l++%A,g=c[u],p.renderFrame(i,u),A>1&&l/A<d)return p.animation._timeout=setTimeout(o,g.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function N9(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],i=n>>7,o=1<<(7&n)+1;e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var A=!0,d=[],f=0,p=null,u=0,g=null;for(this.width=r,this.height=a;A&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var h=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],!(1&h)&&(p=null),u=h>>2&7,t++;break;case 254:for(;;){if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,k=e[t++],S=k>>6&1,B=1<<(7&k)+1,b=l,O=c,_=!1;k>>7&&(_=!0,b=t,O=B,t+=3*B);var U=t;for(t++;;){var I;if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}d.push({x,y,width:v,height:E,has_local_palette:_,palette_offset:b,palette_size:O,data_offset:U,data_length:t-U,transparent_index:p,interlaced:!!S,delay:f,disposal:u});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(R){if(R<0||R>=d.length)throw new Error("Frame index out of range.");return d[R]},this.decodeAndBlitFrameBGRA=function(R,L){var N=this.frameInfo(R),P=N.width*N.height,Q=new Uint8Array(P);jw(e,N.data_offset,Q,P);var Y=N.palette_offset,ee=N.transparent_index;ee===null&&(ee=256);var V=N.width,G=r-V,z=V,C=4*(N.y*r+N.x),D=4*((N.y+N.height)*r+N.x),j=C,K=4*G;N.interlaced===!0&&(K+=4*r*7);for(var W=8,Ae=0,ue=Q.length;Ae<ue;++Ae){var he=Q[Ae];if(z===0&&(z=V,(j+=K)>=D&&(K=4*G+4*r*(W-1),j=C+(V+G)*(W<<1),W>>=1)),he===ee)j+=4;else{var ve=e[Y+3*he],we=e[Y+3*he+1],se=e[Y+3*he+2];L[j++]=se,L[j++]=we,L[j++]=ve,L[j++]=255}--z}},this.decodeAndBlitFrameRGBA=function(R,L){var N=this.frameInfo(R),P=N.width*N.height,Q=new Uint8Array(P);jw(e,N.data_offset,Q,P);var Y=N.palette_offset,ee=N.transparent_index;ee===null&&(ee=256);var V=N.width,G=r-V,z=V,C=4*(N.y*r+N.x),D=4*((N.y+N.height)*r+N.x),j=C,K=4*G;N.interlaced===!0&&(K+=4*r*7);for(var W=8,Ae=0,ue=Q.length;Ae<ue;++Ae){var he=Q[Ae];if(z===0&&(z=V,(j+=K)>=D&&(K=4*G+4*r*(W-1),j=C+(V+G)*(W<<1),W>>=1)),he===ee)j+=4;else{var ve=e[Y+3*he],we=e[Y+3*he+1],se=e[Y+3*he+2];L[j++]=ve,L[j++]=we,L[j++]=se,L[j++]=255}--z}}}function jw(e,t,r,a){for(var n=e[t++],i=1<<n,o=i+1,l=o+1,c=n+1,A=(1<<c)-1,d=0,f=0,p=0,u=e[t++],g=new Int32Array(4096),h=null;;){for(;d<16&&u!==0;)f|=e[t++]<<d,d+=8,u===1?u=e[t++]:--u;if(d<c)break;var x=f&A;if(f>>=c,d-=c,x!==i){if(x===o)break;for(var y=x<l?x:h,v=0,E=y;E>i;)E=g[E]>>8,++v;var k=E;if(p+v+(y!==x?1:0)>a)return void Xr.log("Warning, gif stream longer than expected.");r[p++]=k;var S=p+=v;for(y!==x&&(r[p++]=k),E=y;v--;)E=g[E],r[--S]=255&E,E>>=8;h!==null&&l<4096&&(g[l++]=h<<8|k,l>=A+1&&c<12&&(++c,A=A<<1|1)),h=x}else l=o+1,A=(1<<(c=n+1))-1,h=null}return p!==a&&Xr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function n1(e){var t,r,a,n,i,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),u=new Array(64),g=new Array(64),h=[],x=0,y=7,v=new Array(64),E=new Array(64),k=new Array(64),S=new Array(256),B=new Array(2048),b=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],P=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Q(C,D){for(var j=0,K=0,W=new Array,Ae=1;Ae<=16;Ae++){for(var ue=1;ue<=C[Ae];ue++)W[D[K]]=[],W[D[K]][0]=j,W[D[K]][1]=Ae,K++,j++;j*=2}return W}function Y(C){for(var D=C[0],j=C[1]-1;j>=0;)D&1<<j&&(x|=1<<y),j--,--y<0&&(x==255?(ee(255),ee(0)):ee(x),y=7,x=0)}function ee(C){h.push(C)}function V(C){ee(C>>8&255),ee(255&C)}function G(C,D,j,K,W){for(var Ae,ue=W[0],he=W[240],ve=function(Ye,tt){var je,_e,At,Ct,_t,Et,Pt,Lt,Bt,ut,ct=0;for(Bt=0;Bt<8;++Bt){je=Ye[ct],_e=Ye[ct+1],At=Ye[ct+2],Ct=Ye[ct+3],_t=Ye[ct+4],Et=Ye[ct+5],Pt=Ye[ct+6];var wr=je+(Lt=Ye[ct+7]),Rt=je-Lt,$r=_e+Pt,hr=_e-Pt,vt=At+Et,Or=At-Et,nr=Ct+_t,cn=Ct-_t,Lr=wr+nr,as=wr-nr,Ds=$r+vt,Ur=$r-vt;Ye[ct]=Lr+Ds,Ye[ct+4]=Lr-Ds;var $t=.707106781*(Ur+as);Ye[ct+2]=as+$t,Ye[ct+6]=as-$t;var Er=.382683433*((Lr=cn+Or)-(Ur=hr+Rt)),ii=.5411961*Lr+Er,xa=1.306562965*Ur+Er,vs=.707106781*(Ds=Or+hr),ws=Rt+vs,Dt=Rt-vs;Ye[ct+5]=Dt+ii,Ye[ct+3]=Dt-ii,Ye[ct+1]=ws+xa,Ye[ct+7]=ws-xa,ct+=8}for(ct=0,Bt=0;Bt<8;++Bt){je=Ye[ct],_e=Ye[ct+8],At=Ye[ct+16],Ct=Ye[ct+24],_t=Ye[ct+32],Et=Ye[ct+40],Pt=Ye[ct+48];var ns=je+(Lt=Ye[ct+56]),Ja=je-Lt,Za=_e+Pt,Aa=_e-Pt,ge=At+Et,H=At-Et,le=Ct+_t,ae=Ct-_t,Z=ns+le,oe=ns-le,de=Za+ge,Oe=Za-ge;Ye[ct]=Z+de,Ye[ct+32]=Z-de;var Pe=.707106781*(Oe+oe);Ye[ct+16]=oe+Pe,Ye[ct+48]=oe-Pe;var Ce=.382683433*((Z=ae+H)-(Oe=Aa+Ja)),De=.5411961*Z+Ce,Me=1.306562965*Oe+Ce,$e=.707106781*(de=H+Aa),ft=Ja+$e,xt=Ja-$e;Ye[ct+40]=xt+De,Ye[ct+24]=xt-De,Ye[ct+8]=ft+Me,Ye[ct+56]=ft-Me,ct++}for(Bt=0;Bt<64;++Bt)ut=Ye[Bt]*tt[Bt],u[Bt]=ut>0?ut+.5|0:ut-.5|0;return u}(C,D),we=0;we<64;++we)g[b[we]]=ve[we];var se=g[0]-j;j=g[0],se==0?Y(K[0]):(Y(K[p[Ae=32767+se]]),Y(f[Ae]));for(var He=63;He>0&&g[He]==0;)He--;if(He==0)return Y(ue),j;for(var Ee,pe=1;pe<=He;){for(var ce=pe;g[pe]==0&&pe<=He;)++pe;var Ge=pe-ce;if(Ge>=16){Ee=Ge>>4;for(var et=1;et<=Ee;++et)Y(he);Ge&=15}Ae=32767+g[pe],Y(W[(Ge<<4)+p[Ae]]),Y(f[Ae]),pe++}return He!=63&&Y(ue),j}function z(C){C=Math.min(Math.max(C,1),100),i!=C&&(function(D){for(var j=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;K<64;K++){var W=o((j[K]*D+50)/100);W=Math.min(Math.max(W,1),255),l[b[K]]=W}for(var Ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var he=o((Ae[ue]*D+50)/100);he=Math.min(Math.max(he,1),255),c[b[ue]]=he}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],we=0,se=0;se<8;se++)for(var He=0;He<8;He++)A[we]=1/(l[b[we]]*ve[se]*ve[He]*8),d[we]=1/(c[b[we]]*ve[se]*ve[He]*8),we++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),i=C)}this.encode=function(C,D){D&&z(D),h=new Array,x=0,y=7,V(65496),V(65504),V(16),ee(74),ee(70),ee(73),ee(70),ee(0),ee(1),ee(1),ee(0),V(1),V(1),ee(0),ee(0),function(){V(65499),V(132),ee(0);for(var _e=0;_e<64;_e++)ee(l[_e]);ee(1);for(var At=0;At<64;At++)ee(c[At])}(),function(_e,At){V(65472),V(17),ee(8),V(At),V(_e),ee(3),ee(1),ee(17),ee(0),ee(2),ee(17),ee(1),ee(3),ee(17),ee(1)}(C.width,C.height),function(){V(65476),V(418),ee(0);for(var _e=0;_e<16;_e++)ee(O[_e+1]);for(var At=0;At<=11;At++)ee(_[At]);ee(16);for(var Ct=0;Ct<16;Ct++)ee(U[Ct+1]);for(var _t=0;_t<=161;_t++)ee(I[_t]);ee(1);for(var Et=0;Et<16;Et++)ee(R[Et+1]);for(var Pt=0;Pt<=11;Pt++)ee(L[Pt]);ee(17);for(var Lt=0;Lt<16;Lt++)ee(N[Lt+1]);for(var Bt=0;Bt<=161;Bt++)ee(P[Bt])}(),V(65498),V(12),ee(3),ee(1),ee(0),ee(2),ee(17),ee(3),ee(17),ee(0),ee(63),ee(0);var j=0,K=0,W=0;x=0,y=7,this.encode.displayName="_encode_";for(var Ae,ue,he,ve,we,se,He,Ee,pe,ce=C.data,Ge=C.width,et=C.height,Ye=4*Ge,tt=0;tt<et;){for(Ae=0;Ae<Ye;){for(we=Ye*tt+Ae,He=-1,Ee=0,pe=0;pe<64;pe++)se=we+(Ee=pe>>3)*Ye+(He=4*(7&pe)),tt+Ee>=et&&(se-=Ye*(tt+1+Ee-et)),Ae+He>=Ye&&(se-=Ae+He-Ye+4),ue=ce[se++],he=ce[se++],ve=ce[se++],v[pe]=(B[ue]+B[he+256>>0]+B[ve+512>>0]>>16)-128,E[pe]=(B[ue+768>>0]+B[he+1024>>0]+B[ve+1280>>0]>>16)-128,k[pe]=(B[ue+1280>>0]+B[he+1536>>0]+B[ve+1792>>0]>>16)-128;j=G(v,A,j,t,a),K=G(E,d,K,r,n),W=G(k,d,W,r,n),Ae+=32}tt+=8}if(y>=0){var je=[];je[1]=y+1,je[0]=(1<<y+1)-1,Y(je)}return V(65497),new Uint8Array(h)},e=e||50,function(){for(var C=String.fromCharCode,D=0;D<256;D++)S[D]=C(D)}(),t=Q(O,_),r=Q(R,L),a=Q(U,I),n=Q(N,P),function(){for(var C=1,D=2,j=1;j<=15;j++){for(var K=C;K<D;K++)p[32767+K]=j,f[32767+K]=[],f[32767+K][1]=j,f[32767+K][0]=K;for(var W=-(D-1);W<=-C;W++)p[32767+W]=j,f[32767+W]=[],f[32767+W][1]=j,f[32767+W][0]=D-1+W;C<<=1,D<<=1}}(),function(){for(var C=0;C<256;C++)B[C]=19595*C,B[C+256>>0]=38470*C,B[C+512>>0]=7471*C+32768,B[C+768>>0]=-11059*C,B[C+1024>>0]=-21709*C,B[C+1280>>0]=32768*C+8421375,B[C+1536>>0]=-27439*C,B[C+1792>>0]=-5329*C}(),z(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ui(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Lw(e){function t(O){if(!O)throw Error("assert :P")}function r(O,_,U){for(var I=0;4>I;I++)if(O[_+I]!=U.charCodeAt(I))return!0;return!1}function a(O,_,U,I,R){for(var L=0;L<R;L++)O[_+L]=U[I+L]}function n(O,_,U,I){for(var R=0;R<I;R++)O[_+R]=U}function i(O){return new Int32Array(O)}function o(O,_){for(var U=[],I=0;I<O;I++)U.push(new _);return U}function l(O,_){var U=[];return function I(R,L,N){for(var P=N[L],Q=0;Q<P&&(R.push(N.length>L+1?[]:new _),!(N.length<L+1));Q++)I(R[Q],L+1,N)}(U,0,O),U}var c=function(){var O=this;function _(m,w){for(var F=1<<w-1>>>0;m&F;)F>>>=1;return F?(m&F-1)+F:m}function U(m,w,F,q,X){t(!(q%F));do m[w+(q-=F)]=X;while(0<q)}function I(m,w,F,q,X){if(t(2328>=X),512>=X)var te=i(512);else if((te=i(X))==null)return 0;return function(ne,ie,fe,me,Ie,qe){var Ke,Le,nt=ie,ze=1<<fe,Fe=i(16),ke=i(16);for(t(Ie!=0),t(me!=null),t(ne!=null),t(0<fe),Le=0;Le<Ie;++Le){if(15<me[Le])return 0;++Fe[me[Le]]}if(Fe[0]==Ie)return 0;for(ke[1]=0,Ke=1;15>Ke;++Ke){if(Fe[Ke]>1<<Ke)return 0;ke[Ke+1]=ke[Ke]+Fe[Ke]}for(Le=0;Le<Ie;++Le)Ke=me[Le],0<me[Le]&&(qe[ke[Ke]++]=Le);if(ke[15]==1)return(me=new R).g=0,me.value=qe[0],U(ne,nt,1,ze,me),ze;var rt,it=-1,at=ze-1,Ot=0,wt=1,Ht=1,bt=1<<fe;for(Le=0,Ke=1,Ie=2;Ke<=fe;++Ke,Ie<<=1){if(wt+=Ht<<=1,0>(Ht-=Fe[Ke]))return 0;for(;0<Fe[Ke];--Fe[Ke])(me=new R).g=Ke,me.value=qe[Le++],U(ne,nt+Ot,Ie,bt,me),Ot=_(Ot,Ke)}for(Ke=fe+1,Ie=2;15>=Ke;++Ke,Ie<<=1){if(wt+=Ht<<=1,0>(Ht-=Fe[Ke]))return 0;for(;0<Fe[Ke];--Fe[Ke]){if(me=new R,(Ot&at)!=it){for(nt+=bt,rt=1<<(it=Ke)-fe;15>it&&!(0>=(rt-=Fe[it]));)++it,rt<<=1;ze+=bt=1<<(rt=it-fe),ne[ie+(it=Ot&at)].g=rt+fe,ne[ie+it].value=nt-ie-it}me.g=Ke-fe,me.value=qe[Le++],U(ne,nt+(Ot>>fe),Ie,bt,me),Ot=_(Ot,Ke)}}return wt!=2*ke[15]-1?0:ze}(m,w,F,q,X,te)}function R(){this.value=this.g=0}function L(){this.value=this.g=0}function N(){this.G=o(5,R),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(wn,L)}function P(m,w,F,q){t(m!=null),t(w!=null),t(2147483648>q),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=w,m.pa=F,m.Jd=w,m.Yc=F+q,m.Zc=4<=q?F+q-4+1:F,Ae(m)}function Q(m,w){for(var F=0;0<w--;)F|=he(m,128)<<w;return F}function Y(m,w){var F=Q(m,w);return ue(m)?-F:F}function ee(m,w,F,q){var X,te=0;for(t(m!=null),t(w!=null),t(4294967288>q),m.Sb=q,m.Ra=0,m.u=0,m.h=0,4<q&&(q=4),X=0;X<q;++X)te+=w[F+X]<<8*X;m.Ra=te,m.bb=q,m.oa=w,m.pa=F}function V(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<RA-8>>>0,++m.bb,m.u-=8;j(m)&&(m.h=1,m.u=0)}function G(m,w){if(t(0<=w),!m.h&&w<=FA){var F=D(m)&NA[w];return m.u+=w,V(m),F}return m.h=1,m.u=0}function z(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(m){return m.Ra>>>(m.u&RA-1)>>>0}function j(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>RA}function K(m,w){m.u=w,m.h=j(m)}function W(m){m.u>=hu&&(t(m.u>=hu),V(m))}function Ae(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ue(m){return Q(m,1)}function he(m,w){var F=m.Ca;0>m.b&&Ae(m);var q=m.b,X=F*w>>>8,te=(m.I>>>q>X)+0;for(te?(F-=X,m.I-=X+1<<q>>>0):F=X+1,q=F,X=0;256<=q;)X+=8,q>>=8;return q=7^X+_s[q],m.b-=q,m.Ca=(F<<q)-1,te}function ve(m,w,F){m[w+0]=F>>24&255,m[w+1]=F>>16&255,m[w+2]=F>>8&255,m[w+3]=F>>0&255}function we(m,w){return m[w+0]<<0|m[w+1]<<8}function se(m,w){return we(m,w)|m[w+2]<<16}function He(m,w){return we(m,w)|we(m,w+2)<<16}function Ee(m,w){var F=1<<w;return t(m!=null),t(0<w),m.X=i(F),m.X==null?0:(m.Mb=32-w,m.Xa=w,1)}function pe(m,w){t(m!=null),t(w!=null),t(m.Xa==w.Xa),a(w.X,0,m.X,0,1<<w.Xa)}function ce(){this.X=[],this.Xa=this.Mb=0}function Ge(m,w,F,q){t(F!=null),t(q!=null);var X=F[0],te=q[0];return X==0&&(X=(m*te+w/2)/w),te==0&&(te=(w*X+m/2)/m),0>=X||0>=te?0:(F[0]=X,q[0]=te,1)}function et(m,w){return m+(1<<w)-1>>>w}function Ye(m,w){return((4278255360&m)+(4278255360&w)>>>0&4278255360)+((16711935&m)+(16711935&w)>>>0&16711935)>>>0}function tt(m,w){O[w]=function(F,q,X,te,ne,ie,fe){var me;for(me=0;me<ne;++me){var Ie=O[m](ie[fe+me-1],X,te+me);ie[fe+me]=Ye(F[q+me],Ie)}}}function je(){this.ud=this.hd=this.jd=0}function _e(m,w){return((4278124286&(m^w))>>>1)+(m&w)>>>0}function At(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function Ct(m,w){return At(m+(m-w+.5>>1))}function _t(m,w,F){return Math.abs(w-F)-Math.abs(m-F)}function Et(m,w,F,q,X,te,ne){for(q=te[ne-1],F=0;F<X;++F)te[ne+F]=q=Ye(m[w+F],q)}function Pt(m,w,F,q,X){var te;for(te=0;te<F;++te){var ne=m[w+te],ie=ne>>8&255,fe=16711935&(fe=(fe=16711935&ne)+((ie<<16)+ie));q[X+te]=(4278255360&ne)+fe>>>0}}function Lt(m,w){w.jd=m>>0&255,w.hd=m>>8&255,w.ud=m>>16&255}function Bt(m,w,F,q,X,te){var ne;for(ne=0;ne<q;++ne){var ie=w[F+ne],fe=ie>>>8,me=ie,Ie=255&(Ie=(Ie=ie>>>16)+((m.jd<<24>>24)*(fe<<24>>24)>>>5));me=255&(me=(me=me+((m.hd<<24>>24)*(fe<<24>>24)>>>5))+((m.ud<<24>>24)*(Ie<<24>>24)>>>5)),X[te+ne]=(4278255360&ie)+(Ie<<16)+me}}function ut(m,w,F,q,X){O[w]=function(te,ne,ie,fe,me,Ie,qe,Ke,Le){for(fe=qe;fe<Ke;++fe)for(qe=0;qe<Le;++qe)me[Ie++]=X(ie[q(te[ne++])])},O[m]=function(te,ne,ie,fe,me,Ie,qe){var Ke=8>>te.b,Le=te.Ea,nt=te.K[0],ze=te.w;if(8>Ke)for(te=(1<<te.b)-1,ze=(1<<Ke)-1;ne<ie;++ne){var Fe,ke=0;for(Fe=0;Fe<Le;++Fe)Fe&te||(ke=q(fe[me++])),Ie[qe++]=X(nt[ke&ze]),ke>>=Ke}else O["VP8LMapColor"+F](fe,me,nt,ze,Ie,qe,ne,ie,Le)}}function ct(m,w,F,q,X){for(F=w+F;w<F;){var te=m[w++];q[X++]=te>>16&255,q[X++]=te>>8&255,q[X++]=te>>0&255}}function wr(m,w,F,q,X){for(F=w+F;w<F;){var te=m[w++];q[X++]=te>>16&255,q[X++]=te>>8&255,q[X++]=te>>0&255,q[X++]=te>>24&255}}function Rt(m,w,F,q,X){for(F=w+F;w<F;){var te=(ne=m[w++])>>16&240|ne>>12&15,ne=ne>>0&240|ne>>28&15;q[X++]=te,q[X++]=ne}}function $r(m,w,F,q,X){for(F=w+F;w<F;){var te=(ne=m[w++])>>16&248|ne>>13&7,ne=ne>>5&224|ne>>3&31;q[X++]=te,q[X++]=ne}}function hr(m,w,F,q,X){for(F=w+F;w<F;){var te=m[w++];q[X++]=te>>0&255,q[X++]=te>>8&255,q[X++]=te>>16&255}}function vt(m,w,F,q,X,te){if(te==0)for(F=w+F;w<F;)ve(q,((te=m[w++])[0]>>24|te[1]>>8&65280|te[2]<<8&16711680|te[3]<<24)>>>0),X+=32;else a(q,X,m,w,F)}function Or(m,w){O[w][0]=O[m+"0"],O[w][1]=O[m+"1"],O[w][2]=O[m+"2"],O[w][3]=O[m+"3"],O[w][4]=O[m+"4"],O[w][5]=O[m+"5"],O[w][6]=O[m+"6"],O[w][7]=O[m+"7"],O[w][8]=O[m+"8"],O[w][9]=O[m+"9"],O[w][10]=O[m+"10"],O[w][11]=O[m+"11"],O[w][12]=O[m+"12"],O[w][13]=O[m+"13"],O[w][14]=O[m+"0"],O[w][15]=O[m+"0"]}function nr(m){return m==lg||m==cg||m==M0||m==Ag}function cn(){this.eb=[],this.size=this.A=this.fb=0}function Lr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function as(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new cn,this.f.kb=new Lr,this.sd=null}function Ds(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ur(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function $t(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Er(m,w){var F=m.T,q=w.ba.f.RGBA,X=q.eb,te=q.fb+m.ka*q.A,ne=pi[w.ba.S],ie=m.y,fe=m.O,me=m.f,Ie=m.N,qe=m.ea,Ke=m.W,Le=w.cc,nt=w.dc,ze=w.Mc,Fe=w.Nc,ke=m.ka,rt=m.ka+m.T,it=m.U,at=it+1>>1;for(ke==0?ne(ie,fe,null,null,me,Ie,qe,Ke,me,Ie,qe,Ke,X,te,null,null,it):(ne(w.ec,w.fc,ie,fe,Le,nt,ze,Fe,me,Ie,qe,Ke,X,te-q.A,X,te,it),++F);ke+2<rt;ke+=2)Le=me,nt=Ie,ze=qe,Fe=Ke,Ie+=m.Rc,Ke+=m.Rc,te+=2*q.A,ne(ie,(fe+=2*m.fa)-m.fa,ie,fe,Le,nt,ze,Fe,me,Ie,qe,Ke,X,te-q.A,X,te,it);return fe+=m.fa,m.j+rt<m.o?(a(w.ec,w.fc,ie,fe,it),a(w.cc,w.dc,me,Ie,at),a(w.Mc,w.Nc,qe,Ke,at),F--):1&rt||ne(ie,fe,null,null,me,Ie,qe,Ke,me,Ie,qe,Ke,X,te+q.A,null,null,it),F}function ii(m,w,F){var q=m.F,X=[m.J];if(q!=null){var te=m.U,ne=w.ba.S,ie=ne==U0||ne==M0;w=w.ba.f.RGBA;var fe=[0],me=m.ka;fe[0]=m.T,m.Kb&&(me==0?--fe[0]:(--me,X[0]-=m.width),m.j+m.ka+m.T==m.o&&(fe[0]=m.o-m.j-me));var Ie=w.eb;me=w.fb+me*w.A,m=aa(q,X[0],m.width,te,fe,Ie,me+(ie?0:3),w.A),t(F==fe),m&&nr(ne)&&ui(Ie,me,ie,te,fe,w.A)}return 0}function xa(m){var w=m.ma,F=w.ba.S,q=11>F,X=F==j0||F==L0||F==U0||F==og||F==12||nr(F);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!fu(w.Oa,m,X?11:12))return 0;if(X&&nr(F)&&lt(),m.da)alert("todo:use_scaling");else{if(q){if(w.Ib=$t,m.Kb){if(F=m.U+1>>1,w.memory=i(m.U+2*F),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+m.U,w.Mc=w.cc,w.Nc=w.dc+F,w.Ib=Er,lt()}}else alert("todo:EmitYUV");X&&(w.Jb=ii,q&&Qe())}if(q&&!dv){for(m=0;256>m;++m)tT[m]=89858*(m-128)+Q0>>P0,nT[m]=-22014*(m-128)+Q0,aT[m]=-45773*(m-128),rT[m]=113618*(m-128)+Q0>>P0;for(m=Eu;m<fg;++m)w=76283*(m-16)+Q0>>P0,sT[m-Eu]=Ls(w,255),iT[m-Eu]=Ls(w+8>>4,15);dv=1}return 1}function vs(m){var w=m.ma,F=m.U,q=m.T;return t(!(1&m.ka)),0>=F||0>=q?0:(F=w.Ib(m,w),w.Jb!=null&&w.Jb(m,w,F),w.Dc+=F,1)}function ws(m){m.ma.memory=null}function Dt(m,w,F,q){return G(m,8)!=47?0:(w[0]=G(m,14)+1,F[0]=G(m,14)+1,q[0]=G(m,1),G(m,3)!=0?0:!m.h)}function ns(m,w){if(4>m)return m+1;var F=m-2>>1;return(2+(1&m)<<F)+G(w,F)+1}function Ja(m,w){return 120<w?w-120:1<=(F=((F=QS[w-1])>>4)*m+(8-(15&F)))?F:1;var F}function Za(m,w,F){var q=D(F),X=m[w+=255&q].g-8;return 0<X&&(K(F,F.u+8),q=D(F),w+=m[w].value,w+=q&(1<<X)-1),K(F,F.u+m[w].g),m[w].value}function Aa(m,w,F){return F.g+=m.g,F.value+=m.value<<w>>>0,t(8>=F.g),m.g}function ge(m,w,F){var q=m.xc;return t((w=q==0?0:m.vc[m.md*(F>>q)+(w>>q)])<m.Wb),m.Ya[w]}function H(m,w,F,q){var X=m.ab,te=m.c*w,ne=m.C;w=ne+w;var ie=F,fe=q;for(q=m.Ta,F=m.Ua;0<X--;){var me=m.gc[X],Ie=ne,qe=w,Ke=ie,Le=fe,nt=(fe=q,ie=F,me.Ea);switch(t(Ie<qe),t(qe<=me.nc),me.hc){case 2:O0(Ke,Le,(qe-Ie)*nt,fe,ie);break;case 0:var ze=Ie,Fe=qe,ke=fe,rt=ie,it=(bt=me).Ea;ze==0&&(sg(Ke,Le,null,null,1,ke,rt),Et(Ke,Le+1,0,0,it-1,ke,rt+1),Le+=it,rt+=it,++ze);for(var at=1<<bt.b,Ot=at-1,wt=et(it,bt.b),Ht=bt.K,bt=bt.w+(ze>>bt.b)*wt;ze<Fe;){var Fr=Ht,Mr=bt,Br=1;for(mu(Ke,Le,ke,rt-it,1,ke,rt);Br<it;){var mr=(Br&~Ot)+at;mr>it&&(mr=it),(0,ul[Fr[Mr++]>>8&15])(Ke,Le+ +Br,ke,rt+Br-it,mr-Br,ke,rt+Br),Br=mr}Le+=it,rt+=it,++ze&Ot||(bt+=wt)}qe!=me.nc&&a(fe,ie-nt,fe,ie+(qe-Ie-1)*nt,nt);break;case 1:for(nt=Ke,Fe=Le,it=(Ke=me.Ea)-(rt=Ke&~(ke=(Le=1<<me.b)-1)),ze=et(Ke,me.b),at=me.K,me=me.w+(Ie>>me.b)*ze;Ie<qe;){for(Ot=at,wt=me,Ht=new je,bt=Fe+rt,Fr=Fe+Ke;Fe<bt;)Lt(Ot[wt++],Ht),wc(Ht,nt,Fe,Le,fe,ie),Fe+=Le,ie+=Le;Fe<Fr&&(Lt(Ot[wt++],Ht),wc(Ht,nt,Fe,it,fe,ie),Fe+=it,ie+=it),++Ie&ke||(me+=ze)}break;case 3:if(Ke==fe&&Le==ie&&0<me.b){for(Fe=fe,Ke=nt=ie+(qe-Ie)*nt-(rt=(qe-Ie)*et(me.Ea,me.b)),Le=fe,ke=ie,ze=[],rt=(it=rt)-1;0<=rt;--rt)ze[rt]=Le[ke+rt];for(rt=it-1;0<=rt;--rt)Fe[Ke+rt]=ze[rt];ci(me,Ie,qe,fe,nt,fe,ie)}else ci(me,Ie,qe,Ke,Le,fe,ie)}ie=q,fe=F}fe!=F&&a(q,F,ie,fe,te)}function le(m,w){var F=m.V,q=m.Ba+m.c*m.C,X=w-m.C;if(t(w<=m.l.o),t(16>=X),0<X){var te=m.l,ne=m.Ta,ie=m.Ua,fe=te.width;if(H(m,X,F,q),X=ie=[ie],t((F=m.C)<(q=w)),t(te.v<te.va),q>te.o&&(q=te.o),F<te.j){var me=te.j-F;F=te.j,X[0]+=me*fe}if(F>=q?F=0:(X[0]+=4*te.v,te.ka=F-te.j,te.U=te.va-te.v,te.T=q-F,F=1),F){if(ie=ie[0],11>(F=m.ca).S){var Ie=F.f.RGBA,qe=(q=F.S,X=te.U,te=te.T,me=Ie.eb,Ie.A),Ke=te;for(Ie=Ie.fb+m.Ma*Ie.A;0<Ke--;){var Le=ne,nt=ie,ze=X,Fe=me,ke=Ie;switch(q){case D0:Cs(Le,nt,ze,Fe,ke);break;case j0:is(Le,nt,ze,Fe,ke);break;case lg:is(Le,nt,ze,Fe,ke),ui(Fe,ke,0,ze,1,0);break;case rv:Io(Le,nt,ze,Fe,ke);break;case L0:vt(Le,nt,ze,Fe,ke,1);break;case cg:vt(Le,nt,ze,Fe,ke,1),ui(Fe,ke,0,ze,1,0);break;case U0:vt(Le,nt,ze,Fe,ke,0);break;case M0:vt(Le,nt,ze,Fe,ke,0),ui(Fe,ke,1,ze,1,0);break;case og:fl(Le,nt,ze,Fe,ke);break;case Ag:fl(Le,nt,ze,Fe,ke),ra(Fe,ke,ze,1,0);break;case av:Oo(Le,nt,ze,Fe,ke);break;default:t(0)}ie+=fe,Ie+=qe}m.Ma+=te}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=F.height)}}m.C=w,t(m.C<=m.i)}function ae(m){var w;if(0<m.ua)return 0;for(w=0;w<m.Wb;++w){var F=m.Ya[w].G,q=m.Ya[w].H;if(0<F[1][q[1]+0].g||0<F[2][q[2]+0].g||0<F[3][q[3]+0].g)return 0}return 1}function Z(m,w,F,q,X,te){if(m.Z!=0){var ne=m.qd,ie=m.rd;for(t(gl[m.Z]!=null);w<F;++w)gl[m.Z](ne,ie,q,X,q,X,te),ne=q,ie=X,X+=te;m.qd=ne,m.rd=ie}}function oe(m,w){var F=m.l.ma,q=F.Z==0||F.Z==1?m.l.j:m.C;if(q=m.C<q?q:m.C,t(w<=m.l.o),w>q){var X=m.l.width,te=F.ca,ne=F.tb+X*q,ie=m.V,fe=m.Ba+m.c*q,me=m.gc;t(m.ab==1),t(me[0].hc==3),I0(me[0],q,w,ie,fe,te,ne),Z(F,q,w,te,ne,X)}m.C=m.Ma=w}function de(m,w,F,q,X,te,ne){var ie=m.$/q,fe=m.$%q,me=m.m,Ie=m.s,qe=F+m.$,Ke=qe;X=F+q*X;var Le=F+q*te,nt=280+Ie.ua,ze=m.Pb?ie:16777216,Fe=0<Ie.ua?Ie.Wa:null,ke=Ie.wc,rt=qe<Le?ge(Ie,fe,ie):null;t(m.C<te),t(Le<=X);var it=!1;e:for(;;){for(;it||qe<Le;){var at=0;if(ie>=ze){var Ot=qe-F;t((ze=m).Pb),ze.wd=ze.m,ze.xd=Ot,0<ze.s.ua&&pe(ze.s.Wa,ze.s.vb),ze=ie+KS}if(fe&ke||(rt=ge(Ie,fe,ie)),t(rt!=null),rt.Qb&&(w[qe]=rt.qb,it=!0),!it)if(W(me),rt.jc){at=me,Ot=w;var wt=qe,Ht=rt.pd[D(at)&wn-1];t(rt.jc),256>Ht.g?(K(at,at.u+Ht.g),Ot[wt]=Ht.value,at=0):(K(at,at.u+Ht.g-256),t(256<=Ht.value),at=Ht.value),at==0&&(it=!0)}else at=Za(rt.G[0],rt.H[0],me);if(me.h)break;if(it||256>at){if(!it)if(rt.nd)w[qe]=(rt.qb|at<<8)>>>0;else{if(W(me),it=Za(rt.G[1],rt.H[1],me),W(me),Ot=Za(rt.G[2],rt.H[2],me),wt=Za(rt.G[3],rt.H[3],me),me.h)break;w[qe]=(wt<<24|it<<16|at<<8|Ot)>>>0}if(it=!1,++qe,++fe>=q&&(fe=0,++ie,ne!=null&&ie<=te&&!(ie%16)&&ne(m,ie),Fe!=null))for(;Ke<qe;)at=w[Ke++],Fe.X[(506832829*at&4294967295)>>>Fe.Mb]=at}else if(280>at){if(at=ns(at-256,me),Ot=Za(rt.G[4],rt.H[4],me),W(me),Ot=Ja(q,Ot=ns(Ot,me)),me.h)break;if(qe-F<Ot||X-qe<at)break e;for(wt=0;wt<at;++wt)w[qe+wt]=w[qe+wt-Ot];for(qe+=at,fe+=at;fe>=q;)fe-=q,++ie,ne!=null&&ie<=te&&!(ie%16)&&ne(m,ie);if(t(qe<=X),fe&ke&&(rt=ge(Ie,fe,ie)),Fe!=null)for(;Ke<qe;)at=w[Ke++],Fe.X[(506832829*at&4294967295)>>>Fe.Mb]=at}else{if(!(at<nt))break e;for(it=at-280,t(Fe!=null);Ke<qe;)at=w[Ke++],Fe.X[(506832829*at&4294967295)>>>Fe.Mb]=at;at=qe,t(!(it>>>(Ot=Fe).Xa)),w[at]=Ot.X[it],it=!0}it||t(me.h==j(me))}if(m.Pb&&me.h&&qe<X)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&pe(m.s.vb,m.s.Wa);else{if(me.h)break e;ne!=null&&ne(m,ie>te?te:ie),m.a=0,m.$=qe-F}return 1}return m.a=3,0}function Oe(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var w=m.Wa;w!=null&&(w.X=null),m.vb=null,t(m!=null)}function Pe(){var m=new ng;return m==null?null:(m.a=0,m.xb=iv,Or("Predictor","VP8LPredictors"),Or("Predictor","VP8LPredictors_C"),Or("PredictorAdd","VP8LPredictorsAdd"),Or("PredictorAdd","VP8LPredictorsAdd_C"),O0=Pt,wc=Bt,Cs=ct,is=wr,fl=Rt,Oo=$r,Io=hr,O.VP8LMapColor32b=kA,O.VP8LMapColor8b=N0,m)}function Ce(m,w,F,q,X){var te=1,ne=[m],ie=[w],fe=q.m,me=q.s,Ie=null,qe=0;e:for(;;){if(F)for(;te&&G(fe,1);){var Ke=ne,Le=ie,nt=q,ze=1,Fe=nt.m,ke=nt.gc[nt.ab],rt=G(Fe,2);if(nt.Oc&1<<rt)te=0;else{switch(nt.Oc|=1<<rt,ke.hc=rt,ke.Ea=Ke[0],ke.nc=Le[0],ke.K=[null],++nt.ab,t(4>=nt.ab),rt){case 0:case 1:ke.b=G(Fe,3)+2,ze=Ce(et(ke.Ea,ke.b),et(ke.nc,ke.b),0,nt,ke.K),ke.K=ke.K[0];break;case 3:var it,at=G(Fe,8)+1,Ot=16<at?0:4<at?1:2<at?2:3;if(Ke[0]=et(ke.Ea,Ot),ke.b=Ot,it=ze=Ce(at,1,0,nt,ke.K)){var wt,Ht=at,bt=ke,Fr=1<<(8>>bt.b),Mr=i(Fr);if(Mr==null)it=0;else{var Br=bt.K[0],mr=bt.w;for(Mr[0]=bt.K[0][0],wt=1;wt<1*Ht;++wt)Mr[wt]=Ye(Br[mr+wt],Mr[wt-1]);for(;wt<4*Fr;++wt)Mr[wt]=0;bt.K[0]=null,bt.K[0]=Mr,it=1}}ze=it;break;case 2:break;default:t(0)}te=ze}}if(ne=ne[0],ie=ie[0],te&&G(fe,1)&&!(te=1<=(qe=G(fe,4))&&11>=qe)){q.a=3;break e}var Wr;if(Wr=te)t:{var Gr,or,Ka,Bs=q,Ha=ne,Ss=ie,Pr=qe,Ms=F,Ps=Bs.m,un=Bs.s,En=[null],ls=1,hi=0,to=qS[Pr];r:for(;;){if(Ms&&G(Ps,1)){var fn=G(Ps,3)+2,ko=et(Ha,fn),Bc=et(Ss,fn),MA=ko*Bc;if(!Ce(ko,Bc,0,Bs,En))break r;for(En=En[0],un.xc=fn,Gr=0;Gr<MA;++Gr){var xl=En[Gr]>>8&65535;En[Gr]=xl,xl>=ls&&(ls=xl+1)}}if(Ps.h)break r;for(or=0;5>or;++or){var wa=nv[or];!or&&0<Pr&&(wa+=1<<Pr),hi<wa&&(hi=wa)}var pg=o(ls*to,R),pv=ls,hv=o(pv,N);if(hv==null)var K0=null;else t(65536>=pv),K0=hv;var bu=i(hi);if(K0==null||bu==null||pg==null){Bs.a=1;break r}var H0=pg;for(Gr=Ka=0;Gr<ls;++Gr){var Di=K0[Gr],PA=Di.G,QA=Di.H,mv=0,G0=1,gv=0;for(or=0;5>or;++or){wa=nv[or],PA[or]=H0,QA[or]=Ka,!or&&0<Pr&&(wa+=1<<Pr);n:{var z0,hg=wa,V0=Bs,_u=bu,cT=H0,AT=Ka,mg=0,yl=V0.m,dT=G(yl,1);if(n(_u,0,0,hg),dT){var uT=G(yl,1)+1,fT=G(yl,1),xv=G(yl,fT==0?1:8);_u[xv]=1,uT==2&&(_u[xv=G(yl,8)]=1);var $0=1}else{var yv=i(19),vv=G(yl,4)+4;if(19<vv){V0.a=3;var Y0=0;break n}for(z0=0;z0<vv;++z0)yv[PS[z0]]=G(yl,3);var gg=void 0,Cu=void 0,wv=V0,pT=yv,W0=hg,Ev=_u,xg=0,vl=wv.m,bv=8,_v=o(128,R);a:for(;I(_v,0,7,pT,19);){if(G(vl,1)){var hT=2+2*G(vl,3);if((gg=2+G(vl,hT))>W0)break a}else gg=W0;for(Cu=0;Cu<W0&&gg--;){W(vl);var Cv=_v[0+(127&D(vl))];K(vl,vl.u+Cv.g);var qA=Cv.value;if(16>qA)Ev[Cu++]=qA,qA!=0&&(bv=qA);else{var mT=qA==16,Bv=qA-16,gT=US[Bv],Sv=G(vl,LS[Bv])+gT;if(Cu+Sv>W0)break a;for(var xT=mT?bv:0;0<Sv--;)Ev[Cu++]=xT}}xg=1;break a}xg||(wv.a=3),$0=xg}($0=$0&&!yl.h)&&(mg=I(cT,AT,8,_u,hg)),$0&&mg!=0?Y0=mg:(V0.a=3,Y0=0)}if(Y0==0)break r;if(G0&&MS[or]==1&&(G0=H0[Ka].g==0),mv+=H0[Ka].g,Ka+=Y0,3>=or){var Bu,yg=bu[0];for(Bu=1;Bu<wa;++Bu)bu[Bu]>yg&&(yg=bu[Bu]);gv+=yg}}if(Di.nd=G0,Di.Qb=0,G0&&(Di.qb=(PA[3][QA[3]+0].value<<24|PA[1][QA[1]+0].value<<16|PA[2][QA[2]+0].value)>>>0,mv==0&&256>PA[0][QA[0]+0].value&&(Di.Qb=1,Di.qb+=PA[0][QA[0]+0].value<<8)),Di.jc=!Di.Qb&&6>gv,Di.jc){var X0,Do=Di;for(X0=0;X0<wn;++X0){var wl=X0,El=Do.pd[wl],J0=Do.G[0][Do.H[0]+wl];256<=J0.value?(El.g=J0.g+256,El.value=J0.value):(El.g=0,El.value=0,wl>>=Aa(J0,8,El),wl>>=Aa(Do.G[1][Do.H[1]+wl],16,El),wl>>=Aa(Do.G[2][Do.H[2]+wl],0,El),Aa(Do.G[3][Do.H[3]+wl],24,El))}}}un.vc=En,un.Wb=ls,un.Ya=K0,un.yc=pg,Wr=1;break t}Wr=0}if(!(te=Wr)){q.a=3;break e}if(0<qe){if(me.ua=1<<qe,!Ee(me.Wa,qe)){q.a=1,te=0;break e}}else me.ua=0;var vg=q,Tv=ne,yT=ie,wg=vg.s,Eg=wg.xc;if(vg.c=Tv,vg.i=yT,wg.md=et(Tv,Eg),wg.wc=Eg==0?-1:(1<<Eg)-1,F){q.xb=WS;break e}if((Ie=i(ne*ie))==null){q.a=1,te=0;break e}te=(te=de(q,Ie,0,ne,ie,ie,null))&&!fe.h;break e}return te?(X!=null?X[0]=Ie:(t(Ie==null),t(F)),q.$=0,F||Oe(me)):Oe(me),te}function De(m,w){var F=m.c*m.i,q=F+w+16*w;return t(m.c<=w),m.V=i(q),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+F+w,1)}function Me(m,w){var F=m.C,q=w-F,X=m.V,te=m.Ba+m.c*F;for(t(w<=m.l.o);0<q;){var ne=16<q?16:q,ie=m.l.ma,fe=m.l.width,me=fe*ne,Ie=ie.ca,qe=ie.tb+fe*F,Ke=m.Ta,Le=m.Ua;H(m,ne,X,te),Na(Ke,Le,Ie,qe,me),Z(ie,F,F+ne,Ie,qe,fe),q-=ne,X+=ne*m.c,F+=ne}t(F==w),m.C=m.Ma=w}function $e(){this.ub=this.yd=this.td=this.Rb=0}function ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function xt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ot(){this.Yb=function(){var m=[];return function w(F,q,X){for(var te=X[q],ne=0;ne<te&&(F.push(X.length>q+1?[]:0),!(X.length<q+1));ne++)w(F[ne],q+1,X)}(m,0,[3,11]),m}()}function mt(){this.jb=i(3),this.Wc=l([4,8],ot),this.Xc=l([4,17],ot)}function Kt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function yr(){this.ld=this.La=this.dd=this.tc=0}function Cr(){this.Na=this.la=0}function ya(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Es(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function bs(){this.uc=this.M=this.Nb=0,this.wa=Array(new yr),this.Y=0,this.ya=Array(new Es),this.aa=0,this.l=new oi}function Fn(){this.y=i(16),this.f=i(8),this.ea=i(8)}function js(){this.cb=this.a=0,this.sc="",this.m=new z,this.Od=new $e,this.Kc=new ft,this.ed=new Kt,this.Qa=new xt,this.Ic=this.$c=this.Aa=0,this.D=new bs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,z),this.ia=0,this.pb=o(4,ya),this.Pa=new mt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fn),this.Hd=0,this.rb=Array(new Cr),this.sb=0,this.wa=Array(new yr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Es),this.L=this.aa=0,this.gd=l([4,2],yr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function oi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ss(){var m=new js;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,wu||(wu=Co)),m}function ha(m,w,F){return m.a==0&&(m.a=w,m.sc=F,m.cb=0),0}function Yr(m,w,F){return 3<=F&&m[w+0]==157&&m[w+1]==1&&m[w+2]==42}function en(m,w){if(m==null)return 0;if(m.a=0,m.sc="OK",w==null)return ha(m,2,"null VP8Io passed to VP8GetHeaders()");var F=w.data,q=w.w,X=w.ha;if(4>X)return ha(m,7,"Truncated header.");var te=F[q+0]|F[q+1]<<8|F[q+2]<<16,ne=m.Od;if(ne.Rb=!(1&te),ne.td=te>>1&7,ne.yd=te>>4&1,ne.ub=te>>5,3<ne.td)return ha(m,3,"Incorrect keyframe parameters.");if(!ne.yd)return ha(m,4,"Frame not displayable.");q+=3,X-=3;var ie=m.Kc;if(ne.Rb){if(7>X)return ha(m,7,"cannot parse picture header");if(!Yr(F,q,X))return ha(m,3,"Bad code word");ie.c=16383&(F[q+4]<<8|F[q+3]),ie.Td=F[q+4]>>6,ie.i=16383&(F[q+6]<<8|F[q+5]),ie.Ud=F[q+6]>>6,q+=7,X-=7,m.za=ie.c+15>>4,m.Ub=ie.i+15>>4,w.width=ie.c,w.height=ie.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,n((te=m.Pa).jb,0,255,te.jb.length),t((te=m.Qa)!=null),te.Cb=0,te.Bb=0,te.Fb=1,n(te.Zb,0,0,te.Zb.length),n(te.Lb,0,0,te.Lb)}if(ne.ub>X)return ha(m,7,"bad partition length");P(te=m.m,F,q,ne.ub),q+=ne.ub,X-=ne.ub,ne.Rb&&(ie.Ld=ue(te),ie.Kd=ue(te)),ie=m.Qa;var fe,me=m.Pa;if(t(te!=null),t(ie!=null),ie.Cb=ue(te),ie.Cb){if(ie.Bb=ue(te),ue(te)){for(ie.Fb=ue(te),fe=0;4>fe;++fe)ie.Zb[fe]=ue(te)?Y(te,7):0;for(fe=0;4>fe;++fe)ie.Lb[fe]=ue(te)?Y(te,6):0}if(ie.Bb)for(fe=0;3>fe;++fe)me.jb[fe]=ue(te)?Q(te,8):255}else ie.Bb=0;if(te.Ka)return ha(m,3,"cannot parse segment header");if((ie=m.ed).zd=ue(te),ie.Tb=Q(te,6),ie.wb=Q(te,3),ie.Pc=ue(te),ie.Pc&&ue(te)){for(me=0;4>me;++me)ue(te)&&(ie.vd[me]=Y(te,6));for(me=0;4>me;++me)ue(te)&&(ie.od[me]=Y(te,6))}if(m.L=ie.Tb==0?0:ie.zd?1:2,te.Ka)return ha(m,3,"cannot parse filter header");var Ie=X;if(X=fe=q,q=fe+Ie,ie=Ie,m.Xb=(1<<Q(m.m,2))-1,Ie<3*(me=m.Xb))F=7;else{for(fe+=3*me,ie-=3*me,Ie=0;Ie<me;++Ie){var qe=F[X+0]|F[X+1]<<8|F[X+2]<<16;qe>ie&&(qe=ie),P(m.Jc[+Ie],F,fe,qe),fe+=qe,ie-=qe,X+=3}P(m.Jc[+me],F,fe,ie),F=fe<q?0:5}if(F!=0)return ha(m,F,"cannot parse partitions");for(F=Q(fe=m.m,7),X=ue(fe)?Y(fe,4):0,q=ue(fe)?Y(fe,4):0,ie=ue(fe)?Y(fe,4):0,me=ue(fe)?Y(fe,4):0,fe=ue(fe)?Y(fe,4):0,Ie=m.Qa,qe=0;4>qe;++qe){if(Ie.Cb){var Ke=Ie.Zb[qe];Ie.Fb||(Ke+=F)}else{if(0<qe){m.pb[qe]=m.pb[0];continue}Ke=F}var Le=m.pb[qe];Le.Sc[0]=dg[Ls(Ke+X,127)],Le.Sc[1]=ug[Ls(Ke+0,127)],Le.Eb[0]=2*dg[Ls(Ke+q,127)],Le.Eb[1]=101581*ug[Ls(Ke+ie,127)]>>16,8>Le.Eb[1]&&(Le.Eb[1]=8),Le.Qc[0]=dg[Ls(Ke+me,117)],Le.Qc[1]=ug[Ls(Ke+fe,127)],Le.lc=Ke+fe}if(!ne.Rb)return ha(m,4,"Not a key frame.");for(ue(te),ne=m.Pa,F=0;4>F;++F){for(X=0;8>X;++X)for(q=0;3>q;++q)for(ie=0;11>ie;++ie)me=he(te,$S[F][X][q][ie])?Q(te,8):zS[F][X][q][ie],ne.Wc[F][X].Yb[q][ie]=me;for(X=0;17>X;++X)ne.Xc[F][X]=ne.Wc[F][YS[X]]}return m.kc=ue(te),m.kc&&(m.Bd=Q(te,8)),m.cb=1}function Co(m,w,F,q,X,te,ne){var ie=w[X].Yb[F];for(F=0;16>X;++X){if(!he(m,ie[F+0]))return X;for(;!he(m,ie[F+1]);)if(ie=w[++X].Yb[0],F=0,X==16)return 16;var fe=w[X+1].Yb;if(he(m,ie[F+2])){var me=m,Ie=0;if(he(me,(Ke=ie)[(qe=F)+3]))if(he(me,Ke[qe+6])){for(ie=0,qe=2*(Ie=he(me,Ke[qe+8]))+(Ke=he(me,Ke[qe+9+Ie])),Ie=0,Ke=HS[qe];Ke[ie];++ie)Ie+=Ie+he(me,Ke[ie]);Ie+=3+(8<<qe)}else he(me,Ke[qe+7])?(Ie=7+2*he(me,165),Ie+=he(me,145)):Ie=5+he(me,159);else Ie=he(me,Ke[qe+4])?3+he(me,Ke[qe+5]):2;ie=fe[2]}else Ie=1,ie=fe[1];fe=ne+GS[X],0>(me=m).b&&Ae(me);var qe,Ke=me.b,Le=(qe=me.Ca>>1)-(me.I>>Ke)>>31;--me.b,me.Ca+=Le,me.Ca|=1,me.I-=(qe+1&Le)<<Ke,te[fe]=((Ie^Le)-Le)*q[(0<X)+0]}return 16}function li(m){var w=m.rb[m.sb-1];w.la=0,w.Na=0,n(m.zc,0,0,m.zc.length),m.ja=0}function wA(m,w){if(m==null)return 0;if(w==null)return ha(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!en(m,w))return 0;if(t(m.cb),w.ac==null||w.ac(w)){w.ob&&(m.L=0);var F=q0[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=w.v-F>>4,m.zb=w.j-F>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=w.o+15+F>>4,m.Hb=w.va+15+F>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var q=m.ed;for(F=0;4>F;++F){var X;if(m.Qa.Cb){var te=m.Qa.Lb[F];m.Qa.Fb||(te+=q.Tb)}else te=q.Tb;for(X=0;1>=X;++X){var ne=m.gd[F][X],ie=te;if(q.Pc&&(ie+=q.vd[0],X&&(ie+=q.od[0])),0<(ie=0>ie?0:63<ie?63:ie)){var fe=ie;0<q.wb&&(fe=4<q.wb?fe>>2:fe>>1)>9-q.wb&&(fe=9-q.wb),1>fe&&(fe=1),ne.dd=fe,ne.tc=2*ie+fe,ne.ld=40<=ie?2:15<=ie?1:0}else ne.tc=0;ne.La=X}}}F=0}else ha(m,6,"Frame setup failed"),F=m.a;if(F=F==0){if(F){m.$c=0,0<m.Aa||(m.Ic=lT);e:{F=m.Ic,q=4*(fe=m.za);var me=32*fe,Ie=fe+1,qe=0<m.L?fe*(0<m.Aa?2:1):0,Ke=(m.Aa==2?2:1)*fe;if((ne=q+832+(X=3*(16*F+q0[m.L])/2*me)+(te=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=ne)F=0;else{if(ne>m.Vb){if(m.Vb=0,m.Ec=i(ne),m.Fc=0,m.Ec==null){F=ha(m,1,"no memory during frame initialization.");break e}m.Vb=ne}ne=m.Ec,ie=m.Fc,m.Ac=ne,m.Bc=ie,ie+=q,m.Gd=o(me,Fn),m.Hd=0,m.rb=o(Ie+1,Cr),m.sb=1,m.wa=qe?o(qe,yr):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=fe),t(!0),m.oc=ne,m.pc=ie,ie+=832,m.ya=o(Ke,Es),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=fe),m.R=16*fe,m.B=8*fe,fe=(me=q0[m.L])*m.R,me=me/2*m.B,m.sa=ne,m.ta=ie+fe,m.qa=m.sa,m.ra=m.ta+16*F*m.R+me,m.Ha=m.qa,m.Ia=m.ra+8*F*m.B+me,m.$c=0,ie+=X,m.mb=te?ne:null,m.nb=te?ie:null,t(ie+te<=m.Fc+m.Vb),li(m),n(m.Ac,m.Bc,0,q),F=1}}if(F){if(w.ka=0,w.y=m.sa,w.O=m.ta,w.f=m.qa,w.N=m.ra,w.ea=m.Ha,w.Vd=m.Ia,w.fa=m.R,w.Rc=m.B,w.F=null,w.J=0,!R0){for(F=-255;255>=F;++F)tn[255+F]=0>F?-F:F;for(F=-1020;1020>=F;++F)Fo[1020+F]=-128>F?-128:127<F?127:F;for(F=-112;112>=F;++F)vu[112+F]=-16>F?-16:15<F?15:F;for(F=-255;510>=F;++F)UA[255+F]=0>F?0:255<F?255:F;R0=1}DA=Hm,No=Zd,gu=ll,os=Km,Ai=g0,Ia=mc,jA=nu,F0=yc,xu=ag,Ec=su,bc=rg,pl=BA,_c=iu,LA=B0,Cc=C0,hl=Zi,yu=To,di=tg,ki[0]=Ji,ki[1]=Gm,ki[2]=Ym,ki[3]=Wm,ki[4]=v0,ki[5]=_A,ki[6]=w0,ki[7]=tu,ki[8]=Jm,ki[9]=Xm,ml[0]=x0,ml[1]=Vm,ml[2]=So,ml[3]=EA,ml[4]=kn,ml[5]=$m,ml[6]=y0,Ro[0]=cl,Ro[1]=zm,Ro[2]=Zm,Ro[3]=ru,Ro[4]=xc,Ro[5]=eg,Ro[6]=au,F=1}else F=0}F&&(F=function(Le,nt){for(Le.M=0;Le.M<Le.Va;++Le.M){var ze,Fe=Le.Jc[Le.M&Le.Xb],ke=Le.m,rt=Le;for(ze=0;ze<rt.za;++ze){var it=ke,at=rt,Ot=at.Ac,wt=at.Bc+4*ze,Ht=at.zc,bt=at.ya[at.aa+ze];if(at.Qa.Bb?bt.$b=he(it,at.Pa.jb[0])?2+he(it,at.Pa.jb[2]):he(it,at.Pa.jb[1]):bt.$b=0,at.kc&&(bt.Ad=he(it,at.Bd)),bt.Za=!he(it,145)+0,bt.Za){var Fr=bt.Ob,Mr=0;for(at=0;4>at;++at){var Br,mr=Ht[0+at];for(Br=0;4>Br;++Br){mr=VS[Ot[wt+Br]][mr];for(var Wr=sv[he(it,mr[0])];0<Wr;)Wr=sv[2*Wr+he(it,mr[Wr])];mr=-Wr,Ot[wt+Br]=mr}a(Fr,Mr,Ot,wt,4),Mr+=4,Ht[0+at]=mr}}else mr=he(it,156)?he(it,128)?1:3:he(it,163)?2:0,bt.Ob[0]=mr,n(Ot,wt,mr,4),n(Ht,0,mr,4);bt.Dd=he(it,142)?he(it,114)?he(it,183)?1:3:2:0}if(rt.m.Ka)return ha(Le,7,"Premature end-of-partition0 encountered.");for(;Le.ja<Le.za;++Le.ja){if(rt=Fe,it=(ke=Le).rb[ke.sb-1],Ot=ke.rb[ke.sb+ke.ja],ze=ke.ya[ke.aa+ke.ja],wt=ke.kc?ze.Ad:0)it.la=Ot.la=0,ze.Za||(it.Na=Ot.Na=0),ze.Hc=0,ze.Gc=0,ze.ia=0;else{var Gr,or;if(it=Ot,Ot=rt,wt=ke.Pa.Xc,Ht=ke.ya[ke.aa+ke.ja],bt=ke.pb[Ht.$b],at=Ht.ad,Fr=0,Mr=ke.rb[ke.sb-1],mr=Br=0,n(at,Fr,0,384),Ht.Za)var Ka=0,Bs=wt[3];else{Wr=i(16);var Ha=it.Na+Mr.Na;if(Ha=wu(Ot,wt[1],Ha,bt.Eb,0,Wr,0),it.Na=Mr.Na=(0<Ha)+0,1<Ha)DA(Wr,0,at,Fr);else{var Ss=Wr[0]+3>>3;for(Wr=0;256>Wr;Wr+=16)at[Fr+Wr]=Ss}Ka=1,Bs=wt[0]}var Pr=15&it.la,Ms=15&Mr.la;for(Wr=0;4>Wr;++Wr){var Ps=1&Ms;for(Ss=or=0;4>Ss;++Ss)Pr=Pr>>1|(Ps=(Ha=wu(Ot,Bs,Ha=Ps+(1&Pr),bt.Sc,Ka,at,Fr))>Ka)<<7,or=or<<2|(3<Ha?3:1<Ha?2:at[Fr+0]!=0),Fr+=16;Pr>>=4,Ms=Ms>>1|Ps<<7,Br=(Br<<8|or)>>>0}for(Bs=Pr,Ka=Ms>>4,Gr=0;4>Gr;Gr+=2){for(or=0,Pr=it.la>>4+Gr,Ms=Mr.la>>4+Gr,Wr=0;2>Wr;++Wr){for(Ps=1&Ms,Ss=0;2>Ss;++Ss)Ha=Ps+(1&Pr),Pr=Pr>>1|(Ps=0<(Ha=wu(Ot,wt[2],Ha,bt.Qc,0,at,Fr)))<<3,or=or<<2|(3<Ha?3:1<Ha?2:at[Fr+0]!=0),Fr+=16;Pr>>=2,Ms=Ms>>1|Ps<<5}mr|=or<<4*Gr,Bs|=Pr<<4<<Gr,Ka|=(240&Ms)<<Gr}it.la=Bs,Mr.la=Ka,Ht.Hc=Br,Ht.Gc=mr,Ht.ia=43690&mr?0:bt.ia,wt=!(Br|mr)}if(0<ke.L&&(ke.wa[ke.Y+ke.ja]=ke.gd[ze.$b][ze.Za],ke.wa[ke.Y+ke.ja].La|=!wt),rt.Ka)return ha(Le,7,"Premature end-of-file encountered.")}if(li(Le),ke=nt,rt=1,ze=(Fe=Le).D,it=0<Fe.L&&Fe.M>=Fe.zb&&Fe.M<=Fe.Va,Fe.Aa==0)e:{if(ze.M=Fe.M,ze.uc=it,uu(Fe,ze),rt=1,ze=(or=Fe.D).Nb,it=(mr=q0[Fe.L])*Fe.R,Ot=mr/2*Fe.B,Wr=16*ze*Fe.R,Ss=8*ze*Fe.B,wt=Fe.sa,Ht=Fe.ta-it+Wr,bt=Fe.qa,at=Fe.ra-Ot+Ss,Fr=Fe.Ha,Mr=Fe.Ia-Ot+Ss,Ms=(Pr=or.M)==0,Br=Pr>=Fe.Va-1,Fe.Aa==2&&uu(Fe,or),or.uc)for(Ps=(Ha=Fe).D.M,t(Ha.D.uc),or=Ha.yb;or<Ha.Hb;++or){Ka=or,Bs=Ps;var un=(En=(wa=Ha).D).Nb;Gr=wa.R;var En=En.wa[En.Y+Ka],ls=wa.sa,hi=wa.ta+16*un*Gr+16*Ka,to=En.dd,fn=En.tc;if(fn!=0)if(t(3<=fn),wa.L==1)0<Ka&&hl(ls,hi,Gr,fn+4),En.La&&di(ls,hi,Gr,fn),0<Bs&&Cc(ls,hi,Gr,fn+4),En.La&&yu(ls,hi,Gr,fn);else{var ko=wa.B,Bc=wa.qa,MA=wa.ra+8*un*ko+8*Ka,xl=wa.Ha,wa=wa.Ia+8*un*ko+8*Ka;un=En.ld,0<Ka&&(F0(ls,hi,Gr,fn+4,to,un),Ec(Bc,MA,xl,wa,ko,fn+4,to,un)),En.La&&(pl(ls,hi,Gr,fn,to,un),LA(Bc,MA,xl,wa,ko,fn,to,un)),0<Bs&&(jA(ls,hi,Gr,fn+4,to,un),xu(Bc,MA,xl,wa,ko,fn+4,to,un)),En.La&&(bc(ls,hi,Gr,fn,to,un),_c(Bc,MA,xl,wa,ko,fn,to,un))}}if(Fe.ia&&alert("todo:DitherRow"),ke.put!=null){if(or=16*Pr,Pr=16*(Pr+1),Ms?(ke.y=Fe.sa,ke.O=Fe.ta+Wr,ke.f=Fe.qa,ke.N=Fe.ra+Ss,ke.ea=Fe.Ha,ke.W=Fe.Ia+Ss):(or-=mr,ke.y=wt,ke.O=Ht,ke.f=bt,ke.N=at,ke.ea=Fr,ke.W=Mr),Br||(Pr-=mr),Pr>ke.o&&(Pr=ke.o),ke.F=null,ke.J=null,Fe.Fa!=null&&0<Fe.Fa.length&&or<Pr&&(ke.J=Au(Fe,ke,or,Pr-or),ke.F=Fe.mb,ke.F==null&&ke.F.length==0)){rt=ha(Fe,3,"Could not decode alpha data.");break e}or<ke.j&&(mr=ke.j-or,or=ke.j,t(!(1&mr)),ke.O+=Fe.R*mr,ke.N+=Fe.B*(mr>>1),ke.W+=Fe.B*(mr>>1),ke.F!=null&&(ke.J+=ke.width*mr)),or<Pr&&(ke.O+=ke.v,ke.N+=ke.v>>1,ke.W+=ke.v>>1,ke.F!=null&&(ke.J+=ke.v),ke.ka=or-ke.j,ke.U=ke.va-ke.v,ke.T=Pr-or,rt=ke.put(ke))}ze+1!=Fe.Ic||Br||(a(Fe.sa,Fe.ta-it,wt,Ht+16*Fe.R,it),a(Fe.qa,Fe.ra-Ot,bt,at+8*Fe.B,Ot),a(Fe.Ha,Fe.Ia-Ot,Fr,Mr+8*Fe.B,Ot))}if(!rt)return ha(Le,6,"Output aborted.")}return 1}(m,w)),w.bc!=null&&w.bc(w),F&=1}return F?(m.cb=0,F):0}function Rn(m,w,F,q,X){X=m[w+F+32*q]+(X>>3),m[w+F+32*q]=-256&X?0>X?0:255:X}function Bo(m,w,F,q,X,te){Rn(m,w,0,F,q+X),Rn(m,w,1,F,q+te),Rn(m,w,2,F,q-te),Rn(m,w,3,F,q-X)}function An(m){return(20091*m>>16)+m}function hc(m,w,F,q){var X,te=0,ne=i(16);for(X=0;4>X;++X){var ie=m[w+0]+m[w+8],fe=m[w+0]-m[w+8],me=(35468*m[w+4]>>16)-An(m[w+12]),Ie=An(m[w+4])+(35468*m[w+12]>>16);ne[te+0]=ie+Ie,ne[te+1]=fe+me,ne[te+2]=fe-me,ne[te+3]=ie-Ie,te+=4,w++}for(X=te=0;4>X;++X)ie=(m=ne[te+0]+4)+ne[te+8],fe=m-ne[te+8],me=(35468*ne[te+4]>>16)-An(ne[te+12]),Rn(F,q,0,0,ie+(Ie=An(ne[te+4])+(35468*ne[te+12]>>16))),Rn(F,q,1,0,fe+me),Rn(F,q,2,0,fe-me),Rn(F,q,3,0,ie-Ie),te++,q+=32}function mc(m,w,F,q){var X=m[w+0]+4,te=35468*m[w+4]>>16,ne=An(m[w+4]),ie=35468*m[w+1]>>16;Bo(F,q,0,X+ne,m=An(m[w+1]),ie),Bo(F,q,1,X+te,m,ie),Bo(F,q,2,X-te,m,ie),Bo(F,q,3,X-ne,m,ie)}function Zd(m,w,F,q,X){hc(m,w,F,q),X&&hc(m,w+16,F,q+4)}function ll(m,w,F,q){No(m,w+0,F,q,1),No(m,w+32,F,q+128,1)}function Km(m,w,F,q){var X;for(m=m[w+0]+4,X=0;4>X;++X)for(w=0;4>w;++w)Rn(F,q,w,X,m)}function g0(m,w,F,q){m[w+0]&&os(m,w+0,F,q),m[w+16]&&os(m,w+16,F,q+4),m[w+32]&&os(m,w+32,F,q+128),m[w+48]&&os(m,w+48,F,q+128+4)}function Hm(m,w,F,q){var X,te=i(16);for(X=0;4>X;++X){var ne=m[w+0+X]+m[w+12+X],ie=m[w+4+X]+m[w+8+X],fe=m[w+4+X]-m[w+8+X],me=m[w+0+X]-m[w+12+X];te[0+X]=ne+ie,te[8+X]=ne-ie,te[4+X]=me+fe,te[12+X]=me-fe}for(X=0;4>X;++X)ne=(m=te[0+4*X]+3)+te[3+4*X],ie=te[1+4*X]+te[2+4*X],fe=te[1+4*X]-te[2+4*X],me=m-te[3+4*X],F[q+0]=ne+ie>>3,F[q+16]=me+fe>>3,F[q+32]=ne-ie>>3,F[q+48]=me-fe>>3,q+=64}function eu(m,w,F){var q,X=w-32,te=Us,ne=255-m[X-1];for(q=0;q<F;++q){var ie,fe=te,me=ne+m[w-1];for(ie=0;ie<F;++ie)m[w+ie]=fe[me+m[X+ie]];w+=32}}function Gm(m,w){eu(m,w,4)}function zm(m,w){eu(m,w,8)}function Vm(m,w){eu(m,w,16)}function So(m,w){var F;for(F=0;16>F;++F)a(m,w+32*F,m,w-32,16)}function EA(m,w){var F;for(F=16;0<F;--F)n(m,w,m[w-1],16),w+=32}function bA(m,w,F){var q;for(q=0;16>q;++q)n(w,F+32*q,m,16)}function x0(m,w){var F,q=16;for(F=0;16>F;++F)q+=m[w-1+32*F]+m[w+F-32];bA(q>>5,m,w)}function kn(m,w){var F,q=8;for(F=0;16>F;++F)q+=m[w-1+32*F];bA(q>>4,m,w)}function $m(m,w){var F,q=8;for(F=0;16>F;++F)q+=m[w+F-32];bA(q>>4,m,w)}function y0(m,w){bA(128,m,w)}function Zt(m,w,F){return m+2*w+F+2>>2}function Ym(m,w){var F,q=w-32;for(q=new Uint8Array([Zt(m[q-1],m[q+0],m[q+1]),Zt(m[q+0],m[q+1],m[q+2]),Zt(m[q+1],m[q+2],m[q+3]),Zt(m[q+2],m[q+3],m[q+4])]),F=0;4>F;++F)a(m,w+32*F,q,0,q.length)}function Wm(m,w){var F=m[w-1],q=m[w-1+32],X=m[w-1+64],te=m[w-1+96];ve(m,w+0,16843009*Zt(m[w-1-32],F,q)),ve(m,w+32,16843009*Zt(F,q,X)),ve(m,w+64,16843009*Zt(q,X,te)),ve(m,w+96,16843009*Zt(X,te,te))}function Ji(m,w){var F,q=4;for(F=0;4>F;++F)q+=m[w+F-32]+m[w-1+32*F];for(q>>=3,F=0;4>F;++F)n(m,w+32*F,q,4)}function v0(m,w){var F=m[w-1+0],q=m[w-1+32],X=m[w-1+64],te=m[w-1-32],ne=m[w+0-32],ie=m[w+1-32],fe=m[w+2-32],me=m[w+3-32];m[w+0+96]=Zt(q,X,m[w-1+96]),m[w+1+96]=m[w+0+64]=Zt(F,q,X),m[w+2+96]=m[w+1+64]=m[w+0+32]=Zt(te,F,q),m[w+3+96]=m[w+2+64]=m[w+1+32]=m[w+0+0]=Zt(ne,te,F),m[w+3+64]=m[w+2+32]=m[w+1+0]=Zt(ie,ne,te),m[w+3+32]=m[w+2+0]=Zt(fe,ie,ne),m[w+3+0]=Zt(me,fe,ie)}function w0(m,w){var F=m[w+1-32],q=m[w+2-32],X=m[w+3-32],te=m[w+4-32],ne=m[w+5-32],ie=m[w+6-32],fe=m[w+7-32];m[w+0+0]=Zt(m[w+0-32],F,q),m[w+1+0]=m[w+0+32]=Zt(F,q,X),m[w+2+0]=m[w+1+32]=m[w+0+64]=Zt(q,X,te),m[w+3+0]=m[w+2+32]=m[w+1+64]=m[w+0+96]=Zt(X,te,ne),m[w+3+32]=m[w+2+64]=m[w+1+96]=Zt(te,ne,ie),m[w+3+64]=m[w+2+96]=Zt(ne,ie,fe),m[w+3+96]=Zt(ie,fe,fe)}function _A(m,w){var F=m[w-1+0],q=m[w-1+32],X=m[w-1+64],te=m[w-1-32],ne=m[w+0-32],ie=m[w+1-32],fe=m[w+2-32],me=m[w+3-32];m[w+0+0]=m[w+1+64]=te+ne+1>>1,m[w+1+0]=m[w+2+64]=ne+ie+1>>1,m[w+2+0]=m[w+3+64]=ie+fe+1>>1,m[w+3+0]=fe+me+1>>1,m[w+0+96]=Zt(X,q,F),m[w+0+64]=Zt(q,F,te),m[w+0+32]=m[w+1+96]=Zt(F,te,ne),m[w+1+32]=m[w+2+96]=Zt(te,ne,ie),m[w+2+32]=m[w+3+96]=Zt(ne,ie,fe),m[w+3+32]=Zt(ie,fe,me)}function tu(m,w){var F=m[w+0-32],q=m[w+1-32],X=m[w+2-32],te=m[w+3-32],ne=m[w+4-32],ie=m[w+5-32],fe=m[w+6-32],me=m[w+7-32];m[w+0+0]=F+q+1>>1,m[w+1+0]=m[w+0+64]=q+X+1>>1,m[w+2+0]=m[w+1+64]=X+te+1>>1,m[w+3+0]=m[w+2+64]=te+ne+1>>1,m[w+0+32]=Zt(F,q,X),m[w+1+32]=m[w+0+96]=Zt(q,X,te),m[w+2+32]=m[w+1+96]=Zt(X,te,ne),m[w+3+32]=m[w+2+96]=Zt(te,ne,ie),m[w+3+64]=Zt(ne,ie,fe),m[w+3+96]=Zt(ie,fe,me)}function Xm(m,w){var F=m[w-1+0],q=m[w-1+32],X=m[w-1+64],te=m[w-1+96];m[w+0+0]=F+q+1>>1,m[w+2+0]=m[w+0+32]=q+X+1>>1,m[w+2+32]=m[w+0+64]=X+te+1>>1,m[w+1+0]=Zt(F,q,X),m[w+3+0]=m[w+1+32]=Zt(q,X,te),m[w+3+32]=m[w+1+64]=Zt(X,te,te),m[w+3+64]=m[w+2+64]=m[w+0+96]=m[w+1+96]=m[w+2+96]=m[w+3+96]=te}function Jm(m,w){var F=m[w-1+0],q=m[w-1+32],X=m[w-1+64],te=m[w-1+96],ne=m[w-1-32],ie=m[w+0-32],fe=m[w+1-32],me=m[w+2-32];m[w+0+0]=m[w+2+32]=F+ne+1>>1,m[w+0+32]=m[w+2+64]=q+F+1>>1,m[w+0+64]=m[w+2+96]=X+q+1>>1,m[w+0+96]=te+X+1>>1,m[w+3+0]=Zt(ie,fe,me),m[w+2+0]=Zt(ne,ie,fe),m[w+1+0]=m[w+3+32]=Zt(F,ne,ie),m[w+1+32]=m[w+3+64]=Zt(q,F,ne),m[w+1+64]=m[w+3+96]=Zt(X,q,F),m[w+1+96]=Zt(te,X,q)}function Zm(m,w){var F;for(F=0;8>F;++F)a(m,w+32*F,m,w-32,8)}function ru(m,w){var F;for(F=0;8>F;++F)n(m,w,m[w-1],8),w+=32}function gc(m,w,F){var q;for(q=0;8>q;++q)n(w,F+32*q,m,8)}function cl(m,w){var F,q=8;for(F=0;8>F;++F)q+=m[w+F-32]+m[w-1+32*F];gc(q>>4,m,w)}function eg(m,w){var F,q=4;for(F=0;8>F;++F)q+=m[w+F-32];gc(q>>3,m,w)}function xc(m,w){var F,q=4;for(F=0;8>F;++F)q+=m[w-1+32*F];gc(q>>3,m,w)}function au(m,w){gc(128,m,w)}function CA(m,w,F){var q=m[w-F],X=m[w+0],te=3*(X-q)+ig[1020+m[w-2*F]-m[w+F]],ne=k0[112+(te+4>>3)];m[w-F]=Us[255+q+k0[112+(te+3>>3)]],m[w+0]=Us[255+X-ne]}function E0(m,w,F,q){var X=m[w+0],te=m[w+F];return fi[255+m[w-2*F]-m[w-F]]>q||fi[255+te-X]>q}function b0(m,w,F,q){return 4*fi[255+m[w-F]-m[w+0]]+fi[255+m[w-2*F]-m[w+F]]<=q}function _0(m,w,F,q,X){var te=m[w-3*F],ne=m[w-2*F],ie=m[w-F],fe=m[w+0],me=m[w+F],Ie=m[w+2*F],qe=m[w+3*F];return 4*fi[255+ie-fe]+fi[255+ne-me]>q?0:fi[255+m[w-4*F]-te]<=X&&fi[255+te-ne]<=X&&fi[255+ne-ie]<=X&&fi[255+qe-Ie]<=X&&fi[255+Ie-me]<=X&&fi[255+me-fe]<=X}function C0(m,w,F,q){var X=2*q+1;for(q=0;16>q;++q)b0(m,w+q,F,X)&&CA(m,w+q,F)}function Zi(m,w,F,q){var X=2*q+1;for(q=0;16>q;++q)b0(m,w+q*F,1,X)&&CA(m,w+q*F,1)}function To(m,w,F,q){var X;for(X=3;0<X;--X)C0(m,w+=4*F,F,q)}function tg(m,w,F,q){var X;for(X=3;0<X;--X)Zi(m,w+=4,F,q)}function Al(m,w,F,q,X,te,ne,ie){for(te=2*te+1;0<X--;){if(_0(m,w,F,te,ne))if(E0(m,w,F,ie))CA(m,w,F);else{var fe=m,me=w,Ie=F,qe=fe[me-2*Ie],Ke=fe[me-Ie],Le=fe[me+0],nt=fe[me+Ie],ze=fe[me+2*Ie],Fe=27*(rt=ig[1020+3*(Le-Ke)+ig[1020+qe-nt]])+63>>7,ke=18*rt+63>>7,rt=9*rt+63>>7;fe[me-3*Ie]=Us[255+fe[me-3*Ie]+rt],fe[me-2*Ie]=Us[255+qe+ke],fe[me-Ie]=Us[255+Ke+Fe],fe[me+0]=Us[255+Le-Fe],fe[me+Ie]=Us[255+nt-ke],fe[me+2*Ie]=Us[255+ze-rt]}w+=q}}function Fi(m,w,F,q,X,te,ne,ie){for(te=2*te+1;0<X--;){if(_0(m,w,F,te,ne))if(E0(m,w,F,ie))CA(m,w,F);else{var fe=m,me=w,Ie=F,qe=fe[me-Ie],Ke=fe[me+0],Le=fe[me+Ie],nt=k0[112+((ze=3*(Ke-qe))+4>>3)],ze=k0[112+(ze+3>>3)],Fe=nt+1>>1;fe[me-2*Ie]=Us[255+fe[me-2*Ie]+Fe],fe[me-Ie]=Us[255+qe+ze],fe[me+0]=Us[255+Ke-nt],fe[me+Ie]=Us[255+Le-Fe]}w+=q}}function nu(m,w,F,q,X,te){Al(m,w,F,1,16,q,X,te)}function yc(m,w,F,q,X,te){Al(m,w,1,F,16,q,X,te)}function rg(m,w,F,q,X,te){var ne;for(ne=3;0<ne;--ne)Fi(m,w+=4*F,F,1,16,q,X,te)}function BA(m,w,F,q,X,te){var ne;for(ne=3;0<ne;--ne)Fi(m,w+=4,1,F,16,q,X,te)}function ag(m,w,F,q,X,te,ne,ie){Al(m,w,X,1,8,te,ne,ie),Al(F,q,X,1,8,te,ne,ie)}function su(m,w,F,q,X,te,ne,ie){Al(m,w,1,X,8,te,ne,ie),Al(F,q,1,X,8,te,ne,ie)}function iu(m,w,F,q,X,te,ne,ie){Fi(m,w+4*X,X,1,8,te,ne,ie),Fi(F,q+4*X,X,1,8,te,ne,ie)}function B0(m,w,F,q,X,te,ne,ie){Fi(m,w+4,1,X,8,te,ne,ie),Fi(F,q+4,1,X,8,te,ne,ie)}function SA(){this.ba=new as,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ur,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ou(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function lu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function S0(){this.ua=0,this.Wa=new ce,this.vb=new ce,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new N,this.yc=new R}function ng(){this.xb=this.a=0,this.l=new oi,this.ca=new as,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new S0,this.ab=0,this.gc=o(4,lu),this.Oc=0}function TA(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new oi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vc(m,w,F,q,X,te,ne){for(m=m==null?0:m[w+0],w=0;w<ne;++w)X[te+w]=m+F[q+w]&255,m=X[te+w]}function cu(m,w,F,q,X,te,ne){var ie;if(m==null)vc(null,null,F,q,X,te,ne);else for(ie=0;ie<ne;++ie)X[te+ie]=m[w+ie]+F[q+ie]&255}function dl(m,w,F,q,X,te,ne){if(m==null)vc(null,null,F,q,X,te,ne);else{var ie,fe=m[w+0],me=fe,Ie=fe;for(ie=0;ie<ne;++ie)me=Ie+(fe=m[w+ie])-me,Ie=F[q+ie]+(-256&me?0>me?0:255:me)&255,me=fe,X[te+ie]=Ie}}function Au(m,w,F,q){var X=w.width,te=w.o;if(t(m!=null&&w!=null),0>F||0>=q||F+q>te)return null;if(!m.Cc){if(m.ga==null){var ne;if(m.ga=new TA,(ne=m.ga==null)||(ne=w.width*w.o,t(m.Gb.length==0),m.Gb=i(ne),m.Uc=0,m.Gb==null?ne=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,ne=1),ne=!ne),!ne){ne=m.ga;var ie=m.Fa,fe=m.P,me=m.qc,Ie=m.mb,qe=m.nb,Ke=fe+1,Le=me-1,nt=ne.l;if(t(ie!=null&&Ie!=null&&w!=null),gl[0]=null,gl[1]=vc,gl[2]=cu,gl[3]=dl,ne.ca=Ie,ne.tb=qe,ne.c=w.width,ne.i=w.height,t(0<ne.c&&0<ne.i),1>=me)w=0;else if(ne.$a=ie[fe+0]>>0&3,ne.Z=ie[fe+0]>>2&3,ne.Lc=ie[fe+0]>>4&3,fe=ie[fe+0]>>6&3,0>ne.$a||1<ne.$a||4<=ne.Z||1<ne.Lc||fe)w=0;else if(nt.put=vs,nt.ac=xa,nt.bc=ws,nt.ma=ne,nt.width=w.width,nt.height=w.height,nt.Da=w.Da,nt.v=w.v,nt.va=w.va,nt.j=w.j,nt.o=w.o,ne.$a)e:{t(ne.$a==1),w=Pe();t:for(;;){if(w==null){w=0;break e}if(t(ne!=null),ne.mc=w,w.c=ne.c,w.i=ne.i,w.l=ne.l,w.l.ma=ne,w.l.width=ne.c,w.l.height=ne.i,w.a=0,ee(w.m,ie,Ke,Le),!Ce(ne.c,ne.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&ae(w.s)?(ne.ic=1,ie=w.c*w.i,w.Ta=null,w.Ua=0,w.V=i(ie),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ne.ic=0,w=De(w,ne.c)),!w))break t;w=1;break e}ne.mc=null,w=0}else w=Le>=ne.c*ne.i;ne=!w}if(ne)return null;m.ga.Lc!=1?m.Ga=0:q=te-F}t(m.ga!=null),t(F+q<=te);e:{if(w=(ie=m.ga).c,te=ie.l.o,ie.$a==0){if(Ke=m.rc,Le=m.Vc,nt=m.Fa,fe=m.P+1+F*w,me=m.mb,Ie=m.nb+F*w,t(fe<=m.P+m.qc),ie.Z!=0)for(t(gl[ie.Z]!=null),ne=0;ne<q;++ne)gl[ie.Z](Ke,Le,nt,fe,me,Ie,w),Ke=me,Le=Ie,Ie+=w,fe+=w;else for(ne=0;ne<q;++ne)a(me,Ie,nt,fe,w),Ke=me,Le=Ie,Ie+=w,fe+=w;m.rc=Ke,m.Vc=Le}else{if(t(ie.mc!=null),w=F+q,t((ne=ie.mc)!=null),t(w<=ne.i),ne.C>=w)w=1;else if(ie.ic||Qe(),ie.ic){ie=ne.V,Ke=ne.Ba,Le=ne.c;var ze=ne.i,Fe=(nt=1,fe=ne.$/Le,me=ne.$%Le,Ie=ne.m,qe=ne.s,ne.$),ke=Le*ze,rt=Le*w,it=qe.wc,at=Fe<rt?ge(qe,me,fe):null;t(Fe<=ke),t(w<=ze),t(ae(qe));t:for(;;){for(;!Ie.h&&Fe<rt;){if(me&it||(at=ge(qe,me,fe)),t(at!=null),W(Ie),256>(ze=Za(at.G[0],at.H[0],Ie)))ie[Ke+Fe]=ze,++Fe,++me>=Le&&(me=0,++fe<=w&&!(fe%16)&&oe(ne,fe));else{if(!(280>ze)){nt=0;break t}ze=ns(ze-256,Ie);var Ot,wt=Za(at.G[4],at.H[4],Ie);if(W(Ie),!(Fe>=(wt=Ja(Le,wt=ns(wt,Ie)))&&ke-Fe>=ze)){nt=0;break t}for(Ot=0;Ot<ze;++Ot)ie[Ke+Fe+Ot]=ie[Ke+Fe+Ot-wt];for(Fe+=ze,me+=ze;me>=Le;)me-=Le,++fe<=w&&!(fe%16)&&oe(ne,fe);Fe<rt&&me&it&&(at=ge(qe,me,fe))}t(Ie.h==j(Ie))}oe(ne,fe>w?w:fe);break t}!nt||Ie.h&&Fe<ke?(nt=0,ne.a=Ie.h?5:3):ne.$=Fe,w=nt}else w=de(ne,ne.V,ne.Ba,ne.c,ne.i,w,Me);if(!w){q=0;break e}}F+q>=te&&(m.Cc=1),q=1}if(!q)return null;if(m.Cc&&((q=m.ga)!=null&&(q.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+F*X}function T(m,w,F,q,X,te){for(;0<X--;){var ne,ie=m,fe=w+(F?1:0),me=m,Ie=w+(F?0:3);for(ne=0;ne<q;++ne){var qe=me[Ie+4*ne];qe!=255&&(qe*=32897,ie[fe+4*ne+0]=ie[fe+4*ne+0]*qe>>23,ie[fe+4*ne+1]=ie[fe+4*ne+1]*qe>>23,ie[fe+4*ne+2]=ie[fe+4*ne+2]*qe>>23)}w+=te}}function J(m,w,F,q,X){for(;0<q--;){var te;for(te=0;te<F;++te){var ne=m[w+2*te+0],ie=15&(me=m[w+2*te+1]),fe=4369*ie,me=(240&me|me>>4)*fe>>16;m[w+2*te+0]=(240&ne|ne>>4)*fe>>16&240|(15&ne|ne<<4)*fe>>16>>4&15,m[w+2*te+1]=240&me|ie}w+=X}}function xe(m,w,F,q,X,te,ne,ie){var fe,me,Ie=255;for(me=0;me<X;++me){for(fe=0;fe<q;++fe){var qe=m[w+fe];te[ne+4*fe]=qe,Ie&=qe}w+=F,ne+=ie}return Ie!=255}function Se(m,w,F,q,X){var te;for(te=0;te<X;++te)F[q+te]=m[w+te]>>8}function Qe(){ui=T,ra=J,aa=xe,Na=Se}function Xe(m,w,F){O[m]=function(q,X,te,ne,ie,fe,me,Ie,qe,Ke,Le,nt,ze,Fe,ke,rt,it){var at,Ot=it-1>>1,wt=ie[fe+0]|me[Ie+0]<<16,Ht=qe[Ke+0]|Le[nt+0]<<16;t(q!=null);var bt=3*wt+Ht+131074>>2;for(w(q[X+0],255&bt,bt>>16,ze,Fe),te!=null&&(bt=3*Ht+wt+131074>>2,w(te[ne+0],255&bt,bt>>16,ke,rt)),at=1;at<=Ot;++at){var Fr=ie[fe+at]|me[Ie+at]<<16,Mr=qe[Ke+at]|Le[nt+at]<<16,Br=wt+Fr+Ht+Mr+524296,mr=Br+2*(Fr+Ht)>>3;bt=mr+wt>>1,wt=(Br=Br+2*(wt+Mr)>>3)+Fr>>1,w(q[X+2*at-1],255&bt,bt>>16,ze,Fe+(2*at-1)*F),w(q[X+2*at-0],255&wt,wt>>16,ze,Fe+(2*at-0)*F),te!=null&&(bt=Br+Ht>>1,wt=mr+Mr>>1,w(te[ne+2*at-1],255&bt,bt>>16,ke,rt+(2*at-1)*F),w(te[ne+2*at+0],255&wt,wt>>16,ke,rt+(2*at+0)*F)),wt=Fr,Ht=Mr}1&it||(bt=3*wt+Ht+131074>>2,w(q[X+it-1],255&bt,bt>>16,ze,Fe+(it-1)*F),te!=null&&(bt=3*Ht+wt+131074>>2,w(te[ne+it-1],255&bt,bt>>16,ke,rt+(it-1)*F)))}}function lt(){pi[D0]=XS,pi[j0]=ov,pi[rv]=JS,pi[L0]=lv,pi[U0]=cv,pi[og]=Av,pi[av]=ZS,pi[lg]=ov,pi[cg]=lv,pi[M0]=cv,pi[Ag]=Av}function Tt(m){return m&-16384?0>m?0:255:m>>eT}function Mt(m,w){return Tt((19077*m>>8)+(26149*w>>8)-14234)}function sr(m,w,F){return Tt((19077*m>>8)-(6419*w>>8)-(13320*F>>8)+8708)}function er(m,w){return Tt((19077*m>>8)+(33050*w>>8)-17685)}function br(m,w,F,q,X){q[X+0]=Mt(m,F),q[X+1]=sr(m,w,F),q[X+2]=er(m,w)}function ma(m,w,F,q,X){q[X+0]=er(m,w),q[X+1]=sr(m,w,F),q[X+2]=Mt(m,F)}function va(m,w,F,q,X){var te=sr(m,w,F);w=te<<3&224|er(m,w)>>3,q[X+0]=248&Mt(m,F)|te>>5,q[X+1]=w}function qa(m,w,F,q,X){var te=240&er(m,w)|15;q[X+0]=240&Mt(m,F)|sr(m,w,F)>>4,q[X+1]=te}function Dn(m,w,F,q,X){q[X+0]=255,br(m,w,F,q,X+1)}function dn(m,w,F,q,X){ma(m,w,F,q,X),q[X+3]=255}function Ri(m,w,F,q,X){br(m,w,F,q,X),q[X+3]=255}function Ls(m,w){return 0>m?0:m>w?w:m}function eo(m,w,F){O[m]=function(q,X,te,ne,ie,fe,me,Ie,qe){for(var Ke=Ie+(-2&qe)*F;Ie!=Ke;)w(q[X+0],te[ne+0],ie[fe+0],me,Ie),w(q[X+1],te[ne+0],ie[fe+0],me,Ie+F),X+=2,++ne,++fe,Ie+=2*F;1&qe&&w(q[X+0],te[ne+0],ie[fe+0],me,Ie)}}function T0(m,w,F){return F==0?m==0?w==0?6:5:w==0?4:0:F}function du(m,w,F,q,X){switch(m>>>30){case 3:No(w,F,q,X,0);break;case 2:Ia(w,F,q,X);break;case 1:os(w,F,q,X)}}function uu(m,w){var F,q,X=w.M,te=w.Nb,ne=m.oc,ie=m.pc+40,fe=m.oc,me=m.pc+584,Ie=m.oc,qe=m.pc+600;for(F=0;16>F;++F)ne[ie+32*F-1]=129;for(F=0;8>F;++F)fe[me+32*F-1]=129,Ie[qe+32*F-1]=129;for(0<X?ne[ie-1-32]=fe[me-1-32]=Ie[qe-1-32]=129:(n(ne,ie-32-1,127,21),n(fe,me-32-1,127,9),n(Ie,qe-32-1,127,9)),q=0;q<m.za;++q){var Ke=w.ya[w.aa+q];if(0<q){for(F=-1;16>F;++F)a(ne,ie+32*F-4,ne,ie+32*F+12,4);for(F=-1;8>F;++F)a(fe,me+32*F-4,fe,me+32*F+4,4),a(Ie,qe+32*F-4,Ie,qe+32*F+4,4)}var Le=m.Gd,nt=m.Hd+q,ze=Ke.ad,Fe=Ke.Hc;if(0<X&&(a(ne,ie-32,Le[nt].y,0,16),a(fe,me-32,Le[nt].f,0,8),a(Ie,qe-32,Le[nt].ea,0,8)),Ke.Za){var ke=ne,rt=ie-32+16;for(0<X&&(q>=m.za-1?n(ke,rt,Le[nt].y[15],4):a(ke,rt,Le[nt+1].y,0,4)),F=0;4>F;F++)ke[rt+128+F]=ke[rt+256+F]=ke[rt+384+F]=ke[rt+0+F];for(F=0;16>F;++F,Fe<<=2)ke=ne,rt=ie+uv[F],ki[Ke.Ob[F]](ke,rt),du(Fe,ze,16*+F,ke,rt)}else if(ke=T0(q,X,Ke.Ob[0]),ml[ke](ne,ie),Fe!=0)for(F=0;16>F;++F,Fe<<=2)du(Fe,ze,16*+F,ne,ie+uv[F]);for(F=Ke.Gc,ke=T0(q,X,Ke.Dd),Ro[ke](fe,me),Ro[ke](Ie,qe),Fe=ze,ke=fe,rt=me,255&(Ke=F>>0)&&(170&Ke?gu(Fe,256,ke,rt):Ai(Fe,256,ke,rt)),Ke=Ie,Fe=qe,255&(F>>=8)&&(170&F?gu(ze,320,Ke,Fe):Ai(ze,320,Ke,Fe)),X<m.Ub-1&&(a(Le[nt].y,0,ne,ie+480,16),a(Le[nt].f,0,fe,me+224,8),a(Le[nt].ea,0,Ie,qe+224,8)),F=8*te*m.B,Le=m.sa,nt=m.ta+16*q+16*te*m.R,ze=m.qa,Ke=m.ra+8*q+F,Fe=m.Ha,ke=m.Ia+8*q+F,F=0;16>F;++F)a(Le,nt+F*m.R,ne,ie+32*F,16);for(F=0;8>F;++F)a(ze,Ke+F*m.B,fe,me+32*F,8),a(Fe,ke+F*m.B,Ie,qe+32*F,8)}}function OA(m,w,F,q,X,te,ne,ie,fe){var me=[0],Ie=[0],qe=0,Ke=fe!=null?fe.kd:0,Le=fe??new ou;if(m==null||12>F)return 7;Le.data=m,Le.w=w,Le.ha=F,w=[w],F=[F],Le.gb=[Le.gb];e:{var nt=w,ze=F,Fe=Le.gb;if(t(m!=null),t(ze!=null),t(Fe!=null),Fe[0]=0,12<=ze[0]&&!r(m,nt[0],"RIFF")){if(r(m,nt[0]+8,"WEBP")){Fe=3;break e}var ke=He(m,nt[0]+4);if(12>ke||4294967286<ke){Fe=3;break e}if(Ke&&ke>ze[0]-8){Fe=7;break e}Fe[0]=ke,nt[0]+=12,ze[0]-=12}Fe=0}if(Fe!=0)return Fe;for(ke=0<Le.gb[0],F=F[0];;){e:{var rt=m;ze=w,Fe=F;var it=me,at=Ie,Ot=nt=[0];if((bt=qe=[qe])[0]=0,8>Fe[0])Fe=7;else{if(!r(rt,ze[0],"VP8X")){if(He(rt,ze[0]+4)!=10){Fe=3;break e}if(18>Fe[0]){Fe=7;break e}var wt=He(rt,ze[0]+8),Ht=1+se(rt,ze[0]+12);if(2147483648<=Ht*(rt=1+se(rt,ze[0]+15))){Fe=3;break e}Ot!=null&&(Ot[0]=wt),it!=null&&(it[0]=Ht),at!=null&&(at[0]=rt),ze[0]+=18,Fe[0]-=18,bt[0]=1}Fe=0}}if(qe=qe[0],nt=nt[0],Fe!=0)return Fe;if(ze=!!(2&nt),!ke&&qe)return 3;if(te!=null&&(te[0]=!!(16&nt)),ne!=null&&(ne[0]=ze),ie!=null&&(ie[0]=0),ne=me[0],nt=Ie[0],qe&&ze&&fe==null){Fe=0;break}if(4>F){Fe=7;break}if(ke&&qe||!ke&&!qe&&!r(m,w[0],"ALPH")){F=[F],Le.na=[Le.na],Le.P=[Le.P],Le.Sa=[Le.Sa];e:{wt=m,Fe=w,ke=F;var bt=Le.gb;it=Le.na,at=Le.P,Ot=Le.Sa,Ht=22,t(wt!=null),t(ke!=null),rt=Fe[0];var Fr=ke[0];for(t(it!=null),t(Ot!=null),it[0]=null,at[0]=null,Ot[0]=0;;){if(Fe[0]=rt,ke[0]=Fr,8>Fr){Fe=7;break e}var Mr=He(wt,rt+4);if(4294967286<Mr){Fe=3;break e}var Br=8+Mr+1&-2;if(Ht+=Br,0<bt&&Ht>bt){Fe=3;break e}if(!r(wt,rt,"VP8 ")||!r(wt,rt,"VP8L")){Fe=0;break e}if(Fr[0]<Br){Fe=7;break e}r(wt,rt,"ALPH")||(it[0]=wt,at[0]=rt+8,Ot[0]=Mr),rt+=Br,Fr-=Br}}if(F=F[0],Le.na=Le.na[0],Le.P=Le.P[0],Le.Sa=Le.Sa[0],Fe!=0)break}F=[F],Le.Ja=[Le.Ja],Le.xa=[Le.xa];e:if(bt=m,Fe=w,ke=F,it=Le.gb[0],at=Le.Ja,Ot=Le.xa,wt=Fe[0],rt=!r(bt,wt,"VP8 "),Ht=!r(bt,wt,"VP8L"),t(bt!=null),t(ke!=null),t(at!=null),t(Ot!=null),8>ke[0])Fe=7;else{if(rt||Ht){if(bt=He(bt,wt+4),12<=it&&bt>it-12){Fe=3;break e}if(Ke&&bt>ke[0]-8){Fe=7;break e}at[0]=bt,Fe[0]+=8,ke[0]-=8,Ot[0]=Ht}else Ot[0]=5<=ke[0]&&bt[wt+0]==47&&!(bt[wt+4]>>5),at[0]=ke[0];Fe=0}if(F=F[0],Le.Ja=Le.Ja[0],Le.xa=Le.xa[0],w=w[0],Fe!=0)break;if(4294967286<Le.Ja)return 3;if(ie==null||ze||(ie[0]=Le.xa?2:1),ne=[ne],nt=[nt],Le.xa){if(5>F){Fe=7;break}ie=ne,Ke=nt,ze=te,m==null||5>F?m=0:5<=F&&m[w+0]==47&&!(m[w+4]>>5)?(ke=[0],bt=[0],it=[0],ee(at=new C,m,w,F),Dt(at,ke,bt,it)?(ie!=null&&(ie[0]=ke[0]),Ke!=null&&(Ke[0]=bt[0]),ze!=null&&(ze[0]=it[0]),m=1):m=0):m=0}else{if(10>F){Fe=7;break}ie=nt,m==null||10>F||!Yr(m,w+3,F-3)?m=0:(Ke=m[w+0]|m[w+1]<<8|m[w+2]<<16,ze=16383&(m[w+7]<<8|m[w+6]),m=16383&(m[w+9]<<8|m[w+8]),1&Ke||3<(Ke>>1&7)||!(Ke>>4&1)||Ke>>5>=Le.Ja||!ze||!m?m=0:(ne&&(ne[0]=ze),ie&&(ie[0]=m),m=1))}if(!m||(ne=ne[0],nt=nt[0],qe&&(me[0]!=ne||Ie[0]!=nt)))return 3;fe!=null&&(fe[0]=Le,fe.offset=w-fe.w,t(4294967286>w-fe.w),t(fe.offset==fe.ha-F));break}return Fe==0||Fe==7&&qe&&fe==null?(te!=null&&(te[0]|=Le.na!=null&&0<Le.na.length),q!=null&&(q[0]=ne),X!=null&&(X[0]=nt),0):Fe}function fu(m,w,F){var q=w.width,X=w.height,te=0,ne=0,ie=q,fe=X;if(w.Da=m!=null&&0<m.Da,w.Da&&(ie=m.cd,fe=m.bd,te=m.v,ne=m.j,11>F||(te&=-2,ne&=-2),0>te||0>ne||0>=ie||0>=fe||te+ie>q||ne+fe>X))return 0;if(w.v=te,w.j=ne,w.va=te+ie,w.o=ne+fe,w.U=ie,w.T=fe,w.da=m!=null&&0<m.da,w.da){if(!Ge(ie,fe,F=[m.ib],te=[m.hb]))return 0;w.ib=F[0],w.hb=te[0]}return w.ob=m!=null&&m.ob,w.Kb=m==null||!m.Sd,w.da&&(w.ob=w.ib<3*q/4&&w.hb<3*X/4,w.Kb=0),1}function pu(m){if(m==null)return 2;if(11>m.S){var w=m.f.RGBA;w.fb+=(m.height-1)*w.A,w.A=-w.A}else w=m.f.kb,m=m.height,w.O+=(m-1)*w.fa,w.fa=-w.fa,w.N+=(m-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(m-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(m-1)*w.lb,w.lb=-w.lb);return 0}function IA(m,w,F,q){if(q==null||0>=m||0>=w)return 2;if(F!=null){if(F.Da){var X=F.cd,te=F.bd,ne=-2&F.v,ie=-2&F.j;if(0>ne||0>ie||0>=X||0>=te||ne+X>m||ie+te>w)return 2;m=X,w=te}if(F.da){if(!Ge(m,w,X=[F.ib],te=[F.hb]))return 2;m=X[0],w=te[0]}}q.width=m,q.height=w;e:{var fe=q.width,me=q.height;if(m=q.S,0>=fe||0>=me||!(m>=D0&&13>m))m=2;else{if(0>=q.Rd&&q.sd==null){ne=te=X=w=0;var Ie=(ie=fe*fv[m])*me;if(11>m||(te=(me+1)/2*(w=(fe+1)/2),m==12&&(ne=(X=fe)*me)),(me=i(Ie+2*te+ne))==null){m=1;break e}q.sd=me,11>m?((fe=q.f.RGBA).eb=me,fe.fb=0,fe.A=ie,fe.size=Ie):((fe=q.f.kb).y=me,fe.O=0,fe.fa=ie,fe.Fd=Ie,fe.f=me,fe.N=0+Ie,fe.Ab=w,fe.Cd=te,fe.ea=me,fe.W=0+Ie+te,fe.Db=w,fe.Ed=te,m==12&&(fe.F=me,fe.J=0+Ie+2*te),fe.Tc=ne,fe.lb=X)}if(w=1,X=q.S,te=q.width,ne=q.height,X>=D0&&13>X)if(11>X)m=q.f.RGBA,w&=(ie=Math.abs(m.A))*(ne-1)+te<=m.size,w&=ie>=te*fv[X],w&=m.eb!=null;else{m=q.f.kb,ie=(te+1)/2,Ie=(ne+1)/2,fe=Math.abs(m.fa),me=Math.abs(m.Ab);var qe=Math.abs(m.Db),Ke=Math.abs(m.lb),Le=Ke*(ne-1)+te;w&=fe*(ne-1)+te<=m.Fd,w&=me*(Ie-1)+ie<=m.Cd,w=(w&=qe*(Ie-1)+ie<=m.Ed)&fe>=te&me>=ie&qe>=ie,w&=m.y!=null,w&=m.f!=null,w&=m.ea!=null,X==12&&(w&=Ke>=te,w&=Le<=m.Tc,w&=m.F!=null)}else w=0;m=w?0:2}}return m!=0||F!=null&&F.fd&&(m=pu(q)),m}var wn=64,NA=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],FA=24,RA=32,hu=8,_s=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];tt("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(m){return m},O.Predictor2=function(m,w,F){return w[F+0]},O.Predictor3=function(m,w,F){return w[F+1]},O.Predictor4=function(m,w,F){return w[F-1]},O.Predictor5=function(m,w,F){return _e(_e(m,w[F+1]),w[F+0])},O.Predictor6=function(m,w,F){return _e(m,w[F-1])},O.Predictor7=function(m,w,F){return _e(m,w[F+0])},O.Predictor8=function(m,w,F){return _e(w[F-1],w[F+0])},O.Predictor9=function(m,w,F){return _e(w[F+0],w[F+1])},O.Predictor10=function(m,w,F){return _e(_e(m,w[F-1]),_e(w[F+0],w[F+1]))},O.Predictor11=function(m,w,F){var q=w[F+0];return 0>=_t(q>>24&255,m>>24&255,(w=w[F-1])>>24&255)+_t(q>>16&255,m>>16&255,w>>16&255)+_t(q>>8&255,m>>8&255,w>>8&255)+_t(255&q,255&m,255&w)?q:m},O.Predictor12=function(m,w,F){var q=w[F+0];return(At((m>>24&255)+(q>>24&255)-((w=w[F-1])>>24&255))<<24|At((m>>16&255)+(q>>16&255)-(w>>16&255))<<16|At((m>>8&255)+(q>>8&255)-(w>>8&255))<<8|At((255&m)+(255&q)-(255&w)))>>>0},O.Predictor13=function(m,w,F){var q=w[F-1];return(Ct((m=_e(m,w[F+0]))>>24&255,q>>24&255)<<24|Ct(m>>16&255,q>>16&255)<<16|Ct(m>>8&255,q>>8&255)<<8|Ct(m>>0&255,q>>0&255))>>>0};var sg=O.PredictorAdd0;O.PredictorAdd1=Et,tt("Predictor2","PredictorAdd2"),tt("Predictor3","PredictorAdd3"),tt("Predictor4","PredictorAdd4"),tt("Predictor5","PredictorAdd5"),tt("Predictor6","PredictorAdd6"),tt("Predictor7","PredictorAdd7"),tt("Predictor8","PredictorAdd8"),tt("Predictor9","PredictorAdd9"),tt("Predictor10","PredictorAdd10"),tt("Predictor11","PredictorAdd11"),tt("Predictor12","PredictorAdd12"),tt("Predictor13","PredictorAdd13");var mu=O.PredictorAdd2;ut("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),ut("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var O0,ci=O.ColorIndexInverseTransform,kA=O.MapARGB,I0=O.VP8LColorIndexInverseTransformAlpha,N0=O.MapAlpha,ul=O.VP8LPredictorsAdd=[];ul.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var wc,Cs,is,fl,Oo,Io,DA,No,Ia,gu,os,Ai,jA,F0,xu,Ec,bc,pl,_c,LA,Cc,hl,yu,di,ui,ra,aa,Na,tn=i(511),Fo=i(2041),vu=i(225),UA=i(767),R0=0,ig=Fo,k0=vu,Us=UA,fi=tn,D0=0,j0=1,rv=2,L0=3,U0=4,og=5,av=6,lg=7,cg=8,M0=9,Ag=10,LS=[2,3,7],US=[3,3,11],nv=[280,256,256,256,40],MS=[0,1,1,1,0],PS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],QS=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],qS=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],KS=8,dg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ug=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],wu=null,HS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],GS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sv=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],zS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],VS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],$S=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],YS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ml=[],ki=[],Ro=[],WS=1,iv=2,gl=[],pi=[];Xe("UpsampleRgbLinePair",br,3),Xe("UpsampleBgrLinePair",ma,3),Xe("UpsampleRgbaLinePair",Ri,4),Xe("UpsampleBgraLinePair",dn,4),Xe("UpsampleArgbLinePair",Dn,4),Xe("UpsampleRgba4444LinePair",qa,2),Xe("UpsampleRgb565LinePair",va,2);var XS=O.UpsampleRgbLinePair,JS=O.UpsampleBgrLinePair,ov=O.UpsampleRgbaLinePair,lv=O.UpsampleBgraLinePair,cv=O.UpsampleArgbLinePair,Av=O.UpsampleRgba4444LinePair,ZS=O.UpsampleRgb565LinePair,P0=16,Q0=1<<P0-1,Eu=-227,fg=482,eT=6,dv=0,tT=i(256),rT=i(256),aT=i(256),nT=i(256),sT=i(fg-Eu),iT=i(fg-Eu);eo("YuvToRgbRow",br,3),eo("YuvToBgrRow",ma,3),eo("YuvToRgbaRow",Ri,4),eo("YuvToBgraRow",dn,4),eo("YuvToArgbRow",Dn,4),eo("YuvToRgba4444Row",qa,2),eo("YuvToRgb565Row",va,2);var uv=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],q0=[0,2,8],oT=[8,7,6,4,4,2,2,2,1,1,1,1],lT=1;this.WebPDecodeRGBA=function(m,w,F,q,X){var te=j0,ne=new SA,ie=new as;ne.ba=ie,ie.S=te,ie.width=[ie.width],ie.height=[ie.height];var fe=ie.width,me=ie.height,Ie=new Ds;if(Ie==null||m==null)var qe=2;else t(Ie!=null),qe=OA(m,w,F,Ie.width,Ie.height,Ie.Pd,Ie.Qd,Ie.format,null);if(qe!=0?fe=0:(fe!=null&&(fe[0]=Ie.width[0]),me!=null&&(me[0]=Ie.height[0]),fe=1),fe){ie.width=ie.width[0],ie.height=ie.height[0],q!=null&&(q[0]=ie.width),X!=null&&(X[0]=ie.height);e:{if(q=new oi,(X=new ou).data=m,X.w=w,X.ha=F,X.kd=1,w=[0],t(X!=null),((m=OA(X.data,X.w,X.ha,null,null,null,w,null,X))==0||m==7)&&w[0]&&(m=4),(w=m)==0){if(t(ne!=null),q.data=X.data,q.w=X.w+X.offset,q.ha=X.ha-X.offset,q.put=vs,q.ac=xa,q.bc=ws,q.ma=ne,X.xa){if((m=Pe())==null){ne=1;break e}if(function(Ke,Le){var nt=[0],ze=[0],Fe=[0];t:for(;;){if(Ke==null)return 0;if(Le==null)return Ke.a=2,0;if(Ke.l=Le,Ke.a=0,ee(Ke.m,Le.data,Le.w,Le.ha),!Dt(Ke.m,nt,ze,Fe)){Ke.a=3;break t}if(Ke.xb=iv,Le.width=nt[0],Le.height=ze[0],!Ce(nt[0],ze[0],1,Ke,null))break t;return 1}return t(Ke.a!=0),0}(m,q)){if(q=(w=IA(q.width,q.height,ne.Oa,ne.ba))==0){t:{q=m;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((F=q.l)!=null),t((X=F.ma)!=null),q.xb!=0){if(q.ca=X.ba,q.tb=X.tb,t(q.ca!=null),!fu(X.Oa,F,L0)){q.a=2;break r}if(!De(q,F.width)||F.da)break r;if((F.da||nr(q.ca.S))&&Qe(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&Qe()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!Ee(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!de(q,q.V,q.Ba,q.c,q.i,F.o,le))break r;X.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(w=m.a)}else w=m.a}else{if((m=new ss)==null){ne=1;break e}if(m.Fa=X.na,m.P=X.P,m.qc=X.Sa,en(m,q)){if((w=IA(q.width,q.height,ne.Oa,ne.ba))==0){if(m.Aa=0,F=ne.Oa,t((X=m)!=null),F!=null){if(0<(fe=0>(fe=F.Md)?0:100<fe?255:255*fe/100)){for(me=Ie=0;4>me;++me)12>(qe=X.pb[me]).lc&&(qe.ia=fe*oT[0>qe.lc?0:qe.lc]>>3),Ie|=qe.ia;Ie&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=F.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}wA(m,q)||(w=m.a)}}else w=m.a}w==0&&ne.Oa!=null&&ne.Oa.fd&&(w=pu(ne.ba))}ne=w}te=ne!=0?null:11>te?ie.f.RGBA.eb:ie.f.kb.y}else te=null;return te};var fv=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(O,_){for(var U="",I=0;I<4;I++)U+=String.fromCharCode(O[_++]);return U}function d(O,_){return(O[_+0]<<0|O[_+1]<<8|O[_+2]<<16)>>>0}function f(O,_){return(O[_+0]<<0|O[_+1]<<8|O[_+2]<<16|O[_+3]<<24)>>>0}new c;var p=[0],u=[0],g=[],h=new c,x=e,y=function(O,_){var U={},I=0,R=!1,L=0,N=0;if(U.frames=[],!function(D,j,K,W){for(var Ae=0;Ae<W;Ae++)if(D[j+Ae]!=K.charCodeAt(Ae))return!0;return!1}(O,_,"RIFF",4)){var P,Q;for(f(O,_+=4),_+=8;_<O.length;){var Y=A(O,_),ee=f(O,_+=4);_+=4;var V=ee+(1&ee);switch(Y){case"VP8 ":case"VP8L":U.frames[I]===void 0&&(U.frames[I]={}),(C=U.frames[I]).src_off=R?N:_-8,C.src_size=L+ee+8,I++,R&&(R=!1,L=0,N=0);break;case"VP8X":(C=U.header={}).feature_flags=O[_];var G=_+4;C.canvas_width=1+d(O,G),G+=3,C.canvas_height=1+d(O,G),G+=3;break;case"ALPH":R=!0,L=V+8,N=_-8;break;case"ANIM":(C=U.header).bgcolor=f(O,_),G=_+4,C.loop_count=(P=O)[(Q=G)+0]<<0|P[Q+1]<<8,G+=2;break;case"ANMF":var z,C;(C=U.frames[I]={}).offset_x=2*d(O,_),_+=3,C.offset_y=2*d(O,_),_+=3,C.width=1+d(O,_),_+=3,C.height=1+d(O,_),_+=3,C.duration=d(O,_),_+=3,z=O[_++],C.dispose=1&z,C.blend=z>>1&1}Y!="ANMF"&&(_+=V)}return U}}(x,0);y.response=x,y.rgbaoutput=!0,y.dataurl=!1;var v=y.header?y.header:null,E=y.frames?y.frames:null;if(v){v.loop_counter=v.loop_count,p=[v.canvas_height],u=[v.canvas_width];for(var k=0;k<E.length&&E[k].blend!=0;k++);}var S=E[0],B=h.WebPDecodeRGBA(x,S.src_off,S.src_size,u,p);S.rgba=B,S.imgwidth=u[0],S.imgheight=p[0];for(var b=0;b<u[0]*p[0]*4;b++)g[b]=B[b];return this.width=u,this.height=p,this.data=g,this}(function(e){var t=function(){return typeof Kx=="function"},r=function(p,u,g,h){var x=4,y=o;switch(h){case e.image_compression.FAST:x=1,y=i;break;case e.image_compression.MEDIUM:x=6,y=l;break;case e.image_compression.SLOW:x=9,y=c}p=a(p,u,g,y);var v=Kx(p,{level:x});return e.__addimage__.arrayBufferToBinaryString(v)},a=function(p,u,g,h){for(var x,y,v,E=p.length/u,k=new Uint8Array(p.length+E),S=d(),B=0;B<E;B+=1){if(v=B*u,x=p.subarray(v,v+u),h)k.set(h(x,g,y),v+B);else{for(var b,O=S.length,_=[];b<O;b+=1)_[b]=S[b](x,g,y);var U=f(_.concat());k.set(_[U],v+B)}y=x}return k},n=function(p){var u=Array.apply([],p);return u.unshift(0),u},i=function(p,u){var g,h=[],x=p.length;h[0]=1;for(var y=0;y<x;y+=1)g=p[y-u]||0,h[y+1]=p[y]-g+256&255;return h},o=function(p,u,g){var h,x=[],y=p.length;x[0]=2;for(var v=0;v<y;v+=1)h=g&&g[v]||0,x[v+1]=p[v]-h+256&255;return x},l=function(p,u,g){var h,x,y=[],v=p.length;y[0]=3;for(var E=0;E<v;E+=1)h=p[E-u]||0,x=g&&g[E]||0,y[E+1]=p[E]+256-(h+x>>>1)&255;return y},c=function(p,u,g){var h,x,y,v,E=[],k=p.length;E[0]=4;for(var S=0;S<k;S+=1)h=p[S-u]||0,x=g&&g[S]||0,y=g&&g[S-u]||0,v=A(h,x,y),E[S+1]=p[S]-v+256&255;return E},A=function(p,u,g){if(p===u&&u===g)return p;var h=Math.abs(u-g),x=Math.abs(p-g),y=Math.abs(p+u-g-g);return h<=x&&h<=y?p:x<=y?u:g},d=function(){return[n,i,o,l,c]},f=function(p){var u=p.map(function(g){return g.reduce(function(h,x){return h+Math.abs(x)},0)});return u.indexOf(Math.min.apply(null,u))};e.processPNG=function(p,u,g,h){var x,y,v,E,k,S,B,b,O,_,U,I,R,L,N,P=this.decode.FLATE_DECODE,Q="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(v=new I9(p)).imgData,y=v.bits,x=v.colorSpace,k=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){O=(b=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,U=new Uint8Array(O*v.colors),_=new Uint8Array(O);var Y,ee=v.pixelBitlength-v.bits;for(L=0,N=0;L<O;L++){for(R=b[L],Y=0;Y<ee;)U[N++]=R>>>Y&255,Y+=v.bits;_[L]=R>>>Y&255}}if(v.bits===16){O=(b=new Uint32Array(v.decodePixels().buffer)).length,U=new Uint8Array(O*(32/v.pixelBitlength)*v.colors),_=new Uint8Array(O*(32/v.pixelBitlength)),I=v.colors>1,L=0,N=0;for(var V=0;L<O;)R=b[L++],U[N++]=R>>>0&255,I&&(U[N++]=R>>>16&255,R=b[L++],U[N++]=R>>>0&255),_[V++]=R>>>16&255;y=8}h!==e.image_compression.NONE&&t()?(p=r(U,v.width*v.colors,v.colors,h),B=r(_,v.width,1,h)):(p=U,B=_,P=void 0)}if(v.colorType===3&&(x=this.color_spaces.INDEXED,S=v.palette,v.transparency.indexed)){var G=v.transparency.indexed,z=0;for(L=0,O=G.length;L<O;++L)z+=G[L];if((z/=255)===O-1&&G.indexOf(0)!==-1)E=[G.indexOf(0)];else if(z!==O){for(b=v.decodePixels(),_=new Uint8Array(b.length),L=0,O=b.length;L<O;L++)_[L]=G[b[L]];B=r(_,v.width,1)}}var C=function(D){var j;switch(D){case e.image_compression.FAST:j=11;break;case e.image_compression.MEDIUM:j=13;break;case e.image_compression.SLOW:j=14;break;default:j=12}return j}(h);return P===this.decode.FLATE_DECODE&&(Q="/Predictor "+C+" "),Q+="/Colors "+k+" /BitsPerComponent "+y+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(B&&this.__addimage__.isArrayBuffer(B)||this.__addimage__.isArrayBufferView(B))&&(B=this.__addimage__.arrayBufferToBinaryString(B)),{alias:g,data:p,index:u,filter:P,decodeParameters:Q,transparency:E,palette:S,sMask:B,predictor:C,width:v.width,height:v.height,bitsPerComponent:y,colorSpace:x}}}})(Vt.API),function(e){e.processGIF89A=function(t,r,a,n){var i=new N9(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},d=new n1(100).encode(A,100);return e.processJPEG.call(this,d,r,a,n)},e.processGIF87A=e.processGIF89A}(Vt.API),Ui.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ui.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Xr.log("bit decode error:"+r)}},Ui.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Ui.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,l=i>>4,c=15&i,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*n+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Ui.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Ui.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,A=i>>15?255:0,d=a*this.width*4+4*n;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=A}this.pos+=e}},Ui.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/t*255|0,d=n*this.width*4+4*i;this.data[d]=A,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},Ui.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Ui.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=o}},Ui.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var i=new Ui(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},A=new n1(100).encode(c,100);return e.processJPEG.call(this,A,r,a,n)}}(Vt.API),Lw.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var i=new Lw(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},A=new n1(100).encode(c,100);return e.processJPEG.call(this,A,r,a,n)}}(Vt.API),Vt.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),l=0,c=0,A=0;A<n;A+=4){var d=a[A],f=a[A+1],p=a[A+2],u=a[A+3];i[l++]=d,i[l++]=f,i[l++]=p,o[c++]=u}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Vt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},YA=Vt.API,wp=YA.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:n.metadata.Unicode.widths,c=l.fof?l.fof:1,A=t.kerning?t.kerning:n.metadata.Unicode.kerning,d=A.fof?A.fof:1,f=t.doKerning!==!1,p=0,u=e.length,g=0,h=l[0]||c,x=[];for(r=0;r<u;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?x.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(p=f&&ea(A[a])==="object"&&!isNaN(parseInt(A[a][g],10))?A[a][g]/d:0,x.push((l[a]||h)/c+p)),g=a;return x},Rw=YA.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return YA.processArabic&&(e=YA.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:wp.apply(this,arguments).reduce(function(i,o){return i+o},0)},kw=function(e,t,r,a){for(var n=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;n.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>a&&(n.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&n.push(e.slice(c,i)),n},Dw=function(e,t,r){r||(r={});var a,n,i,o,l,c,A,d=[],f=[d],p=r.textIndent||0,u=0,g=0,h=e.split(" "),x=wp.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?h[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),v=[];h.map(function(k){(k=k.split(/\s*\n/)).length>1?v=v.concat(k.map(function(S,B){return(B&&S.length?`
`:"")+S})):v.push(k[0])}),h=v,c=Rw.apply(this,[y,r])}for(i=0,o=h.length;i<o;i++){var E=0;if(a=h[i],c&&a[0]==`
`&&(a=a.substr(1),E=1),p+u+(g=(n=wp.apply(this,[a,r])).reduce(function(k,S){return k+S},0))>t||E){if(g>t){for(l=kw.apply(this,[a,n,t-(p+u),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);g=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(k,S){return k+S},0)}else d=[a];f.push(d),p=g+c,u=x}else d.push(a),p+=u+g,u=x}return A=c?function(k,S){return(S?y:"")+k.join(" ")}:function(k){return k.join(" ")},f.map(A)},YA.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=a.length;l<c;l++)A=A.concat(Dw.apply(this,[a[l],o,i]));return A},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},a={},n=0;n<t.length;n++)r[t[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=t[n];var i=function(f){return"0x"+parseInt(f,10).toString(16)},o=e.__fontmetrics__.compress=function(f){var p,u,g,h,x=["{"];for(var y in f){if(p=f[y],isNaN(parseInt(y,10))?u="'"+y+"'":(y=parseInt(y,10),u=(u=i(y).slice(2)).slice(0,-1)+a[u.slice(-1)]),typeof p=="number")p<0?(g=i(p).slice(3),h="-"):(g=i(p).slice(2),h=""),g=h+g.slice(0,-1)+a[g.slice(-1)];else{if(ea(p)!=="object")throw new Error("Don't know what to do with value type "+ea(p)+".");g=o(p)}x.push(u+g)}return x.push("}"),x.join("")},l=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,u,g,h,x={},y=1,v=x,E=[],k="",S="",B=f.length-1,b=1;b<B;b+=1)(h=f[b])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(h):h=="{"?(E.push([v,g]),v={},g=void 0):h=="}"?((u=E.pop())[0][u[1]]=v,g=void 0,v=u[0]):h=="-"?y=-1:g===void 0?r.hasOwnProperty(h)?(k+=r[h],g=parseInt(k,16)*y,y=1,k=""):k+=h:r.hasOwnProperty(h)?(S+=r[h],v[g]=parseInt(S,16)*y,y=1,g=void 0,S=""):S+=h;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var p=f.font,u=d.Unicode[p.postScriptName];u&&(p.metadata.Unicode={},p.metadata.Unicode.widths=u.widths,p.metadata.Unicode.kerning=u.kerning);var g=A.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(Vt.API),function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(gf(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])}(Vt),function(e){function t(){return(Yt.canvg?Promise.resolve(Yt.canvg):ps(()=>import("./index.es-DG3o9-Dj.js"),__vite__mapDeps([2,1,3]))).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Vt.API.addSvgAsImage=function(r,a,n,i,o,l,c,A){if(isNaN(a)||isNaN(n))throw Xr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw Xr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=o;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},u=this;return t().then(function(g){return g.fromString(f,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(p)}).then(function(){u.addImage(d.toDataURL("image/jpeg",1),a,n,i,o,c,A)})}}(),Vt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},Vt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,d=0,f=0;function p(g,h){var x,y=!1;for(x=0;x<g.length;x+=1)g[x]===h&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var u=l.length;for(f=0;f<u;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(ea(e)==="object"){for(n in e)if(i=e[n],p(l,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&p(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(A=0;A<i.length;A+=1)if(a=!0,i[A].length===1&&typeof i[A][0]=="number")c.push(String(i[A]-1));else if(i[A].length>1){for(d=0;d<i[A].length;d+=1)typeof i[A][d]!="number"&&(a=!1);a===!0&&c.push([i[A][0]-1,i[A][1]-1].join(" "))}r[n].value="["+c.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,h=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?h.push("/"+g+" /"+r[g].value):h.push("/"+g+" "+r[g].value));h.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+h.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=i.length+o.length+l.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Vt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],d=[""],f=0,p=i.length;f<p;++f){if(l=o.metadata.characterToGlyph(i.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(A[4-l.length],l)}return d.join("")},a=function(i){var o,l,c,A,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,p=(l=Object.keys(i).sort(function(u,g){return u-g})).length;f<p;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(A=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,A=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,p=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),u="",g=0;g<p.length;g++)u+=String.fromCharCode(p[g]);var h=A();d({data:u,addLength1:!0,objectId:h}),c("endobj");var x=A();d({data:a(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var y=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+hd(l.fontName)),c("/FontFile2 "+h+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+hd(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+hd(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,A=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,p="",u=0;u<f.length;u++)p+=String.fromCharCode(f[u]);var g=A();d({data:p,addLength1:!0,objectId:g}),c("endobj");var h=A();d({data:a(l.metadata.toUnicode),addLength1:!0,objectId:h}),c("endobj");var x=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+hd(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+hd(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,l=i.text||"",c=i.x,A=i.y,d=i.options||{},f=i.mutex||{},p=f.pdfEscape,u=f.activeFontKey,g=f.fonts,h=u,x="",y=0,v="",E=g[h].encoding;if(g[h].encoding!=="Identity-H")return{text:l,x:c,y:A,options:d,mutex:f};for(v=l,h=u,Array.isArray(l)&&(v=l[0]),y=0;y<v.length;y+=1)g[h].metadata.hasOwnProperty("cmap")&&(o=g[h].metadata.cmap.unicode.codeMap[v[y].charCodeAt(0)]),o||v[y].charCodeAt(0)<256&&g[h].metadata.hasOwnProperty("Unicode")?x+=v[y]:x+="";var k="";return parseInt(h.slice(1))<14||E==="WinAnsiEncoding"?k=p(x,h).split("").map(function(S){return S.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(k=r(x,g[h])),f.isHex=!0,{text:k,x:c,y:A,options:d,mutex:f}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([n(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(n(Object.assign({},c,{text:o[A]})).text);i.text=l}else i.text=n(Object.assign({},c,{text:o})).text}])}(Vt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Vt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,i,o,l,c,A,d,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},h={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,E=0;this.__bidiEngine__={};var k=function(I){var R=I.charCodeAt(),L=R>>8,N=h[L];return N!==void 0?f[256*N+(255&R)]:L===252||L===253?"AL":y.test(L)?"L":L===8?"R":"N"},S=function(I){for(var R,L=0;L<I.length;L++){if((R=k(I.charAt(L)))==="L")return!1;if(R==="R")return!0}return!1},B=function(I,R,L,N){var P,Q,Y,ee,V=R[N];switch(V){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(V="AN");break;case"AL":v=!0,V="R";break;case"WS":V="N";break;case"CS":N<1||N+1>=R.length||(P=L[N-1])!=="EN"&&P!=="AN"||(Q=R[N+1])!=="EN"&&Q!=="AN"?V="N":v&&(Q="AN"),V=Q===P?Q:"N";break;case"ES":V=(P=N>0?L[N-1]:"B")==="EN"&&N+1<R.length&&R[N+1]==="EN"?"EN":"N";break;case"ET":if(N>0&&L[N-1]==="EN"){V="EN";break}if(v){V="N";break}for(Y=N+1,ee=R.length;Y<ee&&R[Y]==="ET";)Y++;V=Y<ee&&R[Y]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ee=R.length,Y=N+1;Y<ee&&R[Y]==="NSM";)Y++;if(Y<ee){var G=I[N],z=G>=1425&&G<=2303||G===64286;if(P=R[Y],z&&(P==="R"||P==="AL")){V="R";break}}}V=N<1||(P=R[N-1])==="B"?"N":L[N-1];break;case"B":v=!1,n=!0,V=E;break;case"S":i=!0,V="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":V="N"}return V},b=function(I,R,L){var N=I.split("");return L&&O(N,L,{hiLevel:E}),N.reverse(),R&&R.reverse(),N.join("")},O=function(I,R,L){var N,P,Q,Y,ee,V=-1,G=I.length,z=0,C=[],D=E?u:p,j=[];for(v=!1,n=!1,i=!1,P=0;P<G;P++)j[P]=k(I[P]);for(Q=0;Q<G;Q++){if(ee=z,C[Q]=B(I,j,C,Q),N=240&(z=D[ee][g[C[Q]]]),z&=15,R[Q]=Y=D[z][5],N>0)if(N===16){for(P=V;P<Q;P++)R[P]=1;V=-1}else V=-1;if(D[z][6])V===-1&&(V=Q);else if(V>-1){for(P=V;P<Q;P++)R[P]=Y;V=-1}j[Q]==="B"&&(R[Q]=0),L.hiLevel|=Y}i&&function(K,W,Ae){for(var ue=0;ue<Ae;ue++)if(K[ue]==="S"){W[ue]=E;for(var he=ue-1;he>=0&&K[he]==="WS";he--)W[he]=E}}(j,R,G)},_=function(I,R,L,N,P){if(!(P.hiLevel<I)){if(I===1&&E===1&&!n)return R.reverse(),void(L&&L.reverse());for(var Q,Y,ee,V,G=R.length,z=0;z<G;){if(N[z]>=I){for(ee=z+1;ee<G&&N[ee]>=I;)ee++;for(V=z,Y=ee-1;V<Y;V++,Y--)Q=R[V],R[V]=R[Y],R[Y]=Q,L&&(Q=L[V],L[V]=L[Y],L[Y]=Q);z=ee}z++}}},U=function(I,R,L){var N=I.split(""),P={hiLevel:E};return L||(L=[]),O(N,L,P),function(Q,Y,ee){if(ee.hiLevel!==0&&d)for(var V,G=0;G<Q.length;G++)Y[G]===1&&(V=x.indexOf(Q[G]))>=0&&(Q[G]=x[V+1])}(N,L,P),_(2,N,R,L,P),_(1,N,R,L,P),N.join("")};return this.__bidiEngine__.doBidiReorder=function(I,R,L){if(function(P,Q){if(Q)for(var Y=0;Y<P.length;Y++)Q[Y]=Y;l===void 0&&(l=S(P)),A===void 0&&(A=S(P))}(I,R),o||!c||A)if(o&&c&&l^A)E=l?1:0,I=b(I,R,L);else if(!o&&c&&A)E=l?1:0,I=U(I,R,L),I=b(I,R);else if(!o||l||c||A){if(o&&!c&&l^A)I=b(I,R),l?(E=0,I=U(I,R,L)):(E=1,I=U(I,R,L),I=b(I,R));else if(o&&l&&!c&&A)E=1,I=U(I,R,L),I=b(I,R);else if(!o&&!c&&l^A){var N=d;l?(E=1,I=U(I,R,L),E=0,d=!1,I=U(I,R,L),d=N):(E=0,I=U(I,R,L),I=b(I,R),E=1,d=!1,I=U(I,R,L),d=N,I=b(I,R))}}else E=0,I=U(I,R,L);else E=l?1:0,I=U(I,R,L);return I},this.__bidiEngine__.setOptions=function(I){I&&(o=I.isInputVisual,c=I.isOutputVisual,l=I.isInputRtl,A=I.isOutputRtl,d=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text,i=(a.x,a.y,a.options||{}),o=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var l=0;for(o=[],l=0;l<n.length;l+=1)Object.prototype.toString.call(n[l])==="[object Array]"?o.push([r.doBidiReorder(n[l][0]),n[l][1],n[l][2]]):o.push([r.doBidiReorder(n[l])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(Vt),Vt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new cc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new z9(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new F9(this.contents),this.head=new k9(this),this.name=new M9(this),this.cmap=new cB(this),this.toUnicode={},this.hhea=new D9(this),this.maxp=new P9(this),this.hmtx=new Q9(this),this.post=new L9(this),this.os2=new j9(this),this.loca=new G9(this),this.glyf=new q9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],A.push(Math.round(t*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)n=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var Wi,cc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,i,o,l,c;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,i;for(i=[],a=0,n=t.length;a<n;a++)r=t[a],i.push(this.writeByte(r));return i},e}(),F9=function(){var e;function t(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,i,o,l,c,A,d,f,p,u,g,h;for(h in u=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(u)/c),o=Math.floor(f/c),d=16*u-f,(n=new cc).writeInt(this.scalarType),n.writeShort(u),n.writeShort(f),n.writeShort(o),n.writeShort(d),i=16*u,A=n.pos+i,l=null,g=[],r)for(p=r[h],n.writeString(h),n.writeInt(e(p)),n.writeInt(A),n.writeInt(p.length),g=g.concat(p),h==="head"&&(l=A),A+=p.length;A%4;)g.push(0),A++;return n.write(g),a=2981146554-e(n.data),n.pos=l+8,n.writeUInt32(a),n.data},e=function(r){var a,n,i,o;for(r=AB.call(r);r.length%4;)r.push(0);for(i=new cc(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=i.readUInt32();return 4294967295&n},t}(),R9={}.hasOwnProperty,Eo=function(e,t){for(var r in t)R9.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};Wi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var k9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var a;return(a=new cc).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},t}(),Uw=function(){function e(t,r){var a,n,i,o,l,c,A,d,f,p,u,g,h,x,y,v,E;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(u=t.readUInt16(),p=u/2,t.pos+=6,i=function(){var k,S;for(S=[],c=k=0;0<=p?k<p:k>p;c=0<=p?++k:--k)S.push(t.readUInt16());return S}(),t.pos+=2,h=function(){var k,S;for(S=[],c=k=0;0<=p?k<p:k>p;c=0<=p?++k:--k)S.push(t.readUInt16());return S}(),A=function(){var k,S;for(S=[],c=k=0;0<=p?k<p:k>p;c=0<=p?++k:--k)S.push(t.readUInt16());return S}(),d=function(){var k,S;for(S=[],c=k=0;0<=p?k<p:k>p;c=0<=p?++k:--k)S.push(t.readUInt16());return S}(),n=(this.length-t.pos+this.offset)/2,l=function(){var k,S;for(S=[],c=k=0;0<=n?k<n:k>n;c=0<=n?++k:--k)S.push(t.readUInt16());return S}(),c=y=0,E=i.length;y<E;c=++y)for(x=i[c],a=v=g=h[c];g<=x?v<=x:v>=x;a=g<=x?++v:--v)d[c]===0?o=a+A[c]:(o=l[d[c]/2+(a-g)-(p-c)]||0)!==0&&(o+=A[c]),this.codeMap[a]=65535&o}t.pos=f}return e.encode=function(t,r){var a,n,i,o,l,c,A,d,f,p,u,g,h,x,y,v,E,k,S,B,b,O,_,U,I,R,L,N,P,Q,Y,ee,V,G,z,C,D,j,K,W,Ae,ue,he,ve,we,se;switch(N=new cc,o=Object.keys(t).sort(function(He,Ee){return He-Ee}),r){case"macroman":for(h=0,x=function(){var He=[];for(g=0;g<256;++g)He.push(0);return He}(),v={0:0},i={},P=0,V=o.length;P<V;P++)v[he=t[n=o[P]]]==null&&(v[he]=++h),i[n]={old:t[n],new:v[t[n]]},x[n]=v[t[n]];return N.writeUInt16(1),N.writeUInt16(0),N.writeUInt32(12),N.writeUInt16(0),N.writeUInt16(262),N.writeUInt16(0),N.write(x),{charMap:i,subtable:N.data,maxGlyphID:h+1};case"unicode":for(R=[],f=[],E=0,v={},a={},y=A=null,Q=0,G=o.length;Q<G;Q++)v[S=t[n=o[Q]]]==null&&(v[S]=++E),a[n]={old:S,new:v[S]},l=v[S]-n,y!=null&&l===A||(y&&f.push(y),R.push(n),A=l),y=n;for(y&&f.push(y),f.push(65535),R.push(65535),U=2*(_=R.length),O=2*Math.pow(Math.log(_)/Math.LN2,2),p=Math.log(O/2)/Math.LN2,b=2*_-O,c=[],B=[],u=[],g=Y=0,z=R.length;Y<z;g=++Y){if(I=R[g],d=f[g],I===65535){c.push(0),B.push(0);break}if(I-(L=a[I].new)>=32768)for(c.push(0),B.push(2*(u.length+_-g)),n=ee=I;I<=d?ee<=d:ee>=d;n=I<=d?++ee:--ee)u.push(a[n].new);else c.push(L-I),B.push(0)}for(N.writeUInt16(3),N.writeUInt16(1),N.writeUInt32(12),N.writeUInt16(4),N.writeUInt16(16+8*_+2*u.length),N.writeUInt16(0),N.writeUInt16(U),N.writeUInt16(O),N.writeUInt16(p),N.writeUInt16(b),Ae=0,C=f.length;Ae<C;Ae++)n=f[Ae],N.writeUInt16(n);for(N.writeUInt16(0),ue=0,D=R.length;ue<D;ue++)n=R[ue],N.writeUInt16(n);for(ve=0,j=c.length;ve<j;ve++)l=c[ve],N.writeUInt16(l);for(we=0,K=B.length;we<K;we++)k=B[we],N.writeUInt16(k);for(se=0,W=u.length;se<W;se++)h=u[se],N.writeUInt16(h);return{charMap:a,subtable:N.data,maxGlyphID:E+1}}},e}(),cB=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="cmap",t.prototype.parse=function(r){var a,n,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)a=new Uw(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(r,a){var n,i;return a==null&&(a="macroman"),n=Uw.encode(r,a),(i=new cc).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t}(),D9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),j9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n}(),this.charRange=function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),L9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="post",t.prototype.parse=function(r){var a,n,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(n=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)a=r.readByte(),i.push(this.names.push(r.readString(a)));return i;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var l,c,A;for(A=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)A.push(r.readUInt32());return A}).call(this)}},t}(),U9=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},M9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="name",t.prototype.parse=function(r){var a,n,i,o,l,c,A,d,f,p,u;for(r.pos=this.offset,r.readShort(),a=r.readShort(),c=r.readShort(),n=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(A={},o=f=0,p=n.length;f<p;o=++f)i=n[o],r.pos=i.offset,d=r.readString(i.length),l=new U9(d,i),A[u=i.nameID]==null&&(A[u]=[]),A[i.nameID].push(l);this.strings=A,this.copyright=A[0],this.fontFamily=A[1],this.fontSubfamily=A[2],this.uniqueSubfamily=A[3],this.fontName=A[4],this.version=A[5];try{this.postscriptName=A[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=A[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=A[7],this.manufacturer=A[8],this.designer=A[9],this.description=A[10],this.vendorUrl=A[11],this.designerUrl=A[12],this.license=A[13],this.licenseUrl=A[14],this.preferredFamily=A[15],this.preferredSubfamily=A[17],this.compatibleFull=A[18],this.sampleText=A[19]},t}(),P9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),Q9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="hmtx",t.prototype.parse=function(r){var a,n,i,o,l,c,A;for(r.pos=this.offset,this.metrics=[],a=0,c=this.file.hhea.numberOfMetrics;0<=c?a<c:a>c;a=0<=c?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,f;for(f=[],a=d=0;0<=i?d<i:d>i;a=0<=i?++d:--d)f.push(r.readInt16());return f}(),this.widths=(function(){var d,f,p,u;for(u=[],d=0,f=(p=this.metrics).length;d<f;d++)o=p[d],u.push(o.advance);return u}).call(this),n=this.widths[this.widths.length-1],A=[],a=l=0;0<=i?l<i:l>i;a=0<=i?++l:--l)A.push(this.widths.push(n));return A},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),AB=[].slice,q9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var a,n,i,o,l,c,A,d,f,p;return r in this.cache?this.cache[r]:(o=this.file.loca,a=this.file.contents,n=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,l=(c=new cc(a.read(i))).readShort(),d=c.readShort(),p=c.readShort(),A=c.readShort(),f=c.readShort(),this.cache[r]=l===-1?new H9(c,d,p,A,f):new K9(c,l,d,p,A,f),this.cache[r]))},t.prototype.encode=function(r,a,n){var i,o,l,c,A;for(l=[],o=[],c=0,A=a.length;c<A;c++)i=r[a[c]],o.push(l.length),i&&(l=l.concat(i.encode(n)));return o.push(l.length),{table:l,offsets:o}},t}(),K9=function(){function e(t,r,a,n,i,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),H9=function(){function e(t,r,a,n,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new cc(AB.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),G9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Eo(t,Wi),t.prototype.tag="loca",t.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<n.length;++l)if(n[l]=i,o<a.length&&a[o]==l){++o,n[l]=i;var c=this.offsets[l],A=this.offsets[l+1]-c;A>0&&(i+=A)}for(var d=new Array(4*n.length),f=0;f<n.length;++f)d[4*f+3]=255&n[f],d[4*f+2]=(65280&n[f])>>8,d[4*f+1]=(16711680&n[f])>>16,d[4*f]=(4278190080&n[f])>>24;return d},t}(),z9=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,i,o,l,c;for(n={},o=0,l=t.length;o<l;o++)n[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))a=c[i],n[i]=a;return n},e.prototype.encode=function(t,r){var a,n,i,o,l,c,A,d,f,p,u,g,h,x,y;for(n in a=cB.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),u={0:0},y=a.charMap)u[(c=y[n]).old]=c.new;for(g in p=a.maxGlyphID,o)g in u||(u[g]=p++);return d=function(v){var E,k;for(E in k={},v)k[v[E]]=E;return k}(u),f=Object.keys(d).sort(function(v,E){return v-E}),h=function(){var v,E,k;for(k=[],v=0,E=f.length;v<E;v++)l=f[v],k.push(d[l]);return k}(),i=this.font.glyf.encode(o,h,u),A=this.font.loca.encode(i.offsets,h),x={cmap:this.font.cmap.raw(),glyf:i.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},e}();Vt.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,i,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)a=r[l],A.push(t.convert(a));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)o=r[n],i.push("/"+n+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wx=function(e,t){return Wx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Wx(e,t)};function Xi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Wx(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Xx=function(){return Xx=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Xx.apply(this,arguments)};function As(e,t,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{A(a.next(d))}catch(f){o(f)}}function c(d){try{A(a.throw(d))}catch(f){o(f)}}function A(d){d.done?i(d.value):n(d.value).then(l,c)}A((a=a.apply(e,[])).next())})}function Qn(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(d){return c([A,d])}}function c(A){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(i=A[0]&2?n.return:A[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,A[1])).done)return i;switch(n=0,i&&(A=[A[0]&2,i.value]),A[0]){case 0:case 1:i=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,n=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!i||A[1]>i[0]&&A[1]<i[3])){r.label=A[1];break}if(A[0]===6&&r.label<i[1]){r.label=i[1],i=A;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(A);break}i[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(d){A=[6,d],n=0}finally{a=i=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Ep(e,t,r){if(arguments.length===2)for(var a=0,n=t.length,i;a<n;a++)(i||!(a in t))&&(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||t)}var al=function(){function e(t,r,a,n){this.left=t,this.top=r,this.width=a,this.height=n}return e.prototype.add=function(t,r,a,n){return new e(this.left+t,this.top+r,this.width+a,this.height+n)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var a=Array.from(r).find(function(n){return n.width!==0});return a?new e(a.left+t.windowBounds.left,a.top+t.windowBounds.top,a.width,a.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),Fm=function(e,t){return al.fromClientRect(e,t.getBoundingClientRect())},V9=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),n=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new al(0,0,a,n)},Rm=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((n&1023)<<10)+(i&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},ka=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var o=e[n];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},Mw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var bp=0;bp<Mw.length;bp++)$9[Mw.charCodeAt(bp)]=bp;var Pw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$u=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _p=0;_p<Pw.length;_p++)$u[Pw.charCodeAt(_p)]=_p;var Y9=function(e){var t=e.length*.75,r=e.length,a,n=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(A)?A:new Uint8Array(A);for(a=0;a<r;a+=4)i=$u[e.charCodeAt(a)],o=$u[e.charCodeAt(a+1)],l=$u[e.charCodeAt(a+2)],c=$u[e.charCodeAt(a+3)],d[n++]=i<<2|o>>4,d[n++]=(o&15)<<4|l>>2,d[n++]=(l&3)<<6|c&63;return A},W9=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},X9=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},Zc=5,Py=11,s1=2,J9=Py-Zc,dB=65536>>Zc,Z9=1<<Zc,i1=Z9-1,eQ=1024>>Zc,tQ=dB+eQ,rQ=tQ,aQ=32,nQ=rQ+aQ,sQ=65536>>Py,iQ=1<<J9,oQ=iQ-1,Qw=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},lQ=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},cQ=function(e,t){var r=Y9(e),a=Array.isArray(r)?X9(r):new Uint32Array(r),n=Array.isArray(r)?W9(r):new Uint16Array(r),i=24,o=Qw(n,i/2,a[4]/2),l=a[5]===2?Qw(n,(i+a[4])/2):lQ(a,Math.ceil((i+a[4])/4));return new AQ(a[0],a[1],a[2],a[3],o,l)},AQ=function(){function e(t,r,a,n,i,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Zc],r=(r<<s1)+(t&i1),this.data[r];if(t<=65535)return r=this.index[dB+(t-55296>>Zc)],r=(r<<s1)+(t&i1),this.data[r];if(t<this.highStart)return r=nQ-sQ+(t>>Py),r=this.index[r],r+=t>>Zc&oQ,r=this.index[r],r=(r<<s1)+(t&i1),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),qw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dQ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Cp=0;Cp<qw.length;Cp++)dQ[qw.charCodeAt(Cp)]=Cp;var uQ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Kw=50,fQ=1,uB=2,fB=3,pQ=4,hQ=5,Hw=7,pB=8,Gw=9,zl=10,Jx=11,zw=12,Zx=13,mQ=14,Yu=15,e2=16,Bp=17,Nu=18,gQ=19,Vw=20,t2=21,Fu=22,o1=23,WA=24,Gs=25,Wu=26,Xu=27,XA=28,xQ=29,Lc=30,yQ=31,Sp=32,Tp=33,r2=34,a2=35,n2=36,Wf=37,s2=38,Ah=39,dh=40,l1=41,hB=42,vQ=43,wQ=[9001,65288],mB="!",gr="×",Op="÷",i2=cQ(uQ),Po=[Lc,n2],o2=[fQ,uB,fB,hQ],gB=[zl,pB],$w=[Xu,Wu],EQ=o2.concat(gB),Yw=[s2,Ah,dh,r2,a2],bQ=[Yu,Zx],_Q=function(e,t){t===void 0&&(t="strict");var r=[],a=[],n=[];return e.forEach(function(i,o){var l=i2.get(i);if(l>Kw?(n.push(!0),l-=Kw):n.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return a.push(o),r.push(e2);if(l===pQ||l===Jx){if(o===0)return a.push(o),r.push(Lc);var c=r[o-1];return EQ.indexOf(c)===-1?(a.push(a[o-1]),r.push(c)):(a.push(o),r.push(Lc))}if(a.push(o),l===yQ)return r.push(t==="strict"?t2:Wf);if(l===hB||l===xQ)return r.push(Lc);if(l===vQ)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(Wf):r.push(Lc);r.push(l)}),[a,r,n]},c1=function(e,t,r,a){var n=a[r];if(Array.isArray(e)?e.indexOf(n)!==-1:e===n)for(var i=r;i<=a.length;){i++;var o=a[i];if(o===t)return!0;if(o!==zl)break}if(n===zl)for(var i=r;i>0;){i--;var l=a[i];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=a.length;){c++;var o=a[c];if(o===t)return!0;if(o!==zl)break}if(l!==zl)break}return!1},Ww=function(e,t){for(var r=e;r>=0;){var a=t[r];if(a===zl)r--;else return a}return 0},CQ=function(e,t,r,a,n){if(r[a]===0)return gr;var i=a-1;if(Array.isArray(n)&&n[i]===!0)return gr;var o=i-1,l=i+1,c=t[i],A=o>=0?t[o]:0,d=t[l];if(c===uB&&d===fB)return gr;if(o2.indexOf(c)!==-1)return mB;if(o2.indexOf(d)!==-1||gB.indexOf(d)!==-1)return gr;if(Ww(i,t)===pB)return Op;if(i2.get(e[i])===Jx||(c===Sp||c===Tp)&&i2.get(e[l])===Jx||c===Hw||d===Hw||c===Gw||[zl,Zx,Yu].indexOf(c)===-1&&d===Gw||[Bp,Nu,gQ,WA,XA].indexOf(d)!==-1||Ww(i,t)===Fu||c1(o1,Fu,i,t)||c1([Bp,Nu],t2,i,t)||c1(zw,zw,i,t))return gr;if(c===zl)return Op;if(c===o1||d===o1)return gr;if(d===e2||c===e2)return Op;if([Zx,Yu,t2].indexOf(d)!==-1||c===mQ||A===n2&&bQ.indexOf(c)!==-1||c===XA&&d===n2||d===Vw||Po.indexOf(d)!==-1&&c===Gs||Po.indexOf(c)!==-1&&d===Gs||c===Xu&&[Wf,Sp,Tp].indexOf(d)!==-1||[Wf,Sp,Tp].indexOf(c)!==-1&&d===Wu||Po.indexOf(c)!==-1&&$w.indexOf(d)!==-1||$w.indexOf(c)!==-1&&Po.indexOf(d)!==-1||[Xu,Wu].indexOf(c)!==-1&&(d===Gs||[Fu,Yu].indexOf(d)!==-1&&t[l+1]===Gs)||[Fu,Yu].indexOf(c)!==-1&&d===Gs||c===Gs&&[Gs,XA,WA].indexOf(d)!==-1)return gr;if([Gs,XA,WA,Bp,Nu].indexOf(d)!==-1)for(var f=i;f>=0;){var p=t[f];if(p===Gs)return gr;if([XA,WA].indexOf(p)!==-1)f--;else break}if([Xu,Wu].indexOf(d)!==-1)for(var f=[Bp,Nu].indexOf(c)!==-1?o:i;f>=0;){var p=t[f];if(p===Gs)return gr;if([XA,WA].indexOf(p)!==-1)f--;else break}if(s2===c&&[s2,Ah,r2,a2].indexOf(d)!==-1||[Ah,r2].indexOf(c)!==-1&&[Ah,dh].indexOf(d)!==-1||[dh,a2].indexOf(c)!==-1&&d===dh||Yw.indexOf(c)!==-1&&[Vw,Wu].indexOf(d)!==-1||Yw.indexOf(d)!==-1&&c===Xu||Po.indexOf(c)!==-1&&Po.indexOf(d)!==-1||c===WA&&Po.indexOf(d)!==-1||Po.concat(Gs).indexOf(c)!==-1&&d===Fu&&wQ.indexOf(e[l])===-1||Po.concat(Gs).indexOf(d)!==-1&&c===Nu)return gr;if(c===l1&&d===l1){for(var u=r[i],g=1;u>0&&(u--,t[u]===l1);)g++;if(g%2!==0)return gr}return c===Sp&&d===Tp?gr:Op},BQ=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=_Q(e,t.lineBreak),a=r[0],n=r[1],i=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(n=n.map(function(l){return[Gs,Lc,hB].indexOf(l)!==-1?Wf:l}));var o=t.wordBreak==="keep-all"?i.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[a,n,o]},SQ=function(){function e(t,r,a,n){this.codePoints=t,this.required=r===mB,this.start=a,this.end=n}return e.prototype.slice=function(){return ka.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),TQ=function(e,t){var r=Rm(e),a=BQ(r,t),n=a[0],i=a[1],o=a[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var d=gr;A<l&&(d=CQ(r,i,n,++A,o))===gr;);if(d!==gr||A===l){var f=new SQ(r,d,c,A);return c=A,{value:f,done:!1}}return{done:!0,value:null}}}},OQ=1,IQ=2,p0=4,Xw=8,Gh=10,Jw=47,xf=92,NQ=9,FQ=32,Ip=34,Ru=61,RQ=35,kQ=36,DQ=37,Np=39,Fp=40,ku=41,jQ=95,Is=45,LQ=33,UQ=60,MQ=62,PQ=64,QQ=91,qQ=93,KQ=61,HQ=123,Rp=63,GQ=125,Zw=124,zQ=126,VQ=128,eE=65533,A1=42,Mc=43,$Q=44,YQ=58,WQ=59,Xf=46,XQ=0,JQ=8,ZQ=11,eq=14,tq=31,rq=127,ao=-1,xB=48,yB=97,vB=101,aq=102,nq=117,sq=122,wB=65,EB=69,bB=70,iq=85,oq=90,Gn=function(e){return e>=xB&&e<=57},lq=function(e){return e>=55296&&e<=57343},JA=function(e){return Gn(e)||e>=wB&&e<=bB||e>=yB&&e<=aq},cq=function(e){return e>=yB&&e<=sq},Aq=function(e){return e>=wB&&e<=oq},dq=function(e){return cq(e)||Aq(e)},uq=function(e){return e>=VQ},kp=function(e){return e===Gh||e===NQ||e===FQ},zh=function(e){return dq(e)||uq(e)||e===jQ},tE=function(e){return zh(e)||Gn(e)||e===Is},fq=function(e){return e>=XQ&&e<=JQ||e===ZQ||e>=eq&&e<=tq||e===rq},jl=function(e,t){return e!==xf?!1:t!==Gh},Dp=function(e,t,r){return e===Is?zh(t)||jl(t,r):zh(e)?!0:!!(e===xf&&jl(e,t))},d1=function(e,t,r){return e===Mc||e===Is?Gn(t)?!0:t===Xf&&Gn(r):Gn(e===Xf?t:e)},pq=function(e){var t=0,r=1;(e[t]===Mc||e[t]===Is)&&(e[t]===Is&&(r=-1),t++);for(var a=[];Gn(e[t]);)a.push(e[t++]);var n=a.length?parseInt(ka.apply(void 0,a),10):0;e[t]===Xf&&t++;for(var i=[];Gn(e[t]);)i.push(e[t++]);var o=i.length,l=o?parseInt(ka.apply(void 0,i),10):0;(e[t]===EB||e[t]===vB)&&t++;var c=1;(e[t]===Mc||e[t]===Is)&&(e[t]===Is&&(c=-1),t++);for(var A=[];Gn(e[t]);)A.push(e[t++]);var d=A.length?parseInt(ka.apply(void 0,A),10):0;return r*(n+l*Math.pow(10,-o))*Math.pow(10,c*d)},hq={type:2},mq={type:3},gq={type:4},xq={type:13},yq={type:8},vq={type:21},wq={type:9},Eq={type:10},bq={type:11},_q={type:12},Cq={type:14},jp={type:23},Bq={type:1},Sq={type:25},Tq={type:24},Oq={type:26},Iq={type:27},Nq={type:28},Fq={type:29},Rq={type:31},l2={type:32},_B=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Rm(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==l2;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Ip:return this.consumeStringToken(Ip);case RQ:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),n=this.peekCodePoint(2);if(tE(r)||jl(a,n)){var i=Dp(r,a,n)?IQ:OQ,o=this.consumeName();return{type:5,value:o,flags:i}}break;case kQ:if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),xq;break;case Np:return this.consumeStringToken(Np);case Fp:return hq;case ku:return mq;case A1:if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),Cq;break;case Mc:if(d1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case $Q:return gq;case Is:var l=t,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(d1(l,c,A))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Dp(l,c,A))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===Is&&A===MQ)return this.consumeCodePoint(),this.consumeCodePoint(),Tq;break;case Xf:if(d1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Jw:if(this.peekCodePoint(0)===A1)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===A1&&(d=this.consumeCodePoint(),d===Jw))return this.consumeToken();if(d===ao)return this.consumeToken()}break;case YQ:return Oq;case WQ:return Iq;case UQ:if(this.peekCodePoint(0)===LQ&&this.peekCodePoint(1)===Is&&this.peekCodePoint(2)===Is)return this.consumeCodePoint(),this.consumeCodePoint(),Sq;break;case PQ:var f=this.peekCodePoint(0),p=this.peekCodePoint(1),u=this.peekCodePoint(2);if(Dp(f,p,u)){var o=this.consumeName();return{type:7,value:o}}break;case QQ:return Nq;case xf:if(jl(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case qQ:return Fq;case KQ:if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),yq;break;case HQ:return bq;case GQ:return _q;case nq:case iq:var g=this.peekCodePoint(0),h=this.peekCodePoint(1);return g===Mc&&(JA(h)||h===Rp)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case Zw:if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),wq;if(this.peekCodePoint(0)===Zw)return this.consumeCodePoint(),vq;break;case zQ:if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),Eq;break;case ao:return l2}return kp(t)?(this.consumeWhiteSpace(),Rq):Gn(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):zh(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:ka(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();JA(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var a=!1;r===Rp&&t.length<6;)t.push(r),r=this.consumeCodePoint(),a=!0;if(a){var n=parseInt(ka.apply(void 0,t.map(function(c){return c===Rp?xB:c})),16),i=parseInt(ka.apply(void 0,t.map(function(c){return c===Rp?bB:c})),16);return{type:30,start:n,end:i}}var o=parseInt(ka.apply(void 0,t),16);if(this.peekCodePoint(0)===Is&&JA(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];JA(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(ka.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Fp?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Fp?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ao)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Np||r===Ip){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ao||this.peekCodePoint(0)===ku)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),jp)}for(;;){var n=this.consumeCodePoint();if(n===ao||n===ku)return{type:22,value:ka.apply(void 0,t)};if(kp(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ao||this.peekCodePoint(0)===ku?(this.consumeCodePoint(),{type:22,value:ka.apply(void 0,t)}):(this.consumeBadUrlRemnants(),jp);if(n===Ip||n===Np||n===Fp||fq(n))return this.consumeBadUrlRemnants(),jp;if(n===xf)if(jl(n,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),jp;else t.push(n)}},e.prototype.consumeWhiteSpace=function(){for(;kp(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===ku||t===ao)return;jl(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,a="";t>0;){var n=Math.min(r,t);a+=ka.apply(void 0,this._value.splice(0,n)),t-=n}return this._value.shift(),a},e.prototype.consumeStringToken=function(t){var r="",a=0;do{var n=this._value[a];if(n===ao||n===void 0||n===t)return r+=this.consumeStringSlice(a),{type:0,value:r};if(n===Gh)return this._value.splice(0,a),Bq;if(n===xf){var i=this._value[a+1];i!==ao&&i!==void 0&&(i===Gh?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):jl(n,i)&&(r+=this.consumeStringSlice(a),r+=ka(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=p0,a=this.peekCodePoint(0);for((a===Mc||a===Is)&&t.push(this.consumeCodePoint());Gn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(a===Xf&&Gn(n))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Xw;Gn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0),n=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((a===EB||a===vB)&&((n===Mc||n===Is)&&Gn(i)||Gn(n)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Xw;Gn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[pq(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],a=t[1],n=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Dp(n,i,o)){var l=this.consumeName();return{type:15,number:r,flags:a,unit:l}}return n===DQ?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(JA(t)){for(var r=ka(t);JA(this.peekCodePoint(0))&&r.length<6;)r+=ka(this.consumeCodePoint());kp(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||lq(a)||a>1114111?eE:a}return t===ao?eE:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(tE(r))t+=ka(r);else if(jl(r,this.peekCodePoint(0)))t+=ka(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),CB=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new _B;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},a=this.consumeToken();;){if(a.type===32||Dq(a,t))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?l2:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),h0=function(e){return e.type===15},Jd=function(e){return e.type===17},zr=function(e){return e.type===20},kq=function(e){return e.type===0},c2=function(e,t){return zr(e)&&e.value===t},BB=function(e){return e.type!==31},Hd=function(e){return e.type!==31&&e.type!==4},bo=function(e){var t=[],r=[];return e.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&t.push(r),t},Dq=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Ac=function(e){return e.type===17||e.type===15},Wa=function(e){return e.type===16||Ac(e)},SB=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Nn={type:17,number:0,flags:p0},Qy={type:16,number:50,flags:p0},Vl={type:16,number:100,flags:p0},Ju=function(e,t,r){var a=e[0],n=e[1];return[na(a,t),na(typeof n<"u"?n:a,r)]},na=function(e,t){if(e.type===16)return e.number/100*t;if(h0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},TB="deg",OB="grad",IB="rad",NB="turn",km={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case TB:return Math.PI*t.number/180;case OB:return Math.PI/200*t.number;case IB:return t.number;case NB:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},FB=function(e){return e.type===15&&(e.unit===TB||e.unit===OB||e.unit===IB||e.unit===NB)},RB=function(e){var t=e.filter(zr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Nn,Nn];case"to top":case"bottom":return Bi(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Nn,Vl];case"to right":case"left":return Bi(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Vl,Vl];case"to bottom":case"top":return Bi(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Vl,Nn];case"to left":case"right":return Bi(270)}return 0},Bi=function(e){return Math.PI*e/180},Yl={name:"color",parse:function(e,t){if(t.type===18){var r=jq[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var a=t.value.substring(0,1),n=t.value.substring(1,2),i=t.value.substring(2,3);return $l(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),1)}if(t.value.length===4){var a=t.value.substring(0,1),n=t.value.substring(1,2),i=t.value.substring(2,3),o=t.value.substring(3,4);return $l(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(t.value.length===6){var a=t.value.substring(0,2),n=t.value.substring(2,4),i=t.value.substring(4,6);return $l(parseInt(a,16),parseInt(n,16),parseInt(i,16),1)}if(t.value.length===8){var a=t.value.substring(0,2),n=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8);return $l(parseInt(a,16),parseInt(n,16),parseInt(i,16),parseInt(o,16)/255)}}if(t.type===20){var l=Jo[t.value.toUpperCase()];if(typeof l<"u")return l}return Jo.TRANSPARENT}},Wl=function(e){return(255&e)===0},pn=function(e){var t=255&e,r=255&e>>8,a=255&e>>16,n=255&e>>24;return t<255?"rgba("+n+","+a+","+r+","+t/255+")":"rgb("+n+","+a+","+r+")"},$l=function(e,t,r,a){return(e<<24|t<<16|r<<8|Math.round(a*255)<<0)>>>0},rE=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},aE=function(e,t){var r=t.filter(Hd);if(r.length===3){var a=r.map(rE),n=a[0],i=a[1],o=a[2];return $l(n,i,o,1)}if(r.length===4){var l=r.map(rE),n=l[0],i=l[1],o=l[2],c=l[3];return $l(n,i,o,c)}return 0};function u1(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var nE=function(e,t){var r=t.filter(Hd),a=r[0],n=r[1],i=r[2],o=r[3],l=(a.type===17?Bi(a.number):km.parse(e,a))/(Math.PI*2),c=Wa(n)?n.number/100:0,A=Wa(i)?i.number/100:0,d=typeof o<"u"&&Wa(o)?na(o,1):1;if(c===0)return $l(A*255,A*255,A*255,1);var f=A<=.5?A*(c+1):A+c-A*c,p=A*2-f,u=u1(p,f,l+1/3),g=u1(p,f,l),h=u1(p,f,l-1/3);return $l(u*255,g*255,h*255,d)},jq={hsl:nE,hsla:nE,rgb:aE,rgba:aE},yf=function(e,t){return Yl.parse(e,CB.create(t).parseComponentValue())},Jo={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Lq={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(zr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Uq={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Dm=function(e,t){var r=Yl.parse(e,t[0]),a=t[1];return a&&Wa(a)?{color:r,stop:a}:{color:r,stop:null}},sE=function(e,t){var r=e[0],a=e[e.length-1];r.stop===null&&(r.stop=Nn),a.stop===null&&(a.stop=Vl);for(var n=[],i=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=na(l,t);c>i?n.push(c):n.push(i),i=c}else n.push(null)}for(var A=null,o=0;o<n.length;o++){var d=n[o];if(d===null)A===null&&(A=o);else if(A!==null){for(var f=o-A,p=n[A-1],u=(d-p)/(f+1),g=1;g<=f;g++)n[A+g-1]=u*g;A=null}}return e.map(function(h,x){var y=h.color;return{color:y,stop:Math.max(Math.min(1,n[x]/t),0)}})},Mq=function(e,t,r){var a=t/2,n=r/2,i=na(e[0],t)-a,o=n-na(e[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},Pq=function(e,t,r){var a=typeof e=="number"?e:Mq(e,t,r),n=Math.abs(t*Math.sin(a))+Math.abs(r*Math.cos(a)),i=t/2,o=r/2,l=n/2,c=Math.sin(a-Math.PI/2)*l,A=Math.cos(a-Math.PI/2)*l;return[n,i-A,i+A,o-c,o+c]},Pi=function(e,t){return Math.sqrt(e*e+t*t)},iE=function(e,t,r,a,n){var i=[[0,0],[0,t],[e,0],[e,t]];return i.reduce(function(o,l){var c=l[0],A=l[1],d=Pi(r-c,a-A);return(n?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},Qq=function(e,t,r,a,n){var i=0,o=0;switch(e.size){case 0:e.shape===0?i=o=Math.min(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(i=Math.min(Math.abs(t),Math.abs(t-a)),o=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(e.shape===0)i=o=Math.min(Pi(t,r),Pi(t,r-n),Pi(t-a,r),Pi(t-a,r-n));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(t),Math.abs(t-a)),c=iE(a,n,t,r,!0),A=c[0],d=c[1];i=Pi(A-t,(d-r)/l),o=l*i}break;case 1:e.shape===0?i=o=Math.max(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(i=Math.max(Math.abs(t),Math.abs(t-a)),o=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(e.shape===0)i=o=Math.max(Pi(t,r),Pi(t,r-n),Pi(t-a,r),Pi(t-a,r-n));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(t),Math.abs(t-a)),f=iE(a,n,t,r,!1),A=f[0],d=f[1];i=Pi(A-t,(d-r)/l),o=l*i}break}return Array.isArray(e.size)&&(i=na(e.size[0],a),o=e.size.length===2?na(e.size[1],n):i),[i,o]},qq=function(e,t){var r=Bi(180),a=[];return bo(t).forEach(function(n,i){if(i===0){var o=n[0];if(o.type===20&&o.value==="to"){r=RB(n);return}else if(FB(o)){r=km.parse(e,o);return}}var l=Dm(e,n);a.push(l)}),{angle:r,stops:a,type:1}},Lp=function(e,t){var r=Bi(180),a=[];return bo(t).forEach(function(n,i){if(i===0){var o=n[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=RB(n);return}else if(FB(o)){r=(km.parse(e,o)+Bi(270))%Bi(360);return}}var l=Dm(e,n);a.push(l)}),{angle:r,stops:a,type:1}},Kq=function(e,t){var r=Bi(180),a=[],n=1,i=0,o=3,l=[];return bo(t).forEach(function(c,A){var d=c[0];if(A===0){if(zr(d)&&d.value==="linear"){n=1;return}else if(zr(d)&&d.value==="radial"){n=2;return}}if(d.type===18){if(d.name==="from"){var f=Yl.parse(e,d.values[0]);a.push({stop:Nn,color:f})}else if(d.name==="to"){var f=Yl.parse(e,d.values[0]);a.push({stop:Vl,color:f})}else if(d.name==="color-stop"){var p=d.values.filter(Hd);if(p.length===2){var f=Yl.parse(e,p[1]),u=p[0];Jd(u)&&a.push({stop:{type:16,number:u.number*100,flags:u.flags},color:f})}}}}),n===1?{angle:(r+Bi(180))%Bi(360),stops:a,type:n}:{size:o,shape:i,stops:a,position:l,type:n}},kB="closest-side",DB="farthest-side",jB="closest-corner",LB="farthest-corner",UB="circle",MB="ellipse",PB="cover",QB="contain",Hq=function(e,t){var r=0,a=3,n=[],i=[];return bo(t).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(f,p){if(A)if(zr(p))switch(p.value){case"center":return i.push(Qy),f;case"top":case"left":return i.push(Nn),f;case"right":case"bottom":return i.push(Vl),f}else(Wa(p)||Ac(p))&&i.push(p);else if(zr(p))switch(p.value){case UB:return r=0,!1;case MB:return r=1,!1;case"at":return A=!0,!1;case kB:return a=0,!1;case PB:case DB:return a=1,!1;case QB:case jB:return a=2,!1;case LB:return a=3,!1}else if(Ac(p)||Wa(p))return Array.isArray(a)||(a=[]),a.push(p),!1;return f},c)}if(c){var d=Dm(e,o);n.push(d)}}),{size:a,shape:r,stops:n,position:i,type:2}},Up=function(e,t){var r=0,a=3,n=[],i=[];return bo(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if(zr(f))switch(f.value){case"center":return i.push(Qy),!1;case"top":case"left":return i.push(Nn),!1;case"right":case"bottom":return i.push(Vl),!1}else if(Wa(f)||Ac(f))return i.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if(zr(f))switch(f.value){case UB:return r=0,!1;case MB:return r=1,!1;case QB:case kB:return a=0,!1;case DB:return a=1,!1;case jB:return a=2,!1;case PB:case LB:return a=3,!1}else if(Ac(f)||Wa(f))return Array.isArray(a)||(a=[]),a.push(f),!1;return d},c)),c){var A=Dm(e,o);n.push(A)}}),{size:a,shape:r,stops:n,position:i,type:2}},Gq=function(e){return e.type===1},zq=function(e){return e.type===2},qy={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var a=qB[t.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return a(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Vq(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!qB[e.name])}var qB={"linear-gradient":qq,"-moz-linear-gradient":Lp,"-ms-linear-gradient":Lp,"-o-linear-gradient":Lp,"-webkit-linear-gradient":Lp,"radial-gradient":Hq,"-moz-radial-gradient":Up,"-ms-radial-gradient":Up,"-o-radial-gradient":Up,"-webkit-radial-gradient":Up,"-webkit-gradient":Kq},$q={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(a){return Hd(a)&&Vq(a)}).map(function(a){return qy.parse(e,a)})}},Yq={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(zr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Wq={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return bo(t).map(function(r){return r.filter(Wa)}).map(SB)}},Xq={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return bo(t).map(function(r){return r.filter(zr).map(function(a){return a.value}).join(" ")}).map(Jq)}},Jq=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Dd;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(Dd||(Dd={}));var Zq={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return bo(t).map(function(r){return r.filter(eK)})}},eK=function(e){return zr(e)||Wa(e)},jm=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},tK=jm("top"),rK=jm("right"),aK=jm("bottom"),nK=jm("left"),Lm=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return SB(r.filter(Wa))}}},sK=Lm("top-left"),iK=Lm("top-right"),oK=Lm("bottom-right"),lK=Lm("bottom-left"),Um=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},cK=Um("top"),AK=Um("right"),dK=Um("bottom"),uK=Um("left"),Mm=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return h0(r)?r.number:0}}},fK=Mm("top"),pK=Mm("right"),hK=Mm("bottom"),mK=Mm("left"),gK={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},xK={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},yK={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(zr).reduce(function(r,a){return r|vK(a.value)},0)}},vK=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},wK={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},EK={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Vh;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Vh||(Vh={}));var bK={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return Vh.STRICT;case"normal":default:return Vh.NORMAL}}},_K={name:"line-height",initialValue:"normal",prefix:!1,type:4},oE=function(e,t){return zr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Wa(e)?na(e,t):t},CK={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:qy.parse(e,t)}},BK={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},A2={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Pm=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},SK=Pm("top"),TK=Pm("right"),OK=Pm("bottom"),IK=Pm("left"),NK={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(zr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},FK={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Qm=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},RK=Qm("top"),kK=Qm("right"),DK=Qm("bottom"),jK=Qm("left"),LK={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},UK={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},MK={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&c2(t[0],"none")?[]:bo(t).map(function(r){for(var a={color:Jo.TRANSPARENT,offsetX:Nn,offsetY:Nn,blur:Nn},n=0,i=0;i<r.length;i++){var o=r[i];Ac(o)?(n===0?a.offsetX=o:n===1?a.offsetY=o:a.blur=o,n++):a.color=Yl.parse(e,o)}return a})}},PK={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},QK={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=HK[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},qK=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},KK=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],a=t[1];t[2],t[3];var n=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,a,n,i,o,l]:null},HK={matrix:qK,matrix3d:KK},lE={type:16,number:50,flags:p0},GK=[lE,lE],zK={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Wa);return r.length!==2?GK:[r[0],r[1]]}},VK={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},vf;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(vf||(vf={}));var $K={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return vf.BREAK_ALL;case"keep-all":return vf.KEEP_ALL;case"normal":default:return vf.NORMAL}}},YK={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Jd(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},KB={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},WK={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Jd(t)?t.number:1}},XK={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},JK={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(zr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},ZK={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],a=[];return t.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},eH={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},tH={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(Jd(t))return t.number;if(zr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},rH={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(zr).map(function(r){return r.value})}},aH={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},nn=function(e,t){return(e&t)!==0},nH={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},sH={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var a=[],n=t.filter(BB),i=0;i<n.length;i++){var o=n[i],l=n[i+1];if(o.type===20){var c=l&&Jd(l)?l.number:1;a.push({counter:o.value,increment:c})}}return a}},iH={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],a=t.filter(BB),n=0;n<a.length;n++){var i=a[n],o=a[n+1];if(zr(i)&&i.value!=="none"){var l=o&&Jd(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},oH={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(h0).map(function(r){return KB.parse(e,r)})}},lH={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var a=[],n=t.filter(kq);if(n.length%2!==0)return null;for(var i=0;i<n.length;i+=2){var o=n[i].value,l=n[i+1].value;a.push({open:o,close:l})}return a}},cE=function(e,t,r){if(!e)return"";var a=e[Math.min(t,e.length-1)];return a?r?a.open:a.close:""},cH={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&c2(t[0],"none")?[]:bo(t).map(function(r){for(var a={color:255,offsetX:Nn,offsetY:Nn,blur:Nn,spread:Nn,inset:!1},n=0,i=0;i<r.length;i++){var o=r[i];c2(o,"inset")?a.inset=!0:Ac(o)?(n===0?a.offsetX=o:n===1?a.offsetY=o:n===2?a.blur=o:a.spread=o,n++):a.color=Yl.parse(e,o)}return a})}},AH={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],a=[];return t.filter(zr).forEach(function(n){switch(n.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(n){a.indexOf(n)===-1&&a.push(n)}),a}},dH={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},uH={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return h0(t)?t.number:0}},fH=function(){function e(t,r){var a,n;this.animationDuration=It(t,oH,r.animationDuration),this.backgroundClip=It(t,Lq,r.backgroundClip),this.backgroundColor=It(t,Uq,r.backgroundColor),this.backgroundImage=It(t,$q,r.backgroundImage),this.backgroundOrigin=It(t,Yq,r.backgroundOrigin),this.backgroundPosition=It(t,Wq,r.backgroundPosition),this.backgroundRepeat=It(t,Xq,r.backgroundRepeat),this.backgroundSize=It(t,Zq,r.backgroundSize),this.borderTopColor=It(t,tK,r.borderTopColor),this.borderRightColor=It(t,rK,r.borderRightColor),this.borderBottomColor=It(t,aK,r.borderBottomColor),this.borderLeftColor=It(t,nK,r.borderLeftColor),this.borderTopLeftRadius=It(t,sK,r.borderTopLeftRadius),this.borderTopRightRadius=It(t,iK,r.borderTopRightRadius),this.borderBottomRightRadius=It(t,oK,r.borderBottomRightRadius),this.borderBottomLeftRadius=It(t,lK,r.borderBottomLeftRadius),this.borderTopStyle=It(t,cK,r.borderTopStyle),this.borderRightStyle=It(t,AK,r.borderRightStyle),this.borderBottomStyle=It(t,dK,r.borderBottomStyle),this.borderLeftStyle=It(t,uK,r.borderLeftStyle),this.borderTopWidth=It(t,fK,r.borderTopWidth),this.borderRightWidth=It(t,pK,r.borderRightWidth),this.borderBottomWidth=It(t,hK,r.borderBottomWidth),this.borderLeftWidth=It(t,mK,r.borderLeftWidth),this.boxShadow=It(t,cH,r.boxShadow),this.color=It(t,gK,r.color),this.direction=It(t,xK,r.direction),this.display=It(t,yK,r.display),this.float=It(t,wK,r.cssFloat),this.fontFamily=It(t,ZK,r.fontFamily),this.fontSize=It(t,eH,r.fontSize),this.fontStyle=It(t,aH,r.fontStyle),this.fontVariant=It(t,rH,r.fontVariant),this.fontWeight=It(t,tH,r.fontWeight),this.letterSpacing=It(t,EK,r.letterSpacing),this.lineBreak=It(t,bK,r.lineBreak),this.lineHeight=It(t,_K,r.lineHeight),this.listStyleImage=It(t,CK,r.listStyleImage),this.listStylePosition=It(t,BK,r.listStylePosition),this.listStyleType=It(t,A2,r.listStyleType),this.marginTop=It(t,SK,r.marginTop),this.marginRight=It(t,TK,r.marginRight),this.marginBottom=It(t,OK,r.marginBottom),this.marginLeft=It(t,IK,r.marginLeft),this.opacity=It(t,WK,r.opacity);var i=It(t,NK,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=It(t,FK,r.overflowWrap),this.paddingTop=It(t,RK,r.paddingTop),this.paddingRight=It(t,kK,r.paddingRight),this.paddingBottom=It(t,DK,r.paddingBottom),this.paddingLeft=It(t,jK,r.paddingLeft),this.paintOrder=It(t,AH,r.paintOrder),this.position=It(t,UK,r.position),this.textAlign=It(t,LK,r.textAlign),this.textDecorationColor=It(t,XK,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=It(t,JK,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=It(t,MK,r.textShadow),this.textTransform=It(t,PK,r.textTransform),this.transform=It(t,QK,r.transform),this.transformOrigin=It(t,zK,r.transformOrigin),this.visibility=It(t,VK,r.visibility),this.webkitTextStrokeColor=It(t,dH,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=It(t,uH,r.webkitTextStrokeWidth),this.wordBreak=It(t,$K,r.wordBreak),this.zIndex=It(t,YK,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Wl(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return nn(this.display,4)||nn(this.display,33554432)||nn(this.display,268435456)||nn(this.display,536870912)||nn(this.display,67108864)||nn(this.display,134217728)},e}(),pH=function(){function e(t,r){this.content=It(t,nH,r.content),this.quotes=It(t,lH,r.quotes)}return e}(),AE=function(){function e(t,r){this.counterIncrement=It(t,sH,r.counterIncrement),this.counterReset=It(t,iH,r.counterReset)}return e}(),It=function(e,t,r){var a=new _B,n=r!==null&&typeof r<"u"?r.toString():t.initialValue;a.write(n);var i=new CB(a.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,zr(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return km.parse(e,i.parseComponentValue());case"color":return Yl.parse(e,i.parseComponentValue());case"image":return qy.parse(e,i.parseComponentValue());case"length":var l=i.parseComponentValue();return Ac(l)?l:Nn;case"length-percentage":var c=i.parseComponentValue();return Wa(c)?c:Nn;case"time":return KB.parse(e,i.parseComponentValue())}break}},hH="data-html2canvas-debug",mH=function(e){var t=e.getAttribute(hH);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},d2=function(e,t){var r=mH(e);return r===1||t===r},_o=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,d2(r,3))debugger;this.styles=new fH(t,window.getComputedStyle(r,null)),p2(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Fm(this.context,r),d2(r,4)&&(this.flags|=16)}return e}(),gH="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",dE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Mp=0;Mp<dE.length;Mp++)Zu[dE.charCodeAt(Mp)]=Mp;var xH=function(e){var t=e.length*.75,r=e.length,a,n=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(A)?A:new Uint8Array(A);for(a=0;a<r;a+=4)i=Zu[e.charCodeAt(a)],o=Zu[e.charCodeAt(a+1)],l=Zu[e.charCodeAt(a+2)],c=Zu[e.charCodeAt(a+3)],d[n++]=i<<2|o>>4,d[n++]=(o&15)<<4|l>>2,d[n++]=(l&3)<<6|c&63;return A},yH=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},vH=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},eA=5,Ky=11,f1=2,wH=Ky-eA,HB=65536>>eA,EH=1<<eA,p1=EH-1,bH=1024>>eA,_H=HB+bH,CH=_H,BH=32,SH=CH+BH,TH=65536>>Ky,OH=1<<wH,IH=OH-1,uE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},NH=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},FH=function(e,t){var r=xH(e),a=Array.isArray(r)?vH(r):new Uint32Array(r),n=Array.isArray(r)?yH(r):new Uint16Array(r),i=24,o=uE(n,i/2,a[4]/2),l=a[5]===2?uE(n,(i+a[4])/2):NH(a,Math.ceil((i+a[4])/4));return new RH(a[0],a[1],a[2],a[3],o,l)},RH=function(){function e(t,r,a,n,i,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>eA],r=(r<<f1)+(t&p1),this.data[r];if(t<=65535)return r=this.index[HB+(t-55296>>eA)],r=(r<<f1)+(t&p1),this.data[r];if(t<this.highStart)return r=SH-TH+(t>>Ky),r=this.index[r],r+=t>>eA&IH,r=this.index[r],r=(r<<f1)+(t&p1),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),fE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",kH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Pp=0;Pp<fE.length;Pp++)kH[fE.charCodeAt(Pp)]=Pp;var DH=1,h1=2,m1=3,pE=4,hE=5,jH=7,mE=8,g1=9,x1=10,gE=11,xE=12,yE=13,vE=14,y1=15,LH=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((n&1023)<<10)+(i&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},UH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var o=e[n];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},MH=FH(gH),Ei="×",v1="÷",PH=function(e){return MH.get(e)},QH=function(e,t,r){var a=r-2,n=t[a],i=t[r-1],o=t[r];if(i===h1&&o===m1)return Ei;if(i===h1||i===m1||i===pE||o===h1||o===m1||o===pE)return v1;if(i===mE&&[mE,g1,gE,xE].indexOf(o)!==-1||(i===gE||i===g1)&&(o===g1||o===x1)||(i===xE||i===x1)&&o===x1||o===yE||o===hE||o===jH||i===DH)return Ei;if(i===yE&&o===vE){for(;n===hE;)n=t[--a];if(n===vE)return Ei}if(i===y1&&o===y1){for(var l=0;n===y1;)l++,n=t[--a];if(l%2===0)return Ei}return v1},qH=function(e){var t=LH(e),r=t.length,a=0,n=0,i=t.map(PH);return{next:function(){if(a>=r)return{done:!0,value:null};for(var o=Ei;a<r&&(o=QH(t,i,++a))===Ei;);if(o!==Ei||a===r){var l=UH.apply(null,t.slice(n,a));return n=a,{value:l,done:!1}}return{done:!0,value:null}}}},KH=function(e){for(var t=qH(e),r=[],a;!(a=t.next()).done;)a.value&&r.push(a.value.slice());return r},HH=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var a=e.createElement("boundtest");a.style.height=t+"px",a.style.display="block",e.body.appendChild(a),r.selectNode(a);var n=r.getBoundingClientRect(),i=Math.round(n.height);if(e.body.removeChild(a),i===t)return!0}}return!1},GH=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=t.firstChild,n=Rm(a.data).map(function(c){return ka(c)}),i=0,o={},l=n.every(function(c,A){r.setStart(a,i),r.setEnd(a,i+c.length);var d=r.getBoundingClientRect();i+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,A===0?!0:f});return e.body.removeChild(t),l},zH=function(){return typeof new Image().crossOrigin<"u"},VH=function(){return typeof new XMLHttpRequest().responseType=="string"},$H=function(e){var t=new Image,r=e.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},wE=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},YH=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var a=t.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var n=new Image,i=t.toDataURL();n.src=i;var o=u2(r,r,0,0,n);return a.fillStyle="red",a.fillRect(0,0,r,r),EE(o).then(function(l){a.drawImage(l,0,0);var c=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var A=e.createElement("div");return A.style.backgroundImage="url("+i+")",A.style.height=r+"px",wE(c)?EE(u2(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return a.drawImage(l,0,0),wE(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},u2=function(e,t,r,a,n){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",a.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(n),o},EE=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){return t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Bn={get SUPPORT_RANGE_BOUNDS(){var e=HH(document);return Object.defineProperty(Bn,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Bn.SUPPORT_RANGE_BOUNDS&&GH(document);return Object.defineProperty(Bn,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=$H(document);return Object.defineProperty(Bn,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?YH(document):Promise.resolve(!1);return Object.defineProperty(Bn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=zH();return Object.defineProperty(Bn,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=VH();return Object.defineProperty(Bn,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Bn,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Bn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},wf=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),WH=function(e,t,r,a){var n=ZH(t,r),i=[],o=0;return n.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Bn.SUPPORT_RANGE_BOUNDS){var c=bE(a,o,l.length).getClientRects();if(c.length>1){var A=Hy(l),d=0;A.forEach(function(p){i.push(new wf(p,al.fromDOMRectList(e,bE(a,d+o,p.length).getClientRects()))),d+=p.length})}else i.push(new wf(l,al.fromDOMRectList(e,c)))}else{var f=a.splitText(l.length);i.push(new wf(l,XH(e,a))),a=f}else Bn.SUPPORT_RANGE_BOUNDS||(a=a.splitText(l.length));o+=l.length}),i},XH=function(e,t){var r=t.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(t.cloneNode(!0));var n=t.parentNode;if(n){n.replaceChild(a,t);var i=Fm(e,a);return a.firstChild&&n.replaceChild(a.firstChild,a),i}}return al.EMPTY},bE=function(e,t,r){var a=e.ownerDocument;if(!a)throw new Error("Node has no owner document");var n=a.createRange();return n.setStart(e,t),n.setEnd(e,t+r),n},Hy=function(e){if(Bn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return KH(e)},JH=function(e,t){if(Bn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(a){return a.segment})}return tG(e,t)},ZH=function(e,t){return t.letterSpacing!==0?Hy(e):JH(e,t)},eG=[32,160,4961,65792,65793,4153,4241],tG=function(e,t){for(var r=TQ(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),a=[],n,i=function(){if(n.value){var o=n.value.slice(),l=Rm(o),c="";l.forEach(function(A){eG.indexOf(A)===-1?c+=ka(A):(c.length&&a.push(c),a.push(ka(A)),c="")}),c.length&&a.push(c)}};!(n=r.next()).done;)i();return a},rG=function(){function e(t,r,a){this.text=aG(r.data,a.textTransform),this.textBounds=WH(t,this.text,a,r)}return e}(),aG=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(nG,sG);case 2:return e.toUpperCase();default:return e}},nG=/(^|\s|:|-|\(|\))([a-z])/g,sG=function(e,t,r){return e.length>0?t+r.toUpperCase():e},GB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.src=a.currentSrc||a.src,n.intrinsicWidth=a.naturalWidth,n.intrinsicHeight=a.naturalHeight,n.context.cache.addImage(n.src),n}return t}(_o),zB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a,n.intrinsicWidth=a.width,n.intrinsicHeight=a.height,n}return t}(_o),VB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this,i=new XMLSerializer,o=Fm(r,a);return a.setAttribute("width",o.width+"px"),a.setAttribute("height",o.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(a)),n.intrinsicWidth=a.width.baseVal.value,n.intrinsicHeight=a.height.baseVal.value,n.context.cache.addImage(n.svg),n}return t}(_o),$B=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t}(_o),f2=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.start=a.start,n.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,n}return t}(_o),iG=[{type:15,flags:0,unit:"px",number:3}],oG=[{type:16,flags:0,number:50}],lG=function(e){return e.width>e.height?new al(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new al(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},cG=function(e){var t=e.type===AG?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},$h="checkbox",Yh="radio",AG="password",_E=707406591,Gy=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;switch(n.type=a.type.toLowerCase(),n.checked=a.checked,n.value=cG(a),(n.type===$h||n.type===Yh)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=lG(n.bounds)),n.type){case $h:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=iG;break;case Yh:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=oG;break}return n}return t}(_o),YB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this,i=a.options[a.selectedIndex||0];return n.value=i&&i.text||"",n}return t}(_o),WB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t}(_o),XB=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;n.src=a.src,n.width=parseInt(a.width,10)||0,n.height=parseInt(a.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){n.tree=ZB(r,a.contentWindow.document.documentElement);var i=a.contentWindow.document.documentElement?yf(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):Jo.TRANSPARENT,o=a.contentWindow.document.body?yf(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):Jo.TRANSPARENT;n.backgroundColor=Wl(i)?Wl(o)?n.styles.backgroundColor:o:i}}catch{}return n}return t}(_o),dG=["OL","UL","MENU"],uh=function(e,t,r,a){for(var n=t.firstChild,i=void 0;n;n=i)if(i=n.nextSibling,eS(n)&&n.data.trim().length>0)r.textNodes.push(new rG(e,n,r.styles));else if(Ed(n))if(nS(n)&&n.assignedNodes)n.assignedNodes().forEach(function(l){return uh(e,l,r,a)});else{var o=JB(e,n);o.styles.isVisible()&&(uG(n,o,a)?o.flags|=4:fG(o.styles)&&(o.flags|=2),dG.indexOf(n.tagName)!==-1&&(o.flags|=8),r.elements.push(o),n.slot,n.shadowRoot?uh(e,n.shadowRoot,o,a):!Wh(n)&&!tS(n)&&!Xh(n)&&uh(e,n,o,a))}},JB=function(e,t){return h2(t)?new GB(e,t):rS(t)?new zB(e,t):tS(t)?new VB(e,t):pG(t)?new $B(e,t):hG(t)?new f2(e,t):mG(t)?new Gy(e,t):Xh(t)?new YB(e,t):Wh(t)?new WB(e,t):aS(t)?new XB(e,t):new _o(e,t)},ZB=function(e,t){var r=JB(e,t);return r.flags|=4,uh(e,t,r,r),r},uG=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||zy(e)&&r.styles.isTransparent()},fG=function(e){return e.isPositioned()||e.isFloating()},eS=function(e){return e.nodeType===Node.TEXT_NODE},Ed=function(e){return e.nodeType===Node.ELEMENT_NODE},p2=function(e){return Ed(e)&&typeof e.style<"u"&&!fh(e)},fh=function(e){return typeof e.className=="object"},pG=function(e){return e.tagName==="LI"},hG=function(e){return e.tagName==="OL"},mG=function(e){return e.tagName==="INPUT"},gG=function(e){return e.tagName==="HTML"},tS=function(e){return e.tagName==="svg"},zy=function(e){return e.tagName==="BODY"},rS=function(e){return e.tagName==="CANVAS"},CE=function(e){return e.tagName==="VIDEO"},h2=function(e){return e.tagName==="IMG"},aS=function(e){return e.tagName==="IFRAME"},BE=function(e){return e.tagName==="STYLE"},xG=function(e){return e.tagName==="SCRIPT"},Wh=function(e){return e.tagName==="TEXTAREA"},Xh=function(e){return e.tagName==="SELECT"},nS=function(e){return e.tagName==="SLOT"},SE=function(e){return e.tagName.indexOf("-")>0},yG=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(a){return r.counters[a].pop()})},e.prototype.parse=function(t){var r=this,a=t.counterIncrement,n=t.counterReset,i=!0;a!==null&&a.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&n.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),TE={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},OE={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},vG={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},wG={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},ZA=function(e,t,r,a,n,i){return e<t||e>r?Jf(e,n,i.length>0):a.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=a.values[c];return o},"")+i},sS=function(e,t,r,a){var n="";do r||e--,n=a(e)+n,e/=t;while(e*t>=t);return n},Fa=function(e,t,r,a,n){var i=r-t+1;return(e<0?"-":"")+(sS(Math.abs(e),i,a,function(o){return ka(Math.floor(o%i)+t)})+n)},Tc=function(e,t,r){r===void 0&&(r=". ");var a=t.length;return sS(Math.abs(e),a,!1,function(n){return t[Math.floor(n%a)]})+r},md=1,Nl=2,Fl=4,ef=8,Qo=function(e,t,r,a,n,i){if(e<-9999||e>9999)return Jf(e,4,n.length>0);var o=Math.abs(e),l=n;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&nn(i,md)&&l!==""?l=t[A]+l:A>1||A===1&&c===0||A===1&&c===1&&nn(i,Nl)||A===1&&c===1&&nn(i,Fl)&&e>100||A===1&&c>1&&nn(i,ef)?l=t[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?a:"")+l},IE="十百千萬",NE="拾佰仟萬",FE="マイナス",w1="마이너스",Jf=function(e,t,r){var a=r?". ":"",n=r?"、":"",i=r?", ":"",o=r?" ":"";switch(t){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var l=Fa(e,48,57,!0,a);return l.length<4?"0"+l:l;case 4:return Tc(e,"〇一二三四五六七八九",n);case 6:return ZA(e,1,3999,TE,3,a).toLowerCase();case 7:return ZA(e,1,3999,TE,3,a);case 8:return Fa(e,945,969,!1,a);case 9:return Fa(e,97,122,!1,a);case 10:return Fa(e,65,90,!1,a);case 11:return Fa(e,1632,1641,!0,a);case 12:case 49:return ZA(e,1,9999,OE,3,a);case 35:return ZA(e,1,9999,OE,3,a).toLowerCase();case 13:return Fa(e,2534,2543,!0,a);case 14:case 30:return Fa(e,6112,6121,!0,a);case 15:return Tc(e,"子丑寅卯辰巳午未申酉戌亥",n);case 16:return Tc(e,"甲乙丙丁戊己庚辛壬癸",n);case 17:case 48:return Qo(e,"零一二三四五六七八九",IE,"負",n,Nl|Fl|ef);case 47:return Qo(e,"零壹貳參肆伍陸柒捌玖",NE,"負",n,md|Nl|Fl|ef);case 42:return Qo(e,"零一二三四五六七八九",IE,"负",n,Nl|Fl|ef);case 41:return Qo(e,"零壹贰叁肆伍陆柒捌玖",NE,"负",n,md|Nl|Fl|ef);case 26:return Qo(e,"〇一二三四五六七八九","十百千万",FE,n,0);case 25:return Qo(e,"零壱弐参四伍六七八九","拾百千万",FE,n,md|Nl|Fl);case 31:return Qo(e,"영일이삼사오육칠팔구","십백천만",w1,i,md|Nl|Fl);case 33:return Qo(e,"零一二三四五六七八九","十百千萬",w1,i,0);case 32:return Qo(e,"零壹貳參四五六七八九","拾百千",w1,i,md|Nl|Fl);case 18:return Fa(e,2406,2415,!0,a);case 20:return ZA(e,1,19999,wG,3,a);case 21:return Fa(e,2790,2799,!0,a);case 22:return Fa(e,2662,2671,!0,a);case 22:return ZA(e,1,10999,vG,3,a);case 23:return Tc(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return Tc(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Fa(e,3302,3311,!0,a);case 28:return Tc(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",n);case 29:return Tc(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",n);case 34:return Fa(e,3792,3801,!0,a);case 37:return Fa(e,6160,6169,!0,a);case 38:return Fa(e,4160,4169,!0,a);case 39:return Fa(e,2918,2927,!0,a);case 40:return Fa(e,1776,1785,!0,a);case 43:return Fa(e,3046,3055,!0,a);case 44:return Fa(e,3174,3183,!0,a);case 45:return Fa(e,3664,3673,!0,a);case 46:return Fa(e,3872,3881,!0,a);case 3:default:return Fa(e,48,57,!0,a)}},iS="data-html2canvas-ignore",RE=function(){function e(t,r,a){if(this.context=t,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new yG,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var a=this,n=EG(t,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var i=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=n.contentWindow,c=l.document,A=CG(n).then(function(){return As(a,void 0,void 0,function(){var d,f;return Qn(this,function(p){switch(p.label){case 0:return this.scrolledElements.forEach(OG),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:p.sent(),p.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,_G(c)]:[3,4];case 3:p.sent(),p.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return n})]:[2,n]}})})});return c.open(),c.write(SG(document.doctype)+"<html></html>"),TG(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},e.prototype.createElementClone=function(t){if(d2(t,2))debugger;if(rS(t))return this.createCanvasClone(t);if(CE(t))return this.createVideoClone(t);if(BE(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return h2(r)&&(h2(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),SE(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return E1(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),n=t.cloneNode(!1);return n.textContent=a,n}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;var i=t.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var n=t.ownerDocument.createElement("canvas");return n.width=t.offsetWidth,n.height=t.offsetHeight,n},e.prototype.appendChildNode=function(t,r,a){(!Ed(r)||!xG(r)&&!r.hasAttribute(iS)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Ed(r)||!BE(r))&&t.appendChild(this.cloneNode(r,a))},e.prototype.cloneChildNodes=function(t,r,a){for(var n=this,i=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;i;i=i.nextSibling)if(Ed(i)&&nS(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return n.appendChildNode(r,l,a)})}else this.appendChildNode(r,i,a)},e.prototype.cloneNode=function(t,r){if(eS(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var a=t.ownerDocument.defaultView;if(a&&Ed(t)&&(p2(t)||fh(t))){var n=this.createElementClone(t);n.style.transitionProperty="none";var i=a.getComputedStyle(t),o=a.getComputedStyle(t,":before"),l=a.getComputedStyle(t,":after");this.referenceElement===t&&p2(n)&&(this.clonedReferenceElement=n),zy(n)&&FG(n);var c=this.counters.parse(new AE(this.context,i)),A=this.resolvePseudoContent(t,n,o,Ef.BEFORE);SE(t)&&(r=!0),CE(t)||this.cloneChildNodes(t,n,r),A&&n.insertBefore(A,n.firstChild);var d=this.resolvePseudoContent(t,n,l,Ef.AFTER);return d&&n.appendChild(d),this.counters.pop(c),(i&&(this.options.copyStyles||fh(t))&&!aS(t)||r)&&E1(i,n),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([n,t.scrollLeft,t.scrollTop]),(Wh(t)||Xh(t))&&(Wh(n)||Xh(n))&&(n.value=t.value),n}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,a,n){var i=this;if(a){var o=a.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||a.display==="none")){this.counters.parse(new AE(this.context,a));var c=new pH(this.context,a),A=l.createElement("html2canvaspseudoelement");E1(a,A),c.content.forEach(function(f){if(f.type===0)A.appendChild(l.createTextNode(f.value));else if(f.type===22){var p=l.createElement("img");p.src=f.value,p.style.opacity="1",A.appendChild(p)}else if(f.type===18){if(f.name==="attr"){var u=f.values.filter(zr);u.length&&A.appendChild(l.createTextNode(t.getAttribute(u[0].value)||""))}else if(f.name==="counter"){var g=f.values.filter(Hd),h=g[0],x=g[1];if(h&&zr(h)){var y=i.counters.getCounterValue(h.value),v=x&&zr(x)?A2.parse(i.context,x.value):3;A.appendChild(l.createTextNode(Jf(y,v,!1)))}}else if(f.name==="counters"){var E=f.values.filter(Hd),h=E[0],k=E[1],x=E[2];if(h&&zr(h)){var S=i.counters.getCounterValues(h.value),B=x&&zr(x)?A2.parse(i.context,x.value):3,b=k&&k.type===0?k.value:"",O=S.map(function(I){return Jf(I,B,!1)}).join(b);A.appendChild(l.createTextNode(O))}}}else if(f.type===20)switch(f.value){case"open-quote":A.appendChild(l.createTextNode(cE(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(cE(c.quotes,--i.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(f.value))}}),A.className=m2+" "+g2;var d=n===Ef.BEFORE?" "+m2:" "+g2;return fh(r)?r.className.baseValue+=d:r.className+=d,A}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),Ef;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Ef||(Ef={}));var EG=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(iS,"true"),e.body.appendChild(r),r},bG=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},_G=function(e){return Promise.all([].slice.call(e.images,0).map(bG))},CG=function(e){return new Promise(function(t,r){var a=e.contentWindow;if(!a)return r("No window assigned for iframe");var n=a.document;a.onload=e.onload=function(){a.onload=e.onload=null;var i=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(i),t(e))},50)}})},BG=["all","d","content"],E1=function(e,t){for(var r=e.length-1;r>=0;r--){var a=e.item(r);BG.indexOf(a)===-1&&t.style.setProperty(a,e.getPropertyValue(a))}return t},SG=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},TG=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},OG=function(e){var t=e[0],r=e[1],a=e[2];t.scrollLeft=r,t.scrollTop=a},IG=":before",NG=":after",m2="___html2canvas___pseudoelement_before",g2="___html2canvas___pseudoelement_after",kE=`{
    content: "" !important;
    display: none !important;
}`,FG=function(e){RG(e,"."+m2+IG+kE+`
         .`+g2+NG+kE)},RG=function(e,t){var r=e.ownerDocument;if(r){var a=r.createElement("style");a.textContent=t,e.appendChild(a)}},oS=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),kG=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(_1(t)||UG(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return As(this,void 0,void 0,function(){var r,a,n,i,o=this;return Qn(this,function(l){switch(l.label){case 0:return r=oS.isSameOrigin(t),a=!b1(t)&&this._options.useCORS===!0&&Bn.SUPPORT_CORS_IMAGES&&!r,n=!b1(t)&&!r&&!_1(t)&&typeof this._options.proxy=="string"&&Bn.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!b1(t)&&!_1(t)&&!n&&!a?[2]:(i=t,n?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,A){var d=new Image;d.onload=function(){return c(d)},d.onerror=A,(MG(i)||a)&&(d.crossOrigin="anonymous"),d.src=i,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var n=t.substring(0,256);return new Promise(function(i,o){var l=Bn.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return i(f.result)},!1),f.addEventListener("error",function(p){return o(p)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+n+" with status code "+c.status)},c.onerror=o;var A=a.indexOf("?")>-1?"&":"?";if(c.open("GET",""+a+A+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+n)}}c.send()})},e}(),DG=/^data:image\/svg\+xml/i,jG=/^data:image\/.*;base64,/i,LG=/^data:image\/.*/i,UG=function(e){return Bn.SUPPORT_SVG_DRAWING||!PG(e)},b1=function(e){return LG.test(e)},MG=function(e){return jG.test(e)},_1=function(e){return e.substr(0,4)==="blob"},PG=function(e){return e.substr(-3).toLowerCase()==="svg"||DG.test(e)},St=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),ed=function(e,t,r){return new St(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Qp=function(){function e(t,r,a,n){this.type=1,this.start=t,this.startControl=r,this.endControl=a,this.end=n}return e.prototype.subdivide=function(t,r){var a=ed(this.start,this.startControl,t),n=ed(this.startControl,this.endControl,t),i=ed(this.endControl,this.end,t),o=ed(a,n,t),l=ed(n,i,t),c=ed(o,l,t);return r?new e(this.start,a,o,c):new e(c,l,i,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),_i=function(e){return e.type===1},QG=function(){function e(t){var r=t.styles,a=t.bounds,n=Ju(r.borderTopLeftRadius,a.width,a.height),i=n[0],o=n[1],l=Ju(r.borderTopRightRadius,a.width,a.height),c=l[0],A=l[1],d=Ju(r.borderBottomRightRadius,a.width,a.height),f=d[0],p=d[1],u=Ju(r.borderBottomLeftRadius,a.width,a.height),g=u[0],h=u[1],x=[];x.push((i+c)/a.width),x.push((g+f)/a.width),x.push((o+h)/a.height),x.push((A+p)/a.height);var y=Math.max.apply(Math,x);y>1&&(i/=y,o/=y,c/=y,A/=y,f/=y,p/=y,g/=y,h/=y);var v=a.width-c,E=a.height-p,k=a.width-f,S=a.height-h,B=r.borderTopWidth,b=r.borderRightWidth,O=r.borderBottomWidth,_=r.borderLeftWidth,U=na(r.paddingTop,t.bounds.width),I=na(r.paddingRight,t.bounds.width),R=na(r.paddingBottom,t.bounds.width),L=na(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?da(a.left+_/3,a.top+B/3,i-_/3,o-B/3,kr.TOP_LEFT):new St(a.left+_/3,a.top+B/3),this.topRightBorderDoubleOuterBox=i>0||o>0?da(a.left+v,a.top+B/3,c-b/3,A-B/3,kr.TOP_RIGHT):new St(a.left+a.width-b/3,a.top+B/3),this.bottomRightBorderDoubleOuterBox=f>0||p>0?da(a.left+k,a.top+E,f-b/3,p-O/3,kr.BOTTOM_RIGHT):new St(a.left+a.width-b/3,a.top+a.height-O/3),this.bottomLeftBorderDoubleOuterBox=g>0||h>0?da(a.left+_/3,a.top+S,g-_/3,h-O/3,kr.BOTTOM_LEFT):new St(a.left+_/3,a.top+a.height-O/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?da(a.left+_*2/3,a.top+B*2/3,i-_*2/3,o-B*2/3,kr.TOP_LEFT):new St(a.left+_*2/3,a.top+B*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?da(a.left+v,a.top+B*2/3,c-b*2/3,A-B*2/3,kr.TOP_RIGHT):new St(a.left+a.width-b*2/3,a.top+B*2/3),this.bottomRightBorderDoubleInnerBox=f>0||p>0?da(a.left+k,a.top+E,f-b*2/3,p-O*2/3,kr.BOTTOM_RIGHT):new St(a.left+a.width-b*2/3,a.top+a.height-O*2/3),this.bottomLeftBorderDoubleInnerBox=g>0||h>0?da(a.left+_*2/3,a.top+S,g-_*2/3,h-O*2/3,kr.BOTTOM_LEFT):new St(a.left+_*2/3,a.top+a.height-O*2/3),this.topLeftBorderStroke=i>0||o>0?da(a.left+_/2,a.top+B/2,i-_/2,o-B/2,kr.TOP_LEFT):new St(a.left+_/2,a.top+B/2),this.topRightBorderStroke=i>0||o>0?da(a.left+v,a.top+B/2,c-b/2,A-B/2,kr.TOP_RIGHT):new St(a.left+a.width-b/2,a.top+B/2),this.bottomRightBorderStroke=f>0||p>0?da(a.left+k,a.top+E,f-b/2,p-O/2,kr.BOTTOM_RIGHT):new St(a.left+a.width-b/2,a.top+a.height-O/2),this.bottomLeftBorderStroke=g>0||h>0?da(a.left+_/2,a.top+S,g-_/2,h-O/2,kr.BOTTOM_LEFT):new St(a.left+_/2,a.top+a.height-O/2),this.topLeftBorderBox=i>0||o>0?da(a.left,a.top,i,o,kr.TOP_LEFT):new St(a.left,a.top),this.topRightBorderBox=c>0||A>0?da(a.left+v,a.top,c,A,kr.TOP_RIGHT):new St(a.left+a.width,a.top),this.bottomRightBorderBox=f>0||p>0?da(a.left+k,a.top+E,f,p,kr.BOTTOM_RIGHT):new St(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=g>0||h>0?da(a.left,a.top+S,g,h,kr.BOTTOM_LEFT):new St(a.left,a.top+a.height),this.topLeftPaddingBox=i>0||o>0?da(a.left+_,a.top+B,Math.max(0,i-_),Math.max(0,o-B),kr.TOP_LEFT):new St(a.left+_,a.top+B),this.topRightPaddingBox=c>0||A>0?da(a.left+Math.min(v,a.width-b),a.top+B,v>a.width+b?0:Math.max(0,c-b),Math.max(0,A-B),kr.TOP_RIGHT):new St(a.left+a.width-b,a.top+B),this.bottomRightPaddingBox=f>0||p>0?da(a.left+Math.min(k,a.width-_),a.top+Math.min(E,a.height-O),Math.max(0,f-b),Math.max(0,p-O),kr.BOTTOM_RIGHT):new St(a.left+a.width-b,a.top+a.height-O),this.bottomLeftPaddingBox=g>0||h>0?da(a.left+_,a.top+Math.min(S,a.height-O),Math.max(0,g-_),Math.max(0,h-O),kr.BOTTOM_LEFT):new St(a.left+_,a.top+a.height-O),this.topLeftContentBox=i>0||o>0?da(a.left+_+L,a.top+B+U,Math.max(0,i-(_+L)),Math.max(0,o-(B+U)),kr.TOP_LEFT):new St(a.left+_+L,a.top+B+U),this.topRightContentBox=c>0||A>0?da(a.left+Math.min(v,a.width+_+L),a.top+B+U,v>a.width+_+L?0:c-_+L,A-(B+U),kr.TOP_RIGHT):new St(a.left+a.width-(b+I),a.top+B+U),this.bottomRightContentBox=f>0||p>0?da(a.left+Math.min(k,a.width-(_+L)),a.top+Math.min(E,a.height+B+U),Math.max(0,f-(b+I)),p-(O+R),kr.BOTTOM_RIGHT):new St(a.left+a.width-(b+I),a.top+a.height-(O+R)),this.bottomLeftContentBox=g>0||h>0?da(a.left+_+L,a.top+S,Math.max(0,g-(_+L)),h-(O+R),kr.BOTTOM_LEFT):new St(a.left+_+L,a.top+a.height-(O+R))}return e}(),kr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(kr||(kr={}));var da=function(e,t,r,a,n){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=a*i,c=e+r,A=t+a;switch(n){case kr.TOP_LEFT:return new Qp(new St(e,A),new St(e,A-l),new St(c-o,t),new St(c,t));case kr.TOP_RIGHT:return new Qp(new St(e,t),new St(e+o,t),new St(c,A-l),new St(c,A));case kr.BOTTOM_RIGHT:return new Qp(new St(c,t),new St(c,t+l),new St(e+o,A),new St(e,A));case kr.BOTTOM_LEFT:default:return new Qp(new St(c,A),new St(c-o,A),new St(e,t+l),new St(e,t))}},Jh=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},qG=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Zh=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},KG=function(){function e(t,r,a){this.offsetX=t,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return e}(),qp=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),HG=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),GG=function(e){return e.type===0},lS=function(e){return e.type===1},zG=function(e){return e.type===2},DE=function(e,t){return e.length===t.length?e.some(function(r,a){return r===t[a]}):!1},VG=function(e,t,r,a,n){return e.map(function(i,o){switch(o){case 0:return i.add(t,r);case 1:return i.add(t+a,r);case 2:return i.add(t+a,r+n);case 3:return i.add(t,r+n)}return i})},cS=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),AS=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new QG(this.container),this.container.styles.opacity<1&&this.effects.push(new HG(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new KG(a,n,i))}if(this.container.styles.overflowX!==0){var o=Jh(this.curves),l=Zh(this.curves);DE(o,l)?this.effects.push(new qp(o,6)):(this.effects.push(new qp(o,2)),this.effects.push(new qp(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,n=this.effects.slice(0);a;){var i=a.effects.filter(function(c){return!lS(c)});if(r||a.container.styles.position!==0||!a.parent){if(n.unshift.apply(n,i),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var o=Jh(a.curves),l=Zh(a.curves);DE(o,l)||n.unshift(new qp(l,6))}}else n.unshift.apply(n,i);a=a.parent}return n.filter(function(c){return nn(c.target,t)})},e}(),x2=function(e,t,r,a){e.container.elements.forEach(function(n){var i=nn(n.flags,4),o=nn(n.flags,2),l=new AS(n,e);nn(n.styles.display,2048)&&a.push(l);var c=nn(n.flags,8)?[]:a;if(i||o){var A=i||n.styles.isPositioned()?r:t,d=new cS(l);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var f=n.styles.zIndex.order;if(f<0){var p=0;A.negativeZIndex.some(function(g,h){return f>g.element.container.styles.zIndex.order?(p=h,!1):p>0}),A.negativeZIndex.splice(p,0,d)}else if(f>0){var u=0;A.positiveZIndex.some(function(g,h){return f>=g.element.container.styles.zIndex.order?(u=h+1,!1):u>0}),A.positiveZIndex.splice(u,0,d)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else n.styles.isFloating()?A.nonPositionedFloats.push(d):A.nonPositionedInlineLevel.push(d);x2(l,d,i?d:r,c)}else n.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),x2(l,t,r,c);nn(n.flags,8)&&dS(n,c)})},dS=function(e,t){for(var r=e instanceof f2?e.start:1,a=e instanceof f2?e.reversed:!1,n=0;n<t.length;n++){var i=t[n];i.container instanceof $B&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=Jf(r,i.container.styles.listStyleType,!0),r+=a?-1:1}},$G=function(e){var t=new AS(e,null),r=new cS(t),a=[];return x2(t,r,r,a),dS(t.container,a),r},jE=function(e,t){switch(t){case 0:return Si(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Si(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Si(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Si(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},YG=function(e,t){switch(t){case 0:return Si(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Si(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Si(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Si(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},WG=function(e,t){switch(t){case 0:return Si(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Si(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Si(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Si(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},XG=function(e,t){switch(t){case 0:return Kp(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Kp(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Kp(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Kp(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Kp=function(e,t){var r=[];return _i(e)?r.push(e.subdivide(.5,!1)):r.push(e),_i(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Si=function(e,t,r,a){var n=[];return _i(e)?n.push(e.subdivide(.5,!1)):n.push(e),_i(r)?n.push(r.subdivide(.5,!0)):n.push(r),_i(a)?n.push(a.subdivide(.5,!0).reverse()):n.push(a),_i(t)?n.push(t.subdivide(.5,!1).reverse()):n.push(t),n},uS=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},em=function(e){var t=e.styles,r=e.bounds,a=na(t.paddingLeft,r.width),n=na(t.paddingRight,r.width),i=na(t.paddingTop,r.width),o=na(t.paddingBottom,r.width);return r.add(a+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+a+n),-(t.borderTopWidth+t.borderBottomWidth+i+o))},JG=function(e,t){return e===0?t.bounds:e===2?em(t):uS(t)},ZG=function(e,t){return e===0?t.bounds:e===2?em(t):uS(t)},C1=function(e,t,r){var a=JG(gd(e.styles.backgroundOrigin,t),e),n=ZG(gd(e.styles.backgroundClip,t),e),i=ez(gd(e.styles.backgroundSize,t),r,a),o=i[0],l=i[1],c=Ju(gd(e.styles.backgroundPosition,t),a.width-o,a.height-l),A=tz(gd(e.styles.backgroundRepeat,t),c,i,a,n),d=Math.round(a.left+c[0]),f=Math.round(a.top+c[1]);return[A,d,f,o,l]},td=function(e){return zr(e)&&e.value===Dd.AUTO},Hp=function(e){return typeof e=="number"},ez=function(e,t,r){var a=t[0],n=t[1],i=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(Wa(o)&&l&&Wa(l))return[na(o,r.width),na(l,r.height)];var c=Hp(i);if(zr(o)&&(o.value===Dd.CONTAIN||o.value===Dd.COVER)){if(Hp(i)){var A=r.width/r.height;return A<i!=(o.value===Dd.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var d=Hp(a),f=Hp(n),p=d||f;if(td(o)&&(!l||td(l))){if(d&&f)return[a,n];if(!c&&!p)return[r.width,r.height];if(p&&c){var u=d?a:n*i,g=f?n:a/i;return[u,g]}var h=d?a:r.width,x=f?n:r.height;return[h,x]}if(c){var y=0,v=0;return Wa(o)?y=na(o,r.width):Wa(l)&&(v=na(l,r.height)),td(o)?y=v*i:(!l||td(l))&&(v=y/i),[y,v]}var E=null,k=null;if(Wa(o)?E=na(o,r.width):l&&Wa(l)&&(k=na(l,r.height)),E!==null&&(!l||td(l))&&(k=d&&f?E/a*n:r.height),k!==null&&td(o)&&(E=d&&f?k/n*a:r.width),E!==null&&k!==null)return[E,k];throw new Error("Unable to calculate background-size for element")},gd=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},tz=function(e,t,r,a,n){var i=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new St(Math.round(a.left),Math.round(a.top+o)),new St(Math.round(a.left+a.width),Math.round(a.top+o)),new St(Math.round(a.left+a.width),Math.round(c+a.top+o)),new St(Math.round(a.left),Math.round(c+a.top+o))];case 3:return[new St(Math.round(a.left+i),Math.round(a.top)),new St(Math.round(a.left+i+l),Math.round(a.top)),new St(Math.round(a.left+i+l),Math.round(a.height+a.top)),new St(Math.round(a.left+i),Math.round(a.height+a.top))];case 1:return[new St(Math.round(a.left+i),Math.round(a.top+o)),new St(Math.round(a.left+i+l),Math.round(a.top+o)),new St(Math.round(a.left+i+l),Math.round(a.top+o+c)),new St(Math.round(a.left+i),Math.round(a.top+o+c))];default:return[new St(Math.round(n.left),Math.round(n.top)),new St(Math.round(n.left+n.width),Math.round(n.top)),new St(Math.round(n.left+n.width),Math.round(n.height+n.top)),new St(Math.round(n.left),Math.round(n.height+n.top))]}},rz="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",LE="Hidden Text",az=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var a=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",o.appendChild(a),n.src=rz,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(LE)),a.appendChild(i),a.appendChild(n);var l=n.offsetTop-i.offsetTop+2;a.removeChild(i),a.appendChild(this._document.createTextNode(LE)),a.style.lineHeight="normal",n.style.verticalAlign="super";var c=n.offsetTop-a.offsetTop+2;return o.removeChild(a),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var a=t+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(t,r)),this._data[a]},e}(),fS=function(){function e(t,r){this.context=t,this.options=r}return e}(),nz=1e4,sz=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n._activeEffects=[],n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),a.canvas||(n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px"),n.fontMetrics=new az(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),n}return t.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return a.applyEffect(n)})},t.prototype.applyEffect=function(r){this.ctx.save(),zG(r)&&(this.ctx.globalAlpha=r.opacity),GG(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),lS(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return As(this,void 0,void 0,function(){var a;return Qn(this,function(n){switch(n.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return As(this,void 0,void 0,function(){return Qn(this,function(a){switch(a.label){case 0:if(nn(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,a,n){var i=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var o=Hy(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+n),l+i.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),n=Az(r.fontFamily).join(", "),i=h0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,i,n].join(" "),n,i]},t.prototype.renderTextNode=function(r,a){return As(this,void 0,void 0,function(){var n,i,o,l,c,A,d,f,p=this;return Qn(this,function(u){return n=this.createFontStyle(a),i=n[0],o=n[1],l=n[2],this.ctx.font=i,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,d=c.middle,f=a.paintOrder,r.textBounds.forEach(function(g){f.forEach(function(h){switch(h){case 0:p.ctx.fillStyle=pn(a.color),p.renderTextWithLetterSpacing(g,a.letterSpacing,A);var x=a.textShadow;x.length&&g.text.trim().length&&(x.slice(0).reverse().forEach(function(y){p.ctx.shadowColor=pn(y.color),p.ctx.shadowOffsetX=y.offsetX.number*p.options.scale,p.ctx.shadowOffsetY=y.offsetY.number*p.options.scale,p.ctx.shadowBlur=y.blur.number,p.renderTextWithLetterSpacing(g,a.letterSpacing,A)}),p.ctx.shadowColor="",p.ctx.shadowOffsetX=0,p.ctx.shadowOffsetY=0,p.ctx.shadowBlur=0),a.textDecorationLine.length&&(p.ctx.fillStyle=pn(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(y){switch(y){case 1:p.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top+A),g.bounds.width,1);break;case 2:p.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top),g.bounds.width,1);break;case 3:p.ctx.fillRect(g.bounds.left,Math.ceil(g.bounds.top+d),g.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&g.text.trim().length&&(p.ctx.strokeStyle=pn(a.webkitTextStrokeColor),p.ctx.lineWidth=a.webkitTextStrokeWidth,p.ctx.lineJoin=window.chrome?"miter":"round",p.ctx.strokeText(g.text,g.bounds.left,g.bounds.top+A)),p.ctx.strokeStyle="",p.ctx.lineWidth=0,p.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,a,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=em(r),o=Zh(a);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return As(this,void 0,void 0,function(){var a,n,i,o,l,c,v,v,A,d,f,p,k,u,g,S,h,x,y,v,E,k,S;return Qn(this,function(B){switch(B.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,n=r.curves,i=a.styles,o=0,l=a.textNodes,B.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:B.sent(),B.label=3;case 3:return o++,[3,1];case 4:if(!(a instanceof GB))return[3,8];B.label=5;case 5:return B.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return v=B.sent(),this.renderReplacedElement(a,n,v),[3,8];case 7:return B.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof zB&&this.renderReplacedElement(a,n,a.canvas),!(a instanceof VB))return[3,12];B.label=9;case 9:return B.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return v=B.sent(),this.renderReplacedElement(a,n,v),[3,12];case 11:return B.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof XB&&a.tree?(A=new t(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,A.render(a.tree)]):[3,14];case 13:d=B.sent(),a.width&&a.height&&this.ctx.drawImage(d,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),B.label=14;case 14:if(a instanceof Gy&&(f=Math.min(a.bounds.width,a.bounds.height),a.type===$h?a.checked&&(this.ctx.save(),this.path([new St(a.bounds.left+f*.39363,a.bounds.top+f*.79),new St(a.bounds.left+f*.16,a.bounds.top+f*.5549),new St(a.bounds.left+f*.27347,a.bounds.top+f*.44071),new St(a.bounds.left+f*.39694,a.bounds.top+f*.5649),new St(a.bounds.left+f*.72983,a.bounds.top+f*.23),new St(a.bounds.left+f*.84,a.bounds.top+f*.34085),new St(a.bounds.left+f*.39363,a.bounds.top+f*.79)]),this.ctx.fillStyle=pn(_E),this.ctx.fill(),this.ctx.restore()):a.type===Yh&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+f/2,a.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=pn(_E),this.ctx.fill(),this.ctx.restore())),iz(a)&&a.value.length){switch(p=this.createFontStyle(i),k=p[0],u=p[1],g=this.fontMetrics.getMetrics(k,u).baseline,this.ctx.font=k,this.ctx.fillStyle=pn(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=lz(a.styles.textAlign),S=em(a),h=0,a.styles.textAlign){case 1:h+=S.width/2;break;case 2:h+=S.width;break}x=S.add(h,0,0,-S.height/2+1),this.ctx.save(),this.path([new St(S.left,S.top),new St(S.left+S.width,S.top),new St(S.left+S.width,S.top+S.height),new St(S.left,S.top+S.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new wf(a.value,x),i.letterSpacing,g),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!nn(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(y=a.styles.listStyleImage,y.type!==0)return[3,18];v=void 0,E=y.url,B.label=15;case 15:return B.trys.push([15,17,,18]),[4,this.context.cache.match(E)];case 16:return v=B.sent(),this.ctx.drawImage(v,a.bounds.left-(v.width+10),a.bounds.top),[3,18];case 17:return B.sent(),this.context.logger.error("Error loading list-style-image "+E),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(k=this.createFontStyle(i)[0],this.ctx.font=k,this.ctx.fillStyle=pn(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",S=new al(a.bounds.left,a.bounds.top+na(a.styles.paddingTop,a.bounds.width),a.bounds.width,oE(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new wf(r.listValue,S),i.letterSpacing,oE(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),B.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return As(this,void 0,void 0,function(){var a,n,y,i,o,y,l,c,y,A,d,y,f,p,y,u,g,y,h,x,y;return Qn(this,function(v){switch(v.label){case 0:if(nn(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:v.sent(),a=0,n=r.negativeZIndex,v.label=2;case 2:return a<n.length?(y=n[a],[4,this.renderStack(y)]):[3,5];case 3:v.sent(),v.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:v.sent(),i=0,o=r.nonInlineLevel,v.label=7;case 7:return i<o.length?(y=o[i],[4,this.renderNode(y)]):[3,10];case 8:v.sent(),v.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,v.label=11;case 11:return l<c.length?(y=c[l],[4,this.renderStack(y)]):[3,14];case 12:v.sent(),v.label=13;case 13:return l++,[3,11];case 14:A=0,d=r.nonPositionedInlineLevel,v.label=15;case 15:return A<d.length?(y=d[A],[4,this.renderStack(y)]):[3,18];case 16:v.sent(),v.label=17;case 17:return A++,[3,15];case 18:f=0,p=r.inlineLevel,v.label=19;case 19:return f<p.length?(y=p[f],[4,this.renderNode(y)]):[3,22];case 20:v.sent(),v.label=21;case 21:return f++,[3,19];case 22:u=0,g=r.zeroOrAutoZIndexOrTransformedOrOpacity,v.label=23;case 23:return u<g.length?(y=g[u],[4,this.renderStack(y)]):[3,26];case 24:v.sent(),v.label=25;case 25:return u++,[3,23];case 26:h=0,x=r.positiveZIndex,v.label=27;case 27:return h<x.length?(y=x[h],[4,this.renderStack(y)]):[3,30];case 28:v.sent(),v.label=29;case 29:return h++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var a=this;r.forEach(function(n,i){var o=_i(n)?n.start:n;i===0?a.ctx.moveTo(o.x,o.y):a.ctx.lineTo(o.x,o.y),_i(n)&&a.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},t.prototype.renderRepeat=function(r,a,n,i){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(n,i),this.ctx.fill(),this.ctx.translate(-n,-i)},t.prototype.resizeImage=function(r,a,n){var i;if(r.width===a&&r.height===n)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,a),l.height=Math.max(1,n);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,a,n),l},t.prototype.renderBackgroundImage=function(r){return As(this,void 0,void 0,function(){var a,n,i,o,l,c;return Qn(this,function(A){switch(A.label){case 0:a=r.styles.backgroundImage.length-1,n=function(d){var f,p,u,U,Q,Y,L,N,O,g,U,Q,Y,L,N,h,x,y,v,E,k,S,B,b,O,_,U,I,R,L,N,P,Q,Y,ee,V,G,z,C,D,j,K;return Qn(this,function(W){switch(W.label){case 0:if(d.type!==0)return[3,5];f=void 0,p=d.url,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,i.context.cache.match(p)];case 2:return f=W.sent(),[3,4];case 3:return W.sent(),i.context.logger.error("Error loading background-image "+p),[3,4];case 4:return f&&(u=C1(r,a,[f.width,f.height,f.width/f.height]),U=u[0],Q=u[1],Y=u[2],L=u[3],N=u[4],O=i.ctx.createPattern(i.resizeImage(f,L,N),"repeat"),i.renderRepeat(U,O,Q,Y)),[3,6];case 5:Gq(d)?(g=C1(r,a,[null,null,null]),U=g[0],Q=g[1],Y=g[2],L=g[3],N=g[4],h=Pq(d.angle,L,N),x=h[0],y=h[1],v=h[2],E=h[3],k=h[4],S=document.createElement("canvas"),S.width=L,S.height=N,B=S.getContext("2d"),b=B.createLinearGradient(y,E,v,k),sE(d.stops,x).forEach(function(Ae){return b.addColorStop(Ae.stop,pn(Ae.color))}),B.fillStyle=b,B.fillRect(0,0,L,N),L>0&&N>0&&(O=i.ctx.createPattern(S,"repeat"),i.renderRepeat(U,O,Q,Y))):zq(d)&&(_=C1(r,a,[null,null,null]),U=_[0],I=_[1],R=_[2],L=_[3],N=_[4],P=d.position.length===0?[Qy]:d.position,Q=na(P[0],L),Y=na(P[P.length-1],N),ee=Qq(d,Q,Y,L,N),V=ee[0],G=ee[1],V>0&&G>0&&(z=i.ctx.createRadialGradient(I+Q,R+Y,0,I+Q,R+Y,V),sE(d.stops,V*2).forEach(function(Ae){return z.addColorStop(Ae.stop,pn(Ae.color))}),i.path(U),i.ctx.fillStyle=z,V!==G?(C=r.bounds.left+.5*r.bounds.width,D=r.bounds.top+.5*r.bounds.height,j=G/V,K=1/j,i.ctx.save(),i.ctx.translate(C,D),i.ctx.transform(1,0,0,j,0,0),i.ctx.translate(-C,-D),i.ctx.fillRect(I,K*(R-D)+D,L,N*K),i.ctx.restore()):i.ctx.fill())),W.label=6;case 6:return a--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,n(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,a,n){return As(this,void 0,void 0,function(){return Qn(this,function(i){return this.path(jE(n,a)),this.ctx.fillStyle=pn(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,a,n,i){return As(this,void 0,void 0,function(){var o,l;return Qn(this,function(c){switch(c.label){case 0:return a<3?[4,this.renderSolidBorder(r,n,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=YG(i,n),this.path(o),this.ctx.fillStyle=pn(r),this.ctx.fill(),l=WG(i,n),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return As(this,void 0,void 0,function(){var a,n,i,o,l,c,A,d,f=this;return Qn(this,function(p){switch(p.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,n=!Wl(a.backgroundColor)||a.backgroundImage.length,i=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],o=oz(gd(a.backgroundClip,0),r.curves),n||a.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Wl(a.backgroundColor)||(this.ctx.fillStyle=pn(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:p.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(u){f.ctx.save();var g=Jh(r.curves),h=u.inset?0:nz,x=VG(g,-h+(u.inset?1:-1)*u.spread.number,(u.inset?1:-1)*u.spread.number,u.spread.number*(u.inset?-2:2),u.spread.number*(u.inset?-2:2));u.inset?(f.path(g),f.ctx.clip(),f.mask(x)):(f.mask(g),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=u.offsetX.number+h,f.ctx.shadowOffsetY=u.offsetY.number,f.ctx.shadowColor=pn(u.color),f.ctx.shadowBlur=u.blur.number,f.ctx.fillStyle=u.inset?pn(u.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),p.label=2;case 2:l=0,c=0,A=i,p.label=3;case 3:return c<A.length?(d=A[c],d.style!==0&&!Wl(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return p.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return p.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return p.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:p.sent(),p.label=11;case 11:l++,p.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,a,n,i,o){return As(this,void 0,void 0,function(){var l,c,A,d,f,p,u,g,h,x,y,v,E,k,S,B,S,B;return Qn(this,function(b){return this.ctx.save(),l=XG(i,n),c=jE(i,n),o===2&&(this.path(c),this.ctx.clip()),_i(c[0])?(A=c[0].start.x,d=c[0].start.y):(A=c[0].x,d=c[0].y),_i(c[1])?(f=c[1].end.x,p=c[1].end.y):(f=c[1].x,p=c[1].y),n===0||n===2?u=Math.abs(A-f):u=Math.abs(d-p),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),g=a<3?a*3:a*2,h=a<3?a*2:a,o===3&&(g=a,h=a),x=!0,u<=g*2?x=!1:u<=g*2+h?(y=u/(2*g+h),g*=y,h*=y):(v=Math.floor((u+h)/(g+h)),E=(u-v*g)/(v-1),k=(u-(v+1)*g)/v,h=k<=0||Math.abs(h-E)<Math.abs(h-k)?E:k),x&&(o===3?this.ctx.setLineDash([0,g+h]):this.ctx.setLineDash([g,h])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=pn(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(_i(c[0])&&(S=c[3],B=c[0],this.ctx.beginPath(),this.formatPath([new St(S.end.x,S.end.y),new St(B.start.x,B.start.y)]),this.ctx.stroke()),_i(c[1])&&(S=c[1],B=c[2],this.ctx.beginPath(),this.formatPath([new St(S.end.x,S.end.y),new St(B.start.x,B.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return As(this,void 0,void 0,function(){var a;return Qn(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=pn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=$G(r),[4,this.renderStack(a)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(fS),iz=function(e){return e instanceof WB||e instanceof YB?!0:e instanceof Gy&&e.type!==Yh&&e.type!==$h},oz=function(e,t){switch(e){case 0:return Jh(t);case 2:return qG(t);case 1:default:return Zh(t)}},lz=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},cz=["-apple-system","system-ui"],Az=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return cz.indexOf(t)===-1}):e},dz=function(e){Xi(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=a,n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),n}return t.prototype.render=function(r){return As(this,void 0,void 0,function(){var a,n;return Qn(this,function(i){switch(i.label){case 0:return a=u2(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,uz(a)];case 1:return n=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=pn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(fS),uz=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},fz=function(){function e(t){var r=t.id,a=t.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Ep([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Ep([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Ep([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Ep([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),pz=function(){function e(t,r){var a;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new fz({id:this.instanceName,enabled:t.logging}),this.cache=(a=t.cache)!==null&&a!==void 0?a:new kG(this,t)}return e.instanceCount=1,e}(),Vy=function(e,t){return t===void 0&&(t={}),hz(e,t)};typeof window<"u"&&oS.setContext(window);var hz=function(e,t){return As(void 0,void 0,void 0,function(){var r,a,n,i,o,l,c,A,d,f,p,u,g,h,x,y,v,E,k,S,b,B,b,O,_,U,I,R,L,N,P,Q,Y,ee,V,G,z,C,D,j;return Qn(this,function(K){switch(K.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return n={allowTaint:(O=t.allowTaint)!==null&&O!==void 0?O:!1,imageTimeout:(_=t.imageTimeout)!==null&&_!==void 0?_:15e3,proxy:t.proxy,useCORS:(U=t.useCORS)!==null&&U!==void 0?U:!1},i=Xx({logging:(I=t.logging)!==null&&I!==void 0?I:!0,cache:t.cache},n),o={windowWidth:(R=t.windowWidth)!==null&&R!==void 0?R:a.innerWidth,windowHeight:(L=t.windowHeight)!==null&&L!==void 0?L:a.innerHeight,scrollX:(N=t.scrollX)!==null&&N!==void 0?N:a.pageXOffset,scrollY:(P=t.scrollY)!==null&&P!==void 0?P:a.pageYOffset},l=new al(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new pz(i,l),A=(Q=t.foreignObjectRendering)!==null&&Q!==void 0?Q:!1,d={allowTaint:(Y=t.allowTaint)!==null&&Y!==void 0?Y:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new RE(c,e,d),p=f.clonedReferenceElement,p?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return u=K.sent(),g=zy(p)||gG(p)?V9(p.ownerDocument):Fm(c,p),h=g.width,x=g.height,y=g.left,v=g.top,E=mz(c,p,t.backgroundColor),k={canvas:t.canvas,backgroundColor:E,scale:(V=(ee=t.scale)!==null&&ee!==void 0?ee:a.devicePixelRatio)!==null&&V!==void 0?V:1,x:((G=t.x)!==null&&G!==void 0?G:0)+y,y:((z=t.y)!==null&&z!==void 0?z:0)+v,width:(C=t.width)!==null&&C!==void 0?C:Math.ceil(h),height:(D=t.height)!==null&&D!==void 0?D:Math.ceil(x)},A?(c.logger.debug("Document cloned, using foreign object rendering"),b=new dz(c,k),[4,b.render(p)]):[3,3];case 2:return S=K.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+y+","+v+" with size "+h+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),B=ZB(c,p),E===B.styles.backgroundColor&&(B.styles.backgroundColor=Jo.TRANSPARENT),c.logger.debug("Starting renderer for element at "+k.x+","+k.y+" with size "+k.width+"x"+k.height),b=new sz(c,k),[4,b.render(B)];case 4:S=K.sent(),K.label=5;case 5:return(!((j=t.removeContainer)!==null&&j!==void 0)||j)&&(RE.destroy(u)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,S]}})})},mz=function(e,t,r){var a=t.ownerDocument,n=a.documentElement?yf(e,getComputedStyle(a.documentElement).backgroundColor):Jo.TRANSPARENT,i=a.body?yf(e,getComputedStyle(a.body).backgroundColor):Jo.TRANSPARENT,o=typeof r=="string"?yf(e,r):r===null?Jo.TRANSPARENT:4294967295;return t===a.documentElement?Wl(n)?Wl(i)?o:i:n:o};const gz=Object.freeze(Object.defineProperty({__proto__:null,default:Vy},Symbol.toStringTag,{value:"Module"})),xz=({title:e,subtitle:t})=>{const r=$i(),a=dc(),[n,i]=M.useState(!1),o=a.pathname==="/settings"||a.pathname==="#/settings"||a.hash==="#/settings",l=()=>`# ОПИСАНИЕ ФУНКЦИОНАЛА CMS - СИСТЕМА УПРАВЛЕНИЯ ЗАЛОГОВЫМ ИМУЩЕСТВОМ

**Версия:** 2.0.0  
**Дата:** Декабрь 2024  
**Технологии:** React 18, TypeScript, Ant Design 5, Redux Toolkit, IndexedDB

---

## 📋 ОГЛАВЛЕНИЕ

1. Реестр объектов
2. Залоговый портфель
3. Задачи
4. KPI
5. Отчеты
6. Залоговое досье
7. Залоговые заключения
8. Страхование
9. ФНП
10. Аналитика
11. Модуль мониторинга
12. Модуль оценки
13. CMS Check
14. ЕГРН
15. Загрузка
16. Мониторинг
17. Справочная с ИИ
18. Настройки

---

## 1. РЕЕСТР ОБЪЕКТОВ

**Путь:** /registry

### Основной функционал:
- **Управление карточками залогового имущества** - полный CRUD (создание, чтение, обновление, удаление)
- **Расширенная классификация объектов** - 60+ типов объектов с 3-уровневой иерархией
- **Динамические формы** - 150+ полей характеристик, автоматически подстраивающихся под тип объекта
- **Многостраничная форма карточки** (5 вкладок): Основная информация, Адрес, Характеристики, Партнеры, Документы
- **Фильтрация и поиск** - по всем полям карточки
- **Сортировка** - по любому столбцу таблицы
- **Экспорт/импорт** - Excel формат для массовых операций
- **Резервное копирование** - экспорт/импорт всей базы данных

---

## 2. ЗАЛОГОВЫЙ ПОРТФЕЛЬ

**Путь:** /portfolio

### Основной функционал:
- **Агрегированное представление залогового портфеля**
- **Аналитика портфеля** - статистика по категориям, статусам, стоимости
- **Фильтрация и группировка** объектов залога
- **Визуализация данных** - графики и диаграммы портфеля
- **Оценка рисков** портфеля

---

## 3. ЗАДАЧИ

**Путь:** /tasks

### Основной функционал:
- **Управление задачами** (Zadachnik) - система задач для сотрудников
- **Создание задач** - назначение задач сотрудникам с приоритетами и сроками
- **Статусы задач** - планируется, в работе, выполнено, отменено
- **Приоритеты** - низкий, средний, высокий, критический
- **Назначение исполнителей** - привязка задач к сотрудникам
- **Фильтрация задач** - по статусу, приоритету, исполнителю, региону
- **Автогенерация задач** - автоматическое создание задач для активных сотрудников

---

## 4. KPI

**Путь:** /kpi

### Основной функционал:
- **KPI и аналитика** - ключевые показатели эффективности
- **Метрики производительности** - отслеживание показателей работы
- **Дашборд KPI** - визуализация ключевых метрик
- **Сравнительная аналитика** - сравнение показателей по периодам

---

## 5. ОТЧЕТЫ

**Путь:** /reports

### Основной функционал:
- **Агрегирование отчетности** - формирование различных отчетов
- **Типы отчетов**: Отчеты по реестру объектов, портфелю, задачам, оценкам
- **Экспорт отчетов** - в Excel, PDF форматы
- **Настраиваемые параметры** - выбор периодов, фильтров, группировок

---

## 6. ЗАЛОГОВОЕ ДОСЬЕ

**Путь:** /collateral-dossier

### Основной функционал:
- **Формирование залогового досье** - комплексная информация об объекте залога
- **Сбор документов** - все документы по объекту в одном месте
- **История изменений** - отслеживание всех изменений карточки
- **Связанные объекты** - связи между объектами залога
- **Экспорт досье** - формирование PDF досье для печати

---

## 7. ЗАЛОГОВЫЕ ЗАКЛЮЧЕНИЯ

**Путь:** /collateral-conclusions

### Основной функционал:
- **Создание залоговых заключений** - формирование экспертных заключений
- **Шаблоны заключений** - использование готовых шаблонов
- **Редактирование заключений** - создание и редактирование текста заключений
- **Привязка к объектам** - связь заключений с карточками залога
- **Экспорт заключений** - сохранение в PDF, Word форматах

---

## 8. СТРАХОВАНИЕ

**Путь:** /insurance

### Основной функционал:
- **Управление страховыми полисами** - учет страховых полисов по объектам залога
- **Сроки действия полисов** - отслеживание сроков страхования
- **Уведомления о продлении** - напоминания о необходимости продления
- **Страховые компании** - справочник страховщиков
- **Суммы страхования** - учет страховых сумм и премий

---

## 9. ФНП

**Путь:** /fnp

### Основной функционал:
- **Регистрация залога движимого имущества ФНП** - работа с Федеральной нотариальной палатой
- **Подача заявлений** - формирование заявлений на регистрацию залога
- **Отслеживание статусов** - мониторинг статусов регистрации
- **Документооборот** - управление документами для ФНП

---

## 10. АНАЛИТИКА

**Путь:** /analytics

### Основной функционал:
- **Расширенная аналитика** - углубленный анализ данных
- **Визуализация данных** - графики, диаграммы, дашборды
- **Анализ трендов** - выявление тенденций в портфеле
- **Прогнозирование** - прогнозные модели на основе исторических данных
- **Сравнительный анализ** - сравнение показателей по различным параметрам

---

## 11. МОДУЛЬ МОНИТОРИНГА

**Путь:** /credit-risk

### Основной функционал:
- **Мониторинг кредитных рисков** - отслеживание рисков по залоговому имуществу
- **Оценка рисков** - автоматическая и ручная оценка рисков
- **Алерты и уведомления** - оповещения о критических ситуациях
- **Рейтинг рисков** - классификация объектов по уровню риска
- **Отчеты по рискам** - формирование отчетов о рисках портфеля

---

## 12. МОДУЛЬ ОЦЕНКИ

**Путь:** /appraisal

### Основной функционал:
- **Автоматическая оценка объектов залога** - расчет стоимости объектов
- **Методы оценки**: Доходный подход (DCF, прямая капитализация, множитель валового дохода), Сравнительный подход (сравнение продаж, извлечение из рынка), Затратный подход (стоимость замещения, воспроизводства, износ)
- **Расчет LTV** - соотношение суммы займа к стоимости залога
- **Залоговая стоимость** - расчет залоговой стоимости с учетом дисконтов
- **История оценок** - сохранение истории всех оценок объекта
- **Экспорт отчетов об оценке** - формирование PDF отчетов

---

## 13. CMS CHECK

**Путь:** /cms-check

### Основной функционал:
- **Система дистанционных осмотров** - проведение осмотров объектов залога
- **Мобильный интерфейс** - доступ к осмотрам через мобильные устройства
- **Фотофиксация** - загрузка фотографий объекта
- **Чек-листы осмотра** - структурированные формы для осмотра
- **Геолокация** - привязка осмотра к координатам
- **Подпись инспектора** - электронная подпись результатов осмотра
- **Отчеты об осмотре** - автоматическое формирование отчетов

---

## 14. ЕГРН

**Путь:** /egrn

### Основной функционал:
- **Регистрация ипотеки** - работа с Единым государственным реестром недвижимости
- **Снятие обременений** - оформление снятия обременений с недвижимости
- **Выписки ЕГРН** - запрос и получение выписок из ЕГРН
- **Отслеживание статусов** - мониторинг статусов регистрационных действий
- **Документооборот** - управление документами для регистрации

---

## 15. ЗАГРУЗКА

**Путь:** /upload

### Основной функционал:
- **Миграция данных** - перенос данных из других систем
- **Экспорт данных** - выгрузка данных в Excel для миграции
- **Импорт данных** - загрузка данных из Excel файлов
- **Массовые изменения** - массовое редактирование записей через Excel
- **Валидация данных** - проверка корректности импортируемых данных
- **Отчеты об импорте** - статистика по результатам импорта

---

## 16. МОНИТОРИНГ

**Путь:** /monitoring

### Основной функционал:
- **Мониторинг системы** - отслеживание состояния системы
- **Мониторинг объектов** - контроль состояния объектов залога
- **Настройки мониторинга** - конфигурация параметров мониторинга
- **Уведомления** - система оповещений о событиях
- **Логирование** - журнал событий и действий в системе

---

## 17. СПРАВОЧНАЯ С ИИ

**Путь:** /reference

### Основной функционал:
- **AI-помощник** - интеллектуальный помощник на базе DeepSeek AI
- **База знаний** - справочная литература по банковским залогам ("Залоговik")
- **Поиск по базе знаний** - семантический поиск по документам
- **Чат с ИИ** - диалоговый интерфейс для получения консультаций
- **Режим оценки** - AI-оценка объектов залога с использованием профессиональных методов
- **Эквалайзер скилов** - настройка приоритетов методов оценки
- **Режим экспертизы** - настройка уровня экспертизы, анализа, краткости ответов
- **Самообучение ИИ** - система обратной связи (лайк/дизлайк) для улучшения ответов
- **Режим обучения** - интенсивное самообучение системы на базе документов
- **Эволюция ИИ** - система уровней и опыта ИИ-помощника
- **Экспорт PDF отчетов** - генерация подробных отчетов об оценке с расчетами
- **История чатов** - сохранение истории диалогов с ИИ

---

## 18. НАСТРОЙКИ

**Путь:** /settings

### Подразделы:

#### 18.1. Сотрудники
- **Управление сотрудниками** - добавление, редактирование, деактивация сотрудников
- **Роли и права доступа** - назначение ролей и прав сотрудникам
- **Синхронизация с задачами** - автоматическая синхронизация с системой задач

#### 18.2. Справочные данные
- **Управление справочниками** - редактирование классификаторов и справочников
- **Категории объектов** - управление категориями залогового имущества
- **Типы объектов** - настройка типов объектов и их характеристик

#### 18.3. Норма-часы
- **Нормативы времени** - установка нормативов времени на выполнение задач
- **Расчет трудозатрат** - автоматический расчет трудозатрат на основе нормативов

#### 18.4. Метрики
- **Настройка метрик** - конфигурация метрик для KPI и аналитики
- **Пороговые значения** - установка пороговых значений для метрик

---

## 🔧 ТЕХНИЧЕСКИЕ ОСОБЕННОСТИ

### Хранение данных:
- **IndexedDB** - основное хранилище данных в браузере
- **LocalStorage** - хранение настроек и кэша
- **Автоматическое резервное копирование** - экспорт/импорт базы данных

### Производительность:
- **Оптимизация рендеринга** - мемоизация компонентов, виртуализация списков
- **Ленивая загрузка** - загрузка данных по требованию
- **Кэширование** - кэширование результатов поиска и запросов

### Безопасность:
- **Валидация данных** - проверка всех входящих данных
- **Обработка ошибок** - graceful error handling
- **Логирование** - журналирование критических операций

### Интерфейс:
- **Адаптивный дизайн** - поддержка различных размеров экранов
- **Темная/светлая тема** - переключение тем оформления
- **Локализация** - русский язык интерфейса

---

## 📊 СТАТИСТИКА СИСТЕМЫ

- **Модулей:** 18 основных разделов
- **Типов объектов:** 60+
- **Полей характеристик:** 150+
- **Уровней классификации:** 3
- **Методов оценки:** 8 (доходный, сравнительный, затратный подходы)
- **Форматов экспорта:** Excel, PDF, JSON

---

**Дата создания документа:** Декабрь 2024  
**Версия CMS:** 2.0.0`,c=async()=>{try{i(!0),Ne.info("Генерация PDF описания системы...");let d="";try{const I=await fetch("/INSTRUCTION/CMS_FUNCTIONALITY.md");if(I.ok)d=await I.text();else throw new Error("Файл не найден, используем встроенное содержимое")}catch{d=l()}const f=A(d),p=document.createElement("div");p.style.position="fixed",p.style.left="-10000px",p.style.top="0",p.style.width="800px",p.style.minHeight="100px",p.style.padding="20px",p.style.backgroundColor="#ffffff",p.style.color="#000000",p.style.fontFamily='system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',p.style.fontSize="12px",p.style.lineHeight="1.6",p.style.boxSizing="border-box",p.style.visibility="visible",p.style.opacity="1",p.style.pointerEvents="none",p.style.zIndex="999999",p.style.overflow="visible",p.innerHTML=f,document.body.appendChild(p),await new Promise(I=>requestAnimationFrame(I)),await new Promise(I=>requestAnimationFrame(I)),await new Promise(I=>setTimeout(I,500)),p.offsetHeight;const u=p.scrollHeight||1e3;if(u<50)throw document.body.removeChild(p),new Error("Контейнер PDF пуст или не отрендерился");const g=await Vy(p,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:800,height:u,windowWidth:800,windowHeight:u});if(document.body.removeChild(p),!g||g.width===0||g.height===0)throw new Error("Canvas пуст");const h=g.toDataURL("image/png"),x=new Vt({orientation:"p",unit:"mm",format:"a4"}),y=x.internal.pageSize.getWidth(),v=x.internal.pageSize.getHeight(),E=10,k=y-E*2,S=E,B=k,b=g.height*B/g.width;let O=b,_=0;for(x.addImage(h,"PNG",E,S,B,b),O-=v-E*2;O>0;)_=O-b,x.addPage(),x.addImage(h,"PNG",E,_,B,b),O-=v-E*2;const U=new Date().toISOString().slice(0,10);x.save(`Описание_системы_CMS_${U}.pdf`),Ne.success("PDF описание системы успешно выгружено")}catch(d){console.error("Ошибка генерации PDF:",d),Ne.error(`Ошибка генерации PDF: ${d.message||"Неизвестная ошибка"}`)}finally{i(!1)}},A=d=>{let f=d;return f=f.replace(/^### (.*$)/gim,'<h3 style="margin: 16px 0 8px 0; font-size: 16px; font-weight: 600; color: #1890ff;">$1</h3>'),f=f.replace(/^## (.*$)/gim,'<h2 style="margin: 20px 0 12px 0; font-size: 20px; font-weight: 700; color: #1890ff; border-bottom: 2px solid #1890ff; padding-bottom: 4px;">$1</h2>'),f=f.replace(/^# (.*$)/gim,'<h1 style="margin: 24px 0 16px 0; font-size: 24px; font-weight: 700; color: #1890ff;">$1</h1>'),f=f.replace(/\*\*(.*?)\*\*/gim,'<strong style="font-weight: 600;">$1</strong>'),f=f.replace(/^- (.*$)/gim,'<li style="margin: 4px 0; padding-left: 8px;">$1</li>'),f=f.replace(/(<li.*<\/li>)/s,'<ul style="margin: 8px 0; padding-left: 24px;">$1</ul>'),f=f.replace(/^---$/gim,'<hr style="margin: 16px 0; border: none; border-top: 1px solid #e8e8e8;" />'),f=f.split(`

`).map(p=>p.trim()&&!p.match(/^<[h|u|o|l|d]/)?`<p style="margin: 8px 0; text-align: justify;">${p.trim()}</p>`:p).join(`
`),f=f.replace(/`(.*?)`/gim,'<code style="background: #f5f5f5; padding: 2px 6px; border-radius: 3px; font-family: monospace;">$1</code>'),f=f.replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" style="color: #1890ff; text-decoration: none;">$1</a>'),`<div style="max-width: 800px; margin: 0 auto;">${f}</div>`};return o?s.jsxs("div",{style:{padding:"24px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[s.jsx("h1",{style:{margin:0},children:"Настройки"}),s.jsx(Be,{type:"primary",icon:s.jsx(zT,{}),loading:n,onClick:c,size:"large",children:"Выгрузить Описание системы"})]}),s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/employees"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(ti,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),s.jsx("h3",{children:"Управление сотрудниками"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Добавление и редактирование сотрудников, их ролей и прав доступа"})]})})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/reference-data"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(el,{style:{fontSize:"48px",color:"#52c41a",marginBottom:"16px"}}),s.jsx("h3",{children:"Справочники"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Управление всеми справочниками системы"})]})})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/norm-hours"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(Vn,{style:{fontSize:"48px",color:"#fa8c16",marginBottom:"16px"}}),s.jsx("h3",{children:"Нормочасы по функциям"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Управление нормочасами для расчета загрузки сотрудников"})]})})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/metrics"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(tA,{style:{fontSize:"48px",color:"#722ed1",marginBottom:"16px"}}),s.jsx("h3",{children:"Метрики KPI и MBO"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Корректировка ключевых показателей и целевых значений MBO"})]})})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/appraisal-companies"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(wb,{style:{fontSize:"48px",color:"#13c2c2",marginBottom:"16px"}}),s.jsx("h3",{children:"Аккредитация оценочных компаний"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Реестр оценочных компаний и управление их аккредитацией"})]})})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(Ue,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/workflow"),children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(gh,{style:{fontSize:"48px",color:"#fadb14",marginBottom:"16px"}}),s.jsx("h3",{children:"Настройки Workflow"}),s.jsx("p",{style:{color:"#8c8c8c"},children:"Управление этапами, чеклистами и шаблонами внесудебной реализации"})]})})})]})]}):s.jsx(Eb,{status:"info",title:e,subTitle:t||"Этот раздел находится в разработке",extra:s.jsx(Be,{onClick:()=>r("/registry"),children:"Вернуться к реестру"})})},rd=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),yz=()=>{const[e,t]=M.useState([]),[r,a]=M.useState(!0),[n,i]=M.useState(null),[o,l]=M.useState(""),[c,A]=M.useState(null),[d,f]=M.useState(null),[p,u]=M.useState(null),[g,h]=M.useState(null),[x,y]=M.useState(!1),[v,E]=M.useState(null),[k,S]=M.useState(null);M.useEffect(()=>{try{const U=new URLSearchParams(window.location.search),I=U.get("q")||U.get("ref")||"",R=U.get("ref"),L=U.get("policy");R&&E(R),L&&S(L),I&&l(I)}catch{}},[]),M.useEffect(()=>{if(e.length!==0){if(k){const U=e.find(I=>I.policyNumber===k);if(U){h(U),y(!0);return}}if(v){const U=e.filter(I=>String(I.reference)===String(v));U.length>=1&&(h(U[0]),y(!0))}}},[e,v,k]),M.useEffect(()=>{let U=!0;return(async()=>{a(!0),i(null);try{const R="/",L=new URL(R,window.location.origin),N=L.pathname.endsWith("/")?L.pathname:`${L.pathname}/`,P=`${L.origin}${N}insuranceData.json?v=${Date.now()}`,Q=await fetch(P,{cache:"no-store"});if(!Q.ok)throw new Error(`Не удалось загрузить страхование (${Q.status})`);const Y=await Q.json();if(!U)return;t(Y.map((ee,V)=>({...ee,key:`ins-${V}`,reference:ee.reference!=null?String(ee.reference):null})))}catch(R){i(R instanceof Error?R.message:"Неизвестная ошибка"),t([])}finally{U&&a(!1)}})(),()=>{U=!1}},[]);const B=M.useMemo(()=>{const U=I=>Array.from(new Set(e.map(R=>R[I]).filter(R=>typeof R=="string"&&R.trim().length>0))).sort();return{types:U("insuranceType"),statuses:U("status"),insurers:U("insurer")}},[e]),b=M.useMemo(()=>{const U=o.trim().toLowerCase();return e.filter(I=>{const R=!U||[I.policyNumber,I.insured,I.contractNumber,I.reference,I.insurer,I.insuranceType].filter(Boolean).some(Q=>String(Q).toLowerCase().includes(U)),L=!c||I.insuranceType===c,N=!d||I.status===d,P=!p||I.insurer===p;return R&&L&&N&&P})},[e,o,c,d,p]),O=M.useMemo(()=>{const U=b.length,I=b.reduce((L,N)=>{const P=typeof N.insuredAmount=="number"?N.insuredAmount:Number(String(N.insuredAmount??"").replace(/\s/g,"").replace(",","."));return L+(Number.isFinite(P)?P:0)},0),R=b.reduce((L,N)=>{const P=typeof N.premium=="number"?N.premium:Number(String(N.premium??"").replace(/\s/g,"").replace(",","."));return L+(Number.isFinite(P)?P:0)},0);return{totalPolicies:U,totalInsured:I,totalPremium:R}},[b]),_=M.useMemo(()=>[{title:"Полис",dataIndex:"policyNumber",key:"policy",width:200,render:(U,I)=>s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:600},children:I.policyNumber}),s.jsx("div",{className:"insurance-muted",children:I.insuranceType})]})},{title:"Объект",key:"property",width:260,render:(U,I)=>s.jsxs("div",{children:[s.jsx("div",{className:"insurance-muted",children:I.propertyType??"—"}),s.jsx("div",{className:"insurance-muted",children:I.propertyAddress??"—"})]})},{title:"Сделка",key:"deal",width:220,render:(U,I)=>s.jsxs("div",{children:[s.jsxs("div",{className:"insurance-muted",children:["REFERENCE: ",I.reference??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Договор: ",I.contractNumber??"—"]})]})},{title:"Страхователь",key:"insured",width:260,render:(U,I)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:I.insured??"—"}),s.jsx("div",{className:"insurance-muted",children:I.insurer})]})},{title:"Суммы",key:"amounts",width:260,render:(U,I)=>s.jsxs("div",{className:"insurance-metrics",children:[s.jsxs("div",{className:"insurance-metrics-row",children:[s.jsx("span",{children:"Страховая сумма"}),s.jsx("strong",{children:I.insuredAmount?rd.format(Number(String(I.insuredAmount).replace(/\s/g,"").replace(",","."))):"—"})]}),s.jsxs("div",{className:"insurance-metrics-row",children:[s.jsx("span",{children:"Премия"}),s.jsx("strong",{children:I.premium?rd.format(Number(String(I.premium).replace(/\s/g,"").replace(",","."))):"—"})]})]})},{title:"Срок",key:"term",width:220,render:(U,I)=>s.jsxs("div",{children:[s.jsxs("div",{className:"insurance-muted",children:["Начало: ",I.startDate??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Окончание: ",I.endDate??"—"]})]})},{title:"Статус",dataIndex:"status",key:"status",width:160,render:U=>{const I=U==="Активен"?"green":U==="Требует продления"?"orange":U==="Истек"?"volcano":"default";return s.jsx(Ze,{color:I,children:U})}}],[]);return s.jsxs("div",{className:"insurance-page",children:[s.jsxs("div",{className:"insurance-header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"insurance-title",children:"Страхование"}),s.jsx(ht.Paragraph,{className:"insurance-subtitle",children:"Полисы страхования, связанные с договорами залогового портфеля"})]}),s.jsx(Te,{size:"middle",direction:"vertical",children:s.jsx(Kr,{title:"Поиск по полисам, клиентам, договорам",children:s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по полисам, клиентам, REFERENCE",prefix:s.jsx(Pa,{}),value:o,onChange:U=>l(U.target.value),style:{width:360}})})})]}),s.jsx(Ue,{children:s.jsxs("div",{className:"insurance-filters",children:[s.jsx(Ve,{allowClear:!0,placeholder:"Вид страхования",style:{width:200},options:B.types.map(U=>({label:U,value:U})),value:c??void 0,onChange:U=>A(U??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Статус",style:{width:200},options:B.statuses.map(U=>({label:U,value:U})),value:d??void 0,onChange:U=>f(U??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Страховщик",style:{width:200},options:B.insurers.map(U=>({label:U,value:U})),value:p??void 0,onChange:U=>u(U??null)})]})}),s.jsxs(dt,{gutter:[16,16],className:"insurance-stats",children:[s.jsx(be,{xs:24,sm:12,md:8,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Количество полисов",value:O.totalPolicies,prefix:s.jsx(wb,{})})})}),s.jsx(be,{xs:24,sm:12,md:8,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Совокупная страховая сумма",value:rd.format(O.totalInsured)})})}),s.jsx(be,{xs:24,sm:12,md:8,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Совокупная премия",value:rd.format(O.totalPremium),prefix:s.jsx(VT,{})})})})]}),s.jsx(Ue,{className:"insurance-table-card",bodyStyle:{padding:0},children:s.jsx(ir,{columns:_,dataSource:b,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:r,onRow:U=>({onDoubleClick:()=>{h(U),y(!0)}}),locale:{emptyText:s.jsx(Sr,{description:"Нет записей, удовлетворяющих фильтрам",className:"insurance-empty"})}})}),n&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить страховые данные",description:n,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),r&&s.jsx("div",{style:{textAlign:"center"},children:s.jsx(es,{tip:"Загружаем страховые данные..."})}),s.jsx(cr,{title:"Карточка полиса",open:x,onCancel:()=>y(!1),footer:null,width:720,children:g&&s.jsxs(Te,{direction:"vertical",size:"small",style:{width:"100%"},children:[s.jsx(ht.Text,{strong:!0,children:"Полис:"})," ",g.policyNumber,s.jsxs("div",{className:"insurance-muted",children:["Тип: ",g.insuranceType]}),s.jsxs("div",{className:"insurance-muted",children:["Тип имущества: ",g.propertyType??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Адрес имущества: ",g.propertyAddress??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Страхователь: ",g.insured??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["REFERENCE сделки: ",g.reference??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Договор: ",g.contractNumber??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Страховая сумма:"," ",typeof g.insuredAmount=="number"?rd.format(g.insuredAmount):"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Премия:"," ",typeof g.premium=="number"?rd.format(g.premium):"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Срок: ",g.startDate??"—"," — ",g.endDate??"—"]}),s.jsxs("div",{className:"insurance-muted",children:["Страховщик: ",g.insurer]}),s.jsx("div",{children:s.jsx(Ze,{children:g.status})})]})})]})},{TextArea:vz}=Re,{Option:Gp}=Ve,wz=[{value:"Оценка",label:"Оценка"},{value:"Экспертиза",label:"Экспертиза"},{value:"Рецензия",label:"Рецензия"},{value:"ПРКК",label:"ПРКК"},{value:"Прочее",label:"Прочее"},{value:"Отчетность",label:"Отчетность"},{value:"Подготовка СЗ",label:"Подготовка СЗ"}],Ez=[{value:"low",label:"Низкий"},{value:"medium",label:"Средний"},{value:"high",label:"Высокий"},{value:"critical",label:"Критический"}],bz=["Москва","Санкт-Петербург","Новосибирск","Екатеринбург"],_z=({visible:e,deal:t,onCancel:r,onSuccess:a})=>{const[n]=re.useForm(),[i,o]=M.useState(!1),[l,c]=M.useState([]);M.useEffect(()=>{var f,p,u,g;e&&t&&(n.setFieldsValue({region:(f=t.collateralLocation)!=null&&f.includes("Москва")?"Москва":(p=t.collateralLocation)!=null&&p.includes("Санкт-Петербург")?"Санкт-Петербург":(u=t.collateralLocation)!=null&&u.includes("Новосибирск")?"Новосибирск":(g=t.collateralLocation)!=null&&g.includes("Екатеринбург")?"Екатеринбург":"Москва",title:`Сделка ${t.reference||t.contractNumber||""} - ${t.borrower||t.pledger||""}`,description:`Задача по сделке REFERENCE: ${t.reference||t.contractNumber||""}
Заемщик: ${t.borrower||"Не указан"}
Залогодатель: ${t.pledger||"Не указан"}
Тип обеспечения: ${t.collateralType||"Не указан"}
Местоположение: ${t.collateralLocation||"Не указано"}`,priority:"medium",dueDate:We().add(7,"day")}),A())},[e,t,n]);const A=()=>{try{const f=localStorage.getItem("zadachnik_users");if(f){const p=JSON.parse(f),u=(p==null?void 0:p.employee)||[];c(u)}}catch(f){console.error("Ошибка загрузки сотрудников:",f)}},d=async()=>{var f,p,u,g,h;try{const x=await n.validateFields();o(!0);const y=(await ps(async()=>{const{default:k}=await Promise.resolve().then(()=>eM);return{default:k}},void 0)).default;let v=[];try{v=await y.getTasks()}catch{try{const S=localStorage.getItem("zadachnik_tasks");S&&(v=JSON.parse(S))}catch(S){console.warn("Не удалось загрузить задачи:",S)}}const E={id:`T-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,region:x.region,type:x.type,category:x.type,title:x.title,description:x.description||"",priority:x.priority,dueDate:x.dueDate.format("YYYY-MM-DD"),status:"created",businessUser:"system@cms.ru",businessUserName:"Система CMS",assignedTo:x.assignedTo||[],currentAssignee:((f=x.assignedTo)==null?void 0:f[0])||null,currentAssigneeName:(p=x.assignedTo)!=null&&p[0]?(u=l.find(k=>k.email===x.assignedTo[0]))==null?void 0:u.name:null,employeeId:(g=x.assignedTo)!=null&&g[0]?(h=l.find(k=>k.email===x.assignedTo[0]))==null?void 0:h.id:void 0,documents:[],comments:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),history:[{date:new Date().toISOString(),user:"Система CMS",userRole:"system",action:"Создана",comment:`Задача создана из карточки сделки ${(t==null?void 0:t.reference)||(t==null?void 0:t.contractNumber)||""}`,status:"created"}]};v.push(E);try{await y.saveTasks(v)}catch(k){console.error("Ошибка сохранения задачи в IndexedDB:",k),Ne.error("Не удалось сохранить задачу. Попробуйте еще раз."),o(!1);return}Ne.success("Задача успешно создана в Задачнике"),n.resetFields(),o(!1),a==null||a(),r()}catch(x){console.error("Ошибка создания задачи:",x),Ne.error("Ошибка при создании задачи"),o(!1)}};return s.jsx(cr,{title:"Создать задачу в Задачнике",open:e,onCancel:r,footer:[s.jsx(Be,{onClick:r,children:"Отмена"},"cancel"),s.jsx(Be,{type:"primary",loading:i,onClick:d,children:"Создать задачу"},"submit")],width:600,children:s.jsxs(re,{form:n,layout:"vertical",children:[s.jsx(re.Item,{name:"region",label:"Регион",rules:[{required:!0,message:"Выберите регион"}],children:s.jsx(Ve,{placeholder:"Выберите регион",children:bz.map(f=>s.jsx(Gp,{value:f,children:f},f))})}),s.jsx(re.Item,{name:"type",label:"Тип задачи",rules:[{required:!0,message:"Выберите тип задачи"}],children:s.jsx(Ve,{placeholder:"Выберите тип задачи",children:wz.map(f=>s.jsx(Gp,{value:f.value,children:f.label},f.value))})}),s.jsx(re.Item,{name:"title",label:"Название задачи",rules:[{required:!0,message:"Введите название задачи"}],children:s.jsx(Re,{placeholder:"Название задачи"})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(vz,{rows:4,placeholder:"Описание задачи"})}),s.jsx(re.Item,{name:"priority",label:"Приоритет",rules:[{required:!0,message:"Выберите приоритет"}],children:s.jsx(Ve,{placeholder:"Выберите приоритет",children:Ez.map(f=>s.jsx(Gp,{value:f.value,children:f.label},f.value))})}),s.jsx(re.Item,{name:"dueDate",label:"Срок выполнения",rules:[{required:!0,message:"Выберите срок выполнения"}],children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),s.jsx(re.Item,{name:"assignedTo",label:"Исполнитель (необязательно)",children:s.jsx(Ve,{mode:"multiple",placeholder:"Выберите исполнителя",showSearch:!0,filterOption:(f,p)=>(typeof(p==null?void 0:p.label)=="string"?p.label:String((p==null?void 0:p.children)||"")).toLowerCase().includes(f.toLowerCase()),children:l.map(f=>s.jsxs(Gp,{value:f.email,children:[f.name," (",f.email,")"]},f.email))})}),t&&s.jsx(re.Item,{label:"Связанная сделка",children:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"REFERENCE:"})," ",t.reference||t.contractNumber||"Не указан"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Заемщик:"})," ",t.borrower||"Не указан"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Залогодатель:"})," ",t.pledger||"Не указан"]})]})})]})})},B1={Здание:"жилые пом _Здания",Сооружение:"жилые пом _Здания",Помещение:"жилые пом _Здания","Земельный участок":"Земельные участки","Нежилое здание":"Нежилые здания_Помещения","Нежилое помещение":"Нежилые здания_Помещения","Транспортное средство":"ТС и СМ","Самоходная машина":"ТС и СМ","Товарно-материальные ценности":"ТМЦ",Оборудование:"Оборудование","Воздушное судно":"Воздушные суда","Морское судно":"Морские и речные суда","Речное судно":"Морские и речные суда","Железнодорожный подвижной состав":"Подвижной ж_д состав","Имущественные права":"Имущественные права","Уступка прав требования":"Уступка прав требования","Права на строительство":"Имущ.права  стр-во_инвест.","Права на инвестиции":"Имущ.права  стр-во_инвест.","Ценные бумаги":"ценные бумаги_акции",Акции:"ценные бумаги_акции","Доли в уставном капитале":"Доли в УК","Залоговый счет":"Залоговый счет",ГУП:"ГУП МУП",МУП:"ГУП МУП","214-ФЗ":"214-ФЗ"};function Cz(e){if(B1[e])return B1[e];const t=e.toLowerCase();for(const[r,a]of Object.entries(B1))if(t.includes(r.toLowerCase())||r.toLowerCase().includes(t))return a;return"ТС и СМ"}async function Bz(){try{const e="/",t=new URL(e,window.location.origin),r=t.pathname.endsWith("/")?t.pathname:`${t.pathname}/`,a=`${t.origin}${r}Documents.xlsx`,n=await fetch(a,{cache:"no-store",signal:AbortSignal.timeout(5e3)}).catch(()=>null);if(!n||!n.ok)return new Map;const i=await n.arrayBuffer(),o=dA(i,{type:"array"}),l=new Map;return o.SheetNames.forEach(c=>{const A=o.Sheets[c],f=fs.sheet_to_json(A,{header:1,defval:""}).filter(p=>p[1]&&typeof p[1]=="number"&&p[2]).map(p=>({num:p[1],name:String(p[2]||"").trim(),format:String(p[3]||"").trim(),legal:String(p[4]||"").trim()})).filter(p=>p.name.length>0);f.length>0&&l.set(c,f)}),l}catch{return new Map}}function Sz(e,t,r){var l;const a=[],n=((l=t==null?void 0:t.classification)==null?void 0:l.propertyType)||(t==null?void 0:t.mainCategory)||"Транспортное средство",i=Cz(n),o=r.get(i)||[];return o.length===0?(["Договор залога","Отчет об оценке","Заключение юридической службы","Акт осмотра","Страховой полис"].forEach((A,d)=>{a.push({id:`doc-${e.reference}-${d}`,reference:String(e.reference),borrower:e.borrower||null,pledger:e.pledger||null,inn:e.inn||null,docType:A,folderId:`folder-${e.reference}`,folderPath:[e.borrower||"Не указан",e.pledger||"Не указан",`Договор ${e.contractNumber||e.reference}`],description:`Документ по сделке ${e.reference}`,status:d<3?"Загружен":d===3?"На согласовании":"Требует обновления",statusColor:d<3?"green":d===3?"orange":"red",fileName:`${A}_${e.reference}.pdf`,lastUpdated:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString("ru-RU"),responsible:"Иванов И.И.",size:`${Math.floor(Math.random()*5e3+100)} КБ`})}),a):(o.slice(0,Math.min(10,o.length)).forEach(c=>{const A=["Загружен","На согласовании","Требует обновления"],d=["green","orange","red"],f=Math.floor(Math.random()*A.length);a.push({id:`doc-${e.reference}-${c.num}`,reference:String(e.reference),borrower:e.borrower||null,pledger:e.pledger||null,inn:e.inn||null,docType:c.name,folderId:`folder-${e.reference}`,folderPath:[e.borrower||"Не указан",e.pledger||"Не указан",`Договор ${e.contractNumber||e.reference}`],description:c.format||void 0,status:A[f],statusColor:d[f],fileName:`${c.name.replace(/[^a-zA-Zа-яА-Я0-9]/g,"_")}_${e.reference}.pdf`,lastUpdated:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toLocaleDateString("ru-RU"),responsible:["Иванов И.И.","Петров П.П.","Сидоров С.С."][Math.floor(Math.random()*3)],size:`${Math.floor(Math.random()*5e3+100)} КБ`})}),a)}function Tz(e){const t=new Map;return e.forEach(r=>{const a=r.borrower||"Не указан",n=r.pledger||"Не указан",i=`Договор ${r.contractNumber||r.reference}`,o=`client-${a}`;t.has(o)||t.set(o,{id:o,path:[a],description:`Документы клиента: ${a}`});const l=`pledger-${a}-${n}`;t.has(l)||t.set(l,{id:l,path:[a,n],description:`Документы залогодателя: ${n}`});const c=`contract-${r.reference}`;t.has(c)||t.set(c,{id:c,path:[a,n,i],description:`Документы по договору: ${i}`})}),Array.from(t.values())}async function pS(e,t){const r=await Bz(),a=new Map;t.forEach(o=>{var l;(l=o.characteristics)!=null&&l.reference&&a.set(String(o.characteristics.reference),o)});const n=[];return e.forEach(o=>{const l=a.get(String(o.reference)),c=Sz(o,l||null,r);n.push(...c)}),{folders:Tz(e),documents:n}}const{Text:S1}=ht,Oz=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),UE=e=>e==null?"—":Oz.format(e),Iz=({visible:e,onCancel:t,onSelect:r,excludeIds:a=[]})=>{const[n,i]=M.useState(""),[o,l]=M.useState([]),[c,A]=M.useState(!1),[d,f]=M.useState([]),p=M.useCallback(()=>{if(n.trim()){const h=n.toLowerCase(),x=o.filter(y=>{var v,E,k,S,B;return a.includes(y.id)?!1:((v=y.name)==null?void 0:v.toLowerCase().includes(h))||((E=y.number)==null?void 0:E.toLowerCase().includes(h))||((S=(k=y.address)==null?void 0:k.fullAddress)==null?void 0:S.toLowerCase().includes(h))||((B=y.propertyType)==null?void 0:B.toLowerCase().includes(h))});f(x)}else f(o.filter(h=>!a.includes(h.id)))},[n,o,a]),u=M.useCallback(async()=>{A(!0);try{const h=await kt.getExtendedCards();l(h),f(h.filter(x=>!a.includes(x.id)))}catch(h){console.error("Ошибка загрузки объектов:",h)}finally{A(!1)}},[a]);M.useEffect(()=>{e&&u()},[e,u]),M.useEffect(()=>{p()},[p]);const g=[{title:"Наименование",dataIndex:"name",key:"name",render:(h,x)=>s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(S1,{strong:!0,children:x.name}),s.jsx(S1,{type:"secondary",style:{fontSize:"12px"},children:x.number})]})},{title:"Тип имущества",key:"propertyType",render:(h,x)=>s.jsx(Ze,{children:x.propertyType||"—"})},{title:"Адрес",key:"address",render:(h,x)=>{var y;return s.jsx(S1,{children:((y=x.address)==null?void 0:y.fullAddress)||"—"})}},{title:"Рыночная стоимость",key:"marketValue",align:"right",render:(h,x)=>UE(x.marketValue)},{title:"Залоговая стоимость",key:"pledgeValue",align:"right",render:(h,x)=>UE(x.pledgeValue)},{title:"Действие",key:"action",width:120,render:(h,x)=>s.jsx("a",{onClick:()=>r(x),children:"Выбрать"})}];return s.jsx(cr,{title:"Выбор объекта обеспечения",open:e,onCancel:t,footer:null,width:900,children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsx(Re,{placeholder:"Поиск по наименованию, номеру, адресу...",prefix:s.jsx(Pa,{}),value:n,onChange:h=>i(h.target.value),allowClear:!0}),c?s.jsx(es,{tip:"Загрузка объектов..."}):d.length>0?s.jsx(ir,{columns:g,dataSource:d,rowKey:"id",pagination:{pageSize:10},size:"small",onRow:h=>({onDoubleClick:()=>r(h)})}):s.jsx(Sr,{description:"Объекты не найдены"})]})})},Nz=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),Fz=new Intl.NumberFormat("ru-RU",{style:"percent",maximumFractionDigits:1}),qs=e=>{const t=typeof e=="number"?e:e?parseFloat(String(e)):null;return t==null?"—":Nz.format(t)},rn=e=>{if(e==null)return"—";const t=String(e).trim();return t.length>0?t:"—"},Rz=({contract:e,visible:t,onClose:r,onUpdate:a})=>{const n=$i(),[i,o]=M.useState("general"),[l,c]=M.useState([]),[A,d]=M.useState(!1),[f,p]=M.useState(!1),[u,g]=M.useState([]),[h,x]=M.useState([]),[y,v]=M.useState(!1),E=M.useCallback(async()=>{d(!0);try{const N=String(e.reference??e.contractNumber??""),Q=(await kt.getExtendedCards()).filter(Y=>Y.reference&&String(Y.reference)===N||Y.contractNumber&&Y.contractNumber===e.contractNumber);c(Q)}catch(N){console.error("Ошибка загрузки объектов:",N),Ne.error("Ошибка загрузки объектов")}finally{d(!1)}},[e]),k=M.useCallback(async()=>{if(e){v(!0);try{const N=localStorage.getItem("collateralDossierData");let P=[];if(N)P=JSON.parse(N).documents;else{const z=(()=>{const W="/",Ae=new URL(W,window.location.origin),ue=Ae.pathname.endsWith("/")?Ae.pathname:`${Ae.pathname}/`;return`${Ae.origin}${ue}portfolioData.json`})(),C=await fetch(`${z}?v=${Date.now()}`,{cache:"no-store"});let D=[];C.ok&&(D=await C.json());const j=await kt.getExtendedCards();P=(await pS(D,j)).documents}const Q=e.collateralContractNumber,Y=String(e.reference||""),ee=P.filter(z=>z.reference===Y||Q&&z.folderPath.some(C=>C.includes(Q)));g(ee);const G=(await Ba.getInspections()).filter(z=>l.some(C=>z.collateralCardId===C.id||z.collateralNumber===C.number));x(G)}catch(N){console.error("Ошибка загрузки документов:",N),Ne.error("Ошибка загрузки документов")}finally{v(!1)}}},[e,l]);M.useEffect(()=>{t&&e&&E()},[t,e,E]),M.useEffect(()=>{t&&e&&l.length>0&&i==="documents"&&k()},[t,e,l,i,k]);const S=.75,B=M.useMemo(()=>l.reduce((N,P)=>N+(P.marketValue||0),0),[l]),b=M.useMemo(()=>Math.floor(B*S),[B]),O=M.useMemo(()=>{const N=typeof e.debtRub=="number"?e.debtRub:parseFloat(String(e.debtRub||0)),P=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0));return P>0?Math.min(N/P,2):null},[e.debtRub,e.marketValue]),_=async N=>{try{const P=l.find(z=>z.id===N);if(!P)return;const Q={...P,reference:void 0,contractNumber:void 0,contractId:void 0};await kt.saveExtendedCard(Q);const Y=P.marketValue||0,ee=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0)),V=Math.max(0,ee-Y),G=Math.floor(V*S);a&&a({...e,collateralValue:G,marketValue:V,currentMarketValue:V}),Ne.success("Объект отвязан от договора"),await E()}catch(P){console.error("Ошибка отвязки объекта:",P),Ne.error("Ошибка при отвязке объекта")}},U=async N=>{try{const P=String(e.reference??e.contractNumber??""),Q={...N,reference:P,contractNumber:e.contractNumber||void 0,contractId:e.contractNumber||void 0};await kt.saveExtendedCard(Q);const Y=N.marketValue||0,V=(typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0)))+Y,G=Math.floor(V*S);a&&a({...e,collateralValue:G,marketValue:V,currentMarketValue:V}),Ne.success("Объект привязан к договору"),await E(),p(!1)}catch(P){console.error("Ошибка привязки объекта:",P),Ne.error("Ошибка при привязке объекта")}},I=N=>{n(`/registry?objectId=${N}`),r()},R=[{title:"Наименование",dataIndex:"name",key:"name",render:(N,P)=>s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(ht.Text,{strong:!0,children:P.name}),s.jsxs(ht.Text,{type:"secondary",style:{fontSize:"12px"},children:["ID: ",P.id]})]})},{title:"Адрес",key:"address",render:(N,P)=>{var Q;return s.jsx(ht.Text,{children:((Q=P.address)==null?void 0:Q.fullAddress)||"—"})}},{title:"Рыночная стоимость",key:"marketValue",align:"right",render:(N,P)=>qs(P.marketValue)},{title:"Залоговая стоимость",key:"pledgeValue",align:"right",render:(N,P)=>qs(P.pledgeValue)},{title:"Характеристики",key:"characteristics",render:(N,P)=>{var Y;const Q=[];return P.propertyType&&Q.push(P.propertyType),(Y=P.classification)!=null&&Y.level1&&Q.push(P.classification.level1),s.jsx(Te,{wrap:!0,children:Q.map((ee,V)=>s.jsx(Ze,{children:ee},V))})}},{title:"Действия",key:"actions",width:200,render:(N,P)=>s.jsxs(Te,{children:[s.jsx(Be,{type:"link",size:"small",icon:s.jsx(go,{}),onClick:()=>I(P.id),children:"Открыть"}),s.jsx(po,{title:"Отвязать объект от договора?",description:"Стоимость договора будет уменьшена на стоимость объекта",onConfirm:()=>_(P.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,size:"small",icon:s.jsx(Oi,{}),children:"Отвязать"})})]})}],L=[{key:"general",label:s.jsxs("span",{children:[s.jsx(jr,{}),"Общие сведения"]}),children:s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs(ye,{title:"Общие сведения",bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"Сегмент",children:rn(e.segment)}),s.jsx(ye.Item,{label:"Группа",children:rn(e.group)}),s.jsx(ye.Item,{label:"REFERENCE",children:rn(e.reference)}),s.jsx(ye.Item,{label:"Залогодатель",children:rn(e.pledger)}),s.jsx(ye.Item,{label:"ИНН",children:rn(e.inn)}),s.jsx(ye.Item,{label:"Заемщик",children:rn(e.borrower)}),s.jsx(ye.Item,{label:"№ договора",children:rn(e.contractNumber)}),s.jsx(ye.Item,{label:"Дата договора",children:rn(e.contractDate)}),s.jsx(ye.Item,{label:"Тип",children:rn(e.type)}),s.jsx(ye.Item,{label:"Дата открытия",children:rn(e.openDate)}),s.jsx(ye.Item,{label:"Дата закрытия",children:rn(e.closeDate)})]}),s.jsxs(ye,{title:"Финансовые показатели",bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"Задолженность, руб.",children:qs(e.debtRub)}),s.jsx(ye.Item,{label:"Лимит, руб.",children:qs(e.limitRub)}),s.jsx(ye.Item,{label:"LTV",children:O!==null?s.jsx(Ze,{color:O>.8?"red":O>.6?"orange":"green",children:Fz.format(O)}):"—"}),s.jsx(ye.Item,{label:"Проср. ОД, руб.",children:qs(e.overduePrincipal)}),s.jsx(ye.Item,{label:"Проср. %, руб.",children:qs(e.overdueInterest)})]}),s.jsxs(ye,{title:"Оценка обеспечения",bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"Залоговая стоимость, руб.",children:qs(e.collateralValue)}),s.jsx(ye.Item,{label:"Рыночная стоимость, руб.",children:qs(e.marketValue)}),s.jsx(ye.Item,{label:"Совокупная рыночная стоимость объектов",children:qs(B)}),s.jsx(ye.Item,{label:"Совокупная залоговая стоимость объектов",children:qs(b)}),s.jsx(ye.Item,{label:"Дата первоначального определения стоимости",children:rn(e.initialValuationDate)}),s.jsx(ye.Item,{label:"Актуальная рыночная стоимость, руб.",children:qs(e.currentMarketValue)}),s.jsx(ye.Item,{label:"Дата определения текущей стоимости",children:rn(e.currentValuationDate)})]}),s.jsxs(ye,{title:"Обеспечение",bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"Тип обеспечения",children:rn(e.collateralType)}),s.jsx(ye.Item,{label:"Назначение обеспечения",span:2,children:rn(e.collateralPurpose)}),s.jsx(ye.Item,{label:"Информация о залоге",span:3,children:rn(e.collateralInfo)}),s.jsx(ye.Item,{label:"Местоположение предмета залога",span:2,children:rn(e.collateralLocation)}),s.jsx(ye.Item,{label:"Ликвидность",children:rn(e.liquidity)})]})]})},{key:"objects",label:s.jsxs("span",{children:[s.jsx(mh,{}),"Объекты в договоре (",l.length,")"]}),children:s.jsxs("div",{children:[s.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{children:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:"Рыночная стоимость: "}),s.jsx(ht.Text,{strong:!0,style:{color:"#52c41a",fontSize:"16px"},children:qs(B)})]}),s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:"Залоговая стоимость (с дисконтом 75%): "}),s.jsx(ht.Text,{strong:!0,style:{color:"#1890ff",fontSize:"16px"},children:qs(b)})]})]})}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:()=>p(!0),children:"Привязать объект"})]}),A?s.jsx(es,{tip:"Загрузка объектов..."}):l.length>0?s.jsx(ir,{columns:R,dataSource:l,rowKey:"id",pagination:!1,size:"small"}):s.jsx(Sr,{description:"Объекты по данному договору не найдены"})]})},{key:"documents",label:s.jsxs("span",{children:[s.jsx(lo,{}),"Документы"]}),children:s.jsx("div",{children:y?s.jsx(es,{tip:"Загрузка документов..."}):s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:5,children:"Документы из залогового досье"}),u.length>0?s.jsx(ir,{columns:[{title:"Тип документа",dataIndex:"docType",key:"docType",render:N=>s.jsxs(Te,{children:[s.jsx(jr,{style:{color:"#1890ff"}}),s.jsx("span",{children:N.length>50?N.substring(0,47)+"...":N})]})},{title:"Имя файла",dataIndex:"fileName",key:"fileName",ellipsis:!0},{title:"Статус",dataIndex:"status",key:"status",render:(N,P)=>s.jsx(Ze,{color:P.statusColor||"default",children:N})},{title:"Размер",dataIndex:"size",key:"size"},{title:"Обновлен",dataIndex:"lastUpdated",key:"lastUpdated"},{title:"Действия",key:"actions",render:()=>s.jsx(Be,{type:"link",size:"small",icon:s.jsx(In,{}),children:"Скачать"})}],dataSource:u,rowKey:"id",pagination:{pageSize:10},size:"small"}):s.jsx(Sr,{description:"Документы из залогового досье не найдены"})]}),s.jsx(jt,{}),s.jsxs("div",{children:[s.jsx(ht.Title,{level:5,children:"Залоговое заключение"}),s.jsx(Sr,{description:"Залоговое заключение не найдено"})]}),s.jsx(jt,{}),s.jsxs("div",{children:[s.jsx(ht.Title,{level:5,children:"Акты осмотра"}),h.length>0?s.jsx(ir,{columns:[{title:"Дата осмотра",dataIndex:"inspectionDate",key:"inspectionDate",render:N=>new Date(N).toLocaleDateString("ru-RU")},{title:"Тип осмотра",dataIndex:"inspectionTypeLabel",key:"inspectionTypeLabel"},{title:"Инспектор",dataIndex:"inspectorName",key:"inspectorName"},{title:"Объект",dataIndex:"collateralCardName",key:"collateralCardName",ellipsis:!0},{title:"Действия",key:"actions",render:(N,P)=>s.jsxs(Te,{children:[s.jsx(Be,{type:"link",size:"small",icon:s.jsx(Ii,{}),onClick:()=>{n(`/cms-check/inspections?inspectionId=${P.id}`),r()},children:"Просмотр"}),s.jsx(Be,{type:"link",size:"small",icon:s.jsx(In,{}),children:"Скачать PDF"})]})}],dataSource:h,rowKey:"id",pagination:{pageSize:5},size:"small"}):s.jsx(Sr,{description:"Акты осмотра не найдены"})]}),s.jsx(jt,{}),l.some(N=>N.mainCategory==="real_estate")&&s.jsxs("div",{children:[s.jsx(ht.Title,{level:5,children:"Выписки ЕГРН"}),s.jsx(Sr,{description:"Выписки ЕГРН не найдены"})]})]})})}];return s.jsxs(s.Fragment,{children:[s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(jr,{}),s.jsx("span",{children:"Карточка договора залога"}),s.jsx(Ze,{children:rn(e.reference)})]}),open:t,onCancel:r,footer:[s.jsx(Be,{onClick:r,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:s.jsx(ri,{activeKey:i,onChange:o,items:L})}),s.jsx(Iz,{visible:f,onCancel:()=>p(!1),onSelect:U,excludeIds:l.map(N=>N.id)})]})},kz=.75,Dz=e=>Math.floor(e*kz),jz=async e=>{try{const t=await kt.getExtendedCards(),r=new Map;return t.forEach(n=>{const i=n.reference||n.contractNumber;if(i){const o=String(i);r.has(o)||r.set(o,[]),r.get(o).push(n)}}),e.map(n=>{const i=String(n.reference||n.contractNumber||""),o=r.get(i)||[];if(o.length===0)return n;const l=o.reduce((A,d)=>A+(d.marketValue||0),0),c=Dz(l);return{...n,marketValue:l,collateralValue:c,currentMarketValue:l}})}catch(t){return console.error("Ошибка обновления портфеля:",t),e}},ad=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),T1=new Intl.NumberFormat("ru-RU",{style:"percent",maximumFractionDigits:1}),gi=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.replace(/\s/g,"").replace(",","."),r=Number(t);return Number.isFinite(r)?r:null}return null},Lz={Высокая:"green",Средняя:"blue",Низкая:"orange",Малоудовлетворительная:"volcano"},Uz=()=>{const e=dc(),[t,r]=M.useState(""),[a,n]=M.useState("all"),[i,o]=M.useState(null),[l,c]=M.useState(null),[A,d]=M.useState(null),[f,p]=M.useState(null),[u,g]=M.useState([]),[h,x]=M.useState(!0),[y,v]=M.useState(null),[E,k]=M.useState(null),[S,B]=M.useState(!1),[b,O]=M.useState(!1);M.useEffect(()=>{let P=!0;return(async()=>{x(!0),v(null);try{const Y=(()=>{const D="/",j=new URL(D,window.location.origin),K=j.pathname.endsWith("/")?j.pathname:`${j.pathname}/`;return`${j.origin}${K}portfolioData.json`})(),ee=await fetch(`${Y}?v=${Date.now()}`,{cache:"no-store"});if(!ee.ok)throw new Error(`Не удалось загрузить данные (${ee.status})`);const V=await ee.json();if(!P)return;const G=$P(V),C=(await jz(G)).map((D,j)=>({...D,key:`portfolio-${j}`,reference:D.reference!=null?String(D.reference):null,inn:D.inn!=null?String(D.inn):null,account9131:D.account9131!=null?String(D.account9131):null}));g(C)}catch(Y){v(Y instanceof Error?Y.message:"Неизвестная ошибка"),g([])}finally{P&&x(!1)}})(),()=>{P=!1}},[]);const _=Ma.useCallback(P=>{k(P),B(!0)},[]);M.useEffect(()=>{if(u.length>0){const Q=new URLSearchParams(e.search).get("q");if(Q){r(Q);const Y=u.find(ee=>{var V,G;return String(ee.reference)===Q||String(ee.contractNumber)===Q||((V=String(ee.borrower))==null?void 0:V.toLowerCase().includes(Q.toLowerCase()))||((G=String(ee.pledger))==null?void 0:G.toLowerCase().includes(Q.toLowerCase()))});Y&&setTimeout(()=>{_(Y)},500)}}},[u,e.search,_]);const U=M.useMemo(()=>{const P=Q=>{const Y=u.map(ee=>ee[Q]).filter(ee=>typeof ee=="string"&&ee.trim().length>0);return Array.from(new Set(Y)).sort()};return{segments:P("segment"),groups:P("group"),liquidity:P("liquidity"),monitoring:P("monitoringType")}},[u]),I=M.useMemo(()=>{const P=t.trim().toLowerCase();return u.filter(Q=>{const Y=!P||[Q.reference,Q.pledger,Q.borrower,Q.collateralInfo,Q.collateralLocation,Q.contractNumber,Q.account9131].filter(Boolean).some(C=>String(C).toLowerCase().includes(P)),ee=!i||Q.segment===i,V=!l||Q.group===l,G=!A||Q.liquidity===A,z=!f||Q.monitoringType===f;return Y&&ee&&V&&G&&z})},[u,t,i,l,A,f]),R=()=>{k(null),B(!1)},L=M.useMemo(()=>{const P=I.reduce((ee,V)=>{const G=gi(V.debtRub)??0,z=gi(V.marketValue)??0,C=gi(V.collateralValue)??0,D=(gi(V.overduePrincipal)??0)+(gi(V.overdueInterest)??0);return ee.debt+=G,ee.market+=z,ee.collateral+=C,ee.overdue+=D,z>0&&(ee.ltvSamples+=1,ee.ltvSum+=Math.min(G/z,2)),ee},{debt:0,market:0,collateral:0,overdue:0,ltvSum:0,ltvSamples:0}),Q=P.ltvSamples>0?P.ltvSum/P.ltvSamples:0,Y=P.debt>0?P.overdue/P.debt:0;return{totalRows:I.length,totalDebt:P.debt,totalMarket:P.market,averageLtv:Q,overdueShare:Y}},[I]),N=M.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(P,Q)=>s.jsxs("div",{children:[s.jsx("div",{className:"portfolio-page__ref",children:Q.reference??"—"}),s.jsx("div",{className:"portfolio-page__muted",children:Q.contractNumber??"—"}),s.jsxs("div",{className:"portfolio-page__tags",children:[Q.segment&&s.jsx(Ze,{children:Q.segment}),Q.group&&s.jsx(Ze,{color:"geekblue",bordered:!1,children:Q.group})]})]})},{title:"Компании",key:"company",width:260,render:(P,Q)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:Q.pledger??"—"}),s.jsxs("div",{className:"portfolio-page__muted",children:["Заемщик: ",Q.borrower??"—"]}),Q.inn&&s.jsxs("div",{className:"portfolio-page__muted",children:["ИНН: ",s.jsx(ht.Text,{code:!0,children:Q.inn})]})]})},{title:"Показатели",key:"metrics",width:240,render:(P,Q)=>{const Y=gi(Q.debtRub),ee=gi(Q.limitRub),V=gi(Q.marketValue),G=Y&&V?Math.min(Y/V,2):null;return s.jsxs("div",{className:"portfolio-page__metrics",children:[s.jsxs("div",{className:"portfolio-page__metrics-row",children:[s.jsx("span",{children:"Задолженность"}),s.jsx("strong",{children:Y?ad.format(Y):"—"})]}),s.jsxs("div",{className:"portfolio-page__metrics-row",children:[s.jsx("span",{children:"Лимит"}),s.jsx("strong",{children:ee?ad.format(ee):"—"})]}),s.jsxs("div",{className:"portfolio-page__metrics-row",children:[s.jsx("span",{children:"LTV"}),s.jsx("strong",{children:G!==null?s.jsx(Ze,{color:G>.8?"red":G>.7?"orange":"green",children:T1.format(G)}):"—"})]})]})}},{title:"Обеспечение",key:"collateral",width:300,render:(P,Q)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:Q.collateralType??Q.collateralCategory??"—"}),Q.collateralPurpose&&s.jsx("div",{className:"portfolio-page__muted",children:Q.collateralPurpose}),s.jsx("div",{className:"portfolio-page__divider"}),s.jsxs("div",{className:"portfolio-page__metrics",children:[s.jsxs("div",{className:"portfolio-page__metrics-row",children:[s.jsx("span",{children:"Рыночная стоимость"}),s.jsx("strong",{children:gi(Q.marketValue)?ad.format(gi(Q.marketValue)):"—"})]}),s.jsxs("div",{className:"portfolio-page__metrics-row",children:[s.jsx("span",{children:"Залоговая стоимость"}),s.jsx("strong",{children:gi(Q.collateralValue)?ad.format(gi(Q.collateralValue)):"—"})]})]}),Q.collateralLocation&&s.jsxs("div",{style:{marginTop:6},children:[s.jsx(tl,{style:{color:"#8c8c8c",marginRight:4}}),s.jsx(ht.Text,{children:Q.collateralLocation})]})]})},{title:"Мониторинг",key:"monitoring",width:220,render:(P,Q)=>s.jsxs(Te,{direction:"vertical",size:6,style:{width:"100%"},children:[s.jsxs("div",{children:[Q.liquidity&&s.jsx(Ze,{color:Lz[Q.liquidity]||"default",children:Q.liquidity}),Q.qualityCategory&&s.jsx(Ze,{children:Q.qualityCategory})]}),s.jsxs("div",{className:"portfolio-page__muted",children:["Вид мониторинга: ",s.jsx("strong",{children:Q.monitoringType??"—"})]}),s.jsxs("div",{className:"portfolio-page__muted",children:["Последний: ",Q.lastMonitoringDate??"—"]}),s.jsxs("div",{className:"portfolio-page__muted",children:["План: ",Q.nextMonitoringDate??"—"]})]})},{title:"Ответственный",key:"owner",width:180,render:(P,Q)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:Q.owner??"Не назначен"}),Q.account9131&&s.jsxs("div",{className:"portfolio-page__muted",children:["9131: ",s.jsx(ht.Text,{code:!0,children:Q.account9131})]})]})}],[]);return s.jsxs("div",{className:"portfolio-page",children:[s.jsxs("div",{className:"portfolio-page__header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"portfolio-page__title",children:"Залоговый портфель"}),s.jsx(ht.Paragraph,{className:"portfolio-page__subtitle",children:"Актуальные данные из реестра и дополнительно 100 демо-записей для моделирования сценариев"})]}),s.jsxs(Te,{size:"middle",children:[s.jsxs(Te.Compact,{style:{width:500},children:[s.jsx(Ve,{value:a,onChange:n,style:{width:200},options:[{label:"Все поля",value:"all"},{label:"ИНН",value:"inn"},{label:"Залогодатель",value:"pledger"},{label:"Заемщик",value:"borrower"},{label:"REFERENCE залога",value:"reference"},{label:"Номер договора залога (ипотеки)",value:"contractNumber"},{label:"№ договора (9131)",value:"account9131"}]}),s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Введите значение для поиска",prefix:s.jsx(Pa,{}),value:t,onChange:P=>r(P.target.value),style:{flex:1}})]}),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),onClick:()=>{const P=["REFERENCE","Номер договора","Залогодатель","Заемщик","ИНН","Тип залога","Стоимость залога","Задолженность","Сегмент","Группа"],Q=I.map(z=>[z.reference||"",z.contractNumber||"",z.pledger||"",z.borrower||"",z.inn||"",z.collateralType||"",z.collateralValue||"",z.debtRub||"",z.segment||"",z.group||""]),Y=[P.join("	"),...Q.map(z=>z.join("	"))].join(`
`),ee=new Blob(["\uFEFF"+Y],{type:"text/csv;charset=utf-8;"}),V=document.createElement("a"),G=URL.createObjectURL(ee);V.setAttribute("href",G),V.setAttribute("download",`Залоговый_портфель_${new Date().toISOString().split("T")[0]}.xls`),V.style.visibility="hidden",document.body.appendChild(V),V.click(),document.body.removeChild(V)},children:"Выгрузить в EXCEL"})]})]}),s.jsx(Ue,{children:s.jsxs("div",{className:"portfolio-page__filters",children:[s.jsx(Ve,{allowClear:!0,placeholder:"Сегмент",style:{width:180},options:U.segments.map(P=>({label:P,value:P})),value:i??void 0,onChange:P=>o(P??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Группа",style:{width:180},options:U.groups.map(P=>({label:P,value:P})),value:l??void 0,onChange:P=>c(P??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Ликвидность",style:{width:180},options:U.liquidity.map(P=>({label:P,value:P})),value:A??void 0,onChange:P=>d(P??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Вид мониторинга",style:{width:220},options:U.monitoring.map(P=>({label:P,value:P})),value:f??void 0,onChange:P=>p(P??null)})]})}),s.jsxs(dt,{gutter:[16,16],className:"portfolio-page__stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{className:"portfolio-page__card",children:s.jsx(pt,{title:"Количество договоров",value:L.totalRows,prefix:s.jsx(tA,{}),valueStyle:{color:"#1d39c4"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{className:"portfolio-page__card",children:s.jsx(pt,{title:"Совокупная задолженность",value:ad.format(L.totalDebt)})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{className:"portfolio-page__card",children:s.jsx(pt,{title:"Рыночная стоимость",value:ad.format(L.totalMarket),valueStyle:{color:"#52c41a"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{className:"portfolio-page__card",children:s.jsx(pt,{title:"Средний LTV / Просрочка",valueRender:()=>s.jsxs("div",{children:[s.jsx("div",{children:T1.format(L.averageLtv||0)}),s.jsxs("div",{className:"portfolio-page__muted",children:["просрочка ",T1.format(L.overdueShare||0)]})]})})})})]}),s.jsx(Ue,{className:"portfolio-page__table-card",bodyStyle:{padding:0},children:s.jsx(ir,{columns:N,dataSource:I,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:h,onRow:P=>({onDoubleClick:()=>_(P)}),locale:{emptyText:s.jsx(Sr,{description:"Нет записей, удовлетворяющих фильтрам",className:"portfolio-page__empty"})}})}),y&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные залогов",description:y,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),h&&s.jsx("div",{style:{textAlign:"center"},children:s.jsx(es,{tip:"Загружаем данные залогов..."})}),E&&s.jsx(Rz,{contract:E,visible:S,onClose:R,onUpdate:P=>{g(Q=>Q.map(Y=>Y.reference===P.reference||Y.contractNumber===P.contractNumber?{...Y,...P,key:Y.key}:Y)),k({...P,key:(E==null?void 0:E.key)||`portfolio-${Date.now()}`})}}),s.jsx(_z,{visible:b,deal:E,onCancel:()=>O(!1),onSuccess:()=>{}})]})},Mz=()=>{const[e,t]=M.useState([]),[r,a]=M.useState([]),[n,i]=M.useState(""),[o,l]=M.useState(null),[c,A]=M.useState(null),[d,f]=M.useState(null),[p,u]=M.useState(null),[g,h]=M.useState([]),[x,y]=M.useState(!0),[v,E]=M.useState(null),[k,S]=M.useState(!1),[B,b]=M.useState([]),[O,_]=M.useState(""),U=M.useMemo(()=>{const D=new Map,j=new Map;return e.forEach(K=>{const W=String(K.reference||"");j.has(W)||j.set(W,[]),j.get(W).push(K)}),r.forEach(K=>{const W=K.borrower||"Не указан",Ae=K.contractNumber||`Договор ${K.reference||"без номера"}`,ue=K.pledger||"Не указан",he=K.collateralContractNumber||`Договор залога ${K.reference||"без номера"}`,ve=String(K.reference||""),we=j.get(ve)||[];if(we.length>0){const se=`client-${W}-loan-${Ae}-pledger-${ue}-pledge-${he}`;D.set(se,{docs:we,title:`Документы по договору залога: ${he}`})}}),D},[r,e]);M.useEffect(()=>{let D=!0;return(async()=>{y(!0),E(null);try{const K=(()=>{const he="/",ve=new URL(he,window.location.origin),we=ve.pathname.endsWith("/")?ve.pathname:`${ve.pathname}/`;return`${ve.origin}${we}portfolioData.json`})(),W=await fetch(`${K}?v=${Date.now()}`,{cache:"no-store"});let Ae=[];W.ok&&(Ae=await W.json());const ue=await kt.getExtendedCards();try{const he=await pS(Ae,ue);if(!D)return;a(Ae),t(he.documents),localStorage.setItem("collateralDossierData",JSON.stringify(he))}catch(he){console.warn("Ошибка генерации демо-данных, используем сохраненные:",he);const ve=localStorage.getItem("collateralDossierData");if(ve){const we=JSON.parse(ve);a(Ae),t(we.documents)}else a(Ae),t([])}}catch(K){try{const W=localStorage.getItem("collateralDossierData");if(W){const Ae=JSON.parse(W);t(Ae.documents)}else throw K}catch{E(K instanceof Error?K.message:"Неизвестная ошибка")}}finally{D&&y(!1)}})(),()=>{D=!1}},[]);const I=M.useMemo(()=>{const D=new Map;return e.forEach(j=>{const K=String(j.reference||"");D.has(K)||D.set(K,[]),D.get(K).push(j)}),D},[e]),R=M.useMemo(()=>{const D=new Set,j=new Set,K=new Set,W=new Set,Ae=new Set;for(const ue of r)ue.borrower&&D.add(ue.borrower),ue.contractNumber&&j.add(ue.contractNumber),ue.pledger&&K.add(ue.pledger),ue.collateralContractNumber&&W.add(ue.collateralContractNumber);for(const ue of e)ue.status&&Ae.add(ue.status);return{clients:Array.from(D).sort(),loanContracts:Array.from(j).sort(),pledgers:Array.from(K).sort(),pledgeContracts:Array.from(W).sort(),statuses:Array.from(Ae).sort()}},[r,e]),L=M.useCallback(D=>D.length>30?D.substring(0,27)+"...":D,[]),N=M.useCallback(D=>({key:D.id||`${D.folderId}-${D.fileName}`,title:s.jsx(Kr,{title:D.docType,children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 0"},children:[s.jsx(jr,{style:{color:"#1890ff"}}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:500},children:L(D.docType)}),s.jsx("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:D.fileName}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:4},children:[s.jsx(Ze,{color:D.statusColor||"default",style:{margin:0},children:D.status}),s.jsxs("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:[D.size," • ",D.lastUpdated]})]})]})]})}),isLeaf:!0,icon:s.jsx(jr,{})}),[L]),P=M.useMemo(()=>{const D=n.trim().toLowerCase(),j=D.length>0,K=new Map;for(const Ae of r){const ue=Ae.borrower||"Не указан",he=Ae.contractNumber||`Договор ${Ae.reference||"без номера"}`,ve=Ae.pledger||"Не указан",we=Ae.collateralContractNumber||`Договор залога ${Ae.reference||"без номера"}`,se=String(Ae.reference||""),He=I.get(se)||[];if(o&&ue!==o||c&&he!==c||d&&ve!==d||p&&we!==p)continue;if(j){const Ge=ue.toLowerCase(),et=he.toLowerCase(),Ye=ve.toLowerCase(),tt=we.toLowerCase();let je=Ge.includes(D)||et.includes(D)||Ye.includes(D)||tt.includes(D);if(je||(je=He.some(_e=>_e.docType.toLowerCase().includes(D)||_e.fileName.toLowerCase().includes(D))),!je)continue}K.has(ue)||K.set(ue,new Map);const Ee=K.get(ue);Ee.has(he)||Ee.set(he,new Map);const pe=Ee.get(he);pe.has(ve)||pe.set(ve,new Map);const ce=pe.get(ve);if(!ce.has(we))ce.set(we,He);else{const Ge=ce.get(we);ce.set(we,[...Ge,...He])}}return Array.from(K.entries()).map(([Ae,ue])=>{const he=`client-${Ae}`,ve=Array.from(ue.entries()).map(([we,se])=>{const He=`${he}-loan-${we}`,Ee=Array.from(se.entries()).map(([pe,ce])=>{const Ge=`${He}-pledger-${pe}`,et=Array.from(ce.entries()).map(([Ye,tt])=>{const je=`${Ge}-pledge-${Ye}`,_e=tt.map(At=>N(At));return{key:je,title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(lo,{style:{color:"#faad14"}}),s.jsxs("span",{style:{fontWeight:500},children:["Договор залога: ",Ye]}),s.jsxs(Ze,{color:"blue",style:{margin:0},children:[tt.length," документов"]})]}),children:_e.length>0?_e:void 0,icon:s.jsx(lo,{})}});return{key:Ge,title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(lo,{style:{color:"#52c41a"}}),s.jsxs("span",{style:{fontWeight:500},children:["Залогодатель: ",pe]})]}),children:et,icon:s.jsx(lo,{})}});return{key:He,title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(lo,{style:{color:"#722ed1"}}),s.jsxs("span",{style:{fontWeight:500},children:["Кредитный договор: ",we]})]}),children:Ee,icon:s.jsx(lo,{})}});return{key:he,title:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(lo,{style:{color:"#eb2f96"}}),s.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Клиент: ",Ae]})]}),children:ve,icon:s.jsx(lo,{})}})},[r,I,n,o,c,d,p,N]);M.useEffect(()=>{if(P.length>0&&g.length===0){const D=P.map(j=>j.key);h(D)}},[P,g.length]);const Q=M.useCallback(D=>{h(D)},[]),Y=M.useCallback(D=>{const j=D[0];if(!(!j||typeof j!="string")&&j.includes("-pledge-")&&!j.includes("-doc-")){const K=U.get(j);K&&K.docs.length>0&&(_(K.title),b(K.docs),S(!0))}},[U]),ee=M.useMemo(()=>{const D=new Set;for(const j of r)(!o||j.borrower===o)&&j.contractNumber&&D.add(j.contractNumber);return Array.from(D).sort().map(j=>s.jsx(Ve.Option,{value:j,label:j,children:j},j))},[r,o]),V=M.useMemo(()=>{const D=new Set;for(const j of r)o&&j.borrower!==o||c&&j.contractNumber!==c||j.pledger&&D.add(j.pledger);return Array.from(D).sort().map(j=>s.jsx(Ve.Option,{value:j,label:j,children:j},j))},[r,o,c]),G=M.useMemo(()=>{const D=new Set;for(const j of r)o&&j.borrower!==o||c&&j.contractNumber!==c||d&&j.pledger!==d||j.collateralContractNumber&&D.add(j.collateralContractNumber);return Array.from(D).sort().map(j=>s.jsx(Ve.Option,{value:j,label:j,children:j},j))},[r,o,c,d]),z=M.useMemo(()=>[{title:"Тип документа",dataIndex:"docType",key:"docType",width:200,render:(D,j)=>s.jsx(Kr,{title:j.docType,children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(jr,{style:{color:"#1890ff"}}),s.jsx("span",{children:L(D)})]})})},{title:"Имя файла",dataIndex:"fileName",key:"fileName",ellipsis:!0},{title:"Статус",dataIndex:"status",key:"status",width:150,render:(D,j)=>s.jsx(Ze,{color:j.statusColor||"default",children:D})},{title:"Размер",dataIndex:"size",key:"size",width:100},{title:"Обновлен",dataIndex:"lastUpdated",key:"lastUpdated",width:120},{title:"Действия",key:"actions",width:100,render:(D,j)=>s.jsx(Kr,{title:"Скачать документ",children:s.jsx(In,{style:{fontSize:16,color:"#1890ff",cursor:"pointer"},onClick:()=>{console.log("Download:",j)}})})}],[L]),C=M.useMemo(()=>{let D=0,j=0;for(const W of e)W.status==="Загружен"?D++:W.status==="На согласовании"&&j++;const K=e.length;return{totalDocs:K,completed:D,pending:j,completionRate:K?Math.round(D/K*100):0}},[e]);return s.jsxs("div",{className:"collateral-dossier",children:[s.jsx("div",{className:"collateral-dossier__header",children:s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"collateral-dossier__title",children:"Залоговое досье"}),s.jsx(ht.Paragraph,{className:"collateral-dossier__subtitle",children:"Документооборот по сделкам залогового портфеля: заключения, отчеты об оценке, мониторинги, фотофиксация и регистраторы."})]})}),s.jsx(Ue,{style:{marginBottom:16},children:s.jsxs(Te,{size:"middle",wrap:!0,style:{width:"100%"},children:[s.jsx(Kr,{title:"Поиск по клиенту, договору, залогодателю или документу",children:s.jsx(Re,{allowClear:!0,placeholder:"Поиск...",prefix:s.jsx(Pa,{}),value:n,onChange:D=>i(D.target.value),style:{minWidth:250}})}),s.jsx(Ve,{allowClear:!0,placeholder:"Клиент",style:{minWidth:200},value:o,onChange:D=>{l(D),D||(A(null),f(null),u(null))},showSearch:!0,filterOption:(D,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(D.toLowerCase()),children:R.clients.map(D=>s.jsx(Ve.Option,{value:D,label:D,children:D},D))}),s.jsx(Ve,{allowClear:!0,placeholder:"Кредитный договор",style:{minWidth:200},value:c,onChange:D=>{A(D),D||(f(null),u(null))},showSearch:!0,filterOption:(D,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(D.toLowerCase()),disabled:!o,loading:x,children:ee}),s.jsx(Ve,{allowClear:!0,placeholder:"Залогодатель",style:{minWidth:200},value:d,onChange:D=>{f(D),D||u(null)},showSearch:!0,filterOption:(D,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(D.toLowerCase()),disabled:!c,loading:x,children:V}),s.jsx(Ve,{allowClear:!0,placeholder:"Договор залога",style:{minWidth:200},value:p,onChange:u,showSearch:!0,filterOption:(D,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(D.toLowerCase()),disabled:!d,loading:x,children:G})]})}),s.jsxs(dt,{gutter:[16,16],style:{marginBottom:16},children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего документов",value:C.totalDocs})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Загружено",value:C.completed,valueStyle:{color:"#52c41a"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"На согласовании",value:C.pending,valueStyle:{color:"#fa8c16"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Готовность досье",value:`${C.completionRate}%`,valueStyle:{color:"#1677ff"}})})})]}),s.jsx(Ue,{children:v?s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить досье",description:v,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}):x?s.jsx(Sr,{description:"Загрузка..."}):P.length===0?s.jsx(Sr,{description:"Нет документов"}):s.jsx($T,{showLine:{showLeafIcon:!1},showIcon:!0,expandedKeys:g,onExpand:Q,onSelect:Y,treeData:P,style:{fontSize:"14px"},virtual:!1,blockNode:!0})}),s.jsx(cr,{title:O,open:k,onCancel:()=>S(!1),footer:null,width:1e3,destroyOnClose:!0,children:s.jsx(ir,{columns:z,dataSource:B,rowKey:D=>D.id||`${D.folderId}-${D.fileName}`,pagination:{pageSize:10,showSizeChanger:!0,showTotal:D=>`Всего документов: ${D}`},size:"middle"})})]})};var hS={exports:{}};(function(e,t){(function(r,a){e.exports=a()})(_T,function(){return function(r,a,n){r=r||{};var i=a.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(A,d,f,p){return i.fromToBase(A,d,f,p)}n.en.relativeTime=o,i.fromToBase=function(A,d,f,p,u){for(var g,h,x,y=f.$locale().relativeTime||o,v=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],E=v.length,k=0;k<E;k+=1){var S=v[k];S.d&&(g=p?n(A).diff(f,S.d,!0):f.diff(A,S.d,!0));var B=(r.rounding||Math.round)(Math.abs(g));if(x=g>0,B<=S.r||!S.r){B<=1&&k>0&&(S=v[k-1]);var b=y[S.l];u&&(B=u(""+B)),h=typeof b=="string"?b.replace("%d",B):b(B,d,S.l,x);break}}if(d)return h;var O=x?y.future:y.past;return typeof O=="function"?O(h):O.replace("%s",h)},i.to=function(A,d){return l(A,d,this,!0)},i.from=function(A,d){return l(A,d,this)};var c=function(A){return A.$u?n.utc():n()};i.toNow=function(A){return this.to(c(this),A)},i.fromNow=function(A){return this.from(c(this),A)}}})})(hS);var Pz=hS.exports;const Qz=db(Pz),Vo=[{key:"collateralName",label:"Наименование, назначение",type:"text",required:!0,placeholder:"Наименование имущества",group:"Основная информация"},{key:"collateralLocation",label:"Адрес местоположения",type:"text",required:!0,placeholder:"Адрес местоположения",group:"Основная информация"},{key:"ownershipShare",label:"Оцениваемые права, доля в праве %",type:"number",min:0,max:100,unit:"%",group:"Основная информация"},{key:"marketValue",label:"Рыночная стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"collateralValue",label:"Залоговая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"fairValue",label:"Справедливая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"category",label:"Категория обеспечения",type:"select",options:["Основной","Формальный"],group:"Характеристики"},{key:"liquidity",label:"Ликвидность",type:"select",options:["высокая (срок реализации до 90 дней)","удовлетворительная (срок реализации до 365 дней)","низкая (срок реализации свыше 365 дней)","малоудовлетворительная"],group:"Характеристики"},{key:"collateralCondition",label:"Состояние имущества",type:"select",options:["хорошее","удовлетворительное","неудовлетворительное"],group:"Характеристики"}],qm=[...Vo,{key:"totalAreaSqm",label:"Общая площадь объекта, кв. м. (или протяженность и т.п. в соответствующих единицах измерения) Только цифры",type:"number",required:!0,min:0,unit:"кв.м",group:"Параметры объекта"},{key:"objectCadastralNumber",label:"Кадастровый номер объекта",type:"text",placeholder:"23:49:0303008:1915",group:"Параметры объекта"},{key:"landCadastralNumber",label:"Кадастровый номер земельного участка",type:"text",placeholder:"23:49:0303008:1915",group:"Земельный участок"},{key:"landCategory",label:"Категория земель",type:"select",options:["Земли водного фонда","Земли запаса","Земли лесного фонда","Земли населенных пунктов","Земли особоохраняемых территорий и","Земли промышленности, энергетики, тр","Земли сельскохозяйственного назначен","Категория не установлена","-"],group:"Земельный участок"},{key:"landPermittedUse",label:"Вид разрешенного использования земельного участка (только по земельным участкам)",type:"text",placeholder:"Вид разрешенного использования земельного участка",group:"Земельный участок"},{key:"structureType",label:"Тип строения/Категория участка",type:"text",placeholder:"Тип строения или категория участка",group:"Параметры объекта"},{key:"landAreaSqm",label:"Площадь земельного участка",type:"number",min:0,unit:"кв.м",group:"Земельный участок"},{key:"cadastralValue",label:"Кадастровая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"bookValue",label:"Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"marketValuePerSqm",label:"Рыночная стоимость за кв.м",type:"number",min:0,unit:"руб./кв.м",group:"Оценка"},{key:"buildYear",label:"Год строительства",type:"number",min:1800,max:new Date().getFullYear(),group:"Параметры объекта"},{key:"hasReplanning",label:"Наличие перепланировок",type:"boolean",group:"Состояние"},{key:"hasEncumbrances",label:"Наличие обременений",type:"boolean",group:"Состояние"},{key:"encumbrancesDescription",label:"Описание обременений",type:"textarea",placeholder:"Описание зарегистрированных обременений",group:"Состояние"}],zp=[...qm,{key:"livingArea",label:"Жилая площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"kitchenArea",label:"Площадь кухни",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"roomsCount",label:"Количество комнат",type:"number",min:1,group:"Параметры объекта"},{key:"floor",label:"Этаж",type:"number",min:1,group:"Параметры объекта"},{key:"totalFloors",label:"Этажность дома",type:"number",min:1,group:"Параметры объекта"},{key:"ceilingHeight",label:"Высота потолков",type:"number",min:2,max:6,unit:"м",group:"Параметры объекта"},{key:"wallMaterial",label:"Материал стен",type:"select",options:["Кирпич","Панель","Монолит","Блочный","Дерево","Кирпичный/Сталинский","Пенобетонные/Газобетонное блоки"],group:"Параметры объекта"},{key:"separateBathrooms",label:"Количество санузлов",type:"number",min:0,group:"Параметры объекта"},{key:"balcony",label:"Наличие балкона/лоджии",type:"boolean",group:"Параметры объекта"}],Rl=[...qm,{key:"floor",label:"Этаж",type:"number",min:-2,group:"Параметры объекта"},{key:"totalFloors",label:"Этажность здания",type:"number",min:1,group:"Параметры объекта"},{key:"ceilingHeight",label:"Высота потолков",type:"number",min:2.5,max:20,unit:"м",group:"Параметры объекта"},{key:"buildingClass",label:"Класс здания",type:"select",options:["A+","A","B+","B","C"],group:"Параметры объекта"},{key:"structureClass",label:"Класс сооружения",type:"select",options:["A+","A","B+","B","C","D"],group:"Параметры объекта"},{key:"wallMaterial",label:"Материал стен",type:"select",options:["Деревянные","Кирпич","Кирпичный/Сталинский","Металлические без утепления","Монолит/Монолит-кирпич","Панельный/блочный","Пенобетонные/Газобетонное блоки","Сэндвич панели","-"],group:"Параметры объекта"},{key:"ceilingMaterial",label:"Материал перекрытий",type:"select",options:["Деревянные балки","Металлические балки","ж/б","-"],group:"Параметры объекта"},{key:"structuralCondition",label:"Состояние конструктивных элементов здания (Общ. тех. сост. здания)",type:"select",options:["Хорошее","Удовлетворительное","Неудовлетворительное","Требует ремонта"],group:"Состояние"},{key:"finishLevel",label:"Тип отделки",type:"select",options:["Евроремонт","Неизвестно","Простая","Среднее","Требуется кап. ремонт/Без отделки","Улучшенная","-"],group:"Состояние"},{key:"finishCondition",label:"Состояние отделки",type:"select",options:["Без отделки","Требуется кап.ремонт","Требуется косметический ремонт","Удовлетворительное","Хорошее","-"],group:"Состояние"},{key:"hasElectricity",label:"Электричество",type:"boolean",group:"Коммуникации"},{key:"hasWaterSupply",label:"Водоснабжение",type:"boolean",group:"Коммуникации"},{key:"hasSewerage",label:"Канализация",type:"boolean",group:"Коммуникации"},{key:"hasGasSupply",label:"Газоснабжение",type:"boolean",group:"Коммуникации"},{key:"hasSecurityAlarm",label:"Охранная сигнализация",type:"boolean",group:"Безопасность"},{key:"hasFireAlarm",label:"Пожарная сигнализация",type:"boolean",group:"Безопасность"},{key:"hasVideoSurveillance",label:"Видеонаблюдение",type:"boolean",group:"Безопасность"},{key:"replanning",label:"Тип перепланировки",type:"select",options:["Несущественные","Перепланировки отсутствуют","Существенные","-"],group:"Состояние"},{key:"landPermittedUse",label:"Вид разрешенного использования земельного участка",type:"text",placeholder:"Вид разрешенного использования",group:"Земельный участок"},{key:"ownershipRight",label:"Вид права",type:"select",options:["Иное","Право аренды","Право собственности"],group:"Права"},{key:"leaseExpirationDate",label:"Дата окончания срока аренды объекта недвижимости",type:"date",group:"Права"},{key:"ownershipShare",label:"Размер доли в праве",type:"text",placeholder:"Например: 1/1, 1/2, 1/3",group:"Права",description:"Указывается в виде дроби, например: 1/1, 1/2, 1/3"},{key:"isUnfinishedConstruction",label:"Объект незавершенного строительства",type:"boolean",group:"Права"},{key:"ownershipBasis",label:"Право, на основании которого объект принадлежит Залогодателю/документы-основания возникновения права",type:"textarea",placeholder:"Например: Право собственности, на основании следующих документов: Договор купли-продажи",group:"Права"},{key:"technicalDocument",label:"Документ, отражающий технические характеристики объекта",type:"select",options:["Выписка из Единого государственного реестра недвижимости об объекте","Технический паспорт","Техническое заключение","Проектная документация","Иной документ"],group:"Документы"},{key:"hasEncumbrances",label:"Наличие обременений (аренда и т.п.)",type:"boolean",group:"Права"},{key:"encumbrancesDescription",label:"Описание обременений",type:"textarea",placeholder:"Описание зарегистрированных обременений",group:"Права"},{key:"bookValue",label:"Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"comment",label:"Комментарий",type:"textarea",placeholder:"Дополнительные комментарии",group:"Дополнительно"},{key:"parking",label:"Наличие парковки",type:"boolean",group:"Инфраструктура"},{key:"parkingSpaces",label:"Количество машиномест",type:"number",min:0,group:"Инфраструктура"}],qz=[...Rl,{key:"storageArea",label:"Площадь хранения",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"warehouseClass",label:"Класс склада",type:"select",options:["A","A+","B","B+","C","D"],group:"Параметры объекта"},{key:"gates",label:"Тип ворот",type:"select",options:["Докового типа","На нулевой отметке","Смешанные"],group:"Параметры объекта"},{key:"gatesCount",label:"Количество ворот",type:"number",min:0,group:"Параметры объекта"},{key:"flooring",label:"Покрытие пола",type:"select",options:["Бетон","Асфальт","Полимер","Плитка"],group:"Параметры объекта"},{key:"loadCapacity",label:"Нагрузка на пол",type:"number",min:0,unit:"тонн/кв.м",group:"Параметры объекта"},{key:"heating",label:"Отопление",type:"boolean",group:"Инфраструктура"},{key:"ramp",label:"Наличие рампы",type:"boolean",group:"Инфраструктура"}],Kz=[...qm,{key:"landArea",label:"Площадь участка",type:"number",required:!0,min:0,unit:"кв.м",group:"Параметры объекта"},{key:"buildingArea",label:"Площадь здания",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"dispensersCount",label:"Количество ТРК",type:"number",required:!0,min:1,group:"Параметры объекта"},{key:"tanksVolume",label:"Объем резервуаров",type:"number",min:0,unit:"куб.м",group:"Параметры объекта"},{key:"fuelTypes",label:"Количество видов топлива",type:"number",min:1,group:"Параметры объекта"},{key:"carWash",label:"Наличие автомойки",type:"boolean",group:"Инфраструктура"},{key:"shop",label:"Наличие магазина",type:"boolean",group:"Инфраструктура"},{key:"cafe",label:"Наличие кафе",type:"boolean",group:"Инфраструктура"}],y2=[...Vo,{key:"brand",label:"Марка ТС",type:"text",required:!0,placeholder:"Марка транспортного средства",group:"Основная информация"},{key:"model",label:"Модель",type:"text",required:!0,placeholder:"Модель транспортного средства",group:"Основная информация"},{key:"year",label:"Год выпуска",type:"number",required:!0,min:1900,max:new Date().getFullYear(),group:"Основная информация"},{key:"vin",label:"Идентификационный номер (VIN)",type:"text",placeholder:"VIN номер",group:"Основная информация"},{key:"registrationNumber",label:"Государственный регистрационный номер",type:"text",placeholder:"A777AA92",group:"Основная информация"},{key:"engineVolume",label:"Объем двигателя",type:"number",min:0,unit:"куб.см",group:"Технические характеристики"},{key:"enginePower",label:"Мощность двигателя",type:"number",min:0,unit:"л.с.",group:"Технические характеристики"},{key:"enginePowerKw",label:"Мощность двигателя",type:"number",min:0,unit:"кВт",group:"Технические характеристики"},{key:"fuelType",label:"Тип топлива",type:"select",options:["Бензин","Дизель","Гибрид","Электро","Газ"],group:"Технические характеристики"},{key:"transmission",label:"Коробка передач",type:"select",options:["Механическая","Автоматическая","Робот","Вариатор"],group:"Технические характеристики"},{key:"mileage",label:"Показания одометра",type:"number",min:0,unit:"км",group:"Технические характеристики"},{key:"color",label:"Цвет",type:"text",group:"Технические характеристики"},{key:"bodyNumber",label:"Номер кузова",type:"text",group:"Технические характеристики"},{key:"chassisNumber",label:"Номер шасси",type:"text",group:"Технические характеристики"},{key:"frameNumber",label:"Заводской номер машины (рамы)",type:"text",group:"Технические характеристики"}],Hz=[...y2,{key:"loadCapacity",label:"Грузоподъемность",type:"number",required:!0,min:0,unit:"т",group:"Технические характеристики"},{key:"bodyType",label:"Тип кузова",type:"select",options:["Бортовой","Тентованный","Рефрижератор","Самосвал","Фургон","Прицепы/полуприцепы"],group:"Технические характеристики"}],O1=[...Vo,{key:"name",label:"Наименование",type:"text",required:!0,placeholder:"Наименование оборудования",group:"Основная информация"},{key:"manufacturer",label:"Предприятие - изготовитель",type:"text",placeholder:"Производитель",group:"Основная информация"},{key:"model",label:"Модель",type:"text",placeholder:"Модель оборудования",group:"Основная информация"},{key:"year",label:"Год выпуска",type:"number",min:1900,max:new Date().getFullYear(),group:"Основная информация"},{key:"serialNumber",label:"Заводской номер",type:"text",placeholder:"Серийный номер",group:"Основная информация"},{key:"inventoryNumber",label:"Инвентарный номер",type:"text",group:"Основная информация"},{key:"type",label:"Тип техники",type:"text",placeholder:"Тип техники",group:"Основная информация"},{key:"power",label:"Мощность",type:"number",min:0,unit:"кВт",group:"Технические характеристики"},{key:"operatingHours",label:"Наработка (при наличии)",type:"number",min:0,unit:"моточасов",group:"Технические характеристики"},{key:"country",label:"Страна - изготовитель",type:"text",group:"Основная информация"},{key:"balanceValue",label:"Остаточная балансовая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"}],Gz={apartment:zp,room:zp,house:zp,townhouse:zp,land_residential:[...Vo,{key:"totalAreaHectares",label:"Общая площадь",type:"number",required:!0,min:0,unit:"сот.",group:"Параметры объекта"},{key:"landCadastralNumber",label:"Кадастровый номер",type:"text",required:!0,placeholder:"23:49:0303008:1915",group:"Основная информация"},{key:"landCategory",label:"Категория земель",type:"select",required:!0,options:["земли населенных пунктов","земли сельскохозяйственного назначения","земли промышленности","земли особо охраняемых территорий"],group:"Основная информация"},{key:"landPermittedUse",label:"Разрешенный вид использования",type:"text",required:!0,placeholder:"Вид разрешенного использования",group:"Основная информация"},{key:"utilities",label:"Коммуникации",type:"select",options:["Все","Частично","Отсутствуют"],group:"Инфраструктура"}],office:Rl,retail:[...Rl,{key:"tradingArea",label:"Торговая площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"showcaseLength",label:"Длина витрины",type:"number",min:0,unit:"м",group:"Параметры объекта"},{key:"entrance",label:"Вход",type:"select",options:["Отдельный","Общий"],group:"Параметры объекта"}],warehouse:qz,hotel:[...Rl,{key:"roomsCount",label:"Количество номеров",type:"number",required:!0,min:1,group:"Параметры объекта"},{key:"category",label:"Категория",type:"select",options:["Без категории","1 звезда","2 звезды","3 звезды","4 звезды","5 звезд"],group:"Параметры объекта"},{key:"restaurant",label:"Наличие ресторана",type:"boolean",group:"Инфраструктура"}],catering:[...Rl,{key:"hallArea",label:"Площадь зала",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"seatingCapacity",label:"Количество посадочных мест",type:"number",min:0,group:"Параметры объекта"},{key:"kitchen",label:"Наличие кухни",type:"boolean",group:"Параметры объекта"}],gas_station:Kz,car_dealership:[...Rl,{key:"showroomArea",label:"Площадь шоурума",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"serviceArea",label:"Площадь СТО",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"liftCapacity",label:"Количество подъемников",type:"number",min:0,group:"Параметры объекта"}],industrial_building:[...Rl,{key:"productionArea",label:"Производственная площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"craneway",label:"Наличие кран-балки",type:"boolean",group:"Параметры объекта"},{key:"craneCapacity",label:"Грузоподъемность кран-балки",type:"number",min:0,unit:"т",group:"Параметры объекта"},{key:"power",label:"Электрическая мощность",type:"number",min:0,unit:"кВт",group:"Инфраструктура"}],workshop:[...Rl,{key:"productionArea",label:"Производственная площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"specialization",label:"Специализация цеха",type:"text",group:"Параметры объекта"}],car_passenger:y2,car_truck:Hz,equipment:O1,machinery:O1,Недвижимость:qm,"Транспортные средства":y2,Оборудование:O1,"Товары в обороте":[...Vo,{key:"quantity",label:"Количество",type:"number",min:0,group:"Параметры объекта"},{key:"unit",label:"Единица измерения",type:"text",group:"Параметры объекта"}],"Ценные бумаги":[...Vo,{key:"securityType",label:"Тип ценных бумаг",type:"select",options:["Акции","Облигации","Векселя","Депозитарные расписки"],group:"Основная информация"},{key:"issuer",label:"Эмитент",type:"text",group:"Основная информация"},{key:"quantity",label:"Количество",type:"number",min:0,group:"Параметры объекта"}],"Права требования":[...Vo,{key:"debtor",label:"Должник",type:"text",group:"Основная информация"},{key:"debtAmount",label:"Сумма долга",type:"number",min:0,unit:"руб.",group:"Параметры объекта"}]},mS=e=>e&&Gz[e]||Vo,$y=e=>{const t=mS(e),r={};return t.forEach(a=>{const n=a.group||"Прочее";r[n]||(r[n]=[]),r[n].push(a)}),r},zz=(e,t)=>(e==null?void 0:e[t])??null,{TextArea:ME}=Re,{Title:Vp,Paragraph:Vz,Text:nd}=ht,$z=({visible:e,entry:t,onClose:r})=>{const[a,n]=M.useState(null),[i,o]=M.useState(!1),[l,c]=M.useState({inspectionDate:We().format("YYYY-MM-DD")});M.useEffect(()=>{if(!e||!(t!=null&&t.reference)){n(null);return}(async()=>{o(!0);try{const x="/",y=new URL(x,window.location.origin),v=y.pathname.endsWith("/")?y.pathname:`${y.pathname}/`,E=`${y.origin}${v}portfolioData.json?v=${Date.now()}`,k=await fetch(E,{cache:"no-store"});if(k.ok){const B=(await k.json()).find(b=>String(b.reference)===String(t.reference));B&&(n(B),c(b=>({...b,address:B.collateralLocation||void 0,inspectionDate:We().format("YYYY-MM-DD")})))}}catch(x){console.error("Ошибка загрузки данных портфеля:",x)}finally{o(!1)}})()},[e,t]);const A=M.useMemo(()=>a!=null&&a.collateralType?mS(a.collateralType):[],[a==null?void 0:a.collateralType]),d=M.useMemo(()=>a!=null&&a.collateralType?$y(a.collateralType):{},[a==null?void 0:a.collateralType]),f=Ma.useCallback((h,x)=>{if(x==null||x==="")return"—";const y=A.find(v=>v.key===h);return(y==null?void 0:y.type)==="number"&&typeof x=="number"?`${x.toLocaleString("ru-RU")}${y.unit?` ${y.unit}`:""}`:(y==null?void 0:y.type)==="boolean"?x?"Да":"Нет":(y==null?void 0:y.type)==="date"&&x?We(x).format("DD.MM.YYYY"):String(x)},[A]),p=Ma.useCallback(h=>a?a[h]??null:null,[a]),u=Ma.useMemo(()=>"/cms-check/index.html#/inspections",[]),g=M.useMemo(()=>{const h=[];if(h.push({key:"main",label:"Основная информация",icon:s.jsx(jr,{}),children:s.jsx("div",{className:"monitoring-card-content",children:s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"REFERENCE",span:2,children:s.jsx(nd,{strong:!0,children:(t==null?void 0:t.reference)??"—"})}),s.jsx(ye.Item,{label:"Заемщик",children:(t==null?void 0:t.borrower)??"—"}),s.jsx(ye.Item,{label:"Залогодатель",children:(t==null?void 0:t.pledger)??"—"}),s.jsx(ye.Item,{label:"Сегмент",children:(t==null?void 0:t.segment)??"—"}),s.jsx(ye.Item,{label:"Группа",children:(t==null?void 0:t.group)??"—"}),s.jsx(ye.Item,{label:"Тип обеспечения",children:(t==null?void 0:t.baseType)??"—"}),s.jsx(ye.Item,{label:"Детальный тип",children:(t==null?void 0:t.collateralType)??"—"}),s.jsx(ye.Item,{label:"Вид мониторинга",children:(t==null?void 0:t.monitoringType)??"—"}),s.jsx(ye.Item,{label:"Метод мониторинга",children:(t==null?void 0:t.monitoringMethod)??"—"}),s.jsx(ye.Item,{label:"Периодичность",children:t!=null&&t.frequencyMonths?`Каждые ${t.frequencyMonths} мес.`:"—"}),s.jsx(ye.Item,{label:"Последний мониторинг",children:(t==null?void 0:t.lastMonitoringDate)??"—"}),s.jsx(ye.Item,{label:"Планируемая дата",children:(t==null?void 0:t.plannedDate)??"—"}),s.jsx(ye.Item,{label:"Ответственный",children:(t==null?void 0:t.owner)??"—"}),s.jsx(ye.Item,{label:"Приоритет",children:(t==null?void 0:t.priority)??"—"}),(a==null?void 0:a.collateralValue)&&s.jsxs(ye.Item,{label:"Залоговая стоимость",children:[Number(a.collateralValue).toLocaleString("ru-RU")," руб."]}),(a==null?void 0:a.liquidity)&&s.jsx(ye.Item,{label:"Ликвидность",children:s.jsx(Ze,{children:a.liquidity})})]})})}),A.length>0){const x=Object.keys(d).length>0?s.jsx("div",{className:"monitoring-card-content",children:Object.entries(d).map(([y,v])=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx(Vp,{level:5,style:{marginBottom:"16px"},children:y}),s.jsx(ye,{bordered:!0,column:2,size:"small",children:v.map(E=>{const k=p(E.key);return s.jsx(ye.Item,{label:E.label,children:f(E.key,k)},E.key)})})]},y))}):s.jsx("div",{className:"monitoring-card-content",children:s.jsx(ye,{bordered:!0,column:2,size:"small",children:A.map(y=>{const v=p(y.key);return s.jsx(ye.Item,{label:y.label,children:f(y.key,v)},y.key)})})});h.push({key:"characteristics",label:"Характеристики имущества",icon:s.jsx(jr,{}),children:i?s.jsx("div",{style:{textAlign:"center",padding:"40px"},children:s.jsx(es,{size:"large",tip:"Загрузка характеристик..."})}):x})}return h.push({key:"inspection",label:"Акт осмотра",icon:s.jsx(Ao,{}),children:s.jsx("div",{className:"monitoring-card-content",children:s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(Vp,{level:5,children:"Система дистанционных осмотров"}),s.jsx(Vz,{type:"secondary",children:"Используйте CMS Check для проведения осмотра и загрузки фотографий"}),s.jsx(Be,{type:"primary",icon:s.jsx(Ao,{}),onClick:()=>{window.open(u,"_blank")},children:"Открыть CMS Check"})]}),s.jsx(jt,{}),s.jsxs("div",{children:[s.jsx(Vp,{level:5,children:"Данные акта осмотра"}),s.jsxs(dt,{gutter:[16,16],children:[s.jsxs(be,{xs:24,sm:12,children:[s.jsx(nd,{strong:!0,children:"Дата проверки:"}),s.jsx("br",{}),s.jsx(Dr,{style:{width:"100%",marginTop:"8px"},value:l.inspectionDate?We(l.inspectionDate):null,onChange:x=>{c(y=>({...y,inspectionDate:x?x.format("YYYY-MM-DD"):void 0}))},format:"DD.MM.YYYY"})]}),s.jsxs(be,{xs:24,sm:12,children:[s.jsx(nd,{strong:!0,children:"Инспектор:"}),s.jsx("br",{}),s.jsx(Re,{style:{marginTop:"8px"},placeholder:"ФИО инспектора",value:l.inspector,onChange:x=>{c(y=>({...y,inspector:x.target.value}))}})]}),s.jsxs(be,{xs:24,children:[s.jsxs(nd,{strong:!0,children:[s.jsx(tl,{})," Адрес:"]}),s.jsx("br",{}),s.jsx(Re,{style:{marginTop:"8px"},placeholder:"Адрес местоположения имущества",value:l.address,onChange:x=>{c(y=>({...y,address:x.target.value}))}})]}),s.jsxs(be,{xs:24,children:[s.jsx(nd,{strong:!0,children:"Описание состояния имущества:"}),s.jsx("br",{}),s.jsx(ME,{rows:4,style:{marginTop:"8px"},placeholder:"Опишите состояние имущества, выявленные недостатки, повреждения и т.д.",value:l.conditionDescription,onChange:x=>{c(y=>({...y,conditionDescription:x.target.value}))}})]}),s.jsxs(be,{xs:24,children:[s.jsx(nd,{strong:!0,children:"Примечания:"}),s.jsx("br",{}),s.jsx(ME,{rows:3,style:{marginTop:"8px"},placeholder:"Дополнительные примечания по результатам осмотра",value:l.notes,onChange:x=>{c(y=>({...y,notes:x.target.value}))}})]})]})]}),s.jsx(jt,{}),s.jsxs("div",{children:[s.jsxs(Vp,{level:5,children:[s.jsx(Ao,{})," Фотографии имущества"]}),l.photos&&l.photos.length>0?s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px",marginTop:"16px"},children:l.photos.map((x,y)=>s.jsx("div",{style:{position:"relative"},children:s.jsx(im,{src:x,alt:`Фото ${y+1}`,width:"100%",style:{borderRadius:"4px"},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="})},y))}):s.jsx(Sr,{description:"Фотографии не загружены",image:Sr.PRESENTED_IMAGE_SIMPLE,style:{margin:"20px 0"},children:s.jsx(Be,{type:"dashed",icon:s.jsx(Ao,{}),onClick:()=>{window.open(u,"_blank")},children:"Загрузить фотографии через CMS Check"})})]})]})})}),h},[t,a,A,d,i,l,u,f,p]);return t?s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(jr,{}),s.jsxs("span",{children:["Карточка мониторинга договора ",t.reference]})]}),open:e,onCancel:r,footer:[s.jsx(Be,{onClick:r,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:i&&!a?s.jsx("div",{style:{textAlign:"center",padding:"40px"},children:s.jsx(es,{size:"large",tip:"Загрузка данных..."})}):s.jsx(ri,{items:g,defaultActiveKey:"main",size:"small",type:"card"})}):null},gS=e=>{var t,r;return(t=e.address)!=null&&t.region?e.address.region:(r=e.address)!=null&&r.city?e.address.city:"Не указан"},Yz=e=>{const t=[],r=pr.getMonitoringEmployees(),a=new Map;return e.forEach(n=>{if(!n.nextMonitoringDate)return;const i=gS(n);a.has(i)||a.set(i,[]),a.get(i).push(n)}),a.forEach((n,i)=>{const o=pr.getMonitoringEmployeesByRegion(i);if(o.length===0){const c=r;if(c.length===0)return;n.forEach((A,d)=>{const f=c[d%c.length];t.push({cardId:A.id,employeeId:f.id,employeeName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim(),region:f.region})});return}const l=[...o].sort((c,A)=>{const d=c.monitoringWorkload||0,f=A.monitoringWorkload||0;return d-f});n.forEach((c,A)=>{const d=l[A%l.length];t.push({cardId:c.id,employeeId:d.id,employeeName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim(),region:d.region}),d.monitoringWorkload=(d.monitoringWorkload||0)+1})}),t.forEach(n=>{const i=pr.getEmployeeById(n.employeeId);if(i){const o=i.monitoringWorkload||0;pr.updateWorkload(n.employeeId,o,void 0)}}),t},Wz=e=>{const t=[],r=pr.getAppraisalEmployees(),a=new Map;return e.forEach(n=>{if(!n.nextEvaluationDate)return;const i=gS(n);a.has(i)||a.set(i,[]),a.get(i).push(n)}),a.forEach((n,i)=>{const o=pr.getAppraisalEmployeesByRegion(i);if(o.length===0){const c=r;if(c.length===0)return;n.forEach((A,d)=>{const f=c[d%c.length];t.push({cardId:A.id,employeeId:f.id,employeeName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim(),region:f.region})});return}const l=[...o].sort((c,A)=>{const d=c.appraisalWorkload||0,f=A.appraisalWorkload||0;return d-f});n.forEach((c,A)=>{const d=l[A%l.length];t.push({cardId:c.id,employeeId:d.id,employeeName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim(),region:d.region}),d.appraisalWorkload=(d.appraisalWorkload||0)+1})}),t.forEach(n=>{const i=pr.getEmployeeById(n.employeeId);if(i){const o=i.appraisalWorkload||0;pr.updateWorkload(n.employeeId,void 0,o)}}),t},PE=e=>{localStorage.setItem("cms_monitoring_assignments",JSON.stringify(e))},v2=()=>{const e="cms_monitoring_assignments";try{const t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch{return[]}},QE=e=>{localStorage.setItem("cms_appraisal_assignments",JSON.stringify(e))},w2=()=>{const e="cms_appraisal_assignments";try{const t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch{return[]}},Xz=e=>{const r=v2().find(a=>a.cardId===e);return r&&pr.getEmployeeById(r.employeeId)||null},Jz=e=>{const r=w2().find(a=>a.cardId===e);return r&&pr.getEmployeeById(r.employeeId)||null},{Title:Zz,Text:eV}=ht,{TextArea:tV}=Re,I1="cms_monitoring_settings",rV=()=>{const[e]=re.useForm(),[t,r]=M.useState(!1),[a,n]=M.useState([]),[i,o]=M.useState([]),[l,c]=M.useState([]),[A,d]=M.useState([]),[f,p]=M.useState({}),[u,g]=M.useState(!1);M.useEffect(()=>{try{const S=localStorage.getItem(I1);if(S){const B=JSON.parse(S);e.setFieldsValue(B)}else e.setFieldsValue({notificationsEnabled:!0,notificationFrequency:"weekly",clientNotificationsEnabled:!1,clientNotificationDaysBefore:7,autoReminderEnabled:!0,reminderDaysBefore:3})}catch(S){console.error("Ошибка загрузки настроек:",S)}},[e]),M.useEffect(()=>{(()=>{try{const B=pr.getEmployees();n(B.filter(b=>b.isActive)),o(pr.getMonitoringEmployees()),c(pr.getAppraisalEmployees()),d(pr.getRegions())}catch(B){console.error("Ошибка загрузки сотрудников:",B)}})()},[]),M.useEffect(()=>{const S=async()=>{try{const B=v2(),b=w2(),O=await kt.getExtendedCards(),_={};A.forEach(U=>{_[U]={};const I=O.filter(L=>{var P,Q;return(((P=L.address)==null?void 0:P.region)||((Q=L.address)==null?void 0:Q.city)||"Не указан")===U&&L.nextMonitoringDate});if(I.length>0){const L=I[0],N=B.find(P=>P.cardId===L.id);N&&(_[U].monitoring=N.employeeId)}const R=O.filter(L=>{var P,Q;return(((P=L.address)==null?void 0:P.region)||((Q=L.address)==null?void 0:Q.city)||"Не указан")===U&&L.nextEvaluationDate});if(R.length>0){const L=R[0],N=b.find(P=>P.cardId===L.id);N&&(_[U].appraisal=N.employeeId)}}),p(_)}catch(B){console.error("Ошибка загрузки назначений:",B)}};A.length>0&&S()},[A]);const h=async()=>{try{const S=await e.validateFields();r(!0),localStorage.setItem(I1,JSON.stringify(S)),Ne.success("Настройки мониторинга сохранены")}catch(S){console.error("Ошибка сохранения настроек:",S),Ne.error("Ошибка при сохранении настроек")}finally{r(!1)}},x=S=>{const B=a.find(b=>b.id===S);B&&e.setFieldsValue({bankEmployeeEmail:B.email||"",bankEmployeeName:`${B.lastName} ${B.firstName} ${B.middleName||""}`.trim(),bankEmployeeId:B.id})},y=async(S,B)=>{try{const O=(await kt.getExtendedCards()).filter(I=>{var L,N;return(((L=I.address)==null?void 0:L.region)||((N=I.address)==null?void 0:N.city)||"Не указан")===S&&I.nextMonitoringDate}),_=pr.getEmployeeById(B);if(!_)return;const U=v2();O.forEach(I=>{const R=U.findIndex(N=>N.cardId===I.id),L={cardId:I.id,employeeId:_.id,employeeName:`${_.lastName} ${_.firstName} ${_.middleName||""}`.trim(),region:_.region};R>=0?U[R]=L:U.push(L)}),PE(U),p(I=>({...I,[S]:{...I[S],monitoring:B}})),Ne.success(`Ответственный за мониторинг в регионе "${S}" назначен`)}catch(b){console.error("Ошибка назначения ответственного:",b),Ne.error("Ошибка при назначении ответственного")}},v=async(S,B)=>{try{const O=(await kt.getExtendedCards()).filter(I=>{var L,N;return(((L=I.address)==null?void 0:L.region)||((N=I.address)==null?void 0:N.city)||"Не указан")===S&&I.nextEvaluationDate}),_=pr.getEmployeeById(B);if(!_)return;const U=w2();O.forEach(I=>{const R=U.findIndex(N=>N.cardId===I.id),L={cardId:I.id,employeeId:_.id,employeeName:`${_.lastName} ${_.firstName} ${_.middleName||""}`.trim(),region:_.region};R>=0?U[R]=L:U.push(L)}),QE(U),p(I=>({...I,[S]:{...I[S],appraisal:B}})),Ne.success(`Ответственный за оценку в регионе "${S}" назначен`)}catch(b){console.error("Ошибка назначения ответственного:",b),Ne.error("Ошибка при назначении ответственного")}},E=async()=>{try{g(!0);const S=await kt.getExtendedCards(),B=Yz(S);PE(B);const b={};A.forEach(O=>{const _=B.find(U=>{var L,N;const I=S.find(P=>P.id===U.cardId);return(((L=I==null?void 0:I.address)==null?void 0:L.region)||((N=I==null?void 0:I.address)==null?void 0:N.city)||"Не указан")===O});_&&(b[O]={monitoring:_.employeeId})}),p(O=>({...O,...b})),Ne.success(`Автопилот выполнен: назначено ${B.length} объектов для мониторинга`)}catch(S){console.error("Ошибка автопилота мониторинга:",S),Ne.error("Ошибка при выполнении автопилота")}finally{g(!1)}},k=async()=>{try{g(!0);const S=await kt.getExtendedCards(),B=Wz(S);QE(B);const b={};A.forEach(O=>{const _=B.find(U=>{var L,N;const I=S.find(P=>P.id===U.cardId);return(((L=I==null?void 0:I.address)==null?void 0:L.region)||((N=I==null?void 0:I.address)==null?void 0:N.city)||"Не указан")===O});_&&(b[O]={appraisal:_.employeeId})}),p(O=>({...O,...b})),Ne.success(`Автопилот выполнен: назначено ${B.length} объектов для оценки`)}catch(S){console.error("Ошибка автопилота оценки:",S),Ne.error("Ошибка при выполнении автопилота")}finally{g(!1)}};return s.jsx("div",{style:{padding:"24px"},children:s.jsxs(Ue,{children:[s.jsxs("div",{style:{marginBottom:24},children:[s.jsxs(Zz,{level:3,style:{margin:0,display:"flex",alignItems:"center",gap:12},children:[s.jsx(Kc,{style:{fontSize:"28px",color:"#1890ff"}}),"Настройки мониторинга"]}),s.jsx(eV,{type:"secondary",style:{display:"block",marginTop:8},children:"Настройка уведомлений, периодичности и интеграции с почтовой рассылкой"})]}),s.jsx(jt,{}),s.jsxs(re,{form:e,layout:"vertical",onFinish:h,children:[s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(V1,{}),s.jsx("span",{children:"Настройки уведомлений"})]}),style:{marginBottom:24},children:[s.jsx(re.Item,{name:"notificationsEnabled",label:"Включить уведомления",valuePropName:"checked",children:s.jsx(ms,{})}),s.jsx(re.Item,{name:"notificationFrequency",label:"Периодичность уведомлений",rules:[{required:!0,message:"Выберите периодичность"}],children:s.jsxs(Ve,{children:[s.jsx(Ve.Option,{value:"daily",children:"Ежедневно"}),s.jsx(Ve.Option,{value:"weekly",children:"Еженедельно"}),s.jsx(Ve.Option,{value:"monthly",children:"Ежемесячно"}),s.jsx(Ve.Option,{value:"custom",children:"Произвольная (указать дни)"})]})}),s.jsx(re.Item,{noStyle:!0,shouldUpdate:(S,B)=>S.notificationFrequency!==B.notificationFrequency,children:({getFieldValue:S})=>S("notificationFrequency")==="custom"?s.jsx(re.Item,{name:"customNotificationDays",label:"Количество дней между уведомлениями",rules:[{required:!0,message:"Укажите количество дней"}],children:s.jsx(pa,{min:1,max:365,style:{width:"100%"}})}):null}),s.jsx(re.Item,{name:"autoReminderEnabled",label:"Автоматическое напоминание сотруднику",valuePropName:"checked",children:s.jsx(ms,{})}),s.jsx(re.Item,{noStyle:!0,shouldUpdate:(S,B)=>S.autoReminderEnabled!==B.autoReminderEnabled,children:({getFieldValue:S})=>S("autoReminderEnabled")?s.jsx(re.Item,{name:"reminderDaysBefore",label:"Напоминать за (дней до мониторинга)",rules:[{required:!0,message:"Укажите количество дней"}],children:s.jsx(pa,{min:1,max:30,style:{width:"100%"}})}):null})]}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(W1,{}),s.jsx("span",{children:"Интеграция с почтовой рассылкой"})]}),style:{marginBottom:24},children:[s.jsx(Nr,{message:"Настройка email-уведомлений",description:"Укажите сотрудника Банка, ответственного за мониторинг, для автоматической рассылки уведомлений",type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(re.Item,{name:"bankEmployeeId",label:"Ответственный сотрудник Банка",rules:[{required:!0,message:"Выберите сотрудника"}],children:s.jsx(Ve,{placeholder:"Выберите сотрудника",showSearch:!0,filterOption:(S,B)=>((B==null?void 0:B.label)??"").toLowerCase().includes(S.toLowerCase()),onChange:x,options:a.map(S=>({value:S.id,label:`${S.lastName} ${S.firstName} ${S.middleName||""}`.trim()}))})}),s.jsx(re.Item,{name:"bankEmployeeEmail",label:"Email для уведомлений",rules:[{required:!0,message:"Укажите email"},{type:"email",message:"Неверный формат email"}],children:s.jsx(Re,{prefix:s.jsx(W1,{}),placeholder:"email@example.com"})}),s.jsx(re.Item,{name:"bankEmployeeName",hidden:!0,children:s.jsx(Re,{})})]}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(V1,{}),s.jsx("span",{children:"Уведомления клиенту Банка"})]}),style:{marginBottom:24},children:[s.jsx(Nr,{message:"Автоматические уведомления клиенту",description:"Настройте автоматическую отправку уведомлений клиенту о предстоящем мониторинге",type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(re.Item,{name:"clientNotificationsEnabled",label:"Включить уведомления клиенту",valuePropName:"checked",children:s.jsx(ms,{})}),s.jsx(re.Item,{noStyle:!0,shouldUpdate:(S,B)=>S.clientNotificationsEnabled!==B.clientNotificationsEnabled,children:({getFieldValue:S})=>S("clientNotificationsEnabled")?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"clientNotificationDaysBefore",label:"Уведомлять клиента за (дней до мониторинга)",rules:[{required:!0,message:"Укажите количество дней"}],children:s.jsx(pa,{min:1,max:30,style:{width:"100%"}})}),s.jsx(re.Item,{name:"clientNotificationTemplate",label:"Шаблон уведомления клиенту",children:s.jsx(tV,{rows:6,placeholder:"Уважаемый клиент! Напоминаем, что {дата} запланирован мониторинг объекта залога по договору {номер_договора}. Пожалуйста, обеспечьте доступ к объекту."})})]}):null})]}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(ti,{}),s.jsx("span",{children:"Назначение ответственных за мониторинг"})]}),style:{marginBottom:24},extra:s.jsx(Be,{type:"primary",icon:s.jsx(gh,{}),onClick:E,loading:u,children:"Автопилот"}),children:[s.jsx(Nr,{message:"Распределение по регионам",description:"Назначьте ответственных сотрудников для мониторинга по каждому региону. Используйте 'Автопилот' для автоматического распределения с учетом загрузки сотрудников.",type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(ir,{dataSource:A.map(S=>{var B;return{key:S,region:S,monitoringEmployee:(B=f[S])==null?void 0:B.monitoring}}),columns:[{title:"Регион",dataIndex:"region",key:"region"},{title:"Ответственный за мониторинг",dataIndex:"monitoringEmployee",key:"monitoringEmployee",render:(S,B)=>s.jsx(Ve,{style:{width:"100%"},placeholder:"Выберите сотрудника",value:S,onChange:b=>y(B.region,b),options:i.filter(b=>b.region===B.region).map(b=>({value:b.id,label:`${b.lastName} ${b.firstName} ${b.middleName||""}`.trim()}))})}],pagination:!1})]}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(ti,{}),s.jsx("span",{children:"Назначение ответственных за оценку"})]}),style:{marginBottom:24},extra:s.jsx(Be,{type:"primary",icon:s.jsx(gh,{}),onClick:k,loading:u,children:"Автопилот"}),children:[s.jsx(Nr,{message:"Распределение по регионам",description:"Назначьте ответственных сотрудников для оценки по каждому региону. Используйте 'Автопилот' для автоматического распределения с учетом загрузки сотрудников.",type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(ir,{dataSource:A.map(S=>{var B;return{key:S,region:S,appraisalEmployee:(B=f[S])==null?void 0:B.appraisal}}),columns:[{title:"Регион",dataIndex:"region",key:"region"},{title:"Ответственный за оценку",dataIndex:"appraisalEmployee",key:"appraisalEmployee",render:(S,B)=>s.jsx(Ve,{style:{width:"100%"},placeholder:"Выберите сотрудника",value:S,onChange:b=>v(B.region,b),options:l.filter(b=>b.region===B.region).map(b=>({value:b.id,label:`${b.lastName} ${b.firstName} ${b.middleName||""}`.trim()}))})}],pagination:!1})]}),s.jsx(jt,{}),s.jsx(re.Item,{children:s.jsxs(Te,{children:[s.jsx(Be,{type:"primary",htmlType:"submit",icon:s.jsx(sm,{}),loading:t,size:"large",children:"Сохранить настройки"}),s.jsx(Be,{onClick:()=>{e.resetFields();const S=localStorage.getItem(I1);if(S){const B=JSON.parse(S);e.setFieldsValue(B)}},children:"Отменить изменения"})]})})]})]})})},xS=e=>e<0?"overdue":e<=7?"week":e<=30?"month":e<=90?"quarter":"later",tm=e=>{if(!e)return null;const t=e.split(".");if(t.length!==3)return null;const r=parseInt(t[0],10),a=parseInt(t[1],10)-1,n=parseInt(t[2],10);return new Date(n,a,r)},jd=e=>{const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return`${t}.${r}.${a}`},yS=(e,t)=>{if(e)return e.includes("недвижимость")||e.includes("здание")||e.includes("помещение")?"Недвижимость":e.includes("автомобиль")||e.includes("транспорт")?"Транспорт":e.includes("оборудование")||e.includes("техника")?"Оборудование":e.includes("товар")||e.includes("сырье")?"Товары и сырье":e.includes("право")||e.includes("доля")?"Имущественные права":e;switch(t){case"real_estate":return"Недвижимость";case"movable":return"Движимое имущество";case"property_rights":return"Имущественные права";default:return"Прочее"}},aV=(e,t)=>t==="real_estate"?"Выездной осмотр":t==="movable"?e!=null&&e.includes("автомобиль")||e!=null&&e.includes("транспорт")?"Документарная проверка + онлайн-проверка":"Выездной осмотр":"Документарная проверка",nV=(e,t)=>t==="real_estate"?"Оценка недвижимости":t==="movable"?e!=null&&e.includes("автомобиль")||e!=null&&e.includes("транспорт")?"Оценка транспортных средств":"Оценка оборудования":"Оценка имущественных прав",vS=(e,t)=>{if(t==="monitoring"){const a=Xz(e.id);if(a)return`${a.lastName} ${a.firstName} ${a.middleName||""}`.trim()}else{const a=Jz(e.id);if(a)return`${a.lastName} ${a.firstName} ${a.middleName||""}`.trim()}const r=["Иванов И.И.","Петров П.П.","Сидоров С.С.","Смирнов А.А.","Кузнецов Д.Д."];return r[Math.floor(Math.random()*r.length)]},wS=e=>{const t=[],r=We();return e.forEach(a=>{var u,g,h,x,y,v,E;if(a.mainCategory!=="real_estate"&&a.mainCategory!=="movable"||!a.nextMonitoringDate)return;const n=tm(a.nextMonitoringDate);if(!n)return;const i=tm(a.monitoringDate||a.nextMonitoringDate),o=We(n).diff(r,"day"),l=xS(o),c=((u=a.address)==null?void 0:u.city)||((g=a.address)==null?void 0:g.region)||null,A=c?Fy(c):null,d=(h=a.partners)==null?void 0:h.find(k=>k.role==="owner"),f=(x=a.partners)==null?void 0:x.find(k=>k.role==="pledgor"),p={reference:a.reference||null,borrower:d?d.type==="legal"?d.organizationName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim():null,pledger:f?f.type==="legal"?f.organizationName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim():null,segment:null,group:null,collateralType:a.propertyType||null,baseType:yS(a.propertyType,a.mainCategory),frequencyMonths:a.monitoringFrequencyMonths||12,monitoringType:((y=a.characteristics)==null?void 0:y.MONITORING_TYPE)||null,monitoringMethod:aV(a.propertyType,a.mainCategory),lastMonitoringDate:jd(i||n),plannedDate:jd(n),timeframe:l,owner:vS(a,"monitoring"),city:c,regionCenterCode:(A==null?void 0:A.code)||null,regionCenterName:(A==null?void 0:A.name)||null,priority:((v=a.characteristics)==null?void 0:v.PRIORITY)||null,liquidity:((E=a.characteristics)==null?void 0:E.LIQUIDITY)||null,collateralValue:a.pledgeValue||null};t.push(p)}),t},ES=e=>{const t=[],r=We();return e.forEach(a=>{var g,h,x,y,v;if(a.mainCategory!=="real_estate"&&a.mainCategory!=="movable"||!a.nextEvaluationDate)return;const n=tm(a.nextEvaluationDate);if(!n)return;const i=tm(a.lastEvaluationDate||a.evaluationDate||a.nextEvaluationDate),o=We(n).diff(r,"day"),l=xS(o),c=((g=a.address)==null?void 0:g.city)||((h=a.address)==null?void 0:h.region)||null,A=c?Fy(c):null,d=(x=a.partners)==null?void 0:x.find(E=>E.role==="owner"),f=(y=a.partners)==null?void 0:y.find(E=>E.role==="pledgor"),p=a.mainCategory==="real_estate"?12:6,u={reference:a.reference||null,borrower:d?d.type==="legal"?d.organizationName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim():null,pledger:f?f.type==="legal"?f.organizationName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim():null,segment:null,group:null,collateralType:a.propertyType||null,baseType:yS(a.propertyType,a.mainCategory),frequencyMonths:p,lastRevaluationDate:jd(i||n),plannedDate:jd(n),timeframe:l,owner:vS(a,"appraisal"),city:c,regionCenterCode:(A==null?void 0:A.code)||null,regionCenterName:(A==null?void 0:A.name)||null,priority:((v=a.characteristics)==null?void 0:v.PRIORITY)||null,collateralValue:a.pledgeValue||null,marketValue:a.marketValue||null,revaluationMethod:nV(a.propertyType,a.mainCategory)};t.push(u)}),t};We.extend(Qz);const qE=[{label:"Все",value:"all"},{label:"Просрочено",value:"overdue"},{label:"7 дней",value:"week"},{label:"30 дней",value:"month"},{label:"90 дней",value:"quarter"}],sV=()=>{var tt;const e=dc(),t=((tt=e.state)==null?void 0:tt.activeTab)||"monitoring",[r,a]=M.useState(t);M.useEffect(()=>{var _e;const je=(_e=e.state)==null?void 0:_e.activeTab;je&&(je==="monitoring"||je==="revaluation"||je==="settings")&&a(je)},[e.state]);const[n,i]=M.useState([]),[o,l]=M.useState(!0),[c,A]=M.useState(null),[d,f]=M.useState("week"),[p,u]=M.useState(""),[g,h]=M.useState(null),[x,y]=M.useState(null),[v,E]=M.useState(null),[k,S]=M.useState(!1),[B,b]=M.useState(null),[O,_]=M.useState(!1),[U,I]=M.useState([]),[R,L]=M.useState(!0),[N,P]=M.useState(null),[Q,Y]=M.useState("week"),[ee,V]=M.useState(""),[G,z]=M.useState(null),[C,D]=M.useState(null),[j,K]=M.useState(null);M.useEffect(()=>{let je=!0;return(async()=>{l(!0),A(null);try{const At=await kt.getExtendedCards();if(!je)return;const _t=wS(At).map((Et,Pt)=>{const Bt=We(Et.plannedDate,"DD.MM.YYYY").diff(We(),"day");let ut="#1677ff";return Bt<0?ut="#f5222d":Bt<=7?ut="#fa8c16":Bt<=30&&(ut="#52c41a"),{...Et,key:`${Et.reference??"ref"}-${Pt}`,daysUntil:Bt,statusColor:ut}});i(_t)}catch(At){A(At instanceof Error?At.message:"Неизвестная ошибка")}finally{je&&l(!1)}})(),()=>{je=!1}},[]);const W=M.useMemo(()=>Array.from(new Set(n.map(_e=>_e.baseType))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),Ae=M.useMemo(()=>Array.from(new Set(n.map(_e=>_e.monitoringMethod))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),ue=M.useMemo(()=>Array.from(new Set(n.map(_e=>_e.owner))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),he=M.useMemo(()=>{const je=p.trim().toLowerCase();return n.filter(_e=>{const At=!je||[_e.reference,_e.borrower,_e.pledger,_e.segment,_e.owner,_e.monitoringType].filter(Boolean).some(Lt=>String(Lt).toLowerCase().includes(je)),Ct=d==="all"||_e.timeframe===d,_t=!g||_e.baseType===g,Et=!x||_e.monitoringMethod===x,Pt=!v||_e.owner===v;return At&&Ct&&_t&&Et&&Pt})},[n,p,d,g,x,v]),ve=M.useMemo(()=>{const je={overdue:0,week:0,month:0,quarter:0,total:n.length};return n.forEach(_e=>{_e.timeframe in je&&(je[_e.timeframe]+=1)}),je},[n]),we=M.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:_e.reference??"—"}),s.jsx("div",{className:"monitoring-muted",children:_e.borrower??_e.pledger??"Не указан"}),s.jsxs("div",{className:"monitoring-muted",children:[_e.segment??"—"," · ",_e.group??"—"]})]})},{title:"Обеспечение",dataIndex:"baseType",key:"baseType",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(ht.Text,{children:_e.baseType}),s.jsx("div",{className:"monitoring-muted",children:_e.collateralType}),_e.liquidity&&s.jsx(Ze,{children:_e.liquidity})]})},{title:"План мониторинга",dataIndex:"plannedDate",key:"plannedDate",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(Bf,{color:_e.statusColor}),s.jsx(ht.Text,{style:{marginLeft:8},children:_e.plannedDate}),s.jsxs("div",{className:"monitoring-muted",children:["Последний: ",_e.lastMonitoringDate," · каждые ",_e.frequencyMonths," мес."]}),s.jsxs("div",{className:"monitoring-trend",children:[s.jsx(Vn,{}),_e.daysUntil<0?s.jsxs("span",{children:["Просрочен на ",Math.abs(_e.daysUntil)," дн."]}):s.jsxs("span",{children:["Через ",_e.daysUntil," дн."]})]})]})},{title:"Вид/метод мониторинга",dataIndex:"monitoringType",key:"monitoringType",width:240,render:(je,_e)=>s.jsxs("div",{children:[_e.monitoringType&&s.jsx(Ze,{color:"blue",children:_e.monitoringType}),s.jsx("div",{className:"monitoring-muted",children:_e.monitoringMethod})]})},{title:"Ответственный",dataIndex:"owner",key:"owner",width:180,render:je=>s.jsx(ht.Text,{children:je})},{title:"Приоритет",dataIndex:"priority",key:"priority",width:160,render:je=>s.jsx("span",{children:je??"—"})},{title:"Действия",key:"actions",width:100,fixed:"right",render:(je,_e)=>s.jsx(Kr,{title:"Открыть карточку мониторинга",children:s.jsxs("a",{onClick:()=>{b(_e),_(!0)},children:[s.jsx(Ii,{})," Открыть"]})})}],[b,_]);M.useEffect(()=>{let je=!0;return(async()=>{L(!0),P(null);try{const At=await kt.getExtendedCards();if(!je)return;const _t=ES(At).map((Et,Pt)=>{const Bt=We(Et.plannedDate,"DD.MM.YYYY").diff(We(),"day");let ut="#1677ff";return Bt<0?ut="#f5222d":Bt<=7?ut="#fa8c16":Bt<=30&&(ut="#52c41a"),{...Et,key:`${Et.reference??"ref"}-${Pt}`,daysUntil:Bt,statusColor:ut}});I(_t)}catch(At){P(At instanceof Error?At.message:"Неизвестная ошибка")}finally{je&&L(!1)}})(),()=>{je=!1}},[]);const se=M.useMemo(()=>Array.from(new Set(U.map(_e=>_e.baseType))).filter(Boolean).map(_e=>({value:_e,label:_e})),[U]),He=M.useMemo(()=>Array.from(new Set(U.map(_e=>_e.revaluationMethod))).filter(Boolean).map(_e=>({value:_e,label:_e})),[U]),Ee=M.useMemo(()=>Array.from(new Set(U.map(_e=>_e.owner))).filter(Boolean).map(_e=>({value:_e,label:_e})),[U]),pe=M.useMemo(()=>{const je=ee.trim().toLowerCase();return U.filter(_e=>{const At=!je||[_e.reference,_e.borrower,_e.pledger,_e.segment,_e.owner,_e.revaluationMethod].filter(Boolean).some(Lt=>String(Lt).toLowerCase().includes(je)),Ct=Q==="all"||_e.timeframe===Q,_t=!G||_e.baseType===G,Et=!C||_e.revaluationMethod===C,Pt=!j||_e.owner===j;return At&&Ct&&_t&&Et&&Pt})},[U,ee,Q,G,C,j]),ce=M.useMemo(()=>{const je={overdue:0,week:0,month:0,quarter:0,total:U.length};return U.forEach(_e=>{_e.timeframe in je&&(je[_e.timeframe]+=1)}),je},[U]),Ge=M.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(ht.Text,{strong:!0,children:_e.reference??"—"}),s.jsx("div",{className:"monitoring-muted",children:_e.borrower??_e.pledger??"Не указан"}),s.jsxs("div",{className:"monitoring-muted",children:[_e.segment??"—"," · ",_e.group??"—"]})]})},{title:"Обеспечение",dataIndex:"baseType",key:"baseType",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(ht.Text,{children:_e.baseType}),s.jsx("div",{className:"monitoring-muted",children:_e.collateralType})]})},{title:"План переоценки",dataIndex:"plannedDate",key:"plannedDate",width:220,render:(je,_e)=>s.jsxs("div",{children:[s.jsx(Bf,{color:_e.statusColor}),s.jsx(ht.Text,{style:{marginLeft:8},children:_e.plannedDate}),s.jsxs("div",{className:"monitoring-muted",children:["Последняя: ",_e.lastRevaluationDate," · каждые ",_e.frequencyMonths," мес."]}),s.jsxs("div",{className:"monitoring-trend",children:[s.jsx(Vn,{}),_e.daysUntil<0?s.jsxs("span",{children:["Просрочен на ",Math.abs(_e.daysUntil)," дн."]}):s.jsxs("span",{children:["Через ",_e.daysUntil," дн."]})]})]})},{title:"Стоимость",dataIndex:"collateralValue",key:"collateralValue",width:180,render:(je,_e)=>s.jsxs("div",{children:[_e.collateralValue&&s.jsx("div",{children:s.jsxs(ht.Text,{children:["Залог: ",_e.collateralValue.toLocaleString("ru-RU")," ₽"]})}),_e.marketValue&&s.jsxs("div",{className:"monitoring-muted",children:["Рыночная: ",_e.marketValue.toLocaleString("ru-RU")," ₽"]})]})},{title:"Метод переоценки",dataIndex:"revaluationMethod",key:"revaluationMethod",width:200,render:je=>je?s.jsx(Ze,{color:"purple",children:je}):s.jsx("span",{children:"—"})},{title:"Ответственный",dataIndex:"owner",key:"owner",width:180,render:je=>s.jsx(ht.Text,{children:je})},{title:"Приоритет",dataIndex:"priority",key:"priority",width:160,render:je=>s.jsx("span",{children:je??"—"})}],[]),et=M.useCallback(()=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"monitoring-page__header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"monitoring-page__title",children:"План мониторинга Обеспечения"}),s.jsx(ht.Paragraph,{className:"monitoring-page__subtitle",children:"Формирование недельного, месячного и квартального графика выездов и документарных проверок по всем видам залогов."})]}),s.jsx(Kr,{title:"Поиск по сделке, клиенту, ИНН или ответственному",children:s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по сделкам и клиентам",prefix:s.jsx(Pa,{}),value:p,onChange:je=>u(je.target.value),style:{width:360}})})]}),s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Просрочено",value:ve.overdue,valueStyle:{color:"#f5222d"},prefix:s.jsx(Jp,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"7 дней",value:ve.week,valueStyle:{color:"#fa8c16"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"30 дней",value:ve.month,valueStyle:{color:"#52c41a"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"90 дней",value:ve.quarter,valueStyle:{color:"#1677ff"}})})})]}),s.jsx(Ue,{className:"monitoring-page__filters",children:s.jsxs(Te,{size:"middle",wrap:!0,children:[s.jsx(Ho.Group,{options:qE,value:d,onChange:je=>f(je.target.value),optionType:"button",buttonStyle:"solid"}),s.jsx(Ve,{allowClear:!0,placeholder:"Тип обеспечения",style:{minWidth:200},options:W,value:g??void 0,onChange:je=>h(je??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Метод мониторинга",style:{minWidth:200},options:Ae,value:x??void 0,onChange:je=>y(je??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Ответственный",style:{minWidth:200},options:ue,value:v??void 0,onChange:je=>E(je??null)})]})}),s.jsx(dt,{gutter:[16,16],children:s.jsx(be,{xs:24,children:s.jsxs(Ue,{bodyStyle:{padding:0},className:"monitoring-page__table-card",children:[s.jsx("div",{className:"monitoring-page__table-actions",children:s.jsx(Te,{children:s.jsx(Kr,{title:"Рекомендации по периодичности мониторинга",children:s.jsx("a",{onClick:()=>S(!0),children:"Рекомендации"})})})}),s.jsx(ir,{columns:we,dataSource:he,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:1200},loading:o,onRow:je=>({onDoubleClick:()=>{b(je),_(!0)},style:{cursor:"pointer"}}),locale:{emptyText:o?s.jsx(Sr,{description:"Загрузка..."}):s.jsx(Sr,{description:"Нет задач"})}})]})})}),c&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить план мониторинга",description:c,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),s.jsxs(cr,{title:"Рекомендации по периодичности мониторинга",open:k,onCancel:()=>S(!1),onOk:()=>S(!1),okText:"Понятно",cancelText:"Закрыть",children:[s.jsxs("ul",{className:"monitoring-guidelines",children:[s.jsx("li",{children:"Недвижимость — не реже 1 раза в 12 месяцев."}),s.jsx("li",{children:"Транспорт/оборудование без страхования — каждые 6 месяцев."}),s.jsx("li",{children:"Транспорт/оборудование со страхованием — каждые 12 месяцев."}),s.jsx("li",{children:"Товары и сырье — каждые 3 месяца (формальное обеспечение документарно)."}),s.jsx("li",{children:"Имущественные права — каждые 6 месяцев."}),s.jsx("li",{children:"Ценные бумаги и доли — ежегодно, документарно."})]}),s.jsx(ht.Paragraph,{className:"monitoring-muted",children:"При наличии решения УО/УЛ используется индивидуальный график. Документарные проверки включают ЕГРН, реестры залогов, выписки счетов депо и онлайн-проверку транспортных средств."})]}),s.jsx($z,{visible:O,entry:B,onClose:()=>{_(!1),b(null)}})]}),[p,ve,d,g,x,v,he,o,c,k,O,B,W,Ae,ue,we]),Ye=M.useCallback(()=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"monitoring-page__header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"monitoring-page__title",children:"План переоценок Обеспечения"}),s.jsx(ht.Paragraph,{className:"monitoring-page__subtitle",children:"Формирование графика переоценок залогового имущества для актуализации стоимости обеспечения."})]}),s.jsx(Kr,{title:"Поиск по сделке, клиенту, ИНН или ответственному",children:s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по сделкам и клиентам",prefix:s.jsx(Pa,{}),value:ee,onChange:je=>V(je.target.value),style:{width:360}})})]}),s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Просрочено",value:ce.overdue,valueStyle:{color:"#f5222d"},prefix:s.jsx(Jp,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"7 дней",value:ce.week,valueStyle:{color:"#fa8c16"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"30 дней",value:ce.month,valueStyle:{color:"#52c41a"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"90 дней",value:ce.quarter,valueStyle:{color:"#1677ff"}})})})]}),s.jsx(Ue,{className:"monitoring-page__filters",children:s.jsxs(Te,{size:"middle",wrap:!0,children:[s.jsx(Ho.Group,{options:qE,value:Q,onChange:je=>Y(je.target.value),optionType:"button",buttonStyle:"solid"}),s.jsx(Ve,{allowClear:!0,placeholder:"Тип обеспечения",style:{minWidth:200},options:se,value:G??void 0,onChange:je=>z(je??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Метод переоценки",style:{minWidth:200},options:He,value:C??void 0,onChange:je=>D(je??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Ответственный",style:{minWidth:200},options:Ee,value:j??void 0,onChange:je=>K(je??null)})]})}),s.jsx(dt,{gutter:[16,16],children:s.jsx(be,{xs:24,children:s.jsx(Ue,{bodyStyle:{padding:0},className:"monitoring-page__table-card",children:s.jsx(ir,{columns:Ge,dataSource:pe,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:1200},loading:R,locale:{emptyText:R?s.jsx(Sr,{description:"Загрузка..."}):s.jsx(Sr,{description:"Нет задач"})}})})})}),N&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить план переоценок",description:N,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})})]}),[ee,ce,Q,G,C,j,pe,R,N,se,He,Ee,Ge]);return s.jsxs("div",{className:"monitoring-page",children:[s.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end",gap:8},children:[s.jsx(Be,{type:r==="monitoring"?"primary":"default",icon:s.jsx(Ii,{}),size:"large",onClick:()=>a("monitoring"),style:r==="monitoring"?{}:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"#fff"},children:"План мониторинга Обеспечения"}),s.jsx(Be,{type:r==="revaluation"?"primary":"default",icon:s.jsx(Zl,{}),size:"large",onClick:()=>a("revaluation"),style:r==="revaluation"?{}:{backgroundColor:"#52c41a",borderColor:"#52c41a",color:"#fff"},children:"План переоценки Обеспечения"})]}),s.jsx(ri,{activeKey:r,onChange:a,items:[{key:"monitoring",label:s.jsxs("span",{children:[s.jsx(Jp,{}),"План мониторинга обеспечения"]}),children:et()},{key:"revaluation",label:s.jsxs("span",{children:[s.jsx(Zf,{}),"План переоценок Обеспечения"]}),children:Ye()},{key:"settings",label:s.jsxs("span",{children:[s.jsx(Kc,{}),"Настройка"]}),children:s.jsx(rV,{})}]})]})};function iV(e){const{portfolioData:t,creditOrgCode:r="000000000",creditOrgName:a="Кредитная организация",reportDate:n=new Date().toISOString().split("T")[0]}=e,i=oV(),o="urn:cbr-ru:rep0409310:v4.0.4.5";let l=`<?xml version="1.0" encoding="windows-1251"?>
`;l+=`<Ф0409310 xmlns="${o}"
`,l+=`	Идентификатор="${i}"
`,l+=`	ВерсияФормата="4.0.4.5"
`,l+=`	ДатаВерсииФормата="2025-04-24"
`,l+=`	Версия="4.0.4.5"
`,l+=`	Дата="${n}"
`,l+=`	Номер="1"
`,l+=`	ДатаВерсии="2025-04-24"
`,l+=`	ДатаВерсииФормата="2025-04-24T00:00:00">
`,l+=`	<КредитнаяОрганизация Наименование="${za(a)}" Код="${r}"/>
`,l+=`	<Раздел310 НП="1">
`;const c=t.slice(0,100);for(const A of c){const d=String(A.reference||A.contractNumber||"");if(!d)continue;l+=`		<Раздел1 Раздел1_1="${d}">
`,l+=`			<Подраздел1>
`,l+=`				<Раздел1_1 Раздел1.1_2="${d}"/>
`;const f=Tl(A.registrationDate||A.collateralContractDate);l+=`				<Раздел1.1 Раздел1.1_3="${f}" Раздел1.1_4="${za(String(A.collateralType||"-"))}"/>
`,A.collateralReference&&(l+=`				<Раздел1.2 Раздел1.2_2="${A.collateralReference}"/>
`),A.lastMonitoringDate&&A.lastMonitoringDate!=="-"&&(l+=`				<Раздел1.3 Раздел1.3_2="${Tl(A.lastMonitoringDate)}"/>
`),l+=`			</Подраздел1>
`,A.closeDate&&A.closeDate!=="-"&&(l+=`			<Раздел1.4 Раздел1.4_2="${Tl(A.closeDate)}"/>
`),l+=`		</Раздел1>
`;const p=Tl(A.contractDate);l+=`		<Раздел2
`,l+=`			Раздел2_1="${d}"
`,l+=`			Раздел2_2="${za(String(A.contractNumber||""))}"
`,l+=`			Раздел2_3="${sd(A.debtRub||0)}"
`,l+=`			Раздел2_4="${p}"
`,l+=`			Раздел2_5="${sd(A.overdueInterest||0)}"
`,l+=`			Раздел2_6="${p}"
`,l+=`			Раздел2_7="${sd(A.overduePrincipal||0)}"
`,l+=`			Раздел2_8="${p}"
`,l+=`			Раздел2_9="${sd(A.overdueInterest||0)}"
`,l+=`			Раздел2_10="${p}"
`,l+=`			Раздел2_11="${sd(A.limitRub||0)}"
`,l+=`			Раздел2_12="${p}"
`,l+=`			Раздел2_13="0.00"
`,l+=`			Раздел2_14="${p}"/>
`,l+=`		<Раздел3
`,l+=`			Раздел3_1="${d}"
`,l+=`			Раздел3_2="${za(String(A.collateralLocation||""))}"
`,l+=`			Раздел3_3="${za(String(A.collateralType||""))}"
`,l+=`			Раздел3_4="${za(String(A.collateralCategory||""))}"
`,l+=`			Раздел3_5="310310"
`,l+=`			Раздел3_6="${za(String(A.collateralInfo||""))}"
`,l+=`			Раздел3_7="${za(String(A.collateralPurpose||""))}"
`,l+=`			Раздел3_8="${za(String(A.qualityCategory||""))}"
`,l+=`			Раздел3_9="${za(String(A.liquidity||""))}"
`,l+=`			Раздел3_10="${za(String(A.collateralValue||0))}"
`,l+=`			Раздел3_11="${sd(A.marketValue||A.currentMarketValue||0)}"/>
`;const u=String(A.collateralType||"").toLowerCase();l+=`		<Раздел4 Раздел4_1="${d}">
`,u.includes("недвиж")||u.includes("зем")||u.includes("здание")?(l+=`			<Раздел4.1
`,l+=`				Раздел4.1_2="${za(String(A.collateralLocation||""))}"
`,l+=`				Раздел4.1_3="${Tl(A.registrationDate||A.collateralContractDate)}"
`,l+=`				Раздел4.1_4="${Tl(A.initialValuationDate)}"
`,l+=`				Раздел4.1_5="${String(A.collateralReference||"")}"
`,l+=`				Раздел4.1_6="${Tl(A.currentValuationDate)}"/>
`):(u.includes("транспорт")||u.includes("авто"))&&(l+=`			<Раздел4.3
`,l+=`				Раздел4.3_2="${Tl(A.registrationDate||A.collateralContractDate)}"
`,l+=`				Раздел4.3_3="${za(String(A.collateralInfo||""))}"
`,l+=`				Раздел4.3_4="${za(String(A.collateralLocation||""))}"
`,l+=`				Раздел4.3_5="2024"
`,l+=`				Раздел4.3_6="${za(String(A.collateralInfo||""))}"
`,l+=`				Раздел4.3_7="${za(String(A.collateralInfo||""))}"
`,l+=`				Раздел4.3_8="${za(String(A.collateralInfo||""))}"/>
`),l+=`		</Раздел4>
`;const g=A.pledger||A.borrower||"";g&&(l+=`		<Раздел5 Раздел5_1="${d}">
`,l+=`			<Раздел5.1
`,l+=`				Раздел5.1_2="${za(String(A.collateralLocation||""))}"
`,l+=`				Раздел5.1_3="${za(g)}"
`,l+=`				Раздел5.1_4="${za(g)}"
`,l+=`				Раздел5.1_5=""
`,l+=`				Раздел5.1_6=""
`,l+=`				Раздел5.1_7=""
`,l+=`				Раздел5.1_8="${String(A.inn||"")}"
`,l+=`				Раздел5.1_9=""/>
`,l+=`		</Раздел5>
`)}return l+=`	</Раздел310>
`,l+="</Ф0409310>",l}function za(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Tl(e){if(!e||e==="-")return new Date().toISOString().split("T")[0];try{const t=String(e).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.split(/[./-]/);if(r.length===3){const[a,n,i]=r;return a.length===4?`${a}-${n.padStart(2,"0")}-${i.padStart(2,"0")}`:`${i}-${n.padStart(2,"0")}-${a.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]}catch{return new Date().toISOString().split("T")[0]}}function sd(e,t=2){if(e==null)return"0.00";try{return(typeof e=="string"?parseFloat(e.replace(/\s/g,"").replace(",",".")):Number(e)).toFixed(t)}catch{return"0.00"}}function oV(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function lV(e,t){const r=new Blob([e],{type:"application/xml;charset=windows-1251"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}const cV=()=>{const[e,t]=M.useState([]),[r,a]=M.useState(!0),[n,i]=M.useState(null),[o,l]=M.useState(""),[c,A]=M.useState(null),[d,f]=M.useState(null),[p,u]=M.useState(null),[g,h]=M.useState(!1);M.useEffect(()=>{let _=!0;return(async()=>{a(!0),i(null);try{const I="/",R=new URL(I,window.location.origin),L=R.pathname.endsWith("/")?R.pathname:`${R.pathname}/`,N=`${R.origin}${L}reportsData.json?v=${Date.now()}`,P=await fetch(N,{cache:"no-store"});if(!P.ok)throw new Error(`Не удалось загрузить отчеты (${P.status})`);const Q=await P.json();if(!_)return;const Y=Q.reports||[];t(Y.map(ee=>({...ee,key:ee.id})))}catch(I){i(I instanceof Error?I.message:"Неизвестная ошибка")}finally{_&&a(!1)}})(),()=>{_=!1}},[]);const x=M.useMemo(()=>Array.from(new Set(e.map(U=>U.status))).map(U=>({value:U,label:U==="draft"?"Черновик":U==="submitted"?"Отправлен":U==="approved"?"Утвержден":"Отклонен"})),[e]),y=M.useMemo(()=>Array.from(new Set(e.map(U=>U.reportDate))).sort().reverse().map(U=>({value:U,label:U})),[e]),v=M.useMemo(()=>{const _=o.trim().toLowerCase();return e.filter(U=>{const I=!_||[U.reportNumber,U.guid,U.reportDate].filter(Boolean).some(N=>String(N).toLowerCase().includes(_)),R=!c||U.status===c,L=!d||U.reportDate===d;return I&&R&&L})},[e,o,c,d]),E=M.useMemo(()=>{const _=v.length,U=v.filter(L=>L.status==="draft").length,I=v.filter(L=>L.status==="submitted").length,R=v.filter(L=>L.status==="approved").length;return{total:_,draft:U,submitted:I,approved:R}},[v]),k=M.useMemo(()=>({draft:"default",submitted:"processing",approved:"success",rejected:"error"}),[]),S=M.useMemo(()=>({draft:"Черновик",submitted:"Отправлен",approved:"Утвержден",rejected:"Отклонен"}),[]),B=M.useMemo(()=>[{title:"Номер отчета",dataIndex:"reportNumber",key:"reportNumber",width:200,render:(_,U)=>s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:600},children:_}),s.jsxs("div",{className:"reports-muted",children:["GUID: ",U.guid.substring(0,8),"..."]})]})},{title:"Дата отчета",dataIndex:"reportDate",key:"reportDate",width:150,render:_=>s.jsxs(Te,{children:[s.jsx(Jp,{}),s.jsx("span",{children:_})]})},{title:"Статус",dataIndex:"status",key:"status",width:150,render:_=>s.jsx(Ze,{color:k[_]||"default",children:S[_]||_})},{title:"Разделы",key:"sections",width:200,render:(_,U)=>{const I=[];return U.section1&&I.push("1"),U.section2&&I.push("2"),U.section3&&I.push("3"),U.section4&&I.push("4"),U.section5&&I.push("5"),U.section6&&I.push("6"),s.jsx("span",{children:I.join(", ")||"—"})}},{title:"Обновлен",dataIndex:"updatedAt",key:"updatedAt",width:180,render:_=>new Date(_).toLocaleString("ru-RU")}],[k,S]),b=_=>{u(_),h(!0)},O=async()=>{try{Ne.loading({content:"Загрузка данных портфеля...",key:"generate-xml"});const _="/",U=new URL(_,window.location.origin),I=U.pathname.endsWith("/")?U.pathname:`${U.pathname}/`,R=`${U.origin}${I}portfolioData.json?v=${Date.now()}`,L=await fetch(R,{cache:"no-store"});if(!L.ok)throw new Error("Не удалось загрузить данные портфеля");const N=await L.json();Ne.loading({content:"Генерация XML отчета...",key:"generate-xml"});const P=iV({portfolioData:N,creditOrgCode:"000000000",creditOrgName:"Кредитная организация",reportDate:new Date().toISOString().split("T")[0]}),Q=`Ф310_${new Date().toISOString().split("T")[0].replace(/-/g,"")}_${Date.now()}.xml`;lV(P,Q),Ne.success({content:`XML отчет "${Q}" успешно сгенерирован и скачан`,key:"generate-xml",duration:4})}catch(_){Ne.error({content:_ instanceof Error?_.message:"Ошибка при генерации XML отчета",key:"generate-xml",duration:4})}};return s.jsxs("div",{className:"reports-page",children:[s.jsxs("div",{className:"reports-header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"reports-title",children:"Отчеты (Форма 310)"}),s.jsx(ht.Paragraph,{className:"reports-subtitle",children:"Отчетность по залоговому имуществу в соответствии с формой 310 ЦБ РФ"})]}),s.jsxs(Te,{size:"middle",direction:"vertical",children:[s.jsx(Kr,{title:"Поиск по номеру, GUID, дате",children:s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по отчетам",prefix:s.jsx(Pa,{}),value:o,onChange:_=>l(_.target.value),style:{width:360}})}),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),size:"large",onClick:O,children:"Сформировать XML отчет (Ф310)"})]})]}),s.jsx(Ue,{children:s.jsxs("div",{className:"reports-filters",children:[s.jsx(Ve,{allowClear:!0,placeholder:"Статус",style:{width:200},options:x,value:c??void 0,onChange:_=>A(_??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Дата отчета",style:{width:200},options:y,value:d??void 0,onChange:_=>f(_??null)})]})}),s.jsxs(dt,{gutter:[16,16],className:"reports-stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего отчетов",value:E.total,prefix:s.jsx(jr,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Черновики",value:E.draft,prefix:s.jsx(jr,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Отправлены",value:E.submitted,prefix:s.jsx(yn,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Утверждены",value:E.approved,prefix:s.jsx(yn,{})})})})]}),s.jsx(Ue,{className:"reports-table-card",bodyStyle:{padding:0},children:s.jsx(ir,{columns:B,dataSource:v,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:r,onRow:_=>({onDoubleClick:()=>b(_)}),locale:{emptyText:s.jsx(Sr,{description:"Нет отчетов, удовлетворяющих фильтрам",className:"reports-empty"})}})}),n&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить отчеты",description:n,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),s.jsx(cr,{title:`Отчет ${(p==null?void 0:p.reportNumber)||""}`,open:g,onCancel:()=>{h(!1),u(null)},footer:[s.jsx(Be,{type:"primary",onClick:()=>{h(!1),u(null)},children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:p&&s.jsxs("div",{className:"reports-modal",children:[s.jsxs(ye,{title:"Общая информация",bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Номер отчета",children:p.reportNumber}),s.jsx(ye.Item,{label:"GUID",children:p.guid}),s.jsx(ye.Item,{label:"Дата отчета",children:p.reportDate}),s.jsx(ye.Item,{label:"Статус",children:s.jsx(Ze,{color:k[p.status]||"default",children:S[p.status]||p.status})}),s.jsx(ye.Item,{label:"Создан",children:new Date(p.createdAt).toLocaleString("ru-RU")}),s.jsx(ye.Item,{label:"Обновлен",children:new Date(p.updatedAt).toLocaleString("ru-RU")})]}),p.section1&&p.section1.items.length>0&&s.jsxs("div",{style:{marginTop:24},children:[s.jsx(ht.Title,{level:4,children:"Раздел 1: Общие сведения"}),s.jsxs(ht.Text,{type:"secondary",children:["Записей: ",p.section1.items.length]})]}),p.section2&&p.section2.items.length>0&&s.jsxs("div",{style:{marginTop:24},children:[s.jsx(ht.Title,{level:4,children:"Раздел 2: Финансовые показатели"}),s.jsxs(ht.Text,{type:"secondary",children:["Записей: ",p.section2.items.length]})]}),p.section3&&p.section3.items.length>0&&s.jsxs("div",{style:{marginTop:24},children:[s.jsx(ht.Title,{level:4,children:"Раздел 3: Оценка обеспечения"}),s.jsxs(ht.Text,{type:"secondary",children:["Записей: ",p.section3.items.length]})]}),p.errors&&p.errors.length>0&&s.jsx("div",{style:{marginTop:24},children:s.jsx(Nr,{type:"warning",message:"Ошибки при обработке",description:s.jsx("ul",{children:p.errors.map((_,U)=>s.jsxs("li",{children:[s.jsxs("strong",{children:[_.field,":"]})," ",_.message]},U))})})})]})})]})},AV=()=>{const e=M.useRef(null),[t,r]=Ma.useState(!0);return M.useEffect(()=>{const a=e.current;if(!a)return;const n=()=>{r(!1)};a.addEventListener("load",n);const o="/zadachnik/index.html";return a.src=o,()=>{a.removeEventListener("load",n)}},[]),s.jsxs("div",{className:"tasks-page",children:[t&&s.jsx("div",{className:"tasks-loading",children:s.jsx(es,{size:"large",tip:"Загрузка системы задач..."})}),s.jsx("iframe",{ref:e,className:"tasks-iframe",title:"ЗАДАЧНИК - Система управления задачами",style:{display:t?"none":"block"}})]})},{TextArea:Du}=Re,{RangePicker:dV}=Dr,$p=[{value:"primary",label:"Первичный осмотр"},{value:"periodic",label:"Периодический осмотр"},{value:"unscheduled",label:"Внеплановый осмотр"},{value:"after_repair",label:"Осмотр после ремонта"},{value:"before_loan",label:"Осмотр перед выдачей кредита"},{value:"revaluation",label:"Осмотр при переоценке"},{value:"monitoring",label:"Осмотр при мониторинге"},{value:"appraisal",label:"Осмотр при оценке"}],N1=[{value:"scheduled",label:"Запланирован",color:"blue"},{value:"in_progress",label:"В процессе",color:"orange"},{value:"completed",label:"Завершен",color:"green"},{value:"cancelled",label:"Отменен",color:"red"}],uV=[{value:"excellent",label:"Отличное",color:"green"},{value:"good",label:"Хорошее",color:"blue"},{value:"satisfactory",label:"Удовлетворительное",color:"orange"},{value:"poor",label:"Плохое",color:"red"},{value:"critical",label:"Критическое",color:"red"}],fV=()=>{const[e,t]=M.useState([]),[r,a]=M.useState(!1),[n,i]=M.useState(!1),[o,l]=M.useState(!1),[c,A]=M.useState(null),[d,f]=M.useState(null),[p]=re.useForm(),[u,g]=M.useState("employee"),[h,x]=M.useState([]),[y,v]=M.useState({});M.useEffect(()=>{E()},[]);const E=async()=>{try{const N=await kt.getExtendedCards();x(N)}catch(N){console.error("Ошибка загрузки карточек:",N)}};M.useEffect(()=>{k(),Ba.initDatabase()},[]);const k=async()=>{a(!0);try{const N=await Ba.getInspections();t(N)}catch(N){console.error("Ошибка загрузки осмотров:",N),Ne.error("Не удалось загрузить осмотры")}finally{a(!1)}},S=()=>{f(null),g("employee"),p.resetFields(),p.setFieldsValue({inspectorType:"employee"}),i(!0)},B=N=>{console.log("Opening inspection modal for:",N.id),console.log("Current viewModalVisible before:",o),A(N.id),l(!0),console.log("Set viewModalVisible to true, viewingInspectionId:",N.id),setTimeout(()=>{console.log("After timeout - viewModalVisible should be true")},0)},b=N=>{f(N),p.setFieldsValue({...N,inspectionDate:N.inspectionDate?We(N.inspectionDate):void 0,inspectionMethod:N.inspectionMethod||"Визуальный осмотр",propertyPresence:N.propertyPresence||"Наличие имущества подтверждается",propertyCondition:N.propertyCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",storageConditions:N.storageConditions||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",conclusions:N.conclusions||void 0,proposals:N.proposals||"-"}),i(!0)},O=async N=>{try{await Ba.deleteInspection(N),Ne.success("Осмотр удален"),k()}catch(P){console.error("Ошибка удаления осмотра:",P),Ne.error("Не удалось удалить осмотр")}},_=async()=>{try{const N=await p.validateFields(),P=new Date,Q="Система",Y={...N,inspectionType:N.inspectionType,status:N.status||"scheduled",inspectionDate:N.inspectionDate?N.inspectionDate.toDate():P,inspectorType:N.inspectorType||"employee",inspectorName:N.inspectorName||"",inspectorId:N.inspectorId||void 0,inspectorPhone:N.inspectorPhone||void 0,inspectorEmail:N.inspectorEmail||void 0,clientPhone:N.clientPhone||void 0,clientEmail:N.clientEmail||void 0,collateralCardId:N.collateralCardId||"",collateralName:N.collateralName||"",address:N.address||void 0,condition:N.condition,inspectionMethod:N.inspectionMethod||"Визуальный осмотр",propertyPresence:N.propertyPresence||"Наличие имущества подтверждается",propertyCondition:N.propertyCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",storageConditions:N.storageConditions||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",conclusions:N.conclusions||void 0,proposals:N.proposals||"-",photos:(d==null?void 0:d.photos)||[],defects:(d==null?void 0:d.defects)||[],recommendations:(d==null?void 0:d.recommendations)||[],history:(d==null?void 0:d.history)||[{id:`hist-${Date.now()}`,date:P,action:"created",user:Q,userRole:"creator",comment:"Осмотр создан",status:N.status||"scheduled"}],createdByUser:(d==null?void 0:d.createdByUser)||Q};if(d)await Ba.updateInspection(d.id,Y),Ne.success("Осмотр обновлен");else{const ee=await Ba.createInspection(Y);if(N.inspectorType==="client"&&N.clientEmail){const V=await Ba.generateClientLink(ee);Ne.success(`Осмотр создан. Ссылка для клиента: ${V}`)}else Ne.success("Осмотр создан")}i(!1),p.resetFields(),g("employee"),k()}catch(N){console.error("Ошибка сохранения осмотра:",N),Ne.error("Не удалось сохранить осмотр")}},I=(()=>{let N=[...e];if(y.status&&(N=N.filter(P=>P.status===y.status)),y.type&&(N=N.filter(P=>P.inspectionType===y.type)),y.dateRange){const[P,Q]=y.dateRange;N=N.filter(Y=>{const ee=We(Y.inspectionDate);return ee.isAfter(P.subtract(1,"day"))&&ee.isBefore(Q.add(1,"day"))})}return N})(),R=Ma.useMemo(()=>{const N=e.length,P=e.reduce((Y,ee)=>(Y[ee.status]=(Y[ee.status]||0)+1,Y),{}),Q=e.reduce((Y,ee)=>(Y[ee.inspectionType]=(Y[ee.inspectionType]||0)+1,Y),{});return{total:N,byStatus:P,byType:Q}},[e]),L=[{title:"Дата осмотра",dataIndex:"inspectionDate",key:"inspectionDate",render:N=>We(N).format("DD.MM.YYYY HH:mm"),sorter:(N,P)=>We(N.inspectionDate).unix()-We(P.inspectionDate).unix()},{title:"Тип",dataIndex:"inspectionType",key:"inspectionType",render:N=>{const P=$p.find(Q=>Q.value===N);return(P==null?void 0:P.label)||N}},{title:"Инспектор",dataIndex:"inspectorName",key:"inspectorName"},{title:"Объект",dataIndex:"collateralName",key:"collateralName"},{title:"Статус",dataIndex:"status",key:"status",render:N=>{const P=N1.find(Q=>Q.value===N);return P?s.jsx(Ze,{color:P.color,children:P.label}):s.jsx(Ze,{children:N})}},{title:"Состояние",dataIndex:"condition",key:"condition",render:N=>{const P=uV.find(Q=>Q.value===N);return P?s.jsx(Ze,{color:P.color,children:P.label}):s.jsx(Ze,{children:N})}},{title:"Действия",key:"actions",render:(N,P)=>s.jsxs(Te,{children:[s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>B(P),size:"small",children:"Просмотр"}),s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),onClick:()=>b(P),size:"small",children:"Редактировать"}),s.jsx(po,{title:"Удалить осмотр?",onConfirm:()=>O(P.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),size:"small",children:"Удалить"})})]})}];return s.jsxs("div",{style:{padding:"24px"},children:[s.jsxs(Ue,{children:[s.jsxs(dt,{gutter:16,style:{marginBottom:24},children:[s.jsx(be,{span:6,children:s.jsx(pt,{title:"Всего осмотров",value:R.total})}),s.jsx(be,{span:6,children:s.jsx(pt,{title:"Завершено",value:R.byStatus.completed||0,valueStyle:{color:"#3f8600"}})}),s.jsx(be,{span:6,children:s.jsx(pt,{title:"В процессе",value:R.byStatus.in_progress||0,valueStyle:{color:"#cf1322"}})}),s.jsx(be,{span:6,children:s.jsx(pt,{title:"Запланировано",value:R.byStatus.scheduled||0})})]}),s.jsxs(Te,{style:{marginBottom:16,width:"100%",justifyContent:"space-between"},children:[s.jsxs(Te,{children:[s.jsx(Ve,{placeholder:"Фильтр по статусу",allowClear:!0,style:{width:200},onChange:N=>v({...y,status:N}),children:N1.map(N=>s.jsx(Ve.Option,{value:N.value,children:N.label},N.value))}),s.jsx(Ve,{placeholder:"Фильтр по типу",allowClear:!0,style:{width:200},onChange:N=>v({...y,type:N}),children:$p.map(N=>s.jsx(Ve.Option,{value:N.value,children:N.label},N.value))}),s.jsx(dV,{placeholder:["Дата начала","Дата окончания"],onChange:N=>v({...y,dateRange:N})})]}),s.jsxs(Te,{children:[s.jsx(Be,{icon:s.jsx(Zl,{}),onClick:k,children:"Обновить"}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:S,children:"Создать осмотр"})]})]}),s.jsx(ir,{columns:L,dataSource:I,rowKey:"id",loading:r,pagination:{pageSize:20},onRow:N=>({onDoubleClick:()=>{console.log("Double click on inspection:",N.id),B(N)},style:{cursor:"pointer"}})})]}),s.jsx(MC,{visible:o,inspectionId:c,onClose:()=>{console.log("Closing inspection modal"),l(!1),A(null)},onApprove:async N=>{await Ba.approveInspection(N,"Система"),Ne.success("Осмотр согласован"),k()},onRequestRevision:async(N,P)=>{await Ba.requestRevision(N,"Система",P),Ne.success("Запрошена доработка"),k()}}),s.jsx(cr,{title:d?"Редактировать осмотр":"Создать осмотр",open:n,onOk:_,onCancel:()=>{i(!1),p.resetFields()},width:600,children:s.jsxs(re,{form:p,layout:"vertical",children:[s.jsx(re.Item,{name:"inspectionType",label:"Тип осмотра",rules:[{required:!0,message:"Выберите тип осмотра"}],children:s.jsx(Ve,{placeholder:"Выберите тип осмотра",onChange:N=>{var Q;const P=((Q=$p.find(Y=>Y.value===N))==null?void 0:Q.label)||"";p.setFieldsValue({inspectionTypeLabel:P})},children:$p.map(N=>s.jsx(Ve.Option,{value:N.value,children:N.label},N.value))})}),s.jsx(re.Item,{name:"collateralCardId",label:"Объект залога",rules:[{required:!0,message:"Выберите объект залога"}],children:s.jsx(Ve,{placeholder:"Выберите объект залога",showSearch:!0,filterOption:(N,P)=>String((P==null?void 0:P.label)??"").toLowerCase().includes(N.toLowerCase()),onChange:N=>{var Q,Y,ee,V,G,z;const P=h.find(C=>C.id===N);if(P){const C=(Q=P.partners)==null?void 0:Q.find(ve=>ve.role==="pledgor"),D=(Y=P.partners)==null?void 0:Y.find(ve=>ve.role==="owner"),j=C?C.type==="legal"?C.organizationName||"":`${C.lastName||""} ${C.firstName||""} ${C.middleName||""}`.trim():"",K=D?D.type==="legal"?D.organizationName||"":`${D.lastName||""} ${D.firstName||""} ${D.middleName||""}`.trim():"",W=P.pledgeContractId||((ee=P.characteristics)==null?void 0:ee.pledgeContractNumber)||"",Ae=(V=P.characteristics)!=null&&V.pledgeContractDate?We(P.characteristics.pledgeContractDate).format("DD.MM.YYYY"):"",ue=P.loanContractId||((G=P.characteristics)==null?void 0:G.loanContractNumber)||"",he=(z=P.characteristics)!=null&&z.loanContractDate?We(P.characteristics.loanContractDate).format("DD.MM.YYYY"):"";p.setFieldsValue({collateralName:P.name,address:P.address?`${P.address.city||""} ${P.address.street||""} ${P.address.house||""}`.trim():void 0,pledgorName:j,borrowerName:K,pledgeContractNumber:W,pledgeContractDate:Ae,loanContractNumber:ue,loanContractDate:he})}},children:h.map(N=>s.jsxs(Ve.Option,{value:N.id,label:N.name,children:[N.name," (",N.number,")"]},N.id))})}),s.jsx(re.Item,{name:"collateralName",label:"Название объекта",rules:[{required:!0,message:"Введите название объекта"}],children:s.jsx(Re,{placeholder:"Название объекта залога"})}),s.jsx(re.Item,{name:"address",label:"Адрес",children:s.jsx(Re,{placeholder:"Адрес объекта"})}),s.jsx(re.Item,{name:"inspectionDate",label:"Дата осмотра",rules:[{required:!0,message:"Выберите дату осмотра"}],children:s.jsx(Dr,{showTime:!0,style:{width:"100%"},format:"DD.MM.YYYY HH:mm"})}),s.jsx(re.Item,{name:"inspectorType",label:"Исполнитель",rules:[{required:!0,message:"Выберите тип исполнителя"}],children:s.jsxs(Ve,{placeholder:"Выберите тип исполнителя",onChange:N=>{g(N),p.setFieldsValue({inspectorId:void 0,inspectorName:void 0,inspectorPhone:void 0,inspectorEmail:void 0,clientPhone:void 0,clientEmail:void 0})},children:[s.jsx(Ve.Option,{value:"employee",children:"Сотрудник банка"}),s.jsx(Ve.Option,{value:"client",children:"Клиент"})]})}),u==="employee"?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"inspectorId",label:"Сотрудник",rules:[{required:!0,message:"Выберите сотрудника"}],children:s.jsx(Ve,{placeholder:"Выберите сотрудника",showSearch:!0,filterOption:(N,P)=>String((P==null?void 0:P.label)??"").toLowerCase().includes(N.toLowerCase()),onChange:N=>{const P=pr.getEmployeeById(N);P&&p.setFieldsValue({inspectorName:`${P.lastName} ${P.firstName} ${P.middleName||""}`.trim(),inspectorPhone:P.phone,inspectorEmail:P.email})},children:pr.getEmployees().filter(N=>N.isActive).map(N=>s.jsxs(Ve.Option,{value:N.id,label:`${N.lastName} ${N.firstName} ${N.middleName||""}`.trim(),children:[`${N.lastName} ${N.firstName} ${N.middleName||""}`.trim()," - ",N.position]},N.id))})}),s.jsx(re.Item,{name:"inspectorName",label:"ФИО инспектора",hidden:!0,children:s.jsx(Re,{})}),s.jsx(re.Item,{name:"inspectorPhone",label:"Телефон",hidden:!0,children:s.jsx(Re,{})}),s.jsx(re.Item,{name:"inspectorEmail",label:"Email",hidden:!0,children:s.jsx(Re,{})})]}):s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"inspectorName",label:"ФИО клиента",rules:[{required:!0,message:"Введите ФИО клиента"}],children:s.jsx(Re,{placeholder:"ФИО клиента"})}),s.jsx(re.Item,{name:"clientPhone",label:"Телефон клиента",rules:[{required:!0,message:"Введите телефон клиента"}],children:s.jsx(Re,{placeholder:"+7 (___) ___-__-__"})}),s.jsx(re.Item,{name:"clientEmail",label:"Email клиента",rules:[{required:!0,message:"Введите email клиента"},{type:"email",message:"Введите корректный email"}],children:s.jsx(Re,{placeholder:"email@example.com"})})]}),s.jsx(re.Item,{name:"status",label:"Статус",initialValue:"scheduled",children:s.jsx(Ve,{placeholder:"Выберите статус",children:N1.map(N=>s.jsx(Ve.Option,{value:N.value,children:N.label},N.value))})}),s.jsx(jt,{orientation:"left",children:"Данные акта проверки наличия и состояния залога"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgorName",label:"Наименование Залогодателя",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"borrowerName",label:"Наименование Заемщика",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgeContractNumber",label:"Номер договора залога",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgeContractDate",label:"Дата договора залога",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"loanContractNumber",label:"Номер кредитного договора",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"loanContractDate",label:"Дата кредитного договора",children:s.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"inspectionMethod",label:"Способ проверки",initialValue:"Визуальный осмотр",rules:[{required:!0,message:"Укажите способ проверки"}],children:s.jsxs(Ve,{placeholder:"Выберите способ проверки",children:[s.jsx(Ve.Option,{value:"Визуальный осмотр",children:"Визуальный осмотр"}),s.jsx(Ve.Option,{value:"Инструментальный осмотр",children:"Инструментальный осмотр"}),s.jsx(Ve.Option,{value:"Экспертиза",children:"Экспертиза"})]})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"inspectionTypeLabel",label:"Тип осмотра",children:s.jsx(Re,{placeholder:"Автоматически из типа осмотра",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),s.jsx(re.Item,{name:"propertyPresence",label:"Наличие заложенного имущества",initialValue:"Наличие имущества подтверждается",rules:[{required:!0,message:"Укажите наличие имущества"}],children:s.jsxs(Ve,{placeholder:"Выберите вариант",children:[s.jsx(Ve.Option,{value:"Наличие имущества подтверждается",children:"Наличие имущества подтверждается"}),s.jsx(Ve.Option,{value:"Наличие имущества не подтверждается",children:"Наличие имущества не подтверждается"}),s.jsx(Ve.Option,{value:"Имущество частично отсутствует",children:"Имущество частично отсутствует"})]})}),s.jsx(re.Item,{name:"propertyCondition",label:"Состояние заложенного имущества",initialValue:"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",rules:[{required:!0,message:"Опишите состояние имущества"}],children:s.jsx(Du,{rows:3,placeholder:"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению"})}),s.jsx(re.Item,{name:"storageConditions",label:"Соответствие условий хранения/эксплуатации заложенного имущества",initialValue:"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",rules:[{required:!0,message:"Опишите условия хранения/эксплуатации"}],children:s.jsx(Du,{rows:3,placeholder:"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)"})}),s.jsx(re.Item,{name:"conclusions",label:"Выводы",rules:[{required:!0,message:"Укажите выводы"}],children:s.jsx(Du,{rows:3,placeholder:"Имущество соответствует требованиям для принятия в залог"})}),s.jsx(re.Item,{name:"proposals",label:"Предложения",initialValue:"-",children:s.jsx(Du,{rows:2,placeholder:"Предложения по улучшению состояния имущества или условий его хранения"})}),s.jsx(re.Item,{name:"notes",label:"Примечания",children:s.jsx(Du,{rows:4,placeholder:"Дополнительная информация"})})]})})]})},pV=()=>s.jsx(fV,{}),{Title:KE,Text:HE,Paragraph:hV}=ht,{Step:mV}=bb,F1=(e,t)=>e.includes("real_estate")?[{title:"Фасад",description:"Сфотографируйте фасад здания"},{title:"Вход",description:"Сфотографируйте вход в здание"},{title:"Внутри",description:"Сфотографируйте внутренние помещения"},{title:"Документы",description:"Сфотографируйте документы на объект"}]:e.includes("movable")?[{title:"Общий вид",description:"Сфотографируйте объект с разных сторон"},{title:"Серийный номер",description:"Сфотографируйте серийный номер или VIN"},{title:"Состояние",description:"Сфотографируйте повреждения или особенности"},{title:"Документы",description:"Сфотографируйте документы на объект"}]:[{title:"Общий вид",description:"Сфотографируйте объект"},{title:"Детали",description:"Сфотографируйте детали объекта"},{title:"Документы",description:"Сфотографируйте документы"}],gV=()=>{const{token:e}=ub(),t=$i(),[r,a]=M.useState(null),[n,i]=M.useState(!0),[o,l]=M.useState(0),[c,A]=M.useState(!1),[d,f]=M.useState(null),[p,u]=M.useState({}),[g,h]=M.useState(!1),x=M.useCallback(async()=>{var B;i(!0);try{const b=await Ba.getInspectionByToken(e);if(!b){Ne.error("Осмотр не найден или ссылка истекла"),t("/");return}a(b);const O=F1(b.inspectionType),_={};(B=b.photos)==null||B.forEach(U=>{const I=O.findIndex(R=>R.title===U.step||R.title===U.location);I>=0?(_[I]||(_[I]=[]),_[I].push(U)):(_[0]||(_[0]=[]),_[0].push(U))}),u(_)}catch(b){console.error("Ошибка загрузки осмотра:",b),Ne.error("Не удалось загрузить осмотр")}finally{i(!1)}},[e,t]);M.useEffect(()=>{e&&x()},[e,x]);const y=()=>{if(!navigator.geolocation){Ne.error("Геолокация не поддерживается вашим браузером");return}navigator.geolocation.getCurrentPosition(B=>{f({lat:B.coords.latitude,lon:B.coords.longitude,accuracy:B.coords.accuracy||0}),A(!0),Ne.success("Геолокация получена")},B=>{console.error("Ошибка геолокации:",B),Ne.error("Не удалось получить геолокацию")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},v=(B,b)=>{const O=new FileReader;O.onload=async _=>{var N;const U=(N=_.target)==null?void 0:N.result,R=F1((r==null?void 0:r.inspectionType)||"")[B],L={id:`photo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,url:U,description:R.description,location:R.title,step:R.title,takenAt:new Date,latitude:d==null?void 0:d.lat,longitude:d==null?void 0:d.lon,accuracy:d==null?void 0:d.accuracy};if(u(P=>({...P,[B]:[...P[B]||[],L]})),r)try{await Ba.addPhoto(r.id,L)}catch(P){console.error("Ошибка сохранения фото:",P)}},O.readAsDataURL(b)},E=async()=>{if(r){h(!0);try{await Ba.submitForReview(r.id,r.inspectorName),d&&await Ba.updateInspection(r.id,{latitude:d.lat,longitude:d.lon,geolocationConsent:!0}),Ne.success("Осмотр отправлен на проверку"),setTimeout(()=>{t("/")},2e3)}catch(B){console.error("Ошибка отправки осмотра:",B),Ne.error("Не удалось отправить осмотр")}finally{h(!1)}}};if(n)return s.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[s.jsx(es,{size:"large"}),s.jsx("div",{style:{marginTop:16},children:s.jsx(HE,{children:"Загрузка осмотра..."})})]});if(!r)return s.jsx("div",{style:{padding:"40px"},children:s.jsx(Nr,{message:"Осмотр не найден",description:"Ссылка недействительна или истекла",type:"error"})});const k=F1(r.inspectionType),S=p[o]||[];return s.jsx("div",{className:"mobile-inspection-page",children:s.jsx(Ue,{children:s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(KE,{level:4,children:"Осмотр объекта"}),s.jsx(HE,{type:"secondary",children:r.collateralName})]}),s.jsx(Nr,{message:"Согласие на геолокацию",description:"Для проведения осмотра необходимо предоставить доступ к геолокации",type:"info",action:s.jsx(ec,{checked:c,onChange:B=>{A(B.target.checked),B.target.checked&&y()},children:"Разрешить"})}),d&&s.jsx(Nr,{message:"Геолокация получена",description:`Координаты: ${d.lat.toFixed(6)}, ${d.lon.toFixed(6)}`,type:"success",icon:s.jsx(tl,{})}),s.jsx(bb,{current:o,direction:"vertical",size:"small",children:k.map((B,b)=>s.jsx(mV,{title:B.title,description:B.description,status:o===b?"process":p[b]&&p[b].length>0?"finish":"wait",icon:p[b]&&p[b].length>0?s.jsx(yn,{style:{color:"#52c41a"}}):void 0},b))}),s.jsx(Ue,{children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsx(KE,{level:5,children:k[o].title}),s.jsx(hV,{children:k[o].description}),s.jsx(Js,{accept:"image/*",capture:"environment",showUploadList:!1,beforeUpload:B=>(v(o,B),!1),children:s.jsx(Be,{type:"primary",icon:s.jsx(Ao,{}),size:"large",block:!0,children:"Сфотографировать"})}),S.length>0&&s.jsx(dt,{gutter:[8,8],children:S.map(B=>s.jsx(be,{xs:12,sm:8,md:6,children:s.jsx(im,{src:B.url,alt:B.description,style:{width:"100%",borderRadius:4},preview:!0})},B.id))})]})}),s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between"},children:[s.jsx(Be,{disabled:o===0,onClick:()=>l(o-1),children:"Назад"}),o<k.length-1?s.jsx(Be,{type:"primary",onClick:()=>l(o+1),children:"Далее"}):s.jsx(Be,{type:"primary",icon:s.jsx(_b,{}),onClick:E,loading:g,disabled:!c,children:"Отправить на проверку"})]})]})})})},{TextArea:xV}=Re,{Option:yV}=Ve,{Title:vV}=ht,wV=({collateralType:e})=>{const t=$y(e),r=a=>{var i;const n=a.required?[{required:!0,message:`Поле "${a.label}" обязательно для заполнения`}]:[];switch(a.type){case"text":return s.jsx(re.Item,{name:a.key,label:a.label,rules:n,children:s.jsx(Re,{placeholder:a.placeholder||a.label})},a.key);case"number":return s.jsx(re.Item,{name:a.key,label:a.label,rules:n,children:s.jsx(pa,{style:{width:"100%"},placeholder:a.placeholder||a.label,min:a.min,max:a.max,addonAfter:a.unit})},a.key);case"boolean":return s.jsx(re.Item,{name:a.key,label:a.label,valuePropName:"checked",children:s.jsx(ms,{})},a.key);case"select":return s.jsx(re.Item,{name:a.key,label:a.label,rules:n,children:s.jsx(Ve,{placeholder:a.placeholder||`Выберите ${a.label.toLowerCase()}`,allowClear:!0,children:(i=a.options)==null?void 0:i.map(o=>s.jsx(yV,{value:o,children:o},o))})},a.key);case"date":return s.jsx(re.Item,{name:a.key,label:a.label,rules:n,children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD",placeholder:a.placeholder||a.label})},a.key);case"textarea":return s.jsx(re.Item,{name:a.key,label:a.label,rules:n,children:s.jsx(xV,{rows:3,placeholder:a.placeholder||a.label})},a.key);default:return null}};return!e||Object.keys(t).length===0?s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Выберите тип имущества для отображения атрибутов"}):s.jsx("div",{children:Object.entries(t).map(([a,n])=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx(jt,{orientation:"left",children:s.jsx(vV,{level:5,style:{margin:0},children:a})}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:n.map(i=>r(i))})]},a))})},{TextArea:no}=Re,{Option:rr}=Ve,EV=({visible:e,onCancel:t,onSuccess:r})=>{const[a]=re.useForm(),[n,i]=M.useState(!1),[o,l]=M.useState([]),[c,A]=M.useState(null);M.useEffect(()=>{e&&(a.resetFields(),a.setFieldsValue({conclusionDate:We(),authorDate:We().format("YYYY-MM-DD"),status:"Черновик",conclusionType:"Первичное"}),d())},[e,a]);const d=async()=>{try{const u="/",g=new URL(u,window.location.origin),h=g.pathname.endsWith("/")?g.pathname:`${g.pathname}/`,x=`${g.origin}${h}portfolioData.json?v=${Date.now()}`,y=await fetch(x,{cache:"no-store"});if(y.ok){const v=await y.json();l(v)}}catch(u){console.error("Ошибка загрузки данных портфеля:",u)}},f=async()=>{try{const u=await a.validateFields();i(!0);const g=`ЗК-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,h={id:`conclusion-${Date.now()}`,conclusionNumber:g,conclusionDate:u.conclusionDate.format("YYYY-MM-DD"),reference:u.reference||null,contractNumber:u.contractNumber||null,pledger:u.pledger||null,pledgerInn:u.pledgerInn||null,borrower:u.borrower||null,borrowerInn:u.borrowerInn||null,creditProduct:u.creditProduct||null,creditAmount:u.creditAmount?parseFloat(u.creditAmount):null,creditTermMonths:u.creditTermMonths?parseInt(u.creditTermMonths):null,collateralType:u.collateralType||null,collateralName:u.collateralName||null,collateralPurpose:u.collateralPurpose||null,totalAreaSqm:u.totalAreaSqm?parseFloat(u.totalAreaSqm):null,totalAreaHectares:u.totalAreaHectares?parseFloat(u.totalAreaHectares):null,collateralLocation:u.collateralLocation||null,objectsCount:u.objectsCount?parseInt(u.objectsCount):null,ownershipShare:u.ownershipShare?parseFloat(u.ownershipShare):null,landCategory:u.landCategory||null,landPermittedUse:u.landPermittedUse||null,landCadastralNumber:u.landCadastralNumber||null,landAreaSqm:u.landAreaSqm?parseFloat(u.landAreaSqm):null,marketValue:u.marketValue?parseFloat(u.marketValue):null,collateralValue:u.collateralValue?parseFloat(u.collateralValue):null,fairValue:u.fairValue?parseFloat(u.fairValue):null,category:u.category||null,liquidity:u.liquidity||null,liquidityFairValue:u.liquidityFairValue||null,collateralDescription:u.collateralDescription||null,collateralCondition:u.collateralCondition||null,hasReplanning:u.hasReplanning!==void 0?u.hasReplanning:null,landFunctionalProvision:u.landFunctionalProvision||null,hasEncumbrances:u.hasEncumbrances!==void 0?u.hasEncumbrances:null,encumbrancesDescription:u.encumbrancesDescription||null,encumbrancesDetails:u.encumbrancesDetails||null,ownershipBasis:u.ownershipBasis||null,ownershipDocuments:u.ownershipDocuments||null,registrationRecord:u.registrationRecord||null,registrationDocument:u.registrationDocument||null,replanningDescription:u.replanningDescription||null,inspectionDate:u.inspectionDate?u.inspectionDate.format("YYYY-MM-DD"):null,inspectorName:u.inspectorName||null,bankruptcyCheckDate:u.bankruptcyCheckDate?u.bankruptcyCheckDate.format("YYYY-MM-DD"):null,bankruptcyCheckResult:u.bankruptcyCheckResult||null,specialOpinion:u.specialOpinion||null,creditContractNumber:u.creditContractNumber||null,cadastralValue:u.cadastralValue?parseFloat(u.cadastralValue):null,marketValuePerSqm:u.marketValuePerSqm?parseFloat(u.marketValuePerSqm):null,marketValuePerHectare:u.marketValuePerHectare?parseFloat(u.marketValuePerHectare):null,liquidityMovable:u.liquidityMovable||null,landAreaHectares:u.landAreaHectares?parseFloat(u.landAreaHectares):null,conclusionType:u.conclusionType,status:u.status,statusColor:u.status==="Согласовано"?"green":u.status==="На согласовании"?"blue":u.status==="Отклонено"||u.status==="Аннулировано"?"red":void 0,author:u.author||"Система",authorDate:u.authorDate||We().format("YYYY-MM-DD"),approver:u.approver||null,approvalDate:u.approvalDate?u.approvalDate.format("YYYY-MM-DD"):null,conclusionText:u.conclusionText||"",recommendations:u.recommendations||void 0,riskLevel:u.riskLevel||void 0,notes:u.notes||void 0},x="/",y=new URL(x,window.location.origin),v=y.pathname.endsWith("/")?y.pathname:`${y.pathname}/`,E=`${y.origin}${v}collateralConclusionsData.json?v=${Date.now()}`,k=await fetch(E,{cache:"no-store"});let S=[];k.ok&&(S=await k.json()),S.push(h),Ne.success(`Заключение "${g}" создано (в демо-версии данные не сохраняются)`),a.resetFields(),i(!1),r==null||r(),t()}catch(u){console.error("Ошибка создания заключения:",u),Ne.error("Ошибка при создании заключения"),i(!1)}},p=u=>{const g=o.find(h=>String(h.reference)===String(u));if(g){const h=g.collateralType||null;A(h),a.setFieldsValue({contractNumber:g.contractNumber||null,pledger:g.pledger||null,pledgerInn:g.inn||null,borrower:g.borrower||null,collateralType:h,collateralLocation:g.collateralLocation||null,collateralValue:g.collateralValue||null,marketValue:g.marketValue||g.currentMarketValue||null,fairValue:g.fairValue||null,category:g.qualityCategory||null,liquidity:g.liquidity||null})}};return s.jsx(cr,{title:"Создать залоговое заключение",open:e,onCancel:t,footer:[s.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),s.jsx(Be,{type:"primary",loading:n,onClick:f,children:"Создать"},"submit")],width:900,children:s.jsxs(re,{form:a,layout:"vertical",children:[s.jsx(re.Item,{name:"reference",label:"REFERENCE сделки",tooltip:"Выберите сделку из портфеля для автозаполнения данных",children:s.jsx(Ve,{placeholder:"Выберите REFERENCE",showSearch:!0,allowClear:!0,onChange:p,filterOption:(u,g)=>String((g==null?void 0:g.children)||"").toLowerCase().includes(u.toLowerCase()),children:o.map(u=>s.jsxs(rr,{value:u.reference,children:[u.reference," - ",u.borrower||u.pledger||"Не указано"]},u.reference))})}),s.jsx(re.Item,{name:"conclusionType",label:"Тип заключения",rules:[{required:!0}],children:s.jsxs(Ve,{children:[s.jsx(rr,{value:"Первичное",children:"Первичное"}),s.jsx(rr,{value:"Повторное",children:"Повторное"}),s.jsx(rr,{value:"Дополнительное",children:"Дополнительное"}),s.jsx(rr,{value:"Переоценка",children:"Переоценка"})]})}),s.jsx(re.Item,{name:"conclusionDate",label:"Дата заключения",rules:[{required:!0}],children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),s.jsx(re.Item,{name:"status",label:"Статус",rules:[{required:!0}],children:s.jsxs(Ve,{children:[s.jsx(rr,{value:"Черновик",children:"Черновик"}),s.jsx(rr,{value:"На согласовании",children:"На согласовании"}),s.jsx(rr,{value:"Согласовано",children:"Согласовано"}),s.jsx(rr,{value:"Отклонено",children:"Отклонено"}),s.jsx(rr,{value:"Аннулировано",children:"Аннулировано"})]})}),s.jsx(re.Item,{name:"contractNumber",label:"№ договора",children:s.jsx(Re,{placeholder:"Номер договора"})}),s.jsx(re.Item,{name:"pledger",label:"Залогодатель",children:s.jsx(Re,{placeholder:"Залогодатель"})}),s.jsx(re.Item,{name:"pledgerInn",label:"ИНН залогодателя",children:s.jsx(Re,{placeholder:"ИНН"})}),s.jsx(re.Item,{name:"borrower",label:"Заемщик",children:s.jsx(Re,{placeholder:"Заемщик"})}),s.jsx(re.Item,{name:"collateralType",label:"Тип залога",children:s.jsxs(Ve,{placeholder:"Выберите тип залога",allowClear:!0,onChange:u=>A(u||null),showSearch:!0,filterOption:(u,g)=>String((g==null?void 0:g.children)||"").toLowerCase().includes(u.toLowerCase()),children:[s.jsx(rr,{value:"Недвижимость",children:"Недвижимость"}),s.jsx(rr,{value:"Транспортные средства",children:"Транспортные средства"}),s.jsx(rr,{value:"Оборудование",children:"Оборудование"}),s.jsx(rr,{value:"Товары в обороте",children:"Товары в обороте"}),s.jsx(rr,{value:"Ценные бумаги",children:"Ценные бумаги"}),s.jsx(rr,{value:"Права требования",children:"Права требования"}),s.jsx(rr,{value:"apartment",children:"Квартира"}),s.jsx(rr,{value:"house",children:"Жилой дом"}),s.jsx(rr,{value:"office",children:"Офис"}),s.jsx(rr,{value:"retail",children:"Торговое помещение"}),s.jsx(rr,{value:"warehouse",children:"Склад"}),s.jsx(rr,{value:"gas_station",children:"АЗС"}),s.jsx(rr,{value:"car_passenger",children:"Легковой автомобиль"}),s.jsx(rr,{value:"car_truck",children:"Грузовой автомобиль"}),s.jsx(rr,{value:"equipment",children:"Оборудование"}),s.jsx(rr,{value:"machinery",children:"Техника"})]})}),s.jsx(re.Item,{name:"collateralPurpose",label:"Назначение обеспечения",children:s.jsx(Re,{placeholder:"Назначение обеспечения"})}),s.jsx(wV,{collateralType:c,form:a}),s.jsx(re.Item,{name:"landCategory",label:"Категория земель",children:s.jsx(Re,{placeholder:"Категория земель"})}),s.jsx(re.Item,{name:"landPermittedUse",label:"Разрешенный вид использования",children:s.jsx(Re,{placeholder:"Разрешенный вид использования"})}),s.jsx(re.Item,{name:"landAreaSqm",label:"Площадь земельного участка, кв.м.",children:s.jsx(Re,{type:"number",placeholder:"Площадь земельного участка"})}),s.jsx(re.Item,{name:"landAreaHectares",label:"Площадь земельного участка, га",children:s.jsx(Re,{type:"number",step:"0.01",placeholder:"Площадь в гектарах"})}),s.jsx(re.Item,{name:"collateralDescription",label:"Описание имущества",children:s.jsx(no,{rows:4,placeholder:"Состояние и краткое описание имущества"})}),s.jsx(re.Item,{name:"collateralCondition",label:"Состояние имущества",children:s.jsxs(Ve,{placeholder:"Выберите состояние",children:[s.jsx(rr,{value:"хорошее",children:"Хорошее"}),s.jsx(rr,{value:"удовлетворительное",children:"Удовлетворительное"}),s.jsx(rr,{value:"неудовлетворительное",children:"Неудовлетворительное"})]})}),s.jsx(re.Item,{name:"hasReplanning",label:"Наличие перепланировок",children:s.jsxs(Ve,{placeholder:"Выберите",children:[s.jsx(rr,{value:!0,children:"Да"}),s.jsx(rr,{value:!1,children:"Нет"})]})}),s.jsx(re.Item,{name:"replanningDescription",label:"Выявленные перепланировки",children:s.jsx(no,{rows:3,placeholder:"Описание перепланировок"})}),s.jsx(re.Item,{name:"hasEncumbrances",label:"Наличие обременений",children:s.jsxs(Ve,{placeholder:"Выберите",children:[s.jsx(rr,{value:!0,children:"Да"}),s.jsx(rr,{value:!1,children:"Нет"})]})}),s.jsx(re.Item,{name:"encumbrancesDescription",label:"Описание обременений",children:s.jsx(no,{rows:3,placeholder:"Описание обременений"})}),s.jsx(re.Item,{name:"encumbrancesDetails",label:"Выявленные обременения",children:s.jsx(no,{rows:3,placeholder:"Детальное описание выявленных обременений"})}),s.jsx(re.Item,{name:"ownershipBasis",label:"Право, на основании которого объект принадлежит Залогодателю",children:s.jsx(Re,{placeholder:"Право собственности, аренды и т.д."})}),s.jsx(re.Item,{name:"ownershipDocuments",label:"Документы-основания возникновения права собственности",children:s.jsx(no,{rows:3,placeholder:"Описание документов"})}),s.jsx(re.Item,{name:"registrationRecord",label:"Запись регистрации в ЕГРН (дата, №)",children:s.jsx(Re,{placeholder:"Запись регистрации"})}),s.jsx(re.Item,{name:"registrationDocument",label:"Правоподтверждающий документ",children:s.jsx(no,{rows:2,placeholder:"Выписка из ЕГРН и т.д."})}),s.jsx(re.Item,{name:"inspectionDate",label:"Дата осмотра / проверки",children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),s.jsx(re.Item,{name:"inspectorName",label:"Сотрудник ПР, проводивший проверку",children:s.jsx(Re,{placeholder:"ФИО сотрудника"})}),s.jsx(re.Item,{name:"bankruptcyCheckDate",label:"Дата проверки на банкротство",children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),s.jsx(re.Item,{name:"bankruptcyCheckResult",label:"Результат проверки на банкротство",children:s.jsx(Re,{placeholder:"Результат проверки"})}),s.jsx(re.Item,{name:"category",label:"Категория обеспечения",children:s.jsxs(Ve,{placeholder:"Выберите категорию",children:[s.jsx(rr,{value:"Формальное",children:"Формальное"}),s.jsx(rr,{value:"Достаточное",children:"Достаточное"}),s.jsx(rr,{value:"Недостаточное",children:"Недостаточное"})]})}),s.jsx(re.Item,{name:"liquidity",label:"Ликвидность",children:s.jsxs(Ve,{placeholder:"Выберите ликвидность",children:[s.jsx(rr,{value:"высокая (срок реализации до 90 дней)",children:"Высокая (срок реализации до 90 дней)"}),s.jsx(rr,{value:"удовлетворительная (срок реализации до 365 дней)",children:"Удовлетворительная (срок реализации до 365 дней)"}),s.jsx(rr,{value:"низкая (срок реализации свыше 365 дней)",children:"Низкая (срок реализации свыше 365 дней)"}),s.jsx(rr,{value:"малоудовлетворительная",children:"Малоудовлетворительная"})]})}),s.jsx(re.Item,{name:"riskLevel",label:"Уровень риска",children:s.jsxs(Ve,{placeholder:"Выберите уровень риска",children:[s.jsx(rr,{value:"Низкий",children:"Низкий"}),s.jsx(rr,{value:"Средний",children:"Средний"}),s.jsx(rr,{value:"Высокий",children:"Высокий"}),s.jsx(rr,{value:"Критический",children:"Критический"})]})}),s.jsx(re.Item,{name:"collateralValue",label:"Оценочная стоимость, руб.",children:s.jsx(Re,{type:"number",placeholder:"Оценочная стоимость"})}),s.jsx(re.Item,{name:"marketValue",label:"Рыночная стоимость, руб.",children:s.jsx(Re,{type:"number",placeholder:"Рыночная стоимость"})}),s.jsx(re.Item,{name:"fairValue",label:"Справедливая стоимость, руб.",children:s.jsx(Re,{type:"number",placeholder:"Справедливая стоимость"})}),s.jsx(re.Item,{name:"cadastralValue",label:"Кадастровая стоимость, руб.",children:s.jsx(Re,{type:"number",placeholder:"Кадастровая стоимость"})}),s.jsx(re.Item,{name:"marketValuePerSqm",label:"Рыночная стоимость, руб./кв.м.",children:s.jsx(Re,{type:"number",placeholder:"Стоимость за кв.м."})}),s.jsx(re.Item,{name:"marketValuePerHectare",label:"Рыночная стоимость, руб./сот.",children:s.jsx(Re,{type:"number",placeholder:"Стоимость за сотку"})}),s.jsx(re.Item,{name:"conclusionText",label:"Текст заключения",rules:[{required:!0}],children:s.jsx(no,{rows:6,placeholder:"Введите текст заключения"})}),s.jsx(re.Item,{name:"recommendations",label:"Рекомендации",children:s.jsx(no,{rows:4,placeholder:"Введите рекомендации"})}),s.jsx(re.Item,{name:"specialOpinion",label:"Особое мнение",children:s.jsx(no,{rows:6,placeholder:"Введите особое мнение"})}),s.jsx(re.Item,{name:"notes",label:"Примечания",children:s.jsx(no,{rows:3,placeholder:"Введите примечания"})}),s.jsx(re.Item,{name:"author",label:"Автор",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Автор заключения"})}),s.jsx(re.Item,{name:"authorDate",label:"Дата создания",children:s.jsx(Re,{disabled:!0})}),s.jsx(re.Item,{name:"approver",label:"Согласующий",children:s.jsx(Re,{placeholder:"Согласующий"})}),s.jsx(re.Item,{name:"approvalDate",label:"Дата согласования",children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})})]})})},E2=[{id:"risk_001",code:"001",name:"Внезапное изменение состава, структуры и количества предмета залога",category:"collateral"},{id:"risk_002",code:"002",name:"Нарушение условий хранения, эксплуатации или содержания имущества, угрожающее утратой или повреждением имущества",category:"collateral"},{id:"risk_003",code:"003",name:"Ухудшение качества или повреждение заложенного имущества, а также по другим причинам, повлекшим изменение его ликвидности",category:"collateral"},{id:"risk_004",code:"004",name:"Перемещение залогового обеспечения по адресу (адресам), не указанным в договоре залога, за исключениям имущества, перемещение которого является типичным условием его эксплуатации",category:"collateral"},{id:"risk_005",code:"005",name:"Появление любой существенной негативной информации о Заемщике/Залогодателе",category:"borrower"},{id:"risk_006",code:"006",name:"Отклонение фактических показателей деятельности Залогодателя (либо выручки, либо EBITDA, либо чистой прибыли, либо объема поступивших денежных средств по договорам аренды) в одном квартальном периоде более чем на 20% от запланированных",category:"financial"},{id:"risk_007",code:"007",name:"Выбытие основного(ых) контрагента(ов) Залогодателя, генерирующего(их) более 25% от общего потока арендных платежей",category:"financial"},{id:"risk_008",code:"008",name:"Изменение в составе собственников и / или руководстве Залогодателя, которые могут негативно повлиять на бизнес Залогодателя",category:"borrower"},{id:"risk_009",code:"009",name:"Наличие серьезных разногласий и конфронтации между акционерами / участниками Залогодателя",category:"borrower"},{id:"risk_010",code:"010",name:"Снижение в течение квартала пассажиропотока/ погрузки и/или пассажирооборота/ грузооборота Залогодателя более чем на 20% по сравнению с прошлым сопоставимым периодом",category:"transport"},{id:"risk_011",code:"011",name:"Введение ограничений на эксплуатацию транспортных средств, используемых Залогодателем, которые могут повлечь за собой снижение пассажиропотока / погрузки более чем на 20%",category:"transport"},{id:"risk_012",code:"012",name:"Снижение рейтинга Заемщика более чем на 3 пункта с момента его предыдущего пересмотра, в случае если новый рейтинг Заемщика 20 и ниже",category:"rating"},{id:"risk_013",code:"013",name:"Любое снижение рейтинга Заемщика с момента его предыдущего пересмотра, в случае если новый рейтинг Заемщика 23-26",category:"rating"},{id:"risk_014",code:"014",name:"Наличие негативных тенденций отрасли Заемщика/Залогодателя, отраженных в рейтинговой модели/отраслевых стратегиях Банка",category:"industry"},{id:"risk_015",code:"015",name:"Снижение поступления объемов выручки Заемщика более чем на 20% по сравнению с предшествующим месяцем",category:"financial"},{id:"risk_016",code:"016",name:"Снижение величины основных средств в представленной Залогодателем бухгалтерской (финансовой) отчетности более чем на 20% по сравнению с предшествующим кварталом",category:"financial"},{id:"risk_017",code:"017",name:"Проведение в отношении Заемщика/Залогодателя процедур, предусмотренных законодательством о несостоятельности (банкротстве)",category:"legal"}],{Paragraph:id,Text:R1}=ht,bV=({conclusion:e,onEdit:t,onPrint:r,onExport:a})=>{const n=$i(),i=Ma.useCallback(A=>{try{const d=localStorage.getItem("creditRiskRecords"),f=d?JSON.parse(d):[],p={id:`risk-${Date.now()}`,reference:e.reference||"",contractNumber:e.contractNumber||void 0,pledger:e.pledger||"",pledgerInn:e.pledgerInn||void 0,borrower:e.borrower||void 0,borrowerInn:e.borrowerInn||void 0,riskEvent:E2[0],suspensiveConditionId:A.id,suspensiveConditionDescription:A.description,insuranceRelated:!1,status:"active",eventDate:We().format("YYYY-MM-DD"),detectionDate:We().format("YYYY-MM-DD"),priority:"medium",documents:[],createdAt:We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")};f.push(p),localStorage.setItem("creditRiskRecords",JSON.stringify(f)),Ne.success("Отлагательное условие добавлено в модуль ФКР"),setTimeout(()=>{n("/credit-risk")},500)}catch(d){console.error("Ошибка добавления в ФКР:",d),Ne.error("Ошибка добавления в модуль ФКР")}},[e,n]),o=Ma.useMemo(()=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),[]),l=Ma.useCallback(A=>A?o.format(A):"—",[o]),c=M.useMemo(()=>{const A=[];A.push({key:"conclusion",label:"Залоговое заключение",children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsxs(ye,{bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"№ заключения",span:1,children:s.jsx(R1,{strong:!0,children:e.conclusionNumber})}),s.jsx(ye.Item,{label:"Дата",span:1,children:e.conclusionDate}),s.jsx(ye.Item,{label:"Тип",span:1,children:e.conclusionType}),s.jsx(ye.Item,{label:"Статус",span:1,children:s.jsx(Ze,{color:e.status==="Согласовано"?"green":e.status==="На согласовании"?"blue":e.status==="Отклонено"||e.status==="Аннулировано"?"red":"default",children:e.status})}),s.jsx(ye.Item,{label:"REFERENCE",span:1,children:s.jsx(R1,{copyable:!0,children:e.reference||"—"})}),s.jsx(ye.Item,{label:"№ договора",span:1,children:e.contractNumber||"—"}),s.jsx(ye.Item,{label:"Заемщик",span:2,children:e.borrower||"—"}),s.jsx(ye.Item,{label:"ИНН заемщика",span:1,children:e.borrowerInn||"—"}),s.jsx(ye.Item,{label:"Залогодатель",span:2,children:e.pledger||"—"}),s.jsx(ye.Item,{label:"ИНН залогодателя",span:1,children:e.pledgerInn||"—"})]}),e.creditProduct&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:"Кредитный продукт"}),s.jsxs(ye,{bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"Продукт",children:e.creditProduct}),s.jsx(ye.Item,{label:"Сумма, руб.",children:l(e.creditAmount)}),s.jsx(ye.Item,{label:"Срок, мес.",children:e.creditTermMonths||"—"}),e.creditContractNumber&&s.jsx(ye.Item,{label:"№ Кредитного договора",span:3,children:e.creditContractNumber})]})]}),s.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:"Согласование"}),s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Автор",children:e.author}),s.jsx(ye.Item,{label:"Дата создания",children:e.authorDate}),e.approver&&s.jsx(ye.Item,{label:"Согласующий",children:e.approver}),e.approvalDate&&s.jsx(ye.Item,{label:"Дата согласования",children:e.approvalDate}),e.inspectionDate&&s.jsx(ye.Item,{label:"Дата осмотра",children:e.inspectionDate}),e.inspectorName&&s.jsx(ye.Item,{label:"Проводивший осмотр",children:e.inspectorName})]})]})});const d=e.collateralType,p=(y=>{if(!y)return;const v=y.toLowerCase();if(v.includes("недвижимость")||v.includes("нежилая")){if(e.collateralName){const E=e.collateralName.toLowerCase();if(E.includes("офис")||E.includes("офисное"))return"office";if(E.includes("торгов")||E.includes("магазин"))return"retail";if(E.includes("склад"))return"warehouse";if(E.includes("гостиниц")||E.includes("отель"))return"hotel";if(E.includes("кафе")||E.includes("ресторан"))return"catering";if(E.includes("азс")||E.includes("заправк"))return"gas_station";if(E.includes("автосалон"))return"car_dealership";if(E.includes("производств")||E.includes("цех"))return"industrial_building"}return"office"}if(v.includes("транспорт")||v.includes("авто"))return"car_passenger";if(v.includes("спецтехник")||v.includes("техник"))return"machinery";if(v.includes("оборудован"))return"equipment"})(d),u=$y(p||d||void 0),g={collateralName:e.collateralName,collateralLocation:e.collateralLocation,totalAreaSqm:e.totalAreaSqm,totalAreaHectares:e.totalAreaHectares,landCategory:e.landCategory,landPermittedUse:e.landPermittedUse,landCadastralNumber:e.landCadastralNumber,ownershipShare:e.ownershipShare,marketValue:e.marketValue,collateralValue:e.collateralValue,fairValue:e.fairValue,category:e.category,collateralCondition:e.collateralCondition,hasEncumbrances:e.hasEncumbrances,ownershipBasis:e.ownershipBasis,...e.additionalData||{}};Object.keys(g).forEach(y=>{(g[y]===null||g[y]===void 0||g[y]==="")&&delete g[y]});const h=Object.keys(g).length>0,x=(y,v)=>v==null||v===""?"—":y.type==="boolean"?v?"Да":"Нет":y.type==="number"&&y.unit?`${v} ${y.unit}`:(y.type==="number",String(v));if(A.push({key:"characteristics",label:"Характеристики",children:(()=>{const y=Object.keys(u);return y.length===0||!h?s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Характеристики не указаны"}):s.jsx(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:y.map(v=>{const E=u[v],k=[];return E.forEach(S=>{const B=zz(g,S.key);B!=null&&B!==""&&k.push({label:S.label,children:x(S,B)})}),k.length===0?null:s.jsxs("div",{children:[s.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:v}),s.jsx(ye,{bordered:!0,column:2,size:"small",items:k})]},v)})})})()}),e.suspensiveConditions&&e.suspensiveConditions.length>0?A.push({key:"suspensive",label:"отлагательные",children:s.jsx(ir,{dataSource:e.suspensiveConditions,rowKey:"id",pagination:!1,size:"small",columns:[{title:"№",dataIndex:"number",width:60,align:"center"},{title:"Перечень отлагательных и дополнительных условий",dataIndex:"description",key:"description"},{title:"Отлагательные условия",dataIndex:"suspensiveCondition",width:150,align:"center",render:y=>y==="+"?s.jsx(Ze,{color:"green",children:"+"}):s.jsx(Ze,{color:"red",children:"-"})},{title:"Доп. условия",dataIndex:"additionalCondition",width:150,align:"center",render:y=>y?s.jsx(Ze,{color:"blue",children:"+"}):s.jsx(Ze,{color:"default",children:"-"})},{title:"Действия",key:"actions",width:150,align:"center",render:(y,v)=>s.jsx(Be,{type:"link",icon:s.jsx(ys,{}),onClick:()=>i(v),size:"small",children:"Добавить в модуль ФКР"})}]})}):A.push({key:"suspensive",label:"отлагательные",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет отлагательных условий"})}),e.detailedDescriptions&&e.detailedDescriptions.length>0){const y=e.detailedDescriptions[0],v=Object.keys(y).filter(E=>E!=="id"&&y[E]!==null&&y[E]!==void 0).slice(0,10).map(E=>({title:E,dataIndex:E,key:E,width:150,ellipsis:!0,render:k=>k==null?"—":typeof k=="object"?JSON.stringify(k).slice(0,50):String(k).slice(0,50)}));A.push({key:"detailed",label:"Описание",children:s.jsx(ir,{dataSource:e.detailedDescriptions,rowKey:"id",columns:v,pagination:!1,scroll:{x:"max-content"},size:"small"})})}else A.push({key:"detailed",label:"Описание",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет описания объектов"})});if(e.photos&&e.photos.length>0?A.push({key:"photos",label:"Фото",children:s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:e.photos.map(y=>s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx(im,{src:y.url,alt:y.description||"Фото",width:200,height:150,style:{objectFit:"cover",borderRadius:"4px"},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}),y.description&&s.jsx(R1,{type:"secondary",style:{display:"block",marginTop:"8px"},children:y.description})]},y.id))})}):A.push({key:"photos",label:"Фото",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет фотографий"})}),e.calculations&&e.calculations.length>0){const y=[];e.calculations.forEach(v=>{v.data&&v.data.analogs&&Array.isArray(v.data.analogs)&&v.data.analogs.forEach((E,k)=>{y.push({id:`analog-${v.id}-${k}`,number:E.number||k+1,address:E.address||"—",description:E.description||"—",price:E.price||"—",area:E.area||"—",type:v.type})})}),y.length>0?A.push({key:"analogs",label:"Аналоги",children:s.jsx(ir,{dataSource:y,rowKey:"id",pagination:!1,size:"small",columns:[{title:"№",dataIndex:"number",width:60,align:"center"},{title:"Адрес",dataIndex:"address",key:"address"},{title:"Краткое описание",dataIndex:"description",key:"description"},{title:"Цена предложения, руб.",dataIndex:"price",key:"price",align:"right",render:v=>typeof v=="number"?l(v):v},{title:"Площадь, кв.м.",dataIndex:"area",key:"area",align:"right"},{title:"Тип расчета",dataIndex:"type",key:"type"}]})}):A.push({key:"analogs",label:"Аналоги",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет данных об аналогах"})})}else A.push({key:"analogs",label:"Аналоги",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет данных об аналогах"})});if(e.calculations&&e.calculations.length>0){const y=e.calculations.map(v=>({key:v.id,label:v.type,children:s.jsx(ye,{bordered:!0,column:2,size:"small",children:Object.entries(v.data).map(([E,k])=>s.jsx(ye.Item,{label:E,children:typeof k=="object"?s.jsx("pre",{style:{margin:0,fontSize:"12px"},children:JSON.stringify(k,null,2)}):String(k)},E))})}));A.push({key:"calculations",label:"расчеты",children:s.jsx(ri,{items:y,size:"small"})})}else A.push({key:"calculations",label:"расчеты",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет расчетов"})});return e.review?A.push({key:"review",label:"Рецензия",children:s.jsxs(ye,{bordered:!0,column:1,size:"small",children:[e.review.reviewer&&s.jsx(ye.Item,{label:"Рецензент",children:e.review.reviewer}),e.review.reviewerPosition&&s.jsx(ye.Item,{label:"Должность",children:e.review.reviewerPosition}),e.review.reviewDate&&s.jsx(ye.Item,{label:"Дата рецензии",children:e.review.reviewDate}),e.review.reviewText&&s.jsx(ye.Item,{label:"Текст рецензии",children:s.jsx(id,{style:{margin:0},children:e.review.reviewText})}),e.review.conclusion&&s.jsx(ye.Item,{label:"Заключение",children:s.jsx(Ze,{color:"green",children:e.review.conclusion})}),e.review.compliance&&s.jsx(ye.Item,{label:"Соответствие требованиям",children:s.jsx(id,{style:{margin:0},children:e.review.compliance})})]})}):A.push({key:"review",label:"Рецензия",children:s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Рецензия не проведена"})}),A.push({key:"contract",label:"для договора",children:s.jsx(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:s.jsxs(ye,{bordered:!0,column:1,size:"small",children:[s.jsx(ye.Item,{label:"Приложение к договору залога",children:s.jsx(id,{children:"Настоящее заключение является приложением к договору залога и содержит полную информацию о предмете залога, его оценке и условиях принятия в залог."})}),e.conclusionNumber&&s.jsx(ye.Item,{label:"Номер заключения",children:e.conclusionNumber}),e.conclusionDate&&s.jsx(ye.Item,{label:"Дата заключения",children:e.conclusionDate}),e.contractNumber&&s.jsx(ye.Item,{label:"Номер договора залога",children:e.contractNumber}),e.collateralType&&s.jsx(ye.Item,{label:"Тип залога",children:e.collateralType}),e.marketValue&&s.jsx(ye.Item,{label:"Рыночная стоимость",children:l(e.marketValue)}),e.collateralValue&&s.jsx(ye.Item,{label:"Залоговая стоимость",children:l(e.collateralValue)}),e.specialOpinion&&s.jsx(ye.Item,{label:"Особое мнение",children:s.jsx(id,{style:{margin:0},children:e.specialOpinion})}),e.recommendations&&s.jsx(ye.Item,{label:"Рекомендации",children:s.jsx(id,{style:{margin:0},children:e.recommendations})}),e.conclusionText&&s.jsx(ye.Item,{label:"Текст заключения",children:s.jsx(id,{style:{margin:0},children:e.conclusionText})})]})})}),A},[e,l,i]);return s.jsxs("div",{style:{padding:"8px 0"},children:[s.jsxs("div",{style:{marginBottom:"16px",display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t&&s.jsx(Be,{icon:s.jsx(Rs,{}),onClick:t,children:"Редактировать"}),r&&s.jsx(Be,{icon:s.jsx(YT,{}),onClick:r,children:"Печать"}),a&&s.jsx(Be,{icon:s.jsx(In,{}),onClick:a,children:"Экспорт"}),s.jsx(Be,{icon:s.jsx(jr,{}),onClick:()=>window.print(),children:"PDF"})]}),s.jsx(ri,{items:c,defaultActiveKey:"conclusion",size:"small",type:"card",style:{minHeight:"400px"}})]})},GE="cms_appraisal_reviews";class _V{getReviews(){const t=localStorage.getItem(GE);return t?JSON.parse(t):[]}saveReviews(t){localStorage.setItem(GE,JSON.stringify(t))}getAll(){return this.getReviews()}getById(t){return this.getReviews().find(r=>r.id===t)}create(t){const r=this.getReviews(),a={...t,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveReviews(r),a}update(t,r){const a=this.getReviews(),n=a.findIndex(o=>o.id===t);if(n===-1)return;const i={...a[n],...r,updatedAt:new Date().toISOString()};return a[n]=i,this.saveReviews(a),i}delete(t){const r=this.getReviews().filter(a=>a.id!==t);this.saveReviews(r)}initializeDemoData(){if(this.getReviews().length===0){const t=[{id:crypto.randomUUID(),status:"approved",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),appraiserName:'ООО "Вектор Оценки"',hasRecommendation:!0,reportName:"Отчет об оценке №123/2025",reportNumber:"123/2025",appraisalDate:"2025-11-15",appraisalPurpose:"Залог",valueType:"Рыночная стоимость",marketValueWithVat:15e6,objectDescription:"Нежилое помещение, 150 кв.м., г. Москва, ул. Ленина 1",compliance135FZ:"compliant",complianceNote:"Нарушений не выявлено",comparativeMethodologyValid:"Выбор метода сравнения продаж обоснован",comparativeErrors:"Ошибок нет",comparativeConclusion:"Стоимость определена корректно",costMethodologyValid:"Отказ от использования обоснован",costErrors:"-",costConclusion:"-",incomeMethodologyValid:"Метод прямой капитализации применен верно",incomeErrors:"Ставка капитализации в пределах рынка",incomeConclusion:"Результат достоверен",reconciliationWeightsJustification:"Веса: Сравнительный 60%, Доходный 40%",marketValueCorrectness:"Рыночная стоимость определена корректно",marketCorrespondence:!0,reviewDate:"2025-11-20",reviewerName:"Иванов И.И.",reviewerPosition:"Главный эксперт"}];this.saveReviews(t)}}}const od=new _V,{TextArea:ld}=Re,CV=({initialValues:e,onSubmit:t,onCancel:r,loading:a})=>{const[n]=re.useForm(),[i,o]=M.useState([]);M.useEffect(()=>{e?(n.setFieldsValue({...e,appraisalDate:e.appraisalDate?We(e.appraisalDate):null,reviewDate:e.reviewDate?We(e.reviewDate):null}),e.reportDocumentId&&e.reportDocumentName?o([{uid:e.reportDocumentId,name:e.reportDocumentName,status:"done"}]):o([])):(n.resetFields(),o([]),n.setFieldsValue({valueType:"Рыночная стоимость",marketCorrespondence:!0,compliance135FZ:"compliant"}))},[e,n]);const l=async A=>{let d=(e==null?void 0:e.reportDocumentId)||null,f=(e==null?void 0:e.reportDocumentName)||null;if(i.length>0&&i[0].originFileObj){const u=i[0].originFileObj;try{const g=await new Promise((y,v)=>{const E=new FileReader;E.onloadend=()=>{const k=E.result;y(k)},E.onerror=v,E.readAsDataURL(u)}),h=crypto.randomUUID(),x={id:h,name:u.name,type:u.type,size:u.size,data:g,uploadedAt:new Date().toISOString()};localStorage.setItem(`appraisal_report_${h}`,JSON.stringify(x)),d=h,f=u.name}catch{Ne.error("Ошибка при загрузке файла");return}}else i.length===0&&(e!=null&&e.reportDocumentId)&&(d=null,f=null);const p={...A,appraisalDate:A.appraisalDate?A.appraisalDate.toISOString():null,reviewDate:A.reviewDate?A.reviewDate.toISOString():null,reportDocumentId:d,reportDocumentName:f};t(p)},c={beforeUpload:A=>{const d=A.type==="application/pdf"||A.name.endsWith(".pdf"),f=A.type.includes("wordprocessingml")||A.name.endsWith(".doc")||A.name.endsWith(".docx");return!d&&!f?(Ne.error("Можно загружать только PDF или DOC/DOCX файлы!"),Js.LIST_IGNORE):A.size/1024/1024<10?!1:(Ne.error("Файл должен быть меньше 10MB!"),Js.LIST_IGNORE)},fileList:i,onChange:({fileList:A})=>{o(A)},onRemove:()=>{o([]),n.setFieldsValue({reportDocumentId:null,reportDocumentName:null})},maxCount:1};return s.jsxs(re,{form:n,layout:"vertical",onFinish:l,disabled:a,children:[s.jsxs(Ue,{title:"Общие сведения",size:"small",style:{marginBottom:16},children:[(e==null?void 0:e.id)&&s.jsx(dt,{gutter:16,style:{marginBottom:16},children:s.jsx(be,{span:24,children:s.jsx(re.Item,{label:"ID рецензии",children:s.jsx(Re,{value:e.id,disabled:!0,style:{fontFamily:"monospace"}})})})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"appraiserName",label:"Наименование оценщика",rules:[{required:!0}],children:s.jsx(Re,{})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"hasRecommendation",label:"Наличие рекомендации",valuePropName:"checked",children:s.jsx(ec,{children:"Рекомендован банком"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"reportName",label:"Наименование отчета",rules:[{required:!0}],children:s.jsx(Re,{})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"reportNumber",label:"Номер отчета",rules:[{required:!0}],children:s.jsx(Re,{})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"appraisalDate",label:"Дата оценки",rules:[{required:!0}],children:s.jsx(Dr,{style:{width:"100%"}})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"appraisalPurpose",label:"Цель оценки",children:s.jsx(Re,{})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"valueType",label:"Вид стоимости",children:s.jsx(Re,{})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"marketValueWithVat",label:"Итоговая рыночная стоимость (с НДС)",children:s.jsx(pa,{style:{width:"100%"},formatter:A=>`${A}`.replace(/\B(?=(\d{3})+(?!\d))/g," "),parser:A=>A.replace(/\s?|(,*)/g,"")})})})]}),s.jsx(re.Item,{name:"objectDescription",label:"Описание оцениваемого объекта",children:s.jsx(ld,{rows:3})}),s.jsxs(re.Item,{label:"Отчет об оценке (файл)",children:[s.jsx(Js,{...c,children:s.jsx(Be,{icon:s.jsx(Ns,{}),children:"Загрузить отчет"})}),s.jsx("div",{style:{marginTop:8,fontSize:12,color:"#888"},children:"Поддерживаются файлы PDF, DOC, DOCX (макс. 10MB)"}),i.length>0&&i[0].status==="done"&&s.jsxs("div",{style:{marginTop:8},children:[s.jsx(kl,{})," ",i[0].name]})]})]}),s.jsx(Ue,{title:"Требования к оформлению отчета",size:"small",style:{marginBottom:16},children:s.jsx(ir,{size:"small",pagination:!1,dataSource:[{key:"1",requirement:"Отчет об оценке соответствует требованиям Федерального закона от 29.07.98 г. №135-ФЗ «Об оценочной деятельности в Российской Федерации» (со всеми изменениями на дату оценки), Федеральным стандартам оценки",compliance:"compliance135FZ",note:"complianceNote"}],columns:[{title:"Требования к оформлению отчета",dataIndex:"requirement",key:"requirement",width:"50%"},{title:"Соответствие требованиям",dataIndex:"compliance",key:"compliance",width:"25%",render:A=>s.jsx(re.Item,{name:A,noStyle:!0,children:s.jsxs(Ve,{placeholder:"Выберите",children:[s.jsx(Ve.Option,{value:"compliant",children:"Соответствует"}),s.jsx(Ve.Option,{value:"not_compliant",children:"Не соответствует"}),s.jsx(Ve.Option,{value:"partial",children:"Соответствует частично"})]})})},{title:"Примечание",dataIndex:"note",key:"note",width:"25%",render:A=>s.jsx(re.Item,{name:A,noStyle:!0,children:s.jsx(Re,{placeholder:"Примечание"})})}]})}),s.jsx(Ue,{title:"Расчет стоимости объекта оценки",size:"small",style:{marginBottom:16},children:s.jsx(ir,{size:"small",pagination:!1,dataSource:[{key:"comparative",approach:"Сравнительный подход",methodology:"comparativeMethodologyValid",errors:"comparativeErrors",conclusion:"comparativeConclusion"},{key:"cost",approach:"Затратный подход",methodology:"costMethodologyValid",errors:"costErrors",conclusion:"costConclusion"},{key:"income",approach:"Доходный подход",methodology:"incomeMethodologyValid",errors:"incomeErrors",conclusion:"incomeConclusion"}],columns:[{title:"Подход",dataIndex:"approach",key:"approach",width:"20%"},{title:"Правильность и обоснованность выбора метода в рамках подхода/Корректность обоснования отказа от использования подхода",dataIndex:"methodology",key:"methodology",width:"30%",render:A=>s.jsx(re.Item,{name:A,noStyle:!0,children:s.jsx(ld,{rows:2,placeholder:"Комментарии"})})},{title:"Наличие ошибок в расчетах, корректность подобранных аналогов, обоснованность принятых корректировок, прочие нарушения",dataIndex:"errors",key:"errors",width:"30%",render:A=>s.jsx(re.Item,{name:A,noStyle:!0,children:s.jsx(ld,{rows:2,placeholder:"Комментарии"})})},{title:"Выводы в рамках подхода",dataIndex:"conclusion",key:"conclusion",width:"20%",render:A=>s.jsx(re.Item,{name:A,noStyle:!0,children:s.jsx(ld,{rows:2,placeholder:"Выводы"})})}]})}),s.jsx(Ue,{title:"Согласование результатов",size:"small",style:{marginBottom:16},children:s.jsx(re.Item,{name:"reconciliationWeightsJustification",label:"Обоснование выбора использованных весов, присвоенных каждому из подходов",children:s.jsx(ld,{rows:3,placeholder:"Опишите обоснование выбора весов для каждого подхода"})})}),s.jsxs(Ue,{title:"Вывод о корректности определения рыночной стоимости",size:"small",style:{marginBottom:16},children:[s.jsx(re.Item,{name:"marketValueCorrectness",label:"Вывод о корректности определения рыночной стоимости",children:s.jsx(ld,{rows:3,placeholder:"Сформулируйте вывод о корректности определения рыночной стоимости"})}),s.jsx(re.Item,{name:"marketCorrespondence",label:"Стоимость соответствует рынку",valuePropName:"checked",children:s.jsx(ec,{children:"Да, стоимость соответствует рынку"})})]}),s.jsx(Ue,{title:"Подпись",size:"small",style:{marginBottom:16},children:s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"reviewDate",label:"Дата рецензии",children:s.jsx(Dr,{style:{width:"100%"}})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"reviewerName",label:"ФИО сотрудника",children:s.jsx(Re,{})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"reviewerPosition",label:"Должность",children:s.jsx(Re,{})})})]})}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[s.jsx(Be,{onClick:r,children:"Отмена"}),s.jsx(Be,{type:"primary",htmlType:"submit",loading:a,children:"Сохранить"})]})]})},BV=()=>{const[e,t]=M.useState([]),[r,a]=M.useState(!1),[n,i]=M.useState(null),[o,l]=M.useState(!1),[c,A]=M.useState(""),[d,f]=M.useState(null);M.useEffect(()=>{p()},[]);const p=()=>{od.initializeDemoData(),t(od.getAll())},u=()=>{i(null),a(!0)},g=S=>{i(S),a(!0)},h=S=>{cr.confirm({title:"Удалить рецензию?",content:"Это действие нельзя отменить",onOk:()=>{od.delete(S),Ne.success("Рецензия удалена"),p()}})},x=(S,B)=>{od.update(S,{status:B});const b={draft:"Черновик",pending:"На согласовании",approved:"Согласовано",rejected:"Отклонено"};Ne.success(`Статус изменен на "${b[B]}"`),p()},y=M.useMemo(()=>{const S=c.trim().toLowerCase();return e.filter(B=>{const b=!S||[B.appraiserName,B.reportName,B.reportNumber,B.objectDescription].filter(Boolean).some(_=>String(_).toLowerCase().includes(S)),O=!d||B.status===d;return b&&O})},[e,c,d]),v=M.useMemo(()=>{const S=y.length,B=y.filter(U=>U.status==="draft").length,b=y.filter(U=>U.status==="approved").length,O=y.filter(U=>U.status==="pending").length,_=y.filter(U=>U.status==="rejected").length;return{total:S,draft:B,approved:b,pending:O,rejected:_}},[y]),E=S=>{l(!0);try{n?(od.update(n.id,S),Ne.success("Рецензия обновлена")):(od.create({...S,status:"draft"}),Ne.success("Рецензия создана")),a(!1),p()}catch{Ne.error("Ошибка при сохранении")}finally{l(!1)}},k=[{title:"ID",dataIndex:"id",key:"id",width:100,render:S=>s.jsxs("span",{style:{fontFamily:"monospace",fontSize:"12px"},children:[S.substring(0,8),"..."]})},{title:"Дата оценки",dataIndex:"appraisalDate",key:"appraisalDate",render:S=>S?We(S).format("DD.MM.YYYY"):"-"},{title:"Оценщик",dataIndex:"appraiserName",key:"appraiserName"},{title:"Отчет",key:"report",render:(S,B)=>s.jsxs("div",{children:[s.jsx("div",{children:B.reportName}),s.jsx("small",{style:{color:"#888"},children:B.reportNumber}),B.reportDocumentName&&s.jsxs("div",{style:{marginTop:4},children:[s.jsx(kl,{style:{color:"#1890ff"}})," ",s.jsx("span",{style:{fontSize:"12px",color:"#1890ff"},children:B.reportDocumentName})]})]})},{title:"Объект",dataIndex:"objectDescription",key:"objectDescription",ellipsis:!0},{title:"Стоимость",dataIndex:"marketValueWithVat",key:"marketValueWithVat",render:S=>S?`${S.toLocaleString("ru-RU")} ₽`:"-"},{title:"Статус",dataIndex:"status",key:"status",render:S=>{const B={draft:"default",pending:"processing",approved:"success",rejected:"error"},b={draft:"Черновик",pending:"На согласовании",approved:"Согласовано",rejected:"Отклонено"};return s.jsx(Ze,{color:B[S],children:b[S]})}},{title:"Действия",key:"actions",width:200,render:(S,B)=>s.jsxs(Te,{children:[s.jsx(Be,{icon:s.jsx(Ii,{}),size:"small",onClick:()=>g(B),title:"Просмотр"}),B.status==="draft"&&s.jsx(Be,{icon:s.jsx(Rs,{}),size:"small",onClick:()=>g(B),title:"Редактировать"}),B.status==="draft"&&s.jsx(Be,{icon:s.jsx(Nv,{}),size:"small",type:"primary",ghost:!0,title:"Отправить на согласование",onClick:()=>x(B.id,"pending")}),B.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(Be,{icon:s.jsx(Nv,{}),size:"small",type:"primary",title:"Согласовать",onClick:()=>x(B.id,"approved")}),s.jsx(Be,{icon:s.jsx(vb,{}),size:"small",danger:!0,title:"Отклонить",onClick:()=>x(B.id,"rejected")})]}),B.status!=="approved"&&s.jsx(Be,{icon:s.jsx(Oi,{}),size:"small",danger:!0,onClick:()=>h(B.id),title:"Удалить"})]})}];return s.jsxs("div",{className:"appraisal-reviews-list",children:[s.jsxs("div",{style:{marginBottom:16},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[s.jsx("h2",{style:{margin:0},children:"Реестр рецензий на отчеты об оценке"}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:u,children:"Создать рецензию"})]}),s.jsxs(Te,{size:"middle",style:{width:"100%",marginBottom:16},children:[s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по оценщику, отчету, объекту...",prefix:s.jsx(Pa,{}),value:c,onChange:S=>A(S.target.value),style:{width:400}}),s.jsx(Ve,{allowClear:!0,placeholder:"Статус",style:{width:200},value:d??void 0,onChange:S=>f(S??null),options:[{label:"Черновик",value:"draft"},{label:"На согласовании",value:"pending"},{label:"Согласовано",value:"approved"},{label:"Отклонено",value:"rejected"}]})]})]}),s.jsx(Ue,{style:{marginBottom:16},children:s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Всего рецензий",value:v.total})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Черновики",value:v.draft})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"На согласовании",value:v.pending})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Согласовано",value:v.approved})})]})}),s.jsx(Ue,{bodyStyle:{padding:0},children:s.jsx(ir,{columns:k,dataSource:y,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1200}})}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx("span",{children:n?"Редактирование рецензии":"Создание рецензии"}),n&&s.jsx(Ze,{color:n.status==="approved"?"green":n.status==="pending"?"blue":n.status==="rejected"?"red":"default",children:n.status==="draft"?"Черновик":n.status==="pending"?"На согласовании":n.status==="approved"?"Согласовано":"Отклонено"})]}),open:r,onCancel:()=>a(!1),footer:null,width:"95%",style:{top:10},styles:{body:{maxHeight:"85vh",overflowY:"auto",padding:"16px"}},destroyOnClose:!0,children:s.jsx(CV,{initialValues:n||{},onSubmit:E,onCancel:()=>a(!1),loading:o})})]})},SV=()=>{const e=$i(),[t,r]=M.useState([]),[a,n]=M.useState(!0),[i,o]=M.useState(null),[l,c]=M.useState(""),[A,d]=M.useState(null),[f,p]=M.useState(null),[u,g]=M.useState(null),[h,x]=M.useState(!1),[y,v]=M.useState(!1);M.useEffect(()=>{let U=!0;return(async()=>{n(!0),o(null);try{const R="/",L=new URL(R,window.location.origin),N=L.pathname.endsWith("/")?L.pathname:`${L.pathname}/`,P=`${L.origin}${N}collateralConclusionsData.json?v=${Date.now()}`,Q=await fetch(P,{cache:"no-store"});if(!Q.ok)throw new Error(`Не удалось загрузить данные заключений (${Q.status})`);const Y=await Q.json();if(!U)return;r(Y.map((ee,V)=>({...ee,key:ee.id||`conclusion-${V}`})))}catch(R){o(R instanceof Error?R.message:"Неизвестная ошибка"),r([])}finally{U&&n(!1)}})(),()=>{U=!1}},[]);const E=M.useMemo(()=>{const U=l.trim().toLowerCase();return t.filter(I=>{const R=!U||[I.conclusionNumber,I.reference,I.contractNumber,I.pledger,I.borrower,I.collateralType].filter(Boolean).some(P=>String(P).toLowerCase().includes(U)),L=!A||I.status===A,N=!f||I.conclusionType===f;return R&&L&&N})},[t,l,A,f]),k=M.useMemo(()=>{const U=E.length,I=E.filter(N=>N.status==="Черновик").length,R=E.filter(N=>N.status==="Согласовано").length,L=E.filter(N=>N.status==="На согласовании").length;return{total:U,draft:I,approved:R,pending:L}},[E]),S=U=>{g(U),x(!0)},B=Ma.useCallback((U,I)=>{U?e(`/collateral-dossier?ref=${U}`):I?e(`/collateral-dossier?q=${encodeURIComponent(I)}`):Ne.warning("Не указан REFERENCE или Залогодатель для перехода к досье")},[e]),b=Ma.useCallback((U,I)=>{I?e(`/portfolio?q=${encodeURIComponent(I)}`):U?e(`/portfolio?q=${encodeURIComponent(U)}`):Ne.warning("Не указан Залогодатель или REFERENCE для перехода к портфелю")},[e]),O=M.useMemo(()=>[{title:"№ заключения",dataIndex:"conclusionNumber",key:"conclusionNumber",width:150,render:(U,I)=>s.jsx(Be,{type:"link",onClick:()=>S(I),children:U})},{title:"Дата",dataIndex:"conclusionDate",key:"conclusionDate",width:120},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:150,render:U=>U?s.jsx(ht.Text,{code:!0,children:U}):"—"},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200,render:(U,I)=>s.jsx(Kr,{title:"Перейти к портфелю",children:s.jsx(Be,{type:"link",icon:s.jsx(ti,{}),onClick:()=>b(I.pledger,I.reference),children:U||"—"})})},{title:"Тип залога",dataIndex:"collateralType",key:"collateralType",width:180},{title:"Тип заключения",dataIndex:"conclusionType",key:"conclusionType",width:150},{title:"Статус",dataIndex:"status",key:"status",width:150,render:U=>{const I=U==="Согласовано"?"green":U==="На согласовании"?"blue":U==="Отклонено"||U==="Аннулировано"?"red":"default";return s.jsx(Ze,{color:I,children:U})}},{title:"Автор",dataIndex:"author",key:"author",width:150},{title:"Действия",key:"actions",width:120,render:(U,I)=>s.jsxs(Te,{children:[s.jsx(Kr,{title:"Просмотр",children:s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>S(I)})}),s.jsx(Kr,{title:"Залоговое досье",children:s.jsx(Be,{type:"link",icon:s.jsx(z1,{}),onClick:()=>B(I.reference,I.pledger)})})]})}],[B,b]),_=()=>{window.location.reload()};return s.jsx("div",{className:"collateral-conclusions-page",children:s.jsx(ri,{defaultActiveKey:"conclusions",items:[{key:"conclusions",label:"Залоговые заключения",children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"conclusions-header",children:[s.jsxs("div",{children:[s.jsx(ht.Title,{level:2,className:"conclusions-title",children:"Залоговые заключения"}),s.jsx(ht.Paragraph,{className:"conclusions-subtitle",children:"Реестр залоговых заключений по сделкам"})]}),s.jsxs(Te,{size:"middle",children:[s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по номеру, REFERENCE, залогодателю...",prefix:s.jsx(Pa,{}),value:l,onChange:U=>c(U.target.value),style:{width:400}}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),size:"large",onClick:()=>v(!0),children:"Создать заключение"})]})]}),s.jsx(Ue,{children:s.jsxs("div",{className:"conclusions-filters",children:[s.jsx(Ve,{allowClear:!0,placeholder:"Статус",style:{width:200},options:[{label:"Черновик",value:"Черновик"},{label:"На согласовании",value:"На согласовании"},{label:"Согласовано",value:"Согласовано"},{label:"Отклонено",value:"Отклонено"},{label:"Аннулировано",value:"Аннулировано"}],value:A??void 0,onChange:U=>d(U??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Тип заключения",style:{width:200},options:[{label:"Первичное",value:"Первичное"},{label:"Повторное",value:"Повторное"},{label:"Дополнительное",value:"Дополнительное"},{label:"Переоценка",value:"Переоценка"}],value:f??void 0,onChange:U=>p(U??null)})]})}),s.jsxs(dt,{gutter:[16,16],className:"conclusions-stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего заключений",value:k.total,prefix:s.jsx(jr,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Черновики",value:k.draft})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"На согласовании",value:k.pending})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Согласовано",value:k.approved})})})]}),s.jsx(Ue,{className:"conclusions-table-card",bodyStyle:{padding:0},children:s.jsx(ir,{columns:O,dataSource:E,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},loading:a,onRow:U=>({onDoubleClick:()=>S(U)}),locale:{emptyText:s.jsx(Sr,{description:"Нет заключений, удовлетворяющих фильтрам",className:"conclusions-empty"})}})}),i&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные заключений",description:i,action:s.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(jr,{}),s.jsxs("span",{children:["Залоговое заключение ",u==null?void 0:u.conclusionNumber]}),u&&s.jsx(Ze,{color:u.status==="Согласовано"?"green":u.status==="На согласовании"?"blue":u.status==="Отклонено"||u.status==="Аннулировано"?"red":"default",children:u.status})]}),open:h,onCancel:()=>x(!1),footer:[s.jsx(Be,{icon:s.jsx(z1,{}),onClick:()=>{u&&B(u.reference,u.pledger)},children:"Залоговое досье"},"dossier"),s.jsx(Be,{icon:s.jsx(ti,{}),onClick:()=>{u&&b(u.pledger,u.reference)},children:"Залогодатель"},"pledger"),s.jsx(Be,{type:"primary",onClick:()=>x(!1),children:"Закрыть"},"close")],width:"95%",style:{top:10},styles:{body:{maxHeight:"80vh",overflowY:"auto",padding:"16px"}},children:u&&s.jsx(bV,{conclusion:u,onEdit:()=>{Ne.info("Редактирование в разработке")},onPrint:()=>{window.print()},onExport:()=>{Ne.info("Экспорт в разработке")}})}),s.jsx(EV,{visible:y,onCancel:()=>v(!1),onSuccess:_})]})},{key:"reviews",label:"Рецензии на отчеты об оценке",children:s.jsx(BV,{})}]})})},{TextArea:ju}=Re,{Option:Mi}=Ve,{Title:TV,Paragraph:k1}=ht,OV=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),Yp=e=>{const t=typeof e=="string"?parseFloat(e.replace(/\s/g,"").replace(",",".")):Number(e);return Number.isFinite(t)?OV.format(t):"—"},vr=e=>{if(e==null)return"—";const t=String(e).trim();return t.length>0?t:"—"},Oc={draft:{color:"default",text:"Черновик",icon:s.jsx(jr,{})},submitted:{color:"processing",text:"Подано",icon:s.jsx(Vn,{})},registered:{color:"success",text:"Зарегистрировано",icon:s.jsx(yn,{})},rejected:{color:"error",text:"Отклонено",icon:s.jsx(Jl,{})},cancelled:{color:"default",text:"Аннулировано",icon:s.jsx(Jl,{})}},IV=()=>{const e=$i(),[t,r]=M.useState([]),[a,n]=M.useState(!0),[i,o]=M.useState(null),[l,c]=M.useState(""),[A,d]=M.useState(null),[f,p]=M.useState(null),[u,g]=M.useState(null),[h,x]=M.useState(!1),[y,v]=M.useState(!1),[E]=re.useForm(),[k,S]=M.useState([]);M.useEffect(()=>{let G=!0;return(async()=>{n(!0),o(null);try{const C=localStorage.getItem("fnp_registrations");let D=[];if(C?D=JSON.parse(C):(D=b(),localStorage.setItem("fnp_registrations",JSON.stringify(D))),!G)return;r(D.map((j,K)=>({...j,key:j.id||`fnp-${K}`}))),await B()}catch(C){o(C instanceof Error?C.message:"Неизвестная ошибка"),r([])}finally{G&&n(!1)}})(),()=>{G=!1}},[]);const B=async()=>{try{const G="/",z=new URL(G,window.location.origin),C=z.pathname.endsWith("/")?z.pathname:`${z.pathname}/`,D=`${z.origin}${C}portfolioData.json?v=${Date.now()}`,j=await fetch(D,{cache:"no-store"});if(j.ok){const K=await j.json();S(K)}}catch(G){console.error("Ошибка загрузки данных портфеля:",G)}},b=()=>{const G=["Транспортные средства","Оборудование","Товары в обороте"],z=["draft","submitted","registered","rejected"],C=[];for(let D=1;D<=20;D++){const j=G[Math.floor(Math.random()*G.length)],K=z[Math.floor(Math.random()*z.length)],W=Oc[K];C.push({id:`fnp-${D}`,registrationNumber:K==="registered"?`ФНП-2024-${String(D).padStart(6,"0")}`:void 0,registrationDate:K==="registered"?We().subtract(Math.floor(Math.random()*30),"day").format("YYYY-MM-DD"):void 0,status:K,statusText:W.text,reference:`REF-${1e3+D}`,contractNumber:`ДЗ-2024-${D}`,pledgerName:`ООО "Компания ${D}"`,pledgerInn:`${Math.floor(1e9+Math.random()*9e9)}`,pledgerType:"legal",borrowerName:`Заемщик ${D}`,collateralType:j,collateralName:j==="Транспортные средства"?`Автомобиль ${["Toyota","BMW","Mercedes","Audi"][Math.floor(Math.random()*4)]}`:j==="Оборудование"?`Оборудование ${D}`:`Товары ${D}`,vehicleBrand:j==="Транспортные средства"?["Toyota","BMW","Mercedes"][Math.floor(Math.random()*3)]:void 0,vehicleModel:j==="Транспортные средства"?"Model X":void 0,vehicleYear:j==="Транспортные средства"?2020+Math.floor(Math.random()*4):void 0,vehicleVin:j==="Транспортные средства"?`VIN${Math.random().toString(36).substring(2,17).toUpperCase()}`:void 0,marketValue:Math.floor(Math.random()*5e6)+5e5,collateralValue:Math.floor(Math.random()*4e6)+4e5,pledgeContractNumber:`ДЗ-2024-${D}`,pledgeContractDate:We().subtract(Math.floor(Math.random()*60),"day").format("YYYY-MM-DD"),pledgeAmount:Math.floor(Math.random()*3e6)+3e5,createdAt:We().subtract(Math.floor(Math.random()*90),"day").toISOString(),updatedAt:We().subtract(Math.floor(Math.random()*10),"day").toISOString()})}return C},O=M.useMemo(()=>{const G=l.trim().toLowerCase();return t.filter(z=>{const C=!G||[z.registrationNumber,z.pledgerName,z.contractNumber,z.reference,z.collateralName,z.collateralType].filter(Boolean).some(K=>String(K).toLowerCase().includes(G)),D=!A||z.status===A,j=!f||z.collateralType===f;return C&&D&&j})},[t,l,A,f]),_=M.useMemo(()=>{const G=O.length,z=O.filter(j=>j.status==="draft").length,C=O.filter(j=>j.status==="submitted").length,D=O.filter(j=>j.status==="registered").length;return{total:G,draft:z,submitted:C,registered:D}},[O]),U=M.useMemo(()=>Array.from(new Set(t.map(G=>G.status))).map(G=>({label:Oc[G].text,value:G})),[t]),I=M.useMemo(()=>Array.from(new Set(t.map(G=>G.collateralType))).map(G=>({label:G,value:G})),[t]),R=G=>{g(G),x(!0)},L=()=>{g(null),E.resetFields(),E.setFieldsValue({status:"draft",pledgerType:"legal",pledgeContractDate:We()}),v(!0)},N=Ma.useCallback(G=>{g(G),E.setFieldsValue({...G,pledgeContractDate:G.pledgeContractDate?We(G.pledgeContractDate):void 0,registrationDate:G.registrationDate?We(G.registrationDate):void 0}),v(!0)},[E]),P=async()=>{var G,z,C,D;try{const j=await E.validateFields(),K=We().toISOString();if(u){const W={...u,...j,pledgeContractDate:(G=j.pledgeContractDate)==null?void 0:G.format("YYYY-MM-DD"),registrationDate:(z=j.registrationDate)==null?void 0:z.format("YYYY-MM-DD"),updatedAt:K},Ae=t.map(ue=>ue.id===u.id?{...W,key:W.id}:ue);r(Ae),localStorage.setItem("fnp_registrations",JSON.stringify(Ae)),Ne.success("Регистрация обновлена")}else{const W={id:`fnp-${Date.now()}`,status:j.status||"draft",statusText:Oc[j.status||"draft"].text,...j,pledgeContractDate:(C=j.pledgeContractDate)==null?void 0:C.format("YYYY-MM-DD"),registrationDate:(D=j.registrationDate)==null?void 0:D.format("YYYY-MM-DD"),createdAt:K,updatedAt:K},Ae=[...t,{...W,key:W.id}];r(Ae),localStorage.setItem("fnp_registrations",JSON.stringify(Ae)),Ne.success("Регистрация создана")}v(!1),E.resetFields()}catch(j){console.error("Ошибка сохранения:",j),Ne.error("Ошибка при сохранении регистрации")}},Q=Ma.useCallback(G=>{cr.confirm({title:"Удалить регистрацию?",content:"Это действие нельзя отменить.",okText:"Удалить",okType:"danger",cancelText:"Отмена",onOk:()=>{const z=t.filter(C=>C.id!==G);r(z),localStorage.setItem("fnp_registrations",JSON.stringify(z)),Ne.success("Регистрация удалена")}})},[t]),Y=G=>{const z=k.find(C=>String(C.reference)===String(G));z&&E.setFieldsValue({contractNumber:z.contractNumber||null,pledgerName:z.pledger||null,pledgerInn:z.inn||null,borrowerName:z.borrower||null,collateralType:z.collateralType||null,collateralName:z.collateralType||null,marketValue:z.marketValue||z.currentMarketValue||null,collateralValue:z.collateralValue||null,pledgeAmount:z.debtRub||null})},ee=Ma.useCallback(G=>{G&&e(`/portfolio?q=${G}`)},[e]),V=M.useMemo(()=>[{title:"№ регистрации",dataIndex:"registrationNumber",key:"registrationNumber",width:150,render:(G,z)=>s.jsx(Be,{type:"link",onClick:()=>R(z),style:{padding:0},children:G||s.jsx("span",{style:{color:"#999"},children:"—"})})},{title:"Дата регистрации",dataIndex:"registrationDate",key:"registrationDate",width:120,render:G=>vr(G)},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:G=>s.jsx(Kr,{title:G,children:s.jsx(Be,{type:"link",onClick:()=>ee(G),style:{padding:0},children:s.jsx(ht.Text,{copyable:!0,ellipsis:{suffix:String(G).slice(-4)},children:G})})})},{title:"Залогодатель",dataIndex:"pledgerName",key:"pledgerName",width:200,render:G=>vr(G)},{title:"Тип имущества",dataIndex:"collateralType",key:"collateralType",width:150,render:G=>vr(G)},{title:"Предмет залога",dataIndex:"collateralName",key:"collateralName",width:200,render:G=>vr(G)},{title:"Статус",dataIndex:"status",key:"status",width:150,render:(G,z)=>{const C=Oc[G]||Oc.draft;return s.jsx(Ze,{color:C.color,icon:C.icon,children:z.statusText})}},{title:"Действия",key:"actions",width:120,fixed:"right",render:(G,z)=>s.jsxs(Te,{size:"small",children:[s.jsx(Kr,{title:"Просмотреть",children:s.jsx(Be,{icon:s.jsx(Ii,{}),onClick:()=>R(z),size:"small"})}),z.status==="draft"&&s.jsx(Kr,{title:"Редактировать",children:s.jsx(Be,{icon:s.jsx(Rs,{}),onClick:()=>N(z),size:"small"})}),z.status==="draft"&&s.jsx(Kr,{title:"Удалить",children:s.jsx(Be,{icon:s.jsx(Oi,{}),onClick:()=>Q(z.id),size:"small",danger:!0})})]})}],[ee,N,Q]);return s.jsxs("div",{className:"fnp-service-page",children:[s.jsxs("div",{className:"fnp-header",children:[s.jsxs("div",{children:[s.jsx(TV,{level:2,className:"fnp-title",children:"Регистрация залога движимого имущества ФНП"}),s.jsx(k1,{className:"fnp-subtitle",children:"Сервис регистрации залога движимого имущества в реестре Федеральной нотариальной палаты"})]}),s.jsxs(Te,{size:"middle",children:[s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по №, REFERENCE, залогодателю",prefix:s.jsx(Pa,{}),value:l,onChange:G=>c(G.target.value),style:{width:360}}),s.jsx(Be,{type:"primary",size:"large",icon:s.jsx(ys,{}),onClick:L,children:"Создать регистрацию"})]})]}),s.jsx(Ue,{children:s.jsxs("div",{className:"fnp-filters",children:[s.jsx(Ve,{allowClear:!0,placeholder:"Статус регистрации",style:{width:200},options:U,value:A??void 0,onChange:G=>d(G??null)}),s.jsx(Ve,{allowClear:!0,placeholder:"Тип имущества",style:{width:200},options:I,value:f??void 0,onChange:G=>p(G??null)})]})}),s.jsxs(dt,{gutter:[16,16],className:"fnp-stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего регистраций",value:_.total,prefix:s.jsx(jr,{})})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Черновики",value:_.draft})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Подано",value:_.submitted})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Зарегистрировано",value:_.registered})})})]}),s.jsx(Ue,{className:"fnp-table-card",bodyStyle:{padding:0},children:s.jsx(ir,{columns:V,dataSource:O,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},loading:a,onRow:G=>({onDoubleClick:()=>R(G)}),locale:{emptyText:s.jsx(Sr,{description:"Нет регистраций, удовлетворяющих фильтрам",className:"fnp-empty"})}})}),i&&s.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные регистраций",description:i,action:s.jsx(Be,{size:"small",icon:s.jsx(Zl,{}),onClick:()=>window.location.reload(),children:"Повторить"})}),s.jsx(cr,{title:"Регистрация залога ФНП",open:h,onCancel:()=>x(!1),footer:[(u==null?void 0:u.status)==="draft"&&s.jsx(Be,{icon:s.jsx(Rs,{}),onClick:()=>{x(!1),N(u)},children:"Редактировать"},"edit"),s.jsx(Be,{type:"primary",onClick:()=>x(!1),children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:u&&s.jsx("div",{className:"fnp-registration-details",children:s.jsxs(ye,{bordered:!0,column:3,size:"small",children:[s.jsx(ye.Item,{label:"№ регистрации",span:1,children:vr(u.registrationNumber)||s.jsx("span",{style:{color:"#999"},children:"Не присвоен"})}),s.jsx(ye.Item,{label:"Дата регистрации",span:1,children:vr(u.registrationDate)}),s.jsx(ye.Item,{label:"Статус",span:1,children:s.jsx(Ze,{color:Oc[u.status].color,icon:Oc[u.status].icon,children:u.statusText})}),s.jsx(ye.Item,{label:"REFERENCE",span:1,children:s.jsx(Be,{type:"link",onClick:()=>ee(u.reference),style:{padding:0},children:vr(u.reference)})}),s.jsx(ye.Item,{label:"№ договора залога",span:2,children:vr(u.pledgeContractNumber)}),s.jsx(jt,{orientation:"left",children:"Залогодатель"}),s.jsx(ye.Item,{label:"Наименование",span:2,children:vr(u.pledgerName)}),s.jsx(ye.Item,{label:"Тип",span:1,children:u.pledgerType==="legal"?"Юридическое лицо":"Физическое лицо"}),s.jsx(ye.Item,{label:"ИНН",children:vr(u.pledgerInn)}),s.jsx(ye.Item,{label:"ОГРН",children:vr(u.pledgerOgrn)}),s.jsx(ye.Item,{label:"Адрес",span:3,children:vr(u.pledgerAddress)}),u.borrowerName&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Заемщик"}),s.jsx(ye.Item,{label:"Наименование",span:2,children:vr(u.borrowerName)}),s.jsx(ye.Item,{label:"ИНН",children:vr(u.borrowerInn)})]}),s.jsx(jt,{orientation:"left",children:"Предмет залога"}),s.jsx(ye.Item,{label:"Тип имущества",span:1,children:vr(u.collateralType)}),s.jsx(ye.Item,{label:"Наименование",span:2,children:vr(u.collateralName)}),u.collateralType==="Транспортные средства"&&s.jsxs(s.Fragment,{children:[s.jsx(ye.Item,{label:"Марка",children:vr(u.vehicleBrand)}),s.jsx(ye.Item,{label:"Модель",children:vr(u.vehicleModel)}),s.jsx(ye.Item,{label:"Год выпуска",children:vr(u.vehicleYear)}),s.jsx(ye.Item,{label:"VIN",children:vr(u.vehicleVin)}),s.jsx(ye.Item,{label:"Гос. номер",children:vr(u.vehicleRegistrationNumber)}),s.jsx(ye.Item,{label:"Номер кузова",children:vr(u.vehicleBodyNumber)}),s.jsx(ye.Item,{label:"Номер шасси",children:vr(u.vehicleChassisNumber)}),s.jsx(ye.Item,{label:"Номер рамы",children:vr(u.vehicleFrameNumber)})]}),u.collateralType==="Оборудование"&&s.jsxs(s.Fragment,{children:[s.jsx(ye.Item,{label:"Наименование",span:2,children:vr(u.equipmentName)}),s.jsx(ye.Item,{label:"Производитель",children:vr(u.equipmentManufacturer)}),s.jsx(ye.Item,{label:"Модель",children:vr(u.equipmentModel)}),s.jsx(ye.Item,{label:"Серийный номер",children:vr(u.equipmentSerialNumber)}),s.jsx(ye.Item,{label:"Инвентарный номер",children:vr(u.equipmentInventoryNumber)}),s.jsx(ye.Item,{label:"Год выпуска",children:vr(u.equipmentYear)})]}),s.jsx(jt,{orientation:"left",children:"Оценка"}),s.jsx(ye.Item,{label:"Рыночная стоимость",children:Yp(u.marketValue)}),s.jsx(ye.Item,{label:"Залоговая стоимость",children:Yp(u.collateralValue)}),s.jsx(ye.Item,{label:"Сумма обязательства",children:Yp(u.pledgeAmount)}),s.jsx(jt,{orientation:"left",children:"Договор залога"}),s.jsx(ye.Item,{label:"№ договора",children:vr(u.pledgeContractNumber)}),s.jsx(ye.Item,{label:"Дата договора",children:vr(u.pledgeContractDate)}),s.jsx(ye.Item,{label:"Сумма обязательства",children:Yp(u.pledgeAmount)}),u.notaryName&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Нотариус"}),s.jsx(ye.Item,{label:"ФИО нотариуса",span:2,children:vr(u.notaryName)}),s.jsx(ye.Item,{label:"Регион",children:vr(u.notaryRegion)}),s.jsx(ye.Item,{label:"Нотариальная контора",span:3,children:vr(u.notaryOffice)})]}),u.rejectionReason&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Отклонение"}),s.jsx(ye.Item,{label:"Причина отклонения",span:3,children:s.jsx(k1,{style:{margin:0,color:"#ff4d4f"},children:u.rejectionReason})})]}),u.comments&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Комментарии"}),s.jsx(ye.Item,{label:"Примечания",span:3,children:s.jsx(k1,{style:{margin:0},children:u.comments})})]})]})})}),s.jsx(cr,{title:u?"Редактировать регистрацию":"Создать регистрацию залога ФНП",open:y,onCancel:()=>{v(!1),E.resetFields()},footer:[s.jsx(Be,{onClick:()=>{v(!1),E.resetFields()},children:"Отмена"},"cancel"),s.jsx(Be,{type:"primary",onClick:P,children:u?"Сохранить":"Создать"},"submit")],width:900,children:s.jsxs(re,{form:E,layout:"vertical",children:[s.jsx(re.Item,{name:"reference",label:"REFERENCE сделки",tooltip:"Выберите сделку из портфеля для автозаполнения данных",children:s.jsx(Ve,{placeholder:"Выберите REFERENCE",showSearch:!0,allowClear:!0,onChange:Y,filterOption:(G,z)=>String((z==null?void 0:z.children)||"").toLowerCase().includes(G.toLowerCase()),children:k.map(G=>s.jsxs(Mi,{value:G.reference,children:[G.reference," - ",G.borrower||G.pledger||"Не указано"]},G.reference))})}),s.jsx(re.Item,{name:"status",label:"Статус",rules:[{required:!0}],children:s.jsxs(Ve,{children:[s.jsx(Mi,{value:"draft",children:"Черновик"}),s.jsx(Mi,{value:"submitted",children:"Подано"}),s.jsx(Mi,{value:"registered",children:"Зарегистрировано"}),s.jsx(Mi,{value:"rejected",children:"Отклонено"}),s.jsx(Mi,{value:"cancelled",children:"Аннулировано"})]})}),s.jsx(jt,{orientation:"left",children:"Залогодатель"}),s.jsx(re.Item,{name:"pledgerType",label:"Тип залогодателя",rules:[{required:!0}],children:s.jsxs(Ve,{children:[s.jsx(Mi,{value:"legal",children:"Юридическое лицо"}),s.jsx(Mi,{value:"individual",children:"Физическое лицо"})]})}),s.jsx(re.Item,{name:"pledgerName",label:"Наименование залогодателя",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Наименование"})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgerInn",label:"ИНН",children:s.jsx(Re,{placeholder:"ИНН"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgerOgrn",label:"ОГРН",children:s.jsx(Re,{placeholder:"ОГРН"})})})]}),s.jsx(re.Item,{name:"pledgerAddress",label:"Адрес залогодателя",children:s.jsx(ju,{rows:2,placeholder:"Адрес"})}),s.jsx(jt,{orientation:"left",children:"Заемщик"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:16,children:s.jsx(re.Item,{name:"borrowerName",label:"Наименование заемщика",children:s.jsx(Re,{placeholder:"Наименование"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"borrowerInn",label:"ИНН заемщика",children:s.jsx(Re,{placeholder:"ИНН"})})})]}),s.jsx(jt,{orientation:"left",children:"Предмет залога"}),s.jsx(re.Item,{name:"collateralType",label:"Тип движимого имущества",rules:[{required:!0}],children:s.jsxs(Ve,{placeholder:"Выберите тип",children:[s.jsx(Mi,{value:"Транспортные средства",children:"Транспортные средства"}),s.jsx(Mi,{value:"Оборудование",children:"Оборудование"}),s.jsx(Mi,{value:"Товары в обороте",children:"Товары в обороте"})]})}),s.jsx(re.Item,{name:"collateralName",label:"Наименование предмета залога",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Наименование"})}),s.jsx(re.Item,{name:"collateralDescription",label:"Описание предмета залога",children:s.jsx(ju,{rows:3,placeholder:"Подробное описание"})}),s.jsx(re.Item,{noStyle:!0,shouldUpdate:(G,z)=>G.collateralType!==z.collateralType,children:({getFieldValue:G})=>{const z=G("collateralType");return z==="Транспортные средства"?s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Данные транспортного средства"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"vehicleBrand",label:"Марка",children:s.jsx(Re,{placeholder:"Марка ТС"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"vehicleModel",label:"Модель",children:s.jsx(Re,{placeholder:"Модель"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"vehicleYear",label:"Год выпуска",children:s.jsx(pa,{style:{width:"100%"},min:1900,max:new Date().getFullYear()})})}),s.jsx(be,{span:16,children:s.jsx(re.Item,{name:"vehicleVin",label:"VIN номер",children:s.jsx(Re,{placeholder:"VIN"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"vehicleRegistrationNumber",label:"Гос. номер",children:s.jsx(Re,{placeholder:"A777AA92"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"vehicleBodyNumber",label:"Номер кузова",children:s.jsx(Re,{placeholder:"Номер кузова"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"vehicleChassisNumber",label:"Номер шасси",children:s.jsx(Re,{placeholder:"Номер шасси"})})})]}),s.jsx(re.Item,{name:"vehicleFrameNumber",label:"Номер рамы",children:s.jsx(Re,{placeholder:"Номер рамы"})})]}):z==="Оборудование"?s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Данные оборудования"}),s.jsx(re.Item,{name:"equipmentName",label:"Наименование оборудования",children:s.jsx(Re,{placeholder:"Наименование"})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"equipmentManufacturer",label:"Производитель",children:s.jsx(Re,{placeholder:"Производитель"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"equipmentModel",label:"Модель",children:s.jsx(Re,{placeholder:"Модель"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"equipmentSerialNumber",label:"Серийный номер",children:s.jsx(Re,{placeholder:"Серийный номер"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"equipmentInventoryNumber",label:"Инвентарный номер",children:s.jsx(Re,{placeholder:"Инвентарный номер"})})})]}),s.jsx(re.Item,{name:"equipmentYear",label:"Год выпуска",children:s.jsx(pa,{style:{width:"100%"},min:1900,max:new Date().getFullYear()})})]}):z==="Товары в обороте"?s.jsxs(s.Fragment,{children:[s.jsx(jt,{orientation:"left",children:"Данные товаров"}),s.jsx(re.Item,{name:"goodsDescription",label:"Описание товаров",children:s.jsx(ju,{rows:3,placeholder:"Подробное описание товаров"})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"goodsQuantity",label:"Количество",children:s.jsx(pa,{style:{width:"100%"},min:0})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"goodsUnit",label:"Единица измерения",children:s.jsx(Re,{placeholder:"шт., кг, м и т.д."})})})]})]}):null}}),s.jsx(jt,{orientation:"left",children:"Оценка"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"marketValue",label:"Рыночная стоимость, руб.",children:s.jsx(pa,{style:{width:"100%"},min:0,addonAfter:"руб."})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"collateralValue",label:"Залоговая стоимость, руб.",children:s.jsx(pa,{style:{width:"100%"},min:0,addonAfter:"руб."})})})]}),s.jsx(jt,{orientation:"left",children:"Договор залога"}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgeContractNumber",label:"№ договора залога",children:s.jsx(Re,{placeholder:"Номер договора"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"pledgeContractDate",label:"Дата договора залога",children:s.jsx(Dr,{style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),s.jsx(re.Item,{name:"pledgeAmount",label:"Сумма обязательства, обеспеченного залогом, руб.",children:s.jsx(pa,{style:{width:"100%"},min:0,addonAfter:"руб."})}),s.jsx(jt,{orientation:"left",children:"Нотариус"}),s.jsx(re.Item,{name:"notaryName",label:"ФИО нотариуса",children:s.jsx(Re,{placeholder:"ФИО нотариуса"})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"notaryRegion",label:"Регион",children:s.jsx(Re,{placeholder:"Регион"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"notaryOffice",label:"Нотариальная контора",children:s.jsx(Re,{placeholder:"Название конторы"})})})]}),s.jsx(re.Item,{name:"comments",label:"Комментарии",children:s.jsx(ju,{rows:3,placeholder:"Дополнительные комментарии"})}),(u==null?void 0:u.status)==="rejected"&&s.jsx(re.Item,{name:"rejectionReason",label:"Причина отклонения",children:s.jsx(ju,{rows:2,placeholder:"Причина отклонения регистрации"})})]})})]})},{Title:NV,Text:FV}=ht,{Option:Ea}=Ve,RV=()=>{const e=$i(),[t]=re.useForm(),[r,a]=M.useState([]),[n]=M.useState(!1),[i,o]=M.useState(""),[l,c]=M.useState(null),[A,d]=M.useState(null),[f,p]=M.useState(null),[u,g]=M.useState(null),[h,x]=M.useState(!1),[y,v]=M.useState(!1),[E,k]=M.useState(!1);M.useEffect(()=>{(()=>{try{const Y=localStorage.getItem("creditRiskRecords");if(Y){const ee=JSON.parse(Y);a(ee.map((V,G)=>({...V,key:V.id||`risk-${G}`})))}}catch(Y){console.error("Ошибка загрузки данных ФКР:",Y),a([])}})()},[]);const S=Q=>{try{localStorage.setItem("creditRiskRecords",JSON.stringify(Q)),a(Q.map((Y,ee)=>({...Y,key:Y.id||`risk-${ee}`})))}catch(Y){console.error("Ошибка сохранения данных ФКР:",Y),Ne.error("Ошибка сохранения данных")}},B=M.useMemo(()=>{const Q=i.trim().toLowerCase();return r.filter(Y=>{var C,D,j;const ee=!Q||String(Y.reference).toLowerCase().includes(Q)||((C=Y.contractNumber)==null?void 0:C.toLowerCase().includes(Q))||((D=Y.pledger)==null?void 0:D.toLowerCase().includes(Q))||((j=Y.borrower)==null?void 0:j.toLowerCase().includes(Q))||Y.riskEvent.name.toLowerCase().includes(Q),V=!l||Y.status===l,G=!A||Y.riskEvent.category===A,z=!f||Y.priority===f;return ee&&V&&G&&z})},[r,i,l,A,f]),b=M.useMemo(()=>{const Q=r.filter(G=>G.status==="active").length,Y=r.filter(G=>G.status==="resolved").length,ee=r.filter(G=>G.priority==="critical"&&G.status==="active").length,V=r.filter(G=>G.priority==="high"&&G.status==="active").length;return{total:r.length,active:Q,resolved:Y,critical:ee,high:V}},[r]),O=()=>{g(null),t.resetFields(),k(!0)},_=Q=>{g(Q),x(!0)},U=Q=>{g(Q),t.setFieldsValue({...Q,eventDate:Q.eventDate?We(Q.eventDate):null,detectionDate:Q.detectionDate?We(Q.detectionDate):null,resolutionDate:Q.resolutionDate?We(Q.resolutionDate):null,riskEventCode:Q.riskEvent.code}),v(!0)},I=async Q=>{try{const Y=E2.find(G=>G.code===Q.riskEventCode);if(!Y){Ne.error("Рисковое событие не найдено");return}const ee={id:(u==null?void 0:u.id)||`risk-${Date.now()}`,reference:Q.reference,contractNumber:Q.contractNumber,pledger:Q.pledger,pledgerInn:Q.pledgerInn,borrower:Q.borrower,borrowerInn:Q.borrowerInn,riskEvent:Y,suspensiveConditionId:Q.suspensiveConditionId,suspensiveConditionDescription:Q.suspensiveConditionDescription,insuranceRelated:Q.insuranceRelated||!1,insurancePolicyNumber:Q.insurancePolicyNumber,status:Q.status||"active",eventDate:Q.eventDate?Q.eventDate.format("YYYY-MM-DD"):We().format("YYYY-MM-DD"),detectionDate:Q.detectionDate?Q.detectionDate.format("YYYY-MM-DD"):We().format("YYYY-MM-DD"),resolutionDate:Q.resolutionDate?Q.resolutionDate.format("YYYY-MM-DD"):void 0,description:Q.description,comments:Q.comments,resolution:Q.resolution,detectedBy:Q.detectedBy,responsible:Q.responsible,reviewer:Q.reviewer,priority:Q.priority||"medium",documents:Q.documents||[],createdAt:(u==null?void 0:u.createdAt)||We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")},V=u?r.map(G=>G.id===u.id?ee:G):[...r,ee];S(V),Ne.success(u?"Запись обновлена":"Запись создана"),v(!1),k(!1),t.resetFields()}catch(Y){console.error("Ошибка сохранения:",Y),Ne.error("Ошибка сохранения записи")}},R=Q=>{switch(Q){case"active":return"red";case"resolved":return"green";case"archived":return"default";default:return"default"}},L=Q=>{switch(Q){case"critical":return"red";case"high":return"orange";case"medium":return"blue";case"low":return"green";default:return"default"}},N=Q=>({collateral:"purple",borrower:"cyan",financial:"gold",transport:"blue",rating:"orange",industry:"volcano",legal:"red"})[Q]||"default",P=[{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:(Q,Y)=>s.jsx(Be,{type:"link",onClick:()=>e(`/portfolio?q=${Y.reference}`),icon:s.jsx(go,{}),children:Y.reference})},{title:"Договор залога",dataIndex:"contractNumber",key:"contractNumber",width:150},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200},{title:"Рисковое событие",key:"riskEvent",width:300,render:(Q,Y)=>s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsx(Ze,{color:N(Y.riskEvent.category),children:Y.riskEvent.code}),s.jsx(FV,{style:{fontSize:"12px"},children:Y.riskEvent.name})]})},{title:"Статус",dataIndex:"status",key:"status",width:100,render:Q=>{const Y={active:"Активен",resolved:"Разрешен",archived:"Архив"};return s.jsx(Ze,{color:R(Q),children:Y[Q]})}},{title:"Приоритет",dataIndex:"priority",key:"priority",width:100,render:Q=>{const Y={critical:"Критический",high:"Высокий",medium:"Средний",low:"Низкий"};return s.jsx(Ze,{color:L(Q),children:Y[Q]})}},{title:"Дата события",dataIndex:"eventDate",key:"eventDate",width:120,render:Q=>We(Q).format("DD.MM.YYYY")},{title:"Действия",key:"actions",width:120,fixed:"right",render:(Q,Y)=>s.jsxs(Te,{children:[s.jsx(Kr,{title:"Просмотр",children:s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>_(Y)})}),s.jsx(Kr,{title:"Редактировать",children:s.jsx(Be,{type:"link",icon:s.jsx(jr,{}),onClick:()=>U(Y)})})]})}];return s.jsxs("div",{className:"credit-risk-page",children:[s.jsxs("div",{className:"credit-risk-page__header",children:[s.jsxs("div",{children:[s.jsx(NV,{level:2,className:"credit-risk-page__title",children:"Модуль мониторинга"}),s.jsx(ht.Paragraph,{className:"credit-risk-page__subtitle",children:"Отслеживание рисковых событий и отлагательных условий по договорам залога"})]}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:O,children:"Добавить рисковое событие"})]}),s.jsxs(dt,{gutter:[16,16],className:"credit-risk-page__stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего записей",value:b.total})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Активных рисков",value:b.active,valueStyle:{color:"#cf1322"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Критических",value:b.critical,valueStyle:{color:"#ff4d4f"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Разрешенных",value:b.resolved,valueStyle:{color:"#3f8600"}})})})]}),s.jsx(Ue,{children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsx(Re,{allowClear:!0,placeholder:"Поиск по REFERENCE, договору, залогодателю, заемщику",prefix:s.jsx(Pa,{}),value:i,onChange:Q=>o(Q.target.value),style:{width:"100%"}}),s.jsxs(Te,{wrap:!0,children:[s.jsxs(Ve,{allowClear:!0,placeholder:"Статус",style:{width:150},value:l??void 0,onChange:Q=>c(Q??null),children:[s.jsx(Ea,{value:"active",children:"Активен"}),s.jsx(Ea,{value:"resolved",children:"Разрешен"}),s.jsx(Ea,{value:"archived",children:"Архив"})]}),s.jsxs(Ve,{allowClear:!0,placeholder:"Категория",style:{width:200},value:A??void 0,onChange:Q=>d(Q??null),children:[s.jsx(Ea,{value:"collateral",children:"Обеспечение"}),s.jsx(Ea,{value:"borrower",children:"Заемщик/Залогодатель"}),s.jsx(Ea,{value:"financial",children:"Финансовые"}),s.jsx(Ea,{value:"transport",children:"Транспорт"}),s.jsx(Ea,{value:"rating",children:"Рейтинг"}),s.jsx(Ea,{value:"industry",children:"Отрасль"}),s.jsx(Ea,{value:"legal",children:"Юридические"})]}),s.jsxs(Ve,{allowClear:!0,placeholder:"Приоритет",style:{width:150},value:f??void 0,onChange:Q=>p(Q??null),children:[s.jsx(Ea,{value:"critical",children:"Критический"}),s.jsx(Ea,{value:"high",children:"Высокий"}),s.jsx(Ea,{value:"medium",children:"Средний"}),s.jsx(Ea,{value:"low",children:"Низкий"})]})]})]})}),s.jsx(Ue,{bodyStyle:{padding:0},children:s.jsx(ir,{columns:P,dataSource:B,pagination:{pageSize:20,showSizeChanger:!0},scroll:{x:1200},loading:n,locale:{emptyText:s.jsx(Sr,{description:"Нет записей"})}})}),s.jsx(cr,{title:"Детали рискового события",open:h,onCancel:()=>x(!1),footer:[s.jsx(Be,{onClick:()=>x(!1),children:"Закрыть"},"close")],width:800,children:u&&s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"REFERENCE",span:2,children:s.jsx(Be,{type:"link",onClick:()=>{e(`/portfolio?q=${u.reference}`),x(!1)},icon:s.jsx(go,{}),children:u.reference})}),s.jsx(ye.Item,{label:"Договор залога",children:u.contractNumber||"—"}),s.jsx(ye.Item,{label:"Залогодатель",children:u.pledger}),s.jsx(ye.Item,{label:"Заемщик",children:u.borrower||"—"}),s.jsx(ye.Item,{label:"Рисковое событие",span:2,children:s.jsxs(Te,{children:[s.jsx(Ze,{color:N(u.riskEvent.category),children:u.riskEvent.code}),u.riskEvent.name]})}),u.suspensiveConditionDescription&&s.jsx(ye.Item,{label:"Отлагательное условие",span:2,children:u.suspensiveConditionDescription}),u.insuranceRelated&&s.jsx(ye.Item,{label:"Страхование",span:2,children:s.jsx(Be,{type:"link",onClick:()=>{e(`/insurance?ref=${u.reference}`),x(!1)},icon:s.jsx(WT,{}),children:u.insurancePolicyNumber||"Перейти к страхованию"})}),s.jsx(ye.Item,{label:"Статус",children:s.jsx(Ze,{color:R(u.status),children:u.status==="active"?"Активен":u.status==="resolved"?"Разрешен":"Архив"})}),s.jsx(ye.Item,{label:"Приоритет",children:s.jsx(Ze,{color:L(u.priority),children:u.priority==="critical"?"Критический":u.priority==="high"?"Высокий":u.priority==="medium"?"Средний":"Низкий"})}),s.jsx(ye.Item,{label:"Дата события",children:We(u.eventDate).format("DD.MM.YYYY")}),s.jsx(ye.Item,{label:"Дата обнаружения",children:We(u.detectionDate).format("DD.MM.YYYY")}),u.resolutionDate&&s.jsx(ye.Item,{label:"Дата разрешения",children:We(u.resolutionDate).format("DD.MM.YYYY")}),u.description&&s.jsx(ye.Item,{label:"Описание",span:2,children:u.description}),u.comments&&s.jsx(ye.Item,{label:"Комментарии",span:2,children:u.comments}),u.resolution&&s.jsx(ye.Item,{label:"Способ разрешения",span:2,children:u.resolution})]})}),s.jsx(B2,{title:u?"Редактировать запись":"Добавить рисковое событие",open:y||E,onClose:()=>{v(!1),k(!1),t.resetFields()},width:600,children:s.jsxs(re,{form:t,layout:"vertical",onFinish:I,initialValues:{status:"active",priority:"medium",eventDate:We(),detectionDate:We()},children:[s.jsx(re.Item,{name:"reference",label:"REFERENCE",rules:[{required:!0,message:"Укажите REFERENCE"}],children:s.jsx(Re,{placeholder:"REFERENCE сделки"})}),s.jsx(re.Item,{name:"contractNumber",label:"Договор залога",children:s.jsx(Re,{placeholder:"Номер договора залога"})}),s.jsx(re.Item,{name:"pledger",label:"Залогодатель",rules:[{required:!0,message:"Укажите залогодателя"}],children:s.jsx(Re,{placeholder:"Наименование залогодателя"})}),s.jsx(re.Item,{name:"pledgerInn",label:"ИНН залогодателя",children:s.jsx(Re,{placeholder:"ИНН"})}),s.jsx(re.Item,{name:"borrower",label:"Заемщик",children:s.jsx(Re,{placeholder:"Наименование заемщика"})}),s.jsx(re.Item,{name:"borrowerInn",label:"ИНН заемщика",children:s.jsx(Re,{placeholder:"ИНН"})}),s.jsx(re.Item,{name:"riskEventCode",label:"Рисковое событие",rules:[{required:!0,message:"Выберите рисковое событие"}],children:s.jsx(Ve,{placeholder:"Выберите событие",showSearch:!0,optionFilterProp:"children",children:E2.map(Q=>s.jsxs(Ea,{value:Q.code,children:["[",Q.code,"] ",Q.name]},Q.code))})}),s.jsx(re.Item,{name:"suspensiveConditionDescription",label:"Отлагательное условие",children:s.jsx(Re.TextArea,{rows:3,placeholder:"Описание отлагательного условия (если добавлено из заключения)"})}),s.jsx(re.Item,{name:"insuranceRelated",label:"Связано со страхованием",valuePropName:"checked",children:s.jsx(ms,{})}),s.jsx(re.Item,{name:"insurancePolicyNumber",label:"Номер полиса страхования",children:s.jsx(Re,{placeholder:"Номер полиса"})}),s.jsx(re.Item,{name:"status",label:"Статус",children:s.jsxs(Ve,{children:[s.jsx(Ea,{value:"active",children:"Активен"}),s.jsx(Ea,{value:"resolved",children:"Разрешен"}),s.jsx(Ea,{value:"archived",children:"Архив"})]})}),s.jsx(re.Item,{name:"priority",label:"Приоритет",children:s.jsxs(Ve,{children:[s.jsx(Ea,{value:"low",children:"Низкий"}),s.jsx(Ea,{value:"medium",children:"Средний"}),s.jsx(Ea,{value:"high",children:"Высокий"}),s.jsx(Ea,{value:"critical",children:"Критический"})]})}),s.jsx(re.Item,{name:"eventDate",label:"Дата события",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"detectionDate",label:"Дата обнаружения",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"resolutionDate",label:"Дата разрешения",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(Re.TextArea,{rows:4,placeholder:"Дополнительное описание события"})}),s.jsx(re.Item,{name:"comments",label:"Комментарии",children:s.jsx(Re.TextArea,{rows:3,placeholder:"Комментарии"})}),s.jsx(re.Item,{name:"resolution",label:"Способ разрешения",children:s.jsx(Re.TextArea,{rows:3,placeholder:"Как был разрешен риск"})}),s.jsx(re.Item,{name:"detectedBy",label:"Обнаружил",children:s.jsx(Re,{placeholder:"ФИО сотрудника"})}),s.jsx(re.Item,{name:"responsible",label:"Ответственный",children:s.jsx(Re,{placeholder:"ФИО ответственного"})}),s.jsx(re.Item,{children:s.jsxs(Te,{children:[s.jsx(Be,{type:"primary",htmlType:"submit",children:u?"Сохранить":"Создать"}),s.jsx(Be,{onClick:()=>{v(!1),k(!1),t.resetFields()},children:"Отмена"})]})})]})})]})},{Title:zE,Text:cd}=ht,kV=()=>{var V;const[e,t]=M.useState("collateral"),[r,a]=M.useState(null),[n,i]=M.useState([]),[o,l]=M.useState(!1),[c,A]=M.useState(!1),[d,f]=M.useState(!1),[p,u]=M.useState([]),[g,h]=M.useState(""),[x,y]=M.useState(null),[v,E]=M.useState(!1),[k,S]=M.useState(!1);M.useEffect(()=>{(async()=>{l(!0);try{if(e==="collateral"){const C=(await kt.getExtendedCards()).map(D=>{var j,K,W,Ae;return{id:D.id,type:"collateral",name:D.name,reference:D.reference,contractNumber:D.contractNumber,collateralType:(j=D.classification)==null?void 0:j.level1,address:(K=D.address)==null?void 0:K.fullAddress,area:((W=D.characteristics)==null?void 0:W.totalAreaSqm)||((Ae=D.characteristics)==null?void 0:Ae.totalArea),characteristics:D.characteristics||{}}});i(C)}else if(e==="conclusion")try{const z="/",C=new URL(z,window.location.origin),D=C.pathname.endsWith("/")?C.pathname:`${C.pathname}/`,j=`${C.origin}${D}collateralConclusionsData.json?v=${Date.now()}`,K=await fetch(j,{cache:"no-store"});if(K.ok){const Ae=(await K.json()).map(ue=>({id:ue.id,type:"conclusion",name:ue.collateralName||ue.collateralType||"Залоговое заключение",reference:ue.reference||void 0,contractNumber:ue.contractNumber||void 0,collateralType:ue.collateralType||void 0,address:ue.collateralLocation||void 0,area:ue.totalAreaSqm||ue.totalAreaHectares||void 0,characteristics:{marketValue:ue.marketValue,collateralValue:ue.collateralValue,fairValue:ue.fairValue}}));i(Ae)}}catch(z){console.error("Ошибка загрузки заключений:",z),i([])}else if(e==="portfolio")try{const z="/",C=new URL(z,window.location.origin),D=C.pathname.endsWith("/")?C.pathname:`${C.pathname}/`,j=`${C.origin}${D}portfolioData.json?v=${Date.now()}`,K=await fetch(j,{cache:"no-store"});if(K.ok){const Ae=(await K.json()).map(ue=>({id:String(ue.reference||`portfolio-${ue.contractNumber}`),type:"portfolio",name:`${ue.borrower||ue.pledger||"Договор"} - ${ue.collateralType||"Обеспечение"}`,reference:ue.reference||void 0,contractNumber:ue.contractNumber||void 0,collateralType:ue.collateralType||void 0,address:ue.collateralLocation||void 0,characteristics:{marketValue:ue.marketValue,collateralValue:ue.collateralValue,fairValue:ue.fairValue}}));i(Ae)}}catch(z){console.error("Ошибка загрузки портфеля:",z),i([])}}catch(z){console.error("Ошибка загрузки объектов:",z),Ne.error("Ошибка загрузки объектов"),i([])}finally{l(!1)}})()},[e]),M.useEffect(()=>{(()=>{try{const z=localStorage.getItem("appraisalResults");if(z){const C=JSON.parse(z);u(C.map((D,j)=>({...D,key:D.id||`result-${j}`})))}}catch(z){console.error("Ошибка загрузки результатов оценки:",z)}})()},[]);const B=M.useMemo(()=>{const G=g.trim().toLowerCase();return n.filter(z=>{var C,D;return!G||z.name.toLowerCase().includes(G)||String(z.reference||"").toLowerCase().includes(G)||((C=z.contractNumber)==null?void 0:C.toLowerCase().includes(G))||((D=z.address)==null?void 0:D.toLowerCase().includes(G))})},[n,g]),b=()=>{S(!0)},O=G=>{a(G),S(!1)},_=async()=>{if(!r){Ne.warning("Выберите объект для оценки");return}A(!0);try{await new Promise(D=>setTimeout(D,2e3));const G=I(r),z=localStorage.getItem("appraisalResults"),C=z?JSON.parse(z):[];C.push(G),localStorage.setItem("appraisalResults",JSON.stringify(C)),u(D=>[...D,{...G,key:G.id}]),Ne.success("Оценка выполнена успешно"),a(null)}catch(G){console.error("Ошибка оценки:",G),Ne.error("Ошибка выполнения оценки")}finally{A(!1)}},U=async()=>{if(!r){Ne.warning("Выберите объект для оценки");return}f(!0);try{const G=R(r),z=r.characteristics?Object.entries(r.characteristics).slice(0,5).map(([W,Ae])=>`${W}: ${Ae}`).join("; "):void 0,C=await jy.generateEstimate({objectName:r.name,assetGroup:G,assetType:r.collateralType||r.type,location:r.address,area:r.area,purpose:'Экспресс-оценка в модуле "Оценка"',additionalFactors:z,card:null}),D=L(C,r),j=localStorage.getItem("appraisalResults"),K=j?JSON.parse(j):[];K.push(D),localStorage.setItem("appraisalResults",JSON.stringify(K)),u(W=>[...W,{...D,key:D.id}]),r.type==="collateral"&&qh.add({cardId:r.id,objectId:r.id,objectName:r.name,estimate:C,input:{objectName:r.name,assetGroup:G,assetType:r.collateralType||r.type,location:r.address,area:r.area,card:null,purpose:"Экспресс-оценка",additionalFactors:z}}),Ne.success("AI помощник выполнил оценку объекта")}catch(G){console.error("Ошибка AI оценки:",G),Ne.error("Не удалось выполнить AI оценку")}finally{f(!1)}},I=G=>{var Ae,ue,he;const z=G.area||100,C=1e5;let D=1;(Ae=G.collateralType)!=null&&Ae.includes("Офис")&&(D=1.2),(ue=G.collateralType)!=null&&ue.includes("Склад")&&(D=.8),(he=G.collateralType)!=null&&he.includes("Торгов")&&(D=1.5);const j=Math.round(z*C*D),K=Math.round(j*.7),W=Math.round(j*.85);return{id:`appraisal-${Date.now()}`,requestId:`request-${Date.now()}`,objectId:G.id,objectType:G.type,marketValue:j,collateralValue:K,fairValue:W,appraisalMethod:"Сравнительный подход (база данных аналогов в разработке)",comparableObjectsCount:0,confidenceLevel:"medium",details:"Автоматическая оценка выполнена на основе характеристик объекта. База данных аналогичных объектов находится в разработке.",notes:"Оценка выполнена автоматически. Требуется проверка оценщиком.",appraisedAt:We().format("YYYY-MM-DD HH:mm:ss"),status:"draft"}},R=G=>{const z=(G.collateralType||"").toLowerCase();if(z.includes("зем"))return"land";if(z.includes("недвиж")||z.includes("офис")||z.includes("склад")||z.includes("торгов"))return"real_estate";if(z.includes("акци")||z.includes("дол"))return"equity";if(z.includes("прав")||z.includes("интеллект"))return"rights";if(z.includes("товар")||z.includes("урож"))return"metals_goods";if(z.includes("транспорт")||z.includes("оборуд")||z.includes("техника"))return"movable";switch(G.type){case"collateral":return"real_estate";case"conclusion":return"real_estate";case"portfolio":return"real_estate";default:return"movable"}},L=(G,z)=>{var C;return{id:`ai-appraisal-${Date.now()}`,requestId:`ai-${Date.now()}`,objectId:z.id,objectType:z.type,marketValue:G.marketValue,collateralValue:G.collateralValue,fairValue:Math.round(G.marketValue*.9),appraisalMethod:G.methodology,comparableObjectsCount:((C=G.comparables)==null?void 0:C.length)||0,confidenceLevel:G.confidence,details:G.summary,notes:`Риски: ${G.riskFactors.join("; ")||"—"}. Рекомендации: ${G.recommendedActions.join("; ")||"—"}`,appraisedAt:We().format("YYYY-MM-DD HH:mm:ss"),status:"draft"}},N=G=>{y(G),E(!0)},P=G=>{switch(G){case"approved":return"green";case"rejected":return"red";case"draft":return"orange";default:return"default"}},Q=G=>{switch(G){case"approved":return s.jsx(yn,{});case"rejected":return s.jsx(Jl,{});case"draft":return s.jsx(Vn,{});default:return null}},Y=G=>{switch(G){case"collateral":return"Объект залога";case"conclusion":return"Залоговое заключение";case"portfolio":return"Договор из портфеля";default:return G}},ee=[{title:"Объект",key:"object",width:200,render:(G,z)=>{const C=n.find(D=>D.id===z.objectId);return s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsx(cd,{strong:!0,children:(C==null?void 0:C.name)||"Неизвестный объект"}),s.jsx(Ze,{children:Y(z.objectType)})]})}},{title:"REFERENCE",dataIndex:"objectId",key:"reference",width:120,render:(G,z)=>{const C=n.find(D=>D.id===z.objectId);return C!=null&&C.reference?String(C.reference):"—"}},{title:"Рыночная стоимость",dataIndex:"marketValue",key:"marketValue",width:150,render:G=>G?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(G):"—"},{title:"Залоговая стоимость",dataIndex:"collateralValue",key:"collateralValue",width:150,render:G=>G?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(G):"—"},{title:"Метод",dataIndex:"appraisalMethod",key:"appraisalMethod",width:200,ellipsis:!0},{title:"Уверенность",dataIndex:"confidenceLevel",key:"confidenceLevel",width:120,render:G=>{const z={high:"green",medium:"orange",low:"red"},C={high:"Высокая",medium:"Средняя",low:"Низкая"};return s.jsx(Ze,{color:z[G],children:C[G]})}},{title:"Статус",dataIndex:"status",key:"status",width:120,render:G=>{const z={draft:"Черновик",approved:"Утверждено",rejected:"Отклонено"};return s.jsx(Ze,{color:P(G),icon:Q(G),children:z[G]})}},{title:"Дата оценки",dataIndex:"appraisedAt",key:"appraisedAt",width:150,render:G=>We(G).format("DD.MM.YYYY HH:mm")},{title:"Действия",key:"actions",width:100,fixed:"right",render:(G,z)=>s.jsx(Kr,{title:"Просмотр",children:s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>N(z)})})}];return s.jsxs("div",{className:"appraisal-page",children:[s.jsx("div",{className:"appraisal-page__header",children:s.jsxs("div",{children:[s.jsx(zE,{level:2,className:"appraisal-page__title",children:"Модуль оценки"}),s.jsx(ht.Paragraph,{className:"appraisal-page__subtitle",children:"Автоматическая оценка объектов залога на основе базы данных аналогичных объектов"})]})}),s.jsx(Ue,{children:s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(cd,{strong:!0,style:{marginRight:16},children:"Выберите тип объекта:"}),s.jsxs(Ho.Group,{value:e,onChange:G=>{t(G.target.value),a(null)},children:[s.jsxs(Ho.Button,{value:"collateral",children:[s.jsx(el,{})," Объекты залога"]}),s.jsxs(Ho.Button,{value:"conclusion",children:[s.jsx(jr,{})," Залоговые заключения"]}),s.jsxs(Ho.Button,{value:"portfolio",children:[s.jsx(pb,{})," Договоры из портфеля"]})]})]}),s.jsxs(Te,{style:{width:"100%"},direction:"vertical",children:[s.jsx(cd,{strong:!0,children:"Выбранный объект:"}),r?s.jsx(Ue,{size:"small",style:{backgroundColor:"#f0f9ff"},children:s.jsxs(Te,{direction:"vertical",size:"small",style:{width:"100%"},children:[s.jsx(cd,{strong:!0,children:r.name}),s.jsxs(Te,{children:[s.jsx(Ze,{children:Y(r.type)}),r.reference&&s.jsxs(Ze,{children:["REF: ",r.reference]}),r.contractNumber&&s.jsxs(Ze,{children:["Договор: ",r.contractNumber]})]}),r.address&&s.jsx(cd,{type:"secondary",style:{fontSize:"12px"},children:r.address}),r.area&&s.jsxs(cd,{type:"secondary",style:{fontSize:"12px"},children:["Площадь: ",r.area," ","кв.м"]})]})}):s.jsx(Sr,{description:"Объект не выбран",image:Sr.PRESENTED_IMAGE_SIMPLE}),s.jsxs(Te,{children:[s.jsx(Be,{type:"primary",onClick:b,icon:s.jsx(Pa,{}),children:"Выбрать объект"}),s.jsx(Be,{type:"primary",onClick:_,icon:s.jsx(Ml,{}),loading:c,disabled:!r,children:"Выполнить оценку"}),s.jsx(Be,{type:"default",onClick:U,icon:s.jsx(Cf,{}),loading:d,disabled:!r,children:"Оценка ИИ"})]})]})]})}),s.jsx(Nr,{message:"База данных аналогичных объектов",description:"База данных аналогичных объектов находится в разработке. В настоящее время оценка выполняется на основе базовых алгоритмов. После внедрения базы данных оценка будет выполняться на основе реальных данных об аналогичных объектах.",type:"info",showIcon:!0,style:{marginTop:16,marginBottom:16}}),s.jsxs(Ue,{children:[s.jsx(zE,{level:4,children:"История оценок"}),s.jsx(ir,{columns:ee,dataSource:p,pagination:{pageSize:15,showSizeChanger:!0},scroll:{x:1200},loading:o,locale:{emptyText:s.jsx(Sr,{description:"Нет выполненных оценок"})}})]}),s.jsxs(cr,{title:`Выбор объекта: ${Y(e)}`,open:k,onCancel:()=>S(!1),footer:null,width:800,children:[s.jsx(Re,{placeholder:"Поиск по названию, REFERENCE, договору, адресу",prefix:s.jsx(Pa,{}),value:g,onChange:G=>h(G.target.value),style:{marginBottom:16}}),s.jsx(ir,{dataSource:B,rowKey:"id",pagination:{pageSize:10},size:"small",onRow:G=>({onClick:()=>O(G),style:{cursor:"pointer"}}),columns:[{title:"Название",dataIndex:"name",key:"name",ellipsis:!0},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:G=>G||"—"},{title:"Тип",dataIndex:"collateralType",key:"collateralType",width:150,ellipsis:!0},{title:"Адрес",dataIndex:"address",key:"address",ellipsis:!0}]})]}),s.jsx(cr,{title:"Результат оценки",open:v,onCancel:()=>E(!1),footer:[s.jsx(Be,{onClick:()=>E(!1),children:"Закрыть"},"close")],width:700,children:x&&s.jsx(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Объект",span:2,children:((V=n.find(G=>G.id===x.objectId))==null?void 0:V.name)||"Неизвестный объект"}),s.jsx(ye.Item,{label:"Тип объекта",children:Y(x.objectType)}),s.jsx(ye.Item,{label:"Статус",children:s.jsx(Ze,{color:P(x.status),icon:Q(x.status),children:x.status==="draft"?"Черновик":x.status==="approved"?"Утверждено":"Отклонено"})}),s.jsx(ye.Item,{label:"Рыночная стоимость",span:1,children:x.marketValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(x.marketValue):"—"}),s.jsx(ye.Item,{label:"Залоговая стоимость",span:1,children:x.collateralValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(x.collateralValue):"—"}),s.jsx(ye.Item,{label:"Справедливая стоимость",span:1,children:x.fairValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(x.fairValue):"—"}),s.jsx(ye.Item,{label:"Уверенность",span:1,children:s.jsx(Ze,{color:x.confidenceLevel==="high"?"green":x.confidenceLevel==="medium"?"orange":"red",children:x.confidenceLevel==="high"?"Высокая":x.confidenceLevel==="medium"?"Средняя":"Низкая"})}),s.jsx(ye.Item,{label:"Метод оценки",span:2,children:x.appraisalMethod||"—"}),s.jsx(ye.Item,{label:"Количество аналогов",span:1,children:x.comparableObjectsCount??0}),s.jsx(ye.Item,{label:"Дата оценки",span:1,children:We(x.appraisedAt).format("DD.MM.YYYY HH:mm")}),x.details&&s.jsx(ye.Item,{label:"Детали",span:2,children:x.details}),x.notes&&s.jsx(ye.Item,{label:"Примечания",span:2,children:x.notes})]})})})]})},VE=()=>[{id:"egrn-1",serviceType:"encumbrance_removal",objectName:"Квартира",address:"ул. Колпакова, стр. 41А, кв. 73",cadastralNumber:"77:01:0001001:1234",reference:"REF-2021-001",contractNumber:"ДЗ-2021-001",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",encumbranceType:"ипотека",encumbranceNumber:"ИП-2020-001",encumbranceDate:"2020-05-15",removalReason:"Погашение кредита",status:"in_progress",submittedAt:"2021-09-10",employeeName:"Филиппова В. П.",participants:["Филиппова В. П."],createdAt:"2021-09-10",updatedAt:"2021-09-15"},{id:"egrn-2",serviceType:"mortgage_registration",objectName:"Квартира",address:"ул. Шаболовка, д. 4, кв. 10",cadastralNumber:"77:01:0001002:2345",reference:"REF-2021-002",contractNumber:"ДЗ-2021-002",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-002",mortgageContractDate:"2021-08-15",mortgageAmount:5e6,mortgageTerm:"20 лет",status:"in_progress",submittedAt:"2021-09-03",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Фоксин С. Е.","Иванов И. И."],createdAt:"2021-09-03",updatedAt:"2021-09-10"},{id:"egrn-3",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Мамина-Сибиряка, 58, корпус 1, помещение 301",cadastralNumber:"77:01:0001003:3456",reference:"REF-2021-003",contractNumber:"ДЗ-2021-003",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-003",mortgageContractDate:"2021-08-20",mortgageAmount:15e6,mortgageTerm:"15 лет",status:"in_progress",submittedAt:"2021-09-01",employeeName:"Хорошенько И. Г.",participants:["Коваленко С. Е.","Хорошенько И. Г.","Петров П. П."],createdAt:"2021-09-01",updatedAt:"2021-09-05"},{id:"egrn-4",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Сибиряков-Гвардейцев дом 61, здание 1, строение 8, комната 512/5",cadastralNumber:"77:01:0001004:4567",reference:"REF-2021-004",contractNumber:"ДЗ-2021-004",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-004",mortgageContractDate:"2021-08-10",mortgageAmount:8e6,mortgageTerm:"10 лет",status:"in_progress",submittedAt:"2021-08-22",employeeName:"Хорошенько И. Г.",participants:["Коваленко С. Е.","Хорошенько И. Г.","Сидоров С. С."],createdAt:"2021-08-22",updatedAt:"2021-08-25"},{id:"egrn-5",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Цирковая, здание 12, корпус 7, помещение 81",cadastralNumber:"77:01:0001005:5678",reference:"REF-2021-005",contractNumber:"ДЗ-2021-005",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-005",mortgageContractDate:"2021-07-15",mortgageAmount:12e6,mortgageTerm:"12 лет",status:"completed",submittedAt:"2021-08-22",completedAt:"2021-09-15",resultNumber:"77-77/2021-123456",resultDate:"2021-09-15",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Фоксин С. Е.","Кузнецов К. К."],createdAt:"2021-08-22",updatedAt:"2021-09-15"},{id:"egrn-6",serviceType:"mortgage_registration",objectName:"Квартира",address:"ул. Карла Либкнехта, 133, кв. 5",cadastralNumber:"77:01:0001006:6789",reference:"REF-2021-006",contractNumber:"ДЗ-2021-006",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-006",mortgageContractDate:"2021-07-20",mortgageAmount:6e6,mortgageTerm:"25 лет",status:"submitted",submittedAt:"2021-08-13",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Смирнов С. С."],createdAt:"2021-08-13",updatedAt:"2021-08-13"},{id:"egrn-extract-1",serviceType:"extract",objectName:"Квартира",address:"ул. Ленина, д. 10, кв. 25",cadastralNumber:"77:01:0002001:1001",reference:"REF-2021-101",contractNumber:"ДЗ-2021-101",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Для оценки залоговой стоимости",status:"completed",submittedAt:"2021-10-05",completedAt:"2021-10-12",resultNumber:"ВП-2021-001234",resultDate:"2021-10-12",cost:400,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Иванов И. И."],createdAt:"2021-10-05",updatedAt:"2021-10-12"},{id:"egrn-extract-2",serviceType:"extract",objectName:"Жилой дом",address:"ул. Пушкина, д. 5, стр. 1",cadastralNumber:"77:01:0002002:2002",reference:"REF-2021-102",contractNumber:"ДЗ-2021-102",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка кадастровых данных",status:"in_progress",submittedAt:"2021-10-08",cost:250,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Петров П. П."],createdAt:"2021-10-08",updatedAt:"2021-10-10"},{id:"egrn-extract-3",serviceType:"extract",objectName:"Офисное помещение",address:"ул. Тверская, д. 15, офис 301",cadastralNumber:"77:01:0002003:3003",reference:"REF-2021-103",contractNumber:"ДЗ-2021-103",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_rights",extractPurpose:"Проверка прав собственности",status:"completed",submittedAt:"2021-10-01",completedAt:"2021-10-08",resultNumber:"ВП-2021-001567",resultDate:"2021-10-08",cost:400,employeeName:"Филиппова В. П.",participants:["Филиппова В. П."],createdAt:"2021-10-01",updatedAt:"2021-10-08"},{id:"egrn-extract-4",serviceType:"extract",objectName:"Квартира",address:"пр-т Мира, д. 20, кв. 45",cadastralNumber:"77:01:0002004:4004",reference:"REF-2021-104",contractNumber:"ДЗ-2021-104",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"short",extractPurpose:"Краткая информация об объекте",status:"submitted",submittedAt:"2021-10-12",cost:200,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Сидоров С. С."],createdAt:"2021-10-12",updatedAt:"2021-10-12"},{id:"egrn-extract-5",serviceType:"extract",objectName:"Торговое помещение",address:"ул. Арбат, д. 30, помещение 15",cadastralNumber:"77:01:0002005:5005",reference:"REF-2021-105",contractNumber:"ДЗ-2021-105",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Полная выписка для сделки",status:"in_progress",submittedAt:"2021-10-10",cost:400,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Коваленко С. Е."],createdAt:"2021-10-10",updatedAt:"2021-10-11"},{id:"egrn-extract-6",serviceType:"extract",objectName:"Квартира",address:"ул. Садовая, д. 8, кв. 12",cadastralNumber:"77:01:0002006:6006",reference:"REF-2021-106",contractNumber:"ДЗ-2021-106",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка характеристик объекта",status:"completed",submittedAt:"2021-09-28",completedAt:"2021-10-05",resultNumber:"ВП-2021-001890",resultDate:"2021-10-05",cost:250,employeeName:"Филиппова В. П.",participants:["Филиппова В. П.","Кузнецов К. К."],createdAt:"2021-09-28",updatedAt:"2021-10-05"},{id:"egrn-extract-7",serviceType:"extract",objectName:"Складское помещение",address:"ул. Промышленная, д. 25, склад 3",cadastralNumber:"77:01:0002007:7007",reference:"REF-2021-107",contractNumber:"ДЗ-2021-107",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_rights",extractPurpose:"Проверка обременений",status:"draft",cost:400,employeeName:"Фокина С. А.",participants:["Фокина С. А."],createdAt:"2021-10-13",updatedAt:"2021-10-13"},{id:"egrn-extract-8",serviceType:"extract",objectName:"Квартира",address:"ул. Невский проспект, д. 50, кв. 78",cadastralNumber:"77:01:0002008:8008",reference:"REF-2021-108",contractNumber:"ДЗ-2021-108",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Для оформления ипотеки",status:"completed",submittedAt:"2021-09-25",completedAt:"2021-10-02",resultNumber:"ВП-2021-002123",resultDate:"2021-10-02",cost:400,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Смирнов С. С.","Иванов И. И."],createdAt:"2021-09-25",updatedAt:"2021-10-02"},{id:"egrn-extract-9",serviceType:"extract",objectName:"Офисное помещение",address:"ул. Красная площадь, д. 1, офис 100",cadastralNumber:"77:01:0002009:9009",reference:"REF-2021-109",contractNumber:"ДЗ-2021-109",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"short",extractPurpose:"Быстрая проверка объекта",status:"in_progress",submittedAt:"2021-10-11",cost:200,employeeName:"Филиппова В. П.",participants:["Филиппова В. П.","Петров П. П."],createdAt:"2021-10-11",updatedAt:"2021-10-12"},{id:"egrn-extract-10",serviceType:"extract",objectName:"Квартира",address:"ул. Гагарина, д. 12, кв. 33",cadastralNumber:"77:01:0002010:1010",reference:"REF-2021-110",contractNumber:"ДЗ-2021-110",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка кадастровой стоимости",status:"submitted",submittedAt:"2021-10-13",cost:250,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Коваленко С. Е."],createdAt:"2021-10-13",updatedAt:"2021-10-13"}],DV=()=>{try{const e=localStorage.getItem("egrnRequests");if(!e||JSON.parse(e).length===0){const t=VE();localStorage.setItem("egrnRequests",JSON.stringify(t)),console.log("✅ Демо-данные ЕГРН загружены")}else{const t=JSON.parse(e);if(!t.some(a=>a.serviceType==="extract")){const n=VE().filter(o=>o.serviceType==="extract"),i=[...t,...n];localStorage.setItem("egrnRequests",JSON.stringify(i)),console.log("✅ Демо-данные выписок ЕГРН добавлены")}}}catch(e){console.error("Ошибка загрузки демо-данных ЕГРН:",e)}},{Title:jV,Text:Ic}=ht,{Option:an}=Ve,{TextArea:D1}=Re,LV=()=>{const e=dc(),[t]=re.useForm(),[r,a]=M.useState("mortgage_registration"),[n,i]=M.useState([]),[o]=M.useState(!1),[l,c]=M.useState(""),[A,d]=M.useState(null),[f,p]=M.useState(null),[u,g]=M.useState(!1),[h,x]=M.useState(!1),y=M.useCallback((z,C,D)=>{p(null),t.resetFields(),t.setFieldsValue({serviceType:"extract",objectId:z,cadastralNumber:C,objectName:D,extractType:"about_object",applicantType:"legal",status:"draft"}),a("extract"),x(!0)},[t]);M.useEffect(()=>{(()=>{try{DV();const C=localStorage.getItem("egrnRequests");if(C){const D=JSON.parse(C);i(D.map((j,K)=>({...j,key:j.id||`egrn-${K}`})))}}catch(C){console.error("Ошибка загрузки данных ЕГРН:",C)}})()},[]),M.useEffect(()=>{const z=new URLSearchParams(e.search),C=z.get("objectId"),D=z.get("cadastralNumber"),j=z.get("objectName");C&&D&&(y(C,D,j||""),window.history.replaceState({},"",e.pathname))},[e.search,e.pathname,y]);const v=z=>{try{localStorage.setItem("egrnRequests",JSON.stringify(z)),i(z.map((C,D)=>({...C,key:C.id||`egrn-${D}`})))}catch(C){console.error("Ошибка сохранения данных ЕГРН:",C),Ne.error("Ошибка сохранения данных")}},E=M.useMemo(()=>{const z=l.trim().toLowerCase();return n.filter(C=>{var W,Ae,ue;const D=C.serviceType===r,j=!z||((W=C.objectName)==null?void 0:W.toLowerCase().includes(z))||String(C.reference||"").toLowerCase().includes(z)||((Ae=C.contractNumber)==null?void 0:Ae.toLowerCase().includes(z))||((ue=C.cadastralNumber)==null?void 0:ue.toLowerCase().includes(z)),K=!A||C.status===A;return D&&j&&K})},[n,r,l,A]),k=M.useMemo(()=>{const z=n.filter(K=>K.serviceType===r),C=z.filter(K=>K.status==="completed").length,D=z.filter(K=>K.status==="in_progress").length,j=z.filter(K=>K.status==="submitted").length;return{total:z.length,completed:C,inProgress:D,submitted:j}},[n,r]),S=()=>{p(null),t.resetFields(),t.setFieldsValue({serviceType:r,applicantType:"legal",status:"draft"}),x(!0)},B=z=>{p(z),t.setFieldsValue({...z,mortgageContractDate:z.mortgageContractDate?We(z.mortgageContractDate):null,encumbranceDate:z.encumbranceDate?We(z.encumbranceDate):null,submittedAt:z.submittedAt?We(z.submittedAt):null,completedAt:z.completedAt?We(z.completedAt):null,resultDate:z.resultDate?We(z.resultDate):null}),x(!0)},b=z=>{p(z),g(!0)},O=async z=>{try{const C={id:(f==null?void 0:f.id)||`egrn-${Date.now()}`,serviceType:r,objectId:z.objectId,reference:z.reference,contractNumber:z.contractNumber,objectName:z.objectName,cadastralNumber:z.cadastralNumber,address:z.address,applicantName:z.applicantName,applicantInn:z.applicantInn,applicantType:z.applicantType,mortgageContractNumber:z.mortgageContractNumber,mortgageContractDate:z.mortgageContractDate?z.mortgageContractDate.format("YYYY-MM-DD"):void 0,mortgageAmount:z.mortgageAmount,mortgageTerm:z.mortgageTerm,encumbranceType:z.encumbranceType,encumbranceNumber:z.encumbranceNumber,encumbranceDate:z.encumbranceDate?z.encumbranceDate.format("YYYY-MM-DD"):void 0,removalReason:z.removalReason,extractType:z.extractType,extractPurpose:z.extractPurpose,status:z.status||"draft",submittedAt:z.submittedAt?z.submittedAt.format("YYYY-MM-DD"):void 0,completedAt:z.completedAt?z.completedAt.format("YYYY-MM-DD"):void 0,resultDocument:z.resultDocument,resultNumber:z.resultNumber,resultDate:z.resultDate?z.resultDate.format("YYYY-MM-DD"):void 0,comments:z.comments,rejectionReason:z.rejectionReason,createdAt:(f==null?void 0:f.createdAt)||We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")},D=f?n.map(j=>j.id===f.id?C:j):[...n,C];v(D),Ne.success(f?"Запрос обновлен":"Запрос создан"),x(!1),t.resetFields()}catch(C){console.error("Ошибка сохранения:",C),Ne.error("Ошибка сохранения запроса")}},_=z=>{switch(z){case"completed":return"green";case"in_progress":return"blue";case"submitted":return"orange";case"rejected":return"red";case"draft":return"default";default:return"default"}},U=z=>{switch(z){case"completed":return s.jsx(yn,{});case"rejected":return s.jsx(Jl,{});default:return s.jsx(Vn,{})}},I=z=>({draft:"Черновик",submitted:"Подано",in_progress:"В работе",completed:"Завершено",rejected:"Отклонено"})[z],R=z=>{switch(z){case"mortgage_registration":return"Регистрация ДДУ";case"encumbrance_removal":return"Прекращение обременения";case"extract":return"Выписки ЕГРН";default:return z}},L=(z,C)=>z==="in_progress"?C==="mortgage_registration"?"В Росреестре":C==="encumbrance_removal"?"Подписание заявлений":C==="extract"?"В обработке":"Обрабатывается":z==="submitted"?C==="extract"?"Запрос отправлен":"Отправляем в Росреестр":z==="completed"?C==="extract"?"Выписка получена":"Сделка зарегистрирована":z==="rejected"?"Регистрация приостановлена":z==="draft"?"Черновик":"",N=(z,C)=>z==="in_progress"?C==="extract"?"Ожидание ответа":"Обрабатывается":z==="submitted"?C==="extract"?"Ожидание обработки":"":z==="rejected"?"Регистрация приостановлена":"",[P,Q]=M.useState({}),Y=z=>{Q(C=>({...C,[z]:!C[z]}))},ee=[{title:"Отправлено",dataIndex:"submittedAt",key:"submittedAt",width:120,render:z=>z?We(z).format("DD.MM.YYYY"):"—"},{title:"Адрес объекта",key:"address",width:300,render:(z,C)=>s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(Ic,{children:C.address||"—"}),s.jsx(Ic,{type:"secondary",style:{fontSize:"12px"},children:R(C.serviceType)})]})},{title:"Статус",dataIndex:"status",key:"status",width:250,render:(z,C)=>{const D=L(z,C.serviceType),j=N(z),K=_(z);return s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsxs(Te,{children:[s.jsx("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:K==="green"?"#52c41a":K==="orange"?"#fa8c16":K==="blue"?"#1890ff":K==="red"?"#ff4d4f":"#d9d9d9",display:"inline-block"}}),s.jsx(Ic,{children:D||I(z)})]}),j&&s.jsx(Ic,{type:"secondary",style:{fontSize:"12px",marginLeft:16},children:N(z,C.serviceType)}),z==="in_progress"&&C.serviceType==="encumbrance_removal"&&s.jsx(Ic,{type:"secondary",style:{fontSize:"12px",marginLeft:16},children:"Требуется подпись"})]})}},{title:"Сотрудник",dataIndex:"employeeName",key:"employeeName",width:180,render:z=>z||"—"},{title:"Участники",key:"participants",width:250,render:(z,C)=>{const D=C.participants||[],K=P[C.id]?D.length:2,W=D.slice(0,K),Ae=D.length-K;return D.length===0?s.jsx(Ic,{type:"secondary",children:"—"}):s.jsxs(Te,{direction:"vertical",size:0,children:[W.map((ue,he)=>s.jsx(Ic,{children:ue},he)),Ae>0&&s.jsxs(Be,{type:"link",size:"small",style:{padding:0,height:"auto",fontSize:"12px"},onClick:()=>Y(C.id),children:["ещё ",Ae]})]})}},{title:"Действия",key:"actions",width:100,fixed:"right",render:(z,C)=>s.jsx(Kr,{title:"Просмотр",children:s.jsx(Be,{type:"link",icon:s.jsx(Ii,{}),onClick:()=>b(C)})})}],V=[{key:"mortgage_registration",label:s.jsxs(Te,{children:[s.jsx(mh,{}),"Регистрация ипотеки"]})},{key:"encumbrance_removal",label:s.jsxs(Te,{children:[s.jsx(Fv,{}),"Снятие обременений"]})},{key:"extract",label:s.jsxs(Te,{children:[s.jsx(tf,{}),"Выписки ЕГРН"]})}],G=()=>r==="mortgage_registration"?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"mortgageContractNumber",label:"Номер договора ипотеки",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Номер договора"})}),s.jsx(re.Item,{name:"mortgageContractDate",label:"Дата договора ипотеки",rules:[{required:!0}],children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"mortgageAmount",label:"Сумма ипотеки, руб.",children:s.jsx(Re,{type:"number",placeholder:"Сумма"})}),s.jsx(re.Item,{name:"mortgageTerm",label:"Срок ипотеки",children:s.jsx(Re,{placeholder:"Срок"})})]}):r==="encumbrance_removal"?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"encumbranceType",label:"Тип обременения",rules:[{required:!0}],children:s.jsxs(Ve,{placeholder:"Выберите тип",children:[s.jsx(an,{value:"ипотека",children:"Ипотека"}),s.jsx(an,{value:"аренда",children:"Аренда"}),s.jsx(an,{value:"залог",children:"Залог"}),s.jsx(an,{value:"сервитут",children:"Сервитут"}),s.jsx(an,{value:"другое",children:"Другое"})]})}),s.jsx(re.Item,{name:"encumbranceNumber",label:"Номер обременения",children:s.jsx(Re,{placeholder:"Номер"})}),s.jsx(re.Item,{name:"encumbranceDate",label:"Дата регистрации обременения",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"removalReason",label:"Основание для снятия",rules:[{required:!0}],children:s.jsx(D1,{rows:3,placeholder:"Основание для снятия обременения"})})]}):r==="extract"?s.jsxs(s.Fragment,{children:[s.jsx(re.Item,{name:"extractType",label:"Тип выписки",rules:[{required:!0}],children:s.jsxs(Ve,{placeholder:"Выберите тип",children:[s.jsx(an,{value:"full",children:"Полная выписка"}),s.jsx(an,{value:"short",children:"Краткая выписка"}),s.jsx(an,{value:"about_object",children:"Выписка об объекте"}),s.jsx(an,{value:"about_rights",children:"Выписка о правах"})]})}),s.jsx(re.Item,{name:"extractPurpose",label:"Цель получения выписки",children:s.jsx(D1,{rows:2,placeholder:"Цель получения выписки"})})]}):null;return s.jsxs("div",{className:"egrn-page",children:[s.jsxs("div",{className:"egrn-page__header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[s.jsx(jV,{level:2,style:{margin:0},children:"Сделки"}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:S,style:{backgroundColor:"#722ed1",borderColor:"#722ed1"},children:"+ Создать сделку"})]}),s.jsx(Ue,{children:s.jsx(ri,{activeKey:r,onChange:z=>{a(z),d(null),c("")},items:V})}),s.jsxs(dt,{gutter:[16,16],className:"egrn-page__stats",children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего запросов",value:k.total})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Подано",value:k.submitted,valueStyle:{color:"#fa8c16"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"В работе",value:k.inProgress,valueStyle:{color:"#1890ff"}})})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Завершено",value:k.completed,valueStyle:{color:"#3f8600"}})})})]}),s.jsx(Ue,{children:s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsx(Re,{allowClear:!0,placeholder:"Поиск по объекту, REFERENCE, договору, кадастровому номеру",prefix:s.jsx(Pa,{}),value:l,onChange:z=>c(z.target.value),style:{width:"100%"}}),s.jsxs(Ve,{allowClear:!0,placeholder:"Статус",style:{width:150},value:A??void 0,onChange:z=>d(z??null),children:[s.jsx(an,{value:"draft",children:"Черновик"}),s.jsx(an,{value:"submitted",children:"Подано"}),s.jsx(an,{value:"in_progress",children:"В работе"}),s.jsx(an,{value:"completed",children:"Завершено"}),s.jsx(an,{value:"rejected",children:"Отклонено"})]})]})}),s.jsx(Ue,{bodyStyle:{padding:0},children:s.jsx(ir,{columns:ee,dataSource:E,pagination:{pageSize:15,showSizeChanger:!0},scroll:{x:1200},loading:o,locale:{emptyText:s.jsx(Sr,{description:"Нет регистраций"})},rowClassName:()=>"egrn-table-row",onRow:z=>({onClick:()=>b(z)})})}),s.jsx(cr,{title:s.jsxs(Te,{children:[(f==null?void 0:f.serviceType)==="extract"?s.jsx(tf,{}):(f==null?void 0:f.serviceType)==="encumbrance_removal"?s.jsx(Fv,{}):s.jsx(mh,{}),s.jsx("span",{children:f?R(f.serviceType):"Детали запроса"}),f&&s.jsx(Ze,{color:_(f.status),children:I(f.status)})]}),open:u,onCancel:()=>g(!1),footer:[s.jsx(Be,{icon:s.jsx(Rs,{}),onClick:()=>{f&&(B(f),g(!1))},children:"Редактировать"},"edit"),s.jsx(Be,{onClick:()=>g(!1),children:"Закрыть"},"close")],width:800,children:f&&s.jsxs(ye,{bordered:!0,column:2,size:"small",children:[s.jsx(ye.Item,{label:"Тип услуги",span:2,children:R(f.serviceType)}),s.jsx(ye.Item,{label:"Объект",span:2,children:f.objectName||"—"}),s.jsx(ye.Item,{label:"Адрес",span:2,children:f.address||"—"}),s.jsx(ye.Item,{label:"Кадастровый номер",children:f.cadastralNumber||"—"}),s.jsx(ye.Item,{label:"REFERENCE",children:f.reference||"—"}),s.jsx(ye.Item,{label:"Номер договора залога",children:f.contractNumber||"—"}),s.jsx(ye.Item,{label:"Дата отправки",children:f.submittedAt?We(f.submittedAt).format("DD.MM.YYYY"):"—"}),s.jsx(ye.Item,{label:"Сотрудник",children:f.employeeName||"—"}),s.jsx(ye.Item,{label:"Участники",span:2,children:f.participants&&f.participants.length>0?f.participants.join(", "):"—"}),s.jsx(ye.Item,{label:"Заявитель",span:2,children:f.applicantName||"—"}),s.jsx(ye.Item,{label:"ИНН заявителя",children:f.applicantInn||"—"}),s.jsx(ye.Item,{label:"Статус",children:s.jsx(Ze,{color:_(f.status),icon:U(f.status),children:I(f.status)})}),f.serviceType==="mortgage_registration"&&s.jsxs(s.Fragment,{children:[s.jsx(ye.Item,{label:"Номер договора ипотеки",children:f.mortgageContractNumber||"—"}),s.jsx(ye.Item,{label:"Дата договора",children:f.mortgageContractDate?We(f.mortgageContractDate).format("DD.MM.YYYY"):"—"}),s.jsx(ye.Item,{label:"Сумма ипотеки",children:f.mortgageAmount?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(f.mortgageAmount):"—"}),s.jsx(ye.Item,{label:"Срок ипотеки",children:f.mortgageTerm||"—"})]}),f.serviceType==="encumbrance_removal"&&s.jsxs(s.Fragment,{children:[s.jsx(ye.Item,{label:"Тип обременения",children:f.encumbranceType||"—"}),s.jsx(ye.Item,{label:"Номер обременения",children:f.encumbranceNumber||"—"}),s.jsx(ye.Item,{label:"Дата регистрации",children:f.encumbranceDate?We(f.encumbranceDate).format("DD.MM.YYYY"):"—"}),s.jsx(ye.Item,{label:"Основание для снятия",span:2,children:f.removalReason||"—"})]}),f.serviceType==="extract"&&s.jsxs(s.Fragment,{children:[s.jsx(ye.Item,{label:"Тип выписки",children:f.extractType==="full"?"Полная выписка":f.extractType==="short"?"Краткая выписка":f.extractType==="about_object"?"Выписка об объекте":f.extractType==="about_rights"?"Выписка о правах":"—"}),s.jsx(ye.Item,{label:"Цель получения",children:f.extractPurpose||"—"}),f.cost&&s.jsx(ye.Item,{label:"Стоимость",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(f.cost)}),f.completedAt&&s.jsx(ye.Item,{label:"Дата получения",children:We(f.completedAt).format("DD.MM.YYYY")})]}),f.resultNumber&&s.jsx(ye.Item,{label:f.serviceType==="extract"?"Номер выписки":"Номер результата",children:f.resultNumber}),f.resultDate&&s.jsx(ye.Item,{label:f.serviceType==="extract"?"Дата выписки":"Дата результата",children:We(f.resultDate).format("DD.MM.YYYY")}),f.resultDocument&&s.jsx(ye.Item,{label:"Документ",span:2,children:s.jsx(Be,{type:"link",icon:s.jsx(tf,{}),onClick:()=>{Ne.info("Скачивание документа...")},children:"Скачать документ"})}),f.comments&&s.jsx(ye.Item,{label:"Комментарии",span:2,children:f.comments})]})}),s.jsx(B2,{title:f?"Редактировать запрос":`Создать запрос: ${R(r)}`,open:h,onClose:()=>{x(!1),t.resetFields()},width:600,children:s.jsxs(re,{form:t,layout:"vertical",onFinish:O,initialValues:{serviceType:r,applicantType:"legal",status:"draft"},children:[s.jsx(re.Item,{name:"serviceType",hidden:!0,children:s.jsx(Re,{})}),s.jsx(re.Item,{name:"objectName",label:"Наименование объекта",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Наименование объекта"})}),s.jsx(re.Item,{name:"cadastralNumber",label:"Кадастровый номер",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"23:49:0303008:1915"})}),s.jsx(re.Item,{name:"address",label:"Адрес",children:s.jsx(Re,{placeholder:"Адрес объекта"})}),s.jsx(re.Item,{name:"reference",label:"REFERENCE",children:s.jsx(Re,{placeholder:"REFERENCE сделки"})}),s.jsx(re.Item,{name:"contractNumber",label:"Номер договора залога",children:s.jsx(Re,{placeholder:"Номер договора"})}),s.jsx(re.Item,{name:"applicantType",label:"Тип заявителя",children:s.jsxs(Ho.Group,{children:[s.jsx(Ho,{value:"legal",children:"Юридическое лицо"}),s.jsx(Ho,{value:"individual",children:"Физическое лицо"})]})}),s.jsx(re.Item,{name:"applicantName",label:"Наименование заявителя",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Наименование"})}),s.jsx(re.Item,{name:"applicantInn",label:"ИНН заявителя",children:s.jsx(Re,{placeholder:"ИНН"})}),G(),s.jsx(re.Item,{name:"status",label:"Статус",children:s.jsxs(Ve,{children:[s.jsx(an,{value:"draft",children:"Черновик"}),s.jsx(an,{value:"submitted",children:"Подано"}),s.jsx(an,{value:"in_progress",children:"В работе"}),s.jsx(an,{value:"completed",children:"Завершено"}),s.jsx(an,{value:"rejected",children:"Отклонено"})]})}),s.jsx(re.Item,{name:"submittedAt",label:"Дата подачи",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"completedAt",label:"Дата завершения",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"resultNumber",label:"Номер результата",children:s.jsx(Re,{placeholder:"Номер выписки/регистрации"})}),s.jsx(re.Item,{name:"resultDate",label:"Дата результата",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),s.jsx(re.Item,{name:"comments",label:"Комментарии",children:s.jsx(D1,{rows:3,placeholder:"Комментарии"})}),s.jsx(re.Item,{children:s.jsxs(Te,{children:[s.jsx(Be,{type:"primary",htmlType:"submit",children:f?"Сохранить":"Создать"}),s.jsx(Be,{onClick:()=>{x(!1),t.resetFields()},children:"Отмена"})]})})]})})]})},Pc={"Подготовка СЗ":6,"Подготовка СЗ (2 объекта)":7,"Подготовка СЗ (АЗС)":24,Оценка:8,Экспертиза:6,Рецензия:4,ПРКК:4,Мониторинг:2,Осмотр:3,"Проверка документов":2,Согласование:2,"Контроль качества":3,Отчетность:4,Прочее:2},b2=8,bS=22,Xl=b2*bS;function UV(e){const t=e.type||"Прочее";let r=null;try{const a=localStorage.getItem("normHoursSettings");a&&(r=JSON.parse(a))}catch{}if(t==="Подготовка СЗ"){const a=(e.title||"").toLowerCase(),n=(e.description||"").toLowerCase();return a.includes("азс")||n.includes("азс")?(r==null?void 0:r["Подготовка СЗ (АЗС)"])||Pc["Подготовка СЗ (АЗС)"]:(r==null?void 0:r["Подготовка СЗ"])||Pc["Подготовка СЗ"]}return(r==null?void 0:r[t])||Pc[t]||Pc.Прочее}function Yy(e){return e.reduce((t,r)=>t+UV(r),0)}function Wy(e,t=Xl){const a=Yy(e)/t*100;return Math.min(Math.round(a*10)/10,150)}function j1(e,t,r,a=Xl){const n=e.filter(l=>{const c=(l.status||"").toString();if(c==="completed"||c==="Выполнено"||c==="done"||c==="approved"||c==="created"||!["assigned","in_progress","in-progress","review","rework","paused","approval"].includes(c))return!1;const f=We(l.createdAt||l.updatedAt);return f.isAfter(t.subtract(1,"day"))&&f.isBefore(r.add(1,"day"))}),i=Yy(n),o=Wy(n,a);return{totalNormHours:i,workloadPercent:o,tasksCount:n.length}}function _S(e,t,r,a){const n=t.filter(u=>u.isActive&&u.status!=="sick_leave"&&u.status!=="vacation"&&u.status!=="business_trip"&&(!u.status||u.status==="working")),i=e.filter(u=>{const g=(u.region||"").toString();return a.includes(g)||g===r}),o=new Set(n.map(u=>u.email).filter(Boolean)),l=i.filter(u=>{const g=(u.status||"").toString();return g==="completed"||g==="Выполнено"||g==="done"||g==="approved"||g==="created"||!(u.currentAssignee&&o.has(u.currentAssignee)||Array.isArray(u.assignedTo)&&u.assignedTo.some(y=>o.has(y))||u.employeeId&&n.some(y=>y.id===u.employeeId))?!1:["assigned","in_progress","in-progress","review","rework","paused","approval"].includes(g)}),c=Yy(l),A=n.length;if(A===0)return{totalNormHours:0,workloadPercent:0,tasksCount:0,workingEmployeesCount:0};const f=c/A/Xl*100;let p=Math.round(f*10)/10;return l.length===0||p<85?p=85:p>125&&(p=125),{totalNormHours:c,workloadPercent:p,tasksCount:l.length,workingEmployeesCount:A}}const Xy="kpiMetricsOverrides",CS="kpiMetricsLatest",Jy="kpiCenterMboOverrides",_2={totalPortfolioValue:0,totalContracts:0,activeContracts:0,completedTasks:0,pendingTasks:0,overdueTasks:0,totalConclusions:0,approvedConclusions:0,pendingConclusions:0,totalObjects:0,totalInsurance:0,activeInsurance:0,averageConclusionDays:0,slaCompliance:0,currentWorkload:0,mboCompletionOverall:0,workloadByPeriod:{last7Days:0,last30Days:0,last90Days:0}},rm=(e=_2)=>({...e,workloadByPeriod:{...e.workloadByPeriod}}),BS=()=>{try{const e=localStorage.getItem(Xy);return e?JSON.parse(e):null}catch(e){return console.warn("Не удалось загрузить корректировки KPI:",e),null}},MV=e=>{try{localStorage.setItem(Xy,JSON.stringify(e))}catch(t){console.error("Не удалось сохранить корректировки KPI:",t)}},PV=()=>{try{localStorage.removeItem(Xy)}catch(e){console.warn("Не удалось удалить корректировки KPI:",e)}},SS=()=>{try{const e=localStorage.getItem(Jy);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch(e){return console.warn("Не удалось загрузить корректировки MBO по центрам:",e),{}}},QV=e=>{try{localStorage.setItem(Jy,JSON.stringify(e))}catch(t){console.error("Не удалось сохранить корректировки MBO по центрам:",t)}},qV=()=>{try{localStorage.removeItem(Jy)}catch(e){console.warn("Не удалось удалить корректировки MBO по центрам:",e)}},KV=()=>{try{const e=localStorage.getItem(CS);if(!e)return null;const t=JSON.parse(e);return!t||typeof t!="object"?null:{...rm(_2),...t,workloadByPeriod:{..._2.workloadByPeriod,...t.workloadByPeriod||{}}}}catch(e){return console.warn("Не удалось загрузить последние метрики KPI:",e),null}},HV=e=>{try{localStorage.setItem(CS,JSON.stringify(e))}catch(t){console.warn("Не удалось сохранить последние метрики KPI:",t)}},TS=(e,t=BS())=>t?{...e,...t,workloadByPeriod:{...e.workloadByPeriod,...t.workloadByPeriod||{}}}:e,{Title:Ad,Text:dr}=ht,{RangePicker:GV}=Dr,OS=[{key:"month",label:"Работник месяца",days:30,icon:s.jsx(XT,{style:{color:"#faad14"}}),color:"#faad14"},{key:"quarter",label:"Работник квартала",days:90,icon:s.jsx(bd,{style:{color:"#1677ff"}}),color:"#1677ff"},{key:"year",label:"Работник года",days:365,icon:s.jsx(JT,{style:{color:"#722ed1"}}),color:"#722ed1"}],Ld=e=>`${e.lastName} ${e.firstName} ${e.middleName||""}`.trim(),zV=(e,t)=>(e||t||"Москва").trim(),Zy=(e,t)=>{if(!e.isValid()||!t.isValid())return 0;let r=0,a=e.clone();for(;a.isBefore(t)||a.isSame(t,"day");){const n=a.day();n!==0&&n!==6&&r++,a=a.add(1,"day")}return r},Zo=e=>{const t=(e||"").toString();return t==="completed"||t==="Выполнено"||t==="done"||t==="approved"},ev=e=>{const t=(e||"").toString();return["pending","created","assigned","in_progress","in-progress","review","approval","rework","paused"].includes(t)},Ud=e=>{const t=(e.status||"").toString();if(!ev(t))return!1;if(!e.dueDate)return!0;const r=We(e.dueDate);return r.isAfter(We(),"day")||r.isSame(We(),"day")},Md=e=>{const t=(e.status||"").toString();return Zo(t)||!e.dueDate?!1:We(e.dueDate).isBefore(We(),"day")},Qc=e=>Number.isFinite(e)?Math.max(85,Math.min(125,Math.round(e*10)/10)):85,L1=e=>{const t=Math.random()*10-5;return Qc(e+t)},$E=e=>{if(!e)return We();const t=We(e,["DD.MM.YYYY","YYYY-MM-DD"],!0);return t.isValid()?t:We(e)},YE=(e,t,r)=>e.map((a,n)=>{var E;const i=$E(a.plannedDate),o=i.isValid()?i:We().add(7,"day"),l=$E("lastMonitoringDate"in a?a.lastMonitoringDate:a.lastRevaluationDate).subtract(5,"day"),A=a.timeframe==="overdue"?"in_progress":a.timeframe==="week"?"assigned":a.timeframe==="month"?"approval":"assigned",d=a.timeframe==="overdue"||a.timeframe==="week"?"high":a.timeframe==="month"?"medium":"low",f=(E=a.owner)==null?void 0:E.trim(),p=f?r.find(k=>Ld(k).toLowerCase()===f.toLowerCase()):void 0,u=p!=null&&p.email?[p.email]:[],g=t==="monitoring"?"monitoring@cmsauto.ru":"revaluation@cmsauto.ru",h=t==="monitoring"?"План мониторинга":"План переоценок",x=t==="monitoring"?"Мониторинг":"Оценка",y=t==="monitoring"?"План мониторинга":"План переоценок",v=zV(a.city,a.regionCenterName||a.regionCenterCode||void 0);return{id:`PLAN-${t}-${a.reference||"ref"}-${n}-${Math.random().toString(36).slice(2,7)}`,region:v,type:x,title:`${t==="monitoring"?"Мониторинг":"Переоценка"} ${a.reference||""}`.trim(),description:t==="monitoring"?`Плановый мониторинг обеспечения (${a.baseType})`:`Плановая переоценка обеспечения (${a.baseType})`,priority:d,dueDate:o.format("YYYY-MM-DD"),status:A,businessUser:g,businessUserName:h,assignedTo:u,currentAssignee:(p==null?void 0:p.email)||null,currentAssigneeName:p?Ld(p):a.owner||null,employeeId:p==null?void 0:p.id,documents:[],comments:[],createdAt:l.format("YYYY-MM-DD"),updatedAt:We().toISOString(),history:[{date:l.toISOString(),user:h,userRole:"system",action:"Создана плановая задача",status:"created"},{date:o.toISOString(),user:p?Ld(p):a.owner||h,userRole:"employee",action:"Назначена в план работ",status:A}],category:y}}),VV=(e,t,r)=>Xs.map(a=>{const n=e.filter(u=>a.cities.includes(u.region)||u.region===a.code||a.name.includes(u.region)),i=a.cities.map(u=>{const g=n.filter(B=>B.region===u),x=t.filter(B=>B.region===u).map(B=>{const b=g.filter(L=>L.employeeId===B.id||L.currentAssigneeName===Ld(B)),O=b.filter(L=>Zo(L.status)).length,_=b.filter(L=>Ud(L)).length,U=b.filter(L=>Md(L)).length,I=b.length,R=I>0?Math.round(O/I*100):0;return{employeeId:B.id,totalTasks:I,completedTasks:O,inProgressTasks:_,overdueTasks:U,completionRate:R}}),y=g.length,v=g.filter(B=>Zo(B.status)).length,E=g.filter(B=>Ud(B)).length,k=g.filter(B=>Md(B)).length,S=y>0?Math.round(v/y*100):0;return{city:u,totalTasks:y,completedTasks:v,inProgressTasks:E,overdueTasks:k,completionRate:S,employees:x}}),o=n.length,l=n.filter(u=>Zo(u.status)).length,c=n.filter(u=>Ud(u)).length,A=n.filter(u=>Md(u)).length,d=o>0?Math.round(l/o*100):0,f=o>0?Math.round(l/o*100):0,p=typeof r[a.code]=="number"?r[a.code]:f;return{code:a.code,name:a.name,totalTasks:o,completedTasks:l,inProgressTasks:c,overdueTasks:A,completionRate:d,mboCompletion:p,cities:i}}),$V=(e,t)=>{const r={month:null,quarter:null,year:null},a=We();return OS.forEach(n=>{const i=a.subtract(n.days,"day"),o=e.filter(A=>We(A.createdAt||A.updatedAt).isAfter(i)),l=t.filter(A=>A.isActive&&(!A.status||A.status==="working")).map(A=>{const d=Ld(A),f=o.filter(y=>y.employeeId===A.id||y.currentAssigneeName===d);if(f.length===0)return null;const p=f.filter(y=>ev(y.status)),u=Wy(p),g=f.filter(y=>Zo(y.status)&&y.completedAt&&y.createdAt);if(g.length===0)return null;const h=g.map(y=>Zy(We(y.createdAt),We(y.completedAt))),x=h.length>0?Math.round(h.filter(y=>y<=7).length/h.length*100):0;return{employee:A,name:d,region:A.region,workload:Qc(u),slaSuccess:Math.min(x,100),completedCount:g.length}}).filter(Boolean);if(l.length===0){r[n.key]=null;return}l.sort((A,d)=>d.workload!==A.workload?d.workload-A.workload:d.slaSuccess!==A.slaSuccess?d.slaSuccess-A.slaSuccess:d.completedCount-A.completedCount);const c=l[0];r[n.key]={title:n.label,employeeName:c.name,region:c.region,workload:c.workload,slaSuccess:c.slaSuccess}}),r},YV=(e,t)=>!e.length||!t.length?[]:t.filter(a=>a.isActive&&(!a.status||a.status==="working")).map(a=>{const n=Ld(a),i=e.filter(g=>g.employeeId===a.id||g.currentAssigneeName===n||a.email&&(g.currentAssignee===a.email||Array.isArray(g.assignedTo)&&g.assignedTo.includes(a.email)));if(i.length===0)return null;const o=i.filter(g=>{const h=(g.status||"").toString();return!(!ev(h)||h==="created")}),l=Qc(Wy(o)),c=i.filter(g=>Zo(g.status)).length,A=i.filter(g=>Ud(g)).length,d=i.filter(g=>Md(g)).length,p=i.filter(g=>Zo(g.status)&&g.createdAt&&(g.completedAt||g.updatedAt)).map(g=>Zy(We(g.createdAt),We(g.completedAt||g.updatedAt))),u=p.length>0?Math.round(p.filter(g=>g<=7).length/p.length*100):100;return{key:a.id,name:n,region:a.region,workload:l,slaSuccess:Math.min(u,100),completed:c,inProgress:A,overdue:d}}).filter(Boolean).sort((a,n)=>n.workload!==a.workload?n.workload-a.workload:n.slaSuccess!==a.slaSuccess?n.slaSuccess-a.slaSuccess:n.completed!==a.completed?n.completed-a.completed:a.overdue-n.overdue).slice(0,10),WV=()=>{var I;const[e,t]=M.useState(!0),[r,a]=M.useState(()=>rm()),[n,i]=M.useState([We().subtract(30,"day"),We()]),[o,l]=M.useState("30days"),[c,A]=M.useState([]),[d,f]=M.useState(null),[p,u]=M.useState(null),[g,h]=M.useState(!1),[x,y]=M.useState([]),[v,E]=M.useState([]),[k,S]=M.useState({month:null,quarter:null,year:null});M.useEffect(()=>{(async()=>{t(!0);try{const[L,N,P]=await Promise.all([fetch("/portfolioData.json").then(vt=>vt.json()).catch(()=>[]),fetch("/collateralConclusionsData.json").then(vt=>vt.json()).catch(()=>[]),fetch("/insuranceData.json").then(vt=>vt.json()).catch(()=>[])]),Q=await kt.getExtendedCards(),Y=wS(Q),ee=ES(Q);let V=[];try{V=await kt.getTasks()}catch{try{const Or=localStorage.getItem("zadachnik_tasks");Or&&(V=JSON.parse(Or))}catch(Or){console.warn("Не удалось загрузить задачи:",Or)}}let G=pr.getEmployees();(!G||G.length===0)&&(G=pr.getEmployees()),E(G);const z=G.filter(vt=>vt.isActive),D=z.length*60;if(!V||V.length===0||V.length<D)try{const{generateTasksForEmployees:vt}=await ps(async()=>{const{generateTasksForEmployees:Or}=await Promise.resolve().then(()=>NS);return{generateTasksForEmployees:Or}},void 0);await vt(),V=await kt.getTasks(),console.log(`✅ Сгенерировано ${V.length} задач для ${z.length} активных сотрудников`)}catch(vt){console.warn("Не удалось сгенерировать задачи:",vt)}const j=YE(Y,"monitoring",G),K=YE(ee,"revaluation",G),W=[...V,...j,...K];y(W);const Ae=L.reduce((vt,Or)=>vt+(parseFloat(Or.collateralValue)||0),0),ue=L.length,he=L.filter(vt=>vt.status==="active"||vt.status==="Активный").length,ve=W.length,we=W.filter(vt=>Zo(vt.status)).length,se=W.filter(vt=>Ud(vt)).length,He=W.filter(vt=>Md(vt)).length,Ee=N.length,pe=N.filter(vt=>vt.status==="Согласовано").length,ce=N.filter(vt=>vt.status==="На согласовании"||vt.status==="Черновик").length,Ge=Q.length,et=P.length,Ye=P.filter(vt=>vt.status==="active"||vt.status==="Активный").length,tt=N.filter(vt=>vt.status==="Согласовано"&&vt.authorDate&&(vt.approvalDate||vt.conclusionDate));let je=0,_e=0;if(tt.length>0){const vt=[];if(tt.forEach(Or=>{const nr=We(Or.authorDate),cn=We(Or.approvalDate||Or.conclusionDate);if(nr.isValid()&&cn.isValid()&&cn.isAfter(nr)){const Lr=Zy(nr,cn);vt.push(Lr)}}),vt.length>0){je=Math.round(vt.reduce((nr,cn)=>nr+cn,0)/vt.length*10)/10;const Or=vt.filter(nr=>nr<=7).length;_e=Math.round(Or/vt.length*100)}}const At=Xs.map(vt=>_S(W,G,vt.code,vt.cities)),Ct=At.length>0?At.reduce((vt,Or)=>vt+Or.workloadPercent,0)/At.length:85,_t=Qc(Ct||85),Et=We(),Pt=j1(W,Et.subtract(7,"day"),Et,Xl),Lt=j1(W,Et.subtract(30,"day"),Et,Xl),Bt=j1(W,Et.subtract(90,"day"),Et,Xl),ut=Pt.tasksCount===0?L1(_t):Qc(Pt.workloadPercent),ct=Lt.tasksCount===0?L1(_t):Qc(Lt.workloadPercent),wr=Bt.tasksCount===0?L1(_t):Qc(Bt.workloadPercent),Rt=SS();A(VV(W,G,Rt)),S($V(W,G));const $r={totalPortfolioValue:Ae,totalContracts:ue,activeContracts:he,completedTasks:we,pendingTasks:se,overdueTasks:He,totalConclusions:Ee,approvedConclusions:pe,pendingConclusions:ce,totalObjects:Ge,totalInsurance:et,activeInsurance:Ye,averageConclusionDays:je,slaCompliance:_e,currentWorkload:_t,mboCompletionOverall:ve>0?Math.round(we/ve*100):0,workloadByPeriod:{last7Days:ut,last30Days:ct,last90Days:wr}};HV($r);const hr=TS($r);a(hr)}catch(L){console.error("Ошибка загрузки KPI данных:",L)}finally{t(!1)}})()},[n,o]);const B=Ma.useMemo(()=>{if(!x||x.length===0)return[];const R=new Map;return x.forEach(L=>{const N=L.category||"Без категории";R.has(N)||R.set(N,{total:0,completed:0,pending:0,overdue:0});const P=R.get(N);P.total+=1,Zo(L.status)?P.completed+=1:Ud(L)&&(P.pending+=1),Md(L)&&(P.overdue+=1)}),Array.from(R.entries()).map(([L,N])=>({key:L,category:L,...N,completionRate:N.total>0?Math.round(N.completed/N.total*100):0}))},[x]),b=Ma.useMemo(()=>YV(x,v),[x,v]),O=[{title:"№",key:"rank",width:60,align:"center",render:(R,L,N)=>N+1},{title:"Сотрудник",dataIndex:"name",key:"name",render:(R,L)=>s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(dr,{strong:!0,children:R}),s.jsx(dr,{type:"secondary",style:{fontSize:11},children:L.region})]})},{title:"Загрузка",dataIndex:"workload",key:"workload",align:"center",render:R=>`${R}%`},{title:"SLA ≤ 7 дн.",dataIndex:"slaSuccess",key:"slaSuccess",align:"center",render:R=>`${R}%`},{title:"Выполнено",dataIndex:"completed",key:"completed",align:"center"},{title:"В работе",dataIndex:"inProgress",key:"inProgress",align:"center"},{title:"Просрочено",dataIndex:"overdue",key:"overdue",align:"center",render:R=>s.jsx(dr,{type:R>0?"danger":"success",children:R})}],_=[{title:"Категория",dataIndex:"category",key:"category"},{title:"Всего",dataIndex:"total",key:"total",align:"center"},{title:"Выполнено",dataIndex:"completed",key:"completed",align:"center",render:R=>s.jsx(dr,{type:"success",children:R})},{title:"В работе",dataIndex:"pending",key:"pending",align:"center",render:R=>s.jsx(dr,{type:"warning",children:R})},{title:"Просрочено",dataIndex:"overdue",key:"overdue",align:"center",render:R=>s.jsx(dr,{type:"danger",children:R})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:R=>`${R}%`}],U=R=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(R);return e?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(es,{size:"large",tip:"Загрузка аналитики..."})}):s.jsxs("div",{className:"kpi-page",children:[s.jsxs("div",{className:"kpi-header",children:[s.jsx(Ad,{level:2,children:"KPI и Аналитика"}),s.jsxs(Te,{children:[s.jsx(Ve,{value:o,onChange:l,style:{width:150},options:[{label:"За 7 дней",value:"7days"},{label:"За 30 дней",value:"30days"},{label:"За 90 дней",value:"90days"},{label:"За год",value:"1year"}]}),s.jsx(GV,{value:n,onChange:R=>i(R),format:"DD.MM.YYYY"})]})]}),s.jsxs("div",{className:"kpi-compact-grid",children:[s.jsx(Ue,{size:"small",className:"kpi-card--compact",children:s.jsx(pt,{title:"Общая стоимость портфеля",value:r.totalPortfolioValue,prefix:s.jsx(Zf,{}),formatter:R=>U(Number(R)),valueStyle:{color:"#3f8600"}})}),s.jsx(Ue,{size:"small",className:"kpi-card--compact",children:s.jsx(pt,{title:"Активных договоров",value:r.activeContracts,prefix:s.jsx(jr,{}),suffix:`/ ${r.totalContracts}`,valueStyle:{color:"#1890ff"}})}),s.jsx(Ue,{size:"small",className:"kpi-card--compact",children:s.jsx(pt,{title:"Выполнено задач",value:r.completedTasks,prefix:s.jsx(yn,{}),suffix:`/ ${r.completedTasks+r.pendingTasks}`,valueStyle:{color:"#3f8600"}})}),s.jsx(Ue,{size:"small",className:"kpi-card--compact",children:s.jsx(pt,{title:"Просрочено задач",value:r.overdueTasks,prefix:s.jsx(hh,{}),valueStyle:{color:"#cf1322"}})}),s.jsxs(Ue,{size:"small",className:"kpi-card--compact",children:[s.jsx(pt,{title:"MBO выполнение (департамент)",value:r.mboCompletionOverall,suffix:"%",prefix:s.jsx(bd,{}),valueStyle:{color:r.mboCompletionOverall>=95?"#3f8600":r.mboCompletionOverall>=80?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:r.mboCompletionOverall,size:"small",strokeColor:r.mboCompletionOverall>=95?"#3f8600":r.mboCompletionOverall>=80?"#faad14":"#cf1322",style:{marginTop:8}})]})]}),s.jsxs("div",{className:"kpi-compact-grid kpi-compact-grid--wide",children:[s.jsxs(Ue,{size:"small",className:"kpi-card--compact",children:[s.jsx(pt,{title:"Залоговых заключений",value:r.totalConclusions,prefix:s.jsx(jr,{}),valueStyle:{color:"#1890ff"}}),s.jsxs("div",{style:{marginTop:8},children:[s.jsxs(dr,{type:"success",children:["Согласовано: ",r.approvedConclusions]}),s.jsx("br",{}),s.jsxs(dr,{type:"warning",children:["На согласовании: ",r.pendingConclusions]})]})]}),s.jsxs(Ue,{size:"small",className:"kpi-card--compact",children:[s.jsx(pt,{title:"Средний срок подготовки СЗ",value:r.averageConclusionDays,suffix:"раб. дней",prefix:s.jsx(Vn,{}),valueStyle:{color:r.averageConclusionDays<=7?"#3f8600":"#cf1322"}}),s.jsxs("div",{style:{marginTop:8},children:[s.jsx(dr,{type:"secondary",style:{fontSize:12},children:"SLA: не более 7 рабочих дней"}),s.jsx(qn,{percent:r.averageConclusionDays>0?Math.min(7/r.averageConclusionDays*100,100):0,strokeColor:r.averageConclusionDays<=7?"#3f8600":"#faad14",size:"small",showInfo:!1,style:{marginTop:8}})]})]}),s.jsxs(Ue,{size:"small",className:"kpi-card--compact",children:[s.jsx(pt,{title:"Выполнение SLA",value:r.slaCompliance,suffix:"%",prefix:s.jsx(yn,{}),valueStyle:{color:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:r.slaCompliance,strokeColor:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]}),s.jsxs(Ue,{size:"small",className:"kpi-card--compact",children:[s.jsx(pt,{title:"Текущая загрузка",value:r.currentWorkload,suffix:"%",prefix:s.jsx(ti,{}),valueStyle:{color:r.currentWorkload<=100?"#3f8600":r.currentWorkload<=125?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:Math.min(r.currentWorkload,150),strokeColor:r.currentWorkload<=100?"#3f8600":r.currentWorkload<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})]}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(tA,{}),s.jsx("span",{children:"Загрузка сотрудников по периодам"})]}),style:{marginBottom:24},children:s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"За последние 7 дней",value:r.workloadByPeriod.last7Days,suffix:"%",prefix:s.jsx(Vn,{}),valueStyle:{color:r.workloadByPeriod.last7Days<=100?"#3f8600":r.workloadByPeriod.last7Days<=125?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:Math.min(r.workloadByPeriod.last7Days,150),strokeColor:r.workloadByPeriod.last7Days<=100?"#3f8600":r.workloadByPeriod.last7Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})}),s.jsx(be,{xs:24,sm:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"За последние 30 дней",value:r.workloadByPeriod.last30Days,suffix:"%",prefix:s.jsx(Vn,{}),valueStyle:{color:r.workloadByPeriod.last30Days<=100?"#3f8600":r.workloadByPeriod.last30Days<=125?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:Math.min(r.workloadByPeriod.last30Days,150),strokeColor:r.workloadByPeriod.last30Days<=100?"#3f8600":r.workloadByPeriod.last30Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})}),s.jsx(be,{xs:24,sm:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"За последние 90 дней",value:r.workloadByPeriod.last90Days,suffix:"%",prefix:s.jsx(Vn,{}),valueStyle:{color:r.workloadByPeriod.last90Days<=100?"#3f8600":r.workloadByPeriod.last90Days<=125?"#faad14":"#cf1322"}}),s.jsx(qn,{percent:Math.min(r.workloadByPeriod.last90Days,150),strokeColor:r.workloadByPeriod.last90Days<=100?"#3f8600":r.workloadByPeriod.last90Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})})]})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(bd,{}),s.jsx("span",{children:"Лучшие сотрудники"})]}),style:{marginBottom:24},children:s.jsx(dt,{gutter:[16,16],children:OS.map(R=>{const L=k[R.key];return s.jsx(be,{xs:24,md:8,children:s.jsx(Ue,{size:"small",bordered:!0,children:L?s.jsxs(Te,{direction:"vertical",size:6,style:{width:"100%"},children:[s.jsxs(Te,{size:6,align:"center",children:[R.icon,s.jsx(dr,{strong:!0,children:L.title})]}),s.jsx(Ad,{level:5,style:{margin:0},children:L.employeeName}),s.jsx(dr,{type:"secondary",children:L.region}),s.jsxs("div",{style:{fontSize:12},children:[s.jsxs(dr,{children:["Загрузка: ",L.workload,"%"]}),s.jsx("br",{}),s.jsxs(dr,{children:["SLA ≤ 7 дней: ",L.slaSuccess,"%"]})]})]}):s.jsx(dr,{type:"secondary",children:"Данные обновляются..."})})},R.key)})})}),s.jsx(dt,{gutter:[16,16],style:{marginBottom:24},children:s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Объектов в реестре",value:r.totalObjects,prefix:s.jsx(qc,{}),valueStyle:{color:"#722ed1"}})})})}),s.jsxs(dt,{gutter:[16,16],style:{marginBottom:24},children:[s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Активных страховок",value:r.activeInsurance,prefix:s.jsx(yn,{}),suffix:`/ ${r.totalInsurance}`,valueStyle:{color:"#3f8600"}})})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Задач в работе",value:r.pendingTasks,prefix:s.jsx(Vn,{}),valueStyle:{color:"#faad14"}})})})]}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(yn,{}),s.jsx("span",{children:"Выполнение SLA по залоговым заключениям"})]}),style:{marginBottom:24},children:s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,md:12,children:s.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[s.jsx(Ad,{level:3,style:{marginBottom:8},children:"Средний срок подготовки"}),s.jsx("div",{style:{fontSize:48,fontWeight:"bold",marginBottom:8,color:r.averageConclusionDays<=7?"#3f8600":"#cf1322"},children:r.averageConclusionDays.toFixed(1)}),s.jsx(dr,{type:"secondary",style:{fontSize:18},children:"рабочих дней"}),s.jsxs("div",{style:{marginTop:16},children:[s.jsx(dr,{strong:!0,style:{fontSize:16},children:"Требование SLA: не более 7 рабочих дней"}),s.jsx("br",{}),s.jsx(dr,{type:r.averageConclusionDays<=7?"success":"danger",style:{fontSize:14},children:r.averageConclusionDays<=7?"✅ Соответствует SLA":"❌ Превышение на "+(r.averageConclusionDays-7).toFixed(1)+" дней"})]})]})}),s.jsx(be,{xs:24,md:12,children:s.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[s.jsx(Ad,{level:3,style:{marginBottom:8},children:"Процент соответствия SLA"}),s.jsx(qn,{type:"circle",percent:r.slaCompliance,strokeColor:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322",size:200,format:R=>`${R}%`}),s.jsxs("div",{style:{marginTop:16},children:[s.jsx(dr,{type:"secondary",style:{fontSize:14},children:"Заключений, подготовленных в срок ≤ 7 дней"}),s.jsx("br",{}),s.jsx(dr,{strong:!0,style:{fontSize:16,color:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322"},children:r.slaCompliance>=90?"✅ Отличный показатель":r.slaCompliance>=70?"⚠️ Требует улучшения":"❌ Критический уровень"})]})]})})]})}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(qc,{}),s.jsx("span",{children:"Аналитика по региональным центрам"})]}),style:{marginBottom:24},children:[s.jsx(dr,{type:"secondary",style:{display:"block",marginBottom:16},children:"Кликните на региональный центр для детальной статистики по городам и сотрудникам"}),s.jsx(dt,{gutter:[16,16],children:c.map(R=>s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsxs(Ue,{className:"kpi-center-card",hoverable:!0,onClick:()=>{f(R.code),u(null),h(!0)},style:{cursor:"pointer"},children:[s.jsx(ht.Title,{level:4,style:{marginTop:0},children:R.name}),s.jsxs("div",{className:"kpi-center-card__metrics",children:[s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"Выполнение:"}),s.jsxs(dr,{strong:!0,style:{marginLeft:4},children:[R.completionRate,"%"]}),s.jsx(qn,{percent:R.completionRate,strokeColor:"#3f8600",showInfo:!1,size:"small",style:{marginTop:6}})]}),s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"MBO:"}),s.jsxs(dr,{strong:!0,style:{marginLeft:4},children:[R.mboCompletion,"%"]}),s.jsx(qn,{percent:R.mboCompletion,strokeColor:"#1890ff",showInfo:!1,size:"small",style:{marginTop:6}})]})]}),s.jsxs(Te,{direction:"vertical",size:"small",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"Всего задач:"})," ",s.jsx(dr,{strong:!0,children:R.totalTasks})]}),s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"Завершено:"})," ",s.jsx(dr,{strong:!0,type:"success",children:R.completedTasks})]}),s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"В работе:"})," ",s.jsx(dr,{strong:!0,type:"warning",children:R.inProgressTasks})]}),s.jsxs("div",{children:[s.jsx(dr,{type:"secondary",children:"Просрочено:"})," ",s.jsx(dr,{strong:!0,type:"danger",children:R.overdueTasks})]})]})]})},R.code))})]}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(Cb,{}),s.jsx("span",{children:"Статистика по задачам по категориям"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:_,dataSource:B,pagination:!1,size:"small"})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(bd,{}),s.jsx("span",{children:"Рейтинг сотрудников"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:O,dataSource:b,pagination:!1,size:"small",rowKey:"key",locale:{emptyText:"Недостаточно данных для формирования рейтинга"}})}),s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(tA,{}),s.jsx("span",{children:"Динамика выполнения задач"})]}),children:s.jsxs("div",{style:{padding:"40px 0",textAlign:"center",color:"#999"},children:["График динамики выполнения задач",s.jsx("br",{}),s.jsx(dr,{type:"secondary",children:"(Интеграция с графиками в разработке)"})]})})}),s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(qc,{}),s.jsx("span",{children:"Распределение по статусам"})]}),children:s.jsxs("div",{style:{padding:"40px 0",textAlign:"center",color:"#999"},children:["График распределения по статусам",s.jsx("br",{}),s.jsx(dr,{type:"secondary",children:"(Интеграция с графиками в разработке)"})]})})})]}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(ti,{}),s.jsxs("span",{children:["Аналитика по региональному центру:"," ",d?(I=c.find(R=>R.code===d))==null?void 0:I.name:""]})]}),open:g,onCancel:()=>{h(!1),f(null),u(null)},footer:[s.jsx(Be,{onClick:()=>{h(!1),f(null),u(null)},children:"Закрыть"},"close")],width:900,children:d&&(()=>{const R=c.find(V=>V.code===d);if(!R)return null;const L=[{title:"Город",dataIndex:"city",key:"city"},{title:"Всего задач",dataIndex:"totalTasks",key:"totalTasks",align:"center"},{title:"Завершено",dataIndex:"completedTasks",key:"completedTasks",align:"center",render:V=>s.jsx(dr,{type:"success",children:V})},{title:"В работе",dataIndex:"inProgressTasks",key:"inProgressTasks",align:"center",render:V=>s.jsx(dr,{type:"warning",children:V})},{title:"Просрочено",dataIndex:"overdueTasks",key:"overdueTasks",align:"center",render:V=>s.jsx(dr,{type:"danger",children:V})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:V=>`${V}%`}],N=R.cities.map(V=>({key:V.city,...V})),P=pr.getEmployees(),Q=p?R.cities.find(V=>V.city===p):void 0,Y=[{title:"Сотрудник",dataIndex:"employee",key:"employee",render:(V,G)=>{const z=P.find(C=>C.id===G.employeeId);return z?`${z.lastName} ${z.firstName} ${z.middleName||""}`.trim():"Неизвестно"}},{title:"Должность",dataIndex:"position",key:"position",render:(V,G)=>{const z=P.find(C=>C.id===G.employeeId);return(z==null?void 0:z.position)||"—"}},{title:"Всего задач",dataIndex:"totalTasks",key:"totalTasks",align:"center"},{title:"Завершено",dataIndex:"completedTasks",key:"completedTasks",align:"center",render:V=>s.jsx(dr,{type:"success",children:V})},{title:"В работе",dataIndex:"inProgressTasks",key:"inProgressTasks",align:"center",render:V=>s.jsx(dr,{type:"warning",children:V})},{title:"Просрочено",dataIndex:"overdueTasks",key:"overdueTasks",align:"center",render:V=>s.jsx(dr,{type:"danger",children:V})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:V=>`${V}%`}],ee=(Q==null?void 0:Q.employees.map(V=>({key:V.employeeId,...V})))??[];return s.jsxs(s.Fragment,{children:[s.jsx(Ad,{level:5,style:{marginBottom:12},children:"Города регионального центра"}),s.jsx(ir,{columns:L,dataSource:N,size:"small",pagination:!1,onRow:V=>({onClick:()=>u(V.city),style:{cursor:"pointer",backgroundColor:p===V.city?"rgba(24,144,255,0.06)":void 0}})}),p&&Q&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{marginTop:24,marginBottom:8},children:s.jsxs(Ad,{level:5,children:["Сотрудники города: ",p," (",Q.totalTasks," задач)"]})}),s.jsx(ir,{columns:Y,dataSource:ee,size:"small",pagination:!1})]})]})})()})]})},{Title:XV,Text:Ts}=ht,{RangePicker:JV}=Dr,WE=e=>{if(!e)return"Прочее";const t=String(e).toLowerCase();return t.includes("квартир")||t.includes("комнат")||t.includes("жилой дом")||t.includes("таунхаус")||t.includes("жилая")||t==="apartment"||t==="room"||t==="house"||t==="townhouse"||t==="land_residential"?"НЕДВИЖИМОСТЬ ЖИЛАЯ":t.includes("офис")||t.includes("торгов")||t.includes("склад")||t.includes("гостиниц")||t.includes("отель")||t.includes("кафе")||t.includes("ресторан")||t.includes("азс")||t.includes("автосалон")||t.includes("производств")||t.includes("цех")||t.includes("нежилая")||t.includes("коммерческая")||t.includes("промышленная")||t==="office"||t==="retail"||t==="warehouse"||t==="hotel"||t==="catering"||t==="gas_station"||t==="car_dealership"||t==="industrial_building"||t==="workshop"?"НЕДВИЖИМОСТЬ НЕЖИЛАЯ":t.includes("оборудован")||t==="equipment"?"ОБОРУДОВАНИЕ":t.includes("автомобиль")||t.includes("легков")||t.includes("грузов")||t.includes("транспорт")||t==="car_passenger"||t==="car_truck"?"ТРАНСПОРТНЫЕ СРЕДСТВА":t.includes("спецтехник")||t.includes("техник")||t==="machinery"?"СПЕЦТЕХНИКА":t.includes("товар")||t.includes("оборот")?"ТОВАРЫ В ОБОРОТЕ":"Прочее"},ZV=()=>{const[e,t]=M.useState(!0),[r,a]=M.useState({portfolioData:[],totalValue:0,totalDebt:0}),[n,i]=M.useState([We().subtract(365,"day"),We()]),[o,l]=M.useState("all"),c=Ma.useCallback(S=>{if(S==null||S==="")return 0;const B=parseFloat(String(S));return isNaN(B)?0:B},[]),A=Ma.useCallback(async()=>{t(!0);try{const S="/",B=new URL(S,window.location.origin),b=B.pathname.endsWith("/")?B.pathname:`${B.pathname}/`,O=`${B.origin}${b}portfolioData.json?v=${Date.now()}`,_=await fetch(O,{cache:"no-store"});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);const U=await _.json(),I=await kt.getExtendedCards(),R=U.map(P=>{const Q=I.filter(Y=>Y.reference&&String(Y.reference)===String(P.reference)||Y.contractNumber&&Y.contractNumber===P.contractNumber);return Q.length>0&&Q[0].propertyType?{...P,collateralType:Q[0].propertyType}:P});let L=0,N=0;for(const P of R)L+=c(P.collateralValue),N+=c(P.debtRub);a({portfolioData:R,totalValue:L,totalDebt:N})}catch(S){console.error("Ошибка загрузки данных для аналитики:",S)}finally{t(!1)}},[c]);M.useEffect(()=>{A()},[A]);const d=M.useMemo(()=>{const S=new Map,B=new Set(["МБ","СРБ","КБ","Малый бизнес","Средний бизнес","Крупный бизнес","Сегмент ВЭД","ВЭД","МСБ","Корпоративный","Розничный"]);for(const O of r.portfolioData){const _=O.collateralCategory||WE(O.collateralType)||"Не указана";if(B.has(_)||O.segment===_)continue;const U=c(O.collateralValue),I=c(O.debtRub),R=S.get(_)||{count:0,value:0,debt:0};R.count++,R.value+=U,R.debt+=I,S.set(_,R)}const b=r.totalValue;return Array.from(S.entries()).map(([O,_])=>({category:O,count:_.count,value:_.value,debt:_.debt,share:b>0?_.value/b*100:0,coverageRatio:_.debt>0?_.value/_.debt*100:0})).sort((O,_)=>_.value-O.value)},[r,c]),f=M.useMemo(()=>{const S=new Map,B=new Set(["Формальный","Основное","Проблемный"]);for(const O of r.portfolioData){const _=O.collateralCategory||"";if(!B.has(_))continue;const U=O.collateralType||"Не указан",I=WE(O.collateralType),R=c(O.collateralValue),L=c(O.debtRub),N=S.get(U)||{count:0,value:0,debt:0,category:I};N.count++,N.value+=R,N.debt+=L,S.set(U,N)}const b=r.totalValue;return Array.from(S.entries()).map(([O,_])=>({type:O,category:_.category,count:_.count,value:_.value,debt:_.debt,share:b>0?_.value/b*100:0})).sort((O,_)=>_.value-O.value)},[r,c]),p=M.useMemo(()=>{if(!n[0]||!n[1])return null;const S=n[0].startOf("day"),B=n[1].endOf("day"),b=r.portfolioData.filter(j=>{const K=j.contractDate||j.createdAt;if(!K)return!1;const W=We(K);return W.isAfter(S)&&W.isBefore(B)}),O=B.diff(S,"day"),_=S.subtract(O+1,"day"),U=S.subtract(1,"day"),I=r.portfolioData.filter(j=>{const K=j.contractDate||j.createdAt;if(!K)return!1;const W=We(K);return W.isAfter(_)&&W.isBefore(U)});let R=0,L=0;for(const j of b)R+=c(j.collateralValue),L+=c(j.debtRub);const N=b.length;let P=0,Q=0;for(const j of I)P+=c(j.collateralValue),Q+=c(j.debtRub);const Y=I.length,ee=N-Y,V=Y>0?ee/Y*100:N>0?100:0,G=R-P,z=P>0?G/P*100:R>0?100:0,C=L-Q,D=Q>0?C/Q*100:L>0?100:0;return{current:{count:N,value:R,debt:L},previous:{count:Y,value:P,debt:Q},changes:{count:ee,countPercent:V,value:G,valuePercent:z,debt:C,debtPercent:D},periodStart:S.format("DD.MM.YYYY"),periodEnd:B.format("DD.MM.YYYY"),previousPeriodStart:_.format("DD.MM.YYYY"),previousPeriodEnd:U.format("DD.MM.YYYY")}},[r,n,c]),u=M.useMemo(()=>{const S=new Map;for(const b of r.portfolioData){const O=b.segment||"Не указан",_=c(b.collateralValue),U=c(b.debtRub),I=S.get(O)||{count:0,value:0,debt:0};I.count++,I.value+=_,I.debt+=U,S.set(O,I)}const B=r.totalValue;return Array.from(S.entries()).map(([b,O])=>({segment:b,count:O.count,value:O.value,debt:O.debt,share:B>0?O.value/B*100:0,coverageRatio:O.debt>0?O.value/O.debt*100:0})).sort((b,O)=>O.value-b.value)},[r,c]),g=M.useMemo(()=>{const S=[];let B=0,b=0;for(const U of r.portfolioData){const I=String(U.status||"").toLowerCase();(I.includes("просроч")||I.includes("overdue")||I.includes("проблем"))&&(S.push(U),B+=c(U.collateralValue),b+=c(U.debtRub))}const O=r.totalValue,_=r.totalDebt;return{count:S.length,totalCount:r.portfolioData.length,value:B,debt:b,share:O>0?B/O*100:0,debtShare:_>0?b/_*100:0}},[r,c]),h=M.useMemo(()=>{const S=new Map;for(const b of r.portfolioData){const O=b.group||"Не указана",_=c(b.collateralValue),U=c(b.debtRub),I=S.get(O)||{count:0,value:0,debt:0};I.count++,I.value+=_,I.debt+=U,S.set(O,I)}const B=r.totalValue;return Array.from(S.entries()).map(([b,O])=>({group:b,count:O.count,value:O.value,debt:O.debt,share:B>0?O.value/B*100:0})).sort((b,O)=>O.value-b.value)},[r,c]),x=S=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),y=[{title:"Категория имущества",dataIndex:"category",key:"category"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:S=>x(S)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:S=>x(S)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:S=>s.jsxs("div",{children:[s.jsxs(Ts,{strong:!0,children:[S.toFixed(2),"%"]}),s.jsx(qn,{percent:S,showInfo:!1,size:"small",style:{marginTop:4}})]})},{title:"Коэффициент покрытия",dataIndex:"coverageRatio",key:"coverageRatio",align:"center",render:S=>s.jsxs(Ze,{color:S>=100?"green":S>=70?"orange":"red",children:[S.toFixed(1),"%"]})}],v=[{title:"Категория",dataIndex:"category",key:"category",filters:Array.from(new Set(f.map(S=>S.category))).map(S=>({text:S,value:S})),onFilter:(S,B)=>B.category===S},{title:"Тип залогового имущества",dataIndex:"type",key:"type"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:S=>x(S)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:S=>x(S)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:S=>s.jsxs("div",{children:[s.jsxs(Ts,{strong:!0,children:[S.toFixed(2),"%"]}),s.jsx(qn,{percent:S,showInfo:!1,size:"small",style:{marginTop:4}})]})}],E=[{title:"Сегмент бизнеса",dataIndex:"segment",key:"segment"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:S=>x(S)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:S=>x(S)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:S=>`${S.toFixed(2)}%`},{title:"Коэффициент покрытия",dataIndex:"coverageRatio",key:"coverageRatio",align:"center",render:S=>s.jsxs(Ze,{color:S>=100?"green":S>=70?"orange":"red",children:[S.toFixed(1),"%"]})}],k=[{title:"Группа",dataIndex:"group",key:"group"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:S=>x(S)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:S=>x(S)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:S=>`${S.toFixed(2)}%`}];return e?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(es,{size:"large",tip:"Загрузка аналитики..."})}):s.jsxs("div",{className:"analytics-page",children:[s.jsxs("div",{className:"analytics-header",children:[s.jsx(XV,{level:2,children:"Аналитика залогового портфеля"}),s.jsxs(Te,{children:[s.jsx(Ve,{value:o,onChange:l,style:{width:150},options:[{label:"Весь период",value:"all"},{label:"За 7 дней",value:"7days"},{label:"За 30 дней",value:"30days"},{label:"За 90 дней",value:"90days"},{label:"За год",value:"1year"}]}),s.jsx(JV,{value:n,onChange:S=>i(S),format:"DD.MM.YYYY"})]})]}),s.jsxs(dt,{gutter:[16,16],style:{marginBottom:24},children:[s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Общая стоимость портфеля",value:r.totalValue,prefix:s.jsx(Zf,{}),formatter:S=>x(Number(S)),valueStyle:{color:"#3f8600"}})})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Общая задолженность",value:r.totalDebt,prefix:s.jsx(el,{}),formatter:S=>x(Number(S)),valueStyle:{color:"#1890ff"}})})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Всего договоров",value:r.portfolioData.length,prefix:s.jsx(jr,{})})})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(Ue,{children:s.jsx(pt,{title:"Просроченных",value:g.count,prefix:s.jsx(hh,{}),suffix:`/ ${g.totalCount}`,valueStyle:{color:"#cf1322"}})})})]}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(hh,{}),s.jsx("span",{children:"Анализ просроченной задолженности"})]}),style:{marginBottom:24},children:[s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(pt,{title:"Количество просроченных договоров",value:g.count,suffix:`из ${g.totalCount}`})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(pt,{title:"Стоимость залога по просроченным",value:g.value,formatter:S=>x(Number(S)),valueStyle:{color:"#cf1322"}})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(pt,{title:"Просроченная задолженность",value:g.debt,formatter:S=>x(Number(S)),valueStyle:{color:"#cf1322"}})}),s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(pt,{title:"Доля просроченной задолженности",value:g.debtShare,suffix:"%",valueStyle:{color:"#cf1322"}})})]}),s.jsx(jt,{}),s.jsxs(dt,{gutter:[16,16],children:[s.jsxs(be,{xs:24,sm:12,children:[s.jsx(qn,{type:"dashboard",percent:g.share,format:S=>`${S==null?void 0:S.toFixed(1)}%`,strokeColor:"#cf1322"}),s.jsx(Ts,{type:"secondary",style:{display:"block",textAlign:"center",marginTop:8},children:"Доля просроченных в общей стоимости портфеля"})]}),s.jsxs(be,{xs:24,sm:12,children:[s.jsx(qn,{type:"dashboard",percent:g.debtShare,format:S=>`${S==null?void 0:S.toFixed(1)}%`,strokeColor:"#ff4d4f"}),s.jsx(Ts,{type:"secondary",style:{display:"block",textAlign:"center",marginTop:8},children:"Доля просроченной задолженности в общей задолженности"})]})]})]}),p&&s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(tA,{}),s.jsxs("span",{children:["Динамика портфеля за период ",p.periodStart," - ",p.periodEnd]})]}),style:{marginBottom:24},children:[s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"Количество договоров",value:p.current.count,suffix:s.jsxs("div",{children:[s.jsxs(Ts,{type:p.changes.count>=0?"success":"danger",children:[p.changes.count>=0?"+":"",p.changes.count]}),s.jsx("br",{}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["(",p.changes.countPercent>=0?"+":"",p.changes.countPercent.toFixed(2),"%)"]})]})}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",p.previous.count]})]})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"Стоимость залога",value:p.current.value,formatter:S=>x(Number(S)),suffix:s.jsxs("div",{children:[s.jsxs(Ts,{type:p.changes.value>=0?"success":"danger",children:[p.changes.value>=0?"+":"",x(p.changes.value)]}),s.jsx("br",{}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["(",p.changes.valuePercent>=0?"+":"",p.changes.valuePercent.toFixed(2),"%)"]})]})}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",x(p.previous.value)]})]})}),s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsxs(Ue,{size:"small",children:[s.jsx(pt,{title:"Задолженность",value:p.current.debt,formatter:S=>x(Number(S)),suffix:s.jsxs("div",{children:[s.jsxs(Ts,{type:p.changes.debt>=0?"danger":"success",children:[p.changes.debt>=0?"+":"",x(p.changes.debt)]}),s.jsx("br",{}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["(",p.changes.debtPercent>=0?"+":"",p.changes.debtPercent.toFixed(2),"%)"]})]})}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",x(p.previous.debt)]})]})})]}),s.jsx(jt,{}),s.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:["Сравнение с предыдущим периодом: ",p.previousPeriodStart," - ",p.previousPeriodEnd]})]}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(qc,{}),s.jsx("span",{children:"Структура портфеля по сегментам бизнеса"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:E,dataSource:u.map((S,B)=>({...S,key:B})),pagination:!1,size:"small"})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(Cb,{}),s.jsx("span",{children:"Структура портфеля по категориям имущества"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:y,dataSource:d.map((S,B)=>({...S,key:B})),pagination:!1,size:"small"})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(qc,{}),s.jsx("span",{children:"Детальная структура портфеля по типам залогового имущества"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:v,dataSource:f.map((S,B)=>({...S,key:B})),pagination:{pageSize:20},size:"small"})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(qc,{}),s.jsx("span",{children:"Структура портфеля по группам"})]}),style:{marginBottom:24},children:s.jsx(ir,{columns:k,dataSource:h.map((S,B)=>({...S,key:B})),pagination:!1,size:"small"})})]})},e$=e=>{const t=`${e.lastName} ${e.firstName} ${e.middleName||""}`.trim(),r=e.region?Fy(e.region):null,a=r?r.name:e.region;let n="employee";return e.isManager&&(n="manager"),{id:e.id,email:e.email,name:t,role:n,region:a,position:e.position,department:e.department}},xd=()=>{try{const t=pr.getEmployees().filter(l=>l.isActive).map(e$),r=Xs.map(l=>({code:l.code,name:l.name,cities:l.cities})),a="zadachnik_users",n=localStorage.getItem(a);let i={};if(n)try{i=JSON.parse(n)}catch{console.warn("Не удалось распарсить существующие данные zadachnik, создаем новые")}i.employee=t,i.regions=r,localStorage.setItem(a,JSON.stringify(i));const o=t.filter(l=>l.role==="manager").length;console.log(`✅ Синхронизировано ${t.length} сотрудников в zadachnik (${o} руководителей)`),console.log(`✅ Синхронизировано ${r.length} региональных центров`)}catch(e){console.error("Ошибка синхронизации сотрудников с zadachnik:",e)}},t$=Object.freeze(Object.defineProperty({__proto__:null,syncEmployeesToZadachnik:xd},Symbol.toStringTag,{value:"Module"})),XE=[{email:"business1@bank.ru",name:"Иванов Иван Иванович"},{email:"business2@bank.ru",name:"Петрова Мария Сергеевна"},{email:"business3@bank.ru",name:"Сидоров Петр Александрович"},{email:"business4@bank.ru",name:"Козлова Анна Дмитриевна"},{email:"business5@bank.ru",name:"Волков Сергей Николаевич"}],JE={Оценка:["Провести оценку объекта недвижимости","Выполнить оценку движимого имущества","Организовать переоценку объекта залога","Подготовить отчет об оценке","Провести независимую оценку","Оценить рыночную стоимость объекта","Выполнить оценку для целей залога","Провести оценку коммерческой недвижимости","Оценить земельный участок","Подготовить экспертное заключение по оценке"],Экспертиза:["Провести экспертизу документов","Выполнить техническую экспертизу объекта","Проверить юридическую чистоту","Провести строительно-техническую экспертизу","Организовать экспертизу оценки","Провести судебную экспертизу","Выполнить экологическую экспертизу","Проверить техническое состояние объекта","Провести экспертизу проектной документации","Выполнить финансовую экспертизу"],Рецензия:["Провести рецензию отчета об оценке","Выполнить рецензирование экспертизы","Проверить качество оценки","Подготовить рецензию на заключение","Провести независимую рецензию","Выполнить рецензирование отчета","Проверить соответствие стандартам оценки","Подготовить экспертное заключение по рецензии"],ПРКК:["Провести проверку рисков","Выполнить анализ кредитных рисков","Проверить залоговое обеспечение","Оценить риски по сделке","Провести комплексную проверку рисков","Выполнить анализ залоговых рисков","Оценить рыночные риски","Проверить ликвидность залога","Выполнить стресс-тестирование","Провести анализ концентрации рисков"],Прочее:["Провести мониторинг объекта залога","Проверить комплектность документов","Связаться с клиентом","Обновить данные в реестре","Проверить срок действия страховки","Провести осмотр объекта","Подготовить справку","Оформить документы","Проверить соответствие требованиям","Выполнить консультацию"],Отчетность:["Подготовить аналитический отчет","Сформировать отчет по портфелю","Подготовить отчет для руководства","Обновить отчетность","Подготовить ежемесячный отчет","Сформировать квартальный отчет","Подготовить отчет по региону","Выполнить сводный отчет","Подготовить отчет по рискам","Сформировать статистический отчет"],"Подготовка СЗ":["Подготовить залоговое заключение","Оформить документы по залогу","Подготовить пакет документов","Согласовать условия залога","Подготовить заключение по залогу","Оформить залоговое обеспечение","Подготовить документы для регистрации","Согласовать залоговое заключение","Подготовить проект залогового договора","Оформить залоговую документацию"],Мониторинг:["Провести плановый мониторинг объекта","Выполнить внеплановый мониторинг","Проверить состояние объекта залога","Провести мониторинг рыночной стоимости","Выполнить мониторинг документов","Проверить использование объекта","Провести мониторинг страховки","Выполнить контрольный мониторинг","Проверить сохранность залога","Провести комплексный мониторинг"],Осмотр:["Провести первичный осмотр объекта","Выполнить повторный осмотр","Провести внеплановый осмотр","Организовать осмотр объекта залога","Проверить техническое состояние","Провести осмотр с фотофиксацией","Выполнить осмотр с оценщиком","Провести осмотр недвижимости","Организовать осмотр движимого имущества","Проверить соответствие описанию"],"Проверка документов":["Проверить комплектность документов","Выполнить проверку подлинности","Проверить соответствие требованиям","Провести правовую проверку","Выполнить проверку регистрации","Проверить срок действия документов","Провести комплексную проверку","Выполнить проверку на обременения","Проверить правоустанавливающие документы","Провести проверку кадастровых документов"],Согласование:["Согласовать условия залога","Провести согласование с клиентом","Согласовать оценку","Выполнить согласование документов","Провести согласование с руководством","Согласовать условия сделки","Выполнить межведомственное согласование","Провести согласование с партнерами","Согласовать залоговое заключение","Провести финальное согласование"],"Контроль качества":["Провести контроль качества оценки","Выполнить проверку качества документов","Проверить качество экспертизы","Провести контроль качества работы","Выполнить аудит качества","Проверить соответствие стандартам","Провести внутренний контроль","Выполнить проверку на ошибки","Проверить полноту информации","Провести финальный контроль"]},r$=(e,t,r)=>({Оценка:`Требуется выполнить оценку объекта в регионе ${r}. ${t}`,Экспертиза:`Необходимо провести экспертизу в регионе ${r}. ${t}`,Рецензия:`Требуется рецензирование в регионе ${r}. ${t}`,ПРКК:`Провести проверку рисков в регионе ${r}. ${t}`,Прочее:`Задача в регионе ${r}. ${t}`,Отчетность:`Подготовить отчетность по региону ${r}. ${t}`,"Подготовка СЗ":`Подготовить залоговое заключение в регионе ${r}. ${t}`,Мониторинг:`Провести мониторинг в регионе ${r}. ${t}`,Осмотр:`Провести осмотр объекта в регионе ${r}. ${t}`,"Проверка документов":`Проверить документы в регионе ${r}. ${t}`,Согласование:`Провести согласование в регионе ${r}. ${t}`,"Контроль качества":`Провести контроль качества в регионе ${r}. ${t}`})[e]||`${t} в регионе ${r}`,IS=async()=>{try{const e=pr.getEmployees().filter(A=>A.isActive),t=[],r=We(),a={};Xs.forEach(A=>{a[A.code]=e.filter(d=>A.cities.includes(d.region)||d.region===A.code)}),Xs.forEach(A=>{const d=a[A.code]||[],f=d.filter(u=>u.isActive&&!u.isManager&&u.status!=="sick_leave"&&u.status!=="vacation"&&u.status!=="business_trip"&&(!u.status||u.status==="working")),p=d.filter(u=>u.isActive&&u.isManager);f.length===0||p.length===0||f.forEach(u=>{const h=(85+Math.random()*40)/100*Xl,x=h*(10/19),y=h*(5/19),v=Math.max(2,h-x-y),E=h*3.2,k=Math.max(h*.05,2),S=u.region,B=XE[Math.floor(Math.random()*XE.length)],b=`${u.lastName} ${u.firstName} ${u.middleName||""}`.trim(),O=p[0],_=O?`${O.lastName} ${O.firstName} ${O.middleName||""}`.trim():"",U=(Y,ee,V=!1)=>{const G=[];let z=0;const C=Object.entries(Pc).map(([D,j])=>({type:D,hours:j})).sort((D,j)=>j.hours-D.hours);for(;z<Y;){const D=Y-z,j=C.filter(_e=>_e.hours<=D);if(j.length===0)break;const K=Math.random()>.3?j[0]:j[Math.floor(Math.random()*Math.min(3,j.length))];let W=K.type,Ae=K.hours;if(W==="Подготовка СЗ"&&(Math.random()<.1&&D>=24?(W="Подготовка СЗ (АЗС)",Ae=24):Ae=6),Ae>D)break;const ue=Math.floor(Math.random()*90),he=r.subtract(ue+(ee==="completed"?30:0),"day"),ve=ee==="completed"?he.add(Math.floor(Math.random()*20),"day"):null,we=V?r.subtract(1+Math.floor(Math.random()*30),"day"):ee==="completed"&&ve?ve.add(Math.floor(Math.random()*10),"day"):r.add(Math.floor(Math.random()*30)+1,"day"),se=JE[W]||JE.Прочее||["Задача"],He=se[Math.floor(Math.random()*se.length)],Ee=r$(W,He,S),pe=`T-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ce=he.toISOString();let Ge=ee,et=[],Ye=null,tt=null;const je=[{date:ce,user:B.name,userRole:"business",action:"Создана",comment:"Задача создана бизнесом",status:"created"}];if(ee==="completed"||ee==="approved"){const _e=he.add(1,"day"),At=_e.add(1,"day"),Ct=At.add(Math.floor(Math.random()*10),"day"),_t=ee==="approved"&&ve?ve:Ct.add(1,"day");et=u.email?[u.email]:[],Ye=u.email||null,tt=b,je.push({date:_e.toISOString(),user:_||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${b}`,status:"assigned",assignedTo:et},{date:At.toISOString(),user:b,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"},{date:Ct.toISOString(),user:b,userRole:"employee",action:"Отправлена на утверждение",comment:"Задача отправлена на согласование руководителю",status:"approval"},{date:_t.toISOString(),user:_||"Руководитель",userRole:"manager",action:ee==="approved"?"Согласовано":"Выполнена",comment:ee==="approved"?"Задача согласована руководителем":"Задача выполнена",status:ee==="approved"?"approved":"completed"}),Ge=ee==="approved"?"approved":"completed"}else if(ee==="in_progress"){const _e=he.add(1,"day"),At=_e.add(1,"day");et=u.email?[u.email]:[],Ye=u.email||null,tt=b,je.push({date:_e.toISOString(),user:_||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${b}`,status:"assigned",assignedTo:et},{date:At.toISOString(),user:b,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"}),Ge="in_progress"}else if(ee==="assigned"){const _e=he.add(1,"day");et=u.email?[u.email]:[],Ye=u.email||null,tt=b,je.push({date:_e.toISOString(),user:_||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${b}`,status:"assigned",assignedTo:et}),Ge="assigned"}else if(ee==="approval"){const _e=he.add(1,"day"),At=_e.add(1,"day"),Ct=At.add(Math.floor(Math.random()*10),"day");et=u.email?[u.email]:[],Ye=(O==null?void 0:O.email)||null,tt=_,je.push({date:_e.toISOString(),user:_||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${b}`,status:"assigned",assignedTo:et},{date:At.toISOString(),user:b,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"},{date:Ct.toISOString(),user:b,userRole:"employee",action:"Отправлена на утверждение",comment:"Задача отправлена на согласование руководителю",status:"approval"}),Ge="approval"}G.push({id:pe,region:S,type:W,category:W,title:He,description:Ee,priority:Math.random()>.6?"high":Math.random()>.3?"medium":"low",dueDate:we.format("YYYY-MM-DD"),status:Ge,businessUser:B.email,businessUserName:B.name,assignedTo:et,currentAssignee:Ye,currentAssigneeName:tt,employeeId:u.id,documents:[],comments:[],createdAt:ce,updatedAt:ee==="completed"&&ve?ve.toISOString():r.toISOString(),completedAt:ee==="completed"&&ve?ve.toISOString():void 0,history:je}),z+=Ae}return G},I=U(E*.8,"completed"),R=U(E*.2,"approved"),L=U(k,"in_progress",!0),N=U(x,"assigned"),P=U(y,"in_progress"),Q=U(v,"approval");t.push(...I,...R,...L,...N,...P,...Q)})});try{await kt.saveTasks(t),console.log(`✅ Задачи сохранены в IndexedDB (${t.length} задач)`);try{localStorage.removeItem("zadachnik_tasks")}catch{}}catch(A){throw console.error("Ошибка сохранения задач в IndexedDB:",A),A}const n=t.reduce((A,d)=>(A[d.type]=(A[d.type]||0)+1,A),{}),i=e.filter(A=>A.isActive),o=t.filter(A=>A.status==="completed").length,l=t.filter(A=>A.status==="in_progress"||A.status==="created").length,c=t.filter(A=>We(A.dueDate).isBefore(We(),"day")&&A.status!=="completed").length;console.log(`✅ Сгенерировано ${t.length} задач для ${i.length} активных сотрудников`),console.log(`   - Среднее количество задач на сотрудника: ${(t.length/i.length).toFixed(1)}`),console.log(`   - Выполнено: ${o} (${(o/t.length*100).toFixed(1)}%)`),console.log(`   - В работе: ${l} (${(l/t.length*100).toFixed(1)}%)`),console.log(`   - Просрочено: ${c} (${(c/t.length*100).toFixed(1)}%)`),console.log("   - Распределение по типам задач:",Object.entries(n).map(([A,d])=>`${A}: ${d}`).join(", "))}catch(e){throw console.error("Ошибка генерации задач:",e),e}},NS=Object.freeze(Object.defineProperty({__proto__:null,generateTasksForEmployees:IS},Symbol.toStringTag,{value:"Module"})),{Title:a$}=ht,{Option:U1}=Ve,{TextArea:n$}=Re,{Panel:s$}=S2,M1=[{value:"working",label:"На работе",color:"green"},{value:"sick_leave",label:"Больничный",color:"orange"},{value:"vacation",label:"Отпуск",color:"blue"},{value:"business_trip",label:"Командировка",color:"purple"}],ZE={registry_view:"Просмотр реестра",registry_edit:"Редактирование реестра",portfolio_view:"Просмотр портфеля",portfolio_edit:"Редактирование портфеля",conclusions_view:"Просмотр заключений",conclusions_edit:"Редактирование заключений",tasks_view:"Просмотр задач",tasks_edit:"Редактирование задач",reports_view:"Просмотр отчетов",reports_export:"Экспорт отчетов",settings_view:"Просмотр настроек",settings_edit:"Редактирование настроек",admin:"Администратор"},i$=()=>{var R;const[e,t]=M.useState([]),[r,a]=M.useState([]),[n,i]=M.useState(!1),[o,l]=M.useState(!1),[c,A]=M.useState(null),[d]=re.useForm(),[f,p]=M.useState([]),[u,g]=M.useState("");M.useEffect(()=>{h(),x()},[]);const h=(L=!1)=>{i(!0);try{const N=pr.getEmployees();t(N),xd(),L&&Ne.success(`Загружено ${N.length} сотрудников`)}catch(N){Ne.error("Ошибка загрузки сотрудников"),console.error(N)}finally{i(!1)}},x=async()=>{try{let L=[];try{L=await kt.getTasks()}catch{try{const P=localStorage.getItem("zadachnik_tasks");P&&(L=JSON.parse(P))}catch(P){console.warn("Не удалось загрузить задачи из localStorage:",P)}}a(L)}catch(L){console.warn("Ошибка загрузки задач для статистики загрузки сотрудников:",L)}},y=M.useMemo(()=>{if(!u.trim())return e;const L=u.toLowerCase();return e.filter(N=>{const P=`${N.lastName} ${N.firstName} ${N.middleName||""}`.toLowerCase(),Q=(N.position||"").toLowerCase(),Y=(N.region||"").toLowerCase(),ee=(N.email||"").toLowerCase(),V=(N.department||"").toLowerCase();return P.includes(L)||Q.includes(L)||Y.includes(L)||ee.includes(L)||V.includes(L)})},[e,u]),v=M.useMemo(()=>{const L={};return Xs.forEach(N=>{L[N.code]={},N.cities.forEach(P=>{L[N.code][P]=y.filter(Q=>Q.region===P)})}),L},[y]),E=M.useMemo(()=>{const L={};return Xs.forEach(N=>{const P=_S(r,e,N.code,N.cities);L[N.code]=P}),L},[r,e]),k=M.useMemo(()=>{const L={};return Xs.forEach(N=>{const P=r.filter(Q=>{const Y=(Q.region||"").toString();return N.cities.includes(Y)||Y===N.code}).sort((Q,Y)=>{const ee=We(Q.updatedAt||Q.createdAt||Q.dueDate||We().toISOString()).valueOf();return We(Y.updatedAt||Y.createdAt||Y.dueDate||We().toISOString()).valueOf()-ee}).slice(0,5);L[N.code]=P}),L},[r]),S=()=>{A(null),d.resetFields(),l(!0)},B=L=>{A(L),d.setFieldsValue({...L,permissions:L.permissions||[],birthDate:L.birthDate?We(L.birthDate):void 0,hireDate:L.hireDate?We(L.hireDate):void 0,status:L.status||"working",photo:L.photo?[{uid:"-1",name:"photo.png",status:"done",url:L.photo}]:[]}),l(!0)},b=L=>new Promise((N,P)=>{const Q=new FileReader;Q.readAsDataURL(L),Q.onload=()=>N(Q.result),Q.onerror=Y=>P(Y)}),O=async L=>{if(L.file.status!=="uploading"&&(L.file.status==="done"||L.file.originFileObj))try{const N=await b(L.file.originFileObj||L.file);d.setFieldsValue({photo:[{...L.file,thumbUrl:N,url:N}]})}catch(N){Ne.error("Ошибка загрузки фото"),console.error(N)}},_=L=>{try{pr.deleteEmployee(L),xd(),Ne.success("Сотрудник удален"),h()}catch{Ne.error("Ошибка удаления сотрудника")}},U=async()=>{try{const L=await d.validateFields();let N;if(L.photo&&L.photo.length>0){const Q=L.photo[0];Q.response?N=Q.response.url:Q.thumbUrl?N=Q.thumbUrl:Q.url&&(N=Q.url)}else c!=null&&c.photo&&(N=c.photo);const P={...L,birthDate:L.birthDate?We(L.birthDate).format("YYYY-MM-DD"):void 0,hireDate:L.hireDate?We(L.hireDate).format("YYYY-MM-DD"):void 0,status:L.status||"working",photo:N};c?(pr.updateEmployee(c.id,P),xd(),Ne.success("Сотрудник обновлен")):(pr.addEmployee(P),xd(),Ne.success("Сотрудник добавлен")),l(!1),h()}catch(L){console.error("Ошибка сохранения:",L)}},I=[{title:"ФИО",key:"name",width:180,fixed:"left",render:(L,N)=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:"13px"},children:[s.jsx(nm,{src:N.photo,icon:s.jsx(ti,{}),size:40,style:{flexShrink:0}}),s.jsxs("div",{children:[s.jsxs("div",{children:[N.lastName," ",N.firstName," ",N.middleName||""]}),N.employeeNumber&&s.jsxs("div",{style:{fontSize:"11px",color:"#999",marginTop:2},children:["№ ",N.employeeNumber]})]})]})},{title:"Должность",dataIndex:"position",key:"position",width:180,ellipsis:!0},{title:"Регион",dataIndex:"region",key:"region",width:120,ellipsis:!0},{title:"Email",dataIndex:"email",key:"email",width:180,ellipsis:!0},{title:"Роли / Загрузка",key:"roles",width:200,render:(L,N)=>{var P,Q;return s.jsxs(Te,{direction:"vertical",size:2,style:{fontSize:"11px"},children:[s.jsxs(Te,{size:4,wrap:!0,children:[N.isManager&&s.jsx(Ze,{color:"gold",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:"Руководитель"}),N.canMonitor&&s.jsxs(Ze,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["М: ",N.monitoringWorkload||0]}),N.canAppraise&&s.jsxs(Ze,{color:"purple",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["О: ",N.appraisalWorkload||0]}),!N.canMonitor&&!N.canAppraise&&!N.isManager&&s.jsx(Ze,{color:"default",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:"Общие"})]}),N.status&&s.jsx(Ze,{color:((P=M1.find(Y=>Y.value===N.status))==null?void 0:P.color)||"default",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:((Q=M1.find(Y=>Y.value===N.status))==null?void 0:Q.label)||N.status}),s.jsx(Ze,{color:N.isActive?"green":"red",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:N.isActive?"Активен":"Неактивен"})]})}},{title:"Права",key:"permissions",width:150,render:(L,N)=>s.jsxs(Te,{wrap:!0,size:2,children:[N.permissions.slice(0,2).map(P=>s.jsx(Ze,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:ZE[P].substring(0,15)},P)),N.permissions.length>2&&s.jsxs(Ze,{style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["+",N.permissions.length-2]})]})},{title:"Действия",key:"actions",width:100,fixed:"right",render:(L,N)=>s.jsxs(Te,{size:4,children:[s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),onClick:()=>B(N),size:"small",style:{padding:"0 4px"}}),s.jsx(po,{title:"Удалить сотрудника?",onConfirm:()=>_(N.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),size:"small",style:{padding:"0 4px"}})})]})}];return s.jsxs("div",{className:"employees-page",style:{padding:"8px"},children:[s.jsxs(Ue,{size:"small",style:{marginBottom:8},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[s.jsxs(a$,{level:4,style:{margin:0,fontSize:"16px"},children:[s.jsx(Bb,{style:{marginRight:4}}),"Сотрудники"]}),s.jsxs(Te,{size:8,split:s.jsx("span",{style:{color:"#d9d9d9"},children:"|"}),children:[s.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:["Всего: ",s.jsx("strong",{children:e.length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#52c41a"},children:["Активных: ",s.jsx("strong",{children:e.filter(L=>L.isActive).length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#1890ff"},children:["Мониторинг: ",s.jsx("strong",{children:e.filter(L=>L.canMonitor).length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#722ed1"},children:["Оценка: ",s.jsx("strong",{children:e.filter(L=>L.canAppraise).length})]})]}),s.jsxs(Te,{size:8,split:s.jsx("span",{style:{color:"#d9d9d9"},children:"|"}),style:{marginTop:4},children:[s.jsxs("span",{style:{fontSize:"12px",color:"#52c41a"},children:["На работе:"," ",s.jsx("strong",{children:e.filter(L=>L.status==="working"||!L.status).length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#fa8c16"},children:["Больничный:"," ",s.jsx("strong",{children:e.filter(L=>L.status==="sick_leave").length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#1890ff"},children:["Отпуск: ",s.jsx("strong",{children:e.filter(L=>L.status==="vacation").length})]}),s.jsxs("span",{style:{fontSize:"12px",color:"#722ed1"},children:["Командировка:"," ",s.jsx("strong",{children:e.filter(L=>L.status==="business_trip").length})]})]})]}),s.jsxs(Te,{size:4,children:[s.jsx(po,{title:"Регенерировать базу сотрудников?",description:"Это создаст 30 сотрудников на каждый региональный центр. Существующие данные будут перезаписаны.",onConfirm:()=>{try{i(!0);const L=pr.regenerateEmployees();t(L),xd(),Ne.success(`Создано ${L.length} сотрудников`),i(!1)}catch(L){Ne.error("Ошибка регенерации сотрудников"),console.error(L),i(!1)}},okText:"Да",cancelText:"Нет",children:s.jsx(Be,{icon:s.jsx(el,{}),loading:n,size:"small",children:"Регенерация"})}),s.jsx(Be,{icon:s.jsx(Zl,{}),onClick:()=>h(!0),loading:n,size:"small",children:"Обновить"}),s.jsx(po,{title:"Сгенерировать задачи для всех сотрудников?",description:"Это создаст 30-50 задач на каждого активного сотрудника. Большая часть будет выполнена, 1% просрочена.",onConfirm:()=>{try{IS(),Ne.success("Задачи успешно сгенерированы")}catch(L){Ne.error("Ошибка генерации задач"),console.error(L)}},okText:"Да",cancelText:"Нет",children:s.jsx(Be,{icon:s.jsx(Zl,{}),size:"small",children:"Генерировать задачи"})}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:S,size:"small",children:"Добавить"})]})]}),s.jsx("div",{style:{marginTop:8},children:s.jsx(Re,{placeholder:"Поиск по ФИО, должности, региону, email...",prefix:s.jsx(Pa,{}),value:u,onChange:L=>g(L.target.value),allowClear:!0,size:"small",style:{maxWidth:400}})})]}),s.jsx(S2,{activeKey:f,onChange:p,size:"small",style:{marginBottom:8},children:Xs.map(L=>{const N=Object.values(v[L.code]||{}).flat(),P=N.filter(z=>z.isActive).length,Q=N.filter(z=>z.canMonitor).length,Y=N.filter(z=>z.canAppraise).length,V=(E[L.code]||{workloadPercent:0}).workloadPercent,G=k[L.code]||[];return s.jsxs(s$,{header:s.jsxs(Te,{size:4,wrap:!0,style:{fontSize:"12px"},children:[s.jsxs("span",{style:{fontWeight:600,fontSize:"13px"},children:[L.code," - ",L.name]}),s.jsxs(Ze,{color:"green",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[P," акт."]}),s.jsxs(Ze,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[Q," мон."]}),s.jsxs(Ze,{color:"purple",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[Y," оц."]}),s.jsxs(Ze,{color:"gold",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["Загрузка: ",V,"%"]})]}),children:[s.jsx(Ue,{size:"small",type:"inner",title:"Демо задачи (нагрузка)",style:{marginBottom:8},bodyStyle:{padding:8,maxHeight:220,overflowY:"auto"},children:s.jsx(Qt,{size:"small",dataSource:G,locale:{emptyText:"Демо задачи формируются автоматически"},renderItem:z=>s.jsx(Qt.Item,{style:{padding:"6px 0"},children:s.jsxs(Te,{direction:"vertical",size:2,style:{width:"100%"},children:[s.jsxs(Te,{size:4,wrap:!0,children:[s.jsx(Ze,{color:"geekblue",style:{margin:0},children:z.type||"Задача"}),s.jsx(Ze,{color:"gold",style:{margin:0},children:(z.status||"").toString()})]}),s.jsx("div",{style:{fontSize:12,fontWeight:500},children:z.title}),s.jsxs(Te,{size:4,wrap:!0,style:{fontSize:11,color:"rgba(0,0,0,0.65)"},children:[z.currentAssigneeName&&s.jsxs("span",{children:["Исполнитель: ",z.currentAssigneeName]}),z.dueDate&&s.jsxs("span",{children:["Срок: ",We(z.dueDate).format("DD.MM.YYYY")]})]})]})},z.id)})}),L.cities.map(z=>{var D;const C=((D=v[L.code])==null?void 0:D[z])||[];return C.length===0?null:s.jsx(Ue,{size:"small",title:s.jsxs(Te,{size:4,style:{fontSize:"12px"},children:[s.jsx(ti,{}),s.jsx("span",{children:z}),s.jsx(Ze,{style:{margin:0,fontSize:"11px",padding:"0 4px"},children:C.length})]}),style:{marginBottom:8},bodyStyle:{padding:"8px"},children:s.jsx(ir,{columns:I,dataSource:C,rowKey:"id",pagination:{pageSize:10,size:"small",showSizeChanger:!1},size:"small",scroll:{x:"max-content"}})},z)})]},L.code)})}),s.jsx(Ue,{title:s.jsxs(Te,{size:4,style:{fontSize:"13px"},children:[s.jsx("span",{children:"Все сотрудники"}),u&&s.jsxs(Ze,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["Найдено: ",y.length," из ",e.length]})]}),size:"small",bodyStyle:{padding:"8px"},children:s.jsx(ir,{columns:I,dataSource:y,rowKey:"id",loading:n,pagination:{pageSize:20,showSizeChanger:!0,showTotal:L=>`Всего ${L} сотрудников`,size:"small",showQuickJumper:!0},size:"small",scroll:{x:"max-content"}})}),s.jsx(cr,{title:c?"Редактировать сотрудника":"Добавить сотрудника",open:o,onOk:U,onCancel:()=>l(!1),width:600,okText:"Сохранить",cancelText:"Отмена",children:s.jsxs(re,{form:d,layout:"vertical",initialValues:{isActive:!0,permissions:[],canMonitor:!1,canAppraise:!1,isManager:!1,monitoringWorkload:0,appraisalWorkload:0,status:"working"},children:[s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"lastName",label:"Фамилия",rules:[{required:!0,message:"Введите фамилию"}],children:s.jsx(Re,{placeholder:"Иванов"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"firstName",label:"Имя",rules:[{required:!0,message:"Введите имя"}],children:s.jsx(Re,{placeholder:"Иван"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"middleName",label:"Отчество",children:s.jsx(Re,{placeholder:"Иванович"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"position",label:"Должность",rules:[{required:!0,message:"Введите должность"}],children:s.jsx(Re,{placeholder:"Менеджер по работе с залогами"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"region",label:"Регион",rules:[{required:!0,message:"Выберите регион"}],children:s.jsx(Ve,{placeholder:"Выберите регион",showSearch:!0,children:Xs.flatMap(L=>L.cities.map(N=>s.jsxs(U1,{value:N,children:[L.code," - ",N]},N)))})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"department",label:"Отдел",children:s.jsx(Re,{placeholder:"Отдел залогового обеспечения"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"phone",label:"Телефон",children:s.jsx(Re,{placeholder:"+7 (495) 123-45-67"})})})]}),s.jsx(re.Item,{name:"email",label:"Email",children:s.jsx(Re,{type:"email",placeholder:"ivanov@bank.ru"})}),s.jsx(re.Item,{name:"photo",label:"Фото сотрудника",children:s.jsx(Js,{listType:"picture-card",maxCount:1,beforeUpload:()=>!1,onChange:O,accept:"image/*",children:((R=d.getFieldValue("photo"))==null?void 0:R.length)>=1?null:s.jsxs("div",{children:[s.jsx(Ns,{}),s.jsx("div",{style:{marginTop:8},children:"Загрузить"})]})})}),s.jsx(re.Item,{name:"permissions",label:"Права доступа",rules:[{required:!0,message:"Выберите права доступа"}],children:s.jsx(Ve,{mode:"multiple",placeholder:"Выберите права доступа",style:{width:"100%"},children:Object.entries(ZE).map(([L,N])=>s.jsx(U1,{value:L,children:N},L))})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"birthDate",label:"Дата рождения",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"employeeNumber",label:"Табельный номер",children:s.jsx(Re,{placeholder:"000001"})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"hireDate",label:"Дата приема на работу",children:s.jsx(Dr,{style:{width:"100%"},format:"DD.MM.YYYY"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"status",label:"Статус",initialValue:"working",children:s.jsx(Ve,{placeholder:"Выберите статус",children:M1.map(L=>s.jsx(U1,{value:L.value,children:s.jsx(Ze,{color:L.color,style:{margin:0},children:L.label})},L.value))})})})]}),s.jsx(dt,{gutter:16,children:s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"isActive",label:"Активен",valuePropName:"checked",children:s.jsx(ms,{})})})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"canMonitor",label:"Может выполнять мониторинг",valuePropName:"checked",children:s.jsx(ms,{})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"canAppraise",label:"Может выполнять оценку",valuePropName:"checked",children:s.jsx(ms,{})})})]}),s.jsx(dt,{gutter:16,children:s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"isManager",label:"Руководитель региона",valuePropName:"checked",tooltip:"Назначить сотрудника руководителем региона",children:s.jsx(ms,{})})})}),s.jsx(re.Item,{name:"notes",label:"Примечания",children:s.jsx(n$,{rows:3,placeholder:"Дополнительная информация"})})]})})]})},{Title:eb,Text:tb}=ht,{TextArea:o$}=Re,l$=()=>{const e=dc(),[t,r]=M.useState([]),[a,n]=M.useState(null),[i,o]=M.useState(!1),[l,c]=M.useState(null),[A]=re.useForm(),d=M.useCallback(()=>{try{const y=Tn.getDictionaries();r(y)}catch{Ne.error("Ошибка загрузки справочников")}},[]);M.useEffect(()=>{(async()=>{try{await Promise.all([Tn.syncCollateralAttributesFromUnified(),Tn.syncAttributeLevelsFromPublic()])}catch(v){console.warn("Ошибка синхронизации справочников:",v)}d()})()},[d]),M.useEffect(()=>{if(t.length===0)return;const y=e.search||window.location.search,v=e.hash||window.location.hash;console.log("ReferenceDataPage: location.search =",e.search),console.log("ReferenceDataPage: location.hash =",e.hash),console.log("ReferenceDataPage: window.location.search =",window.location.search),console.log("ReferenceDataPage: window.location.hash =",window.location.hash);let E;if(v.includes("?")){const S=v.split("?")[1];E=new URLSearchParams(S)}else y?E=new URLSearchParams(y):E=new URLSearchParams;const k=E.get("dict");if(console.log("ReferenceDataPage: dictId из URL =",k),console.log("ReferenceDataPage: доступно справочников =",t.length),console.log("ReferenceDataPage: ID справочников =",t.map(S=>S.id)),k){const S=t.find(B=>B.id===k);if(S){console.log("ReferenceDataPage: найден справочник по ID:",S.name),n(S);return}else console.warn(`Справочник с ID "${k}" не найден. Доступные справочники:`,t.map(B=>B.id))}!a&&t.length>0&&(console.log("ReferenceDataPage: параметр dict отсутствует, выбираем первый справочник"),n(t[0]))},[t,e.search,e.hash,a]);const f=M.useCallback(y=>{n(y),c(null),A.resetFields(),A.setFieldsValue({isActive:!0,sortOrder:y.items.length+1}),o(!0)},[A]),p=M.useCallback((y,v)=>{n(y),c(v),A.setFieldsValue({...v}),o(!0)},[A]),u=M.useCallback((y,v)=>{try{Tn.deleteItemFromDictionary(y.id,v),Ne.success("Элемент удален"),d()}catch{Ne.error("Ошибка удаления элемента")}},[d]),g=M.useCallback(async()=>{if(a)try{const y=await A.validateFields();l?(Tn.updateItemInDictionary(a.id,l.id,y),Ne.success("Элемент обновлен")):(Tn.addItemToDictionary(a.id,y),Ne.success("Элемент добавлен")),o(!1),d()}catch(y){console.error("Ошибка сохранения:",y)}},[d,a,l,A]),h=Ma.useCallback(y=>y.code==="attribute_levels"?[{title:"Код атрибута",dataIndex:"code",key:"code",width:200},{title:"Вид обеспечения",key:"level1",render:(v,E)=>{var k;return((k=E.metadata)==null?void 0:k.level1)||""},width:200},{title:"Тип обеспечения",key:"level2",render:(v,E)=>{var k;return((k=E.metadata)==null?void 0:k.level2)||""},width:200},{title:"Подтип обеспечения",key:"level3",render:(v,E)=>{var k;return((k=E.metadata)==null?void 0:k.level3)||""},width:220},{title:"Функциональная группа",key:"level4",render:(v,E)=>{var k;return((k=E.metadata)==null?void 0:k.level4)||""},width:240},{title:"Функциональная подгруппа",key:"level5",render:(v,E)=>{var k;return((k=E.metadata)==null?void 0:k.level5)||""},width:260},{title:"Действия",key:"actions",width:150,fixed:"right",render:(v,E)=>s.jsxs(Te,{children:[s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),onClick:()=>p(y,E),size:"small",children:"Редактировать"}),s.jsx(po,{title:"Удалить элемент?",onConfirm:()=>u(y,E.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),size:"small",children:"Удалить"})})]})}]:[{title:"Код",dataIndex:"code",key:"code",width:150},{title:"Наименование",dataIndex:"name",key:"name"},{title:"Описание",dataIndex:"description",key:"description",ellipsis:!0},{title:"Порядок сортировки",dataIndex:"sortOrder",key:"sortOrder",align:"center",width:120},{title:"Статус",dataIndex:"isActive",key:"isActive",align:"center",width:100,render:v=>s.jsx(Ze,{color:v?"green":"red",icon:v?s.jsx(yn,{}):s.jsx(Jl,{}),children:v?"Активен":"Неактивен"})},{title:"Действия",key:"actions",width:150,fixed:"right",render:(v,E)=>s.jsxs(Te,{children:[s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),onClick:()=>p(y,E),size:"small",children:"Редактировать"}),s.jsx(po,{title:"Удалить элемент?",onConfirm:()=>u(y,E.id),okText:"Да",cancelText:"Нет",children:s.jsx(Be,{type:"link",danger:!0,icon:s.jsx(Oi,{}),size:"small",children:"Удалить"})})]})}],[p,u]),x=M.useMemo(()=>t.map(y=>({key:y.id,label:y.name,children:s.jsxs("div",{children:[s.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx(eb,{level:4,style:{margin:0},children:y.name}),y.description&&s.jsx(tb,{type:"secondary",children:y.description})]}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:()=>f(y),children:"Добавить элемент"})]}),s.jsx(ir,{columns:h(y),dataSource:y.items.sort((v,E)=>(v.sortOrder||0)-(E.sortOrder||0)),rowKey:"id",pagination:{pageSize:20},size:"small"})]})})),[t,h,f]);return s.jsxs("div",{className:"reference-data-page",children:[s.jsxs(Ue,{children:[s.jsxs("div",{style:{marginBottom:16},children:[s.jsxs(eb,{level:3,style:{margin:0},children:[s.jsx(el,{})," Управление справочниками"]}),s.jsx(tb,{type:"secondary",style:{display:"block",marginTop:8},children:"Редактирование справочников, используемых во всех модулях системы"})]}),s.jsx(ri,{items:x})]}),s.jsx(cr,{title:l?"Редактировать элемент справочника":"Добавить элемент в справочник",open:i,onOk:g,onCancel:()=>o(!1),width:600,okText:"Сохранить",cancelText:"Отмена",children:s.jsxs(re,{form:A,layout:"vertical",initialValues:{isActive:!0,sortOrder:1},children:[s.jsx(re.Item,{name:"code",label:"Код (опционально)",children:s.jsx(Re,{placeholder:"Код элемента"})}),s.jsx(re.Item,{name:"name",label:"Наименование",rules:[{required:!0,message:"Введите наименование"}],children:s.jsx(Re,{placeholder:"Наименование элемента"})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(o$,{rows:3,placeholder:"Описание элемента"})}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"sortOrder",label:"Порядок сортировки",children:s.jsx(pa,{min:0,style:{width:"100%"},placeholder:"Порядок"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"isActive",label:"Активен",valuePropName:"checked",children:s.jsx(ms,{})})})]})]})})]})},{Title:c$,Text:Lu}=ht,A$=()=>{const[e,t]=M.useState(!1),[r,a]=M.useState(null),[n,i]=M.useState([]);M.useEffect(()=>{o()},[]);const o=()=>{try{const u=localStorage.getItem("norm_hours_settings"),g=u?JSON.parse(u):null,h=Object.entries(Pc).map(([x,y])=>{const v={"Подготовка СЗ":"Подготовка одного заключения с одним объектом","Подготовка СЗ (2 объекта)":"Подготовка заключения с двумя объектами","Подготовка СЗ (АЗС)":"Подготовка заключения для АЗС",Оценка:"Проведение оценки объекта",Экспертиза:"Проведение экспертизы",Рецензия:"Рецензирование документов",ПРКК:"Проверка рисков",Мониторинг:"Мониторинг объекта",Осмотр:"Осмотр объекта","Проверка документов":"Проверка комплектности документов",Согласование:"Согласование документов","Контроль качества":"Контроль качества работы",Отчетность:"Подготовка отчетности",Прочее:"Прочие задачи"};return{key:x,functionName:x,normHours:(g==null?void 0:g[x])??y,description:v[x]||"—"}});i(h)}catch(u){console.error("Ошибка загрузки нормочасов:",u),Ne.error("Ошибка загрузки нормочасов")}},l=(u,g)=>{const h=n.map(x=>x.key===u?{...x,normHours:g}:x);i(h),a(null)},c=()=>{try{t(!0);const u={};n.forEach(g=>{u[g.key]=g.normHours}),localStorage.setItem("norm_hours_settings",JSON.stringify(u)),Ne.success("Нормочасы успешно сохранены")}catch(u){console.error("Ошибка сохранения нормочасов:",u),Ne.error("Ошибка сохранения нормочасов")}finally{t(!1)}},A=()=>{const u=n.map(g=>({...g,normHours:Pc[g.key]||2}));i(u),Ne.info("Нормочасы сброшены к значениям по умолчанию")},d=[{title:"Функция",dataIndex:"functionName",key:"functionName",width:250,render:u=>s.jsx(Lu,{strong:!0,children:u})},{title:"Описание",dataIndex:"description",key:"description",ellipsis:!0},{title:"Нормочасы",dataIndex:"normHours",key:"normHours",width:200,align:"center",render:(u,g)=>r===g.key?s.jsxs(Te,{children:[s.jsx(pa,{min:.5,max:100,step:.5,value:u,onChange:x=>{x!==null&&l(g.key,x)},onPressEnter:()=>a(null),autoFocus:!0,style:{width:100}}),s.jsx(Lu,{type:"secondary",children:"часов"})]}):s.jsxs(Te,{children:[s.jsxs(Ze,{color:"blue",style:{fontSize:"14px",padding:"4px 12px"},children:[u," ч"]}),s.jsx(Be,{type:"link",icon:s.jsx(Rs,{}),size:"small",onClick:()=>a(g.key)})]})},{title:"В рабочих днях",key:"workDays",width:150,align:"center",render:(u,g)=>{const h=(g.normHours/b2).toFixed(1);return s.jsxs(Lu,{type:"secondary",children:[h," дн."]})}}],f=n.reduce((u,g)=>u+g.normHours,0),p=n.length>0?(f/n.length).toFixed(1):"0";return s.jsx("div",{className:"norm-hours-page",style:{padding:"24px"},children:s.jsxs(Ue,{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[s.jsxs("div",{children:[s.jsxs(c$,{level:2,style:{margin:0},children:[s.jsx(Vn,{style:{marginRight:8}}),"Нормочасы по функциям"]}),s.jsx(Lu,{type:"secondary",style:{marginTop:8,display:"block"},children:"Управление нормочасами для расчета загрузки сотрудников"})]}),s.jsxs(Te,{children:[s.jsx(Be,{icon:s.jsx(Zl,{}),onClick:A,children:"Сбросить"}),s.jsx(Be,{type:"primary",icon:s.jsx(sm,{}),onClick:c,loading:e,children:"Сохранить"})]})]}),s.jsx(jt,{}),s.jsxs(dt,{gutter:16,style:{marginBottom:24},children:[s.jsx(be,{xs:24,sm:8,children:s.jsx(pt,{title:"Рабочих часов в день",value:b2,suffix:"ч",valueStyle:{color:"#1890ff"}})}),s.jsx(be,{xs:24,sm:8,children:s.jsx(pt,{title:"Рабочих дней в месяце",value:bS,suffix:"дн",valueStyle:{color:"#52c41a"}})}),s.jsx(be,{xs:24,sm:8,children:s.jsx(pt,{title:"Рабочих часов в месяц",value:Xl,suffix:"ч",valueStyle:{color:"#722ed1"}})})]}),s.jsxs(dt,{gutter:16,style:{marginBottom:24},children:[s.jsx(be,{xs:24,sm:12,children:s.jsx(pt,{title:"Среднее нормочасов на функцию",value:p,suffix:"ч",valueStyle:{color:"#fa8c16"}})}),s.jsx(be,{xs:24,sm:12,children:s.jsx(pt,{title:"Всего нормочасов (сумма)",value:f.toFixed(1),suffix:"ч",valueStyle:{color:"#eb2f96"}})})]}),s.jsx(jt,{}),s.jsx(ir,{columns:d,dataSource:n,pagination:!1,size:"middle",rowKey:"key"}),s.jsx("div",{style:{marginTop:24,padding:"16px",background:"#f5f5f5",borderRadius:"4px"},children:s.jsxs(Lu,{type:"secondary",style:{fontSize:"12px"},children:[s.jsx("strong",{children:"Примечание:"})," Изменения вступят в силу после сохранения. Нормочасы используются для расчета загрузки сотрудников при генерации задач и в аналитике KPI. Для расчета загрузки используется формула:"," ",s.jsx("code",{children:"Загрузка (%) = (Сумма нормочасов задач в работе / Рабочих часов в месяц) × 100%"})]})})]})})},{Title:d$,Text:u$}=ht,f$=[{name:"totalPortfolioValue",label:"Общая стоимость портфеля, ₽",min:0,step:1e6},{name:"totalContracts",label:"Всего договоров",min:0,step:1},{name:"activeContracts",label:"Активных договоров",min:0,step:1},{name:"completedTasks",label:"Выполнено задач",min:0,step:1},{name:"pendingTasks",label:"В работе задач",min:0,step:1},{name:"overdueTasks",label:"Просрочено задач",min:0,step:1},{name:"totalConclusions",label:"Залоговых заключений",min:0,step:1},{name:"approvedConclusions",label:"Согласовано заключений",min:0,step:1},{name:"pendingConclusions",label:"На согласовании",min:0,step:1},{name:"totalObjects",label:"Объектов в реестре",min:0,step:1},{name:"totalInsurance",label:"Всего страховок",min:0,step:1},{name:"activeInsurance",label:"Активных страховок",min:0,step:1}],p$=[{name:"averageConclusionDays",label:"Средний срок подготовки СЗ, дней",min:0,step:.1},{name:"slaCompliance",label:"Выполнение SLA, %",min:0,max:150,step:1},{name:"currentWorkload",label:"Текущая загрузка, %",min:0,max:200,step:1},{name:"mboCompletionOverall",label:"MBO департамента, %",min:0,max:200,step:1}],h$=()=>{const[e]=re.useForm(),[t,r]=M.useState(!0),[a,n]=M.useState(!1),[i,o]=M.useState(()=>rm()),[l,c]=M.useState({});M.useEffect(()=>{const g=KV()??rm(),h=BS(),x=TS(g,h||void 0);o(g),e.setFieldsValue({...x,workloadByPeriod:{...g.workloadByPeriod,...(h==null?void 0:h.workloadByPeriod)||{}}}),c(SS()),r(!1)},[e]);const A=M.useMemo(()=>Xs.map(g=>({key:g.code,code:g.code,name:g.name})),[]),d=(g,h)=>{c(x=>{const y={...x};return h===null||Number.isNaN(h)?delete y[g]:y[g]=h,y})},f=async()=>{try{const g=await e.validateFields();n(!0);const h={...g,workloadByPeriod:{...i.workloadByPeriod,...g.workloadByPeriod||{}}};MV(h),QV(l),Ne.success("Метрики KPI и MBO сохранены")}catch(g){g instanceof Error&&Ne.error(g.message)}finally{n(!1)}},p=()=>{e.setFieldsValue({...i,workloadByPeriod:{...i.workloadByPeriod}}),c({}),PV(),qV(),Ne.success("Корректировки сброшены")},u=[{title:"Региональный центр",dataIndex:"name",key:"name"},{title:"Целевой MBO, %",dataIndex:"code",key:"code",width:200,render:g=>s.jsx(pa,{min:0,max:200,value:l[g],onChange:h=>d(g,h),style:{width:"100%"}})}];return t?s.jsx("div",{className:"metrics-page__loading",children:"Загрузка метрик..."}):s.jsxs("div",{className:"metrics-page",children:[s.jsxs("div",{className:"metrics-page__header",children:[s.jsxs("div",{children:[s.jsx(d$,{level:3,style:{marginBottom:0},children:"Настройка KPI и MBO"}),s.jsx(u$,{type:"secondary",children:"Корректируйте значения, которые отображаются на странице KPI"})]}),s.jsxs(Te,{children:[s.jsx(Be,{icon:s.jsx(ZT,{}),onClick:p,children:"Сбросить"}),s.jsx(Be,{type:"primary",icon:s.jsx(sm,{}),onClick:f,loading:a,children:"Сохранить"})]})]}),s.jsx(Nr,{type:"info",showIcon:!0,style:{marginBottom:16},message:"Внесенные значения применяются как корректировки поверх фактических данных KPI."}),s.jsxs(re,{layout:"vertical",form:e,children:[s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(tA,{}),s.jsx("span",{children:"Основные метрики"})]}),size:"small",className:"metrics-card",children:s.jsx(dt,{gutter:[16,16],children:f$.map(g=>s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(re.Item,{name:g.name,label:g.label,rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:g.min??0,step:g.step??1,style:{width:"100%"}})})},g.name))})}),s.jsx(Ue,{title:s.jsxs(Te,{children:[s.jsx(Kc,{}),s.jsx("span",{children:"Показатели SLA и загрузки"})]}),size:"small",className:"metrics-card",children:s.jsxs(dt,{gutter:[16,16],children:[p$.map(g=>s.jsx(be,{xs:24,sm:12,lg:6,children:s.jsx(re.Item,{name:g.name,label:g.label,rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:g.min??0,max:g.max,step:g.step??1,style:{width:"100%"}})})},g.name)),s.jsx(be,{xs:24,sm:8,children:s.jsx(re.Item,{name:["workloadByPeriod","last7Days"],label:"Загрузка за 7 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:0,max:200,style:{width:"100%"}})})}),s.jsx(be,{xs:24,sm:8,children:s.jsx(re.Item,{name:["workloadByPeriod","last30Days"],label:"Загрузка за 30 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:0,max:200,style:{width:"100%"}})})}),s.jsx(be,{xs:24,sm:8,children:s.jsx(re.Item,{name:["workloadByPeriod","last90Days"],label:"Загрузка за 90 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:0,max:200,style:{width:"100%"}})})})]})}),s.jsxs(Ue,{title:s.jsxs(Te,{children:[s.jsx(bd,{}),s.jsx("span",{children:"Настройка MBO"})]}),size:"small",className:"metrics-card",children:[s.jsx(dt,{gutter:[16,16],children:s.jsx(be,{xs:24,md:8,children:s.jsx(re.Item,{name:"mboCompletionOverall",label:"MBO департамента, %",rules:[{required:!0,message:"Укажите значение"}],children:s.jsx(pa,{min:0,max:200,style:{width:"100%"}})})})}),s.jsx(jt,{}),s.jsx(ir,{columns:u,dataSource:A,pagination:!1,size:"small"})]})]})]})},Uu="cms_appraisal_companies";class m${getCompanies(){const t=localStorage.getItem(Uu);return t?JSON.parse(t):[]}saveCompanies(t){try{localStorage.removeItem(Uu),localStorage.setItem(Uu,JSON.stringify(t))}catch(r){if(r.name==="QuotaExceededError"){console.warn("Очищаем localStorage для освобождения места...");const a=[];for(let n=0;n<localStorage.length;n++){const i=localStorage.key(n);i&&(i.includes("appraisal")||i.includes("cms_"))&&a.push(i)}a.forEach(n=>localStorage.removeItem(n)),localStorage.setItem(Uu,JSON.stringify(t))}else throw r}}getAll(){return this.getCompanies()}getById(t){return this.getCompanies().find(r=>r.id===t)}create(t){const r=this.getCompanies(),a={...t,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveCompanies(r),a}update(t,r){const a=this.getCompanies(),n=a.findIndex(o=>o.id===t);if(n===-1)return;const i={...a[n],...r,updatedAt:new Date().toISOString()};return a[n]=i,this.saveCompanies(a),i}delete(t){const r=this.getCompanies().filter(a=>a.id!==t);this.saveCompanies(r)}async loadFromExcelFile(t,r=20,a=!1){try{console.log("Парсинг Excel файла:",t.name,t.size);const n=await t.arrayBuffer();console.log("Размер данных:",n.byteLength);const i=dA(n,{type:"array"});if(console.log("Листы в файле:",i.SheetNames),i.SheetNames.length===0)return console.error("В файле нет листов"),0;const o=i.Sheets[i.SheetNames[0]];let l=0;const c=fs.decode_range(o["!ref"]||"A1");for(let h=0;h<Math.min(10,c.e.r+1);h++){const x=[];for(let v=0;v<=Math.min(20,c.e.c);v++){const E=fs.encode_cell({r:h,c:v}),k=o[E];k&&k.v&&x.push(String(k.v).toLowerCase())}const y=["наименование","инн","огрн","адрес","руководитель"];if(x.some(v=>y.some(E=>v.includes(E)))){l=h,console.log(`Найдена строка заголовка: ${h+1}`);break}}let A;if(l>0){const h=fs.encode_range({s:{r:l,c:0},e:c.e});o["!ref"]=h,A=fs.sheet_to_json(o,{defval:""}),o["!ref"]=fs.encode_range(c)}else A=fs.sheet_to_json(o,{defval:""});if(console.log("Всего строк в файле:",A.length),A.length===0)return console.warn("Файл не содержит данных"),0;if(A.length>0){const h=A[0];console.log("Ключи первой строки:",Object.keys(h)),console.log("Первая строка (первые 5 полей):",Object.entries(h).slice(0,5))}const d=A.slice(0,r);console.log(`Обрабатываем первые ${d.length} строк из ${A.length}`),a&&(console.log("Очищаем существующие данные перед импортом..."),localStorage.removeItem(Uu));const f=a?[]:this.getCompanies(),p=[];let u=0,g=0;for(const h of d)try{const x=Object.keys(h);let y="";for(const k of x){const S=h[k];if(S&&typeof S=="string"&&S.trim().length>3&&!/^\d+$/.test(S.trim())){y=S.trim();break}}if(y||(y=this.findFieldValue(h,["Наименование","наименование","Название","название","Компания","компания","Организация","организация"],"")),!y||y.trim().length===0){console.warn("Пропущена строка без названия:",x),g++;continue}const v={name:String(y).trim(),inn:this.findFieldValue(h,["ИНН","инн","ИНН/КПП","инн/кпп"],""),ogrn:this.findFieldValue(h,["ОГРН","огрн"],""),address:this.findFieldValue(h,["Адрес","адрес","Адрес регистрации","адрес регистрации"],""),phone:this.findFieldValue(h,["Телефон","телефон","Тел","тел"],""),email:this.findFieldValue(h,["Email","email","E-mail","e-mail"],""),website:this.findFieldValue(h,["Сайт","сайт","Website","website","Веб-сайт","веб-сайт","Адрес сайта","адрес сайта"],""),director:this.findFieldValue(h,["Руководитель","руководитель","Директор","директор","Генеральный директор","генеральный директор"],""),accreditationDate:this.findFieldValue(h,["Дата аккредитации","дата аккредитации"])?this.parseDate(this.findFieldValue(h,["Дата аккредитации","дата аккредитации"])):void 0,certificateExpiryDate:this.findFieldValue(h,["Срок действия сертификатов","срок действия сертификатов","Сертификаты до","сертификаты до"])?this.parseDate(this.findFieldValue(h,["Срок действия сертификатов","срок действия сертификатов","Сертификаты до","сертификаты до"])):void 0,insuranceExpiryDate:this.findFieldValue(h,["Срок действия страхования","срок действия страхования","Страхование до","страхование до"])?this.parseDate(this.findFieldValue(h,["Срок действия страхования","срок действия страхования","Страхование до","страхование до"])):void 0,sroMembership:this.parseBoolean(this.findFieldValue(h,["Членство в СРО","членство в сро","СРО","сро","Член СРО","член сро"],!1)),status:this.parseStatus(this.findFieldValue(h,["Статус","статус","Статус аккредитации","статус аккредитации"],"active")),notes:this.findFieldValue(h,["Примечания","примечания","Комментарий","комментарий"],"")};if(v.inn&&(v.inn=String(v.inn).split("/")[0].trim()),v.ogrn&&(v.ogrn=String(v.ogrn).trim()),v.address&&(v.address=String(v.address).trim()),v.phone&&(v.phone=String(v.phone).trim()),v.email&&(v.email=String(v.email).trim()),v.website&&(v.website=String(v.website).trim()),v.director&&(v.director=String(v.director).trim()),v.notes&&(v.notes=String(v.notes).trim()),f.some(k=>k.inn&&v.inn&&k.inn===v.inn||v.name&&k.name.toLowerCase()===v.name.toLowerCase()))g++;else{const k={...v,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};p.push(k),f.push(k),u++}}catch(x){console.warn("Ошибка обработки строки:",x==null?void 0:x.message),g++}if(p.length>0||a)try{const h=a?p:f,x=JSON.stringify(h),y=new Blob([x]).size;console.log(`Размер данных для сохранения: ${(y/1024).toFixed(2)} KB`),this.saveCompanies(h),console.log(`Сохранено ${h.length} компаний в localStorage`)}catch(h){console.error("Ошибка сохранения в localStorage:",h);try{console.warn("Пробуем очистить localStorage и сохранить только новые компании...");const x=[];for(let y=0;y<localStorage.length;y++){const v=localStorage.key(y);v&&v.includes("appraisal")&&x.push(v)}x.forEach(y=>{console.log(`Удаляем ключ: ${y}`),localStorage.removeItem(y)}),this.saveCompanies(p),console.log("Очищен localStorage, сохранены только новые компании")}catch(x){console.error("Критическая ошибка сохранения:",x);try{console.warn("Пробуем сохранить только первые 10 компаний...");for(let y=localStorage.length-1;y>=0;y--){const v=localStorage.key(y);v&&v.includes("appraisal")&&localStorage.removeItem(v)}this.saveCompanies(p.slice(0,10)),console.log("Сохранены только первые 10 компаний из-за ограничений localStorage")}catch(y){console.error("Невозможно сохранить данные:",y);let v=0;for(let E=0;E<localStorage.length;E++){const k=localStorage.key(E);if(k){const S=localStorage.getItem(k)||"";v+=k.length+S.length}}throw console.error(`Общий размер localStorage: ${(v/1024).toFixed(2)} KB`),y}}}return console.log(`Импорт завершен: импортировано ${u}, пропущено ${g}`),u}catch(n){throw console.error("Ошибка загрузки Excel файла:",n),console.error("Детали ошибки:",n.message,n.stack),n}}parseDate(t){if(t){if(typeof t=="number"){const r=new Date(1899,11,30);return new Date(r.getTime()+t*24*60*60*1e3).toISOString()}if(typeof t=="string"){const r=new Date(t);if(!isNaN(r.getTime()))return r.toISOString()}}}findFieldValue(t,r,a=""){for(const n of r)if(t[n]!==void 0&&t[n]!==null&&t[n]!=="")return t[n];return a}parseStatus(t){if(!t)return"active";const r=t.toLowerCase();return r.includes("актив")||r.includes("действ")?"active":r.includes("приостанов")||r.includes("приост")?"suspended":r.includes("отозван")||r.includes("аннул")?"revoked":"active"}parseBoolean(t){if(typeof t=="boolean")return t;if(typeof t=="string"){const r=t.toLowerCase().trim();return r==="да"||r==="yes"||r==="true"||r==="1"||r==="✓"}return typeof t=="number"?t===1:!1}createDemoCompanies(t=20){const r=this.getCompanies(),i=[{id:crypto.randomUUID(),name:'ООО "Оценка-Профи"',inn:"7701234567",ogrn:"1027701234567",address:"г. Москва, ул. Тверская, д. 10, офис 101",phone:"+7 (495) 123-45-67",email:"info@ocenka-profi.ru",director:"Иванов Иван Иванович",accreditationDate:"2020-01-15T00:00:00.000Z",certificateExpiryDate:"2025-12-31T00:00:00.000Z",insuranceExpiryDate:"2025-12-31T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Эксперт-Оценка"',inn:"7702345678",ogrn:"1027702345678",address:"г. Москва, ул. Ленинградская, д. 25, офис 205",phone:"+7 (495) 234-56-78",email:"contact@expert-ocenka.ru",director:"Петрова Мария Сергеевна",accreditationDate:"2019-03-20T00:00:00.000Z",certificateExpiryDate:"2025-06-30T00:00:00.000Z",insuranceExpiryDate:"2025-06-30T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Независимая оценка"',inn:"7703456789",ogrn:"1027703456789",address:"г. Санкт-Петербург, Невский пр., д. 50, офис 301",phone:"+7 (812) 345-67-89",email:"info@nezavisimaya-ocenka.ru",director:"Сидоров Петр Александрович",accreditationDate:"2021-05-10T00:00:00.000Z",certificateExpiryDate:"2026-05-10T00:00:00.000Z",insuranceExpiryDate:"2026-05-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Центр оценки недвижимости"',inn:"7704567890",ogrn:"1027704567890",address:"г. Москва, ул. Арбат, д. 15, офис 402",phone:"+7 (495) 456-78-90",email:"office@centr-ocenki.ru",director:"Козлова Анна Владимировна",accreditationDate:"2018-07-15T00:00:00.000Z",certificateExpiryDate:"2024-12-31T00:00:00.000Z",insuranceExpiryDate:"2024-12-31T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Альфа"',inn:"7705678901",ogrn:"1027705678901",address:"г. Екатеринбург, ул. Ленина, д. 30, офис 501",phone:"+7 (343) 567-89-01",email:"info@alfa-ocenka.ru",director:"Морозов Дмитрий Николаевич",accreditationDate:"2020-09-01T00:00:00.000Z",certificateExpiryDate:"2025-09-01T00:00:00.000Z",insuranceExpiryDate:"2025-09-01T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Профессиональная оценка"',inn:"7706789012",ogrn:"1027706789012",address:"г. Новосибирск, ул. Красный проспект, д. 20, офис 102",phone:"+7 (383) 678-90-12",email:"contact@prof-ocenka.ru",director:"Волкова Елена Игоревна",accreditationDate:"2019-11-20T00:00:00.000Z",certificateExpiryDate:"2025-11-20T00:00:00.000Z",insuranceExpiryDate:"2025-11-20T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Сервис"',inn:"7707890123",ogrn:"1027707890123",address:"г. Казань, ул. Баумана, д. 40, офис 203",phone:"+7 (843) 789-01-23",email:"info@ocenka-service.ru",director:"Новиков Сергей Викторович",accreditationDate:"2021-02-14T00:00:00.000Z",certificateExpiryDate:"2026-02-14T00:00:00.000Z",insuranceExpiryDate:"2026-02-14T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Экспертиза и оценка"',inn:"7708901234",ogrn:"1027708901234",address:"г. Нижний Новгород, ул. Покровка, д. 12, офис 304",phone:"+7 (831) 890-12-34",email:"office@expertiza-ocenka.ru",director:"Смирнова Ольга Петровна",accreditationDate:"2020-06-25T00:00:00.000Z",certificateExpiryDate:"2025-06-25T00:00:00.000Z",insuranceExpiryDate:"2025-06-25T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное агентство Бета"',inn:"7709012345",ogrn:"1027709012345",address:"г. Челябинск, ул. Кирова, д. 100, офис 405",phone:"+7 (351) 901-23-45",email:"info@beta-ocenka.ru",director:"Лебедев Андрей Михайлович",accreditationDate:"2019-08-10T00:00:00.000Z",certificateExpiryDate:"2025-08-10T00:00:00.000Z",insuranceExpiryDate:"2025-08-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Консалт"',inn:"7710123456",ogrn:"1027710123456",address:"г. Ростов-на-Дону, ул. Большая Садовая, д. 55, офис 506",phone:"+7 (863) 012-34-56",email:"contact@ocenka-konsult.ru",director:"Федорова Татьяна Алексеевна",accreditationDate:"2021-04-05T00:00:00.000Z",certificateExpiryDate:"2026-04-05T00:00:00.000Z",insuranceExpiryDate:"2026-04-05T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Стандарт-Оценка"',inn:"7711234567",ogrn:"1027711234567",address:"г. Уфа, ул. Ленина, д. 70, офис 107",phone:"+7 (347) 123-45-67",email:"info@standart-ocenka.ru",director:"Кузнецов Игорь Сергеевич",accreditationDate:"2020-10-12T00:00:00.000Z",certificateExpiryDate:"2025-10-12T00:00:00.000Z",insuranceExpiryDate:"2025-10-12T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная группа Гамма"',inn:"7712345678",ogrn:"1027712345678",address:"г. Воронеж, пр. Революции, д. 33, офис 208",phone:"+7 (473) 234-56-78",email:"office@gamma-ocenka.ru",director:"Орлова Наталья Дмитриевна",accreditationDate:"2019-12-18T00:00:00.000Z",certificateExpiryDate:"2025-12-18T00:00:00.000Z",insuranceExpiryDate:"2025-12-18T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Трейд"',inn:"7713456789",ogrn:"1027713456789",address:"г. Краснодар, ул. Красная, д. 22, офис 309",phone:"+7 (861) 345-67-89",email:"info@ocenka-trade.ru",director:"Соколов Владимир Анатольевич",accreditationDate:"2021-01-30T00:00:00.000Z",certificateExpiryDate:"2026-01-30T00:00:00.000Z",insuranceExpiryDate:"2026-01-30T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное бюро Дельта"',inn:"7714567890",ogrn:"1027714567890",address:"г. Самара, ул. Московское шоссе, д. 18, офис 410",phone:"+7 (846) 456-78-90",email:"contact@delta-ocenka.ru",director:"Попова Светлана Валерьевна",accreditationDate:"2020-03-22T00:00:00.000Z",certificateExpiryDate:"2025-03-22T00:00:00.000Z",insuranceExpiryDate:"2025-03-22T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Профессиональная экспертиза"',inn:"7715678901",ogrn:"1027715678901",address:"г. Омск, ул. Ленина, д. 45, офис 511",phone:"+7 (381) 567-89-01",email:"info@prof-expertiza.ru",director:"Васильев Роман Олегович",accreditationDate:"2019-07-08T00:00:00.000Z",certificateExpiryDate:"2025-07-08T00:00:00.000Z",insuranceExpiryDate:"2025-07-08T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Инвест"',inn:"7716789012",ogrn:"1027716789012",address:"г. Пермь, ул. Ленина, д. 60, офис 112",phone:"+7 (342) 678-90-12",email:"office@ocenka-invest.ru",director:"Михайлова Екатерина Сергеевна",accreditationDate:"2021-06-15T00:00:00.000Z",certificateExpiryDate:"2026-06-15T00:00:00.000Z",insuranceExpiryDate:"2026-06-15T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Эпсилон"',inn:"7717890123",ogrn:"1027717890123",address:"г. Волгоград, пр. Ленина, д. 28, офис 213",phone:"+7 (844) 789-01-23",email:"info@epsilon-ocenka.ru",director:"Тарасов Алексей Владимирович",accreditationDate:"2020-08-20T00:00:00.000Z",certificateExpiryDate:"2025-08-20T00:00:00.000Z",insuranceExpiryDate:"2025-08-20T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Плюс"',inn:"7718901234",ogrn:"1027718901234",address:"г. Красноярск, ул. Мира, д. 35, офис 314",phone:"+7 (391) 890-12-34",email:"contact@ocenka-plus.ru",director:"Романова Ирина Николаевна",accreditationDate:"2019-09-25T00:00:00.000Z",certificateExpiryDate:"2025-09-25T00:00:00.000Z",insuranceExpiryDate:"2025-09-25T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное агентство Зета"',inn:"7719012345",ogrn:"1027719012345",address:"г. Саратов, ул. Московская, д. 50, офис 415",phone:"+7 (845) 901-23-45",email:"info@zeta-ocenka.ru",director:"Борисов Денис Игоревич",accreditationDate:"2021-03-10T00:00:00.000Z",certificateExpiryDate:"2026-03-10T00:00:00.000Z",insuranceExpiryDate:"2026-03-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Менеджмент"',inn:"7720123456",ogrn:"1027720123456",address:"г. Тюмень, ул. Республики, д. 40, офис 516",phone:"+7 (345) 012-34-56",email:"office@ocenka-management.ru",director:"Григорьева Марина Александровна",accreditationDate:"2020-11-05T00:00:00.000Z",certificateExpiryDate:"2025-11-05T00:00:00.000Z",insuranceExpiryDate:"2025-11-05T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Эта"',inn:"7721234567",ogrn:"1027721234567",address:"г. Ижевск, ул. Пушкинская, д. 25, офис 117",phone:"+7 (341) 123-45-67",email:"info@eta-ocenka.ru",director:"Комаров Павел Викторович",accreditationDate:"2019-05-14T00:00:00.000Z",certificateExpiryDate:"2025-05-14T00:00:00.000Z",insuranceExpiryDate:"2025-05-14T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}].slice(0,t).filter(o=>!r.some(l=>l.inn===o.inn||l.name.toLowerCase()===o.name.toLowerCase()));if(i.length>0){const o=[...r,...i];this.saveCompanies(o),console.log(`Создано ${i.length} демо-компаний`)}return i.length}async loadInitialData(t=!1,r=20){if(localStorage.getItem("cms_appraisal_companies_initial_data_loaded")==="true"&&!t)return console.log("Начальные данные уже загружены, пропускаем"),0;try{console.log("Начинаем загрузку начальных данных из reestr_otsenschikov.xls (лимит:",r,")...");const n=await fetch("/reestr_apr/reestr_otsenschikov.xls");if(!n.ok){console.warn("Файл reestr_otsenschikov.xls не найден, создаем демо-данные:",n.status,n.statusText);const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}const i=await n.blob();if(console.log("Файл загружен, размер:",i.size,"байт"),i.size===0){console.warn("Файл пуст, создаем демо-данные");const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}const o=new File([i],"reestr_otsenschikov.xls",{type:"application/vnd.ms-excel"}),l=await this.loadFromExcelFile(o,r);if(console.log("Импортировано компаний:",l),l===0){console.warn("Из файла ничего не импортировано, создаем демо-данные");const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}return l>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),l}catch(n){console.error("Ошибка загрузки начальных данных:",n),console.error("Детали ошибки:",n.message,n.stack),console.warn("Создаем демо-данные из-за ошибки загрузки файла");const i=this.createDemoCompanies(r);return i>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),i}}}const Nc=new m$,{TextArea:rb}=Re,g$=({initialValues:e,onSubmit:t,onCancel:r,loading:a})=>{const[n]=re.useForm();M.useEffect(()=>{e?n.setFieldsValue({...e,accreditationDate:e.accreditationDate?We(e.accreditationDate):null,certificateExpiryDate:e.certificateExpiryDate?We(e.certificateExpiryDate):null,insuranceExpiryDate:e.insuranceExpiryDate?We(e.insuranceExpiryDate):null}):(n.resetFields(),n.setFieldsValue({status:"active"}))},[e,n]);const i=o=>{const l={...o,accreditationDate:o.accreditationDate?o.accreditationDate.toISOString():null,certificateExpiryDate:o.certificateExpiryDate?o.certificateExpiryDate.toISOString():null,insuranceExpiryDate:o.insuranceExpiryDate?o.insuranceExpiryDate.toISOString():null};t(l)};return s.jsxs(re,{form:n,layout:"vertical",onFinish:i,disabled:a,children:[s.jsxs(Ue,{title:"Основная информация",size:"small",style:{marginBottom:16},children:[s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"name",label:"Наименование компании",rules:[{required:!0,message:"Введите наименование компании"}],children:s.jsx(Re,{placeholder:'ООО "Название компании"'})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"status",label:"Статус аккредитации",children:s.jsxs(Ve,{children:[s.jsx(Ve.Option,{value:"active",children:"Активна"}),s.jsx(Ve.Option,{value:"suspended",children:"Приостановлена"}),s.jsx(Ve.Option,{value:"revoked",children:"Отозвана"})]})})})]}),s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"inn",label:"ИНН",children:s.jsx(Re,{placeholder:"1234567890"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"ogrn",label:"ОГРН",children:s.jsx(Re,{placeholder:"1234567890123"})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"accreditationDate",label:"Дата аккредитации",children:s.jsx(Dr,{style:{width:"100%"}})})})]})]}),s.jsx(Ue,{title:"Контактная информация",size:"small",style:{marginBottom:16},children:s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"address",label:"Адрес",children:s.jsx(rb,{rows:2,placeholder:"Полный адрес компании"})})}),s.jsxs(be,{span:12,children:[s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"phone",label:"Телефон",children:s.jsx(Re,{placeholder:"+7 (999) 123-45-67"})})}),s.jsx(be,{span:12,children:s.jsx(re.Item,{name:"email",label:"Email",children:s.jsx(Re,{placeholder:"info@company.ru"})})})]}),s.jsx(re.Item,{name:"website",label:"Сайт",children:s.jsx(Re,{placeholder:"https://www.company.ru"})})]})]})}),s.jsx(Ue,{title:"Сертификаты и страхование",size:"small",style:{marginBottom:16},children:s.jsxs(dt,{gutter:16,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"certificateExpiryDate",label:"Срок действия сертификатов",children:s.jsx(Dr,{style:{width:"100%"}})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"insuranceExpiryDate",label:"Срок действия страхования",children:s.jsx(Dr,{style:{width:"100%"}})})}),s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"sroMembership",label:"Членство в СРО",valuePropName:"checked",children:s.jsx(ec,{children:"Да, является членом СРО"})})})]})}),s.jsx(Ue,{title:"Дополнительная информация",size:"small",style:{marginBottom:16},children:s.jsx(re.Item,{name:"notes",label:"Примечания",children:s.jsx(rb,{rows:4,placeholder:"Дополнительная информация о компании"})})}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[s.jsx(Be,{onClick:r,children:"Отмена"}),s.jsx(Be,{type:"primary",htmlType:"submit",loading:a,children:"Сохранить"})]})]})},x$=()=>{const[e,t]=M.useState([]),[r,a]=M.useState(!1),[n,i]=M.useState(null),[o,l]=M.useState(!1),[c,A]=M.useState(""),[d,f]=M.useState(!1);M.useEffect(()=>{(async()=>{try{const O=await Nc.loadInitialData();O>0?Ne.success(`Загружено компаний из реестра: ${O}`):localStorage.getItem("cms_appraisal_companies_initial_data_loaded")!=="true"&&Ne.warning("Не удалось загрузить данные из файла. Проверьте консоль для деталей.")}catch(O){console.error("Ошибка инициализации данных:",O),Ne.error(`Ошибка загрузки данных: ${O.message||"Неизвестная ошибка"}`)}finally{p()}})()},[]);const p=()=>{t(Nc.getAll())},u=()=>{i(null),a(!0)},g=b=>{i(b),a(!0)},h=b=>{cr.confirm({title:"Удалить компанию?",content:"Это действие нельзя отменить",onOk:()=>{Nc.delete(b),Ne.success("Компания удалена"),p()}})},x=b=>{Ne.info(`Запрос документов для компании "${b.name}" отправлен`)},y=async b=>{f(!0);try{let O=0;if(b.name.endsWith(".xls")||b.name.endsWith(".xlsx"))return O=await Nc.loadFromExcelFile(b,20,!0),Ne.success(`Импортировано компаний: ${O}`),p(),f(!1),!1;const _=await b.text();let U=[];if(b.name.endsWith(".json"))U=JSON.parse(_);else{const I=_.split(`
`).filter(L=>L.trim()),R=I[0].split(/\t|,/).map(L=>L.trim());for(let L=1;L<I.length;L++){const N=I[L].split(/\t|,/).map(Q=>Q.trim()),P={};R.forEach((Q,Y)=>{const ee=N[Y]||"";Q.toLowerCase().includes("наименование")||Q.toLowerCase().includes("название")?P.name=ee:Q.toLowerCase().includes("инн")?P.inn=ee:Q.toLowerCase().includes("огрн")?P.ogrn=ee:Q.toLowerCase().includes("адрес")?P.address=ee:Q.toLowerCase().includes("телефон")?P.phone=ee:Q.toLowerCase().includes("email")?P.email=ee:Q.toLowerCase().includes("руководитель")||Q.toLowerCase().includes("директор")?P.director=ee:Q.toLowerCase().includes("лицензия")?P.licenseNumber=ee:P[Q]=ee}),P.name&&U.push({...P,status:"active"})}}for(const I of U)I.name&&(Nc.create(I),O++);Ne.success(`Импортировано компаний: ${O}`),p()}catch(O){console.error("Ошибка импорта:",O),Ne.error(`Ошибка импорта файла: ${O.message||"Неизвестная ошибка"}`)}finally{f(!1)}return!1},v={beforeUpload:b=>(y(b),!1),showUploadList:!1,accept:".csv,.tsv,.txt,.json,.xls,.xlsx"},E=b=>{l(!0);try{n?(Nc.update(n.id,b),Ne.success("Компания обновлена")):(Nc.create(b),Ne.success("Компания создана")),a(!1),p()}catch{Ne.error("Ошибка при сохранении")}finally{l(!1)}},k=M.useMemo(()=>{const b=c.trim().toLowerCase();return e.filter(O=>!b||[O.name,O.inn,O.address,O.phone,O.website].filter(Boolean).some(_=>String(_).toLowerCase().includes(b)))},[e,c]),S=M.useMemo(()=>{const b=k.length,O=k.filter(I=>I.status==="active").length,_=k.filter(I=>I.status==="suspended").length,U=k.filter(I=>I.status==="revoked").length;return{total:b,active:O,suspended:_,revoked:U}},[k]),B=[{title:"Наименование",dataIndex:"name",key:"name",width:250,render:(b,O)=>s.jsx(Be,{type:"link",onClick:()=>g(O),style:{padding:0},children:b})},{title:"ИНН",dataIndex:"inn",key:"inn",width:120},{title:"Адрес",dataIndex:"address",key:"address",ellipsis:!0,width:300},{title:"Сайт",dataIndex:"website",key:"website",width:200,render:b=>b?s.jsx("a",{href:b.startsWith("http")?b:`https://${b}`,target:"_blank",rel:"noopener noreferrer",children:b}):s.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Телефон",dataIndex:"phone",key:"phone",width:150},{title:"Срок действия сертификатов",dataIndex:"certificateExpiryDate",key:"certificateExpiryDate",width:180,render:b=>b?s.jsx("span",{children:new Date(b).toLocaleDateString("ru-RU")}):s.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Срок действия страхования",dataIndex:"insuranceExpiryDate",key:"insuranceExpiryDate",width:180,render:b=>b?s.jsx("span",{children:new Date(b).toLocaleDateString("ru-RU")}):s.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Членство в СРО",dataIndex:"sroMembership",key:"sroMembership",width:140,render:b=>s.jsx(Ze,{color:b?"green":"default",children:b?"Да":"Нет"})},{title:"Статус",dataIndex:"status",key:"status",width:120,render:b=>{const O={active:"green",suspended:"orange",revoked:"red"},_={active:"Активна",suspended:"Приостановлена",revoked:"Отозвана"};return s.jsx(Ze,{color:O[b]||"default",children:_[b]||b})}},{title:"Действия",key:"actions",width:200,fixed:"right",render:(b,O)=>s.jsxs(Te,{children:[s.jsx(Be,{icon:s.jsx(jr,{}),size:"small",onClick:()=>x(O),title:"Запросить документы",children:"Документы"}),s.jsx(Be,{icon:s.jsx(Rs,{}),size:"small",onClick:()=>g(O),title:"Редактировать"}),s.jsx(Be,{icon:s.jsx(Oi,{}),size:"small",danger:!0,onClick:()=>h(O.id),title:"Удалить"})]})}];return s.jsxs("div",{className:"appraisal-companies-page",children:[s.jsxs("div",{style:{marginBottom:16},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[s.jsx("h2",{style:{margin:0},children:"Реестр оценочных компаний"}),s.jsxs(Te,{children:[s.jsx(Js,{...v,children:s.jsx(Be,{icon:s.jsx(Ns,{}),loading:d,children:"Импорт из файла"})}),s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:u,children:"Добавить компанию"})]})]}),s.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по названию, ИНН, адресу, телефону, сайту...",prefix:s.jsx(Pa,{}),value:c,onChange:b=>A(b.target.value),style:{width:400,marginBottom:16}})]}),s.jsx(Ue,{style:{marginBottom:16},children:s.jsxs(dt,{gutter:[16,16],children:[s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Всего компаний",value:S.total})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Активных",value:S.active,valueStyle:{color:"#3f8600"}})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Приостановленных",value:S.suspended,valueStyle:{color:"#fa8c16"}})}),s.jsx(be,{xs:24,sm:12,md:6,children:s.jsx(pt,{title:"Отозванных",value:S.revoked,valueStyle:{color:"#cf1322"}})})]})}),s.jsx(Ue,{bodyStyle:{padding:0},children:s.jsx(ir,{columns:B,dataSource:k,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},onRow:b=>({onDoubleClick:()=>g(b)})})}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx("span",{children:n?"Редактирование компании":"Добавление компании"}),n&&s.jsx(Ze,{color:n.status==="active"?"green":"orange",children:n.status==="active"?"Активна":n.status==="suspended"?"Приостановлена":"Отозвана"})]}),open:r,onCancel:()=>a(!1),footer:null,width:"95%",style:{top:10},styles:{body:{maxHeight:"85vh",overflowY:"auto",padding:"16px"}},destroyOnClose:!0,children:s.jsx(g$,{initialValues:n||{},onSubmit:E,onCancel:()=>a(!1),loading:o})})]})},{Text:ab}=ht,Wp=[{key:"registry",label:"Реестр объектов",description:"Карточки залогового имущества"},{key:"portfolio",label:"Залоговый портфель",description:"Данные портфеля сделок"},{key:"collateral-dossier",label:"Залоговое досье",description:"Информация по сделкам"},{key:"collateral-conclusions",label:"Заключения по залогу",description:"Заключения и оценки"},{key:"tasks",label:"Задачи",description:"Задачи и поручения"},{key:"kpi",label:"KPI",description:"Ключевые показатели эффективности"},{key:"reports",label:"Отчеты",description:"Аналитические отчеты"},{key:"insurance",label:"Страхование",description:"Страховые полисы"},{key:"fnp",label:"ФНП",description:"Данные ФНП сервиса"},{key:"analytics",label:"Аналитика",description:"Аналитические данные"},{key:"credit-risk",label:"Кредитные риски",description:"Данные по рискам"},{key:"appraisal",label:"Оценка",description:"Данные оценок"},{key:"cms-check",label:"CMS Check",description:"Данные дистанционных осмотров"},{key:"egrn",label:"ЕГРН",description:"Данные ЕГРН"},{key:"monitoring",label:"Мониторинг",description:"Планы мониторинга и переоценки"},{key:"employees",label:"Сотрудники",description:"Данные сотрудников и их права"},{key:"reference-data",label:"Справочники",description:"Все справочники системы"},{key:"settings",label:"Настройки",description:"Настройки приложения"}],y$=({visible:e,onClose:t})=>{const[r]=re.useForm(),[a,n]=M.useState(!1),[i,o]=M.useState([]),l=()=>{const d=Wp.map(f=>f.key);o(d),r.setFieldsValue({modules:d})},c=()=>{o([]),r.setFieldsValue({modules:[]})},A=async()=>{var d;try{const p=(await r.validateFields()).modules||[];if(p.length===0){Ne.warning("Выберите хотя бы один модуль для выгрузки");return}n(!0);const u={version:"1.0.0",exportDate:new Date().toISOString(),modules:{}};for(const v of p)try{switch(v){case"registry":{const E=await kt.getExtendedCards();u.modules.registry=E;break}case"portfolio":u.modules.portfolio=[];break;case"collateral-dossier":u.modules["collateral-dossier"]=[];break;case"collateral-conclusions":u.modules["collateral-conclusions"]=[];break;case"tasks":u.modules.tasks=[];break;case"kpi":u.modules.kpi=[];break;case"reports":u.modules.reports=[];break;case"insurance":u.modules.insurance=[];break;case"fnp":u.modules.fnp=[];break;case"analytics":u.modules.analytics=[];break;case"credit-risk":u.modules["credit-risk"]=[];break;case"appraisal":u.modules.appraisal=[];break;case"cms-check":u.modules["cms-check"]=[];break;case"egrn":u.modules.egrn=[];break;case"monitoring":u.modules.monitoring=[];break;case"employees":{const E=pr.getEmployees();u.modules.employees=E;break}case"reference-data":{const E=Tn.getDictionaries();u.modules["reference-data"]=E;break}case"settings":{const E=await kt.getSettings();u.modules.settings=E;break}}}catch(E){console.error(`Ошибка выгрузки модуля ${v}:`,E),Ne.warning(`Не удалось выгрузить данные модуля "${(d=Wp.find(k=>k.key===v))==null?void 0:d.label}"`)}const g=JSON.stringify(u,null,2),h=new Blob([g],{type:"application/json"}),x=URL.createObjectURL(h),y=document.createElement("a");y.href=x,y.download=`cms-migration-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(x),Ne.success(`Данные успешно выгружены. Выбрано модулей: ${p.length}`),t()}catch(f){console.error("Ошибка выгрузки данных:",f),Ne.error("Ошибка при выгрузке данных")}finally{n(!1)}};return s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(In,{}),s.jsx("span",{children:"Выгрузить форму для миграции"})]}),open:e,onCancel:t,width:800,footer:[s.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),s.jsx(Be,{onClick:l,children:"Выбрать все"},"select-all"),s.jsx(Be,{onClick:c,children:"Снять все"},"deselect-all"),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),loading:a,onClick:A,children:"Выгрузить"},"export")],children:s.jsxs(re,{form:r,layout:"vertical",children:[s.jsx("div",{style:{marginBottom:16},children:s.jsx(ab,{type:"secondary",children:"Выберите модули CMS, данные из которых необходимо выгрузить. Будет создан JSON файл с данными выбранных модулей."})}),s.jsx(jt,{}),s.jsx(re.Item,{name:"modules",rules:[{validator:(d,f)=>!f||f.length===0?Promise.reject(new Error("Выберите хотя бы один модуль")):Promise.resolve()}],children:s.jsx(ec.Group,{value:i,onChange:d=>{o(d),r.setFieldsValue({modules:d})},style:{width:"100%"},children:s.jsx(dt,{gutter:[16,16],children:Wp.map(d=>s.jsx(be,{xs:24,sm:12,lg:8,children:s.jsx(ec,{value:d.key,style:{width:"100%"},children:s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:d.label}),s.jsx("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:d.description})]})})},d.key))})})}),s.jsx("div",{style:{marginTop:16,padding:12,backgroundColor:"#f0f2f5",borderRadius:4},children:s.jsxs(ab,{type:"secondary",style:{fontSize:"12px"},children:["Выбрано модулей: ",s.jsx("strong",{children:i.length})," из ",Wp.length]})})]})})},{Text:v$}=ht,{Dragger:w$}=Js,E$=({visible:e,onClose:t})=>{const[r]=re.useForm(),[a,n]=M.useState(!1),[i,o]=M.useState([]),[l,c]=M.useState([]),[A,d]=M.useState(!1),f=nl(),p=h=>{o(h.fileList),c([]),d(!1)},u=async()=>{if(i.length===0){Ne.warning("Выберите файл для загрузки");return}const h=i[0].originFileObj;if(!h){Ne.error("Файл не найден");return}n(!0),c([]),d(!1);try{const x=await h.text();let y;try{y=JSON.parse(x)}catch{Ne.error("Неверный формат файла. Ожидается JSON файл."),n(!1);return}if(!y.modules||typeof y.modules!="object"){Ne.error("Неверная структура файла миграции"),n(!1);return}const v=[];for(const[S,B]of Object.entries(y.modules))try{let b=0;switch(S){case"registry":if(Array.isArray(B)){for(const _ of B)await kt.saveExtendedCard(_),b++;const O=await kt.getExtendedCards();f(rf(O))}v.push({module:"Реестр объектов",success:!0,count:b});break;case"portfolio":v.push({module:"Залоговый портфель",success:!0,count:0});break;case"collateral-dossier":v.push({module:"Залоговое досье",success:!0,count:0});break;case"collateral-conclusions":v.push({module:"Заключения по залогу",success:!0,count:0});break;case"tasks":v.push({module:"Задачи",success:!0,count:0});break;case"kpi":v.push({module:"KPI",success:!0,count:0});break;case"reports":v.push({module:"Отчеты",success:!0,count:0});break;case"insurance":v.push({module:"Страхование",success:!0,count:0});break;case"fnp":v.push({module:"ФНП",success:!0,count:0});break;case"analytics":v.push({module:"Аналитика",success:!0,count:0});break;case"credit-risk":v.push({module:"Кредитные риски",success:!0,count:0});break;case"appraisal":v.push({module:"Оценка",success:!0,count:0});break;case"cms-check":v.push({module:"CMS Check",success:!0,count:0});break;case"egrn":v.push({module:"ЕГРН",success:!0,count:0});break;case"monitoring":v.push({module:"Мониторинг",success:!0,count:0});break;case"employees":if(Array.isArray(B))for(const O of B)try{if(O.id&&pr.getEmployeeById(O.id)){const{id:N,...P}=O;delete P.createdAt,delete P.updatedAt,pr.updateEmployee(N,P),b++;continue}const{id:_,createdAt:U,updatedAt:I,...R}=O;pr.addEmployee(R),b++}catch(_){console.error("Ошибка импорта сотрудника:",_)}v.push({module:"Сотрудники",success:!0,count:b});break;case"reference-data":if(Array.isArray(B)){const _=[...Tn.getDictionaries()];for(const U of B)try{const I=_.findIndex(R=>R.id===U.id);I!==-1?_[I]={..._[I],...U,updatedAt:new Date().toISOString()}:_.push({...U,updatedAt:new Date().toISOString()}),b++}catch(I){console.error("Ошибка импорта справочника:",I)}Tn.saveDictionaries(_)}v.push({module:"Справочники",success:!0,count:b});break;case"settings":B&&(await kt.saveSettings(B),b=1),v.push({module:"Настройки",success:!0,count:b});break;default:v.push({module:S,success:!1,count:0,error:"Неизвестный модуль"})}}catch(b){v.push({module:S,success:!1,count:0,error:b.message||"Ошибка импорта"})}c(v),d(!0);const E=v.filter(S=>S.success).length,k=v.reduce((S,B)=>S+B.count,0);E===v.length?Ne.success(`Импорт завершен успешно. Импортировано записей: ${k}`):Ne.warning(`Импорт завершен с ошибками. Успешно: ${E}/${v.length}`)}catch(x){console.error("Ошибка импорта данных:",x),Ne.error(`Ошибка при импорте данных: ${x.message}`)}finally{n(!1)}},g=()=>{o([]),c([]),d(!1),r.resetFields(),t()};return s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(Ns,{}),s.jsx("span",{children:"Загрузить форму"})]}),open:e,onCancel:g,width:700,footer:[s.jsx(Be,{onClick:g,children:A?"Закрыть":"Отмена"},"cancel"),...A?[]:[s.jsx(Be,{type:"primary",icon:s.jsx(Ns,{}),loading:a,onClick:u,disabled:i.length===0,children:"Загрузить данные"},"import")]],children:s.jsx(re,{form:r,layout:"vertical",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Nr,{message:"Импорт завершен",description:"Результаты импорта данных из файла миграции",type:l.every(h=>h.success)?"success":"warning",showIcon:!0,style:{marginBottom:16}}),s.jsx(Qt,{dataSource:l,renderItem:h=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{avatar:h.success?s.jsx(yn,{style:{color:"#52c41a",fontSize:"20px"}}):s.jsx(Jl,{style:{color:"#ff4d4f",fontSize:"20px"}}),title:s.jsxs(Te,{children:[s.jsx("span",{children:h.module}),h.success&&h.count>0&&s.jsxs(Ze,{color:"blue",children:[h.count," записей"]}),!h.success&&s.jsx(Ze,{color:"red",children:"Ошибка"})]}),description:h.error||(h.success?"Успешно импортировано":"")})})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{marginBottom:16},children:s.jsx(v$,{type:"secondary",children:"Выберите JSON файл миграции для загрузки данных в модули CMS. Данные будут импортированы в соответствующие модули системы."})}),s.jsx(jt,{}),s.jsx(re.Item,{name:"file",rules:[{required:!0,message:"Выберите файл для загрузки"}],children:s.jsxs(w$,{accept:".json",fileList:i,onChange:p,beforeUpload:()=>!1,maxCount:1,children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(Sb,{})}),s.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файл сюда для загрузки"}),s.jsx("p",{className:"ant-upload-hint",children:"Поддерживается только формат JSON"})]})}),s.jsx(Nr,{message:"Внимание",description:"При импорте данных существующие записи могут быть перезаписаны. Рекомендуется создать резервную копию перед импортом.",type:"warning",showIcon:!0,style:{marginTop:16}})]})})})},b$=async e=>{const t=[];for(const o of e)try{switch(o){case"registry":{const l=await kt.getExtendedCards();for(const c of l){const A={module:"registry",id:c.id,number:c.number,name:c.name,mainCategory:c.mainCategory,status:c.status,cbCode:c.cbCode,propertyType:c.propertyType,reference:c.reference,contractNumber:c.contractNumber,contractId:c.contractId,marketValue:c.marketValue,pledgeValue:c.pledgeValue,notes:c.notes,suspensiveConditions:c.suspensiveConditions,egrnStatementDate:c.egrnStatementDate,partners:JSON.stringify(c.partners||[]),address:JSON.stringify(c.address||{}),characteristics:JSON.stringify(c.characteristics||{}),classification:JSON.stringify(c.classification||{})};t.push(A)}break}case"employees":{const l=pr.getEmployees();for(const c of l){const A={module:"employees",id:c.id,firstName:c.firstName,lastName:c.lastName,middleName:c.middleName,email:c.email,phone:c.phone,position:c.position,department:c.department,region:c.region,permissions:JSON.stringify(c.permissions||[]),isActive:c.isActive};t.push(A)}break}case"reference-data":{const l=Tn.getDictionaries();for(const c of l){const A={module:"reference-data",id:c.id,code:c.code,name:c.name,description:c.description,items:JSON.stringify(c.items||[])};t.push(A)}break}case"cms-check":{const l=await Ba.getInspections();for(const c of l){const A={module:"cms-check",id:c.id,inspectionType:c.inspectionType,status:c.status,inspectionDate:c.inspectionDate instanceof Date?c.inspectionDate.toISOString():c.inspectionDate,collateralCardId:c.collateralCardId,collateralName:c.collateralName,inspectorId:c.inspectorId,inspectorName:c.inspectorName,condition:c.condition,photos:JSON.stringify(c.photos||[]),notes:c.notes,defects:JSON.stringify(c.defects||[]),recommendations:JSON.stringify(c.recommendations||[])};t.push(A)}break}}}catch(l){console.error(`Ошибка экспорта модуля ${o}:`,l)}if(t.length===0)throw new Error("Нет данных для экспорта");const r=fs.json_to_sheet(t),a=fs.book_new();fs.book_append_sheet(a,r,"Массовые изменения");const n=30;r["!cols"]=Object.keys(t[0]||{}).map(()=>({wch:n}));const i=`bulk-edit-${new Date().toISOString().split("T")[0]}.xlsx`;Uh(a,i)},_$=async e=>{const t=await e.arrayBuffer(),r=dA(t,{type:"array"}),a=r.Sheets[r.SheetNames[0]];return fs.sheet_to_json(a).map(o=>{const l={module:o.Модуль||o.module||"",id:o.ID||o.id||void 0};return Object.keys(o).forEach(c=>{c!=="Модуль"&&c!=="module"&&c!=="ID"&&c!=="id"&&(l[c]=o[c])}),l})},C$=async(e,t)=>{try{switch(e){case"registry":{const r=t.partners?JSON.parse(String(t.partners)):[],a=t.address?JSON.parse(String(t.address)):void 0,n=t.characteristics?JSON.parse(String(t.characteristics)):{},i=t.classification?JSON.parse(String(t.classification)):{},o={id:t.id||`card-${Date.now()}-${Math.random()}`,number:t.number||"",name:t.name||"",mainCategory:t.mainCategory||"real_estate",status:t.status||"editing",cbCode:t.cbCode||0,propertyType:t.propertyType,reference:t.reference,contractNumber:t.contractNumber,contractId:t.contractId,marketValue:t.marketValue,pledgeValue:t.pledgeValue,notes:t.notes,suspensiveConditions:t.suspensiveConditions,egrnStatementDate:t.egrnStatementDate,partners:r,address:a,characteristics:n,classification:i,documents:[],createdAt:t.id?new Date:new Date,updatedAt:new Date};if(t.id){const l=await kt.getExtendedCardById(t.id);if(l)return o.createdAt=l.createdAt,await kt.saveExtendedCard(o),{success:!0,created:!1}}return await kt.saveExtendedCard(o),{success:!0,created:!0}}case"employees":{const r=t.permissions?JSON.parse(String(t.permissions)):[],a={firstName:t.firstName||"",lastName:t.lastName||"",middleName:t.middleName,email:t.email,phone:t.phone,position:t.position||"",department:t.department,region:t.region||"",permissions:r,isActive:t.isActive!==void 0?!!t.isActive:!0};return t.id&&pr.getEmployeeById(t.id)?(pr.updateEmployee(t.id,a),{success:!0,created:!1}):(pr.addEmployee(a),{success:!0,created:!0})}case"reference-data":{const r=t.items?JSON.parse(String(t.items)):[],a={id:t.id||`dict-${Date.now()}-${Math.random()}`,code:t.code||"",name:t.name||"",description:t.description,items:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},n=Tn.getDictionaries();if(t.id){const i=n.findIndex(o=>o.id===t.id);if(i!==-1)return n[i]={...n[i],...a,createdAt:n[i].createdAt},Tn.saveDictionaries(n),{success:!0,created:!1}}return n.push(a),Tn.saveDictionaries(n),{success:!0,created:!0}}case"cms-check":{const r=t.photos?JSON.parse(String(t.photos)):[],a=t.defects?JSON.parse(String(t.defects)):[],n=t.recommendations?JSON.parse(String(t.recommendations)):[],i=t.inspectionDate?typeof t.inspectionDate=="string"?new Date(t.inspectionDate):t.inspectionDate:new Date;if(t.id){const l=await Ba.getInspectionById(t.id);if(l){const c={inspectionType:t.inspectionType||l.inspectionType,status:t.status||l.status,inspectionDate:i,collateralCardId:t.collateralCardId||l.collateralCardId,collateralName:t.collateralName||l.collateralName,inspectorId:t.inspectorId||l.inspectorId,inspectorName:t.inspectorName||l.inspectorName,condition:t.condition||l.condition,photos:r,notes:t.notes||l.notes,defects:a,recommendations:n,updatedAt:new Date};return await Ba.updateInspection(t.id,c),{success:!0,created:!1}}}const o={inspectorType:"employee",history:[{id:`hist-${Date.now()}`,date:new Date,action:"created",user:"Система",userRole:"creator",comment:"Осмотр создан через массовое редактирование",status:t.status||"scheduled"}],inspectionType:t.inspectionType||"primary",status:t.status||"scheduled",inspectionDate:i,collateralCardId:t.collateralCardId||"",collateralName:t.collateralName||"",inspectorId:t.inspectorId||"",inspectorName:t.inspectorName||"",condition:t.condition||"good",photos:r,notes:t.notes,defects:a,recommendations:n};return await Ba.createInspection(o),{success:!0,created:!0}}default:return{success:!1,created:!1,error:`Неизвестный модуль: ${e}`}}}catch(r){return{success:!1,created:!1,error:String(r)}}},{Text:nb}=ht,sb=[{key:"registry",label:"Реестр объектов",description:"Карточки залогового имущества"},{key:"employees",label:"Сотрудники",description:"Данные сотрудников и их права"},{key:"reference-data",label:"Справочники",description:"Все справочники системы"},{key:"cms-check",label:"CMS Check",description:"Данные дистанционных осмотров"}],B$=({visible:e,onClose:t})=>{const[r]=re.useForm(),[a,n]=M.useState(!1),[i,o]=M.useState([]),l=()=>{const d=sb.map(f=>f.key);o(d),r.setFieldsValue({modules:d})},c=()=>{o([]),r.setFieldsValue({modules:[]})},A=async()=>{try{const f=(await r.validateFields()).modules||[];if(f.length===0){Ne.warning("Выберите хотя бы один модуль для выгрузки");return}n(!0);try{await b$(f),Ne.success(`Данные успешно выгружены в XLS. Выбрано модулей: ${f.length}`),t()}catch(p){console.error("Ошибка выгрузки данных:",p),Ne.error(`Ошибка при выгрузке данных: ${p.message||"Неизвестная ошибка"}`)}}catch(d){console.error("Ошибка валидации:",d)}finally{n(!1)}};return s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(In,{}),s.jsx("span",{children:"Выгрузить данные для массовых изменений"})]}),open:e,onCancel:t,width:700,footer:[s.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),loading:a,onClick:A,children:"Выгрузить в XLS"},"export")],children:s.jsxs(re,{form:r,layout:"vertical",children:[s.jsx(nb,{type:"secondary",style:{display:"block",marginBottom:16},children:'Выберите модули, данные из которых необходимо выгрузить для массовых изменений. Все данные будут выгружены в один XLS файл с колонками "Модуль" и "ID".'}),s.jsx(jt,{}),s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"middle",children:[s.jsxs(Te,{children:[s.jsx(Be,{size:"small",onClick:l,children:"Выбрать все"}),s.jsx(Be,{size:"small",onClick:c,children:"Снять все"})]}),s.jsx(re.Item,{name:"modules",rules:[{required:!0,message:"Выберите хотя бы один модуль"}],children:s.jsx(ec.Group,{value:i,onChange:d=>{o(d),r.setFieldsValue({modules:d})},style:{width:"100%"},children:s.jsx(Te,{direction:"vertical",style:{width:"100%"},children:sb.map(d=>s.jsx(ec,{value:d.key,children:s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:d.label}),s.jsx(nb,{type:"secondary",style:{fontSize:"12px"},children:d.description})]})},d.key))})})})]})]})})},{Text:P1}=ht,{Dragger:S$}=Js,T$=({visible:e,onClose:t})=>{const[r,a]=M.useState(!1),[n,i]=M.useState([]),[o,l]=M.useState([]),[c,A]=M.useState(!1),[d,f]=M.useState(0),p=nl(),u=x=>{i(x.fileList),l([]),A(!1),f(0)},g=async()=>{if(n.length===0){Ne.warning("Выберите XLS файл для загрузки");return}const x=n[0].originFileObj;if(!x){Ne.error("Файл не найден");return}if(!x.name.endsWith(".xlsx")&&!x.name.endsWith(".xls")){Ne.error("Неверный формат файла. Ожидается XLS или XLSX файл.");return}a(!0),l([]),A(!1),f(0);try{const y=await _$(x);if(y.length===0){Ne.warning("Файл не содержит данных"),a(!1);return}const v=new Map;y.forEach(_=>{v.has(_.module)||v.set(_.module,[]),v.get(_.module).push(_)});const E=[];let k=0;const S=y.length;for(const[_,U]of v.entries()){const I={module:_,updated:0,created:0,errors:[]};for(const R of U){try{const L=await C$(_,R);L.success?L.created?I.created++:I.updated++:I.errors.push(L.error||"Неизвестная ошибка")}catch(L){I.errors.push(`Строка ${R.id||"без ID"}: ${L.message||String(L)}`)}k++,f(Math.round(k/S*100))}E.push(I)}try{const _=await kt.getExtendedCards();p(rf(_))}catch(_){console.warn("Не удалось обновить Redux store:",_)}l(E),A(!0);const B=E.reduce((_,U)=>_+U.updated,0),b=E.reduce((_,U)=>_+U.created,0),O=E.reduce((_,U)=>_+U.errors.length,0);O===0?Ne.success(`Импорт завершен: обновлено ${B}, создано ${b} записей`):Ne.warning(`Импорт завершен с ошибками: обновлено ${B}, создано ${b}, ошибок: ${O}`)}catch(y){console.error("Ошибка импорта данных:",y),Ne.error(`Ошибка при импорте данных: ${y.message||"Неизвестная ошибка"}`)}finally{a(!1)}},h=x=>({registry:"Реестр объектов",employees:"Сотрудники","reference-data":"Справочники","cms-check":"CMS Check"})[x]||x;return s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(Ns,{}),s.jsx("span",{children:"Загрузить файл массовых изменений"})]}),open:e,onCancel:t,width:800,footer:[s.jsx(Be,{onClick:t,disabled:r,children:c?"Закрыть":"Отмена"},"cancel"),s.jsx(Be,{type:"primary",icon:s.jsx(Ns,{}),loading:r,onClick:g,disabled:n.length===0||c,children:"Загрузить и применить изменения"},"import")],children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"large",children:[s.jsx(P1,{type:"secondary",children:'Загрузите XLS файл с массовыми изменениями. Файл должен содержать колонки "Модуль" и "ID". Записи с существующим ID будут обновлены, записи без ID или с новым ID будут созданы.'}),s.jsxs(S$,{fileList:n,onChange:u,beforeUpload:()=>!1,accept:".xlsx,.xls",maxCount:1,children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(Sb,{})}),s.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файл для загрузки"}),s.jsx("p",{className:"ant-upload-hint",children:"Поддерживаются файлы формата XLS и XLSX"})]}),r&&s.jsxs("div",{children:[s.jsx(qn,{percent:d,status:"active"}),s.jsx(P1,{type:"secondary",style:{display:"block",marginTop:8},children:"Обработка данных..."})]}),c&&o.length>0&&s.jsxs("div",{children:[s.jsx(jt,{children:"Результаты импорта"}),s.jsx(Qt,{dataSource:o,renderItem:x=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{title:s.jsxs(Te,{children:[s.jsx("span",{children:h(x.module)}),x.errors.length===0?s.jsx(Ze,{color:"success",icon:s.jsx(yn,{}),children:"Успешно"}):s.jsx(Ze,{color:"warning",icon:s.jsx(Jl,{}),children:"С ошибками"})]}),description:s.jsxs(Te,{direction:"vertical",size:"small",children:[s.jsxs(P1,{children:["Обновлено: ",s.jsx("strong",{children:x.updated}),", Создано: ",s.jsx("strong",{children:x.created})]}),x.errors.length>0&&s.jsx(Nr,{type:"warning",message:"Ошибки",description:s.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[x.errors.slice(0,5).map((y,v)=>s.jsx("li",{children:y},v)),x.errors.length>5&&s.jsxs("li",{children:["... и еще ",x.errors.length-5," ошибок"]})]}),style:{marginTop:8}})]})})})})]})]})})},{Title:Mu,Text:Fc}=ht,O$=()=>{const[e,t]=M.useState(!1),[r,a]=M.useState(!1),[n,i]=M.useState(!1),[o,l]=M.useState(!1),c=[{key:"migration",label:"Миграция данных",icon:s.jsx(eO,{}),children:s.jsxs("div",{children:[s.jsx(Fc,{type:"secondary",style:{display:"block",marginBottom:24},children:"Выгрузка и загрузка данных из различных модулей CMS для переноса между системами или создания резервных копий. Данные выгружаются в формате JSON."}),s.jsxs(dt,{gutter:[24,24],children:[s.jsx(be,{xs:24,md:12,children:s.jsxs(Ue,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>t(!0),children:[s.jsx(In,{style:{fontSize:"64px",color:"#1890ff",marginBottom:16}}),s.jsx(Mu,{level:4,children:"Выгрузить форму для миграции"}),s.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Выберите модули CMS, данные из которых необходимо выгрузить. Будет создан JSON файл для миграции с выбранными данными."}),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),size:"large",style:{marginTop:16},onClick:A=>{A.stopPropagation(),t(!0)},children:"Выгрузить данные"})]})}),s.jsx(be,{xs:24,md:12,children:s.jsxs(Ue,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>a(!0),children:[s.jsx(Ns,{style:{fontSize:"64px",color:"#52c41a",marginBottom:16}}),s.jsx(Mu,{level:4,children:"Загрузить форму"}),s.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Загрузите JSON файл миграции для заполнения модулей CMS данными. Данные будут импортированы в соответствующие модули системы."}),s.jsx(Be,{type:"primary",icon:s.jsx(Ns,{}),size:"large",style:{marginTop:16,backgroundColor:"#52c41a",borderColor:"#52c41a"},onClick:A=>{A.stopPropagation(),a(!0)},children:"Загрузить данные"})]})})]})]})},{key:"bulk-edit",label:"Массовые изменения",icon:s.jsx(Rs,{}),children:s.jsxs("div",{children:[s.jsx(Fc,{type:"secondary",style:{display:"block",marginBottom:24},children:'Выгрузка данных в XLS файл для массового редактирования. После внесения изменений в файл, загрузите его обратно для обновления данных в системе. Все модули выгружаются в один лист с колонками "Модуль" и "ID".'}),s.jsxs(dt,{gutter:[24,24],children:[s.jsx(be,{xs:24,md:12,children:s.jsxs(Ue,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>i(!0),children:[s.jsx(In,{style:{fontSize:"64px",color:"#1890ff",marginBottom:16}}),s.jsx(Mu,{level:4,children:"Выгрузить данные для редактирования"}),s.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:'Выберите модули, данные из которых необходимо выгрузить в XLS файл. Все данные будут в одном файле с колонками "Модуль" и "ID".'}),s.jsx(Be,{type:"primary",icon:s.jsx(In,{}),size:"large",style:{marginTop:16},onClick:A=>{A.stopPropagation(),i(!0)},children:"Выгрузить в XLS"})]})}),s.jsx(be,{xs:24,md:12,children:s.jsxs(Ue,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>l(!0),children:[s.jsx(Ns,{style:{fontSize:"64px",color:"#722ed1",marginBottom:16}}),s.jsx(Mu,{level:4,children:"Загрузить измененный файл"}),s.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Загрузите отредактированный XLS файл для применения изменений. Записи с существующим ID будут обновлены, новые записи будут созданы."}),s.jsx(Be,{type:"primary",icon:s.jsx(Ns,{}),size:"large",style:{marginTop:16,backgroundColor:"#722ed1",borderColor:"#722ed1"},onClick:A=>{A.stopPropagation(),l(!0)},children:"Загрузить и применить"})]})})]})]})}];return s.jsxs("div",{style:{padding:"24px"},children:[s.jsxs(Ue,{children:[s.jsxs("div",{style:{marginBottom:24},children:[s.jsxs(Mu,{level:2,style:{margin:0,display:"flex",alignItems:"center",gap:12},children:[s.jsx(Ns,{style:{fontSize:"32px",color:"#1890ff"}}),"Загрузка и выгрузка данных"]}),s.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Миграция данных между системами и массовое редактирование данных через XLS файлы"})]}),s.jsx(jt,{}),s.jsx(ri,{items:c,defaultActiveKey:"migration"})]}),s.jsx(y$,{visible:e,onClose:()=>t(!1)}),s.jsx(E$,{visible:r,onClose:()=>a(!1)}),s.jsx(B$,{visible:n,onClose:()=>i(!1)}),s.jsx(T$,{visible:o,onClose:()=>l(!1)})]})},I$=["[Volhin_N.A.]_Zalogovik._Vse_o_bankovskih_zalogah_(b-ok.org).pdf","Виды залогового имущества.docx","Отнесение фондированного обеспечения к категориям качества обеспечения.docx","Документы для мониторинга залога.xlsx","Нетиповые риски.docx","Примеры заданий.docx","Оценка АЗС.docx","Оценка АЗС — копия.docx","Оценка торговых центров.docx","BusinesStat АЗС.docx","Анализ наилучшего и наиболее эффективного использования.docx","Величина физического износа объектов капитального строительства.docx","Вопросы переоценки основных средств.docx","Исследование методов оценки акций коммерческого банка.docx","Корректировка на удаленность земельных участков Московской области.docx","Коэффициент перехода на вторичный рынок.docx","Лямбда сестра омеги.docx","Метод АВС при оценке автотранспортных средств.docx","Метод дисконтирования денежных потоков.docx","Метод рыночной экстракции.docx","МЕТОДИЧЕСКОЕ РУКОВОДСТВО ПО ОПРЕДЕЛЕНИЮ СТОИМОСТИ.docx","Норма дисконта.docx","Обзор и сравнение современных отечественных и зарубежных методов оценки технического состояния зданий и сооружений.docx","ОБОСНОВАНИЕ И РАСЧЕТ ПОПРАВКИ НА ПЛОЩАДЬ.docx","Определение прибыли предпринимателя.docx","Особенности оценки имущества в деле о банкротстве.docx","Переоценка основных средств.docx","Практические аспекты расчёта ставки дисконта.docx","Применение модели Ольсона в оценке стоимости компании.docx","Расчет коэффициента капитализации.docx","Расчет ставки дисконтирования кумулятивным методом.docx","Справедливая.docx","Средняя скидка на торг при покупке жилого дома в Московской области.docx","Средняя скидка на торг при покупке земельных участков в Московской области.docx","Статистическое исследование зависимости накопленного износа автомобиля от его эффективного возраста.docx","Техника группы инвестиций.docx","FSO1.pdf","FSO2.pdf","FSO3.pdf","FSO4.pdf","FSO5.pdf","FSO6.pdf","FSO7.pdf","FSO8.pdf","FSO9.pdf","FSO10.pdf","FSO11.pdf","ocenka_biznesa_voprosy_s_otvetami.pdf","ocenka_nedvizhimosti_predpriyatiya_voprosy_s_otvetami.pdf","ocenka_nedvizhimosti_voprosy_s_otvetami.pdf","ekon_ocenka_investiciy_voprosy_s_otvetami.pdf","korrektirovki-zemelnyh-udalennosti-morya-sochi.pdf","Land_heritage_Yaskevich.pdf","Method-recommendations-determining-cadastrial-value.pdf","O-merah-korrektirovke-kadastrovoy-otsenki-zemel-poseleniy.pdf","otsenka-rynochnoy-stoimosti-uchastkov-azs-servisa.pdf","otsenka-rynochnoy-stoimosti-zemelnogo-uchastka-aeroporta.pdf","report-colliers-spb.pdf","Report-Imuschestvo-ip.pdf","Report-Market-Value-Assessment-Report-for-the-Store.pdf","Report-stoimosti-magazina-remonta-bytovoy-tehniki.pdf","Report-valuation-market-value-shares-enterprise-OJSC-BYT.pdf","stavki-diskontirovaniya-RF-pri-sankciyah.pdf","Valuation-minority-stake-in-company-OJSC-MOROZ.pdf","Valuation-report-stake-in-CJSC-Reserve.pdf"];function FS(e){const t=e.toLowerCase();return e.startsWith("~$")||t.endsWith(".doc")||t.endsWith(".pptx")||t.endsWith(".rtf")?"unknown":t.endsWith(".pdf")?"pdf":t.endsWith(".docx")?"docx":t.endsWith(".xlsx")||t.endsWith(".xls")?"xlsx":"unknown"}async function RS(e=!1){try{await $s.loadFromStorage();const t="/",r=[];let a=!1;for(const n of I$){if(n.startsWith("~$"))continue;const i=FS(n);if(i==="unknown"){console.warn(`Пропущен файл с неизвестным типом: ${n}`);continue}const o=[`${t}VND/${n}`,`./VND/${n}`,`/VND/${n}`,`VND/${n}`,`${window.location.origin}${t}VND/${n}`,`${window.location.origin}/VND/${n}`];let l=null;for(const c of o)try{const A=await fetch(c);if(A.ok){l=A;break}}catch{continue}if(l&&l.ok)try{const c=await l.blob();let A="application/octet-stream";i==="pdf"?A="application/pdf":i==="docx"?A="application/vnd.openxmlformats-officedocument.wordprocessingml.document":i==="xlsx"&&(A="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const d=new File([c],n,{type:A}),p=$s.getIndexedDocuments().find(u=>u.documentName===d.name);if(e||!p){console.log(`Индексирую документ: ${d.name} (тип: ${i})`);const u=await $s.indexDocument(d);r.push(u),console.log(`✅ Документ проиндексирован: ${d.name} (${u.totalPages} страниц/листов, ${u.chunks.length} чанков)`),a=!0}else console.log(`Документ уже проиндексирован: ${d.name} (${p.totalPages} страниц/листов)`),r.push(p)}catch(c){console.error(`Ошибка индексации документа ${n}:`,c)}else console.warn(`Не удалось загрузить документ из VND: ${n}`)}if(a||e){console.log("🔨 Строю базу знаний из всех документов..."),await Cn.buildFromDocuments();const n=Cn.getCategories();console.log(`✅ База знаний построена: ${n.length} категорий, ${r.length} документов`)}else{await Cn.loadFromStorage();const n=Cn.getCategories();console.log(`📚 База знаний загружена из хранилища: ${n.length} категорий, ${r.length} документов`)}if(r.length===0){const n=$s.getIndexedDocuments();if(n.length>0)return console.log(`Найдены ранее проиндексированные документы в localStorage: ${n.length}`),n;console.info('Документы не найдены. Вы можете загрузить PDF документ вручную через кнопку "Загрузить документ"')}else console.log(`✅ Всего проиндексировано документов: ${r.length}`);return r.length>0?r:$s.getIndexedDocuments()}catch(t){console.error("Ошибка загрузки документов VND:",t);try{const r=$s.getIndexedDocuments();if(r.length>0)return console.log("Загружены ранее проиндексированные документы из localStorage"),r}catch(r){console.error("Ошибка загрузки из localStorage:",r)}return[]}}async function N$(e){if(FS(e.name)==="unknown")throw new Error(`Неподдерживаемый формат файла: ${e.name}. Поддерживаются: PDF, DOCX, XLSX`);const r=await $s.indexDocument(e);return await Cn.buildFromDocuments(),r}async function F$(){return console.log("🔄 Начинаю принудительную переиндексацию всех документов..."),$s.clearIndexes(),Cn.clear(),await RS(!0)}const ph="reference_chats";function tv(e){try{const t=e.map(a=>({...a,messages:a.messages.map(n=>({...n,timestamp:n.timestamp.toISOString()})),createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}));let r=JSON.stringify(t);if(r.length>4*1024*1024){const n=[...e].sort((o,l)=>l.updatedAt.getTime()-o.updatedAt.getTime()).slice(0,50),i=n.map(o=>({...o,messages:o.messages.map(l=>({...l,timestamp:l.timestamp.toISOString()})),createdAt:o.createdAt.toISOString(),updatedAt:o.updatedAt.toISOString()}));r=JSON.stringify(i),console.warn("localStorage переполнен, удалены старые чаты. Оставлено:",n.length)}localStorage.setItem(ph,r)}catch(t){if(t.name==="QuotaExceededError"||t.code===22)try{const a=[...e].sort((i,o)=>o.updatedAt.getTime()-i.updatedAt.getTime()).slice(0,20),n=a.map(i=>({...i,messages:i.messages.map(o=>({...o,timestamp:o.timestamp.toISOString()})),createdAt:i.createdAt.toISOString(),updatedAt:i.updatedAt.toISOString()}));localStorage.setItem(ph,JSON.stringify(n)),console.warn("localStorage переполнен, удалены старые чаты. Оставлено:",a.length)}catch(r){console.error("Критическая ошибка сохранения чатов, очищаем все:",r),localStorage.removeItem(ph)}else console.error("Ошибка сохранения чатов:",t)}}function m0(){try{const e=localStorage.getItem(ph);return e?JSON.parse(e).map(r=>({...r,messages:r.messages.map(a=>({...a,timestamp:new Date(a.timestamp)})),createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)})):[]}catch(e){return console.error("Ошибка загрузки чатов:",e),[]}}function R$(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function Q1(e){const t={id:R$(),title:`Чат ${new Date().toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}`,messages:[],createdAt:new Date,updatedAt:new Date},r=m0();return r.unshift(t),tv(r),t}function Ol(){return m0().sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime())}function ib(e){return m0().find(r=>r.id===e)||null}function k$(e,t){const r=m0(),a=r.findIndex(n=>n.id===e);a>=0&&(r[a]={...r[a],...t,updatedAt:new Date},tv(r))}function Pu(e,t){const r=m0(),a=r.find(n=>n.id===e);if(a){if(a.messages.push(t),a.updatedAt=new Date,a.messages.length===1&&t.role==="user"){const n=t.content.substring(0,50);a.title=n.length<t.content.length?`${n}...`:n}tv(r)}}const bf=e=>(e||"").trim().toLowerCase().replace(/\s+/g," "),D$=[{key:"location",label:"Адрес/локация",placeholder:"Регион, город, улица"},{key:"areaSqm",label:"Площадь, м²",type:"number",placeholder:"Общая площадь"},{key:"floors",label:"Этажность/уровни",type:"number",placeholder:"Количество этажей"},{key:"condition",label:"Состояние",placeholder:"Например, требует ремонта/хорошее"}],j$=[{key:"location",label:"Местоположение",placeholder:"Регион, населённый пункт"},{key:"areaSqm",label:"Площадь, м²",type:"number",placeholder:"Общая площадь в кв. метрах"},{key:"landUse",label:"Назначение",placeholder:"С/х, коммерческое, ИЖС и т.д."},{key:"ownershipType",label:"Тип права",placeholder:"Собственность / аренда"}],C2=[{key:"baseLocation",label:"Место базирования",placeholder:"Город, склад, порт"},{key:"year",label:"Год выпуска",type:"number",placeholder:"Например, 2018"},{key:"condition",label:"Состояние",placeholder:"Отличное / рабочее / требует ремонта"},{key:"usageHours",label:"Наработка/пробег",placeholder:"км или моточасы"}],L$=[{key:"companyName",label:"Компания/эмитент",placeholder:"Наименование юрлица"},{key:"sharePercent",label:"Доля, %",type:"number",placeholder:"Размер доли"},{key:"financialSnapshot",label:"Финансовые показатели",placeholder:"Выручка, EBITDA, прибыль"},{key:"corporateRights",label:"Особенности прав",placeholder:"Преимущественные права, ограничения"}],U$=[{key:"debtor",label:"Должник / контрагент",placeholder:"Компания / физлицо"},{key:"claimAmount",label:"Сумма требования (₽)",type:"number",placeholder:"Номинал требования"},{key:"maturity",label:"Срок погашения",placeholder:"Дата или период"},{key:"claimType",label:"Тип права",placeholder:"Договор, уступка, ИС и т.д."}],kS=[{key:"storageLocation",label:"Место хранения",placeholder:"Склад, регион"},{key:"quantity",label:"Количество / объём",placeholder:"шт., т, м³ и т.д."},{key:"quality",label:"Качество/сорт",placeholder:"ГОСТ, сорт, бренд"},{key:"turnoverRate",label:"Оборачиваемость",placeholder:"Срок реализации / оборота"}],M$={real_estate:D$,land:j$,movable:C2,metals_goods:kS,equity:L$,rights:U$},DS=[{label:"Воздушные суда",group:"real_estate"},{label:"Все имущество залогодателя",group:"real_estate"},{label:"Доли в уставных капиталах обществ с ограниченной ответственностью",group:"equity"},{label:"Единый недвижимый комплекс",group:"real_estate"},{label:"Железнодорожный подвижной состав",group:"movable"},{label:"Здание",group:"real_estate"},{label:"Земельный участок",group:"land"},{label:"Имущественный комплекс",group:"real_estate"},{label:"Космические объекты",group:"real_estate"},{label:"Машино-место",group:"real_estate"},{label:"Машины и оборудование",group:"movable"},{label:"Наземные безрельсовые механические транспортные средства, прицепы",group:"movable"},{label:"Недвижимое имущество и права аренды недвижимого имущества",group:"real_estate"},{label:"Объект незавершенного строительства",group:"real_estate"},{label:"Плавучие сооружения",group:"movable"},{label:"Плавучие сооружения, не являющиеся судами",group:"movable"},{label:"Помещение",group:"real_estate"},{label:"Прочие движимые вещи",group:"movable"},{label:"Прочие имущественные Права требования",group:"rights"},{label:"Прочие ценные бумаги",group:"equity"},{label:"Сооружение",group:"real_estate"},{label:"Суда, используемые для иных целей",group:"real_estate"},{label:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",group:"real_estate"},{label:"Суда, используемые для перевозки пассажиров и их багажа",group:"real_estate"},{label:"Суда, используемые для рыболовства",group:"real_estate"},{label:"Товары в обороте",group:"movable"},{label:"Эмиссионные ценные бумаги",group:"equity"}],P$=DS.reduce((e,t)=>(e[bf(t.label)]=t.group,e),{}),Q$={[bf("Воздушные суда")]:C2,[bf("Железнодорожный подвижной состав")]:C2,[bf("Товары в обороте")]:kS},q$=DS.map(e=>({value:e.label,label:e.label})),K$=e=>{if(!e)return null;const t=bf(e),r=P$[t]||(t.includes("земел")?"land":t.includes("ценн")||t.includes("акц")||t.includes("дол")?"equity":t.includes("прав")?"rights":t.includes("товар")?"metals_goods":t.includes("оборуд")||t.includes("транспорт")?"movable":"real_estate");return{assetGroup:r,fields:Q$[t]||M$[r]}},q1=(e,t=[])=>{if(!e)return"";const r=t.reduce((n,i)=>(n[i.key]=i.label,n),{});return Object.entries(e).filter(([,n])=>n!=null&&n!=="").map(([n,i])=>`${r[n]||n}: ${i}`).join("; ")};function H$(e){const t=e.toLowerCase().trim();return["торговый центр","торгово-развлекательный центр","офисное здание","офисный центр","бизнес-центр","склад","складской комплекс","логистический центр","гостиница","отель","гостиничный комплекс","ресторан","кафе","производственное здание","производственный комплекс","арендная недвижимость","доходная недвижимость"].some(c=>t.includes(c))?{incomeApproach:75,incomeMethods:{dcf:60,directCapitalization:80,grossRentMultiplier:70},comparativeApproach:60,comparativeMethods:{salesComparison:70,marketExtraction:50},costApproach:30,costMethods:{replacementCost:40,reproductionCost:30,depreciation:20}}:["квартира","жилое помещение","жилой дом","дом","коттедж","таунхаус","апартаменты"].some(c=>t.includes(c))?{incomeApproach:40,incomeMethods:{dcf:30,directCapitalization:50,grossRentMultiplier:40},comparativeApproach:85,comparativeMethods:{salesComparison:90,marketExtraction:80},costApproach:25,costMethods:{replacementCost:30,reproductionCost:25,depreciation:20}}:["здание","помещение","сооружение","недвижимое имущество","имущественный комплекс","единый недвижимый комплекс","объект незавершенного строительства","машино-место"].some(c=>t.includes(c))?{incomeApproach:50,incomeMethods:{dcf:45,directCapitalization:55,grossRentMultiplier:50},comparativeApproach:75,comparativeMethods:{salesComparison:80,marketExtraction:70},costApproach:40,costMethods:{replacementCost:45,reproductionCost:40,depreciation:35}}:t.includes("земельный участок")||t.includes("земля")?{incomeApproach:30,incomeMethods:{dcf:25,directCapitalization:35,grossRentMultiplier:30},comparativeApproach:80,comparativeMethods:{salesComparison:85,marketExtraction:75},costApproach:20,costMethods:{replacementCost:25,reproductionCost:20,depreciation:15}}:["наземные безрельсовые механические транспортные средства","автомобиль","транспортное средство","железнодорожный подвижной состав","плавучие сооружения","судно","воздушные суда"].some(c=>t.includes(c))?{incomeApproach:20,incomeMethods:{dcf:15,directCapitalization:25,grossRentMultiplier:20},comparativeApproach:85,comparativeMethods:{salesComparison:90,marketExtraction:80},costApproach:60,costMethods:{replacementCost:70,reproductionCost:65,depreciation:55}}:["машины и оборудование","оборудование","техника","прочие движимые вещи"].some(c=>t.includes(c))?{incomeApproach:25,incomeMethods:{dcf:20,directCapitalization:30,grossRentMultiplier:25},comparativeApproach:60,comparativeMethods:{salesComparison:65,marketExtraction:55},costApproach:80,costMethods:{replacementCost:85,reproductionCost:80,depreciation:75}}:t.includes("товары в обороте")||t.includes("товар")?{incomeApproach:15,incomeMethods:{dcf:10,directCapitalization:20,grossRentMultiplier:15},comparativeApproach:70,comparativeMethods:{salesComparison:75,marketExtraction:65},costApproach:50,costMethods:{replacementCost:55,reproductionCost:50,depreciation:45}}:["доли в уставных капиталах","доли","акции","ценные бумаги","прочие ценные бумаги","эмиссионные ценные бумаги"].some(c=>t.includes(c))?{incomeApproach:70,incomeMethods:{dcf:75,directCapitalization:65,grossRentMultiplier:60},comparativeApproach:60,comparativeMethods:{salesComparison:65,marketExtraction:55},costApproach:20,costMethods:{replacementCost:25,reproductionCost:20,depreciation:15}}:t.includes("права требования")||t.includes("права")?{incomeApproach:60,incomeMethods:{dcf:65,directCapitalization:55,grossRentMultiplier:50},comparativeApproach:40,comparativeMethods:{salesComparison:45,marketExtraction:35},costApproach:10,costMethods:{replacementCost:15,reproductionCost:10,depreciation:5}}:t.includes("космические объекты")?{incomeApproach:30,incomeMethods:{dcf:25,directCapitalization:35,grossRentMultiplier:30},comparativeApproach:40,comparativeMethods:{salesComparison:45,marketExtraction:35},costApproach:85,costMethods:{replacementCost:90,reproductionCost:85,depreciation:80}}:null}function G$(e,t,r=!0){const a=H$(t);return a?r?{...e,...a,incomeMethods:{...e.incomeMethods,...a.incomeMethods},comparativeMethods:{...e.comparativeMethods,...a.comparativeMethods},costMethods:{...e.costMethods,...a.costMethods}}:a:e}const ob="9eea4a27-e364-4888-9f9f-b8fe79761974",z$="https://api.deepai.org/api/text2img",lb="",V$="https://api.openai.com/v1/images/generations",$$="https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-xl-base-1.0",cb="";class Y${async generateImage(t,r,a){try{const n=this.buildImagePrompt(t,r,a);if(ob)try{return await this.generateWithDeepAI(n)}catch(i){console.warn("Ошибка генерации через DeepAI, пробуем альтернативы:",i)}return this.generatePlaceholderImage(t,r)}catch(n){return console.error("Ошибка генерации изображения:",n),this.generatePlaceholderImage(t,r)}}async generateWithDeepAI(t){try{const r=new FormData;r.append("text",t);const a=await fetch(z$,{method:"POST",headers:{"api-key":ob},body:r});if(!a.ok){const c=await a.text().catch(()=>"Unknown error");throw new Error(`DeepAI API error: ${a.status} - ${c}`)}const n=await a.json(),i=n.output_url||n.url;if(!i)throw new Error("DeepAI не вернул URL изображения");const o=await fetch(i);if(!o.ok)throw new Error(`Не удалось загрузить изображение: ${o.status}`);const l=await o.blob();return await this.blobToBase64(l)}catch(r){throw console.error("Ошибка генерации через DeepAI:",r),r}}async generateWithOpenAI(t){try{const r=await fetch(V$,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${lb}`},body:JSON.stringify({model:"dall-e-3",prompt:t,n:1,size:"1024x1024",quality:"standard"})});if(!r.ok)throw new Error(`OpenAI API error: ${r.status}`);const a=await r.json();if(a.data&&a.data.length>0&&a.data[0].url){const i=await(await fetch(a.data[0].url)).blob();return await this.blobToBase64(i)}throw new Error("Не удалось получить изображение от OpenAI")}catch(r){throw console.error("Ошибка генерации через OpenAI:",r),r}}async generateWithHuggingFace(t){try{const r=await fetch($$,{method:"POST",headers:{Authorization:`Bearer ${cb}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:t,parameters:{num_inference_steps:20,guidance_scale:7.5}})});if(!r.ok)throw new Error(`Hugging Face API error: ${r.status}`);const a=await r.blob();return await this.blobToBase64(a)}catch(r){throw console.error("Ошибка генерации через Hugging Face:",r),r}}buildImagePrompt(t,r,a){let n="Professional real estate photography, high quality, realistic, detailed, ";if(r){const i=r.toLowerCase();i.includes("квартира")||i.includes("жилое")?n+="modern apartment interior, well-lit, clean, spacious rooms, ":i.includes("дом")||i.includes("коттедж")?n+="beautiful house exterior, modern architecture, well-maintained, ":i.includes("торговый центр")||i.includes("офис")?n+="commercial building, modern architecture, professional, ":i.includes("склад")||i.includes("производство")?n+="industrial building, warehouse, functional, ":i.includes("земельный участок")||i.includes("земля")?n+="land plot, aerial view, well-maintained, clear boundaries, ":i.includes("автомобиль")||i.includes("транспорт")?n+="professional car photography, clean vehicle, good condition, ":i.includes("оборудование")||i.includes("техника")?n+="industrial equipment, professional photography, clean, functional, ":n+="professional property photography, well-maintained, "}return a&&(n+=`located in ${a}, `),n+=t,n+=", professional real estate photography style, high resolution, detailed, realistic",n}generatePlaceholderImage(t,r){const a=`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#1890ff;stop-opacity:1" />
            <stop offset="50%" style="stop-color:#40a9ff;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#bae7ff;stop-opacity:1" />
          </linearGradient>
        </defs>
        <rect width="400" height="300" fill="url(#grad)"/>
        <text x="200" y="120" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">
          ${r||"Объект оценки"}
        </text>
        <text x="200" y="160" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle">
          ${t.substring(0,50)}${t.length>50?"...":""}
        </text>
        <text x="200" y="200" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
          Изображение будет сгенерировано ИИ
        </text>
      </svg>
    `.trim();return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(a)))}`}async blobToBase64(t){return new Promise((r,a)=>{const n=new FileReader;n.onloadend=()=>{typeof n.result=="string"?r(n.result):a(new Error("Не удалось конвертировать изображение в base64"))},n.onerror=a,n.readAsDataURL(t)})}}const Ab=new Y$,{TextArea:W$}=Re,{Title:Xp,Text:Gt,Paragraph:X$}=ht,jS=Ma.memo(({message:e,onRating:t,onTopicClick:r})=>{const a=M.useMemo(()=>e.timestamp.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),[e.timestamp]);return s.jsx("div",{className:`reference-page__message reference-page__message--${e.role}`,children:s.jsxs("div",{className:"reference-page__message-content",children:[s.jsx(nm,{icon:e.role==="user"?s.jsx(ti,{}):s.jsx(Cf,{}),style:{backgroundColor:e.role==="user"?"#1890ff":"#52c41a",marginRight:12}}),s.jsxs("div",{className:"reference-page__message-text",children:[s.jsxs("div",{className:"reference-page__message-header",children:[s.jsx(Gt,{strong:!0,children:e.role==="user"?"Вы":"ИИ Помощник"}),s.jsx(Gt,{type:"secondary",style:{fontSize:12,marginLeft:8},children:a})]}),s.jsx(X$,{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.content}),e.sources&&e.sources.length>0&&s.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid #f0f0f0"},children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Источники:"}),s.jsx("div",{style:{marginTop:4},children:e.sources.map(n=>s.jsxs(Ze,{style:{marginTop:4,cursor:"pointer"},onClick:()=>r(n),children:[n.title," (стр. ",n.page,")"]},`${n.id||n.title}-${n.page}`))})]}),e.role==="assistant"&&s.jsx("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid #f0f0f0"},children:s.jsxs(Te,{children:[s.jsx(Be,{type:"text",size:"small",icon:s.jsx(Tb,{}),onClick:()=>t(e.id,"like"),style:{color:e.rating==="like"?"#52c41a":void 0},children:"Полезно"}),s.jsx(Be,{type:"text",size:"small",icon:s.jsx(Ob,{}),onClick:()=>t(e.id,"dislike"),style:{color:e.rating==="dislike"?"#ff4d4f":void 0},children:"Не полезно"})]})})]})]})})});jS.displayName="MessageItem";const J$=()=>{var Za,Aa;const[e,t]=M.useState([]),[r,a]=M.useState(""),[n,i]=M.useState(!1),[o,l]=M.useState(!1),[c,A]=M.useState(!0),[d,f]=M.useState(null),[p,u]=M.useState([]),[g,h]=M.useState([]),[x,y]=M.useState(null),[v,E]=M.useState(""),[k,S]=M.useState([]),[B,b]=M.useState(0),[O,_]=M.useState(1),[U,I]=M.useState(null),[R,L]=M.useState(!1),[N,P]=M.useState(null),[Q,Y]=M.useState([]),[ee,V]=M.useState(0),[G,z]=M.useState(null),[C,D]=M.useState(()=>{try{return localStorage.getItem("reference_training_mode")==="true"}catch{return!1}}),[j,K]=M.useState(!1),[W,Ae]=M.useState(null),[ue,he]=M.useState(!1),[ve]=re.useForm(),[we,se]=M.useState(!1),[He,Ee]=M.useState(()=>{try{const ge=localStorage.getItem("ai_appraisal_skills");if(ge)return JSON.parse(ge)}catch{}return{incomeApproach:50,incomeMethods:{dcf:50,directCapitalization:50,grossRentMultiplier:50},comparativeApproach:50,comparativeMethods:{salesComparison:50,marketExtraction:50},costApproach:50,costMethods:{replacementCost:50,reproductionCost:50,depreciation:50}}}),[pe,ce]=M.useState(()=>{try{const ge=localStorage.getItem("ai_expertise_skills");if(ge)return JSON.parse(ge)}catch{}return{expertiseLevel:50,analysisLevel:50,responseBrevity:50,riskAnalysis:50,comments:50,detailLevel:50,useDeepSeek:!0}});M.useEffect(()=>{try{localStorage.setItem("ai_appraisal_skills",JSON.stringify(He))}catch{}},[He]),M.useEffect(()=>{try{localStorage.setItem("ai_expertise_skills",JSON.stringify(pe))}catch{}},[pe]);const Ge=M.useMemo(()=>[{value:"real_estate",label:"Недвижимое имущество"},{value:"land",label:"Земельные участки"},{value:"movable",label:"Движимое имущество"},{value:"metals_goods",label:"Товары и материалы"},{value:"equity",label:"Доли, акции и ЦБ"},{value:"rights",label:"Права требования"}],[]),et=q$,Ye=re.useWatch("assetType",ve),tt=M.useMemo(()=>K$(Ye),[Ye]),je=M.useMemo(()=>(tt==null?void 0:tt.fields)??[],[tt]),_e=tt==null?void 0:tt.assetGroup;M.useEffect(()=>{if(Ye&&j){const ge=et.find(H=>H.value===Ye);ge&&Ee(H=>{const le=G$(H,ge.label,!1);return JSON.stringify(le)!==JSON.stringify(H)?(Ne.info(`Настройки эквалайзера автоматически применены для типа: ${ge.label}`),le):H})}},[Ye,j,et]);const At=M.useCallback(()=>{D(ge=>{const H=!ge;try{localStorage.setItem("reference_training_mode",String(H))}catch{}return H})},[]),Ct=M.useCallback(()=>{K(ge=>(ge&&(Ae(null),z(null)),!ge))},[]),_t=M.useCallback(()=>{var oe;const ge=ve.getFieldsValue();if(!ge||!ge.assetGroup||!ge.assetType)return"";const H=[],le=((oe=Ge.find(de=>de.value===(ge.assetGroup||_e)))==null?void 0:oe.label)||ge.assetGroup||_e,ae=et.find(de=>de.value===ge.assetType);le&&H.push(`Категория: ${le}`),H.push(`Тип актива: ${(ae==null?void 0:ae.label)||ge.assetType}`),ge.purpose&&H.push(`Цель: ${ge.purpose}`),ge.additionalFactors&&H.push(`Особенности: ${ge.additionalFactors}`);const Z=q1(ge.attributes,je);return Z&&H.push(`Ключевые параметры: ${Z}`),H.join(`
`)},[ve,Ge,_e,je,et]);M.useEffect(()=>{if(!C)return;let ge=!1;const H=6e4,le=async()=>{if(!ge)try{Va.analyzeDocuments(),Va.analyzeFeedback(),ua.addExperienceFromDocuments(),ua.updateExperienceFromCurrentData();const Z=Va.getLearningStats(),oe=ua.getEvolutionStats(),de=ua.getProgressToNextLevel();if(!ge&&oe&&(_(oe.level),I(de)),!ge){const Oe=Math.min(Z.patternsCount*5,30),Pe=Z.averageSuccessRate*25,Ce=Math.min(Z.totalUsage/10,15),De=Math.min(Z.insightsCount*2,10),Me=oe?Math.min(oe.level*2,20):0;b(Math.round(Oe+Pe+Ce+De+Me)),V(Va.getCategorySkill("appraisal"))}}catch{}finally{ge||window.setTimeout(le,H)}},ae=window.setTimeout(le,2e3);return()=>{ge=!0,window.clearTimeout(ae)}},[C]);const[Et,Pt]=M.useState(()=>{const ge=localStorage.getItem("reference_chats_visible");return ge!==null?ge==="true":!0}),Lt=M.useRef(null),Bt=M.useRef(null),ut=M.useRef(new Map);M.useEffect(()=>{localStorage.setItem("reference_chats_visible",String(Et))},[Et]);const ct=Math.min(32+(O-1)*6,80),wr=({size:ge=ct})=>s.jsxs("svg",{width:ge,height:ge,viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle",marginRight:"8px",transition:"width 0.5s ease-in-out, height 0.5s ease-in-out"},className:"robot-icon",children:[s.jsx("rect",{x:"156",y:"120",width:"200",height:"180",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"8"}),s.jsx("rect",{x:"176",y:"160",width:"160",height:"100",rx:"10",fill:"#e6f7ff",stroke:"#40a9ff",strokeWidth:"4"}),s.jsx("circle",{cx:"216",cy:"200",r:"12",fill:"#1890ff"}),s.jsx("circle",{cx:"296",cy:"200",r:"12",fill:"#1890ff"}),s.jsx("circle",{cx:"216",cy:"200",r:"6",fill:"#fff"}),s.jsx("circle",{cx:"296",cy:"200",r:"6",fill:"#fff"}),s.jsx("rect",{x:"236",y:"240",width:"40",height:"8",rx:"4",fill:"#1890ff"}),s.jsx("circle",{cx:"256",cy:"100",r:"8",fill:"#ff4d4f"}),s.jsx("line",{x1:"256",y1:"100",x2:"256",y2:"120",stroke:"#1890ff",strokeWidth:"6",strokeLinecap:"round"}),s.jsx("rect",{x:"176",y:"300",width:"160",height:"120",rx:"15",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"8"}),s.jsx("rect",{x:"196",y:"320",width:"120",height:"60",rx:"8",fill:"#e6f7ff",stroke:"#40a9ff",strokeWidth:"3"}),s.jsx("circle",{cx:"226",cy:"350",r:"6",fill:"#52c41a"}),s.jsx("circle",{cx:"256",cy:"350",r:"6",fill:"#faad14"}),s.jsx("circle",{cx:"286",cy:"350",r:"6",fill:"#ff4d4f"}),s.jsx("rect",{x:"116",y:"320",width:"40",height:"80",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),s.jsx("rect",{x:"356",y:"320",width:"40",height:"80",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),s.jsx("circle",{cx:"136",cy:"420",r:"12",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"4"}),s.jsx("circle",{cx:"376",cy:"420",r:"12",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"4"}),s.jsx("rect",{x:"196",y:"420",width:"50",height:"60",rx:"10",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),s.jsx("rect",{x:"266",y:"420",width:"50",height:"60",rx:"10",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),s.jsx("ellipse",{cx:"221",cy:"490",rx:"20",ry:"8",fill:"#0050b3"}),s.jsx("ellipse",{cx:"291",cy:"490",rx:"20",ry:"8",fill:"#0050b3"}),s.jsx("line",{x1:"196",y1:"340",x2:"316",y2:"340",stroke:"#40a9ff",strokeWidth:"2",opacity:"0.5"}),s.jsx("line",{x1:"196",y1:"360",x2:"316",y2:"360",stroke:"#40a9ff",strokeWidth:"2",opacity:"0.5"})]});M.useEffect(()=>{let ge=!0;return(async()=>{A(!0);try{Va.initialize(),ua.initialize(),await Promise.all([$s.loadFromStorage(),Cn.loadFromStorage()]);const le=Cn.getCategories();if(ge&&h(le),ge){const Z=Va.getLearningStats(),oe=ua.getEvolutionStats(),de=ua.getProgressToNextLevel();oe&&(_(oe.level),I(de));const Oe=Math.min(Z.patternsCount*5,30),Pe=Z.averageSuccessRate*25,Ce=Math.min(Z.totalUsage/10,15),De=Math.min(Z.insightsCount*2,10),Me=oe?Math.min(oe.level*2,20):0;b(Math.round(Oe+Pe+Ce+De+Me)),V(Va.getCategorySkill("appraisal")),A(!1)}(async()=>{try{l(!0),console.log("🔄 Загружаю документы из VND...");const Z=await RS(!1);if(!ge)return;if(u(Z),console.log(`✅ Загружено документов: ${Z.length}`),le.length===0&&Z.length>0&&(console.log("Категории пустые, перестраиваю базу знаний..."),await Cn.buildFromDocuments(),ge)){const oe=Cn.getCategories();h(oe)}Z.length>0&&setTimeout(()=>{ge&&(console.log("🧠 Анализирую документы для обучения модели..."),Va.analyzeDocuments(),ua.addExperienceFromDocuments(),console.log("✅ Анализ документов завершен"))},100),Z.length>0&&ge&&Ne.success(`Загружено документов: ${Z.length}. База знаний готова к использованию.`)}catch{ge&&Ne.warning("Не удалось загрузить документы из VND. Вы можете загрузить их вручную.")}finally{ge&&l(!1)}})(),setTimeout(()=>{ge&&(Va.analyzeFeedback(),ua.updateExperienceFromCurrentData())},50)}catch{ge&&A(!1)}})(),()=>{ge=!1}},[]),M.useEffect(()=>{if(!j)return;!ve.getFieldsValue().assetType&&et.length>0&&ve.setFieldsValue({assetType:et[0].value})},[j,ve,et]),M.useEffect(()=>{_e&&ve.getFieldValue("assetGroup")!==_e&&ve.setFieldsValue({assetGroup:_e})},[_e,ve]),M.useEffect(()=>{const ge=Ol();Y(ge)},[]),M.useEffect(()=>{if(N){const ge=ib(N);ge&&t(ge.messages.map(H=>({...H,timestamp:H.timestamp instanceof Date?H.timestamp:new Date(H.timestamp)})))}else t([])},[N]),M.useEffect(()=>{N&&e.length>0&&ib(N)&&(k$(N,{messages:e}),Y(Ol()))},[e,N]);const Rt=M.useCallback(()=>{const ge=document.querySelector(".reference-page__messages");ge&&requestAnimationFrame(()=>{ge.scrollTo({top:ge.scrollHeight,behavior:"smooth"})}),Lt.current&&requestAnimationFrame(()=>{var H;(H=Lt.current)==null||H.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})},[]);M.useEffect(()=>{e.length>0&&setTimeout(()=>{Rt()},100)},[e.length,Rt]),M.useEffect(()=>{if(!c){f(null);return}f(10);const ge=window.setInterval(()=>{f(H=>H===null?null:H<=0?0:H-1)},1e3);return()=>{window.clearInterval(ge),f(null)}},[c]);const $r=M.useCallback((ge,H)=>{const le=ge.trim().toLowerCase();if(!le)return[];const ae=`${le}::${H}`,Z=ut.current.get(ae),oe=Date.now();if(Z&&oe-Z.timestamp<5*60*1e3)return Z.result;const de=Cn.search(ge,H);return ut.current.set(ae,{result:de,timestamp:oe}),de},[]);M.useEffect(()=>{const ge=v.trim();if(ge.length<=2){S([]);return}const H=setTimeout(()=>{try{const le=$r(ge,10);S(le)}catch{S([])}},400);return()=>clearTimeout(H)},[v,$r]);const hr=M.useMemo(()=>g.map(ge=>ge.name).join(", "),[g]),vt=M.useCallback(async(ge,H=[],le)=>{const ae=ge.toLowerCase(),Z=$r(ge,5);let oe="",de=[],Oe="";if(Z.length>0){const Pe=[];for(const Ce of Z)Pe.push(`Тема: ${Ce.title}
Содержание: ${Ce.content}
Страница: ${Ce.page}`);Oe=Pe.join(`

---

`),de=Z}le&&(Oe=`${Oe||""}

[Дополнительный контекст задания]
${le}`);try{const Pe=pe.useDeepSeek!==!1;if(H.length>0){const Ce=H.slice(-10).map($e=>({role:$e.role,content:$e.content}));Ce.push({role:"user",content:ge});let De=Oe||`База знаний содержит информацию о банковских залогах, ипотеке, оценке имущества, LTV, договорах залога, нормативных требованиях и регистрации залогов. Доступные категории: ${hr}.`;const Me=`


Настройки режима экспертизы (эквалайзер):
- Уровень экспертизы: ${pe.expertiseLevel}%
- Уровень анализа: ${pe.analysisLevel}%
- Краткость ответов: ${pe.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${pe.riskAnalysis}%
- Комментарии: ${pe.comments}%
- Детализация: ${pe.detailLevel}%
- Использовать AI DeepSeek для генерации ответов: ${Pe?"ДА":"НЕТ"}

Профиль ответа помощника:
- Ты отвечаешь как профессионал в области оценки залогового имущества Банка.
- Ты эксперт в области анализа рисков по реализации залогового имущества и формируешь профессиональное суждение по ликвидности залогового имущества.
- Ты обладаешь знаниями по регистрации залогов движимого и недвижимого имущества.
- Ответы должны быть краткими, но ёмкими.
- При формировании ответа опирайся на контекст из базы знаний и на значения эквалайзера (уровни экспертизы, анализа, краткость, анализ рисков, детализацию).

Учитывай эти настройки при формировании ответа.`;De+=Me,oe=await fd.chat(Ce,De),setTimeout(()=>{ua.addPassiveExperience(ge,oe.length)},0)}else if(Oe){const Ce=pe.useDeepSeek!==!1,De=`


Настройки режима экспертизы (эквалайзер):
- Уровень экспертизы: ${pe.expertiseLevel}%
- Уровень анализа: ${pe.analysisLevel}%
- Краткость ответов: ${pe.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${pe.riskAnalysis}%
- Комментарии: ${pe.comments}%
- Детализация: ${pe.detailLevel}%
- Использовать AI DeepSeek для генерации ответов: ${Ce?"ДА":"НЕТ"}

Профиль ответа помощника:
- Ты отвечаешь как профессионал в области оценки залогового имущества Банка.
- Ты эксперт в области анализа рисков по реализации залогового имущества и формируешь профессиональное суждение по ликвидности залогового имущества.
- Ты обладаешь знаниями по регистрации залогов движимого и недвижимого имущества.
- Ответы должны быть краткими, но ёмкими.
- При формировании ответа опирайся на контекст из базы знаний и на значения эквалайзера (уровни экспертизы, анализа, краткость, анализ рисков, детализацию).

Учитывай эти настройки при формировании ответа.`;oe=await fd.generateResponse(ge,Oe+De),setTimeout(()=>{ua.addPassiveExperience(ge,oe.length)},0)}else if(ae.includes("привет")||ae.includes("здравствуй")){const Ce='Поприветствуй пользователя и расскажи, что ты эксперт по банковским залогам и можешь помочь с вопросами об ипотеке, оценке, LTV, договорах залога и других аспектах залогового кредитования. База знаний основана на справочной литературе "Залоговik. Все о банковских залогах".',De=pe.useDeepSeek!==!1,Me=`


Настройки режима экспертизы (эквалайзер):
- Уровень экспертизы: ${pe.expertiseLevel}%
- Уровень анализа: ${pe.analysisLevel}%
- Краткость ответов: ${pe.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${pe.riskAnalysis}%
- Комментарии: ${pe.comments}%
- Детализация: ${pe.detailLevel}%
- Использовать AI DeepSeek для генерации ответов: ${De?"ДА":"НЕТ"}

Профиль ответа помощника:
- Ты отвечаешь как профессионал в области оценки залогового имущества Банка.
- Ты эксперт в области анализа рисков по реализации залогового имущества и формируешь профессиональное суждение по ликвидности залогового имущества.
- Ты обладаешь знаниями по регистрации залогов движимого и недвижимого имущества.
- Ответы должны быть краткими, но ёмкими.
- При формировании ответа опирайся на контекст из базы знаний и на значения эквалайзера (уровни экспертизы, анализа, краткость, анализ рисков, детализацию).

Учитывай эти настройки при формировании ответа.`;oe=await fd.chat([{role:"user",content:Ce+Me}],Me),Oe="Приветствие"}else{let Ce=`База знаний содержит информацию о банковских залогах, ипотеке, оценке имущества, LTV, договорах залога, нормативных требованиях и регистрации залогов. Доступные категории: ${hr}.`;const De=pe.useDeepSeek!==!1,Me=`


Настройки режима экспертизы (эквалайзер):
- Уровень экспертизы: ${pe.expertiseLevel}%
- Уровень анализа: ${pe.analysisLevel}%
- Краткость ответов: ${pe.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${pe.riskAnalysis}%
- Комментарии: ${pe.comments}%
- Детализация: ${pe.detailLevel}%
- Использовать AI DeepSeek для генерации ответов: ${De?"ДА":"НЕТ"}

Профиль ответа помощника:
- Ты отвечаешь как профессионал в области оценки залогового имущества Банка.
- Ты эксперт в области анализа рисков по реализации залогового имущества и формируешь профессиональное суждение по ликвидности залогового имущества.
- Ты обладаешь знаниями по регистрации залогов движимого и недвижимого имущества.
- Ответы должны быть краткими, но ёмкими.
- При формировании ответа опирайся на контекст из базы знаний и на значения эквалайзера (уровни экспертизы, анализа, краткость, анализ рисков, детализацию).

Учитывай эти настройки при формировании ответа.`;Ce+=Me,oe=await fd.generateResponse(ge,Ce),Oe=Ce}}catch(Pe){const Ce=Pe instanceof Error?Pe.message:String(Pe);if(Ce.includes("API ключ")||Ce.includes("401")||Ce.includes("403"))throw new Error("Проблема с доступом к AI сервису. Проверьте настройки API.");oe="Извините, профессиональный AI-помощник (DeepSeek) сейчас недоступен или ответ не удалось получить вовремя. Пожалуйста, повторите запрос позже. При необходимости вы можете временно воспользоваться обычным поиском по базе знаний.",Oe="AI_unavailable"}return{content:oe,sources:de,context:Oe}},[hr,g,$r,pe]),Or=M.useCallback(async()=>{if(!r.trim()||n)return;let ge=N;ge||(ge=Q1().id,P(ge),Y(Ol()));const H={id:`user-${Date.now()}`,role:"user",content:r.trim(),timestamp:new Date};ge&&Pu(ge,H),t(ae=>[...ae,H]);const le=r.trim();a(""),i(!0);try{const ae=e.map(Ce=>({id:Ce.id,role:Ce.role,content:Ce.content,timestamp:Ce.timestamp instanceof Date?Ce.timestamp:new Date(Ce.timestamp)})),Z=j?_t():"",{content:oe,sources:de,context:Oe}=await vt(le,ae,Z||void 0),Pe={id:`ai-${Date.now()}`,role:"assistant",content:oe,timestamp:new Date,sources:de.length>0?de:void 0,context:Oe};ge&&(Pu(ge,Pe),Y(Ol())),t(Ce=>[...Ce,Pe]),setTimeout(()=>{Rt()},150)}catch(ae){const Z=ae instanceof Error?ae.message:String(ae);console.error("Ошибка генерации ответа:",ae),console.error("Детали ошибки:",{message:Z,question:le,stack:ae instanceof Error?ae.stack:void 0});let oe="Извините, произошла ошибка при генерации ответа. ";Z.includes("API ключ")||Z.includes("401")||Z.includes("403")?oe+="Проблема с доступом к AI сервису. Проверьте настройки API ключа.":Z.includes("network")||Z.includes("fetch")||Z.includes("NetworkError")||Z.includes("Failed to fetch")?oe+="Проблема с подключением к интернету. Проверьте соединение и попробуйте еще раз.":Z.includes("timeout")||Z.includes("время ожидания")?oe+="Превышено время ожидания ответа (30 секунд). Попробуйте еще раз или упростите вопрос.":Z.includes("429")||Z.includes("лимит")?oe+="Превышен лимит запросов к API. Подождите немного и попробуйте позже.":Z.includes("CORS")?oe+="Ошибка CORS. Проблема с настройками сервера.":oe+=`Попробуйте еще раз или переформулируйте вопрос. (Ошибка: ${Z.substring(0,100)})`,Ne.error("Не удалось получить ответ от AI помощника. Проверьте консоль браузера для деталей.");const de={id:`ai-error-${Date.now()}`,role:"assistant",content:oe,timestamp:new Date};t(Oe=>[...Oe,de])}finally{i(!1)}},[r,n,vt,N,e,Rt,j,_t]),nr=ge=>{ge.key==="Enter"&&!ge.shiftKey&&(ge.preventDefault(),Or())},cn=M.useCallback((ge,H)=>{var de,Oe,Pe;const le=e.findIndex(Ce=>Ce.id===ge);if(le===-1)return;const ae=e[le];if(!ae||ae.role!=="assistant")return;const Z=le>0?e[le-1]:null,oe=(Z==null?void 0:Z.content)||"";try{Xc.saveFeedback({messageId:ge,question:oe,answer:ae.content,rating:H,timestamp:new Date,context:ae.context}),t(ot=>ot.map(mt=>mt.id===ge?{...mt,rating:H}:mt)),Va.analyzeFeedback();const Ce=(de=ae.context)!=null&&de.toLowerCase().includes("ltv")?"ltv_calculation":(Oe=ae.context)!=null&&Oe.toLowerCase().includes("оценк")?"appraisal":(Pe=ae.context)!=null&&Pe.toLowerCase().includes("риск")?"risks":"general";ua.addExperienceFromFeedback(H,Ce,oe),fd.invalidateFeedbackCache();const De=Va.getLearningStats(),Me=ua.getEvolutionStats(),$e=ua.getCurrentLevel(),ft=ua.getProgressToNextLevel();if(Me&&(_(Me.level),I(ft)),b((()=>{const ot=Math.min(De.patternsCount*5,30),mt=De.averageSuccessRate*25,Kt=Math.min(De.totalUsage/10,15),yr=Math.min(De.insightsCount*2,10),Cr=Me?Math.min(Me.level*2,20):0;return Math.round(ot+mt+Kt+yr+Cr)})()),V(Va.getCategorySkill("appraisal")),$e&&Me&&Me.level>1){const ot=ua.getCurrentLevel();ot&&Ne.success(`🎉 Модель достигла уровня: ${ot.name}! Опыт: ${Me.totalExperience}`)}H==="like"?Ne.success("Спасибо за оценку! Модель обучилась на вашем примере."):Ne.success("Спасибо за обратную связь. Модель проанализирует и улучшит ответы.")}catch{Ne.error("Не удалось сохранить оценку")}},[e]),Lr=M.useCallback(async ge=>{const H=ge.name.toLowerCase();if(![".pdf",".docx",".xlsx",".xls",".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(de=>H.endsWith(de)))return Ne.error("Поддерживаются только файлы: PDF, DOCX, XLSX, XLS, JPG, JPEG, PNG, GIF, BMP, WEBP"),!1;const Z=[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(de=>H.endsWith(de)),oe=Z?10*1024*1024:50*1024*1024;if(ge.size>oe)return Ne.error(`Размер файла не должен превышать ${Z?"10MB":"50MB"}`),!1;l(!0);try{let de;Z?de=await $s.indexDocument(ge):de=await N$(ge),u(Pe=>Pe.some(De=>De.documentName===de.documentName)?Pe:[...Pe,de]);const Oe=Cn.getCategories();if(h(Oe),Oe.length===0){await Cn.buildFromDocuments();const Pe=Cn.getCategories();h(Pe)}Ne.success(`${Z?"Изображение":"Документ"} "${ge.name}" успешно проиндексирован(о). База знаний обновлена.`)}catch(de){const Oe=de instanceof Error?de.message:"Неизвестная ошибка";Ne.error(`Не удалось ${Z?"проиндексировать изображение":"проиндексировать документ"}: ${Oe}`)}finally{l(!1)}return!1},[]),as=M.useCallback(async ge=>{const H=ge.name.toLowerCase();if(![".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(Z=>H.endsWith(Z)))return Ne.error("Для иллюстрации объекта поддерживаются только изображения (JPG, PNG, GIF, BMP, WEBP)"),Js.LIST_IGNORE;const ae=8*1024*1024;if(ge.size>ae)return Ne.error("Размер изображения не должен превышать 8MB"),Js.LIST_IGNORE;try{const Z=new FileReader;Z.onload=()=>{typeof Z.result=="string"&&(z(Z.result),Ne.success("Изображение объекта загружено для отчета"))},Z.readAsDataURL(ge)}catch{Ne.error("Не удалось загрузить изображение объекта")}return!1},[]),Ds=M.useCallback(async()=>{try{const ge=await ve.validateFields();he(!0);const H=et.find(Ce=>Ce.value===ge.assetType),le=ge.attributes||{},ae=q1(le,je),Z=[ge.additionalFactors,ae].filter(Boolean).join(". "),oe=le.location||le.baseLocation||le.storageLocation||void 0,de=(typeof le.areaSqm=="number"?le.areaSqm:void 0)??(typeof le.areaHa=="number"?le.areaHa:void 0)??(typeof le.quantity=="number"?le.quantity:void 0),Oe=le.condition||le.quality,Pe=await jy.generateEstimate({objectName:ge.objectName||(H==null?void 0:H.label)||"Объект оценки",assetGroup:ge.assetGroup,assetType:ge.assetType,location:oe,area:de,areaUnit:void 0,condition:Oe,incomePerYear:void 0,occupancy:void 0,purpose:ge.purpose,additionalFactors:Z,card:null,skills:He});if(Ae(Pe),V(Va.getCategorySkill("appraisal")),!G)try{const Ce=`${ge.objectName||(H==null?void 0:H.label)||"Объект оценки"}. ${(H==null?void 0:H.label)||""}. ${oe?`Расположен: ${oe}.`:""} ${Oe?`Состояние: ${Oe}.`:""} ${ae?`Характеристики: ${ae}.`:""}`;Ne.info("Генерация изображения объекта через ИИ...");const De=await Ab.generateImage(Ce,H==null?void 0:H.label,oe);z(De)}catch(Ce){console.warn("Не удалось сгенерировать изображение через ИИ:",Ce)}Ne.success("AI помощник подготовил оценку объекта")}catch(ge){if(ge&&ge.errorFields)return;console.error("Ошибка запроса оценки ИИ:",ge),Ne.error("Не удалось получить оценку. Проверьте заполненные данные.")}finally{he(!1)}},[ve,et,je,He,G]),Ur=M.useCallback(async()=>{var ge,H;if(!W){Ne.warning("Сначала выполните оценку ИИ, затем можно выгрузить PDF.");return}try{const le=ve.getFieldsValue(),ae=_t(),Z=new Date().toLocaleString("ru-RU"),oe=le.attributes||{},de=et.find(Yr=>Yr.value===le.assetType),Oe=((ge=le.objectName)==null?void 0:ge.trim())||(de==null?void 0:de.label)||"Объект оценки",Pe=oe.location||oe.baseLocation||oe.storageLocation||"";let Ce=G;if(!Ce)try{Ne.info("Генерация изображения объекта для PDF...");const Yr=q1(oe,je),en=`${Oe}. ${(de==null?void 0:de.label)||""}. ${Pe?`Расположен: ${Pe}.`:""} ${Yr?`Характеристики: ${Yr}.`:""}`;Ce=await Ab.generateImage(en,de==null?void 0:de.label,Pe)}catch(Yr){console.warn("Не удалось сгенерировать изображение для PDF:",Yr)}let De='<p style="margin: 0 0 8px 0;">Аналоги не были явно указаны в результате ИИ.</p>';W.comparables&&W.comparables.length>0&&(De=(await Promise.all(W.comparables.map(async(en,Co)=>{const li=typeof en=="string"?{description:en}:en,wA=li.url;let Rn=li.description,Bo=null;if(!wA){const Zd=/(https?:\/\/[^\s)\]}>"]+)/,ll=Rn.match(Zd);ll&&(Bo=ll[0].replace(/[.,;:!?]+$/,""),Rn=Rn.replace(ll[0],"").trim())}const An=wA?li.url:Bo,hc=An?` <br/><span style="font-size: 10px;">Ссылка на источник: <a href="${An}" target="_blank" style="color: #1890ff; text-decoration: underline; word-break: break-all;">${An}</a></span>`:"",mc=li.details||li.additionalInfo||li.notes||"";return`
              <div style="margin: 0 0 12px 0; padding: 8px; background: #f5f5f5; border-radius: 4px; border-left: 3px solid #1890ff;">
                <p style="margin: 0 0 4px 0;"><strong>Аналог ${Co+1}:</strong> ${Rn}</p>
                ${mc?`<p style="margin: 0 0 4px 0; font-size: 10px; color: #555;">Дополнительные характеристики: ${mc}</p>`:""}
                ${hc}
              </div>
            `}))).join(""));const Me=`
        <div style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 16px; font-size: 11px; line-height: 1.4; width: 750px; box-sizing: border-box; background:#ffffff;">
          <h2 style="margin: 0 0 8px 0;">Отчет об экспресс-оценке залогового актива (ИИ)</h2>
          <div style="margin-bottom: 8px;">Дата формирования: ${Z}</div>

          <div style="display: flex; align-items: center; margin: 8px 0 12px 0;">
            ${Ce?`<img src="${Ce}" alt="Объект оценки" style="width: 90px; height: 90px; border-radius: 8px; object-fit: cover; box-shadow: 0 2px 6px rgba(0,0,0,0.2); margin-right: 12px;" />`:`<div style="
                    width: 90px;
                    height: 90px;
                    border-radius: 8px;
                    background: linear-gradient(135deg, #1890ff 0%, #40a9ff 50%, #bae7ff 100%);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: #ffffff;
                    font-size: 9px;
                    text-align: center;
                    padding: 4px;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
                    margin-right: 12px;
                  ">
                    <div>
                      <div style="font-weight: 600; margin-bottom: 2px;">ОБЪЕКТ</div>
                      <div style="word-break: break-word;">${Oe}</div>
                    </div>
                  </div>`}
            <div style="font-size: 10px;">
              <div><strong>Тип актива:</strong> ${(de==null?void 0:de.label)||le.assetType||"-"}</div>
              ${Pe?`<div><strong>Локация:</strong> ${Pe}</div>`:""}
            </div>
          </div>

          <h3 style="margin: 12px 0 4px 0;">1. Описание объекта и исходные данные</h3>
          ${Ce?`<div style="margin: 8px 0; text-align: center;">
                  <img src="${Ce}" alt="Изображение объекта оценки" style="max-width: 100%; max-height: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); margin-bottom: 8px;" />
                  <p style="font-size: 10px; color: #666; margin: 0;">Изображение объекта, сгенерированное ИИ на основе описания</p>
                </div>`:""}
          <pre style="white-space: pre-wrap; margin: 0 0 8px 0;">${ae||"Нет данных"}</pre>

          <h3 style="margin: 12px 0 4px 0;">2. Итоги экспресс-оценки</h3>
          <ul style="margin: 0 0 8px 20px; padding: 0;">
            <li>Рыночная стоимость (ориентировочно): ${W.marketValue.toLocaleString("ru-RU")} ₽</li>
            <li>Залоговая стоимость (ориентировочно): ${W.collateralValue.toLocaleString("ru-RU")} ₽</li>
            ${typeof W.recommendedLtv=="number"?`<li>Рекомендуемый LTV: ${W.recommendedLtv}%</li>`:""}
            <li>Уровень уверенности модели: ${W.confidence}</li>
          </ul>

          <h3 style="margin: 12px 0 4px 0;">3. Методология расчета</h3>
          <p style="margin: 0 0 8px 0;">${W.methodology||"Методология не указана"}</p>

          <h3 style="margin: 12px 0 4px 0;">4. Использованные аналоги (если применимо)</h3>
          ${De}

          <h3 style="margin: 12px 0 4px 0;">5. Риски и корректировки</h3>
          ${W.riskFactors&&W.riskFactors.length>0?`<p style="margin: 0 0 4px 0;">Идентифицированные риски: ${W.riskFactors.join("; ")}</p>`:'<p style="margin: 0 0 4px 0;">Риски не были явно указаны моделью.</p>'}
          ${W.recommendedActions&&W.recommendedActions.length>0?`<p style="margin: 0 0 8px 0;">Рекомендации по учету рисков и корректировкам: ${W.recommendedActions.join("; ")}</p>`:""}

          <h3 style="margin: 12px 0 4px 0;">6. Основные допущения</h3>
          <p style="margin: 0;">
            ${W.assumptions&&W.assumptions.length>0?W.assumptions.join("; "):"Допущения явно не указаны моделью. Рекомендуется дополнительная экспертная проверка."}
          </p>
        </div>
      `,$e=document.createElement("div");if($e.style.position="fixed",$e.style.left="-10000px",$e.style.top="0",$e.style.width="750px",$e.style.minHeight="100px",$e.style.padding="16px",$e.style.backgroundColor="#ffffff",$e.style.color="#000000",$e.style.fontFamily='system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',$e.style.fontSize="11px",$e.style.lineHeight="1.4",$e.style.boxSizing="border-box",$e.style.visibility="visible",$e.style.opacity="1",$e.style.pointerEvents="none",$e.style.zIndex="999999",$e.style.overflow="visible",$e.innerHTML=Me,document.body.appendChild($e),$e.offsetHeight,$e.scrollHeight,await new Promise(Yr=>requestAnimationFrame(Yr)),await new Promise(Yr=>requestAnimationFrame(Yr)),await new Promise(Yr=>setTimeout(Yr,300)),Ce){const Yr=$e.querySelector("img");Yr&&await new Promise(en=>{if(Yr.complete&&Yr.naturalWidth>0&&Yr.naturalHeight>0)en(void 0);else{const Co=setTimeout(()=>en(void 0),3e3);Yr.onload=()=>{clearTimeout(Co),en(void 0)},Yr.onerror=()=>{clearTimeout(Co),en(void 0)}}})}$e.offsetHeight;const ft=$e.scrollHeight||1e3;if(ft<50)throw document.body.removeChild($e),new Error("Контейнер PDF пуст или не отрендерился");const xt=await Vy($e,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:750,height:ft,windowWidth:750,windowHeight:ft,onclone:Yr=>{const en=Yr.querySelector("div");en&&(en.style.visibility="visible",en.style.opacity="1")}});if(document.body.removeChild($e),!xt||xt.width===0||xt.height===0)throw new Error("Canvas is empty");const ot=xt.toDataURL("image/png"),mt=new Vt({orientation:"p",unit:"mm",format:"a4"}),Kt=mt.internal.pageSize.getWidth(),yr=mt.internal.pageSize.getHeight(),Cr=10,ya=Kt-Cr*2,Es=yr-Cr*2;let bs=ya,Fn=xt.height*bs/xt.width;Fn>Es&&(Fn=Es,bs=xt.width*Fn/xt.height);const js=(Kt-bs)/2,oi=(yr-Fn)/2;mt.addImage(ot,"PNG",js,oi,bs,Fn);const ss=((H=le.objectName)==null?void 0:H.trim())||"ai_appraisal_report",ha=new Date().toISOString().slice(0,10);mt.save(`Оценка_ИИ_${ss}_${ha}.pdf`)}catch{Ne.error("Не удалось сформировать PDF отчет.")}},[W,ve,_t,G,et,je]),$t=M.useCallback(ge=>{var H;if(W)try{const le=ve.getFieldsValue(),ae=((H=et.find(de=>de.value===le.assetType))==null?void 0:H.label)||le.assetType||"Неизвестный тип",Z=[];Z.push(`Объект: ${le.objectName||ae}`),Z.push(`Тип актива: ${ae}`),Z.push(`Рыночная: ${W.marketValue.toLocaleString("ru-RU")} ₽, Залоговая: ${W.collateralValue.toLocaleString("ru-RU")} ₽`),typeof W.recommendedLtv=="number"&&Z.push(`LTV: ${W.recommendedLtv}%`),Z.push(`Уверенность модели: ${W.confidence}`);const oe=Z.join(" | ");Xc.saveFeedback({messageId:`appraisal-${Date.now()}`,question:`AI-оценка для объекта "${le.objectName||ae}"`,answer:JSON.stringify(W),rating:ge,timestamp:new Date,context:oe}),Va.analyzeFeedback(),ua.addExperienceFromFeedback(ge,"appraisal",oe),V(Va.getCategorySkill("appraisal")),ge==="like"?Ne.success("Спасибо! Модель учтёт, что оценка была точной."):Ne.success("Спасибо за замечание. Модель дообучится на этом примере.")}catch{Ne.error("Не удалось сохранить обратную связь по оценке.")}},[W,ve,et]),Er=M.useCallback(async()=>{l(!0);try{Ne.info("Начинаю переиндексацию всех документов...");const ge=await F$();u(ge);const H=Cn.getCategories();h(H),Va.forceUpdate(),ua.addExperienceFromDocuments();const le=Va.getLearningStats(),ae=ua.getEvolutionStats(),Z=ua.getProgressToNextLevel();ae&&(_(ae.level),I(Z)),b((()=>{const de=Math.min(le.patternsCount*5,30),Oe=le.averageSuccessRate*25,Pe=Math.min(le.totalUsage/10,15),Ce=Math.min(le.insightsCount*2,10),De=ae?Math.min(ae.level*2,20):0;return Math.round(de+Oe+Pe+Ce+De)})()),Ne.success(`Переиндексация завершена. Обработано документов: ${ge.length}. Категорий: ${H.length}. Данные для самообучения обновлены.`)}catch(ge){const H=ge instanceof Error?ge.message:"Неизвестная ошибка";Ne.error(`Ошибка переиндексации: ${H}`)}finally{l(!1)}},[]),ii=M.useCallback(ge=>{a(ge.title),requestAnimationFrame(()=>{setTimeout(()=>{const H=ge.title;if(!H.trim()||n)return;const le={id:`user-${Date.now()}`,role:"user",content:H.trim(),timestamp:new Date};t(ae=>[...ae,le]),a(""),i(!0),vt(H.trim(),[],j&&_t()||void 0).then(({content:ae,sources:Z,context:oe})=>{const de={id:`ai-${Date.now()}`,role:"assistant",content:ae,timestamp:new Date,sources:Z.length>0?Z:void 0,context:oe};t(Oe=>[...Oe,de])}).catch(ae=>{const Z={id:`ai-error-${Date.now()}`,role:"assistant",content:"Извините, произошла ошибка при генерации ответа. Попробуйте еще раз или переформулируйте вопрос.",timestamp:new Date};t(oe=>[...oe,Z])}).finally(()=>{i(!1)})},50)})},[n,vt,j,_t]),xa=M.useCallback(ge=>{y(ge),E("")},[]),vs=M.useMemo(()=>[{icon:s.jsx(Ml,{}),text:"Расчет LTV и залоговая стоимость",query:"Как правильно рассчитать LTV (loan-to-value) для залогового имущества? Какие факторы влияют на залоговую стоимость?"},{icon:s.jsx(jr,{}),text:"Оценка залогового имущества",query:"Какие требования к независимой оценке залогового имущества? Как выбрать оценщика и проверить отчет об оценке?"},{icon:s.jsx(Rv,{}),text:"Анализ рисков залога",query:"Какие основные риски при принятии имущества в залог? Как оценить и минимизировать риски по залоговому обеспечению?"},{icon:s.jsx(tO,{}),text:"Регистрация обременения в Росреестре",query:"Как зарегистрировать обременение в Росреестре? Какие документы необходимы для регистрации залога недвижимости?"},{icon:s.jsx(jr,{}),text:"Визуальный осмотр залогового имущества",query:"Как провести визуальный осмотр залогового имущества? На что обратить внимание при проверке наличия и состояния залога?"},{icon:s.jsx(Rv,{}),text:"Обращение взыскания на залог",query:"В каких случаях можно обратить взыскание на залоговое имущество? Каков порядок реализации залога?"}],[]),ws=M.useCallback(ge=>{if(!ge.trim()||n)return;let H=N;H||(H=Q1().id,P(H),Y(Ol()));const le={id:`user-${Date.now()}`,role:"user",content:ge.trim(),timestamp:new Date};H&&Pu(H,le),t(Z=>[...Z,le]),a(""),i(!0);const ae=e.map(Z=>({id:Z.id,role:Z.role,content:Z.content,timestamp:Z.timestamp instanceof Date?Z.timestamp:new Date(Z.timestamp)}));vt(ge.trim(),ae,j&&_t()||void 0).then(({content:Z,sources:oe,context:de})=>{const Oe={id:`ai-${Date.now()}`,role:"assistant",content:Z,timestamp:new Date,sources:oe.length>0?oe:void 0,context:de};H&&(Pu(H,Oe),Y(Ol())),t(Pe=>[...Pe,Oe]),setTimeout(()=>{Rt()},150)}).catch(Z=>{const oe={id:`ai-error-${Date.now()}`,role:"assistant",content:"Извините, произошла ошибка при генерации ответа. Попробуйте еще раз или переформулируйте вопрос.",timestamp:new Date};H&&(Pu(H,oe),Y(Ol())),t(de=>[...de,oe]),setTimeout(()=>{Rt()},150)}).finally(()=>{i(!1)})},[n,vt,N,e,Rt,j,_t]),Dt=M.useMemo(()=>{const ge=new Date;ge.setHours(0,0,0,0);const H=new Date(ge);H.setDate(H.getDate()-1);const le=new Date(ge);le.setDate(le.getDate()-7);const ae=new Date(ge);ae.setDate(ae.getDate()-30);const Z={today:[],yesterday:[],week:[],month:[]};return Q.forEach(oe=>{const de=new Date(oe.updatedAt);de.setHours(0,0,0,0),de.getTime()===ge.getTime()?Z.today.push(oe):de.getTime()===H.getTime()?Z.yesterday.push(oe):de>=le?Z.week.push(oe):de>=ae&&Z.month.push(oe)}),Z},[Q]),ns=M.useCallback(()=>{const ge=Q1();P(ge.id),Y(Ol()),t([]),Ne.success("Создан новый чат")},[]),Ja=M.useCallback(ge=>{P(ge)},[]);return s.jsxs("div",{className:"reference-page",children:[s.jsxs("div",{className:`reference-page__sidebar ${Et?"reference-page__sidebar--visible":""}`,children:[s.jsxs("div",{className:"reference-page__sidebar-header",children:[s.jsxs(Te,{children:[s.jsx(wr,{size:24}),s.jsx(Gt,{strong:!0,style:{color:"#fff",fontSize:"16px"},children:"Чаты"})]}),s.jsx(Be,{type:"text",icon:Et?s.jsx(gb,{}):s.jsx(mb,{}),onClick:()=>Pt(!Et),style:{color:"#fff"},title:Et?"Свернуть панель чатов":"Развернуть панель чатов"})]}),Et&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"reference-page__sidebar-content",children:[s.jsx(Be,{type:"primary",icon:s.jsx(ys,{}),onClick:ns,block:!0,style:{marginBottom:16},children:"Новый чат"}),s.jsxs("div",{className:"reference-page__chats-list",children:[Dt.today.length>0&&s.jsxs("div",{className:"reference-page__chats-group",children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"Сегодня"}),Dt.today.map(ge=>s.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[s.jsx(Gt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),s.jsx(Be,{type:"text",icon:s.jsx(Z0,{}),size:"small",onClick:H=>{H.stopPropagation()},style:{color:"#8c8c8c"}})]},ge.id))]}),Dt.yesterday.length>0&&s.jsxs("div",{className:"reference-page__chats-group",children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"Вчера"}),Dt.yesterday.map(ge=>s.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[s.jsx(Gt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),s.jsx(Be,{type:"text",icon:s.jsx(Z0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),Dt.week.length>0&&s.jsxs("div",{className:"reference-page__chats-group",children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"7 дней"}),Dt.week.map(ge=>s.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[s.jsx(Gt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),s.jsx(Be,{type:"text",icon:s.jsx(Z0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),Dt.month.length>0&&s.jsxs("div",{className:"reference-page__chats-group",children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"30 дней"}),Dt.month.map(ge=>s.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[s.jsx(Gt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),s.jsx(Be,{type:"text",icon:s.jsx(Z0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),Q.length===0&&s.jsx("div",{style:{padding:16,textAlign:"center"},children:s.jsx(Gt,{type:"secondary",style:{color:"#8c8c8c"},children:"Нет сохраненных чатов"})})]})]})})]}),s.jsxs("div",{className:`reference-page__main-content ${Et?"reference-page__main-content--with-sidebar":""}`,children:[s.jsxs("div",{className:"reference-page__header",children:[s.jsxs("div",{className:"reference-page__header-left",children:[s.jsx(wr,{size:ct}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsxs(Te,{align:"center",style:{marginBottom:4},size:"small",children:[s.jsx(Xp,{level:2,style:{margin:0,fontSize:"22px",lineHeight:"1.2"},children:"Справочная с ИИ"}),s.jsxs(Ze,{color:B>=70?"success":B>=40?"processing":"default",icon:s.jsx(Ib,{}),style:{fontSize:"12px",padding:"4px 12px",borderRadius:"16px",fontWeight:600,height:"auto",lineHeight:"1.5"},children:["Индекс самообучаемости: ",B,"%"]})]}),U&&s.jsx("div",{style:{marginBottom:4,maxWidth:500},children:s.jsxs(Te,{direction:"vertical",size:2,style:{width:"100%"},children:[s.jsxs(Te,{size:"small",children:[s.jsxs(Gt,{strong:!0,style:{fontSize:"12px"},children:["Уровень: ",((Za=ua.getCurrentLevel())==null?void 0:Za.name)||"Новичок"," (",O,")"]}),s.jsxs(Gt,{type:"secondary",style:{fontSize:"11px"},children:["Опыт: ",((Aa=ua.getEvolutionStats())==null?void 0:Aa.totalExperience)||0]})]}),s.jsx(qn,{percent:U.percentage,status:U.percentage>=90?"active":"normal",strokeColor:{"0%":"#108ee9","100%":"#87d068"},format:()=>`${U.current}/${U.required} опыта`,size:"small",style:{marginTop:2},showInfo:!1})]})}),s.jsxs(Te,{direction:"vertical",size:4,style:{width:"100%"},children:[s.jsx(Gt,{type:"secondary",style:{fontSize:"11px",lineHeight:"1.3"},children:"База знаний на основе справочной литературы по банковским залогам"}),s.jsxs(Te,{align:"center",wrap:!0,size:"small",children:[s.jsxs(Ze,{color:ee>=70?"success":ee>=40?"processing":"default",icon:s.jsx(Ml,{}),style:{margin:0},children:["Скилл оценки: ",ee,"%"]}),s.jsx(Ze,{color:C?"processing":"default",icon:s.jsx(kv,{spin:C}),style:{margin:0},children:"Режим обучения"}),s.jsx(Be,{size:"small",type:j?"primary":"default",icon:s.jsx(Ml,{}),onClick:Ct,children:"Режим оценки"}),s.jsx(Be,{size:"small",type:C?"primary":"default",icon:s.jsx(kv,{spin:C}),onClick:At,children:C?"Остановить обучение":"Режим обучения"}),s.jsx(Be,{size:"small",type:"default",icon:s.jsx(Kc,{}),onClick:()=>se(!0),children:"Эквалайзер скилов"})]})]})]})]}),s.jsxs("div",{className:"reference-page__header-right",children:[p.length>0&&s.jsxs(Ze,{icon:s.jsx(rO,{}),color:"blue",style:{margin:0,padding:"4px 12px"},children:["Документов: ",p.length]}),s.jsxs(Be,{icon:s.jsx(aO,{}),onClick:()=>Pt(!Et),size:"middle",type:Et?"primary":"default",style:{marginRight:8},title:Et?"Скрыть историю чатов":"Показать историю чатов",children:["Чаты"," ",Q.length>0&&s.jsx(Bf,{count:Q.length,size:"small",style:{marginLeft:4}})]}),s.jsx(Be,{icon:s.jsx(Kc,{}),onClick:()=>L(!0),size:"middle",children:"Настройки"})]})]}),j?s.jsx(Ue,{size:"small",className:"reference-page__appraisal-panel",children:s.jsx(re,{layout:"vertical",form:ve,children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"middle",children:[s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between"},children:[s.jsx(Gt,{strong:!0,children:"Режим оценки активен"}),s.jsx(Be,{size:"small",onClick:Ct,children:"Выйти из режима оценки"})]}),s.jsxs(Te,{size:"middle",wrap:!0,children:[s.jsx(re.Item,{label:"Категория",name:"assetGroup",children:s.jsx(Ve,{style:{minWidth:220},options:Ge,disabled:!0})}),s.jsx(re.Item,{label:"Тип актива",name:"assetType",dependencies:["assetGroup"],rules:[{required:!0,message:"Выберите тип актива"}],children:s.jsx(Ve,{style:{minWidth:260},placeholder:"Выберите тип",options:et})}),s.jsx(re.Item,{label:"Наименование",name:"objectName",children:s.jsx(Re,{placeholder:"Например, складской комплекс на МКАД"})})]}),je.length>0&&s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Ключевые атрибуты для оценки"}),s.jsx(dt,{gutter:12,style:{marginTop:8},children:je.map(ge=>s.jsx(be,{xs:24,md:12,lg:8,children:s.jsx(re.Item,{label:ge.label,name:["attributes",ge.key],children:ge.type==="number"?s.jsx(pa,{style:{width:"100%"},placeholder:ge.placeholder,controls:!1}):s.jsx(Re,{placeholder:ge.placeholder})})},ge.key))})]}),s.jsx(dt,{gutter:12,children:s.jsx(be,{xs:24,md:12,children:s.jsxs(re.Item,{label:"Фото объекта для отчета",children:[s.jsx(Js,{accept:".jpg,.jpeg,.png,.gif,.bmp,.webp",showUploadList:!1,beforeUpload:as,children:s.jsx(Be,{size:"small",children:"Загрузить изображение"})}),G&&s.jsx("div",{style:{marginTop:8},children:s.jsx("img",{src:G,alt:"Объект оценки",style:{maxWidth:160,maxHeight:120,borderRadius:8,objectFit:"cover"}})})]})})}),s.jsxs(dt,{gutter:12,children:[s.jsx(be,{xs:24,md:12,children:s.jsx(re.Item,{label:"Цель оценки",name:"purpose",children:s.jsx(Re,{placeholder:"Например, взыскание, кредитование"})})}),s.jsx(be,{xs:24,md:12,children:s.jsx(re.Item,{label:"Особенности / комментарии",name:"additionalFactors",children:s.jsx(Re,{placeholder:"Земля в аренде, есть обременения..."})})})]}),s.jsxs(Te,{style:{justifyContent:"space-between",width:"100%"},children:[s.jsx(Gt,{type:"secondary",children:"После заполнения полей AI помощник выполнит экспресс-оценку и учтёт данные в самообучении."}),s.jsxs(Te,{children:[s.jsx(Be,{type:"default",icon:s.jsx(jr,{}),disabled:!W,onClick:Ur,children:"Выгрузить PDF"}),s.jsx(Be,{type:"primary",icon:s.jsx(Ml,{}),loading:ue,onClick:Ds,children:"Получить оценку ИИ"})]})]}),W&&s.jsx(Nr,{type:"success",showIcon:!0,message:`Рыночная стоимость: ${W.marketValue.toLocaleString("ru-RU")} ₽ · Залоговая: ${W.collateralValue.toLocaleString("ru-RU")} ₽`,description:s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Методология:"})," ",W.methodology,s.jsx("br",{}),s.jsx(Gt,{strong:!0,children:"Ключевые риски:"})," ",W.riskFactors.join("; ")||"не выявлены",s.jsx("br",{}),s.jsx(Gt,{strong:!0,children:"Рекомендации:"})," ",W.recommendedActions.join("; ")||"—",s.jsx("br",{}),s.jsxs(Te,{size:"small",style:{marginTop:8},children:[s.jsx(Be,{size:"small",type:"text",icon:s.jsx(Tb,{}),onClick:()=>$t("like"),title:"Оценка точна"}),s.jsx(Be,{size:"small",type:"text",icon:s.jsx(Ob,{}),onClick:()=>$t("dislike"),title:"Оценка неточна"})]})]})})]})})}):s.jsxs(s.Fragment,{children:[c&&s.jsx(Nr,{message:"Инициализация ИИ-справочной...",description:s.jsxs("div",{children:[s.jsx("span",{className:"reference-page__loading-text",children:"Справочная загружается, подождите пожалуйста..."}),typeof d=="number"&&s.jsxs("div",{style:{marginTop:4},children:["Осталось примерно ",d," сек."]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(Ue,{className:"reference-page__card",children:s.jsx("div",{className:"reference-page__chat",children:s.jsxs("div",{className:"reference-page__messages",children:[e.length===0?s.jsx("div",{className:"reference-page__empty",children:s.jsxs("div",{className:"reference-page__welcome",children:[s.jsx(Cf,{style:{fontSize:40,color:"#1890ff",marginBottom:8}}),s.jsx(Xp,{level:4,style:{marginBottom:4,fontSize:"18px"},children:"Справочная с ИИ"}),s.jsx(Gt,{type:"secondary",style:{fontSize:13,marginBottom:12,display:"block"},children:"Задайте вопрос ниже, и я найду ответ в базе знаний"}),s.jsx(jt,{style:{margin:"8px 0"}}),s.jsx("div",{className:"reference-page__quick-questions",children:s.jsx(S2,{ghost:!0,items:[{key:"1",label:s.jsx(Gt,{strong:!0,style:{fontSize:14},children:"Популярные вопросы"}),children:s.jsx(Te,{direction:"vertical",size:"small",style:{width:"100%"},children:vs.map((ge,H)=>s.jsx(Be,{type:"default",icon:ge.icon,onClick:()=>ws(ge.query),style:{width:"100%",textAlign:"left",height:"auto",padding:"10px 16px",fontSize:"14px"},children:ge.text},H))})}]})})]})}):s.jsxs(s.Fragment,{children:[e.map(ge=>s.jsx(jS,{message:ge,onRating:cn,onTopicClick:ii},ge.id)),n&&s.jsx("div",{className:"reference-page__message reference-page__message--assistant",children:s.jsxs("div",{className:"reference-page__message-content",children:[s.jsx(nm,{icon:s.jsx(Cf,{}),style:{backgroundColor:"#52c41a",marginRight:12}}),s.jsx(es,{size:"small"}),s.jsx(Gt,{type:"secondary",style:{marginLeft:12},children:"Ищу информацию в базе знаний..."})]})}),s.jsx("div",{ref:Lt})]}),s.jsx("div",{className:"reference-page__input-container",children:s.jsxs("div",{className:"reference-page__input-wrapper",children:[s.jsxs("div",{style:{position:"relative",width:"100%"},children:[s.jsx(W$,{ref:Bt,value:r,onChange:ge=>a(ge.target.value),onKeyPress:nr,placeholder:e.length===0?"Задайте вопрос о залогах, ипотеке, оценке...":"Задайте уточняющий вопрос...",autoSize:{minRows:3,maxRows:6},disabled:n||c,className:"reference-page__main-input",style:{fontSize:"16px",padding:"16px 50px 16px 16px",borderRadius:"12px",border:"2px solid #d9d9d9",transition:"all 0.3s"},onFocus:ge=>{ge.target.style.borderColor="#1890ff",ge.target.style.boxShadow="0 0 0 2px rgba(24, 144, 255, 0.2)"},onBlur:ge=>{ge.target.style.borderColor="#d9d9d9",ge.target.style.boxShadow="none"}}),s.jsx(Js,{accept:".pdf,.docx,.xlsx,.xls,.jpg,.jpeg,.png,.gif,.bmp,.webp",beforeUpload:Lr,showUploadList:!1,disabled:o,children:s.jsx(Be,{type:"text",icon:s.jsx(nO,{}),loading:o,disabled:o,style:{position:"absolute",right:"8px",top:"8px",zIndex:1,color:"#8c8c8c",fontSize:"18px",width:"32px",height:"32px",padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"Приложить документ или изображение"})})]}),s.jsx(Be,{type:"primary",icon:s.jsx(_b,{}),onClick:Or,loading:n,disabled:!r.trim()||c,size:"large",className:"reference-page__send-button",style:{height:"auto",padding:"12px 24px",fontSize:"16px",marginTop:"12px",borderRadius:"8px"},children:"Отправить вопрос"})]})})]})})})]}),s.jsx(cr,{title:s.jsxs(Te,{children:[s.jsx(Kc,{}),s.jsx("span",{children:"Настройки"})]}),open:R,onCancel:()=>L(!1),footer:null,width:600,style:{top:20},children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"large",children:[s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Поиск по темам"}),s.jsx(Re,{placeholder:"Поиск...",prefix:s.jsx(Pa,{}),value:v,onChange:ge=>E(ge.target.value),style:{marginTop:8},allowClear:!0})]}),s.jsx(jt,{style:{margin:"8px 0"}}),s.jsxs("div",{children:[s.jsxs(Te,{style:{marginBottom:8},children:[s.jsx(Gt,{strong:!0,children:"Категории"}),x&&s.jsx(Be,{type:"link",size:"small",onClick:()=>xa(null),children:"Сбросить"})]}),s.jsx(Qt,{size:"small",dataSource:g,style:{maxHeight:400,overflow:"auto"},renderItem:ge=>s.jsx(Qt.Item,{style:{cursor:"pointer",backgroundColor:x===ge.id?"#e6f7ff":"transparent",borderRadius:4,padding:"8px 12px"},onClick:()=>xa(ge.id),children:s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between"},children:[s.jsxs(Te,{children:[s.jsx(lo,{}),s.jsx(Gt,{children:ge.name})]}),s.jsx(Bf,{count:ge.topics.length,showZero:!0,style:{backgroundColor:"#52c41a"}})]})})})]}),k.length>0&&!x&&s.jsxs(s.Fragment,{children:[s.jsx(jt,{style:{margin:"8px 0"}}),s.jsxs("div",{children:[s.jsxs(Gt,{strong:!0,children:["Результаты поиска (",k.length,")"]}),s.jsx(Qt,{size:"small",dataSource:k.slice(0,10),style:{marginTop:8,maxHeight:300,overflow:"auto"},renderItem:ge=>s.jsx(Qt.Item,{style:{cursor:"pointer",padding:"8px 12px",borderRadius:4},onClick:()=>{ii(ge),L(!1)},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="transparent"},children:s.jsx(Gt,{ellipsis:!0,style:{fontSize:12},children:ge.title})})})]})]}),s.jsx(jt,{style:{margin:"8px 0"}}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,style:{display:"block",marginBottom:8},children:"Управление базой знаний"}),s.jsx(Be,{icon:s.jsx(Zl,{}),onClick:Er,loading:o,title:"Переиндексировать все документы из папки VND",block:!0,style:{marginTop:8},children:"Обновить базу знаний"}),s.jsx(Gt,{type:"secondary",style:{fontSize:12,display:"block",marginTop:8},children:"Переиндексирует все документы из папки VND и обновит базу знаний"})]})]})}),s.jsx(B2,{title:"Эквалайзер скилов и навыков Помощника ИИ",placement:"right",width:600,open:we,onClose:()=>se(!1),children:s.jsxs(Te,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(Xp,{level:4,children:"Режим оценки"}),s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Доходный подход"}),s.jsx(bn,{value:He.incomeApproach,onChange:ge=>Ee(H=>({...H,incomeApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),s.jsxs(Te,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Дисконтирование денежных потоков (DCF)"}),s.jsx(bn,{value:He.incomeMethods.dcf,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,dcf:ge}})),min:0,max:100,style:{marginTop:4}})]}),s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Прямая капитализация"}),s.jsx(bn,{value:He.incomeMethods.directCapitalization,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,directCapitalization:ge}})),min:0,max:100,style:{marginTop:4}})]}),s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Множитель валового дохода"}),s.jsx(bn,{value:He.incomeMethods.grossRentMultiplier,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,grossRentMultiplier:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Сравнительный подход"}),s.jsx(bn,{value:He.comparativeApproach,onChange:ge=>Ee(H=>({...H,comparativeApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),s.jsxs(Te,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Сравнение продаж"}),s.jsx(bn,{value:He.comparativeMethods.salesComparison,onChange:ge=>Ee(H=>({...H,comparativeMethods:{...H.comparativeMethods,salesComparison:ge}})),min:0,max:100,style:{marginTop:4}})]}),s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Извлечение из рынка"}),s.jsx(bn,{value:He.comparativeMethods.marketExtraction,onChange:ge=>Ee(H=>({...H,comparativeMethods:{...H.comparativeMethods,marketExtraction:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Затратный подход"}),s.jsx(bn,{value:He.costApproach,onChange:ge=>Ee(H=>({...H,costApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),s.jsxs(Te,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Стоимость замещения"}),s.jsx(bn,{value:He.costMethods.replacementCost,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,replacementCost:ge}})),min:0,max:100,style:{marginTop:4}})]}),s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Стоимость воспроизводства"}),s.jsx(bn,{value:He.costMethods.reproductionCost,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,reproductionCost:ge}})),min:0,max:100,style:{marginTop:4}})]}),s.jsxs("div",{children:[s.jsx(Gt,{type:"secondary",style:{fontSize:12},children:"Износ"}),s.jsx(bn,{value:He.costMethods.depreciation,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,depreciation:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]})]})]}),s.jsx(jt,{}),s.jsxs("div",{children:[s.jsx(Xp,{level:4,children:"Режим экспертизы"}),s.jsx(Gt,{type:"secondary",children:"В этом режиме ответы формируются профессиональным AI помощником (DeepSeek) на основе базы знаний и настроек эквалайзера скилов и навыков."}),s.jsxs(Te,{direction:"vertical",size:"middle",style:{width:"100%"},children:[s.jsxs("div",{children:[s.jsxs(Te,{children:[s.jsx(Gt,{strong:!0,children:"Использовать AI DeepSeek для ответов"}),s.jsx(ms,{checked:pe.useDeepSeek!==!1,onChange:ge=>ce(H=>({...H,useDeepSeek:ge}))})]}),s.jsx(Gt,{type:"secondary",style:{display:"block",marginTop:4},children:"При включении этого параметра ИИ будет отвечать как профессионал в области оценки и рисков залогового имущества Банка, опираясь на базу знаний и настройки эквалайзера."})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Уровни экспертизы"}),s.jsx(bn,{value:pe.expertiseLevel,onChange:ge=>ce(H=>({...H,expertiseLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Уровни анализа"}),s.jsx(bn,{value:pe.analysisLevel,onChange:ge=>ce(H=>({...H,analysisLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Краткость ответов"}),s.jsx(bn,{value:pe.responseBrevity,onChange:ge=>ce(H=>({...H,responseBrevity:ge})),min:0,max:100,marks:{0:"Подробно",50:"50%",100:"Кратко"}})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Анализ рисков"}),s.jsx(bn,{value:pe.riskAnalysis,onChange:ge=>ce(H=>({...H,riskAnalysis:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Комментарии"}),s.jsx(bn,{value:pe.comments,onChange:ge=>ce(H=>({...H,comments:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),s.jsxs("div",{children:[s.jsx(Gt,{strong:!0,children:"Детализация"}),s.jsx(bn,{value:pe.detailLevel,onChange:ge=>ce(H=>({...H,detailLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]})]})]})]})})]})]})},Gd=[{key:"ANALYSIS",title:"ANALYSIS",description:"Анализ возможности внесудебной реализации; проверка оценки и рисков.",checklist:["Получить последнюю оценку (рыночная и залоговая)","Проверить ограничения/обременения","Оценить срок и ликвидность"]},{key:"PREPARATION",title:"PREPARATION",description:"Подготовка пакета документов: уведомления, претензии, соглашения.",checklist:["Сформировать уведомление о реализации","Подготовить претензионное письмо"]},{key:"NEGOTIATION",title:"NEGOTIATION",description:"Переговоры с должником/залогодателем: скидка, рассрочка, отступное.",checklist:["Зафиксировать предложения сторон","Подготовить протокол переговоров"]},{key:"APPROVAL",title:"APPROVAL",description:"Внутреннее согласование условий сделки, задачи на согласование.",checklist:["Создать задачи на согласование","Получить визы руководства/юр. блока"]},{key:"AGREEMENT",title:"AGREEMENT",description:"Оформление договора купли-продажи/отступного.",checklist:["Сформировать проект договора","Сохранить договор в залоговом досье"]},{key:"SALE",title:"SALE",description:"Фактическая реализация, ввод покупателя, суммы, даты.",checklist:["Зафиксировать сумму и дату расчётов","Загрузить подтверждающие документы"]},{key:"COMPLETED",title:"COMPLETED",description:"Завершение, снятие обременения, расчёты.",checklist:["Создать задачу на снятие обременения","Обновить статус и закрыть кейс"]},{key:"CANCELLED",title:"CANCELLED",description:"Отмена/возврат в реестр на другие процедуры.",checklist:["Зафиксировать причину отмены","Сообщить заинтересованным сторонам"]}],Z$=()=>{const e=Vi(B=>B.workflow.cases),[t,r]=M.useState([]),[a,n]=M.useState(!1);M.useEffect(()=>{(async()=>{n(!0);try{const b=await kt.getTasks();r(b.filter(O=>O.category==="workflow"))}catch(b){console.warn("Не удалось загрузить задачи для KPI workflow:",b)}finally{n(!1)}})()},[]);const i=M.useMemo(()=>{const B={};return e.forEach(b=>{B[b.stage]=(B[b.stage]||0)+1}),B},[e]),o=e.length||1,l=M.useMemo(()=>{const B={},b=Date.now();return e.forEach(O=>{if(!Array.isArray(O.history)||O.history.length===0)return;const _=O.history.find(R=>R.stage===O.stage);if(!_)return;const U=new Date(_.createdAt).getTime(),I=Math.max(0,(b-U)/(1e3*3600*24));B[O.stage]||(B[O.stage]={totalDays:0,count:0}),B[O.stage].totalDays+=I,B[O.stage].count+=1}),Object.entries(B).map(([O,{totalDays:_,count:U}])=>({stage:O,avgDays:U>0?Math.round(_/U):0}))},[e]),c=M.useMemo(()=>e.filter(B=>B.stage!=="COMPLETED"&&B.stage!=="CANCELLED").slice(0,5).map(B=>({title:B.objectName,stage:B.stage,deadline:B.deadline,manager:B.manager||"Не назначен"})),[e]),A=M.useMemo(()=>{if(e.length===0)return 0;const B=Date.now(),b=e.reduce((O,_)=>{const U=new Date(_.createdAt).getTime();return O+Math.max(0,B-U)/(1e3*3600*24)},0);return Math.round(b/e.length)},[e]),d=e.filter(B=>B.stage==="COMPLETED"),f=d.reduce((B,b)=>B+(b.appraisedValue||0)*.8,0),p=e.reduce((B,b)=>B+(b.appraisedValue||0),0),u=e.reduce((B,b)=>B+(b.debtAmount||0),0),g=e.filter(B=>B.stage!=="COMPLETED"&&B.stage!=="CANCELLED").reduce((B,b)=>B+(b.debtAmount||0),0),h=p>0?Math.round(f/p*100):0,x=e.length>0?Math.round(d.length/e.length*100):0,y=Date.now(),v=t.filter(B=>B.status!=="completed"&&new Date(B.dueDate).getTime()<y),E=M.useMemo(()=>{const B={};return t.forEach(b=>{var U;const O=(U=b.type)==null?void 0:U.split("workflow-"),_=O&&O[1]?O[1].toUpperCase():"OTHER";B[_]=(B[_]||0)+1}),B},[t]),k=t.filter(B=>B.status!=="completed").sort((B,b)=>new Date(B.dueDate).getTime()-new Date(b.dueDate).getTime()).slice(0,5),{Text:S}=ht;return s.jsxs("div",{style:{padding:12},children:[s.jsxs(dt,{gutter:[12,12],children:[s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsx(Ue,{title:"Средний срок реализации",children:s.jsx(pt,{value:A,suffix:"дней"})})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsx(Ue,{title:"Активных кейсов",children:s.jsx(pt,{value:e.length})})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsx(Ue,{title:"Завершено / конверсия",children:s.jsx(pt,{value:`${i.COMPLETED||0} (${x}%)`})})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsx(Ue,{title:"Возвращено средств (оценка)",children:s.jsx(pt,{value:f,suffix:"₽",precision:0})})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsx(Ue,{title:"Эффективность по оценке",children:s.jsx(pt,{value:h,suffix:"%"})})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsxs(Ue,{title:"Задачи workflow",children:[s.jsx(pt,{value:t.length,suffix:a?" (загрузка)":""}),s.jsx("div",{style:{marginTop:8},children:s.jsxs(S,{type:v.length>0?"danger":"secondary",children:["Просрочено: ",v.length]})})]})}),s.jsx(be,{xs:24,sm:12,md:8,lg:6,xl:6,children:s.jsxs(Ue,{title:"Долг по кейсам",children:[s.jsx(pt,{value:g,suffix:"₽ (актив)",precision:0}),s.jsx("div",{style:{marginTop:4},children:s.jsxs(S,{type:"secondary",children:["Всего: ",u.toLocaleString("ru-RU")," ₽"]})})]})})]}),s.jsxs(dt,{gutter:[12,12],style:{marginTop:12},children:[s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:"Воронка этапов",bodyStyle:{padding:12},children:s.jsx(Qt,{size:"small",dataSource:Gd,renderItem:B=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{title:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx(Kr,{title:B.description,placement:"right",children:s.jsx("span",{style:{cursor:"help"},children:B.title})}),(()=>{const b=i[B.key]||0,O=e.length>0?Math.round(b/o*100):0;return s.jsxs(Te,{size:4,children:[s.jsx(Ze,{color:"blue",children:`${O}%`}),s.jsx(Ze,{children:b})]})})()]}),description:null})})})})}),s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:"Средний срок в текущем этапе",bodyStyle:{padding:12},children:s.jsx(Qt,{size:"small",dataSource:l,locale:{emptyText:"Нет кейсов"},renderItem:B=>s.jsx(Qt.Item,{children:s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between"},children:[s.jsx(S,{children:B.stage}),s.jsxs(Ze,{color:B.avgDays>14?"red":"blue",children:["~",B.avgDays," дн."]})]})})})})}),s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:"Ближайшие дедлайны",bodyStyle:{padding:12},children:s.jsx(Qt,{size:"small",dataSource:c,renderItem:B=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:B.title,description:`Этап: ${B.stage}. Менеджер: ${B.manager}`}),s.jsx("div",{children:B.deadline?new Date(B.deadline).toLocaleDateString():"—"})]})})})}),s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:"Задачи (workflow) — ближайшие",bodyStyle:{padding:12},children:s.jsx(Qt,{size:"small",dataSource:k,locale:{emptyText:a?"Загрузка...":"Нет задач"},renderItem:B=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:B.title,description:s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(S,{type:"secondary",children:B.description}),s.jsxs(S,{type:"secondary",children:["До: ",new Date(B.dueDate).toLocaleDateString()," · Статус: ",B.status]})]})}),s.jsx(Ze,{children:B.type})]})})})}),s.jsx(be,{xs:24,lg:12,children:s.jsx(Ue,{title:"Задачи по этапам (workflow)",bodyStyle:{padding:12},children:s.jsx(Qt,{size:"small",dataSource:Object.entries(E),renderItem:([B,b])=>s.jsx(Qt.Item,{children:s.jsxs(Te,{style:{width:"100%",justifyContent:"space-between"},children:[s.jsx(S,{children:B}),s.jsx(Ze,{color:B==="COMPLETED"?"green":"blue",children:b})]})})})})})]})]})},{Text:Qu}=ht,eY=()=>{const e=nl(),t=Vi(c=>c.workflow.cases),[r,a]=M.useState(null),n=M.useMemo(()=>{const c={ANALYSIS:[],PREPARATION:[],NEGOTIATION:[],APPROVAL:[],AGREEMENT:[],SALE:[],COMPLETED:[],CANCELLED:[]};return t.forEach(A=>c[A.stage].push(A)),c},[t]),i=c=>({items:Gd.map(A=>({key:A.key,label:A.title,onClick:()=>e(ex({id:c,stage:A.key}))}))}),o=(c,A)=>{e(ex({id:A,stage:c}))},l=c=>r===c?{border:"1px dashed #1890ff",background:"#f0f7ff"}:{border:"1px solid #f0f0f0"};return s.jsxs("div",{style:{padding:16},children:[s.jsx(Qu,{type:"secondary",style:{fontSize:12},children:"Перетащи карточку в нужный этап или выбери этап через «Перевести»"}),s.jsx("div",{style:{height:8}}),s.jsx(dt,{gutter:[12,12],wrap:!0,children:Gd.map(c=>s.jsx(be,{xs:24,sm:12,md:8,lg:6,children:s.jsx(Ue,{title:s.jsxs(Te,{direction:"vertical",size:0,children:[s.jsx(Qu,{strong:!0,children:c.title}),s.jsx(Qu,{type:"secondary",style:{fontSize:12},children:c.description})]}),size:"small",bodyStyle:{padding:8},style:l(c.key),onDragOver:A=>{A.preventDefault(),a(c.key)},onDragLeave:()=>a(null),onDrop:A=>{A.preventDefault();const d=A.dataTransfer.getData("text/plain");d&&o(c.key,d),a(null)},children:s.jsxs(Te,{direction:"vertical",style:{width:"100%"},size:"small",children:[n[c.key].length===0&&s.jsx(Qu,{type:"secondary",style:{fontSize:12},children:"Нет объектов на этом этапе"}),n[c.key].map(A=>{var d,f;return s.jsxs(Ue,{size:"small",style:{borderColor:"#f0f0f0"},title:A.objectName,extra:s.jsx(Ze,{color:"blue",children:A.assetType}),draggable:!0,onDragStart:p=>{p.dataTransfer.setData("text/plain",A.id),a(c.key)},onDragEnd:()=>a(null),children:[s.jsxs("div",{style:{fontSize:12,marginBottom:8},children:["Долг: ",((d=A.debtAmount)==null?void 0:d.toLocaleString("ru-RU"))||"—"," ₽ ",s.jsx("br",{}),"Оценка: ",((f=A.appraisedValue)==null?void 0:f.toLocaleString("ru-RU"))||"—"," ₽"]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[s.jsxs("div",{children:[s.jsx(Qu,{type:"secondary",style:{fontSize:12},children:"Менеджер:"})," ",A.manager||"Не назначен"]}),s.jsx(yb,{menu:i(A.id),trigger:["click"],children:s.jsx(Be,{size:"small",children:"Перевести"})})]})]},A.id)})]})})},c.key))})]})},tY=()=>s.jsx(ri,{defaultActiveKey:"pipeline",items:[{key:"dashboard",label:"Dashboard",children:s.jsx(Z$,{})},{key:"pipeline",label:"Pipeline",children:s.jsx(eY,{})}]}),rY=(e,t,r,a)=>{var o;const n={workflow:{...t,createdAtFormatted:new Date(t.createdAt).toLocaleDateString("ru-RU"),deadlineFormatted:t.deadline?new Date(t.deadline).toLocaleDateString("ru-RU"):"",salePrice:(a==null?void 0:a.salePrice)??t.salePrice,conditions:(a==null?void 0:a.conditions)??t.notes},object:r?{name:r.name,number:r.number,address:((o=r.address)==null?void 0:o.fullAddress)||""}:void 0,today:new Date().toLocaleDateString("ru-RU"),custom:{}},i=(l,c)=>{const A=c.trim().split(".");let d=n;for(const f of A)if(d&&typeof d=="object"&&f in d)d=d[f];else return"";return d==null?"":typeof d=="number"?d.toLocaleString("ru-RU"):String(d)};return e.content.replace(/{{\s*([^}]+)\s*}}/g,i)},{Title:aY,Paragraph:K1,Text:Ks}=ht,nY=()=>{var b,O;const{id:e}=ub(),t=nl(),{cases:r,segments:a,templates:n}=Vi(_=>_.workflow),i=M.useMemo(()=>r.find(_=>_.id===e),[r,e]),[o,l]=M.useState([]),[c,A]=M.useState(!1),[d]=re.useForm(),[f,p]=M.useState(),[u,g]=M.useState(!1),h=async()=>{A(!0);try{const _=await kt.getTasks();l(i?_.filter(U=>U.workflowCaseId===i.id):[])}catch(_){console.warn("Не удалось загрузить задачи workflow:",_)}finally{A(!1)}};if(M.useEffect(()=>{h()},[i==null?void 0:i.id]),!i)return s.jsx(Nr,{type:"warning",message:"Кейс не найден"});const x=Gd.find(_=>_.key===i.stage),y=Gd.map(_=>_.key),v=y.indexOf(i.stage),E=v>0?y[v-1]:null,k=v>=0&&v<y.length-1?y[v+1]:null,S=async({stage:_,title:U,description:I,priority:R="medium",dueInDays:L=3})=>{const N=new Date,P={id:`task-wf-${i.id}-${_}-${N.getTime()}`,region:i.assetType||"—",type:`workflow-${_.toLowerCase()}`,title:U,description:I,priority:R,dueDate:new Date(N.getTime()+L*24*3600*1e3).toISOString(),status:"new",businessUser:"workflow",businessUserName:"Workflow",assignedTo:[],currentAssignee:null,currentAssigneeName:null,employeeId:void 0,documents:[],comments:[],createdAt:N.toISOString(),updatedAt:N.toISOString(),history:[{date:N.toISOString(),user:"Workflow",userRole:"system",action:`Создано при переходе в этап ${_}`,status:"new"}],category:"workflow",workflowCaseId:i.id};await kt.saveTask(P)},B=async(_,U)=>{t(ex({id:i.id,stage:_,comment:U,user:"Система"}));try{_==="PREPARATION"&&await S({stage:_,title:`Подготовить пакет документов по ${i.objectName}`,description:`Workflow кейс ${i.id} на этапе PREPARATION. Собрать уведомления/претензии.`,priority:"high",dueInDays:2}),_==="NEGOTIATION"&&await S({stage:_,title:`Переговоры с должником/залогодателем по ${i.objectName}`,description:`Workflow кейс ${i.id} на этапе NEGOTIATION. Зафиксировать предложения, скидку/рассрочку.`,priority:"high",dueInDays:3}),_==="APPROVAL"&&await S({stage:_,title:`Согласование условий сделки по ${i.objectName}`,description:`Workflow кейс ${i.id} на этапе APPROVAL. Визы руководства/юрблока.`,priority:"high",dueInDays:3}),_==="AGREEMENT"&&await S({stage:_,title:`Договор/отступное по ${i.objectName}`,description:`Workflow кейс ${i.id} на этапе AGREEMENT. Подготовить/подписать договор.`,priority:"high",dueInDays:5}),_==="SALE"&&await S({stage:_,title:`Фиксация сделки и расчётов по ${i.objectName}`,description:`Workflow кейс ${i.id} на этапе SALE. Ввести покупателя, сумму, дату.`,priority:"medium",dueInDays:5}),_==="COMPLETED"&&await S({stage:_,title:`Снятие обременения / закрытие кейса ${i.objectName}`,description:`Workflow кейс ${i.id} завершён. Создать задачу на снятие обременения, обновить досье.`,priority:"high",dueInDays:5}),await h(),Ne.success(`Этап изменён на ${_}. Задачи созданы (если требуются).`)}catch(I){console.warn("Не удалось создать задачи для workflow:",I),Ne.warning(`Этап изменён на ${_}, но часть задач не создалась`)}["PREPARATION","NEGOTIATION","APPROVAL","AGREEMENT","SALE","COMPLETED"].includes(_)||Ne.success(`Этап изменён на ${_}`)};return s.jsxs("div",{style:{padding:16},children:[s.jsxs(aY,{level:3,style:{marginBottom:12},children:[i.objectName," ",s.jsx(Ze,{color:i.stage==="COMPLETED"?"green":"blue",children:i.stage})]}),s.jsxs(Te,{style:{marginBottom:12},wrap:!0,children:[E&&s.jsxs(Be,{onClick:()=>B(E,"Возврат на предыдущий этап из карточки"),children:["← ",E]}),k&&s.jsxs(Be,{type:"primary",onClick:()=>B(k,"Перевод на следующий этап"),children:[k," →"]}),s.jsx(Be,{onClick:()=>B(i.stage,"Зафиксировано без изменений"),children:"Обновить историю"})]}),s.jsxs(dt,{gutter:[16,16],children:[s.jsxs(be,{xs:24,md:14,children:[s.jsxs(Ue,{title:"Основная информация",children:[s.jsxs(ye,{column:1,size:"small",bordered:!0,children:[s.jsx(ye.Item,{label:"Объект",children:i.objectName}),s.jsx(ye.Item,{label:"Тип",children:i.assetType}),s.jsxs(ye.Item,{label:"Долг",children:[((b=i.debtAmount)==null?void 0:b.toLocaleString("ru-RU"))||"—"," ₽"]}),s.jsxs(ye.Item,{label:"Оценка",children:[((O=i.appraisedValue)==null?void 0:O.toLocaleString("ru-RU"))||"—"," ₽"]}),s.jsx(ye.Item,{label:"Сегмент должника",children:s.jsx(Ve,{size:"small",style:{minWidth:220},placeholder:"Выберите сегмент",value:i.segmentId,onChange:_=>t(aI({id:i.id,segmentId:_})),allowClear:!0,options:a.map(_=>({value:_.id,label:_.name}))})}),s.jsx(ye.Item,{label:"Менеджер",children:i.manager||"Не назначен"}),s.jsx(ye.Item,{label:"Дедлайн",children:i.deadline?new Date(i.deadline).toLocaleDateString():"—"})]}),i.notes&&s.jsxs(K1,{style:{marginTop:12},children:[s.jsx(Ks,{strong:!0,children:"Заметки: "}),i.notes]})]}),s.jsxs(Ue,{title:"Документы workflow",style:{marginTop:16},children:[s.jsxs(Te,{style:{marginBottom:8},wrap:!0,children:[s.jsx(Ve,{placeholder:"Выберите шаблон для генерации",style:{minWidth:260},value:f,onChange:_=>p(_),options:n.map(_=>({value:_.id,label:_.name}))}),s.jsx(Be,{type:"primary",disabled:!f,loading:u,onClick:async()=>{if(!f)return;const _=n.find(U=>U.id===f);if(_)try{g(!0);const U=await kt.getExtendedCardById(i.objectId),I=rY(_,i,U||null,{}),L=`data:text/plain;charset=utf-8,${encodeURIComponent(I)}`,N=`${_.name} от ${new Date().toLocaleDateString("ru-RU").replace(/\./g,"-")}`,P={id:`doc-${Date.now()}`,name:N,type:_.type,url:L,createdAt:new Date().toISOString()},Q=[...i.documents,P];if(t(Pv({id:i.id,documents:Q})),U){const Y=Array.isArray(U.documents)?U.documents:[],ee={...U,documents:[...Y,{id:P.id,name:P.name,type:P.type,size:I.length,mimeType:"text/plain",uploadDate:new Date,description:`Сгенерировано в Workflow по шаблону "${_.name}"`,fileData:I}]};await kt.saveExtendedCard(ee)}Ne.success(`Документ по шаблону "${_.name}" сгенерирован`)}catch(U){console.error("Ошибка генерации документа workflow:",U),Ne.error("Не удалось сгенерировать документ по шаблону")}finally{g(!1)}},children:"Сгенерировать документ"})]}),i.documents.length===0?s.jsx(Ks,{type:"secondary",children:"Документы ещё не добавлены"}):i.documents.map(_=>s.jsxs(K1,{style:{marginBottom:8},children:[s.jsx(CT,{to:_.url||"#",target:"_blank",children:_.name})," ",s.jsx(Ze,{children:_.type})]},_.id)),s.jsx(jt,{}),s.jsxs(re,{form:d,layout:"vertical",onFinish:async _=>{const U={id:`doc-${Date.now()}`,name:_.name,type:_.type,url:_.url||void 0,createdAt:new Date().toISOString()};t(Pv({id:i.id,documents:[...i.documents,U]})),d.resetFields(),Ne.success("Документ добавлен в кейс");try{const I=await kt.getExtendedCardById(i.objectId);if(I){const R=Array.isArray(I.documents)?I.documents:[],L={...I,documents:[...R,{id:U.id,name:U.name,type:U.type,size:0,mimeType:"text/uri-list",uploadDate:new Date,description:"Добавлено из workflow",fileData:U.url}]};await kt.saveExtendedCard(L)}}catch(I){console.warn("Не удалось сохранить документ в залоговом досье:",I)}},children:[s.jsxs(dt,{gutter:8,children:[s.jsx(be,{span:8,children:s.jsx(re.Item,{name:"name",label:"Название",rules:[{required:!0}],children:s.jsx(Re,{placeholder:"Напр. Уведомление"})})}),s.jsx(be,{span:6,children:s.jsx(re.Item,{name:"type",label:"Тип",initialValue:"workflow-doc",children:s.jsx(Ve,{options:[{value:"workflow-doc",label:"Workflow"},{value:"notification",label:"Уведомление"},{value:"agreement",label:"Соглашение"},{value:"sale-contract",label:"ДКП"},{value:"other",label:"Другое"}]})})}),s.jsx(be,{span:10,children:s.jsx(re.Item,{name:"url",label:"Ссылка (опционально)",children:s.jsx(Re,{placeholder:"https://..."})})})]}),s.jsx(Be,{type:"primary",htmlType:"submit",children:"Добавить документ"})]})]})]}),s.jsxs(be,{xs:24,md:10,children:[s.jsxs(Ue,{title:"Этап и чеклист",style:{marginBottom:16},children:[s.jsxs(K1,{children:[s.jsx(Ks,{strong:!0,children:x==null?void 0:x.title}),s.jsx("br",{}),s.jsx(Ks,{type:"secondary",children:x==null?void 0:x.description})]}),s.jsx(jt,{style:{margin:"8px 0"}}),s.jsx("ul",{style:{paddingLeft:18,marginBottom:0},children:x==null?void 0:x.checklist.map(_=>s.jsx("li",{children:s.jsx(Ks,{children:_})},_))})]}),s.jsx(Ue,{title:"История этапов",children:s.jsx(Y1,{items:i.history.map(_=>({color:_.stage==="COMPLETED"?"green":"blue",children:s.jsxs("div",{children:[s.jsx(Ks,{strong:!0,children:_.stage})," — ",new Date(_.createdAt).toLocaleString(),_.comment&&s.jsx("div",{children:s.jsx(Ks,{type:"secondary",children:_.comment})}),s.jsx("div",{children:s.jsxs(Ks,{type:"secondary",children:["Исполнитель: ",_.user]})})]})}))})}),s.jsx(Ue,{title:"Связанные задачи (workflow)",style:{marginTop:16},children:c?s.jsx(Ks,{type:"secondary",children:"Загрузка задач..."}):o.length===0?s.jsx(Ks,{type:"secondary",children:"Задач ещё нет"}):s.jsx("ul",{style:{paddingLeft:18,marginBottom:0},children:o.map(_=>s.jsxs("li",{children:[s.jsx(Ks,{strong:!0,children:_.title})," — ",s.jsx(Ks,{type:"secondary",children:_.status}),s.jsx("br",{}),s.jsxs(Ks,{type:"secondary",children:["До: ",new Date(_.dueDate).toLocaleDateString()," · ",_.description]})]},_.id))})})]})]})]})},{Title:sY,Paragraph:H1,Text:G1}=ht,iY=()=>{const{templates:e,segments:t,steps:r,scripts:a,restructuringRules:n}=Vi(h=>h.workflow),i=nl(),[o,l]=M.useState(null),[c,A]=M.useState(!1),[d]=re.useForm(),f=h=>{const x=e.find(y=>y.id===h);x&&(d.setFieldsValue(x),l(h))},p=()=>{d.validateFields().then(h=>{const x={...h,id:o,updatedAt:new Date().toISOString()};i(rI(x)),l(null),Ne.success("Шаблон обновлён")}).catch(()=>{})},u=()=>{d.resetFields(),A(!0)},g=()=>{d.validateFields().then(h=>{const x=new Date().toISOString(),y={...h,id:`tpl-${Date.now()}`,updatedAt:x};i(tI(y)),A(!1),Ne.success("Шаблон создан")}).catch(()=>{})};return s.jsxs("div",{style:{padding:16},children:[s.jsx(sY,{level:3,style:{marginBottom:12},children:"Настройки Workflow"}),s.jsx(Ue,{title:"Этапы и чеклисты",style:{marginBottom:16},children:s.jsx(Qt,{dataSource:Gd,renderItem:h=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{title:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{children:h.title}),s.jsx(Ze,{children:h.key})]}),description:s.jsxs("div",{children:[s.jsx(H1,{style:{marginBottom:4},children:h.description}),s.jsx("ul",{style:{paddingLeft:18,margin:0},children:h.checklist.map(x=>s.jsx("li",{children:s.jsx(G1,{children:x})},x))})]})})})})}),s.jsx(Ue,{title:"Шаблоны документов workflow",extra:s.jsx(Be,{type:"primary",onClick:u,children:"Добавить шаблон"}),children:s.jsx(Qt,{dataSource:e,renderItem:h=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{children:h.name}),s.jsx(Ze,{children:h.type})]}),description:s.jsxs("div",{children:[s.jsx(H1,{style:{marginBottom:4},children:h.description||"Описание не задано"}),s.jsxs(G1,{type:"secondary",children:["Обновлён: ",new Date(h.updatedAt).toLocaleDateString()]})]})}),s.jsx(Te,{children:s.jsx(Be,{size:"small",onClick:()=>f(h.id),children:"Редактировать"})})]})})}),s.jsx(Ue,{title:"Сегментация должников",style:{marginTop:16},children:s.jsx(Qt,{dataSource:t,renderItem:h=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{title:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{children:h.name}),s.jsx(Ze,{children:h.debtorTypes.join(", ")})]}),description:s.jsxs("div",{children:[s.jsx(H1,{style:{marginBottom:4},children:h.description}),s.jsx(G1,{type:"secondary",children:h.strategySummary})]})})})})}),s.jsx(Ue,{title:"Лестница взыскания",style:{marginTop:16},children:s.jsx(Qt,{dataSource:r,renderItem:h=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:`${h.name} (дни ${h.dayFrom}–${h.dayTo})`,description:h.description}),s.jsx(Ze,{children:h.channel})]})})}),s.jsx(Ue,{title:"Скрипты и шаблоны коммуникации",style:{marginTop:16},children:s.jsx(Qt,{dataSource:a,renderItem:h=>s.jsx(Qt.Item,{children:s.jsx(Qt.Item.Meta,{title:h.name,description:h.summary})})})}),s.jsx(Ue,{title:"Правила реструктуризации",style:{marginTop:16},children:s.jsx(Qt,{dataSource:n,renderItem:h=>s.jsxs(Qt.Item,{children:[s.jsx(Qt.Item.Meta,{title:h.name,description:h.description}),h.managerLimitPercent&&s.jsxs(Ze,{color:"purple",children:["Лимит менеджера: ",h.managerLimitPercent,"%"]})]})})}),s.jsx(cr,{title:"Редактирование шаблона",open:!!o,onOk:p,onCancel:()=>l(null),okText:"Сохранить",cancelText:"Отмена",children:s.jsxs(re,{form:d,layout:"vertical",children:[s.jsx(re.Item,{name:"name",label:"Название",rules:[{required:!0}],children:s.jsx(Re,{})}),s.jsx(re.Item,{name:"type",label:"Тип",rules:[{required:!0}],children:s.jsx(Ve,{options:[{value:"notification",label:"Уведомление"},{value:"claim",label:"Претензия"},{value:"agreement",label:"Соглашение"},{value:"sale-contract",label:"ДКП"},{value:"other",label:"Другое"}]})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(Re.TextArea,{rows:3})}),s.jsx(re.Item,{name:"content",label:"Текст шаблона (поддерживаются плейсхолдеры {{object.*}}, {{workflow.*}}, {{today}})",rules:[{required:!0,message:"Введите текст шаблона"}],children:s.jsx(Re.TextArea,{rows:8})})]})}),s.jsx(cr,{title:"Новый шаблон",open:c,onOk:g,onCancel:()=>A(!1),okText:"Создать",cancelText:"Отмена",children:s.jsxs(re,{form:d,layout:"vertical",children:[s.jsx(re.Item,{name:"name",label:"Название",rules:[{required:!0}],children:s.jsx(Re,{})}),s.jsx(re.Item,{name:"type",label:"Тип",rules:[{required:!0}],children:s.jsx(Ve,{options:[{value:"notification",label:"Уведомление"},{value:"claim",label:"Претензия"},{value:"agreement",label:"Соглашение"},{value:"sale-contract",label:"ДКП"},{value:"other",label:"Другое"}]})}),s.jsx(re.Item,{name:"description",label:"Описание",children:s.jsx(Re.TextArea,{rows:3})}),s.jsx(re.Item,{name:"content",label:"Текст шаблона (поддерживаются плейсхолдеры {{object.*}}, {{workflow.*}}, {{today}})",rules:[{required:!0,message:"Введите текст шаблона"}],children:s.jsx(Re.TextArea,{rows:8})})]})})]})},oY=()=>{const[e,t]=M.useState(new Set),[r,a]=M.useState({x:0,y:0}),[n,i]=M.useState(0),o=M.useRef(null),l=M.useRef(null),c=M.useCallback(p=>{requestAnimationFrame(()=>{a({x:p.clientX,y:p.clientY})})},[]),A=M.useCallback(()=>{requestAnimationFrame(()=>{i(window.scrollY)})},[]);M.useEffect(()=>(o.current=new IntersectionObserver(u=>{u.forEach(g=>{g.isIntersecting&&t(h=>new Set(h).add(g.target.id))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),document.querySelectorAll(".animate-on-scroll").forEach(u=>{o.current&&o.current.observe(u)}),t(u=>{const g=new Set(u);return g.add("hero-logo"),g.add("hero-text"),g}),window.addEventListener("mousemove",c,{passive:!0}),window.addEventListener("scroll",A,{passive:!0}),()=>{o.current&&o.current.disconnect(),window.removeEventListener("mousemove",c),window.removeEventListener("scroll",A)}),[c,A]);const d=[{id:1,title:"Банковская CRM",description:"Комплексная банковская CRM-система для управления залоговым имуществом. Платформа предоставляет полный функционал для ведения учета, классификации и управления объектами залога в банковской сфере.",icon:s.jsx(el,{}),gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",url:"https://cmsauto.ru/#/registry",stats:{users:"500+",objects:"10K+",uptime:"99.9%"},features:["Управление карточками залогового имущества","Расширенная классификация объектов (60+ типов)","Динамические формы с 150+ полями","Многостраничная форма карточки","Фильтрация, поиск и сортировка","Экспорт/импорт в Excel","Резервное копирование","Интеграция с DaData API"]},{id:2,title:"Онлайн Автосалон",description:"Интернет-магазин автомобилей с расширенным каталогом и удобной системой поиска. Платформа для продажи автомобилей из различных регионов с полным циклом оформления документов.",icon:s.jsx(oO,{}),gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",url:"https://cmsauto.store/index.html#catalog",stats:{cars:"5K+",regions:"5",orders:"1K+"},features:["Каталог автомобилей с детальной информацией","Расширенный поиск и фильтрация","Каталоги из разных регионов","Таможенный калькулятор","Заявка на подбор автомобиля","Самостоятельный просчет стоимости","Система оформления заказов","Контактная форма"]},{id:3,title:"Задачник",description:"Система управления задачами для сотрудников с поддержкой ролевой модели, распределения по регионам и автоматизации процессов. Платформа для эффективного управления рабочими задачами.",icon:s.jsx(yn,{}),gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",url:"https://jfsagro-glitch.github.io/zadachnik/",stats:{tasks:"50K+",users:"200+",regions:"4"},features:["Управление задачами различных типов","Ролевая модель доступа","Распределение по регионам","Система приоритетов и статусов","Аналитика и KPI","Автопилот для распределения","Экспорт данных в CSV","Комментарии и история"]},{id:4,title:"Система дистанционных осмотров",description:"Платформа для проведения дистанционных осмотров объектов залогового имущества. Система позволяет проводить осмотры через мобильные устройства с фотофиксацией и геолокацией.",icon:s.jsx(Ao,{}),gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",url:"https://jfsagro-glitch.github.io/CMS_chek/",stats:{inspections:"20K+",mobile:"100%",accuracy:"99%"},features:["Мобильный интерфейс","Фотофиксация объектов","Структурированные чек-листы","Геолокация и привязка к адресу","Электронная подпись","Автоматическое формирование отчетов","История осмотров","Интеграция с CMS"]}],f=[{icon:s.jsx(gh,{}),value:"4",label:"Проекта",color:"#667eea"},{icon:s.jsx(iO,{}),value:"50K+",label:"Строк кода",color:"#f093fb"},{icon:s.jsx(Bb,{}),value:"500+",label:"Пользователей",color:"#4facfe"},{icon:s.jsx(bd,{}),value:"99.9%",label:"Uptime",color:"#fa709a"}];return s.jsxs("div",{className:"bitrix-portfolio-page",children:[s.jsxs("section",{className:"hero-section",ref:l,children:[s.jsx("div",{className:"hero-content",children:s.jsxs("div",{className:"brand-container",children:[s.jsx("img",{src:"/logo.png",alt:"CMS AUTO Logo",className:`hero-logo ${e.has("hero-logo")?"animate-fade-in-up":""}`,id:"hero-logo",loading:"lazy"}),s.jsxs("div",{className:`hero-text ${e.has("hero-text")?"animate-fade-in-up-delay":""}`,id:"hero-text",children:[s.jsxs("h1",{className:"hero-title",children:[s.jsx("span",{className:"title-gradient",children:"CMS AUTO"}),s.jsxs("div",{className:"ai-badge",children:[s.jsx(Ib,{className:"ai-icon"}),s.jsx("span",{className:"ai-text",children:"AI"}),s.jsx("div",{className:"ai-pulse-ring"}),s.jsx("div",{className:"ai-pulse-ring ai-pulse-ring-delay"})]})]}),s.jsx("p",{className:"hero-subtitle",children:"Профессиональные решения для бизнеса"}),s.jsx("div",{className:"hero-stats",children:f.map((p,u)=>s.jsxs("div",{className:"hero-stat-item",style:{animationDelay:`${.4+u*.1}s`},children:[s.jsx("div",{className:"stat-icon",style:{color:p.color},children:p.icon}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:p.value}),s.jsx("div",{className:"stat-label",children:p.label})]})]},u))})]})]})}),s.jsxs("div",{className:"hero-animated-bg",children:[s.jsx("div",{className:"floating-shape shape-1"}),s.jsx("div",{className:"floating-shape shape-2"}),s.jsx("div",{className:"floating-shape shape-3"}),s.jsx("div",{className:"mouse-follower",style:{transform:`translate(${r.x}px, ${r.y}px)`}})]}),s.jsx("div",{className:"parallax-layer",style:{transform:`translateY(${n*.5}px)`}})]}),s.jsx("section",{className:"projects-section",children:s.jsxs("div",{className:"section-container",children:[s.jsxs("div",{className:"section-header animate-on-scroll",id:`header-${Date.now()}`,children:[s.jsx("h2",{className:"section-title",children:s.jsx("span",{className:"title-underline",children:"Портфолио проектов"})}),s.jsx("p",{className:"section-description",children:"Ознакомьтесь с реализованными проектами и решениями"})]}),s.jsx("div",{className:"projects-grid",children:d.map((p,u)=>s.jsxs("div",{className:`project-card animate-on-scroll ${e.has(`project-${p.id}`)?"animate-fade-in-up":""}`,id:`project-${p.id}`,style:{animationDelay:`${u*.1}s`},children:[s.jsxs("div",{className:"project-icon-wrapper",style:{background:p.gradient},children:[s.jsx("div",{className:"project-icon icon-pulse",children:p.icon}),s.jsx("div",{className:"gradient-overlay"}),s.jsx("div",{className:"particles",children:[...Array(20)].map((g,h)=>s.jsx("div",{className:"particle",style:{"--delay":`${h*.1}s`}},h))})]}),s.jsxs("div",{className:"project-content",children:[s.jsx("h3",{className:"project-title",children:p.title}),s.jsx("p",{className:"project-description",children:p.description}),s.jsx("div",{className:"project-stats",children:Object.entries(p.stats).map(([g,h])=>s.jsxs("div",{className:"project-stat",children:[s.jsx("div",{className:"project-stat-value",children:h}),s.jsx("div",{className:"project-stat-label",children:g})]},g))}),s.jsxs("div",{className:"project-features",children:[s.jsx("h4",{className:"features-title",children:"Основные возможности:"}),s.jsx("ul",{className:"features-list",children:p.features.map((g,h)=>s.jsx("li",{className:"feature-item",style:{animationDelay:`${h*.05}s`},children:g},h))})]}),s.jsx("div",{className:"project-footer",children:s.jsxs("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",className:"project-link",children:[s.jsx("span",{children:"Открыть проект"}),s.jsx(sO,{})]})})]})]},p.id))})]})}),s.jsx("section",{className:"contacts-section",children:s.jsxs("div",{className:"section-container",children:[s.jsx("h2",{className:"section-title",children:s.jsx("span",{className:"title-underline",children:"Контактная информация"})}),s.jsxs("div",{className:"contacts-grid",children:[s.jsxs("div",{className:"contact-item animate-on-scroll",id:"contact-1",style:{animationDelay:"0s"},children:[s.jsx("div",{className:"contact-icon-wrapper",children:s.jsx(W1,{className:"contact-icon icon-bounce"})}),s.jsxs("div",{className:"contact-info",children:[s.jsx("h4",{className:"contact-label",children:"Email"}),s.jsx("a",{href:"mailto:cmsauto@bk.ru",className:"contact-value",children:"cmsauto@bk.ru"})]})]}),s.jsxs("div",{className:"contact-item animate-on-scroll",id:"contact-2",style:{animationDelay:"0.1s"},children:[s.jsx("div",{className:"contact-icon-wrapper",children:s.jsx(Dv,{className:"contact-icon icon-bounce"})}),s.jsxs("div",{className:"contact-info",children:[s.jsx("h4",{className:"contact-label",children:"Телефон"}),s.jsx("a",{href:"tel:+79154441208",className:"contact-value",children:"+7 (915) 444-12-08"})]})]}),s.jsxs("div",{className:"contact-item animate-on-scroll",id:"contact-3",style:{animationDelay:"0.2s"},children:[s.jsx("div",{className:"contact-icon-wrapper",children:s.jsx(Dv,{className:"contact-icon icon-bounce"})}),s.jsxs("div",{className:"contact-info",children:[s.jsx("h4",{className:"contact-label",children:"WhatsApp"}),s.jsx("a",{href:"https://wa.me/79184140636",target:"_blank",rel:"noopener noreferrer",className:"contact-value",children:"+7 (918) 414-06-36"})]})]}),s.jsxs("div",{className:"contact-item animate-on-scroll",id:"contact-4",style:{animationDelay:"0.3s"},children:[s.jsx("div",{className:"contact-icon-wrapper",children:s.jsx(go,{className:"contact-icon icon-bounce"})}),s.jsxs("div",{className:"contact-info",children:[s.jsx("h4",{className:"contact-label",children:"Сайт"}),s.jsx("a",{href:"https://cmsauto.ru",target:"_blank",rel:"noopener noreferrer",className:"contact-value",children:"https://cmsauto.ru"})]})]})]})]})})]})},{Paragraph:UY,Text:MY}=ht;class lY extends M.Component{constructor(r){super(r);tr(this,"logErrorToService",(r,a)=>{try{const n={timestamp:new Date().toISOString(),message:r.message,stack:r.stack,componentStack:a.componentStack},i=localStorage.getItem("error_logs"),o=i?JSON.parse(i):[];o.push(n),o.length>50&&o.shift(),localStorage.setItem("error_logs",JSON.stringify(o))}catch(n){console.error("Failed to log error:",n)}});tr(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});tr(this,"handleResetWithoutReload",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a),this.setState({error:r,errorInfo:a}),this.logErrorToService(r,a)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:s.jsx("div",{style:{padding:"50px",maxWidth:"800px",margin:"0 auto"},children:s.jsx(Eb,{status:"error",icon:s.jsx(lO,{}),title:"Произошла ошибка",subTitle:"К сожалению, что-то пошло не так. Попробуйте перезагрузить страницу или вернуться на главную.",extra:[s.jsx(Be,{type:"primary",icon:s.jsx(Zl,{}),onClick:this.handleReset,children:"Перезагрузить страницу"},"reload"),s.jsx(Be,{onClick:this.handleResetWithoutReload,children:"Попробовать снова"},"reset"),s.jsx(Be,{onClick:()=>window.location.href="/",children:"Вернуться на главную"},"home")],children:!1})}):this.props.children}}const cY=()=>{const e=nl(),{theme:t,initialized:r}=Vi(i=>i.app),a=Vi(i=>i.workflow);if(M.useEffect(()=>{(async()=>{try{try{localStorage.removeItem("zadachnik_tasks"),console.log("✅ Очищены старые задачи из localStorage (данные теперь в IndexedDB)")}catch(c){console.warn("Не удалось очистить задачи из localStorage (не критично):",c)}await kt.initDatabase();const o=await kt.getSettings();e(qO(o));const l=await kt.getExtendedCards();if(l.length===0)try{const{loadDemoData:c}=await ps(async()=>{const{loadDemoData:d}=await import("./demoData-DJKFRABz.js");return{loadDemoData:d}},__vite__mapDeps([4,1,5,3]));await c(kt);const A=await kt.getExtendedCards();e(rf(A)),console.log("✅ Демо-данные загружены автоматически")}catch(c){console.warn("Демо-данные не загружены:",c),e(rf(l))}else e(rf(l));try{const{syncEmployeesToZadachnik:c}=await ps(async()=>{const{syncEmployeesToZadachnik:g}=await Promise.resolve().then(()=>t$);return{syncEmployeesToZadachnik:g}},void 0);c();const d=pr.getEmployees().filter(g=>g.isActive);let f=[];try{f=await kt.getTasks()}catch{try{const h=localStorage.getItem("zadachnik_tasks");h&&(h.length<4194304?f=JSON.parse(h):console.warn("Задачи в localStorage слишком большие, используем только IndexedDB"))}catch(h){console.warn("Не удалось загрузить задачи из localStorage:",h)}}const u=d.length*60;if(!f||f.length===0||f.length<u){const{generateTasksForEmployees:g}=await ps(async()=>{const{generateTasksForEmployees:h}=await Promise.resolve().then(()=>NS);return{generateTasksForEmployees:h}},void 0);await g(),f=await kt.getTasks(),console.log(`✅ Сгенерировано ${f.length} задач для ${d.length} активных сотрудников (${(f.length/d.length).toFixed(1)} задач на сотрудника)`)}else console.log(`✅ Загружено ${f.length} задач для ${d.length} активных сотрудников (${(f.length/d.length).toFixed(1)} задач на сотрудника)`)}catch(c){console.warn("Не удалось синхронизировать сотрудников с zadachnik:",c)}try{const c=(await ps(async()=>{const{default:d}=await Promise.resolve().then(()=>KM);return{default:d}},void 0)).default;if(await c.initDatabase(),(await c.getInspections()).length===0){const{loadInspectionDemoData:d}=await ps(async()=>{const{loadInspectionDemoData:f}=await import("./inspectionDemoData-CpwMOjkS.js");return{loadInspectionDemoData:f}},__vite__mapDeps([6,1,5,3]));await d(),console.log("✅ Демо-данные осмотров загружены автоматически")}}catch(c){console.warn("Демо-данные осмотров не загружены:",c)}try{const c=await kt.getWorkflowCases();c&&c.length>0&&e(ZO(c));const A=await kt.getWorkflowTemplates();A&&A.length>0?e(Qv(A)):(await kt.saveWorkflowTemplates(Z1),e(Qv(Z1)))}catch(c){console.warn("Не удалось загрузить workflow из IndexedDB:",c)}e(QO(!0))}catch(o){console.error("Failed to initialize app:",o)}})()},[e]),M.useEffect(()=>{r&&(async()=>{try{await kt.saveWorkflowCases(a.cases),await kt.saveWorkflowTemplates(a.templates)}catch(i){console.warn("Не удалось сохранить workflow в IndexedDB:",i)}})()},[r,a.cases,a.templates]),!r)return s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Загрузка..."});const n=()=>{switch(t){case"dark":return Ul.darkAlgorithm;case"compact":return[Ul.defaultAlgorithm,Ul.compactAlgorithm];default:return Ul.defaultAlgorithm}};return s.jsx(lM,{children:s.jsx(mM,{children:s.jsx(fb,{locale:UO,theme:{algorithm:n(),token:{colorPrimary:"#1890ff",borderRadius:6}},children:s.jsx(cO,{children:s.jsx(BT,{children:s.jsx(ST,{children:s.jsxs(Rr,{path:"/",element:s.jsx(CM,{}),children:[s.jsx(Rr,{index:!0,element:s.jsx(Ov,{to:"/registry",replace:!0})}),s.jsx(Rr,{path:"registry",element:s.jsx(YP,{})}),s.jsx(Rr,{path:"portfolio",element:s.jsx(Uz,{})}),s.jsx(Rr,{path:"collateral-dossier",element:s.jsx(Mz,{})}),s.jsx(Rr,{path:"collateral-conclusions",element:s.jsx(SV,{})}),s.jsx(Rr,{path:"tasks",element:s.jsx(AV,{})}),s.jsx(Rr,{path:"kpi",element:s.jsx(WV,{})}),s.jsx(Rr,{path:"reports",element:s.jsx(cV,{})}),s.jsx(Rr,{path:"insurance",element:s.jsx(yz,{})}),s.jsx(Rr,{path:"fnp",element:s.jsx(IV,{})}),s.jsx(Rr,{path:"analytics",element:s.jsx(ZV,{})}),s.jsx(Rr,{path:"credit-risk",element:s.jsx(RV,{})}),s.jsx(Rr,{path:"appraisal",element:s.jsx(kV,{})}),s.jsx(Rr,{path:"cms-check",element:s.jsx(pV,{})}),s.jsx(Rr,{path:"inspection/:token",element:s.jsx(gV,{})}),s.jsx(Rr,{path:"egrn",element:s.jsx(LV,{})}),s.jsx(Rr,{path:"upload",element:s.jsx(O$,{})}),s.jsx(Rr,{path:"monitoring",element:s.jsx(sV,{})}),s.jsx(Rr,{path:"reference",element:s.jsx(J$,{})}),s.jsx(Rr,{path:"projects-portfolio",element:s.jsx(oY,{})}),s.jsx(Rr,{path:"workflow",element:s.jsx(tY,{})}),s.jsx(Rr,{path:"workflow/object/:id",element:s.jsx(nY,{})}),s.jsx(Rr,{path:"workflow/settings",element:s.jsx(Ov,{to:"/settings/workflow",replace:!0})}),s.jsx(Rr,{path:"settings",element:s.jsx(xz,{title:"Настройки"})}),s.jsx(Rr,{path:"settings/workflow",element:s.jsx(iY,{})}),s.jsx(Rr,{path:"settings/employees",element:s.jsx(i$,{})}),s.jsx(Rr,{path:"settings/reference-data",element:s.jsx(l$,{})}),s.jsx(Rr,{path:"settings/norm-hours",element:s.jsx(A$,{})}),s.jsx(Rr,{path:"settings/metrics",element:s.jsx(h$,{})}),s.jsx(Rr,{path:"settings/appraisal-companies",element:s.jsx(x$,{})})]})})})})})})})},AY=()=>s.jsx(lY,{children:s.jsx(NT,{store:sI,children:s.jsx(cY,{})})});X1.createRoot(document.getElementById("root")).render(s.jsx(Ma.StrictMode,{children:s.jsx(AY,{})}));export{zi as g,Ba as i};
//# sourceMappingURL=index-DmngLMbp.js.map
