const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-Be8gggM1.js","./react-vendor-D9Laeo57.js","./index.es-BV8IozGy.js","./antd-vendor-RBTKstc-.js","./demoData-DEAyhEU4.js","./redux-vendor-Cb-5CTel.js","./inspectionDemoData-cQLZWfqt.js"])))=>i.map(i=>d[i]);
var tT=Object.defineProperty;var rT=(e,t,r)=>t in e?tT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var sr=(e,t,r)=>rT(e,typeof t!="symbol"?t+"":t,r);import{r as K,c as aT,g as XE,u as $s,f as uc,O as nT,R as Ma,e as iT,h as sT,H as oT,i as AT,j as ra,N as cT}from"./react-vendor-D9Laeo57.js";import{c as u2,a as lT,u as dT,b as uT,P as fT}from"./redux-vendor-Cb-5CTel.js";import{C as JE,t as UA,s as Ne,L as _f,T as Xr,M as pT,S as Fe,a as Ye,B as Be,R as JA,b as Bs,c as ZE,d as eA,e as hT,f as Kc,g as L1,h as Qr,i as mT,j as e_,k as rl,l as gT,m as Jf,n as Ko,o as xT,p as yT,q as bf,r as Hc,u as t_,v as r_,w as vT,x as a_,y as xi,z as wT,A as ET,I as Re,D as Pa,E as _T,F as tm,G as es,H as bT,J as Nr,K as ne,N as nr,O as dr,P as fa,Q as Ni,U as Ri,V as fo,W as at,X as CT,Y as Zn,Z as Ge,_ as ft,$ as Te,a0 as On,a1 as fh,a2 as tA,a3 as jt,a4 as BT,a5 as Ii,a6 as Xi,a7 as kA,a8 as In,a9 as Ss,aa as We,ab as Rr,ac as U1,ad as Ts,ae as n_,af as rm,ag as mt,ah as we,ai as Br,aj as am,ak as mv,al as zn,am as ZA,an as Ba,ao as yt,ap as MA,aq as Zu,ar as ST,as as TT,at as ph,au as Jr,av as OT,aw as i_,ax as s_,ay as IT,az as Ao,aA as NT,aB as gv,aC as xv,aD as yv,aE as hh,aF as Wp,aG as Ho,aH as ec,aI as tc,aJ as o_,aK as A_,aL as FT,aM as vv,aN as RT,aO as f2,aP as wv,aQ as ef,aR as Qn,aS as c_,aT as kT,aU as DT,aV as p2,aW as jT,aX as LT,aY as l_,aZ as UT,a_ as d_,a$ as u_,b0 as Ev,b1 as MT,b2 as J0,b3 as PT,b4 as _v,b5 as QT,b6 as qT,b7 as KT,b8 as En,b9 as HT,ba as GT}from"./antd-vendor-RBTKstc-.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var f_={exports:{}},nm={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zT=K,VT=Symbol.for("react.element"),$T=Symbol.for("react.fragment"),YT=Object.prototype.hasOwnProperty,WT=zT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,XT={key:!0,ref:!0,__self:!0,__source:!0};function p_(e,t,r){var a,n={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)YT.call(t,a)&&!XT.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:VT,type:e,key:s,ref:o,props:n,_owner:WT.current}}nm.Fragment=$T;nm.jsx=p_;nm.jsxs=p_;f_.exports=nm;var i=f_.exports,M1={},bv=aT;M1.createRoot=bv.createRoot,M1.hydrateRoot=bv.hydrateRoot;const JT="modulepreload",ZT=function(e,t){return new URL(e,t).href},Cv={},pi=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link"),A=document.querySelector("meta[property=csp-nonce]"),c=(A==null?void 0:A.nonce)||(A==null?void 0:A.getAttribute("nonce"));n=Promise.allSettled(r.map(l=>{if(l=ZT(l,a),l in Cv)return;Cv[l]=!0;const d=l.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!a)for(let g=o.length-1;g>=0;g--){const h=o[g];if(h.href===l&&(!d||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${f}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":JT,d||(u.as="script"),u.crossOrigin="",u.href=l,c&&u.setAttribute("nonce",c),document.head.appendChild(u),d)return new Promise((g,h)=>{u.addEventListener("load",g),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=o,window.dispatchEvent(A),!A.defaultPrevented)throw o}return n.then(o=>{for(const A of o||[])A.status==="rejected"&&s(A.reason);return t().catch(s)})};var im={},h_={exports:{}};(function(e){function t(r){return r&&r.__esModule?r:{default:r}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(h_);var sm=h_.exports,om={};Object.defineProperty(om,"__esModule",{value:!0});om.default=void 0;var eO={items_per_page:"/ стр.",jump_to:"Перейти",jump_to_confirm:"подтвердить",page:"Страница",prev_page:"Назад",next_page:"Вперед",prev_5:"Предыдущие 5",next_5:"Следующие 5",prev_3:"Предыдущие 3",next_3:"Следующие 3",page_size:"размер страницы"};om.default=eO;var Am={},Zf={},cm={},m_={exports:{}},g_={exports:{}},x_={exports:{}},y_={exports:{}};(function(e){function t(r){"@babel/helpers - typeof";return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(y_);var v_=y_.exports,w_={exports:{}};(function(e){var t=v_.default;function r(a,n){if(t(a)!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var o=s.call(a,n||"default");if(t(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(w_);var tO=w_.exports;(function(e){var t=v_.default,r=tO;function a(n){var s=r(n,"string");return t(s)=="symbol"?s:s+""}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(x_);var rO=x_.exports;(function(e){var t=rO;function r(a,n,s){return(n=t(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s,a}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(g_);var aO=g_.exports;(function(e){var t=aO;function r(n,s){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(n);s&&(A=A.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),o.push.apply(o,A)}return o}function a(n){for(var s=1;s<arguments.length;s++){var o=arguments[s]!=null?arguments[s]:{};s%2?r(Object(o),!0).forEach(function(A){t(n,A,o[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(A){Object.defineProperty(n,A,Object.getOwnPropertyDescriptor(o,A))})}return n}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(m_);var nO=m_.exports,lm={};Object.defineProperty(lm,"__esModule",{value:!0});lm.commonLocale=void 0;lm.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var iO=sm.default;Object.defineProperty(cm,"__esModule",{value:!0});cm.default=void 0;var Bv=iO(nO),sO=lm,oO=(0,Bv.default)((0,Bv.default)({},sO.commonLocale),{},{locale:"ru_RU",today:"Сегодня",now:"Сейчас",backToToday:"Текущая дата",ok:"ОК",clear:"Очистить",week:"Неделя",month:"Месяц",year:"Год",timeSelect:"Выбрать время",dateSelect:"Выбрать дату",monthSelect:"Выбрать месяц",yearSelect:"Выбрать год",decadeSelect:"Выбрать десятилетие",dateFormat:"D-M-YYYY",dateTimeFormat:"D-M-YYYY HH:mm:ss",previousMonth:"Предыдущий месяц (PageUp)",nextMonth:"Следующий месяц (PageDown)",previousYear:"Предыдущий год (Control + left)",nextYear:"Следующий год (Control + right)",previousDecade:"Предыдущее десятилетие",nextDecade:"Следущее десятилетие",previousCentury:"Предыдущий век",nextCentury:"Следующий век"});cm.default=oO;var e0={};Object.defineProperty(e0,"__esModule",{value:!0});e0.default=void 0;const AO={placeholder:"Выберите время",rangePlaceholder:["Время начала","Время окончания"]};e0.default=AO;var E_=sm.default;Object.defineProperty(Zf,"__esModule",{value:!0});Zf.default=void 0;var cO=E_(cm),lO=E_(e0);const dO={lang:Object.assign({placeholder:"Выберите дату",yearPlaceholder:"Выберите год",quarterPlaceholder:"Выберите квартал",monthPlaceholder:"Выберите месяц",weekPlaceholder:"Выберите неделю",rangePlaceholder:["Начальная дата","Конечная дата"],rangeYearPlaceholder:["Начальный год","Год окончания"],rangeMonthPlaceholder:["Начальный месяц","Конечный месяц"],rangeWeekPlaceholder:["Начальная неделя","Конечная неделя"],shortWeekDays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],shortMonths:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]},cO.default),timePickerLocale:Object.assign({},lO.default)};Zf.default=dO;var uO=sm.default;Object.defineProperty(Am,"__esModule",{value:!0});Am.default=void 0;var fO=uO(Zf);Am.default=fO.default;var dm=sm.default;Object.defineProperty(im,"__esModule",{value:!0});im.default=void 0;var pO=dm(om),hO=dm(Am),mO=dm(Zf),gO=dm(e0);const qi="${label} не является типом ${type}",xO={locale:"ru",Pagination:pO.default,DatePicker:mO.default,TimePicker:gO.default,Calendar:hO.default,global:{placeholder:"Пожалуйста выберите",close:"Закрыть"},Table:{filterTitle:"Фильтр",filterConfirm:"OK",filterReset:"Сбросить",filterEmptyText:"Без фильтров",filterCheckAll:"Выбрать все элементы",filterSearchPlaceholder:"Поиск в фильтрах",emptyText:"Нет данных",selectAll:"Выбрать всё",selectInvert:"Инвертировать выбор",selectNone:"Очистить все данные",selectionAll:"Выбрать все данные",sortTitle:"Сортировка",expand:"Развернуть строку",collapse:"Свернуть строку",triggerDesc:"Нажмите для сортировки по убыванию",triggerAsc:"Нажмите для сортировки по возрастанию",cancelSort:"Нажмите, чтобы отменить сортировку"},Tour:{Next:"Далее",Previous:"Назад",Finish:"Завершить"},Modal:{okText:"OK",cancelText:"Отмена",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Отмена"},Transfer:{titles:["",""],searchPlaceholder:"Поиск",itemUnit:"элем.",itemsUnit:"элем.",remove:"Удалить",selectAll:"Выбрать все данные",deselectAll:"Очистить все данные",selectCurrent:"Выбрать текущую страницу",selectInvert:"Инвертировать выбор",removeAll:"Удалить все данные",removeCurrent:"Удалить текущую страницу"},Upload:{uploading:"Загрузка...",removeFile:"Удалить файл",uploadError:"При загрузке произошла ошибка",previewFile:"Предпросмотр файла",downloadFile:"Загрузить файл"},Empty:{description:"Нет данных"},Icon:{icon:"иконка"},Text:{edit:"Редактировать",copy:"Копировать",copied:"Скопировано",expand:"Раскрыть",collapse:"Свернуть"},Form:{optional:"(необязательно)",defaultValidateMessages:{default:"Ошибка проверки поля ${label}",required:"Пожалуйста, введите ${label}",enum:"${label} должен быть одним из [${enum}]",whitespace:"${label} не может быть пустым",date:{format:"${label} не правильный формат даты",parse:"${label} не может быть преобразовано в дату",invalid:"${label} не является корректной датой"},types:{string:qi,method:qi,array:qi,object:qi,number:qi,date:qi,boolean:qi,integer:qi,float:qi,regexp:qi,email:qi,url:qi,hex:qi},string:{len:"${label} должна быть ${len} символов",min:"${label} должна быть больше или равна ${min} символов",max:"${label} должна быть меньше или равна ${max} символов",range:"Длина ${label} должна быть между ${min}-${max} символами"},number:{len:"${label} должна быть равна ${len}",min:"${label} должна быть больше или равна ${min}",max:"${label} должна быть меньше или равна ${max}",range:"${label} должна быть между ${min}-${max}"},array:{len:"Количество элементов ${label} должно быть равно ${len}",min:"Количество элементов ${label} должно быть больше или равно ${min}",max:"Количество элементов ${label} должно быть меньше или равно ${max}",range:"Количество элементов ${label} должно быть между ${min} и ${max}"},pattern:{mismatch:"${label} не соответствует шаблону ${pattern}"}}},Image:{preview:"Предпросмотр"},QRCode:{expired:"QR-код устарел",refresh:"Обновить"},ColorPicker:{presetEmpty:"Пустой",transparent:"Прозрачный",singleColor:"Один цвет",gradientColor:"Градиент"}};im.default=xO;var yO=im;const vO=XE(yO),wO={theme:"light",language:"ru",sidebarCollapsed:!1,loading:!1,initialized:!1},__=u2({name:"app",initialState:wO,reducers:{setTheme:(e,t)=>{e.theme=t.payload},setLanguage:(e,t)=>{e.language=t.payload},toggleSidebar:e=>{e.sidebarCollapsed=!e.sidebarCollapsed},setSidebarCollapsed:(e,t)=>{e.sidebarCollapsed=t.payload},setLoading:(e,t)=>{e.loading=t.payload},setInitialized:(e,t)=>{e.initialized=t.payload},setSettings:(e,t)=>({...e,...t.payload})}}),{setTheme:k$,setLanguage:D$,toggleSidebar:EO,setSidebarCollapsed:j$,setLoading:L$,setInitialized:_O,setSettings:bO}=__.actions,CO=__.reducer,BO={items:[],filteredItems:[],selectedCard:null,filters:{},sort:null,loading:!1,error:null},b_=u2({name:"cards",initialState:BO,reducers:{setCards:(e,t)=>{e.items=t.payload,e.filteredItems=_A(t.payload,e.filters,e.sort)},addCard:(e,t)=>{e.items.push(t.payload),e.filteredItems=_A(e.items,e.filters,e.sort)},updateCard:(e,t)=>{const r=e.items.findIndex(a=>a.id===t.payload.id);r!==-1&&(e.items[r]=t.payload,e.filteredItems=_A(e.items,e.filters,e.sort))},deleteCard:(e,t)=>{e.items=e.items.filter(r=>r.id!==t.payload),e.filteredItems=_A(e.items,e.filters,e.sort)},deleteCards:(e,t)=>{e.items=e.items.filter(r=>!t.payload.includes(r.id)),e.filteredItems=_A(e.items,e.filters,e.sort)},setSelectedCard:(e,t)=>{e.selectedCard=t.payload},setFilters:(e,t)=>{e.filters=t.payload,e.filteredItems=_A(e.items,t.payload,e.sort)},setSort:(e,t)=>{e.sort=t.payload,e.filteredItems=_A(e.items,e.filters,t.payload)},clearFilters:e=>{e.filters={},e.filteredItems=_A(e.items,{},e.sort)},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload}}});function _A(e,t,r){let a=[...e];if(t.mainCategory&&(a=a.filter(n=>n.mainCategory===t.mainCategory)),t.status&&(a=a.filter(n=>n.status===t.status)),t.searchQuery){const n=t.searchQuery.toLowerCase();a=a.filter(s=>s.name.toLowerCase().includes(n)||s.number.toLowerCase().includes(n))}return t.dateFrom&&(a=a.filter(n=>n.createdAt>=t.dateFrom)),t.dateTo&&(a=a.filter(n=>n.createdAt<=t.dateTo)),r&&a.sort((n,s)=>{const o=n[r.field],A=s[r.field];return o==null?1:A==null?-1:o<A?r.order==="asc"?-1:1:o>A?r.order==="asc"?1:-1:0}),a}const{setCards:tf,addCard:U$,updateCard:M$,deleteCard:P$,deleteCards:Q$,setSelectedCard:q$,setFilters:K$,setSort:H$,clearFilters:G$,setLoading:z$,setError:V$}=b_.actions,SO=b_.reducer,TO={items:[],filteredItems:[],selectedCard:null,filters:{},sort:null,loading:!1,error:null},C_=u2({name:"extendedCards",initialState:TO,reducers:{setExtendedCards:(e,t)=>{e.items=t.payload,e.filteredItems=bA(t.payload,e.filters,e.sort)},addExtendedCard:(e,t)=>{e.items.push(t.payload),e.filteredItems=bA(e.items,e.filters,e.sort)},updateExtendedCard:(e,t)=>{const r=e.items.findIndex(a=>a.id===t.payload.id);r!==-1&&(e.items[r]=t.payload,e.filteredItems=bA(e.items,e.filters,e.sort))},deleteExtendedCard:(e,t)=>{e.items=e.items.filter(r=>r.id!==t.payload),e.filteredItems=bA(e.items,e.filters,e.sort)},deleteExtendedCards:(e,t)=>{e.items=e.items.filter(r=>!t.payload.includes(r.id)),e.filteredItems=bA(e.items,e.filters,e.sort)},setSelectedExtendedCard:(e,t)=>{e.selectedCard=t.payload},setExtendedFilters:(e,t)=>{e.filters=t.payload,e.filteredItems=bA(e.items,t.payload,e.sort)},setExtendedSort:(e,t)=>{e.sort=t.payload,e.filteredItems=bA(e.items,e.filters,t.payload)},clearExtendedFilters:e=>{e.filters={},e.filteredItems=bA(e.items,{},e.sort)},setExtendedLoading:(e,t)=>{e.loading=t.payload},setExtendedError:(e,t)=>{e.error=t.payload}}});function bA(e,t,r){let a=[...e];if(t.mainCategory&&(a=a.filter(n=>n.mainCategory===t.mainCategory)),t.status&&(a=a.filter(n=>n.status===t.status)),t.searchQuery){const n=t.searchQuery.toLowerCase();a=a.filter(s=>{var o,A;return s.name.toLowerCase().includes(n)||s.number.toLowerCase().includes(n)||((A=(o=s.address)==null?void 0:o.fullAddress)==null?void 0:A.toLowerCase().includes(n))})}return t.region&&(a=a.filter(n=>{var s,o;return(o=(s=n.address)==null?void 0:s.region)==null?void 0:o.toLowerCase().includes(t.region.toLowerCase())})),t.hasDocuments!==void 0&&(a=a.filter(n=>{var s,o;return t.hasDocuments?(((s=n.documents)==null?void 0:s.length)||0)>0:(((o=n.documents)==null?void 0:o.length)||0)===0})),r&&a.sort((n,s)=>{const o=n[r.field],A=s[r.field];if(o!==void 0&&A!==void 0){if(o<A)return r.order==="asc"?-1:1;if(o>A)return r.order==="asc"?1:-1}return 0}),a}const{setExtendedCards:P1,addExtendedCard:OO,updateExtendedCard:IO,deleteExtendedCard:NO,deleteExtendedCards:$$,setSelectedExtendedCard:Y$,setExtendedFilters:W$,setExtendedSort:X$,clearExtendedFilters:J$,setExtendedLoading:Sv,setExtendedError:Z$}=C_.actions,FO=C_.reducer,RO=lT({reducer:{app:CO,cards:SO,extendedCards:FO},middleware:e=>e({serializableCheck:{ignoredActions:["cards/setCards","cards/addCard","cards/updateCard","extendedCards/setExtendedCards","extendedCards/addExtendedCard","extendedCards/updateExtendedCard"],ignoredPaths:["cards.items","extendedCards.items"]}})}),Hd=()=>dT(),Cf=uT,ia=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Xa=Object.keys,Wn=Array.isArray;function mi(e,t){return typeof t!="object"||Xa(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||ia.Promise||(ia.Promise=Promise);const Bf=Object.getPrototypeOf,kO={}.hasOwnProperty;function ts(e,t){return kO.call(e,t)}function Md(e,t){typeof t=="function"&&(t=t(Bf(e))),(typeof Reflect>"u"?Xa:Reflect.ownKeys)(t).forEach(r=>{$o(e,r,t[r])})}const B_=Object.defineProperty;function $o(e,t,r,a){B_(e,t,mi(r&&ts(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},a))}function _d(e){return{from:function(t){return e.prototype=Object.create(t.prototype),$o(e.prototype,"constructor",e),{extend:Md.bind(null,e.prototype)}}}}const DO=Object.getOwnPropertyDescriptor;function h2(e,t){let r;return DO(e,t)||(r=Bf(e))&&h2(r,t)}const jO=[].slice;function mh(e,t,r){return jO.call(e,t,r)}function S_(e,t){return t(e)}function Pu(e){if(!e)throw new Error("Assertion Failed")}function T_(e){ia.setImmediate?setImmediate(e):setTimeout(e,0)}function O_(e,t){return e.reduce((r,a,n)=>{var s=t(a,n);return s&&(r[s[0]]=s[1]),r},{})}function Yo(e,t){if(typeof t=="string"&&ts(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],a=0,n=t.length;a<n;++a){var s=Yo(e,t[a]);r.push(s)}return r}var o=t.indexOf(".");if(o!==-1){var A=e[t.substr(0,o)];return A==null?void 0:Yo(A,t.substr(o+1))}}function Hs(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Pu(typeof r!="string"&&"length"in r);for(var a=0,n=t.length;a<n;++a)Hs(e,t[a],r[a])}else{var s=t.indexOf(".");if(s!==-1){var o=t.substr(0,s),A=t.substr(s+1);if(A==="")r===void 0?Wn(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=r;else{var c=e[o];c&&ts(e,o)||(c=e[o]={}),Hs(c,A,r)}}else r===void 0?Wn(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function I_(e){var t={};for(var r in e)ts(e,r)&&(t[r]=e[r]);return t}const LO=[].concat;function N_(e){return LO.apply([],e)}const F_="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(N_([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>ia[e]),UO=F_.map(e=>ia[e]);O_(F_,e=>[e,!0]);let DA=null;function t0(e){DA=typeof WeakMap<"u"&&new WeakMap;const t=Q1(e);return DA=null,t}function Q1(e){if(!e||typeof e!="object")return e;let t=DA&&DA.get(e);if(t)return t;if(Wn(e)){t=[],DA&&DA.set(e,t);for(var r=0,a=e.length;r<a;++r)t.push(Q1(e[r]))}else if(UO.indexOf(e.constructor)>=0)t=e;else{const s=Bf(e);for(var n in t=s===Object.prototype?{}:Object.create(s),DA&&DA.set(e,t),e)ts(e,n)&&(t[n]=Q1(e[n]))}return t}const{toString:MO}={};function q1(e){return MO.call(e).slice(8,-1)}const K1=typeof Symbol<"u"?Symbol.iterator:"@@iterator",PO=typeof K1=="symbol"?function(e){var t;return e!=null&&(t=e[K1])&&t.apply(e)}:function(){return null},ud={};function qo(e){var t,r,a,n;if(arguments.length===1){if(Wn(e))return e.slice();if(this===ud&&typeof e=="string")return[e];if(n=PO(e)){for(r=[];!(a=n.next()).done;)r.push(a.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const m2=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var go=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function R_(e,t){go=e,k_=t}var k_=()=>!0;const QO=!new Error("").stack;function fl(){if(QO)try{throw fl.arguments,new Error}catch(e){return e}return new Error}function H1(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(k_).map(a=>`
`+a).join("")):""}var D_=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],g2=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(D_),qO={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function bd(e,t){this._e=fl(),this.name=e,this.message=t}function j_(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,a,n)=>n.indexOf(r)===a).join(`
`)}function gh(e,t,r,a){this._e=fl(),this.failures=t,this.failedKeys=a,this.successCount=r,this.message=j_(e,t)}function rf(e,t){this._e=fl(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=j_(e,t)}_d(bd).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+H1(this._e,2))}},toString:function(){return this.name+": "+this.message}}),_d(gh).from(bd),_d(rf).from(bd);var x2=g2.reduce((e,t)=>(e[t]=t+"Error",e),{});const KO=bd;var Wt=g2.reduce((e,t)=>{var r=t+"Error";function a(n,s){this._e=fl(),this.name=r,n?typeof n=="string"?(this.message=`${n}${s?`
 `+s:""}`,this.inner=s||null):typeof n=="object"&&(this.message=`${n.name} ${n.message}`,this.inner=n):(this.message=qO[t]||r,this.inner=null)}return _d(a).from(KO),e[t]=a,e},{});Wt.Syntax=SyntaxError,Wt.Type=TypeError,Wt.Range=RangeError;var Tv=D_.reduce((e,t)=>(e[t+"Error"]=Wt[t],e),{}),Xp=g2.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Wt[t]),e),{});function Wr(){}function Sf(e){return e}function HO(e,t){return e==null||e===Sf?t:function(r){return t(e(r))}}function al(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function GO(e,t){return e===Wr?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var a=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?al(a,this.onsuccess):a),n&&(this.onerror=this.onerror?al(n,this.onerror):n),s!==void 0?s:r}}function zO(e,t){return e===Wr?t:function(){e.apply(this,arguments);var r=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?al(r,this.onsuccess):r),a&&(this.onerror=this.onerror?al(a,this.onerror):a)}}function VO(e,t){return e===Wr?t:function(r){var a=e.apply(this,arguments);mi(r,a);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?al(n,this.onsuccess):n),s&&(this.onerror=this.onerror?al(s,this.onerror):s),a===void 0?o===void 0?void 0:o:mi(a,o)}}function $O(e,t){return e===Wr?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function y2(e,t){return e===Wr?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var a=this,n=arguments.length,s=new Array(n);n--;)s[n]=arguments[n];return r.then(function(){return t.apply(a,s)})}return t.apply(this,arguments)}}Xp.ModifyError=gh,Xp.DexieError=bd,Xp.BulkError=rf;var Tf={};const L_=100,[G1,xh,z1]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Bf(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Bf(t),e]})(),U_=xh&&xh.then,Jp=G1&&G1.constructor,v2=!!z1;var V1=!1,YO=z1?()=>{z1.then(Z0)}:ia.setImmediate?setImmediate.bind(null,Z0):ia.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Z0(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Z0,0)},af=function(e,t){Qu.push([e,t]),yh&&(YO(),yh=!1)},$1=!0,yh=!0,Gc=[],Zp=[],Y1=null,W1=Sf,Cd={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Nv,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{Nv(e[0],e[1])}catch{}})}},Pt=Cd,Qu=[],zc=0,eh=[];function Nt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Wr,this._lib=!1;var t=this._PSD=Pt;if(go&&(this._stackHolder=fl(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Tf)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&J1(this,this._value))}this._state=null,this._value=null,++t.ref,P_(this,e)}const X1={get:function(){var e=Pt,t=vh;function r(a,n){var s=!e.global&&(e!==Pt||t!==vh);const o=s&&!rA();var A=new Nt((c,l)=>{w2(this,new M_(wh(a,e,s,o),wh(n,e,s,o),c,l,e))});return go&&K_(A,this),A}return r.prototype=Tf,r},set:function(e){$o(this,"then",e&&e.prototype===Tf?X1:{get:function(){return e},set:X1.set})}};function M_(e,t,r,a,n){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=a,this.psd=n}function P_(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var a=e._lib&&r0();r&&typeof r.then=="function"?P_(e,(n,s)=>{r instanceof Nt?r._then(n,s):r.then(n,s)}):(e._state=!0,e._value=r,Q_(e)),a&&a0()}},J1.bind(null,e))}catch(r){J1(e,r)}}function J1(e,t){if(Zp.push(t),e._state===null){var r=e._lib&&r0();t=W1(t),e._state=!1,e._value=t,go&&t!==null&&typeof t=="object"&&!t._promise&&function(a,n,s){try{a.apply(null,s)}catch{}}(()=>{var a=h2(t,"stack");t._promise=e,$o(t,"stack",{get:()=>V1?a&&(a.get?a.get.apply(t):a.value):e.stack})}),function(a){Gc.some(n=>n._value===a._value)||Gc.push(a)}(e),Q_(e),r&&a0()}}function Q_(e){var t=e._listeners;e._listeners=[];for(var r=0,a=t.length;r<a;++r)w2(e,t[r]);var n=e._PSD;--n.ref||n.finalize(),zc===0&&(++zc,af(()=>{--zc==0&&E2()},[]))}function w2(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++zc,af(WO,[r,e,t])}else e._listeners.push(t)}function WO(e,t,r){try{Y1=t;var a,n=t._value;t._state?a=e(n):(Zp.length&&(Zp=[]),a=e(n),Zp.indexOf(n)===-1&&function(s){for(var o=Gc.length;o;)if(Gc[--o]._value===s._value)return void Gc.splice(o,1)}(t)),r.resolve(a)}catch(s){r.reject(s)}finally{Y1=null,--zc==0&&E2(),--r.psd.ref||r.psd.finalize()}}function q_(e,t,r){if(t.length===r)return t;var a="";if(e._state===!1){var n,s,o=e._value;o!=null?(n=o.name||"Error",s=o.message||o,a=H1(o,0)):(n=o,s=""),t.push(n+(s?": "+s:"")+a)}return go&&((a=H1(e._stackHolder,2))&&t.indexOf(a)===-1&&t.push(a),e._prev&&q_(e._prev,t,r)),t}function K_(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Z0(){r0()&&a0()}function r0(){var e=$1;return $1=!1,yh=!1,e}function a0(){var e,t,r;do for(;Qu.length>0;)for(e=Qu,Qu=[],r=e.length,t=0;t<r;++t){var a=e[t];a[0].apply(null,a[1])}while(Qu.length>0);$1=!0,yh=!0}function E2(){var e=Gc;Gc=[],e.forEach(a=>{a._PSD.onunhandled.call(null,a._value,a)});for(var t=eh.slice(0),r=t.length;r;)t[--r]()}function ep(e){return new Nt(Tf,!1,e)}function ua(e,t){var r=Pt;return function(){var a=r0(),n=Pt;try{return ac(r,!0),e.apply(this,arguments)}catch(s){t&&t(s)}finally{ac(n,!1),a&&a0()}}}Md(Nt.prototype,{then:X1,_then:function(e,t){w2(this,new M_(null,null,e,t,Pt))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,a=>a instanceof t?r(a):ep(a)):this.then(null,a=>a&&a.name===t?r(a):ep(a))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),ep(t)))},stack:{get:function(){if(this._stack)return this._stack;try{V1=!0;var e=q_(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{V1=!1}}},timeout:function(e,t){return e<1/0?new Nt((r,a)=>{var n=setTimeout(()=>a(new Wt.Timeout(t)),e);this.then(r,a).finally(clearTimeout.bind(null,n))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&$o(Nt.prototype,Symbol.toStringTag,"Dexie.Promise"),Cd.env=H_(),Md(Nt,{all:function(){var e=qo.apply(null,arguments).map(tp);return new Nt(function(t,r){e.length===0&&t([]);var a=e.length;e.forEach((n,s)=>Nt.resolve(n).then(o=>{e[s]=o,--a||t(e)},r))})},resolve:e=>{if(e instanceof Nt)return e;if(e&&typeof e.then=="function")return new Nt((r,a)=>{e.then(r,a)});var t=new Nt(Tf,!0,e);return K_(t,Y1),t},reject:ep,race:function(){var e=qo.apply(null,arguments).map(tp);return new Nt((t,r)=>{e.map(a=>Nt.resolve(a).then(t,r))})},PSD:{get:()=>Pt,set:e=>Pt=e},totalEchoes:{get:()=>vh},newPSD:rc,usePSD:zd,scheduler:{get:()=>af,set:e=>{af=e}},rejectionMapper:{get:()=>W1,set:e=>{W1=e}},follow:(e,t)=>new Nt((r,a)=>rc((n,s)=>{var o=Pt;o.unhandleds=[],o.onunhandled=s,o.finalize=al(function(){(function(A){function c(){A(),eh.splice(eh.indexOf(c),1)}eh.push(c),++zc,af(()=>{--zc==0&&E2()},[])})(()=>{this.unhandleds.length===0?n():s(this.unhandleds[0])})},o.finalize),e()},t,r,a))}),Jp&&(Jp.allSettled&&$o(Nt,"allSettled",function(){const e=qo.apply(null,arguments).map(tp);return new Nt(t=>{e.length===0&&t([]);let r=e.length;const a=new Array(r);e.forEach((n,s)=>Nt.resolve(n).then(o=>a[s]={status:"fulfilled",value:o},o=>a[s]={status:"rejected",reason:o}).then(()=>--r||t(a)))})}),Jp.any&&typeof AggregateError<"u"&&$o(Nt,"any",function(){const e=qo.apply(null,arguments).map(tp);return new Nt((t,r)=>{e.length===0&&r(new AggregateError([]));let a=e.length;const n=new Array(a);e.forEach((s,o)=>Nt.resolve(s).then(A=>t(A),A=>{n[o]=A,--a||r(new AggregateError(n))}))})}));const Vn={awaits:0,echoes:0,id:0};var XO=0,th=[],gg=0,vh=0,JO=0;function rc(e,t,r,a){var n=Pt,s=Object.create(n);s.parent=n,s.ref=0,s.global=!1,s.id=++JO;var o=Cd.env;s.env=v2?{Promise:Nt,PromiseProp:{value:Nt,configurable:!0,writable:!0},all:Nt.all,race:Nt.race,allSettled:Nt.allSettled,any:Nt.any,resolve:Nt.resolve,reject:Nt.reject,nthen:Ov(o.nthen,s),gthen:Ov(o.gthen,s)}:{},t&&mi(s,t),++n.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var A=zd(s,e,r,a);return s.ref===0&&s.finalize(),A}function Gd(){return Vn.id||(Vn.id=++XO),++Vn.awaits,Vn.echoes+=L_,Vn.id}function rA(){return!!Vn.awaits&&(--Vn.awaits==0&&(Vn.id=0),Vn.echoes=Vn.awaits*L_,!0)}function tp(e){return Vn.echoes&&e&&e.constructor===Jp?(Gd(),e.then(t=>(rA(),t),t=>(rA(),An(t)))):e}function ZO(e){++vh,Vn.echoes&&--Vn.echoes!=0||(Vn.echoes=Vn.id=0),th.push(Pt),ac(e,!0)}function eI(){var e=th[th.length-1];th.pop(),ac(e,!1)}function ac(e,t){var r=Pt;if((t?!Vn.echoes||gg++&&e===Pt:!gg||--gg&&e===Pt)||G_(t?ZO.bind(null,e):eI),e!==Pt&&(Pt=e,r===Cd&&(Cd.env=H_()),v2)){var a=Cd.env.Promise,n=e.env;xh.then=n.nthen,a.prototype.then=n.gthen,(r.global||e.global)&&(Object.defineProperty(ia,"Promise",n.PromiseProp),a.all=n.all,a.race=n.race,a.resolve=n.resolve,a.reject=n.reject,n.allSettled&&(a.allSettled=n.allSettled),n.any&&(a.any=n.any))}}function H_(){var e=ia.Promise;return v2?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(ia,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:xh.then,gthen:e.prototype.then}:{}}function zd(e,t,r,a,n){var s=Pt;try{return ac(e,!0),t(r,a,n)}finally{ac(s,!1)}}function G_(e){U_.call(G1,e)}function wh(e,t,r,a){return typeof e!="function"?e:function(){var n=Pt;r&&Gd(),ac(t,!0);try{return e.apply(this,arguments)}finally{ac(n,!1),a&&G_(rA)}}}function Ov(e,t){return function(r,a){return e.call(this,wh(r,t),wh(a,t))}}(""+U_).indexOf("[native code]")===-1&&(Gd=rA=Wr);const Iv="unhandledrejection";function Nv(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var a,n={promise:t,reason:e};if(ia.document&&document.createEvent?((a=document.createEvent("Event")).initEvent(Iv,!0,!0),mi(a,n)):ia.CustomEvent&&mi(a=new CustomEvent(Iv,{detail:n}),n),a&&ia.dispatchEvent&&(dispatchEvent(a),!ia.PromiseRejectionEvent&&ia.onunhandledrejection))try{ia.onunhandledrejection(a)}catch{}go&&a&&!a.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var An=Nt.reject;function Z1(e,t,r,a){if(e.idbdb&&(e._state.openComplete||Pt.letThrough||e._vip)){var n=e._createTransaction(t,r,e._dbSchema);try{n.create(),e._state.PR1398_maxLoop=3}catch(s){return s.name===x2.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>Z1(e,t,r,a))):An(s)}return n._promise(t,(s,o)=>rc(()=>(Pt.trans=n,a(s,o,n)))).then(s=>n._completion.then(()=>s))}if(e._state.openComplete)return An(new Wt.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return An(new Wt.DatabaseClosed);e.open().catch(Wr)}return e._state.dbReadyPromise.then(()=>Z1(e,t,r,a))}const Fv="3.2.7",Mc="￿",ex=-1/0,Do="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",z_="String expected.",nf=[],um=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),tI=um,rI=um,V_=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),fm="__dbnames",xg="readonly",yg="readwrite";function nl(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const $_={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function rp(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=t0(t))[e],t)}let aI=class{_trans(t,r,a){const n=this._tx||Pt.trans,s=this.name;function o(c,l,d){if(!d.schema[s])throw new Wt.NotFound("Table "+s+" not part of transaction");return r(d.idbtrans,d)}const A=r0();try{return n&&n.db===this.db?n===Pt.trans?n._promise(t,o,a):rc(()=>n._promise(t,o,a),{trans:n,transless:Pt.transless||Pt}):Z1(this.db,t,[this.name],o)}finally{A&&a0()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",a=>this.core.get({trans:a,key:t}).then(n=>this.hook.reading.fire(n))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Wn(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Xa(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const a=this.schema.indexes.concat(this.schema.primKey).filter(l=>{if(l.compound&&r.every(d=>l.keyPath.indexOf(d)>=0)){for(let d=0;d<r.length;++d)if(r.indexOf(l.keyPath[d])===-1)return!1;return!0}return!1}).sort((l,d)=>l.keyPath.length-d.keyPath.length)[0];if(a&&this.db._maxKey!==Mc){const l=a.keyPath.slice(0,r.length);return this.where(l).equals(l.map(d=>t[d]))}!a&&go&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:n}=this.schema,s=this.db._deps.indexedDB;function o(l,d){try{return s.cmp(l,d)===0}catch{return!1}}const[A,c]=r.reduce(([l,d],f)=>{const p=n[f],u=t[f];return[l||p,l||!p?nl(d,p&&p.multi?g=>{const h=Yo(g,f);return Wn(h)&&h.some(y=>o(u,y))}:g=>o(u,Yo(g,f))):d]},[null,null]);return A?this.where(A.name).equals(t[A.keyPath]).filter(c):a?this.filter(c):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Wn(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=a=>{if(!a)return a;const n=Object.create(t.prototype);for(var s in a)if(ts(a,s))try{n[s]=a[s]}catch{}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){mi(this,t)})}add(t,r){const{auto:a,keyPath:n}=this.schema.primKey;let s=t;return n&&a&&(s=rp(n)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:r!=null?[r]:null,values:[s]})).then(o=>o.numFailures?Nt.reject(o.failures[0]):o.lastResult).then(o=>{if(n)try{Hs(t,n,o)}catch{}return o})}update(t,r){if(typeof t!="object"||Wn(t))return this.where(":id").equals(t).modify(r);{const a=Yo(t,this.schema.primKey.keyPath);if(a===void 0)return An(new Wt.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Xa(r).forEach(n=>{Hs(t,n,r[n])}):r(t,{value:t,primKey:a})}catch{}return this.where(":id").equals(a).modify(r)}}put(t,r){const{auto:a,keyPath:n}=this.schema.primKey;let s=t;return n&&a&&(s=rp(n)(t)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[s],keys:r!=null?[r]:null})).then(o=>o.numFailures?Nt.reject(o.failures[0]):o.lastResult).then(o=>{if(n)try{Hs(t,n,o)}catch{}return o})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?Nt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:$_})).then(t=>t.numFailures?Nt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(a=>a.map(n=>this.hook.reading.fire(n))))}bulkAdd(t,r,a){const n=Array.isArray(r)?r:void 0,s=(a=a||(n?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:A,keyPath:c}=this.schema.primKey;if(c&&n)throw new Wt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Wt.InvalidArgument("Arguments objects and keys must have the same length");const l=t.length;let d=c&&A?t.map(rp(c)):t;return this.core.mutate({trans:o,type:"add",keys:n,values:d,wantResults:s}).then(({numFailures:f,results:p,lastResult:u,failures:g})=>{if(f===0)return s?p:u;throw new rf(`${this.name}.bulkAdd(): ${f} of ${l} operations failed`,g)})})}bulkPut(t,r,a){const n=Array.isArray(r)?r:void 0,s=(a=a||(n?void 0:r))?a.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:A,keyPath:c}=this.schema.primKey;if(c&&n)throw new Wt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(n&&n.length!==t.length)throw new Wt.InvalidArgument("Arguments objects and keys must have the same length");const l=t.length;let d=c&&A?t.map(rp(c)):t;return this.core.mutate({trans:o,type:"put",keys:n,values:d,wantResults:s}).then(({numFailures:f,results:p,lastResult:u,failures:g})=>{if(f===0)return s?p:u;throw new rf(`${this.name}.bulkPut(): ${f} of ${l} operations failed`,g)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",a=>this.core.mutate({trans:a,type:"delete",keys:t})).then(({numFailures:a,lastResult:n,failures:s})=>{if(a===0)return n;throw new rf(`${this.name}.bulkDelete(): ${a} of ${r} operations failed`,s)})}};function sf(e){var t={},r=function(o,A){if(A){for(var c=arguments.length,l=new Array(c-1);--c;)l[c-1]=arguments[c];return t[o].subscribe.apply(null,l),e}if(typeof o=="string")return t[o]};r.addEventType=s;for(var a=1,n=arguments.length;a<n;++a)s(arguments[a]);return r;function s(o,A,c){if(typeof o!="object"){var l;A||(A=$O),c||(c=Wr);var d={subscribers:[],fire:c,subscribe:function(f){d.subscribers.indexOf(f)===-1&&(d.subscribers.push(f),d.fire=A(d.fire,f))},unsubscribe:function(f){d.subscribers=d.subscribers.filter(function(p){return p!==f}),d.fire=d.subscribers.reduce(A,c)}};return t[o]=r[o]=d,d}Xa(l=o).forEach(function(f){var p=l[f];if(Wn(p))s(f,l[f][0],l[f][1]);else{if(p!=="asap")throw new Wt.InvalidArgument("Invalid event config");var u=s(f,Sf,function(){for(var g=arguments.length,h=new Array(g);g--;)h[g]=arguments[g];u.subscribers.forEach(function(y){T_(function(){y.apply(null,h)})})})}})}}function Bu(e,t){return _d(t).from({prototype:e}),t}function Hl(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function vg(e,t){e.filter=nl(e.filter,t)}function wg(e,t,r){var a=e.replayFilter;e.replayFilter=a?()=>nl(a(),t()):t,e.justLimit=r&&!a}function rh(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Wt.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Rv(e,t,r){const a=rh(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:a,range:e.range}})}function ap(e,t,r,a){const n=e.replayFilter?nl(e.filter,e.replayFilter()):e.filter;if(e.or){const s={},o=(A,c,l)=>{if(!n||n(c,l,p=>c.stop(p),p=>c.fail(p))){var d=c.primaryKey,f=""+d;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(d)),ts(s,f)||(s[f]=!0,t(A,c,l))}};return Promise.all([e.or._iterate(o,r),kv(Rv(e,a,r),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return kv(Rv(e,a,r),nl(e.algorithm,n),t,!e.keysOnly&&e.valueMapper)}function kv(e,t,r,a){var n=ua(a?(s,o,A)=>r(a(s),o,A):r);return e.then(s=>{if(s)return s.start(()=>{var o=()=>s.continue();t&&!t(s,A=>o=A,A=>{s.stop(A),o=Wr},A=>{s.fail(A),o=Wr})||n(s.value,s,A=>o=A),o()})})}function hi(e,t){try{const r=Dv(e),a=Dv(t);if(r!==a)return r==="Array"?1:a==="Array"?-1:r==="binary"?1:a==="binary"?-1:r==="string"?1:a==="string"?-1:r==="Date"?1:a!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(n,s){const o=n.length,A=s.length,c=o<A?o:A;for(let l=0;l<c;++l)if(n[l]!==s[l])return n[l]<s[l]?-1:1;return o===A?0:o<A?-1:1}(jv(e),jv(t));case"Array":return function(n,s){const o=n.length,A=s.length,c=o<A?o:A;for(let l=0;l<c;++l){const d=hi(n[l],s[l]);if(d!==0)return d}return o===A?0:o<A?-1:1}(e,t)}}catch{}return NaN}function Dv(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=q1(e);return r==="ArrayBuffer"?"binary":r}function jv(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}let nI=class{_read(t,r){var a=this._ctx;return a.error?a.table._trans(null,An.bind(null,a.error)):a.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,An.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=nl(r.algorithm,t)}_iterate(t,r){return ap(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),a=Object.create(this._ctx);return t&&mi(a,t),r._ctx=a,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(a=>ap(r,t,a,r.table.core))}count(t){return this._read(r=>{const a=this._ctx,n=a.table.core;if(Hl(a,!0))return n.count({trans:r,query:{index:rh(a,n.schema),range:a.range}}).then(o=>Math.min(o,a.limit));var s=0;return ap(a,()=>(++s,!1),r,n).then(()=>s)}).then(t)}sortBy(t,r){const a=t.split(".").reverse(),n=a[0],s=a.length-1;function o(l,d){return d?o(l[a[d]],d-1):l[n]}var A=this._ctx.dir==="next"?1:-1;function c(l,d){var f=o(l,s),p=o(d,s);return f<p?-A:f>p?A:0}return this.toArray(function(l){return l.sort(c)}).then(r)}toArray(t){return this._read(r=>{var a=this._ctx;if(a.dir==="next"&&Hl(a,!0)&&a.limit>0){const{valueMapper:n}=a,s=rh(a,a.table.core.schema);return a.table.core.query({trans:r,limit:a.limit,values:!0,query:{index:s,range:a.range}}).then(({result:o})=>n?o.map(n):o)}{const n=[];return ap(a,s=>n.push(s),r,a.table.core).then(()=>n)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,Hl(r)?wg(r,()=>{var a=t;return(n,s)=>a===0||(a===1?(--a,!1):(s(()=>{n.advance(a),a=0}),!1))}):wg(r,()=>{var a=t;return()=>--a<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),wg(this._ctx,()=>{var r=t;return function(a,n,s){return--r<=0&&n(s),r>=0}},!0),this}until(t,r){return vg(this._ctx,function(a,n,s){return!t(a.value)||(n(s),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,a;return vg(this._ctx,function(n){return t(n.value)}),r=this._ctx,a=t,r.isMatch=nl(r.isMatch,a),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,n){t(n.key,n)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(a,n){t(n.primaryKey,n)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var a=[];return this.each(function(n,s){a.push(s.key)}).then(function(){return a}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&Hl(r,!0)&&r.limit>0)return this._read(n=>{var s=rh(r,r.table.core.schema);return r.table.core.query({trans:n,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(({result:n})=>n).then(t);r.keysOnly=!r.isMatch;var a=[];return this.each(function(n,s){a.push(s.primaryKey)}).then(function(){return a}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var a={};return vg(this._ctx,function(n){var s=n.primaryKey.toString(),o=ts(a,s);return a[s]=!0,!o}),this}modify(t){var r=this._ctx;return this._write(a=>{var n;if(typeof t=="function")n=t;else{var s=Xa(t),o=s.length;n=function(h){for(var y=!1,x=0;x<o;++x){var v=s[x],E=t[v];Yo(h,v)!==E&&(Hs(h,v,E),y=!0)}return y}}const A=r.table.core,{outbound:c,extractKey:l}=A.schema.primaryKey,d=this.db._options.modifyChunkSize||200,f=[];let p=0;const u=[],g=(h,y)=>{const{failures:x,numFailures:v}=y;p+=h-v;for(let E of Xa(x))f.push(x[E])};return this.clone().primaryKeys().then(h=>{const y=x=>{const v=Math.min(d,h.length-x);return A.getMany({trans:a,keys:h.slice(x,x+v),cache:"immutable"}).then(E=>{const D=[],B=[],I=c?[]:null,_=[];for(let O=0;O<v;++O){const M=E[O],T={value:t0(M),primKey:h[x+O]};n.call(T,T.value,T)!==!1&&(T.value==null?_.push(h[x+O]):c||hi(l(M),l(T.value))===0?(B.push(T.value),c&&I.push(h[x+O])):(_.push(h[x+O]),D.push(T.value)))}const S=Hl(r)&&r.limit===1/0&&(typeof t!="function"||t===Eg)&&{index:r.index,range:r.range};return Promise.resolve(D.length>0&&A.mutate({trans:a,type:"add",values:D}).then(O=>{for(let M in O.failures)_.splice(parseInt(M),1);g(D.length,O)})).then(()=>(B.length>0||S&&typeof t=="object")&&A.mutate({trans:a,type:"put",keys:I,values:B,criteria:S,changeSpec:typeof t!="function"&&t}).then(O=>g(B.length,O))).then(()=>(_.length>0||S&&t===Eg)&&A.mutate({trans:a,type:"delete",keys:_,criteria:S}).then(O=>g(_.length,O))).then(()=>h.length>x+v&&y(x+d))})};return y(0).then(()=>{if(f.length>0)throw new gh("Error modifying one or more objects",f,p,u);return h.length})})})}delete(){var t=this._ctx,r=t.range;return Hl(t)&&(t.isPrimKey&&!rI||r.type===3)?this._write(a=>{const{primaryKey:n}=t.table.core.schema,s=r;return t.table.core.count({trans:a,query:{index:n,range:s}}).then(o=>t.table.core.mutate({trans:a,type:"deleteRange",range:s}).then(({failures:A,lastResult:c,results:l,numFailures:d})=>{if(d)throw new gh("Could not delete some values",Object.keys(A).map(f=>A[f]),o-d);return o-d}))}):this.modify(Eg)}};const Eg=(e,t)=>t.value=null;function iI(e,t){return e<t?-1:e===t?0:1}function sI(e,t){return e>t?-1:e===t?0:1}function Hi(e,t,r){var a=e instanceof W_?new e.Collection(e):e;return a._ctx.error=r?new r(t):new TypeError(t),a}function Gl(e){return new e.Collection(e,()=>Y_("")).limit(0)}function oI(e,t,r,a,n,s){for(var o=Math.min(e.length,a.length),A=-1,c=0;c<o;++c){var l=t[c];if(l!==a[c])return n(e[c],r[c])<0?e.substr(0,c)+r[c]+r.substr(c+1):n(e[c],a[c])<0?e.substr(0,c)+a[c]+r.substr(c+1):A>=0?e.substr(0,A)+t[A]+r.substr(A+1):null;n(e[c],l)<0&&(A=c)}return o<a.length&&s==="next"?e+r.substr(e.length):o<e.length&&s==="prev"?e.substr(0,r.length):A<0?null:e.substr(0,A)+a[A]+r.substr(A+1)}function np(e,t,r,a){var n,s,o,A,c,l,d,f=r.length;if(!r.every(h=>typeof h=="string"))return Hi(e,z_);function p(h){n=function(x){return x==="next"?v=>v.toUpperCase():v=>v.toLowerCase()}(h),s=function(x){return x==="next"?v=>v.toLowerCase():v=>v.toUpperCase()}(h),o=h==="next"?iI:sI;var y=r.map(function(x){return{lower:s(x),upper:n(x)}}).sort(function(x,v){return o(x.lower,v.lower)});A=y.map(function(x){return x.upper}),c=y.map(function(x){return x.lower}),l=h,d=h==="next"?"":a}p("next");var u=new e.Collection(e,()=>IA(A[0],c[f-1]+a));u._ondirectionchange=function(h){p(h)};var g=0;return u._addAlgorithm(function(h,y,x){var v=h.key;if(typeof v!="string")return!1;var E=s(v);if(t(E,c,g))return!0;for(var D=null,B=g;B<f;++B){var I=oI(v,E,A[B],c[B],o,l);I===null&&D===null?g=B+1:(D===null||o(D,I)>0)&&(D=I)}return y(D!==null?function(){h.continue(D+d)}:x),!1}),u}function IA(e,t,r,a){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:a}}function Y_(e){return{type:1,lower:e,upper:e}}class W_{get Collection(){return this._ctx.table.db.Collection}between(t,r,a,n){a=a!==!1,n=n===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(a||n)&&(!a||!n)?Gl(this):new this.Collection(this,()=>IA(t,r,!a,!n))}catch{return Hi(this,Do)}}equals(t){return t==null?Hi(this,Do):new this.Collection(this,()=>Y_(t))}above(t){return t==null?Hi(this,Do):new this.Collection(this,()=>IA(t,void 0,!0))}aboveOrEqual(t){return t==null?Hi(this,Do):new this.Collection(this,()=>IA(t,void 0,!1))}below(t){return t==null?Hi(this,Do):new this.Collection(this,()=>IA(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Hi(this,Do):new this.Collection(this,()=>IA(void 0,t))}startsWith(t){return typeof t!="string"?Hi(this,z_):this.between(t,t+Mc,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):np(this,(r,a)=>r.indexOf(a[0])===0,[t],Mc)}equalsIgnoreCase(t){return np(this,(r,a)=>r===a[0],[t],"")}anyOfIgnoreCase(){var t=qo.apply(ud,arguments);return t.length===0?Gl(this):np(this,(r,a)=>a.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=qo.apply(ud,arguments);return t.length===0?Gl(this):np(this,(r,a)=>a.some(n=>r.indexOf(n)===0),t,Mc)}anyOf(){const t=qo.apply(ud,arguments);let r=this._cmp;try{t.sort(r)}catch{return Hi(this,Do)}if(t.length===0)return Gl(this);const a=new this.Collection(this,()=>IA(t[0],t[t.length-1]));a._ondirectionchange=s=>{r=s==="next"?this._ascending:this._descending,t.sort(r)};let n=0;return a._addAlgorithm((s,o,A)=>{const c=s.key;for(;r(c,t[n])>0;)if(++n,n===t.length)return o(A),!1;return r(c,t[n])===0||(o(()=>{s.continue(t[n])}),!1)}),a}notEqual(t){return this.inAnyRange([[ex,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=qo.apply(ud,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Hi(this,Do)}const r=t.reduce((a,n)=>a?a.concat([[a[a.length-1][1],n]]):[[ex,n]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const a=this._cmp,n=this._ascending,s=this._descending,o=this._min,A=this._max;if(t.length===0)return Gl(this);if(!t.every(v=>v[0]!==void 0&&v[1]!==void 0&&n(v[0],v[1])<=0))return Hi(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Wt.InvalidArgument);const c=!r||r.includeLowers!==!1,l=r&&r.includeUppers===!0;let d,f=n;function p(v,E){return f(v[0],E[0])}try{d=t.reduce(function(v,E){let D=0,B=v.length;for(;D<B;++D){const I=v[D];if(a(E[0],I[1])<0&&a(E[1],I[0])>0){I[0]=o(I[0],E[0]),I[1]=A(I[1],E[1]);break}}return D===B&&v.push(E),v},[]),d.sort(p)}catch{return Hi(this,Do)}let u=0;const g=l?v=>n(v,d[u][1])>0:v=>n(v,d[u][1])>=0,h=c?v=>s(v,d[u][0])>0:v=>s(v,d[u][0])>=0;let y=g;const x=new this.Collection(this,()=>IA(d[0][0],d[d.length-1][1],!c,!l));return x._ondirectionchange=v=>{v==="next"?(y=g,f=n):(y=h,f=s),d.sort(p)},x._addAlgorithm((v,E,D)=>{for(var B=v.key;y(B);)if(++u,u===d.length)return E(D),!1;return!!function(I){return!g(I)&&!h(I)}(B)||(this._cmp(B,d[u][1])===0||this._cmp(B,d[u][0])===0||E(()=>{f===n?v.continue(d[u][0]):v.continue(d[u][1])}),!1)}),x}startsWithAnyOf(){const t=qo.apply(ud,arguments);return t.every(r=>typeof r=="string")?t.length===0?Gl(this):this.inAnyRange(t.map(r=>[r,r+Mc])):Hi(this,"startsWithAnyOf() only works with strings")}}function co(e){return ua(function(t){return Of(t),e(t.target.error),!1})}function Of(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const If="storagemutated",LA="x-storagemutated-1",nc=sf(null,If);class AI{_lock(){return Pu(!Pt.global),++this._reculock,this._reculock!==1||Pt.global||(Pt.lockOwnerFor=this),this}_unlock(){if(Pu(!Pt.global),--this._reculock==0)for(Pt.global||(Pt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{zd(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Pt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,a=this.db._state.dbOpenError;if(Pu(!this.idbtrans),!t&&!r)switch(a&&a.name){case"DatabaseClosedError":throw new Wt.DatabaseClosed(a);case"MissingAPIError":throw new Wt.MissingAPI(a.message,a);default:throw new Wt.OpenFailed(a)}if(!this.active)throw new Wt.TransactionInactive;return Pu(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ua(n=>{Of(n),this._reject(t.error)}),t.onabort=ua(n=>{Of(n),this.active&&this._reject(new Wt.Abort(t.error)),this.active=!1,this.on("abort").fire(n)}),t.oncomplete=ua(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&nc.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,a){if(t==="readwrite"&&this.mode!=="readwrite")return An(new Wt.ReadOnly("Transaction is readonly"));if(!this.active)return An(new Wt.TransactionInactive);if(this._locked())return new Nt((s,o)=>{this._blockedFuncs.push([()=>{this._promise(t,r,a).then(s,o)},Pt])});if(a)return rc(()=>{var s=new Nt((o,A)=>{this._lock();const c=r(o,A,this);c&&c.then&&c.then(o,A)});return s.finally(()=>this._unlock()),s._lib=!0,s});var n=new Nt((s,o)=>{var A=r(s,o,this);A&&A.then&&A.then(s,o)});return n._lib=!0,n}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const a=Nt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>a);else{r._waitingFor=a,r._waitingQueue=[];var n=r.idbtrans.objectStore(r.storeNames[0]);(function o(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(n.get(-1/0).onsuccess=o)})()}var s=r._waitingFor;return new Nt((o,A)=>{a.then(c=>r._waitingQueue.push(ua(o.bind(null,c))),c=>r._waitingQueue.push(ua(A.bind(null,c)))).finally(()=>{r._waitingFor===s&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Wt.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(ts(r,t))return r[t];const a=this.schema[t];if(!a)throw new Wt.NotFound("Table "+t+" not part of transaction");const n=new this.db.Table(t,a,this);return n.core=this.db.core.table(t),r[t]=n,n}}function tx(e,t,r,a,n,s,o){return{name:e,keyPath:t,unique:r,multi:a,auto:n,compound:s,src:(r&&!o?"&":"")+(a?"*":"")+(n?"++":"")+X_(t)}}function X_(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function J_(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:O_(r,a=>[a.name,a])}}let Nf=e=>{try{return e.only([[]]),Nf=()=>[[]],[[]]}catch{return Nf=()=>Mc,Mc}};function rx(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?a=>a[t]:a=>Yo(a,t)}(e):t=>Yo(t,e)}function Lv(e){return[].slice.call(e)}let cI=0;function of(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function lI(e,t,r){function a(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:l,upper:d,lowerOpen:f,upperOpen:p}=c;return l===void 0?d===void 0?null:t.upperBound(d,!!p):d===void 0?t.lowerBound(l,!!f):t.bound(l,d,!!f,!!p)}const{schema:n,hasGetAll:s}=function(c,l){const d=Lv(c.objectStoreNames);return{schema:{name:c.name,tables:d.map(f=>l.objectStore(f)).map(f=>{const{keyPath:p,autoIncrement:u}=f,g=Wn(p),h=p==null,y={},x={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:g,keyPath:p,autoIncrement:u,unique:!0,extractKey:rx(p)},indexes:Lv(f.indexNames).map(v=>f.index(v)).map(v=>{const{name:E,unique:D,multiEntry:B,keyPath:I}=v,_={name:E,compound:Wn(I),keyPath:I,unique:D,multiEntry:B,extractKey:rx(I)};return y[of(I)]=_,_}),getIndexByKeyPath:v=>y[of(v)]};return y[":id"]=x.primaryKey,p!=null&&(y[of(p)]=x.primaryKey),x})},hasGetAll:d.length>0&&"getAll"in l.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),o=n.tables.map(c=>function(l){const d=l.name;return{name:d,schema:l,mutate:function({trans:f,type:p,keys:u,values:g,range:h}){return new Promise((y,x)=>{y=ua(y);const v=f.objectStore(d),E=v.keyPath==null,D=p==="put"||p==="add";if(!D&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:B}=u||g||{length:1};if(u&&g&&u.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(B===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let I;const _=[],S=[];let O=0;const M=R=>{++O,Of(R)};if(p==="deleteRange"){if(h.type===4)return y({numFailures:O,failures:S,results:[],lastResult:void 0});h.type===3?_.push(I=v.clear()):_.push(I=v.delete(a(h)))}else{const[R,L]=D?E?[g,u]:[g,null]:[u,null];if(D)for(let N=0;N<B;++N)_.push(I=L&&L[N]!==void 0?v[p](R[N],L[N]):v[p](R[N])),I.onerror=M;else for(let N=0;N<B;++N)_.push(I=v[p](R[N])),I.onerror=M}const T=R=>{const L=R.target.result;_.forEach((N,P)=>N.error!=null&&(S[P]=N.error)),y({numFailures:O,failures:S,results:p==="delete"?u:_.map(N=>N.result),lastResult:L})};I.onerror=R=>{M(R),T(R)},I.onsuccess=T})},getMany:({trans:f,keys:p})=>new Promise((u,g)=>{u=ua(u);const h=f.objectStore(d),y=p.length,x=new Array(y);let v,E=0,D=0;const B=_=>{const S=_.target;x[S._pos]=S.result,++D===E&&u(x)},I=co(g);for(let _=0;_<y;++_)p[_]!=null&&(v=h.get(p[_]),v._pos=_,v.onsuccess=B,v.onerror=I,++E);E===0&&u(x)}),get:({trans:f,key:p})=>new Promise((u,g)=>{u=ua(u);const h=f.objectStore(d).get(p);h.onsuccess=y=>u(y.target.result),h.onerror=co(g)}),query:function(f){return p=>new Promise((u,g)=>{u=ua(u);const{trans:h,values:y,limit:x,query:v}=p,E=x===1/0?void 0:x,{index:D,range:B}=v,I=h.objectStore(d),_=D.isPrimaryKey?I:I.index(D.name),S=a(B);if(x===0)return u({result:[]});if(f){const O=y?_.getAll(S,E):_.getAllKeys(S,E);O.onsuccess=M=>u({result:M.target.result}),O.onerror=co(g)}else{let O=0;const M=y||!("openKeyCursor"in _)?_.openCursor(S):_.openKeyCursor(S),T=[];M.onsuccess=R=>{const L=M.result;return L?(T.push(y?L.value:L.primaryKey),++O===x?u({result:T}):void L.continue()):u({result:T})},M.onerror=co(g)}})}(s),openCursor:function({trans:f,values:p,query:u,reverse:g,unique:h}){return new Promise((y,x)=>{y=ua(y);const{index:v,range:E}=u,D=f.objectStore(d),B=v.isPrimaryKey?D:D.index(v.name),I=g?h?"prevunique":"prev":h?"nextunique":"next",_=p||!("openKeyCursor"in B)?B.openCursor(a(E),I):B.openKeyCursor(a(E),I);_.onerror=co(x),_.onsuccess=ua(S=>{const O=_.result;if(!O)return void y(null);O.___id=++cI,O.done=!1;const M=O.continue.bind(O);let T=O.continuePrimaryKey;T&&(T=T.bind(O));const R=O.advance.bind(O),L=()=>{throw new Error("Cursor not stopped")};O.trans=f,O.stop=O.continue=O.continuePrimaryKey=O.advance=()=>{throw new Error("Cursor not started")},O.fail=ua(x),O.next=function(){let N=1;return this.start(()=>N--?this.continue():this.stop()).then(()=>this)},O.start=N=>{const P=new Promise((V,ie)=>{V=ua(V),_.onerror=co(ie),O.fail=ie,O.stop=W=>{O.stop=O.continue=O.continuePrimaryKey=O.advance=L,V(W)}}),U=()=>{if(_.result)try{N()}catch(V){O.fail(V)}else O.done=!0,O.start=()=>{throw new Error("Cursor behind last entry")},O.stop()};return _.onsuccess=ua(V=>{_.onsuccess=U,U()}),O.continue=M,O.continuePrimaryKey=T,O.advance=R,U(),P},y(O)},x)})},count({query:f,trans:p}){const{index:u,range:g}=f;return new Promise((h,y)=>{const x=p.objectStore(d),v=u.isPrimaryKey?x:x.index(u.name),E=a(g),D=E?v.count(E):v.count();D.onsuccess=ua(B=>h(B.target.result)),D.onerror=co(y)})}}}(c)),A={};return o.forEach(c=>A[c.name]=c),{stack:"dbcore",transaction:e.transaction.bind(e),table(c){if(!A[c])throw new Error(`Table '${c}' not found`);return A[c]},MIN_KEY:-1/0,MAX_KEY:Nf(t),schema:n}}function ax({_novip:e},t){const r=t.db,a=function(n,s,{IDBKeyRange:o,indexedDB:A},c){return{dbcore:function(d,f){return f.reduce((p,{create:u})=>({...p,...u(p)}),d)}(lI(s,o,c),n.dbcore)}}(e._middlewares,r,e._deps,t);e.core=a.dbcore,e.tables.forEach(n=>{const s=n.name;e.core.schema.tables.some(o=>o.name===s)&&(n.core=e.core.table(s),e[s]instanceof e.Table&&(e[s].core=n.core))})}function Eh({_novip:e},t,r,a){r.forEach(n=>{const s=a[n];t.forEach(o=>{const A=h2(o,n);(!A||"value"in A&&A.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?$o(o,n,{get(){return this.table(n)},set(c){B_(this,n,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):o[n]=new e.Table(n,s))})})}function nx({_novip:e},t){t.forEach(r=>{for(let a in r)r[a]instanceof e.Table&&delete r[a]})}function dI(e,t){return e._cfg.version-t._cfg.version}function uI(e,t,r,a){const n=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,n);s.create(r),s._completion.catch(a);const o=s._reject.bind(s),A=Pt.transless||Pt;rc(()=>{Pt.trans=s,Pt.transless=A,t===0?(Xa(n).forEach(c=>{_g(r,c,n[c].primKey,n[c].indexes)}),ax(e,r),Nt.follow(()=>e.on.populate.fire(s)).catch(o)):function({_novip:c},l,d,f){const p=[],u=c._versions;let g=c._dbSchema=sx(c,c.idbdb,f),h=!1;const y=u.filter(v=>v._cfg.version>=l);function x(){return p.length?Nt.resolve(p.shift()(d.idbtrans)).then(x):Nt.resolve()}return y.forEach(v=>{p.push(()=>{const E=g,D=v._cfg.dbschema;ox(c,E,f),ox(c,D,f),g=c._dbSchema=D;const B=Z_(E,D);B.add.forEach(_=>{_g(f,_[0],_[1].primKey,_[1].indexes)}),B.change.forEach(_=>{if(_.recreate)throw new Wt.Upgrade("Not yet support for changing primary key");{const S=f.objectStore(_.name);_.add.forEach(O=>ix(S,O)),_.change.forEach(O=>{S.deleteIndex(O.name),ix(S,O)}),_.del.forEach(O=>S.deleteIndex(O))}});const I=v._cfg.contentUpgrade;if(I&&v._cfg.version>l){ax(c,f),d._memoizedTables={},h=!0;let _=I_(D);B.del.forEach(T=>{_[T]=E[T]}),nx(c,[c.Transaction.prototype]),Eh(c,[c.Transaction.prototype],Xa(_),_),d.schema=_;const S=m2(I);let O;S&&Gd();const M=Nt.follow(()=>{if(O=I(d),O&&S){var T=rA.bind(null,null);O.then(T,T)}});return O&&typeof O.then=="function"?Nt.resolve(O):M.then(()=>O)}}),p.push(E=>{(!h||!tI)&&function(D,B){[].slice.call(B.db.objectStoreNames).forEach(I=>D[I]==null&&B.db.deleteObjectStore(I))}(v._cfg.dbschema,E),nx(c,[c.Transaction.prototype]),Eh(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),d.schema=c._dbSchema})}),x().then(()=>{var v,E;E=f,Xa(v=g).forEach(D=>{E.db.objectStoreNames.contains(D)||_g(E,D,v[D].primKey,v[D].indexes)})})}(e,t,s,r).catch(o)})}function Z_(e,t){const r={del:[],add:[],change:[]};let a;for(a in e)t[a]||r.del.push(a);for(a in t){const n=e[a],s=t[a];if(n){const o={name:a,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(n.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||n.primKey.auto!==s.primKey.auto&&!um)o.recreate=!0,r.change.push(o);else{const A=n.idxByName,c=s.idxByName;let l;for(l in A)c[l]||o.del.push(l);for(l in c){const d=A[l],f=c[l];d?d.src!==f.src&&o.change.push(f):o.add.push(f)}(o.del.length>0||o.add.length>0||o.change.length>0)&&r.change.push(o)}}else r.add.push([a,s])}return r}function _g(e,t,r,a){const n=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return a.forEach(s=>ix(n,s)),n}function ix(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function sx(e,t,r){const a={};return mh(t.objectStoreNames,0).forEach(n=>{const s=r.objectStore(n);let o=s.keyPath;const A=tx(X_(o),o||"",!1,!1,!!s.autoIncrement,o&&typeof o!="string",!0),c=[];for(let d=0;d<s.indexNames.length;++d){const f=s.index(s.indexNames[d]);o=f.keyPath;var l=tx(f.name,o,!!f.unique,!!f.multiEntry,!1,o&&typeof o!="string",!1);c.push(l)}a[n]=J_(n,A,c)}),a}function ox({_novip:e},t,r){const a=r.db.objectStoreNames;for(let n=0;n<a.length;++n){const s=a[n],o=r.objectStore(s);e._hasGetAll="getAll"in o;for(let A=0;A<o.indexNames.length;++A){const c=o.indexNames[A],l=o.index(c).keyPath,d=typeof l=="string"?l:"["+mh(l).join("+")+"]";if(t[s]){const f=t[s].idxByName[d];f&&(f.name=c,delete t[s].idxByName[d],t[s].idxByName[c]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ia.WorkerGlobalScope&&ia instanceof ia.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class fI{_parseStoresSpec(t,r){Xa(t).forEach(a=>{if(t[a]!==null){var n=t[a].split(",").map((o,A)=>{const c=(o=o.trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return tx(c,l||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),Wn(l),A===0)}),s=n.shift();if(s.multi)throw new Wt.Schema("Primary key cannot be multi-valued");n.forEach(o=>{if(o.auto)throw new Wt.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new Wt.Schema("Index must have a name and cannot be an empty string")}),r[a]=J_(a,s,n)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?mi(this._cfg.storesSource,t):t;const a=r._versions,n={};let s={};return a.forEach(o=>{mi(n,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(n,s)}),r._dbSchema=s,nx(r,[r._allTables,r,r.Transaction.prototype]),Eh(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Xa(s),s),r._storeNames=Xa(s),this}upgrade(t){return this._cfg.contentUpgrade=y2(this._cfg.contentUpgrade||Wr,t),this}}function _2(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Vc(fm,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function b2(e){return e&&typeof e.databases=="function"}function Ax(e){return rc(function(){return Pt.letThrough=!0,e()})}function pI(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function hI(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?An(t.dbOpenError):e);go&&(t.openCanceller._stackHolder=fl()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const a=t.openCanceller;function n(){if(t.openCanceller!==a)throw new Wt.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,o=null,A=!1;const c=()=>new Nt((l,d)=>{if(n(),!r)throw new Wt.MissingAPI;const f=e.name,p=t.autoSchema?r.open(f):r.open(f,Math.round(10*e.verno));if(!p)throw new Wt.MissingAPI;p.onerror=co(d),p.onblocked=ua(e._fireOnBlocked),p.onupgradeneeded=ua(u=>{if(o=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=Of,o.abort(),p.result.close();const h=r.deleteDatabase(f);h.onsuccess=h.onerror=ua(()=>{d(new Wt.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{o.onerror=co(d);var g=u.oldVersion>Math.pow(2,62)?0:u.oldVersion;A=g<1,e._novip.idbdb=p.result,uI(e,g/10,o,d)}},d),p.onsuccess=ua(()=>{o=null;const u=e._novip.idbdb=p.result,g=mh(u.objectStoreNames);if(g.length>0)try{const y=u.transaction((h=g).length===1?h[0]:h,"readonly");t.autoSchema?function({_novip:x},v,E){x.verno=v.version/10;const D=x._dbSchema=sx(0,v,E);x._storeNames=mh(v.objectStoreNames,0),Eh(x,[x._allTables],Xa(D),D)}(e,u,y):(ox(e,e._dbSchema,y),function(x,v){const E=Z_(sx(0,x.idbdb,v),x._dbSchema);return!(E.add.length||E.change.some(D=>D.add.length||D.change.length))}(e,y)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ax(e,y)}catch{}var h;nf.push(e),u.onversionchange=ua(y=>{t.vcFired=!0,e.on("versionchange").fire(y)}),u.onclose=ua(y=>{e.on("close").fire(y)}),A&&function({indexedDB:y,IDBKeyRange:x},v){!b2(y)&&v!==fm&&_2(y,x).put({name:v}).catch(Wr)}(e._deps,f),l()},d)}).catch(l=>l&&l.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):Nt.reject(l));return Nt.race([a,(typeof navigator>"u"?Nt.resolve():pI()).then(c)]).then(()=>(n(),t.onReadyBeingFired=[],Nt.resolve(Ax(()=>e.on.ready.fire(e.vip))).then(function l(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(y2,Wr);return t.onReadyBeingFired=[],Nt.resolve(Ax(()=>d(e.vip))).then(l)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(l=>{t.dbOpenError=l;try{o&&o.abort()}catch{}return a===t.openCanceller&&e._close(),An(l)}).finally(()=>{t.openComplete=!0,s()})}function cx(e){var t=s=>e.next(s),r=n(t),a=n(s=>e.throw(s));function n(s){return o=>{var A=s(o),c=A.value;return A.done?c:c&&typeof c.then=="function"?c.then(r,a):Wn(c)?Promise.all(c).then(r,a):r(c)}}return n(t)()}function mI(e,t,r){var a=arguments.length;if(a<2)throw new Wt.InvalidArgument("Too few arguments");for(var n=new Array(a-1);--a;)n[a-1]=arguments[a];return r=n.pop(),[e,N_(n),r]}function eb(e,t,r,a,n){return Nt.resolve().then(()=>{const s=Pt.transless||Pt,o=e._createTransaction(t,r,e._dbSchema,a),A={trans:o,transless:s};if(a)o.idbtrans=a.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===x2.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>eb(e,t,r,null,n))):An(f)}const c=m2(n);let l;c&&Gd();const d=Nt.follow(()=>{if(l=n.call(o,o),l)if(c){var f=rA.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=cx(l))},A);return(l&&typeof l.then=="function"?Nt.resolve(l).then(f=>o.active?f:An(new Wt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>l)).then(f=>(a&&o._resolve(),o._completion.then(()=>f))).catch(f=>(o._reject(f),An(f)))})}function ip(e,t,r){const a=Wn(e)?e.slice():[e];for(let n=0;n<r;++n)a.push(t);return a}const gI={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:a}=r,n={},s=[];function o(d,f,p){const u=of(d),g=n[u]=n[u]||[],h=d==null?0:typeof d=="string"?1:d.length,y=f>0,x={...p,isVirtual:y,keyTail:f,keyLength:h,extractKey:rx(d),unique:!y&&p.unique};return g.push(x),x.isPrimaryKey||s.push(x),h>1&&o(h===2?d[0]:d.slice(0,h-1),f+1,p),g.sort((v,E)=>v.keyTail-E.keyTail),x}const A=o(a.primaryKey.keyPath,0,a.primaryKey);n[":id"]=[A];for(const d of a.indexes)o(d.keyPath,0,d);function c(d){const f=d.query.index;return f.isVirtual?{...d,query:{index:f,range:(p=d.query.range,u=f.keyTail,{type:p.type===1?2:p.type,lower:ip(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,u),lowerOpen:!0,upper:ip(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,u),upperOpen:!0})}}:d;var p,u}return{...r,schema:{...a,primaryKey:A,indexes:s,getIndexByKeyPath:function(d){const f=n[of(d)];return f&&f[0]}},count:d=>r.count(c(d)),query:d=>r.query(c(d)),openCursor(d){const{keyTail:f,isVirtual:p,keyLength:u}=d.query.index;return p?r.openCursor(c(d)).then(g=>g&&function(h){return Object.create(h,{continue:{value:function(x){x!=null?h.continue(ip(x,d.reverse?e.MAX_KEY:e.MIN_KEY,f)):d.unique?h.continue(h.key.slice(0,u).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,f)):h.continue()}},continuePrimaryKey:{value(x,v){h.continuePrimaryKey(ip(x,e.MAX_KEY,f),v)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const x=h.key;return u===1?x[0]:x.slice(0,u)}},value:{get:()=>h.value}})}(g)):r.openCursor(d)}}}}}};function C2(e,t,r,a){return r=r||{},a=a||"",Xa(e).forEach(n=>{if(ts(t,n)){var s=e[n],o=t[n];if(typeof s=="object"&&typeof o=="object"&&s&&o){const A=q1(s);A!==q1(o)?r[a+n]=t[n]:A==="Object"?C2(s,o,r,a+n+"."):s!==o&&(r[a+n]=t[n])}else s!==o&&(r[a+n]=t[n])}else r[a+n]=void 0}),Xa(t).forEach(n=>{ts(e,n)||(r[a+n]=t[n])}),r}const xI={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:a}=r.schema;return{...r,mutate(s){const o=Pt.trans,{deleting:A,creating:c,updating:l}=o.table(t).hook;switch(s.type){case"add":if(c.fire===Wr)break;return o._promise("readwrite",()=>d(s),!0);case"put":if(c.fire===Wr&&l.fire===Wr)break;return o._promise("readwrite",()=>d(s),!0);case"delete":if(A.fire===Wr)break;return o._promise("readwrite",()=>d(s),!0);case"deleteRange":if(A.fire===Wr)break;return o._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(s),!0)}return r.mutate(s);function d(p){const u=Pt.trans,g=p.keys||function(h,y){return y.type==="delete"?y.keys:y.keys||y.values.map(h.extractKey)}(a,p);if(!g)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:g}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(h,y,x){return y.type==="add"?Promise.resolve([]):h.getMany({trans:y.trans,keys:x,cache:"immutable"})}(r,p,g).then(h=>{const y=g.map((x,v)=>{const E=h[v],D={onerror:null,onsuccess:null};if(p.type==="delete")A.fire.call(D,x,E,u);else if(p.type==="add"||E===void 0){const B=c.fire.call(D,x,p.values[v],u);x==null&&B!=null&&(x=B,p.keys[v]=x,a.outbound||Hs(p.values[v],a.keyPath,x))}else{const B=C2(E,p.values[v]),I=l.fire.call(D,B,x,E,u);if(I){const _=p.values[v];Object.keys(I).forEach(S=>{ts(_,S)?_[S]=I[S]:Hs(_,S,I[S])})}}return D});return r.mutate(p).then(({failures:x,results:v,numFailures:E,lastResult:D})=>{for(let B=0;B<g.length;++B){const I=v?v[B]:g[B],_=y[B];I==null?_.onerror&&_.onerror(x[B]):_.onsuccess&&_.onsuccess(p.type==="put"&&h[B]?p.values[B]:I)}return{failures:x,results:v,numFailures:E,lastResult:D}}).catch(x=>(y.forEach(v=>v.onerror&&v.onerror(x)),Promise.reject(x)))})}function f(p,u,g){return r.query({trans:p,values:!1,query:{index:a,range:u},limit:g}).then(({result:h})=>d({type:"delete",keys:h,trans:p}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):h.length<g?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...u,lower:h[h.length-1],lowerOpen:!0},g)))}}}}})};function tb(e,t,r){try{if(!t||t.keys.length<e.length)return null;const a=[];for(let n=0,s=0;n<t.keys.length&&s<e.length;++n)hi(t.keys[n],e[s])===0&&(a.push(r?t0(t.values[n]):t.values[n]),++s);return a.length===e.length?a:null}catch{return null}}const yI={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:a=>{if(!a.cache)return r.getMany(a);const n=tb(a.keys,a.trans._cache,a.cache==="clone");return n?Nt.resolve(n):r.getMany(a).then(s=>(a.trans._cache={keys:a.keys,values:a.cache==="clone"?t0(s):s},s))},mutate:a=>(a.type!=="add"&&(a.trans._cache=null),r.mutate(a))}}})};function B2(e){return!("from"in e)}const Qo=function(e,t){if(!this){const r=new Qo;return e&&"d"in e&&mi(r,e),r}mi(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ff(e,t,r){const a=hi(t,r);if(isNaN(a))return;if(a>0)throw RangeError();if(B2(e))return mi(e,{from:t,to:r,d:1});const n=e.l,s=e.r;if(hi(r,e.from)<0)return n?Ff(n,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Uv(e);if(hi(t,e.to)>0)return s?Ff(s,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Uv(e);hi(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),hi(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const o=!e.r;n&&!e.l&&_h(e,n),s&&o&&_h(e,s)}function _h(e,t){B2(t)||function r(a,{from:n,to:s,l:o,r:A}){Ff(a,n,s),o&&r(a,o),A&&r(a,A)}(e,t)}function vI(e,t){const r=lx(t);let a=r.next();if(a.done)return!1;let n=a.value;const s=lx(e);let o=s.next(n.from),A=o.value;for(;!a.done&&!o.done;){if(hi(A.from,n.to)<=0&&hi(A.to,n.from)>=0)return!0;hi(n.from,A.from)<0?n=(a=r.next(A.from)).value:A=(o=s.next(n.from)).value}return!1}function lx(e){let t=B2(e)?null:{s:0,n:e};return{next(r){const a=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,a)for(;t.n.l&&hi(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!a||hi(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Uv(e){var t,r;const a=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),n=a>1?"r":a<-1?"l":"";if(n){const s=n==="r"?"l":"r",o={...e},A=e[n];e.from=A.from,e.to=A.to,e[n]=A[n],o[n]=A[s],e[s]=o,o.d=Mv(o)}e.d=Mv(e)}function Mv({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Md(Qo.prototype,{add(e){return _h(this,e),this},addKey(e){return Ff(this,e,e),this},addKeys(e){return e.forEach(t=>Ff(this,t,t)),this},[K1](){return lx(this)}});const wI={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new Qo(e.MIN_KEY,e.MAX_KEY);return{...e,table:a=>{const n=e.table(a),{schema:s}=n,{primaryKey:o}=s,{extractKey:A,outbound:c}=o,l={...n,mutate:p=>{const u=p.trans,g=u.mutatedParts||(u.mutatedParts={}),h=I=>{const _=`idb://${t}/${a}/${I}`;return g[_]||(g[_]=new Qo)},y=h(""),x=h(":dels"),{type:v}=p;let[E,D]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const B=p.trans._cache;return n.mutate(p).then(I=>{if(Wn(E)){v!=="delete"&&(E=I.results),y.addKeys(E);const _=tb(E,B);_||v==="add"||x.addKeys(E),(_||D)&&function(S,O,M,T){function R(L){const N=S(L.name||"");function P(V){return V!=null?L.extractKey(V):null}const U=V=>L.multiEntry&&Wn(V)?V.forEach(ie=>N.addKey(ie)):N.addKey(V);(M||T).forEach((V,ie)=>{const W=M&&P(M[ie]),z=T&&P(T[ie]);hi(W,z)!==0&&(W!=null&&U(W),z!=null&&U(z))})}O.indexes.forEach(R)}(h,s,_,D)}else if(E){const _={from:E.lower,to:E.upper};x.add(_),y.add(_)}else y.add(r),x.add(r),s.indexes.forEach(_=>h(_.name).add(r));return I})}},d=({query:{index:p,range:u}})=>{var g,h;return[p,new Qo((g=u.lower)!==null&&g!==void 0?g:e.MIN_KEY,(h=u.upper)!==null&&h!==void 0?h:e.MAX_KEY)]},f={get:p=>[o,new Qo(p.key)],getMany:p=>[o,new Qo().addKeys(p.keys)],count:d,query:d,openCursor:d};return Xa(f).forEach(p=>{l[p]=function(u){const{subscr:g}=Pt;if(g){const h=D=>{const B=`idb://${t}/${a}/${D}`;return g[B]||(g[B]=new Qo)},y=h(""),x=h(":dels"),[v,E]=f[p](u);if(h(v.name||"").add(E),!v.isPrimaryKey){if(p!=="count"){const D=p==="query"&&c&&u.values&&n.query({...u,values:!1});return n[p].apply(this,arguments).then(B=>{if(p==="query"){if(c&&u.values)return D.then(({result:_})=>(y.addKeys(_),B));const I=u.values?B.result.map(A):B.result;u.values?y.addKeys(I):x.addKeys(I)}else if(p==="openCursor"){const I=B,_=u.values;return I&&Object.create(I,{key:{get:()=>(x.addKey(I.primaryKey),I.key)},primaryKey:{get(){const S=I.primaryKey;return x.addKey(S),S}},value:{get:()=>(_&&y.addKey(I.primaryKey),I.value)}})}return B})}x.add(r)}}return n[p].apply(this,arguments)}}),l}}}};class Vc{constructor(t,r){this._middlewares={},this.verno=0;const a=Vc.dependencies;this._options=r={addons:Vc.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:n}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Wr,dbReadyPromise:null,cancelOpen:Wr,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;s.dbReadyPromise=new Nt(A=>{s.dbReadyResolve=A}),s.openCanceller=new Nt((A,c)=>{s.cancelOpen=c}),this._state=s,this.name=t,this.on=sf(this,"populate","blocked","versionchange","close",{ready:[y2,Wr]}),this.on.ready.subscribe=S_(this.on.ready.subscribe,A=>(c,l)=>{Vc.vip(()=>{const d=this._state;if(d.openComplete)d.dbOpenError||Nt.resolve().then(c),l&&A(c);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(c),l&&A(c);else{A(c);const f=this;l||A(function p(){f.on.ready.unsubscribe(c),f.on.ready.unsubscribe(p)})}})}),this.Collection=(o=this,Bu(nI.prototype,function(A,c){this.db=o;let l=$_,d=null;if(c)try{l=c()}catch(g){d=g}const f=A._ctx,p=f.table,u=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:l,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:f.or,valueMapper:u!==Sf?u:null}})),this.Table=function(A){return Bu(aI.prototype,function(c,l,d){this.db=A,this._tx=d,this.name=c,this.schema=l,this.hook=A._allTables[c]?A._allTables[c].hook:sf(null,{creating:[GO,Wr],reading:[HO,Sf],updating:[VO,Wr],deleting:[zO,Wr]})})}(this),this.Transaction=function(A){return Bu(AI.prototype,function(c,l,d,f,p){this.db=A,this.mode=c,this.storeNames=l,this.schema=d,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=sf(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Nt((u,g)=>{this._resolve=u,this._reject=g}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},u=>{var g=this.active;return this.active=!1,this.on.error.fire(u),this.parent?this.parent._reject(u):g&&this.idbtrans&&this.idbtrans.abort(),An(u)})})}(this),this.Version=function(A){return Bu(fI.prototype,function(c){this.db=A,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(A){return Bu(W_.prototype,function(c,l,d){this.db=A,this._ctx={table:c,index:l===":id"?null:l,or:d};const f=A._deps.indexedDB;if(!f)throw new Wt.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,u)=>f.cmp(u,p),this._max=(p,u)=>f.cmp(p,u)>0?p:u,this._min=(p,u)=>f.cmp(p,u)<0?p:u,this._IDBKeyRange=A._deps.IDBKeyRange})}(this),this.on("versionchange",A=>{A.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",A=>{!A.newVersion||A.newVersion<A.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${A.oldVersion/10}`)}),this._maxKey=Nf(r.IDBKeyRange),this._createTransaction=(A,c,l,d)=>new this.Transaction(A,c,l,this._options.chromeTransactionDurability,d),this._fireOnBlocked=A=>{this.on("blocked").fire(A),nf.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(A))},this.use(gI),this.use(xI),this.use(wI),this.use(yI),this.vip=Object.create(this,{_vip:{value:!0}}),n.forEach(A=>A(this))}version(t){if(isNaN(t)||t<.1)throw new Wt.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Wt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var a=r.filter(n=>n._cfg.version===t)[0];return a||(a=new this.Version(t),r.push(a),r.sort(dI),a.stores({}),this._state.autoSchema=!1,a)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Pt.letThrough||this._vip)?t():new Nt((r,a)=>{if(this._state.openComplete)return a(new Wt.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void a(new Wt.DatabaseClosed);this.open().catch(Wr)}this._state.dbReadyPromise.then(r,a)}).then(t)}use({stack:t,create:r,level:a,name:n}){n&&this.unuse({stack:t,name:n});const s=this._middlewares[t]||(this._middlewares[t]=[]);return s.push({stack:t,create:r,level:a??10,name:n}),s.sort((o,A)=>o.level-A.level),this}unuse({stack:t,name:r,create:a}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(n=>a?n.create!==a:!!r&&n.name!==r)),this}open(){return hI(this)}_close(){const t=this._state,r=nf.indexOf(this);if(r>=0&&nf.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new Nt(a=>{t.dbReadyResolve=a}),t.openCanceller=new Nt((a,n)=>{t.cancelOpen=n})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Wt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new Nt((a,n)=>{const s=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=ua(()=>{(function({indexedDB:A,IDBKeyRange:c},l){!b2(A)&&l!==fm&&_2(A,c).delete(l).catch(Wr)})(this._deps,this.name),a()}),o.onerror=co(n),o.onblocked=this._fireOnBlocked};if(t)throw new Wt.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Xa(this._allTables).map(t=>this._allTables[t])}transaction(){const t=mI.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,a){let n=Pt.trans;n&&n.db===this&&t.indexOf("!")===-1||(n=null);const s=t.indexOf("?")!==-1;let o,A;t=t.replace("!","").replace("?","");try{if(A=r.map(l=>{var d=l instanceof this.Table?l.name:l;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),t=="r"||t===xg)o=xg;else{if(t!="rw"&&t!=yg)throw new Wt.InvalidArgument("Invalid transaction mode: "+t);o=yg}if(n){if(n.mode===xg&&o===yg){if(!s)throw new Wt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");n=null}n&&A.forEach(l=>{if(n&&n.storeNames.indexOf(l)===-1){if(!s)throw new Wt.SubTransaction("Table "+l+" not included in parent transaction.");n=null}}),s&&n&&!n.active&&(n=null)}}catch(l){return n?n._promise(null,(d,f)=>{f(l)}):An(l)}const c=eb.bind(null,this,o,A,n,a);return n?n._promise(o,c,"lock"):Pt.trans?zd(Pt.transless,()=>this._whenReady(c)):this._whenReady(c)}table(t){if(!ts(this._allTables,t))throw new Wt.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const EI=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class _I{constructor(t){this._subscribe=t}subscribe(t,r,a){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:a})}[EI](){return this}}function rb(e,t){return Xa(t).forEach(r=>{_h(e[r]||(e[r]=new Qo),t[r])}),e}function bI(e){let t,r=!1;const a=new _I(n=>{const s=m2(e);let o=!1,A={},c={};const l={get closed(){return o},unsubscribe:()=>{o=!0,nc.storagemutated.unsubscribe(u)}};n.start&&n.start(l);let d=!1,f=!1;function p(){return Xa(c).some(h=>A[h]&&vI(A[h],c[h]))}const u=h=>{rb(A,h),p()&&g()},g=()=>{if(d||o)return;A={};const h={},y=function(x){s&&Gd();const v=()=>rc(e,{subscr:x,trans:null}),E=Pt.trans?zd(Pt.transless,v):v();return s&&E.then(rA,rA),E}(h);f||(nc(If,u),f=!0),d=!0,Promise.resolve(y).then(x=>{r=!0,t=x,d=!1,o||(p()?g():(A={},c=h,n.next&&n.next(x)))},x=>{d=!1,r=!1,n.error&&n.error(x),l.unsubscribe()})};return g(),l});return a.hasValue=()=>r,a.getValue=()=>t,a}let dx;try{dx={indexedDB:ia.indexedDB||ia.mozIndexedDB||ia.webkitIndexedDB||ia.msIndexedDB,IDBKeyRange:ia.IDBKeyRange||ia.webkitIDBKeyRange}}catch{dx={indexedDB:null,IDBKeyRange:null}}const Sc=Vc;function ah(e){let t=Go;try{Go=!0,nc.storagemutated.fire(e)}finally{Go=t}}Md(Sc,{...Xp,delete:e=>new Sc(e,{addons:[]}).delete(),exists:e=>new Sc(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return b2(t)?Promise.resolve(t.databases()).then(a=>a.map(n=>n.name).filter(n=>n!==fm)):_2(t,r).toCollection().primaryKeys()}(Sc.dependencies).then(e)}catch{return An(new Wt.MissingAPI)}},defineClass:()=>function(e){mi(this,e)},ignoreTransaction:e=>Pt.trans?zd(Pt.transless,e):e(),vip:Ax,async:function(e){return function(){try{var t=cx(e.apply(this,arguments));return t&&typeof t.then=="function"?t:Nt.resolve(t)}catch(r){return An(r)}}},spawn:function(e,t,r){try{var a=cx(e.apply(r,t||[]));return a&&typeof a.then=="function"?a:Nt.resolve(a)}catch(n){return An(n)}},currentTransaction:{get:()=>Pt.trans||null},waitFor:function(e,t){const r=Nt.resolve(typeof e=="function"?Sc.ignoreTransaction(e):e).timeout(t||6e4);return Pt.trans?Pt.trans.waitFor(r):r},Promise:Nt,debug:{get:()=>go,set:e=>{R_(e,e==="dexie"?()=>!0:V_)}},derive:_d,extend:mi,props:Md,override:S_,Events:sf,on:nc,liveQuery:bI,extendObservabilitySet:rb,getByKeyPath:Yo,setByKeyPath:Hs,delByKeyPath:function(e,t){typeof t=="string"?Hs(e,t,void 0):"length"in t&&[].map.call(t,function(r){Hs(e,r,void 0)})},shallowClone:I_,deepClone:t0,getObjectDiff:C2,cmp:hi,asap:T_,minKey:ex,addons:[],connections:nf,errnames:x2,dependencies:dx,semVer:Fv,version:Fv.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),Sc.maxKey=Nf(Sc.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(nc(If,e=>{if(!Go){let t;um?(t=document.createEvent("CustomEvent"),t.initCustomEvent(LA,!0,!0,e)):t=new CustomEvent(LA,{detail:e}),Go=!0,dispatchEvent(t),Go=!1}}),addEventListener(LA,({detail:e})=>{Go||ah(e)}));let Go=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(LA);typeof e.unref=="function"&&e.unref(),nc(If,t=>{Go||e.postMessage(t)}),e.onmessage=t=>{t.data&&ah(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){nc(If,t=>{try{Go||(typeof localStorage<"u"&&localStorage.setItem(LA,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:LA,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===LA){const r=JSON.parse(t.newValue);r&&ah(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===LA&&ah(t.changedParts)})}Nt.rejectionMapper=function(e,t){if(!e||e instanceof bd||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Tv[e.name])return e;var r=new Tv[e.name](t||e.message,e);return"stack"in e&&$o(r,"stack",{get:function(){return this.inner.stack}}),r},R_(go,V_);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Rf={};Rf.version="0.18.5";var Zi=1200,il=1252,CI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],S2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pm=function(e){CI.indexOf(e)!=-1&&(il=S2[0]=e)};function BI(){pm(1252)}var Es=function(e){Zi=e,pm(e)};function hm(){Es(1200),BI()}function bh(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function SI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ab(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var yd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?SI(e.slice(2)):t==254&&r==255?ab(e.slice(2)):t==65279?e.slice(1):e},qu=function(t){return String.fromCharCode(t)},ux=function(t){return String.fromCharCode(t)},_r;function TI(e){_r=e,Es=function(t){Zi=t,pm(t)},yd=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?_r.utils.decode(1200,bh(t.slice(2))):t},qu=function(r){return Zi===1200?String.fromCharCode(r):_r.utils.decode(Zi,[r&255,r>>8])[0]},ux=function(r){return _r.utils.decode(il,[r])[0]},Fb()}var PA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kf(e){for(var t="",r=0,a=0,n=0,s=0,o=0,A=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,a=e.charCodeAt(l++),o=(r&3)<<4|a>>4,n=e.charCodeAt(l++),A=(a&15)<<2|n>>6,c=n&63,isNaN(a)?A=c=64:isNaN(n)&&(c=64),t+=PA.charAt(s)+PA.charAt(o)+PA.charAt(A)+PA.charAt(c);return t}function rs(e){var t="",r=0,a=0,n=0,s=0,o=0,A=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=PA.indexOf(e.charAt(l++)),o=PA.indexOf(e.charAt(l++)),r=s<<2|o>>4,t+=String.fromCharCode(r),A=PA.indexOf(e.charAt(l++)),a=(o&15)<<4|A>>2,A!==64&&(t+=String.fromCharCode(a)),c=PA.indexOf(e.charAt(l++)),n=(A&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var lr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),nA=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ic(e){return lr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Pv(e){return lr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $i=function(t){return lr?nA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function n0(e){if(typeof ArrayBuffer>"u")return $i(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function fc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function OI(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function T2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return T2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xn=lr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:nA(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function II(e){for(var t=[],r=0,a=e.length+250,n=ic(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var A=e.charCodeAt(++s)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|A>>6&15|(o&3)<<4,n[r++]=128|A&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=ic(65535),a=65530)}return t.push(n.slice(0,r)),xn(t)}var Xn=/\u0000/g,Ku=/[\u0001-\u0006]/g;function Bd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ks(e,t){var r=""+e;return r.length>=t?r:ba("0",t-r.length)+r}function O2(e,t){var r=""+e;return r.length>=t?r:ba(" ",t-r.length)+r}function Ch(e,t){var r=""+e;return r.length>=t?r:r+ba(" ",t-r.length)}function NI(e,t){var r=""+Math.round(e);return r.length>=t?r:ba("0",t-r.length)+r}function FI(e,t){var r=""+e;return r.length>=t?r:ba("0",t-r.length)+r}var Qv=Math.pow(2,32);function zl(e,t){if(e>Qv||e<-Qv)return NI(e,t);var r=Math.round(e);return FI(r,t)}function Bh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var qv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],bg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Kv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Sh(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,o=1,A=0,c=1,l=0,d=0,f=Math.floor(n);l<t&&(f=Math.floor(n),A=f*o+s,d=f*l+c,!(n-f<5e-8));)n=1/(n-f),s=o,o=A,c=l,l=d;if(d>t&&(l>t?(d=c,A=s):(d=l,A=o)),!r)return[0,a*A,d];var p=Math.floor(a*A/d);return[p,a*A-p*d,d]}function QA(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,o=[],A={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(A.u)<1e-6&&(A.u=0),t&&t.date1904&&(a+=1462),A.u>.9999&&(A.u=0,++n==86400&&(A.T=n=0,++a,++A.D)),a===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),r&&(s=PI(c,o))}return A.y=o[0],A.m=o[1],A.d=o[2],A.S=n%60,n=Math.floor(n/60),A.M=n%60,n=Math.floor(n/60),A.H=n,A.q=s,A}var nb=new Date(1899,11,31,0,0,0),DI=nb.getTime(),jI=new Date(1900,2,1,0,0,0);function ib(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jI&&(r+=24*60*60*1e3),(r-(DI+(e.getTimezoneOffset()-nb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function I2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function LI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function UI(e){var t=e<0?12:11,r=I2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function MI(e){var t=I2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Df(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=UI(e):t===10?r=e.toFixed(10).substr(0,12):r=MI(e),I2(LI(r.toUpperCase()))}function sl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Df(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return as(14,ib(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function PI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function QI(e,t,r,a){var n="",s=0,o=0,A=r.y,c,l=0;switch(e){case 98:A=r.y+543;case 121:switch(t.length){case 1:case 2:c=A%100,l=2;break;default:c=A%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,l=t.length;break;case 3:return bg[r.m-1][1];case 5:return bg[r.m-1][0];default:return bg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,l=t.length;break;case 3:return qv[r.q][0];default:return qv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ks(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(n=Ks(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=A,l=1;break}var d=l>0?Ks(c,l):"";return d}function qA(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var sb=/%/g;function qI(e,t,r){var a=t.replace(sb,""),n=t.length-a.length;return Wo(e,a,r*Math.pow(10,2*n))+ba("%",n)}function KI(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wo(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ob(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ob(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(A,c,l,d){return c+l+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ab=/# (\?+)( ?)\/( ?)(\d+)/;function HI(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),o=n-s*a,A=a;return r+(s===0?"":""+s)+" "+(o===0?ba(" ",e[1].length+1+e[4].length):O2(o,e[1].length)+e[2]+"/"+e[3]+Ks(A,e[4].length))}function GI(e,t,r){return r+(t===0?"":""+t)+ba(" ",e[1].length+2+e[4].length)}var cb=/^#*0*\.([0#]+)/,lb=/\).*[0#]/,db=/\(###\) ###\\?-####/;function li(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Hv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Gv(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function zI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function VI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function hs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hs("n",a,r):"("+hs("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return KI(e,t,r);if(t.indexOf("%")!==-1)return qI(e,t,r);if(t.indexOf("E")!==-1)return ob(t,r);if(t.charCodeAt(0)===36)return"$"+hs(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,A,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+zl(c,t.length);if(t.match(/^[#?]+$/))return n=zl(r,0),n==="0"&&(n=""),n.length>t.length?n:li(t.substr(0,t.length-n.length))+n;if(s=t.match(Ab))return HI(s,c,l);if(t.match(/^#+0+$/))return l+zl(c,t.length-t.indexOf("0"));if(s=t.match(cb))return n=Hv(r,s[1].length).replace(/^([^\.]+)$/,"$1."+li(s[1])).replace(/\.$/,"."+li(s[1])).replace(/\.(\d*)$/,function(g,h){return"."+h+ba("0",li(s[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+Hv(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+qA(zl(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hs(e,t,-r):qA(""+(Math.floor(r)+zI(r,s[1].length)))+"."+Ks(Gv(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return hs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Bd(hs(e,t.replace(/[\\-]/g,""),r)),o=0,Bd(Bd(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(db))return n=hs(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),A=Sh(c,Math.pow(10,o)-1,!1),n=""+l,d=Wo("n",s[1],A[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=Ch(A[2],o),d.length<s[4].length&&(d=li(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),A=Sh(c,Math.pow(10,o)-1,!0),l+(A[0]||(A[1]?"":"0"))+" "+(A[1]?O2(A[1],o)+s[2]+"/"+s[3]+Ch(A[2],o):ba(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=zl(r,0),t.length<=n.length?n:li(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,p=t.length-n.length-f;return li(t.substr(0,f)+n+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Gv(r,s[1].length),r<0?"-"+hs(e,t,-r):qA(VI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ks(0,3-g.length):"")+g})+"."+Ks(o,s[1].length);switch(t){case"###,##0.00":return hs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var u=qA(zl(c,0));return u!=="0"?l+u:"";case"###,###.00":return hs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $I(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wo(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function YI(e,t,r){var a=t.replace(sb,""),n=t.length-a.length;return Wo(e,a,r*Math.pow(10,2*n))+ba("%",n)}function ub(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ub(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(A,c,l,d){return c+l+d.substr(0,(n+s)%n)+"."+d.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function io(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?io("n",a,r):"("+io("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $I(e,t,r);if(t.indexOf("%")!==-1)return YI(e,t,r);if(t.indexOf("E")!==-1)return ub(t,r);if(t.charCodeAt(0)===36)return"$"+io(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,A,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Ks(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:li(t.substr(0,t.length-n.length))+n;if(s=t.match(Ab))return GI(s,c,l);if(t.match(/^#+0+$/))return l+Ks(c,t.length-t.indexOf("0"));if(s=t.match(cb))return n=(""+r).replace(/^([^\.]+)$/,"$1."+li(s[1])).replace(/\.$/,"."+li(s[1])),n=n.replace(/\.(\d*)$/,function(g,h){return"."+h+ba("0",li(s[1]).length-h.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+qA(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+io(e,t,-r):qA(""+r)+"."+ba("0",s[1].length);if(s=t.match(/^#,#*,#0/))return io(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Bd(io(e,t.replace(/[\\-]/g,""),r)),o=0,Bd(Bd(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(db))return n=io(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),A=Sh(c,Math.pow(10,o)-1,!1),n=""+l,d=Wo("n",s[1],A[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+s[2]+"/"+s[3],d=Ch(A[2],o),d.length<s[4].length&&(d=li(s[4].substr(s[4].length-d.length))+d),n+=d,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),A=Sh(c,Math.pow(10,o)-1,!0),l+(A[0]||(A[1]?"":"0"))+" "+(A[1]?O2(A[1],o)+s[2]+"/"+s[3]+Ch(A[2],o):ba(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:li(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,p=t.length-n.length-f;return li(t.substr(0,f)+n+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+io(e,t,-r):qA(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ks(0,3-g.length):"")+g})+"."+Ks(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var u=qA(""+c);return u!=="0"?l+u:"";default:if(t.match(/\.[0#?]*$/))return io(e,t.slice(0,t.lastIndexOf(".")),r)+li(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wo(e,t,r){return(r|0)===r?io(e,t,r):hs(e,t,r)}function WI(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var fb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Bh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(fb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function XI(e,t,r,a){for(var n=[],s="",o=0,A="",c="t",l,d,f,p="H";o<e.length;)switch(A=e.charAt(o)){case"G":if(!Bh(e,o))throw new Error("unrecognized character "+A+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);n[n.length]={t:"t",v:s},++o;break;case"\\":var u=e.charAt(++o),g=u==="("||u===")"?u:"t";n[n.length]={t:g,v:u},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(l==null&&(l=QA(t,r,e.charAt(o+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=A,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":A=A.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=QA(t,r),l==null))return"";for(s=A;++o<e.length&&e.charAt(o).toLowerCase()===A;)s+=A;A==="m"&&c.toLowerCase()==="h"&&(A="M"),A==="h"&&(A=p),n[n.length]={t:A,v:s},c=A;break;case"A":case"a":case"上":var h={t:A,v:A};if(l==null&&(l=QA(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(l!=null&&(h.v=l.H>=12?"P":"A"),h.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(l!=null&&(h.v=l.H>=12?"PM":"AM"),h.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(l!=null&&(h.v=l.H>=12?"下午":"上午"),h.t="T",o+=5,p="h"):(h.t="t",++o),l==null&&h.t==="T")return"";n[n.length]=h,c=A;break;case"[":for(s=A;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(fb)){if(l==null&&(l=QA(t,r),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",pl(e)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=A;++o<e.length&&(A=e.charAt(o))==="0";)s+=A;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=A;++o<e.length&&"0#?.,E+-%".indexOf(A=e.charAt(o))>-1;)s+=A;n[n.length]={t:"n",v:s};break;case"?":for(s=A;e.charAt(++o)===A;)s+=A;n[n.length]={t:A,v:s},c=A;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":A,v:A},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=A;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:A,v:A},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(A)===-1)throw new Error("unrecognized character "+A+" in "+e);n[n.length]={t:"t",v:A},++o;break}var y=0,x=0,v;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=p,c="h",y<1&&(y=1);break;case"s":(v=n[o].v.match(/\.0+$/))&&(x=Math.max(x,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&n[o].v.match(/[Hh]/)&&(y=1),y<2&&n[o].v.match(/[Mm]/)&&(y=2),y<3&&n[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var E="",D;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=QI(n[o].t.charCodeAt(0),n[o].v,l,x),n[o].t="t";break;case"n":case"?":for(D=o+1;n[D]!=null&&((A=n[D].t)==="?"||A==="D"||(A===" "||A==="t")&&n[D+1]!=null&&(n[D+1].t==="?"||n[D+1].t==="t"&&n[D+1].v==="/")||n[o].t==="("&&(A===" "||A==="n"||A===")")||A==="t"&&(n[D].v==="/"||n[D].v===" "&&n[D+1]!=null&&n[D+1].t=="?"));)n[o].v+=n[D].v,n[D]={v:"",t:";"},++D;E+=n[o].v,o=D-1;break;case"G":n[o].t="t",n[o].v=sl(t,r);break}var B="",I,_;if(E.length>0){E.charCodeAt(0)==40?(I=t<0&&E.charCodeAt(0)===45?-t:t,_=Wo("n",E,I)):(I=t<0&&a>1?-t:t,_=Wo("n",E,I),I<0&&n[0]&&n[0].t=="t"&&(_=_.substr(1),n[0].v="-"+n[0].v)),D=_.length-1;var S=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){S=o;break}var O=n.length;if(S===n.length&&_.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(D>=n[o].v.length-1?(D-=n[o].v.length,n[o].v=_.substr(D+1,n[o].v.length)):D<0?n[o].v="":(n[o].v=_.substr(0,D+1),D=-1),n[o].t="t",O=o);D>=0&&O<n.length&&(n[O].v=_.substr(0,D+1)+n[O].v)}else if(S!==n.length&&_.indexOf("E")===-1){for(D=_.indexOf(".")-1,o=S;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===S?n[o].v.indexOf(".")-1:n[o].v.length-1,B=n[o].v.substr(d+1);d>=0;--d)D>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(B=_.charAt(D--)+B);n[o].v=B,n[o].t="t",O=o}for(D>=0&&O<n.length&&(n[O].v=_.substr(0,D+1)+n[O].v),D=_.indexOf(".")+1,o=S;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==S)){for(d=n[o].v.indexOf(".")>-1&&o===S?n[o].v.indexOf(".")+1:0,B=n[o].v.substr(0,d);d<n[o].v.length;++d)D<_.length&&(B+=_.charAt(D++));n[o].v=B,n[o].t="t",O=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(I=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Wo(n[o].t,n[o].v,I),n[o].t="t");var M="";for(o=0;o!==n.length;++o)n[o]!=null&&(M+=n[o].v);return M}var zv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function JI(e,t){var r=WI(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(zv),A=r[1].match(zv);return Vv(t,o)?[a,r[0]]:Vv(t,A)?[a,r[1]]:[a,r[o!=null&&A!=null?2:1]]}return[a,s]}function as(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Kt)[e],a==null&&(a=r.table&&r.table[Kv[e]]||Kt[Kv[e]]),a==null&&(a=kI[e]||"General");break}if(Bh(a,0))return sl(t,r);t instanceof Date&&(t=ib(t,r.date1904));var n=JI(a,t);if(Bh(n[1]))return sl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return XI(n[1],t,r,n[0])}function po(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Kt[r]==null){t<0&&(t=r);continue}if(Kt[r]==e){t=r;break}}t<0&&(t=391)}return Kt[t]=e,t}function i0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&po(e[t],t)}function Vd(){Kt=RI()}var pb={format:as,load:po,_table:Kt,load_table:i0,parse_date_code:QA,is_date:pl,get_table:function(){return pb._table=Kt}},ZI={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function e3(e){var t=typeof e=="number"?Kt[e]:e;return t=t.replace(hb,"(\\d+)"),new RegExp("^"+t+"$")}function t3(e,t,r){var a=-1,n=-1,s=-1,o=-1,A=-1,c=-1;(t.match(hb)||[]).forEach(function(f,p){var u=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=u;break;case"d":s=u;break;case"h":o=u;break;case"s":c=u;break;case"m":o>=0?A=u:n=u;break}}),c>=0&&A==-1&&n>=0&&(A=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(A>=0?A:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&A==-1&&c==-1?l:a==-1&&n==-1&&s==-1?d:l+"T"+d}var r3=function(){var e={};e.version="1.2.0";function t(){for(var _=0,S=new Array(256),O=0;O!=256;++O)_=O,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[O]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function a(_){var S=0,O=0,M=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)T[M]=_[M];for(M=0;M!=256;++M)for(O=_[M],S=256+M;S<4096;S+=256)O=T[S]=O>>>8^_[O&255];var R=[];for(M=1;M!=16;++M)R[M-1]=typeof Int32Array<"u"?T.subarray(M*256,M*256+256):T.slice(M*256,M*256+256);return R}var n=a(r),s=n[0],o=n[1],A=n[2],c=n[3],l=n[4],d=n[5],f=n[6],p=n[7],u=n[8],g=n[9],h=n[10],y=n[11],x=n[12],v=n[13],E=n[14];function D(_,S){for(var O=S^-1,M=0,T=_.length;M<T;)O=O>>>8^r[(O^_.charCodeAt(M++))&255];return~O}function B(_,S){for(var O=S^-1,M=_.length-15,T=0;T<M;)O=E[_[T++]^O&255]^v[_[T++]^O>>8&255]^x[_[T++]^O>>16&255]^y[_[T++]^O>>>24]^h[_[T++]]^g[_[T++]]^u[_[T++]]^p[_[T++]]^f[_[T++]]^d[_[T++]]^l[_[T++]]^c[_[T++]]^A[_[T++]]^o[_[T++]]^s[_[T++]]^r[_[T++]];for(M+=15;T<M;)O=O>>>8^r[(O^_[T++])&255];return~O}function I(_,S){for(var O=S^-1,M=0,T=_.length,R=0,L=0;M<T;)R=_.charCodeAt(M++),R<128?O=O>>>8^r[(O^R)&255]:R<2048?(O=O>>>8^r[(O^(192|R>>6&31))&255],O=O>>>8^r[(O^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,L=_.charCodeAt(M++)&1023,O=O>>>8^r[(O^(240|R>>8&7))&255],O=O>>>8^r[(O^(128|R>>2&63))&255],O=O>>>8^r[(O^(128|L>>6&15|(R&3)<<4))&255],O=O>>>8^r[(O^(128|L&63))&255]):(O=O>>>8^r[(O^(224|R>>12&15))&255],O=O>>>8^r[(O^(128|R>>6&63))&255],O=O>>>8^r[(O^(128|R&63))&255]);return~O}return e.table=r,e.bstr=D,e.buf=B,e.str=I,e}(),Lt=function(){var t={};t.version="1.2.1";function r(H,Ae){for(var te=H.split("/"),Z=Ae.split("/"),se=0,ce=0,Se=Math.min(te.length,Z.length);se<Se;++se){if(ce=te[se].length-Z[se].length)return ce;if(te[se]!=Z[se])return te[se]<Z[se]?-1:1}return te.length-Z.length}function a(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:a(H.slice(0,-1));var Ae=H.lastIndexOf("/");return Ae===-1?H:H.slice(0,Ae+1)}function n(H){if(H.charAt(H.length-1)=="/")return n(H.slice(0,-1));var Ae=H.lastIndexOf("/");return Ae===-1?H:H.slice(Ae+1)}function s(H,Ae){typeof Ae=="string"&&(Ae=new Date(Ae));var te=Ae.getHours();te=te<<6|Ae.getMinutes(),te=te<<5|Ae.getSeconds()>>>1,H.write_shift(2,te);var Z=Ae.getFullYear()-1980;Z=Z<<4|Ae.getMonth()+1,Z=Z<<5|Ae.getDate(),H.write_shift(2,Z)}function o(H){var Ae=H.read_shift(2)&65535,te=H.read_shift(2)&65535,Z=new Date,se=te&31;te>>>=5;var ce=te&15;te>>>=4,Z.setMilliseconds(0),Z.setFullYear(te+1980),Z.setMonth(ce-1),Z.setDate(se);var Se=Ae&31;Ae>>>=5;var Me=Ae&63;return Ae>>>=6,Z.setHours(Ae),Z.setMinutes(Me),Z.setSeconds(Se<<1),Z}function A(H){Bn(H,0);for(var Ae={},te=0;H.l<=H.length-4;){var Z=H.read_shift(2),se=H.read_shift(2),ce=H.l+se,Se={};switch(Z){case 21589:te=H.read_shift(1),te&1&&(Se.mtime=H.read_shift(4)),se>5&&(te&2&&(Se.atime=H.read_shift(4)),te&4&&(Se.ctime=H.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}H.l=ce,Ae[Z]=Se}return Ae}var c;function l(){return c||(c={})}function d(H,Ae){if(H[0]==80&&H[1]==75)return kr(H,Ae);if((H[0]|32)==109&&(H[1]|32)==105)return vi(H,Ae);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var te=3,Z=512,se=0,ce=0,Se=0,Me=0,be=0,ke=[],Ue=H.slice(0,512);Bn(Ue,0);var ze=f(Ue);switch(te=ze[0],te){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(ze[1]==0)return kr(H,Ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}Z!==512&&(Ue=H.slice(0,Z),Bn(Ue,28));var dt=H.slice(0,Z);p(Ue,te);var pt=Ue.read_shift(4,"i");if(te===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Ue.l+=4,Se=Ue.read_shift(4,"i"),Ue.l+=4,Ue.chk("00100000","Mini Stream Cutoff Size: "),Me=Ue.read_shift(4,"i"),se=Ue.read_shift(4,"i"),be=Ue.read_shift(4,"i"),ce=Ue.read_shift(4,"i");for(var st=-1,ht=0;ht<109&&(st=Ue.read_shift(4,"i"),!(st<0));++ht)ke[ht]=st;var Qt=u(H,Z);y(be,ce,Qt,Z,ke);var xr=v(Qt,Se,ke,Z);xr[Se].name="!Directory",se>0&&Me!==L&&(xr[Me].name="!MiniFAT"),xr[ke[0]].name="!FAT",xr.fat_addrs=ke,xr.ssz=Z;var br={},xa=[],wi=[],Ei=[];E(Se,xr,Qt,xa,se,br,wi,Me),g(wi,Ei,xa),xa.shift();var Fn={FileIndex:wi,FullPaths:Ei};return Ae&&Ae.raw&&(Fn.raw={header:dt,sectors:Qt}),Fn}function f(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(N,"Header Signature: "),H.l+=16;var Ae=H.read_shift(2,"u");return[H.read_shift(2,"u"),Ae]}function p(H,Ae){var te=9;switch(H.l+=2,te=H.read_shift(2)){case 9:if(Ae!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(Ae!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function u(H,Ae){for(var te=Math.ceil(H.length/Ae)-1,Z=[],se=1;se<te;++se)Z[se-1]=H.slice(se*Ae,(se+1)*Ae);return Z[te-1]=H.slice(te*Ae),Z}function g(H,Ae,te){for(var Z=0,se=0,ce=0,Se=0,Me=0,be=te.length,ke=[],Ue=[];Z<be;++Z)ke[Z]=Ue[Z]=Z,Ae[Z]=te[Z];for(;Me<Ue.length;++Me)Z=Ue[Me],se=H[Z].L,ce=H[Z].R,Se=H[Z].C,ke[Z]===Z&&(se!==-1&&ke[se]!==se&&(ke[Z]=ke[se]),ce!==-1&&ke[ce]!==ce&&(ke[Z]=ke[ce])),Se!==-1&&(ke[Se]=Z),se!==-1&&Z!=ke[Z]&&(ke[se]=ke[Z],Ue.lastIndexOf(se)<Me&&Ue.push(se)),ce!==-1&&Z!=ke[Z]&&(ke[ce]=ke[Z],Ue.lastIndexOf(ce)<Me&&Ue.push(ce));for(Z=1;Z<be;++Z)ke[Z]===Z&&(ce!==-1&&ke[ce]!==ce?ke[Z]=ke[ce]:se!==-1&&ke[se]!==se&&(ke[Z]=ke[se]));for(Z=1;Z<be;++Z)if(H[Z].type!==0){if(Me=Z,Me!=ke[Me])do Me=ke[Me],Ae[Z]=Ae[Me]+"/"+Ae[Z];while(Me!==0&&ke[Me]!==-1&&Me!=ke[Me]);ke[Z]=-1}for(Ae[0]+="/",Z=1;Z<be;++Z)H[Z].type!==2&&(Ae[Z]+="/")}function h(H,Ae,te){for(var Z=H.start,se=H.size,ce=[],Se=Z;te&&se>0&&Se>=0;)ce.push(Ae.slice(Se*R,Se*R+R)),se-=R,Se=jc(te,Se*4);return ce.length===0?Je(0):xn(ce).slice(0,H.size)}function y(H,Ae,te,Z,se){var ce=L;if(H===L){if(Ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var Se=te[H],Me=(Z>>>2)-1;if(!Se)return;for(var be=0;be<Me&&(ce=jc(Se,be*4))!==L;++be)se.push(ce);y(jc(Se,Z-4),Ae-1,te,Z,se)}}function x(H,Ae,te,Z,se){var ce=[],Se=[];se||(se=[]);var Me=Z-1,be=0,ke=0;for(be=Ae;be>=0;){se[be]=!0,ce[ce.length]=be,Se.push(H[be]);var Ue=te[Math.floor(be*4/Z)];if(ke=be*4&Me,Z<4+ke)throw new Error("FAT boundary crossed: "+be+" 4 "+Z);if(!H[Ue])break;be=jc(H[Ue],ke)}return{nodes:ce,data:i4([Se])}}function v(H,Ae,te,Z){var se=H.length,ce=[],Se=[],Me=[],be=[],ke=Z-1,Ue=0,ze=0,dt=0,pt=0;for(Ue=0;Ue<se;++Ue)if(Me=[],dt=Ue+Ae,dt>=se&&(dt-=se),!Se[dt]){be=[];var st=[];for(ze=dt;ze>=0;){st[ze]=!0,Se[ze]=!0,Me[Me.length]=ze,be.push(H[ze]);var ht=te[Math.floor(ze*4/Z)];if(pt=ze*4&ke,Z<4+pt)throw new Error("FAT boundary crossed: "+ze+" 4 "+Z);if(!H[ht]||(ze=jc(H[ht],pt),st[ze]))break}ce[dt]={nodes:Me,data:i4([be])}}return ce}function E(H,Ae,te,Z,se,ce,Se,Me){for(var be=0,ke=Z.length?2:0,Ue=Ae[H].data,ze=0,dt=0,pt;ze<Ue.length;ze+=128){var st=Ue.slice(ze,ze+128);Bn(st,64),dt=st.read_shift(2),pt=ym(st,0,dt-ke),Z.push(pt);var ht={name:pt,type:st.read_shift(1),color:st.read_shift(1),L:st.read_shift(4,"i"),R:st.read_shift(4,"i"),C:st.read_shift(4,"i"),clsid:st.read_shift(16),state:st.read_shift(4,"i"),start:0,size:0},Qt=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);Qt!==0&&(ht.ct=D(st,st.l-8));var xr=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);xr!==0&&(ht.mt=D(st,st.l-8)),ht.start=st.read_shift(4,"i"),ht.size=st.read_shift(4,"i"),ht.size<0&&ht.start<0&&(ht.size=ht.type=0,ht.start=L,ht.name=""),ht.type===5?(be=ht.start,se>0&&be!==L&&(Ae[be].name="!StreamData")):ht.size>=4096?(ht.storage="fat",Ae[ht.start]===void 0&&(Ae[ht.start]=x(te,ht.start,Ae.fat_addrs,Ae.ssz)),Ae[ht.start].name=ht.name,ht.content=Ae[ht.start].data.slice(0,ht.size)):(ht.storage="minifat",ht.size<0?ht.size=0:be!==L&&ht.start!==L&&Ae[be]&&(ht.content=h(ht,Ae[be].data,(Ae[Me]||{}).data))),ht.content&&Bn(ht.content,0),ce[pt]=ht,Se.push(ht)}}function D(H,Ae){return new Date((gn(H,Ae+4)/1e7*Math.pow(2,32)+gn(H,Ae)/1e7-11644473600)*1e3)}function B(H,Ae){return l(),d(c.readFileSync(H),Ae)}function I(H,Ae){var te=Ae&&Ae.type;switch(te||lr&&Buffer.isBuffer(H)&&(te="buffer"),te||"base64"){case"file":return B(H,Ae);case"base64":return d($i(rs(H)),Ae);case"binary":return d($i(H),Ae)}return d(H,Ae)}function _(H,Ae){var te=Ae||{},Z=te.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=Z+"/",H.FileIndex[0]={name:Z,type:5}),te.CLSID&&(H.FileIndex[0].clsid=te.CLSID),S(H)}function S(H){var Ae="Sh33tJ5";if(!Lt.find(H,"/"+Ae)){var te=Je(4);te[0]=55,te[1]=te[3]=50,te[2]=54,H.FileIndex.push({name:Ae,type:2,content:te,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+Ae),O(H)}}function O(H,Ae){_(H);for(var te=!1,Z=!1,se=H.FullPaths.length-1;se>=0;--se){var ce=H.FileIndex[se];switch(ce.type){case 0:Z?te=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(ce.R*ce.L*ce.C)&&(te=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!Ae)){var Se=new Date(1987,1,19),Me=0,be=Object.create?Object.create(null):{},ke=[];for(se=0;se<H.FullPaths.length;++se)be[H.FullPaths[se]]=!0,H.FileIndex[se].type!==0&&ke.push([H.FullPaths[se],H.FileIndex[se]]);for(se=0;se<ke.length;++se){var Ue=a(ke[se][0]);Z=be[Ue],Z||(ke.push([Ue,{name:n(Ue).replace("/",""),type:1,clsid:U,ct:Se,mt:Se,content:null}]),be[Ue]=!0)}for(ke.sort(function(pt,st){return r(pt[0],st[0])}),H.FullPaths=[],H.FileIndex=[],se=0;se<ke.length;++se)H.FullPaths[se]=ke[se][0],H.FileIndex[se]=ke[se][1];for(se=0;se<ke.length;++se){var ze=H.FileIndex[se],dt=H.FullPaths[se];if(ze.name=n(dt).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||U,se===0)ze.C=ke.length>1?1:-1,ze.size=0,ze.type=5;else if(dt.slice(-1)=="/"){for(Me=se+1;Me<ke.length&&a(H.FullPaths[Me])!=dt;++Me);for(ze.C=Me>=ke.length?-1:Me,Me=se+1;Me<ke.length&&a(H.FullPaths[Me])!=a(dt);++Me);ze.R=Me>=ke.length?-1:Me,ze.type=1}else a(H.FullPaths[se+1]||"")==a(dt)&&(ze.R=se+1),ze.type=2}}}function M(H,Ae){var te=Ae||{};if(te.fileType=="mad")return kt(H,te);switch(O(H),te.fileType){case"zip":return Di(H,te)}var Z=function(pt){for(var st=0,ht=0,Qt=0;Qt<pt.FileIndex.length;++Qt){var xr=pt.FileIndex[Qt];if(xr.content){var br=xr.content.length;br>0&&(br<4096?st+=br+63>>6:ht+=br+511>>9)}}for(var xa=pt.FullPaths.length+3>>2,wi=st+7>>3,Ei=st+127>>7,Fn=wi+ht+xa+Ei,ji=Fn+127>>7,is=ji<=109?0:Math.ceil((ji-109)/127);Fn+ji+is+127>>7>ji;)is=++ji<=109?0:Math.ceil((ji-109)/127);var ni=[1,is,ji,Ei,xa,ht,st,0];return pt.FileIndex[0].size=st<<6,ni[7]=(pt.FileIndex[0].start=ni[0]+ni[1]+ni[2]+ni[3]+ni[4]+ni[5])+(ni[6]+7>>3),ni}(H),se=Je(Z[7]<<9),ce=0,Se=0;{for(ce=0;ce<8;++ce)se.write_shift(1,P[ce]);for(ce=0;ce<8;++ce)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),ce=0;ce<3;++ce)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,Z[2]),se.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:L),se.write_shift(4,Z[3]),se.write_shift(-4,Z[1]?Z[0]-1:L),se.write_shift(4,Z[1]),ce=0;ce<109;++ce)se.write_shift(-4,ce<Z[2]?Z[1]+ce:-1)}if(Z[1])for(Se=0;Se<Z[1];++Se){for(;ce<236+Se*127;++ce)se.write_shift(-4,ce<Z[2]?Z[1]+ce:-1);se.write_shift(-4,Se===Z[1]-1?L:Se+1)}var Me=function(pt){for(Se+=pt;ce<Se-1;++ce)se.write_shift(-4,ce+1);pt&&(++ce,se.write_shift(-4,L))};for(Se=ce=0,Se+=Z[1];ce<Se;++ce)se.write_shift(-4,V.DIFSECT);for(Se+=Z[2];ce<Se;++ce)se.write_shift(-4,V.FATSECT);Me(Z[3]),Me(Z[4]);for(var be=0,ke=0,Ue=H.FileIndex[0];be<H.FileIndex.length;++be)Ue=H.FileIndex[be],Ue.content&&(ke=Ue.content.length,!(ke<4096)&&(Ue.start=Se,Me(ke+511>>9)));for(Me(Z[6]+7>>3);se.l&511;)se.write_shift(-4,V.ENDOFCHAIN);for(Se=ce=0,be=0;be<H.FileIndex.length;++be)Ue=H.FileIndex[be],Ue.content&&(ke=Ue.content.length,!(!ke||ke>=4096)&&(Ue.start=Se,Me(ke+63>>6)));for(;se.l&511;)se.write_shift(-4,V.ENDOFCHAIN);for(ce=0;ce<Z[4]<<2;++ce){var ze=H.FullPaths[ce];if(!ze||ze.length===0){for(be=0;be<17;++be)se.write_shift(4,0);for(be=0;be<3;++be)se.write_shift(4,-1);for(be=0;be<12;++be)se.write_shift(4,0);continue}Ue=H.FileIndex[ce],ce===0&&(Ue.start=Ue.size?Ue.start-1:L);var dt=ce===0&&te.root||Ue.name;if(ke=2*(dt.length+1),se.write_shift(64,dt,"utf16le"),se.write_shift(2,ke),se.write_shift(1,Ue.type),se.write_shift(1,Ue.color),se.write_shift(-4,Ue.L),se.write_shift(-4,Ue.R),se.write_shift(-4,Ue.C),Ue.clsid)se.write_shift(16,Ue.clsid,"hex");else for(be=0;be<4;++be)se.write_shift(4,0);se.write_shift(4,Ue.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,Ue.start),se.write_shift(4,Ue.size),se.write_shift(4,0)}for(ce=1;ce<H.FileIndex.length;++ce)if(Ue=H.FileIndex[ce],Ue.size>=4096)if(se.l=Ue.start+1<<9,lr&&Buffer.isBuffer(Ue.content))Ue.content.copy(se,se.l,0,Ue.size),se.l+=Ue.size+511&-512;else{for(be=0;be<Ue.size;++be)se.write_shift(1,Ue.content[be]);for(;be&511;++be)se.write_shift(1,0)}for(ce=1;ce<H.FileIndex.length;++ce)if(Ue=H.FileIndex[ce],Ue.size>0&&Ue.size<4096)if(lr&&Buffer.isBuffer(Ue.content))Ue.content.copy(se,se.l,0,Ue.size),se.l+=Ue.size+63&-64;else{for(be=0;be<Ue.size;++be)se.write_shift(1,Ue.content[be]);for(;be&63;++be)se.write_shift(1,0)}if(lr)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function T(H,Ae){var te=H.FullPaths.map(function(be){return be.toUpperCase()}),Z=te.map(function(be){var ke=be.split("/");return ke[ke.length-(be.slice(-1)=="/"?2:1)]}),se=!1;Ae.charCodeAt(0)===47?(se=!0,Ae=te[0].slice(0,-1)+Ae):se=Ae.indexOf("/")!==-1;var ce=Ae.toUpperCase(),Se=se===!0?te.indexOf(ce):Z.indexOf(ce);if(Se!==-1)return H.FileIndex[Se];var Me=!ce.match(Ku);for(ce=ce.replace(Xn,""),Me&&(ce=ce.replace(Ku,"!")),Se=0;Se<te.length;++Se)if((Me?te[Se].replace(Ku,"!"):te[Se]).replace(Xn,"")==ce||(Me?Z[Se].replace(Ku,"!"):Z[Se]).replace(Xn,"")==ce)return H.FileIndex[Se];return null}var R=64,L=-2,N="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:N,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(H,Ae,te){l();var Z=M(H,te);c.writeFileSync(Ae,Z)}function W(H){for(var Ae=new Array(H.length),te=0;te<H.length;++te)Ae[te]=String.fromCharCode(H[te]);return Ae.join("")}function z(H,Ae){var te=M(H,Ae);switch(Ae&&Ae.type||"buffer"){case"file":return l(),c.writeFileSync(Ae.filename,te),te;case"binary":return typeof te=="string"?te:W(te);case"base64":return kf(typeof te=="string"?te:W(te));case"buffer":if(lr)return Buffer.isBuffer(te)?te:nA(te);case"array":return typeof te=="string"?$i(te):te}return te}var G;function b(H){try{var Ae=H.InflateRaw,te=new Ae;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)G=H;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function k(H,Ae){if(!G)return rr(H,Ae);var te=G.InflateRaw,Z=new te,se=Z._processChunk(H.slice(H.l),Z._finishFlushFlag);return H.l+=Z.bytesRead,se}function j(H){return G?G.deflateRawSync(H):ut(H)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(H){var Ae=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(Ae>>16|Ae>>8|Ae)&255}for(var pe=typeof Uint8Array<"u",ye=pe?new Uint8Array(256):[],ve=0;ve<256;++ve)ye[ve]=ue(ve);function ae(H,Ae){var te=ye[H&255];return Ae<=8?te>>>8-Ae:(te=te<<8|ye[H>>8&255],Ae<=16?te>>>16-Ae:(te=te<<8|ye[H>>16&255],te>>>24-Ae))}function Ke(H,Ae){var te=Ae&7,Z=Ae>>>3;return(H[Z]|(te<=6?0:H[Z+1]<<8))>>>te&3}function Ee(H,Ae){var te=Ae&7,Z=Ae>>>3;return(H[Z]|(te<=5?0:H[Z+1]<<8))>>>te&7}function me(H,Ae){var te=Ae&7,Z=Ae>>>3;return(H[Z]|(te<=4?0:H[Z+1]<<8))>>>te&15}function le(H,Ae){var te=Ae&7,Z=Ae>>>3;return(H[Z]|(te<=3?0:H[Z+1]<<8))>>>te&31}function He(H,Ae){var te=Ae&7,Z=Ae>>>3;return(H[Z]|(te<=1?0:H[Z+1]<<8))>>>te&127}function Ze(H,Ae,te){var Z=Ae&7,se=Ae>>>3,ce=(1<<te)-1,Se=H[se]>>>Z;return te<8-Z||(Se|=H[se+1]<<8-Z,te<16-Z)||(Se|=H[se+2]<<16-Z,te<24-Z)||(Se|=H[se+3]<<24-Z),Se&ce}function $e(H,Ae,te){var Z=Ae&7,se=Ae>>>3;return Z<=5?H[se]|=(te&7)<<Z:(H[se]|=te<<Z&255,H[se+1]=(te&7)>>8-Z),Ae+3}function et(H,Ae,te){var Z=Ae&7,se=Ae>>>3;return te=(te&1)<<Z,H[se]|=te,Ae+1}function je(H,Ae,te){var Z=Ae&7,se=Ae>>>3;return te<<=Z,H[se]|=te&255,te>>>=8,H[se+1]=te,Ae+8}function _e(H,Ae,te){var Z=Ae&7,se=Ae>>>3;return te<<=Z,H[se]|=te&255,te>>>=8,H[se+1]=te&255,H[se+2]=te>>>8,Ae+16}function lt(H,Ae){var te=H.length,Z=2*te>Ae?2*te:Ae+5,se=0;if(te>=Ae)return H;if(lr){var ce=Pv(Z);if(H.copy)H.copy(ce);else for(;se<H.length;++se)ce[se]=H[se];return ce}else if(pe){var Se=new Uint8Array(Z);if(Se.set)Se.set(H);else for(;se<te;++se)Se[se]=H[se];return Se}return H.length=Z,H}function Ct(H){for(var Ae=new Array(H),te=0;te<H;++te)Ae[te]=0;return Ae}function bt(H,Ae,te){var Z=1,se=0,ce=0,Se=0,Me=0,be=H.length,ke=pe?new Uint16Array(32):Ct(32);for(ce=0;ce<32;++ce)ke[ce]=0;for(ce=be;ce<te;++ce)H[ce]=0;be=H.length;var Ue=pe?new Uint16Array(be):Ct(be);for(ce=0;ce<be;++ce)ke[se=H[ce]]++,Z<se&&(Z=se),Ue[ce]=0;for(ke[0]=0,ce=1;ce<=Z;++ce)ke[ce+16]=Me=Me+ke[ce-1]<<1;for(ce=0;ce<be;++ce)Me=H[ce],Me!=0&&(Ue[ce]=ke[Me+16]++);var ze=0;for(ce=0;ce<be;++ce)if(ze=H[ce],ze!=0)for(Me=ae(Ue[ce],Z)>>Z-ze,Se=(1<<Z+4-ze)-1;Se>=0;--Se)Ae[Me|Se<<ze]=ze&15|ce<<4;return Z}var Et=pe?new Uint16Array(512):Ct(512),Mt=pe?new Uint16Array(32):Ct(32);if(!pe){for(var Dt=0;Dt<512;++Dt)Et[Dt]=0;for(Dt=0;Dt<32;++Dt)Mt[Dt]=0}(function(){for(var H=[],Ae=0;Ae<32;Ae++)H.push(5);bt(H,Mt,32);var te=[];for(Ae=0;Ae<=143;Ae++)te.push(8);for(;Ae<=255;Ae++)te.push(9);for(;Ae<=279;Ae++)te.push(7);for(;Ae<=287;Ae++)te.push(8);bt(te,Et,288)})();var Bt=function(){for(var Ae=pe?new Uint8Array(32768):[],te=0,Z=0;te<de.length-1;++te)for(;Z<de[te+1];++Z)Ae[Z]=te;for(;Z<32768;++Z)Ae[Z]=29;var se=pe?new Uint8Array(259):[];for(te=0,Z=0;te<Y.length-1;++te)for(;Z<Y[te+1];++Z)se[Z]=te;function ce(Me,be){for(var ke=0;ke<Me.length;){var Ue=Math.min(65535,Me.length-ke),ze=ke+Ue==Me.length;for(be.write_shift(1,+ze),be.write_shift(2,Ue),be.write_shift(2,~Ue&65535);Ue-- >0;)be[be.l++]=Me[ke++]}return be.l}function Se(Me,be){for(var ke=0,Ue=0,ze=pe?new Uint16Array(32768):[];Ue<Me.length;){var dt=Math.min(65535,Me.length-Ue);if(dt<10){for(ke=$e(be,ke,+(Ue+dt==Me.length)),ke&7&&(ke+=8-(ke&7)),be.l=ke/8|0,be.write_shift(2,dt),be.write_shift(2,~dt&65535);dt-- >0;)be[be.l++]=Me[Ue++];ke=be.l*8;continue}ke=$e(be,ke,+(Ue+dt==Me.length)+2);for(var pt=0;dt-- >0;){var st=Me[Ue];pt=(pt<<5^st)&32767;var ht=-1,Qt=0;if((ht=ze[pt])&&(ht|=Ue&-32768,ht>Ue&&(ht-=32768),ht<Ue))for(;Me[ht+Qt]==Me[Ue+Qt]&&Qt<250;)++Qt;if(Qt>2){st=se[Qt],st<=22?ke=je(be,ke,ye[st+1]>>1)-1:(je(be,ke,3),ke+=5,je(be,ke,ye[st-23]>>5),ke+=3);var xr=st<8?0:st-4>>2;xr>0&&(_e(be,ke,Qt-Y[st]),ke+=xr),st=Ae[Ue-ht],ke=je(be,ke,ye[st]>>3),ke-=3;var br=st<4?0:st-2>>1;br>0&&(_e(be,ke,Ue-ht-de[st]),ke+=br);for(var xa=0;xa<Qt;++xa)ze[pt]=Ue&32767,pt=(pt<<5^Me[Ue])&32767,++Ue;dt-=Qt-1}else st<=143?st=st+48:ke=et(be,ke,1),ke=je(be,ke,ye[st]),ze[pt]=Ue&32767,++Ue}ke=je(be,ke,0)-1}return be.l=(ke+7)/8|0,be.l}return function(be,ke){return be.length<8?ce(be,ke):Se(be,ke)}}();function ut(H){var Ae=Je(50+Math.floor(H.length*1.1)),te=Bt(H,Ae);return Ae.slice(0,te)}var ct=pe?new Uint16Array(32768):Ct(32768),vr=pe?new Uint16Array(32768):Ct(32768),Rt=pe?new Uint16Array(128):Ct(128),Gr=1,pr=1;function vt(H,Ae){var te=le(H,Ae)+257;Ae+=5;var Z=le(H,Ae)+1;Ae+=5;var se=me(H,Ae)+4;Ae+=4;for(var ce=0,Se=pe?new Uint8Array(19):Ct(19),Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,ke=pe?new Uint8Array(8):Ct(8),Ue=pe?new Uint8Array(8):Ct(8),ze=Se.length,dt=0;dt<se;++dt)Se[q[dt]]=ce=Ee(H,Ae),be<ce&&(be=ce),ke[ce]++,Ae+=3;var pt=0;for(ke[0]=0,dt=1;dt<=be;++dt)Ue[dt]=pt=pt+ke[dt-1]<<1;for(dt=0;dt<ze;++dt)(pt=Se[dt])!=0&&(Me[dt]=Ue[pt]++);var st=0;for(dt=0;dt<ze;++dt)if(st=Se[dt],st!=0){pt=ye[Me[dt]]>>8-st;for(var ht=(1<<7-st)-1;ht>=0;--ht)Rt[pt|ht<<st]=st&7|dt<<3}var Qt=[];for(be=1;Qt.length<te+Z;)switch(pt=Rt[He(H,Ae)],Ae+=pt&7,pt>>>=3){case 16:for(ce=3+Ke(H,Ae),Ae+=2,pt=Qt[Qt.length-1];ce-- >0;)Qt.push(pt);break;case 17:for(ce=3+Ee(H,Ae),Ae+=3;ce-- >0;)Qt.push(0);break;case 18:for(ce=11+He(H,Ae),Ae+=7;ce-- >0;)Qt.push(0);break;default:Qt.push(pt),be<pt&&(be=pt);break}var xr=Qt.slice(0,te),br=Qt.slice(te);for(dt=te;dt<286;++dt)xr[dt]=0;for(dt=Z;dt<30;++dt)br[dt]=0;return Gr=bt(xr,ct,286),pr=bt(br,vr,30),Ae}function Tr(H,Ae){if(H[0]==3&&!(H[1]&3))return[ic(Ae),2];for(var te=0,Z=0,se=Pv(Ae||1<<18),ce=0,Se=se.length>>>0,Me=0,be=0;!(Z&1);){if(Z=Ee(H,te),te+=3,Z>>>1)Z>>1==1?(Me=9,be=5):(te=vt(H,te),Me=Gr,be=pr);else{te&7&&(te+=8-(te&7));var ke=H[te>>>3]|H[(te>>>3)+1]<<8;if(te+=32,ke>0)for(!Ae&&Se<ce+ke&&(se=lt(se,ce+ke),Se=se.length);ke-- >0;)se[ce++]=H[te>>>3],te+=8;continue}for(;;){!Ae&&Se<ce+32767&&(se=lt(se,ce+32767),Se=se.length);var Ue=Ze(H,te,Me),ze=Z>>>1==1?Et[Ue]:ct[Ue];if(te+=ze&15,ze>>>=4,!(ze>>>8&255))se[ce++]=ze;else{if(ze==256)break;ze-=257;var dt=ze<8?0:ze-4>>2;dt>5&&(dt=0);var pt=ce+Y[ze];dt>0&&(pt+=Ze(H,te,dt),te+=dt),Ue=Ze(H,te,be),ze=Z>>>1==1?Mt[Ue]:vr[Ue],te+=ze&15,ze>>>=4;var st=ze<4?0:ze-2>>1,ht=de[ze];for(st>0&&(ht+=Ze(H,te,st),te+=st),!Ae&&Se<pt&&(se=lt(se,pt+100),Se=se.length);ce<pt;)se[ce]=se[ce-ht],++ce}}}return Ae?[se,te+7>>>3]:[se.slice(0,ce),te+7>>>3]}function rr(H,Ae){var te=H.slice(H.l||0),Z=Tr(te,Ae);return H.l+=Z[1],Z[0]}function ln(H,Ae){if(H)typeof console<"u"&&console.error(Ae);else throw new Error(Ae)}function kr(H,Ae){var te=H;Bn(te,0);var Z=[],se=[],ce={FileIndex:Z,FullPaths:se};_(ce,{root:Ae.root});for(var Se=te.length-4;(te[Se]!=80||te[Se+1]!=75||te[Se+2]!=5||te[Se+3]!=6)&&Se>=0;)--Se;te.l=Se+4,te.l+=4;var Me=te.read_shift(2);te.l+=6;var be=te.read_shift(4);for(te.l=be,Se=0;Se<Me;++Se){te.l+=20;var ke=te.read_shift(4),Ue=te.read_shift(4),ze=te.read_shift(2),dt=te.read_shift(2),pt=te.read_shift(2);te.l+=8;var st=te.read_shift(4),ht=A(te.slice(te.l+ze,te.l+ze+dt));te.l+=ze+dt+pt;var Qt=te.l;te.l=st+4,ri(te,ke,Ue,ce,ht),te.l=Qt}return ce}function ri(H,Ae,te,Z,se){H.l+=2;var ce=H.read_shift(2),Se=H.read_shift(2),Me=o(H);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var be=H.read_shift(4),ke=H.read_shift(4),Ue=H.read_shift(4),ze=H.read_shift(2),dt=H.read_shift(2),pt="",st=0;st<ze;++st)pt+=String.fromCharCode(H[H.l++]);if(dt){var ht=A(H.slice(H.l,H.l+dt));(ht[21589]||{}).mt&&(Me=ht[21589].mt),((se||{})[21589]||{}).mt&&(Me=se[21589].mt)}H.l+=dt;var Qt=H.slice(H.l,H.l+ke);switch(Se){case 8:Qt=k(H,Ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var xr=!1;ce&8&&(be=H.read_shift(4),be==134695760&&(be=H.read_shift(4),xr=!0),ke=H.read_shift(4),Ue=H.read_shift(4)),ke!=Ae&&ln(xr,"Bad compressed size: "+Ae+" != "+ke),Ue!=te&&ln(xr,"Bad uncompressed size: "+te+" != "+Ue),Ja(Z,pt,Qt,{unsafe:!0,mt:Me})}function Di(H,Ae){var te=Ae||{},Z=[],se=[],ce=Je(1),Se=te.compression?8:0,Me=0,be=0,ke=0,Ue=0,ze=0,dt=H.FullPaths[0],pt=dt,st=H.FileIndex[0],ht=[],Qt=0;for(be=1;be<H.FullPaths.length;++be)if(pt=H.FullPaths[be].slice(dt.length),st=H.FileIndex[be],!(!st.size||!st.content||pt=="Sh33tJ5")){var xr=Ue,br=Je(pt.length);for(ke=0;ke<pt.length;++ke)br.write_shift(1,pt.charCodeAt(ke)&127);br=br.slice(0,br.l),ht[ze]=r3.buf(st.content,0);var xa=st.content;Se==8&&(xa=j(xa)),ce=Je(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Me),ce.write_shift(2,Se),st.mt?s(ce,st.mt):ce.write_shift(4,0),ce.write_shift(-4,ht[ze]),ce.write_shift(4,xa.length),ce.write_shift(4,st.content.length),ce.write_shift(2,br.length),ce.write_shift(2,0),Ue+=ce.length,Z.push(ce),Ue+=br.length,Z.push(br),Ue+=xa.length,Z.push(xa),ce=Je(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Me),ce.write_shift(2,Se),ce.write_shift(4,0),ce.write_shift(-4,ht[ze]),ce.write_shift(4,xa.length),ce.write_shift(4,st.content.length),ce.write_shift(2,br.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,xr),Qt+=ce.l,se.push(ce),Qt+=br.length,se.push(br),++ze}return ce=Je(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,ze),ce.write_shift(2,ze),ce.write_shift(4,Qt),ce.write_shift(4,Ue),ce.write_shift(2,0),xn([xn(Z),xn(se),ce])}var Dr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Gt(H,Ae){if(H.ctype)return H.ctype;var te=H.name||"",Z=te.match(/\.([^\.]+)$/);return Z&&Dr[Z[1]]||Ae&&(Z=(te=Ae).match(/[\.\\]([^\.\\])+$/),Z&&Dr[Z[1]])?Dr[Z[1]]:"application/octet-stream"}function wr(H){for(var Ae=kf(H),te=[],Z=0;Z<Ae.length;Z+=76)te.push(Ae.slice(Z,Z+76));return te.join(`\r
`)+`\r
`}function ns(H){var Ae=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Ue=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Ue.length==1?"0"+Ue:Ue)});Ae=Ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ae.charAt(0)==`
`&&(Ae="=0D"+Ae.slice(1)),Ae=Ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],Z=Ae.split(`\r
`),se=0;se<Z.length;++se){var ce=Z[se];if(ce.length==0){te.push("");continue}for(var Se=0;Se<ce.length;){var Me=76,be=ce.slice(Se,Se+Me);be.charAt(Me-1)=="="?Me--:be.charAt(Me-2)=="="?Me-=2:be.charAt(Me-3)=="="&&(Me-=3),be=ce.slice(Se,Se+Me),Se+=Me,Se<ce.length&&(be+="="),te.push(be)}}return te.join(`\r
`)}function ga(H){for(var Ae=[],te=0;te<H.length;++te){for(var Z=H[te];te<=H.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+H[++te];Ae.push(Z)}for(var se=0;se<Ae.length;++se)Ae[se]=Ae[se].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return $i(Ae.join(`\r
`))}function yi(H,Ae,te){for(var Z="",se="",ce="",Se,Me=0;Me<10;++Me){var be=Ae[Me];if(!be||be.match(/^\s*$/))break;var ke=be.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":Z=ke[2].trim();break;case"content-type":ce=ke[2].trim();break;case"content-transfer-encoding":se=ke[2].trim();break}}switch(++Me,se.toLowerCase()){case"base64":Se=$i(rs(Ae.slice(Me).join("")));break;case"quoted-printable":Se=ga(Ae.slice(Me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var Ue=Ja(H,Z.slice(te.length),Se,{unsafe:!0});ce&&(Ue.ctype=ce)}function vi(H,Ae){if(W(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=Ae&&Ae.root||"",Z=(lr&&Buffer.isBuffer(H)?H.toString("binary"):W(H)).split(`\r
`),se=0,ce="";for(se=0;se<Z.length;++se)if(ce=Z[se],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),te||(te=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),ce.slice(0,te.length)!=te););var Se=(Z[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Me="--"+(Se[1]||""),be=[],ke=[],Ue={FileIndex:be,FullPaths:ke};_(Ue);var ze,dt=0;for(se=0;se<Z.length;++se){var pt=Z[se];pt!==Me&&pt!==Me+"--"||(dt++&&yi(Ue,Z.slice(ze,se),te),ze=se)}return Ue}function kt(H,Ae){var te=Ae||{},Z=te.boundary||"SheetJS";Z="------="+Z;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],ce=H.FullPaths[0],Se=ce,Me=H.FileIndex[0],be=1;be<H.FullPaths.length;++be)if(Se=H.FullPaths[be].slice(ce.length),Me=H.FileIndex[be],!(!Me.size||!Me.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qt){return"_x"+Qt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qt){return"_u"+Qt.charCodeAt(0).toString(16)+"_"});for(var ke=Me.content,Ue=lr&&Buffer.isBuffer(ke)?ke.toString("binary"):W(ke),ze=0,dt=Math.min(1024,Ue.length),pt=0,st=0;st<=dt;++st)(pt=Ue.charCodeAt(st))>=32&&pt<128&&++ze;var ht=ze>=dt*4/5;se.push(Z),se.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+Se),se.push("Content-Transfer-Encoding: "+(ht?"quoted-printable":"base64")),se.push("Content-Type: "+Gt(Me,Se)),se.push(""),se.push(ht?ns(Ue):wr(Ue))}return se.push(Z+`--\r
`),se.join(`\r
`)}function ai(H){var Ae={};return _(Ae,H),Ae}function Ja(H,Ae,te,Z){var se=Z&&Z.unsafe;se||_(H);var ce=!se&&Lt.find(H,Ae);if(!ce){var Se=H.FullPaths[0];Ae.slice(0,Se.length)==Se?Se=Ae:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+Ae).replace("//","/")),ce={name:n(Ae),type:2},H.FileIndex.push(ce),H.FullPaths.push(Se),se||Lt.utils.cfb_gc(H)}return ce.content=te,ce.size=te?te.length:0,Z&&(Z.CLSID&&(ce.clsid=Z.CLSID),Z.mt&&(ce.mt=Z.mt),Z.ct&&(ce.ct=Z.ct)),ce}function Za(H,Ae){_(H);var te=Lt.find(H,Ae);if(te){for(var Z=0;Z<H.FileIndex.length;++Z)if(H.FileIndex[Z]==te)return H.FileIndex.splice(Z,1),H.FullPaths.splice(Z,1),!0}return!1}function ca(H,Ae,te){_(H);var Z=Lt.find(H,Ae);if(Z){for(var se=0;se<H.FileIndex.length;++se)if(H.FileIndex[se]==Z)return H.FileIndex[se].name=n(te),H.FullPaths[se]=te,!0}return!1}function ge(H){O(H,!0)}return t.find=T,t.read=I,t.parse=d,t.write=z,t.writeFile=ie,t.utils={cfb_new:ai,cfb_add:Ja,cfb_del:Za,cfb_mov:ca,cfb_gc:ge,ReadShift:Af,CheckField:Rb,prep_blob:Bn,bconcat:xn,use_zlib:b,_deflateRaw:ut,_inflateRaw:rr,consts:V},t}();let KA;function a3(e){KA=e}function n3(e){return typeof e=="string"?n0(e):Array.isArray(e)?OI(e):e}function s0(e,t,r){if(typeof KA<"u"&&KA.writeFileSync)return r?KA.writeFileSync(e,t,r):KA.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=n0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?lo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([n3(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var A=File(e);return A.open("w"),A.encoding="binary",Array.isArray(t)&&(t=fc(t)),A.write(t),A.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function i3(e){if(typeof KA<"u")return KA.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Oa(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function $v(e,t){for(var r=[],a=Oa(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function mm(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function gm(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function s3(e){for(var t=[],r=Oa(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Th=new Date(1899,11,30,0,0,0);function cn(e,t){var r=e.getTime(),a=Th.getTime()+(e.getTimezoneOffset()-Th.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var mb=new Date,o3=Th.getTime()+(mb.getTimezoneOffset()-Th.getTimezoneOffset())*6e4,Yv=mb.getTimezoneOffset();function xm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+o3),t.getTimezoneOffset()!==Yv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Yv)*6e4),t}function A3(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var Wv=new Date("2017-02-19T19:06:09.000Z"),gb=isNaN(Wv.getFullYear())?new Date("2/19/17"):Wv,c3=gb.getFullYear()==2017;function Aa(e,t){var r=new Date(e);if(c3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gb.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ol(e,t){if(lr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return lo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return lo(ab(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return lo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return lo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Zr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zr(e[r]));return t}function ba(e,t){for(var r="";r.length<t;)r+=e;return r}function Gs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var l3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pd(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&l3.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var d3=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),o=[s[0]],A=1;A<s.length;++A)o.push(n),o.push(s[A]);return o}}();function xb(e){return e?e.content&&e.type?ol(e.content,!0):e.data?yd(e.data):e.asNodeBuffer&&lr?yd(e.asNodeBuffer().toString("binary")):e.asBinary?yd(e.asBinary()):e._data&&e._data.getContent?yd(ol(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function yb(e){if(!e)return null;if(e.data)return bh(e.data);if(e.asNodeBuffer&&lr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?bh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function u3(e){return e&&e.name.slice(-4)===".bin"?yb(e):xb(e)}function xs(e,t){for(var r=e.FullPaths||Oa(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function N2(e,t){var r=xs(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function $a(e,t,r){if(!r)return u3(N2(e,t));if(!t)return null;try{return $a(e,t)}catch{return null}}function Yi(e,t,r){if(!r)return xb(N2(e,t));if(!t)return null;try{return Yi(e,t)}catch{return null}}function f3(e,t,r){return yb(N2(e,t))}function Xv(e){for(var t=e.FullPaths||Oa(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ar(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return lr?a=nA(r):a=II(r),Lt.utils.cfb_add(e,t,a)}Lt.utils.cfb_add(e,t,r)}else e.file(t,r)}function F2(){return Lt.utils.cfb_new()}function vb(e,t){switch(t.type){case"base64":return Lt.read(e,{type:"base64"});case"binary":return Lt.read(e,{type:"binary"});case"buffer":case"array":return Lt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Qa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,p3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,h3=/<[^>]*>/g,ti=Qa.match(Jv)?Jv:h3,m3=/<\w*:/,g3=/<(\/?)\w+:/;function Xt(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(p3),A=0,c="",l=0,d="",f="",p=1;if(o)for(l=0;l!=o.length;++l){for(f=o[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(p=(n=f.charCodeAt(s+1))==34||n==39?1:0,c=f.slice(s+1+p,f.length-p),A=0;A!=d.length&&d.charCodeAt(A)!==58;++A);if(A===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,a[d.toLowerCase()]=c;else{var u=(A===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(A+1);if(a[u]&&d.slice(A-3,A)=="ext")continue;a[u]=c,a[u.toLowerCase()]=c}}return a}function xo(e){return e.replace(g3,"<$1")}var wb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},R2=mm(wb),Sr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(A,c){return wb[A]||String.fromCharCode(parseInt(c,A.indexOf("x")>-1?16:10))||A}).replace(t,function(A,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,o)+r(n.slice(o+3))}}(),k2=/[&<>'"]/g,x3=/[\u0000-\u0008\u000b-\u001f]/g;function Pr(e){var t=e+"";return t.replace(k2,function(r){return R2[r]}).replace(x3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Zv(e){return Pr(e).replace(/ /g,"_x0020_")}var Eb=/[\u0000-\u001f]/g;function D2(e){var t=e+"";return t.replace(k2,function(r){return R2[r]}).replace(/\n/g,"<br/>").replace(Eb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function y3(e){var t=e+"";return t.replace(k2,function(r){return R2[r]}).replace(Eb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var e4=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function v3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function na(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cg(e){for(var t="",r=0,a=0,n=0,s=0,o=0,A=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}o=e.charCodeAt(r++),A=((a&7)<<18|(n&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(A>>>10&1023)),t+=String.fromCharCode(56320+(A&1023))}return t}function t4(e){var t=ic(2*e.length),r,a,n=1,s=0,o=0,A;for(a=0;a<e.length;a+=n)n=1,(A=e.charCodeAt(a))<128?r=A:A<224?(r=(A&31)*64+(e.charCodeAt(a+1)&63),n=2):A<240?(r=(A&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(A&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function r4(e){return nA(e,"binary").toString("utf8")}var sp="foo bar bazâð£",Hr=lr&&(r4(sp)==Cg(sp)&&r4||t4(sp)==Cg(sp)&&t4)||Cg,lo=lr?function(e){return nA(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},jf=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),_b=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),w3=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),E3=/<\/?(?:vt:)?variant>/g,_3=/<(?:vt:)([^>]*)>([\s\S]*)</;function a4(e,t){var r=Xt(e),a=e.match(w3(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var o=s.replace(E3,"").match(_3);o&&n.push({v:Hr(o[2]),t:o[1]})}),n}var bb=/(^\s|\s$|\n)/;function Tn(e,t){return"<"+e+(t.match(bb)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lf(e){return Oa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function gt(e,t,r){return"<"+e+(r!=null?Lf(r):"")+(t!=null?(t.match(bb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function b3(e,t){switch(typeof e){case"string":var r=gt("vt:lpwstr",Pr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return gt((e|0)==e?"vt:i4":"vt:r8",Pr(String(e)));case"boolean":return gt("vt:bool",e?"true":"false")}if(e instanceof Date)return gt("vt:filetime",fx(e));throw new Error("Unable to serialize "+e)}function j2(e){if(lr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Hr(fc(T2(e)));throw new Error("Bad input format: expected Buffer or string")}var Uf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,on={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function C3(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function B3(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,o=a?-t:t;isFinite(o)?o==0?n=s=0:(n=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var A=0;A<=5;++A,s/=256)e[r+A]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var n4=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},i4=lr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:nA(t)})):n4(e)}:n4,s4=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(zo(e,n)));return a.join("").replace(Xn,"")},ym=lr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Xn,""):s4(e,t,r)}:s4,o4=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Cb=lr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):o4(e,t,r)}:o4,A4=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(fd(e,n)));return a.join("")},$d=lr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):A4(t,r,a)}:A4,Bb=function(e,t){var r=gn(e,t);return r>0?$d(e,t+4,t+4+r-1):""},L2=Bb,Sb=function(e,t){var r=gn(e,t);return r>0?$d(e,t+4,t+4+r-1):""},U2=Sb,Tb=function(e,t){var r=2*gn(e,t);return r>0?$d(e,t+4,t+4+r-1):""},M2=Tb,Ob=function(t,r){var a=gn(t,r);return a>0?ym(t,r+4,r+4+a):""},P2=Ob,Ib=function(e,t){var r=gn(e,t);return r>0?$d(e,t+4,t+4+r):""},Q2=Ib,Nb=function(e,t){return C3(e,t)},Oh=Nb,q2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};lr&&(L2=function(t,r){if(!Buffer.isBuffer(t))return Bb(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},U2=function(t,r){if(!Buffer.isBuffer(t))return Sb(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},M2=function(t,r){if(!Buffer.isBuffer(t))return Tb(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},P2=function(t,r){if(!Buffer.isBuffer(t))return Ob(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Q2=function(t,r){if(!Buffer.isBuffer(t))return Ib(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Oh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Nb(t,r)},q2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Fb(){ym=function(e,t,r){return _r.utils.decode(1200,e.slice(t,r)).replace(Xn,"")},$d=function(e,t,r){return _r.utils.decode(65001,e.slice(t,r))},L2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(il,e.slice(t+4,t+4+r-1)):""},U2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(Zi,e.slice(t+4,t+4+r-1)):""},M2=function(e,t){var r=2*gn(e,t);return r>0?_r.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},P2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(1200,e.slice(t+4,t+4+r)):""},Q2=function(e,t){var r=gn(e,t);return r>0?_r.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof _r<"u"&&Fb();var fd=function(e,t){return e[t]},zo=function(e,t){return e[t+1]*256+e[t]},S3=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},gn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},T3=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Af(e,t){var r="",a,n,s=[],o,A,c,l;switch(t){case"dbcs":if(l=this.l,lr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(zo(this,l)),l+=2;e*=2;break;case"utf8":r=$d(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ym(this,this.l,this.l+e);break;case"wstr":if(typeof _r<"u")r=_r.utils.decode(Zi,this.slice(this.l,this.l+2*e));else return Af.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=L2(this,this.l),e=4+gn(this,this.l);break;case"lpstr-cp":r=U2(this,this.l),e=4+gn(this,this.l);break;case"lpwstr":r=M2(this,this.l),e=4+2*gn(this,this.l);break;case"lpp4":e=4+gn(this,this.l),r=P2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+gn(this,this.l),r=Q2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=fd(this,this.l+e++))!==0;)s.push(qu(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=zo(this,this.l+e))!==0;)s.push(qu(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=fd(this,l),this.l=l+1,A=Af.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+A;s.push(qu(zo(this,l))),l+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof _r<"u"){r=_r.utils.decode(Zi,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=fd(this,l),this.l=l+1,A=Af.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+A;s.push(qu(fd(this,l))),l+=1}r=s.join("");break;default:switch(e){case 1:return a=fd(this,this.l),this.l++,a;case 2:return a=(t==="i"?S3:zo)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?jc:T3)(this,this.l),this.l+=4,a):(n=gn(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Oh(this,this.l):n=Oh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=Cb(this,this.l,e);break}}return this.l+=e,r}var O3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},I3=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},N3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function F3(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)N3(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){if(typeof _r<"u"&&il==874)for(n=0;n!=t.length;++n){var s=_r.utils.encode(il,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var A=t.charCodeAt(n);this[this.l++]=A&255,this[this.l++]=A>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,O3(this,t,this.l);break;case 8:if(a=8,r==="f"){B3(this,t,this.l);break}case 16:break;case-4:a=4,I3(this,t,this.l);break}return this.l+=a,this}function Rb(e,t){var r=Cb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Bn(e,t){e.l=t,e.read_shift=Af,e.chk=Rb,e.write_shift=F3}function ei(e,t){e.l+=t}function Je(e){var t=ic(e);return Bn(t,0),t}function iA(e,t,r){if(e){var a,n,s;Bn(e,e.l||0);for(var o=e.length,A=0,c=0;e.l<o;){A=e.read_shift(1),A&128&&(A=(A&127)+((e.read_shift(1)&127)<<7));var l=Hf[A]||Hf[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;c=e.l+s;var d=l.f&&l.f(e,s,r);if(e.l=c,t(d,l,A))return}}}function Fi(){var e=[],t=lr?256:2048,r=function(l){var d=Je(l);return Bn(d,0),d},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(l){return a&&l<a.length-a.l?a:(n(),a=r(Math.max(l+1,t)))},o=function(){return n(),xn(e)},A=function(l){n(),a=l,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:A,end:o,_bufs:e}}function it(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=Hf[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var o=e.next(s);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var A=0;A!=4;++A)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&q2(r)&&e.push(r)}}function cf(e,t,r){var a=Zr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function c4(e,t,r){var a=Zr(e);return a.s=cf(a.s,t.s,r),a.e=cf(a.e,t.s,r),a}function lf(e,t){if(e.cRel&&e.c<0)for(e=Zr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$t(e);return!e.cRel&&e.cRel!=null&&(r=D3(r)),!e.rRel&&e.rRel!=null&&(r=R3(r)),r}function Bg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+oa(e.s.c)+":"+(e.e.cRel?"":"$")+oa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sa(e.s.r)+":"+(e.e.rRel?"":"$")+Sa(e.e.r):lf(e.s,t.biff)+":"+lf(e.e,t.biff)}function K2(e){return parseInt(k3(e),10)-1}function Sa(e){return""+(e+1)}function R3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function k3(e){return e.replace(/\$(\d+)$/,"$1")}function H2(e){for(var t=j3(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function oa(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function D3(e){return e.replace(/^([A-Z])/,"$$$1")}function j3(e){return e.replace(/^\$([A-Z])/,"$1")}function L3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ma(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function $t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gi(e){var t=e.indexOf(":");return t==-1?{s:ma(e),e:ma(e)}:{s:ma(e.slice(0,t)),e:ma(e.slice(t+1))}}function or(e,t){return typeof t>"u"||typeof t=="number"?or(e.s,e.e):(typeof e!="string"&&(e=$t(e)),typeof t!="string"&&(t=$t(t)),e==t?e:e+":"+t)}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function l4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=as(e.z,r?cn(t):t)}catch{}try{return e.w=as((e.XF||{}).numFmtId||(r?14:0),r?cn(t):t)}catch{return""+t}}function mo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?sA[e.v]||e.v:t==null?l4(e,e.v):l4(e,t))}function pc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function kb(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),o=0,A=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?ma(a.origin):a.origin;o=c.r,A=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=gr(s["!ref"]);l.s.c=d.s.c,l.s.r=d.s.r,l.e.c=Math.max(l.e.c,d.e.c),l.e.r=Math.max(l.e.r,d.e.r),o==-1&&(l.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var u={v:t[f][p]},g=o+f,h=A+p;if(l.s.r>g&&(l.s.r=g),l.s.c>h&&(l.s.c=h),l.e.r<g&&(l.e.r=g),l.e.c<h&&(l.e.c=h),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))u=t[f][p];else if(Array.isArray(u.v)&&(u.f=t[f][p][1],u.v=u.v[0]),u.v===null)if(u.f)u.t="n";else if(a.nullError)u.t="e",u.v=0;else if(a.sheetStubs)u.t="z";else continue;else typeof u.v=="number"?u.t="n":typeof u.v=="boolean"?u.t="b":u.v instanceof Date?(u.z=a.dateNF||Kt[14],a.cellDates?(u.t="d",u.w=as(u.z,cn(u.v))):(u.t="n",u.v=cn(u.v),u.w=as(u.z,u.v))):u.t="s";if(n)s[g]||(s[g]=[]),s[g][h]&&s[g][h].z&&(u.z=s[g][h].z),s[g][h]=u;else{var y=$t({c:h,r:g});s[y]&&s[y].z&&(u.z=s[y].z),s[y]=u}}}return l.s.c<1e7&&(s["!ref"]=or(l)),s}function Yd(e,t){return kb(null,e,t)}function U3(e){return e.read_shift(4,"i")}function zs(e,t){return t||(t=Je(4)),t.write_shift(4,e),t}function Jn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yn(e,t){var r=!1;return t==null&&(r=!0,t=Je(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function M3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function P3(e,t){return t||(t=Je(4)),t.write_shift(2,0),t.write_shift(2,0),t}function G2(e,t){var r=e.l,a=e.read_shift(1),n=Jn(e),s=[],o={t:n,h:n};if(a&1){for(var A=e.read_shift(4),c=0;c!=A;++c)s.push(M3(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Q3(e,t){var r=!1;return t==null&&(r=!0,t=Je(15+4*e.t.length)),t.write_shift(1,0),yn(e.t,t),r?t.slice(0,t.l):t}var q3=G2;function K3(e,t){var r=!1;return t==null&&(r=!0,t=Je(23+4*e.t.length)),t.write_shift(1,1),yn(e.t,t),t.write_shift(4,1),P3({},t),r?t.slice(0,t.l):t}function Os(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ml(e,t){return t==null&&(t=Je(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function gl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function xl(e,t){return t==null&&(t=Je(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var H3=Jn,Db=yn;function z2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ih(e,t){var r=!1;return t==null&&(r=!0,t=Je(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var G3=Jn,px=z2,V2=Ih;function $2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Oh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):jc(t,0)>>2;return r?n/100:n}function jb(e,t){t==null&&(t=Je(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Lb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function z3(e,t){return t||(t=Je(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var yl=Lb,Wd=z3;function $n(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Al(e,t){return(t||Je(8)).write_shift(8,e,"f")}function V3(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),A=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=$c[n];l&&(t.rgb=Pf(l));break;case 2:t.rgb=Pf([o,A,c]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Nh(e,t){if(t||(t=Je(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function $3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Y3(e,t){t||(t=Je(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Ub(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function W3(e){return Ub(e,1)}function X3(e){return Ub(e,2)}var Y2=2,Ti=3,op=11,d4=12,Fh=19,Ap=64,J3=65,Z3=71,eN=4108,tN=4126,hn=80,Mb=81,rN=[hn,Mb],hx={1:{n:"CodePage",t:Y2},2:{n:"Category",t:hn},3:{n:"PresentationFormat",t:hn},4:{n:"ByteCount",t:Ti},5:{n:"LineCount",t:Ti},6:{n:"ParagraphCount",t:Ti},7:{n:"SlideCount",t:Ti},8:{n:"NoteCount",t:Ti},9:{n:"HiddenCount",t:Ti},10:{n:"MultimediaClipCount",t:Ti},11:{n:"ScaleCrop",t:op},12:{n:"HeadingPairs",t:eN},13:{n:"TitlesOfParts",t:tN},14:{n:"Manager",t:hn},15:{n:"Company",t:hn},16:{n:"LinksUpToDate",t:op},17:{n:"CharacterCount",t:Ti},19:{n:"SharedDoc",t:op},22:{n:"HyperlinksChanged",t:op},23:{n:"AppVersion",t:Ti,p:"version"},24:{n:"DigSig",t:J3},26:{n:"ContentType",t:hn},27:{n:"ContentStatus",t:hn},28:{n:"Language",t:hn},29:{n:"Version",t:hn},255:{},2147483648:{n:"Locale",t:Fh},2147483651:{n:"Behavior",t:Fh},1919054434:{}},mx={1:{n:"CodePage",t:Y2},2:{n:"Title",t:hn},3:{n:"Subject",t:hn},4:{n:"Author",t:hn},5:{n:"Keywords",t:hn},6:{n:"Comments",t:hn},7:{n:"Template",t:hn},8:{n:"LastAuthor",t:hn},9:{n:"RevNumber",t:hn},10:{n:"EditTime",t:Ap},11:{n:"LastPrinted",t:Ap},12:{n:"CreatedDate",t:Ap},13:{n:"ModifiedDate",t:Ap},14:{n:"PageCount",t:Ti},15:{n:"WordCount",t:Ti},16:{n:"CharCount",t:Ti},17:{n:"Thumbnail",t:Z3},18:{n:"Application",t:hn},19:{n:"DocSecurity",t:Ti},255:{},2147483648:{n:"Locale",t:Fh},2147483651:{n:"Behavior",t:Fh},1919054434:{}},u4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var iN=nN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$c=Zr(iN),sA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Pb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},cp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function W2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sN(e){var t=W2();if(!e||!e.match)return t;var r={};if((e.match(ti)||[]).forEach(function(a){var n=Xt(a);switch(n[0].replace(m3,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[gx[n.ContentType]]!==void 0&&t[gx[n.ContentType]].push(n.PartName);break}}),t.xmlns!==on.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Qb(e,t){var r=s3(gx),a=[],n;a[a.length]=Qa,a[a.length]=gt("Types",null,{xmlns:on.CT,"xmlns:xsd":on.xsd,"xmlns:xsi":on.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return gt("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=gt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:cp[c][t.bookType]||cp[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(l){a[a.length]=gt("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:cp[c][t.bookType]||cp[c].xlsx})})},A=function(c){(e[c]||[]).forEach(function(l){a[a.length]=gt("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),A("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(A),A("vba"),A("comments"),A("threadedcomments"),A("drawings"),o("metadata"),A("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function df(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ti)||[]).forEach(function(n){var s=Xt(n);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var A=s.TargetMode==="External"?s.Target:Hu(s.Target,t);r[A]=o,a[s.Id]=o}}),r["!id"]=a,r}function Sd(e){var t=[Qa,gt("Relationships",null,{xmlns:on.RELS})];return Oa(e["!id"]).forEach(function(r){t[t.length]=gt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Mr(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var oN="application/vnd.oasis.opendocument.spreadsheet";function AN(e,t){for(var r=j2(e),a,n;a=Uf.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Xt(a[0],!1),n.path=="/"&&n.type!==oN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function cN(e){var t=[Qa];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function f4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function lN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function dN(e){var t=[Qa];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(f4(e[r][0],e[r][1])),t.push(lN("",e[r][0]));return t.push(f4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function qb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Rf.version+"</meta:generator></office:meta></office:document-meta>"}var Cs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uN=function(){for(var e=new Array(Cs.length),t=0;t<Cs.length;++t){var r=Cs[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function Kb(e){var t={};e=Hr(e);for(var r=0;r<Cs.length;++r){var a=Cs[r],n=e.match(uN[r]);n!=null&&n.length>0&&(t[a[1]]=Sr(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Aa(t[a[1]]))}return t}function Sg(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Pr(t),a[a.length]=r?gt(e,t,r):Tn(e,t))}function Hb(e,t){var r=t||{},a=[Qa,gt("cp:coreProperties",null,{"xmlns:cp":on.CORE_PROPS,"xmlns:dc":on.dc,"xmlns:dcterms":on.dcterms,"xmlns:dcmitype":on.dcmitype,"xmlns:xsi":on.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Sg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fx(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Sg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fx(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=Cs.length;++s){var o=Cs[s],A=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;A===!0?A="1":A===!1?A="0":typeof A=="number"&&(A=String(A)),A!=null&&Sg(o[0],A,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Yc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zb(e,t,r,a){var n=[];if(typeof e=="string")n=a4(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?a4(t,a).map(function(d){return d.v}):t,A=0,c=0;if(o.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(A,A+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(A,A+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(A,A+c);break}A+=c}}function fN(e,t,r){var a={};return t||(t={}),e=Hr(e),Yc.forEach(function(n){var s=(e.match(jf(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=Sr(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&zb(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Vb(e){var t=[],r=gt;return e||(e={}),e.Application="SheetJS",t[t.length]=Qa,t[t.length]=gt("Properties",null,{xmlns:on.EXT_PROPS,"xmlns:vt":on.vt}),Yc.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Pr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Pr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var pN=/<[^>]+>[^<]*/g;function hN(e,t){var r={},a="",n=e.match(pN);if(n)for(var s=0;s!=n.length;++s){var o=n[s],A=Xt(o);switch(A[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Sr(A.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),l=c[0].slice(4),d=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[a]=Sr(d);break;case"bool":r[a]=na(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Aa(d);break;case"cy":case"error":r[a]=Sr(d);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,l,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function $b(e){var t=[Qa,gt("Properties",null,{xmlns:on.CUST_PROPS,"xmlns:vt":on.vt})];if(!e)return t.join("");var r=1;return Oa(e).forEach(function(n){++r,t[t.length]=gt("property",b3(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Pr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tg;function mN(e,t,r){Tg||(Tg=mm(xx)),t=Tg[t]||t,e[t]=r}function gN(e,t){var r=[];return Oa(xx).map(function(a){for(var n=0;n<Cs.length;++n)if(Cs[n][1]==a)return Cs[n];for(n=0;n<Yc.length;++n)if(Yc[n][1]==a)return Yc[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Tn(xx[a[1]]||a[1],n))}}),gt("DocumentProperties",r.join(""),{xmlns:Vi.o})}function xN(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Oa(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Cs.length;++o)if(s==Cs[o][1])return;for(o=0;o<Yc.length;++o)if(s==Yc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var A=e[s],c="string";typeof A=="number"?(c="float",A=String(A)):A===!0||A===!1?(c="boolean",A=A?"1":"0"):A=String(A),n.push(gt(Zv(s),A,{"dt:dt":c}))}}),t&&Oa(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],A="string";typeof o=="number"?(A="float",o=String(o)):o===!0||o===!1?(A="boolean",o=o?"1":"0"):o instanceof Date?(A="dateTime.tz",o=o.toISOString()):o=String(o),n.push(gt(Zv(s),o,{"dt:dt":A}))}}),"<"+a+' xmlns="'+Vi.o+'">'+n.join("")+"</"+a+">"}function X2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function yN(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var o=Je(8);return o.write_shift(4,a),o.write_shift(4,n),o}function Yb(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function Wb(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Xb(e,t,r){return t===31?Wb(e):Yb(e,t,r)}function yx(e,t,r){return Xb(e,t,r===!1?0:4)}function vN(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Xb(e,t,0)}function wN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Xn,""),e.l-n&2&&(e.l+=2)}return r}function EN(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Xn,"");return r}function _N(e){var t=e.l,r=Rh(e,Mb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Rh(e,Ti);return[r,a]}function bN(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(_N(e));return r}function p4(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),o=e.read_shift(4);a[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Xn,"").replace(Ku,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Jb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function CN(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Rh(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==d4&&a!==t&&rN.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===d4?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Yb(e,a,4).replace(Xn,"");case 31:return Wb(e);case 64:return X2(e);case 65:return Jb(e);case 71:return CN(e);case 80:return yx(e,a,!s.raw).replace(Xn,"");case 81:return vN(e,a).replace(Xn,"");case 4108:return bN(e);case 4126:case 4127:return a==4127?wN(e):EN(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function h4(e,t){var r=Je(4),a=Je(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Je(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=yN(t);break;case 31:case 80:for(a=Je(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xn([r,a])}function m4(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0,A=0,c=-1,l={};for(o=0;o!=n;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,E){return v[1]-E[1]});var p={};for(o=0;o!=n;++o){if(e.l!==s[o][1]){var u=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,u=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],u=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],u=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(u=!1,e.l=s[o][1]),u)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[s[o][0]];if(p[g.n]=Rh(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Es(A=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(s[o][0]===1){if(A=p.CodePage=Rh(e,Y2),Es(A),c!==-1){var h=e.l;e.l=s[c][1],l=p4(e,A),e.l=h}}else if(s[o][0]===0){if(A===0){c=o,e.l=s[o+1][1];continue}l=p4(e,A)}else{var y=l[s[o][0]],x;switch(e[e.l]){case 65:e.l+=4,x=Jb(e);break;case 30:e.l+=4,x=yx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=yx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Ra(e,4);break;case 64:e.l+=4,x=Aa(X2(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=x}}return e.l=r+a,p}var Zb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BN(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function g4(e,t,r){var a=Je(8),n=[],s=[],o=8,A=0,c=Je(8),l=Je(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),n.push(l),o+=8+c.length,!t){l=Je(8),l.write_shift(4,0),n.unshift(l);var d=[Je(4)];for(d[0].write_shift(4,e.length),A=0;A<e.length;++A){var f=e[A][0];for(c=Je(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,A+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=xn(d),s.unshift(c),o+=8+c.length}for(A=0;A<e.length;++A)if(!(t&&!t[e[A][0]])&&!(Zb.indexOf(e[A][0])>-1||Gb.indexOf(e[A][0])>-1)&&e[A][1]!=null){var p=e[A][1],u=0;if(t){u=+t[e[A][0]];var g=r[u];if(g.p=="version"&&typeof p=="string"){var h=p.split(".");p=(+h[0]<<16)+(+h[1]||0)}c=h4(g.t,p)}else{var y=BN(p);y==-1&&(y=31,p=String(p)),c=h4(y,p)}s.push(c),l=Je(8),l.write_shift(4,t?u:2+A),n.push(l),o+=8+c.length}var x=8*(s.length+1);for(A=0;A<s.length;++A)n[A].write_shift(4,x),x+=s[A].length;return a.write_shift(4,o),a.write_shift(4,s.length),xn([a].concat(n).concat(s))}function x4(e,t,r){var a=e.content;if(!a)return{};Bn(a,0);var n,s,o,A,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),d=a.read_shift(16);if(d!==Lt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),A=a.read_shift(4),n===1&&A!==a.l)throw new Error("Length mismatch: "+A+" !== "+a.l);n===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=m4(a,t),p={SystemIdentifier:l};for(var u in f)p[u]=f[u];if(p.FMTID=s,n===1)return p;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var g;try{g=m4(a,null)}catch{}for(u in g)p[u]=g[u];return p.FMTID=[s,o],p}function y4(e,t,r,a,n,s){var o=Je(n?68:48),A=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Lt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=g4(e,r,a);if(A.push(c),n){var l=g4(n,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),A.push(l)}return xn(A)}function CA(e,t){return e.read_shift(t),null}function SN(e,t){t||(t=Je(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function TN(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Ra(e,t){return e.read_shift(t)===1}function di(e,t){return t||(t=Je(2)),t.write_shift(2,+!!e),t}function Ya(e){return e.read_shift(2,"u")}function vs(e,t){return t||(t=Je(2)),t.write_shift(2,e),t}function e5(e,t){return TN(e,t,Ya)}function ON(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function t5(e,t,r){return r||(r=Je(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function o0(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",s=Zi;if(r&&r.biff>=8&&(Zi=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var A=a?e.read_shift(a,n):"";return Zi=s,A}function IN(e){var t=Zi;Zi=1200;var r=e.read_shift(2),a=e.read_shift(1),n=a&4,s=a&8,o=1+(a&1),A=0,c,l={};s&&(A=e.read_shift(2)),n&&(c=e.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return s&&(e.l+=4*A),n&&(e.l+=c),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Zi=t,l}function NN(e){var t=e.t||"",r=Je(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Je(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return xn(n)}function cl(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function A0(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):cl(e,a,r)}function vl(e,t,r){if(r.biff>5)return A0(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function r5(e,t,r){return r||(r=Je(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function FN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function RN(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Xn,"");return a&&(e.l+=24),n}function kN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Xn,"");return r+o}function DN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return RN(e);case"0303000000000000c000000000000046":return kN(e);default:throw new Error("Unsupported Moniker "+r)}}function lp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Xn,""):"";return r}function v4(e,t){t||(t=Je(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function jN(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,o,A,c,l="",d,f;n&16&&(s=lp(e,r-e.l)),n&128&&(o=lp(e,r-e.l)),(n&257)===257&&(A=lp(e,r-e.l)),(n&257)===1&&(c=DN(e,r-e.l)),n&8&&(l=lp(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=X2(e)),e.l=r;var p=o||A||c||"";p&&l&&(p+="#"+l),p||(p="#"+l),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var u={Target:p};return d&&(u.guid=d),f&&(u.time=f),s&&(u.Tooltip=s),u}function LN(e){var t=Je(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)a=a.slice(1),v4(a,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var A=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(A.length+1)),r=0;r<A.length;++r)t.write_shift(2,A.charCodeAt(r));t.write_shift(2,0),s&8&&v4(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function a5(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function n5(e,t){var r=a5(e);return r[3]=0,r}function yo(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ll(e,t,r,a){return a||(a=Je(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function UN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function MN(e,t,r){return t===0?"":vl(e,t,r)}function PN(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,s,o]}function i5(e){var t=e.read_shift(2),r=$2(e);return[t,r]}function QN(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=o0(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function vm(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function s5(e,t){return t||(t=Je(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function o5(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var qN=o5;function A5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function KN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function HN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Dn(e){e.l+=2,e.l+=e.read_shift(2)}var GN={0:Dn,4:Dn,5:Dn,6:Dn,7:HN,8:Dn,9:Dn,10:Dn,11:Dn,12:Dn,13:KN,14:Dn,15:Dn,16:Dn,17:Dn,18:Dn,19:Dn,20:Dn,21:A5};function zN(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(GN[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function dp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function J2(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Je(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function VN(e,t){return t===0||e.read_shift(2),1200}function $N(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=vl(e,0,r);return e.read_shift(t+a-e.l),n}function YN(e,t){var r=!t||t.biff==8,a=Je(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function WN(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function XN(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=o0(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:s,name:o}}function JN(e,t){var r=!t||t.biff>=8?2:1,a=Je(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function ZN(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0;o!=n&&e.l<r;++o)s.push(IN(e));return s.Count=a,s.Unique=n,s}function eF(e,t){var r=Je(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=NN(e[n]);var s=xn([r].concat(a));return s.parts=[r.length].concat(a.map(function(o){return o.length})),s}function tF(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function rF(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function aF(e){var t=UN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function nF(e){return e.read_shift(2),e.read_shift(4)}function w4(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function iF(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),A=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:o,FirstTab:A,Selected:c,TabRatio:l}}function sF(){var e=Je(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function oF(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function AF(e){var t=Je(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function cF(){}function lF(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=o0(e,0,r),a}function dF(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=Je(n);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function uF(e){var t=yo(e);return t.isst=e.read_shift(4),t}function fF(e,t,r,a){var n=Je(10);return ll(e,t,a,n),n.write_shift(4,r),n}function pF(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=yo(e);r.biff==2&&e.l++;var s=A0(e,a-e.l,r);return n.val=s,n}function hF(e,t,r,a,n){var s=!n||n.biff==8,o=Je(8+ +s+(1+s)*r.length);return ll(e,t,a,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function mF(e,t,r){var a=e.read_shift(2),n=vl(e,0,r);return[a,n]}function gF(e,t,r,a){var n=r&&r.biff==5;a||(a=Je(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var xF=vl;function E4(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),o=e.read_shift(n),A=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:s,c:A},e:{r:o,c}}}function yF(e,t){var r=t.biff==8||!t.biff?4:2,a=Je(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function vF(e){var t=e.read_shift(2),r=e.read_shift(2),a=i5(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function wF(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(i5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:s}}function EF(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:s}}function _F(e,t,r,a){var n={},s=e.read_shift(4),o=e.read_shift(4),A=e.read_shift(4),c=e.read_shift(2);return n.patternType=aN[A>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=A&127,n.icvBottom=A>>7&127,n.icvDiag=A>>14&127,n.dgDiag=A>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function bF(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=_F(e,t,a.fStyle,r),a}function _4(e,t,r,a){var n=r&&r.biff==5;a||(a=Je(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function CF(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function BF(e){var t=Je(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function b4(e,t,r){var a=yo(e);(r.biff==2||t==9)&&++e.l;var n=ON(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function SF(e,t,r,a,n,s){var o=Je(8);return ll(e,t,a,o),t5(r,s,o),o}function TF(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=yo(e),n=$n(e);return a.val=n,a}function OF(e,t,r,a){var n=Je(14);return ll(e,t,a,n),Al(r,n),n}var C4=MN;function IF(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=cl(e,s),A=[];a>e.l;)A.push(A0(e));return[s,n,o,A]}function B4(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=QN(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var NF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function S4(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),A=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=cl(e,o,r);n&32&&(l=NF[l.charCodeAt(0)]);var d=a-e.l;r&&r.biff==2&&--d;var f=a==e.l||A===0||!(d>0)?[]:zD(e,d,r,A);return{chKey:s,Name:l,itab:c,rgce:f}}function c5(e,t,r){if(r.biff<8)return FF(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(PN(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function FF(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=o0(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function RF(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=cl(e,a,r),o=cl(e,n,r);return[s,o]}function kF(e,t,r){var a=o5(e);e.l++;var n=e.read_shift(1);return t-=8,[VD(e,t,r),n,a]}function T4(e,t,r){var a=qN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,HD(e,t,r)]}function DF(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function jF(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),A=vl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},A,o,s]}}function LF(e,t,r){return jF(e,t,r)}function UF(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(vm(e));return r}function MF(e){var t=Je(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)s5(e[r],t);return t}function PF(e,t,r){if(r&&r.biff<8)return qF(e,t,r);var a=A5(e),n=zN(e,t-22,a[1]);return{cmo:a,ft:n}}var QF={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function qF(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((QF[a]||ei)(e,t,r)),{cmo:[n,a,s],ft:o}}function KF(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=FN(e,6,r);var A=e.read_shift(2);e.read_shift(2),Ya(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var d=e[e.l],f=cl(e,e.lens[l+1]-e.lens[l]-1);if(n+=f,n.length>=(d?A:2*A))break}if(n.length!==A&&n.length!==A*2)throw new Error("cchText: "+A+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function HF(e,t){var r=vm(e);e.l+=16;var a=jN(e,t-24);return[r,a]}function GF(e){var t=Je(24),r=ma(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return xn([t,LN(e[1])])}function zF(e,t){e.read_shift(2);var r=vm(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Xn,""),[r,a]}function VF(e){var t=e[1].Tooltip,r=Je(10+2*(t.length+1));r.write_shift(2,2048);var a=ma(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function $F(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=u4[r]||r,r=e.read_shift(2),t[1]=u4[r]||r,t}function YF(e){return e||(e=Je(4)),e.write_shift(2,1),e.write_shift(2,1),e}function WF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n5(e));return r}function XF(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n5(e));return r}function JF(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function l5(e,t,r){if(!r.cellStyles)return ei(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),A=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:s,w:o,ixfe:A,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function ZF(e,t){var r=Je(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function eR(e,t){var r={};return t<32||(e.l+=16,r.header=$n(e),r.footer=$n(e),e.l+=2),r}function tR(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function rR(e){for(var t=Je(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var aR=yo,nR=e5,iR=A0;function sR(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function oR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=yo(e);++e.l;var n=vl(e,t-7,r);return a.t="str",a.val=n,a}function AR(e){var t=yo(e);++e.l;var r=$n(e);return t.t="n",t.val=r,t}function cR(e,t,r){var a=Je(15);return u0(a,e,t),a.write_shift(8,r,"f"),a}function lR(e){var t=yo(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function dR(e,t,r){var a=Je(9);return u0(a,e,t),a.write_shift(2,r),a}function uR(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function fR(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function pR(e,t,r){var a=e.l+t,n=yo(e),s=e.read_shift(2),o=cl(e,s,r);return e.l=a,n.t="str",n.val=o,n}var hR=[2,3,48,49,131,139,140,245],vx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=mm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(A,c){var l=[],d=ic(1);switch(c.type){case"base64":d=$i(rs(A));break;case"binary":d=$i(A);break;case"buffer":case"array":d=A;break}Bn(d,0);var f=d.read_shift(1),p=!!(f&136),u=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:u=!0,p=!0;break;case 49:u=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var h=0,y=521;f==2&&(h=d.read_shift(2)),d.l+=3,f!=2&&(h=d.read_shift(4)),h>1048576&&(h=1e6),f!=2&&(y=d.read_shift(2));var x=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var E=[],D={},B=Math.min(d.length,f==2?521:y-10-(u?264:0)),I=g?32:11;d.l<B&&d[d.l]!=13;)switch(D={},D.name=_r.utils.decode(v,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,D.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(D.offset=d.read_shift(4)),D.len=d.read_shift(1),f==2&&(D.offset=d.read_shift(2)),D.dec=d.read_shift(1),D.name.length&&E.push(D),f!=2&&(d.l+=g?13:14),D.type){case"B":(!u||D.len!=8)&&c.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var _=0,S=0;for(l[0]=[],S=0;S!=E.length;++S)l[0][S]=E[S].name;for(;h-- >0;){if(d[d.l]===42){d.l+=x;continue}for(++d.l,l[++_]=[],S=0,S=0;S!=E.length;++S){var O=d.slice(d.l,d.l+E[S].len);d.l+=E[S].len,Bn(O,0);var M=_r.utils.decode(v,O);switch(E[S].type){case"C":M.trim().length&&(l[_][S]=M.replace(/\s+$/,""));break;case"D":M.length===8?l[_][S]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):l[_][S]=M;break;case"F":l[_][S]=parseFloat(M.trim());break;case"+":case"I":l[_][S]=g?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":l[_][S]=!0;break;case"N":case"F":l[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[_][S]="##MEMO##"+(g?parseInt(M.trim(),10):O.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(l[_][S]=+M||0);break;case"@":l[_][S]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":l[_][S]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":l[_][S]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[_][S]=-O.read_shift(-8,"f");break;case"B":if(u&&E[S].len==8){l[_][S]=O.read_shift(8,"f");break}case"G":case"P":O.l+=E[S].len;break;case"0":if(E[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=E,l}function a(A,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var d=Yd(r(A,l),l);return d["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,d}function n(A,c){try{return pc(a(A,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(A,c){var l=c||{};if(+l.codepage>=0&&Es(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var d=Fi(),f=Lh(A,{header:1,raw:!0,cellDates:!0}),p=f[0],u=f.slice(1),g=A["!cols"]||[],h=0,y=0,x=0,v=1;for(h=0;h<p.length;++h){if(((g[h]||{}).DBF||{}).name){p[h]=g[h].DBF.name,++x;continue}if(p[h]!=null){if(++x,typeof p[h]=="number"&&(p[h]=p[h].toString(10)),typeof p[h]!="string")throw new Error("DBF Invalid column name "+p[h]+" |"+typeof p[h]+"|");if(p.indexOf(p[h])!==h){for(y=0;y<1024;++y)if(p.indexOf(p[h]+"_"+y)==-1){p[h]+="_"+y;break}}}}var E=gr(A["!ref"]),D=[],B=[],I=[];for(h=0;h<=E.e.c-E.s.c;++h){var _="",S="",O=0,M=[];for(y=0;y<u.length;++y)u[y][h]!=null&&M.push(u[y][h]);if(M.length==0||p[h]==null){D[h]="?";continue}for(y=0;y<M.length;++y){switch(typeof M[y]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=M[y]instanceof Date?"D":"C";break;default:S="C"}O=Math.max(O,String(M[y]).length),_=_&&_!=S?"C":S}O>250&&(O=250),S=((g[h]||{}).DBF||{}).type,S=="C"&&g[h].DBF.len>O&&(O=g[h].DBF.len),_=="B"&&S=="N"&&(_="N",I[h]=g[h].DBF.dec,O=g[h].DBF.len),B[h]=_=="C"||S=="N"?O:s[_]||0,v+=B[h],D[h]=_}var T=d.next(32);for(T.write_shift(4,318902576),T.write_shift(4,u.length),T.write_shift(2,296+32*x),T.write_shift(2,v),h=0;h<4;++h)T.write_shift(4,0);for(T.write_shift(4,0|(+t[il]||3)<<8),h=0,y=0;h<p.length;++h)if(p[h]!=null){var R=d.next(32),L=(p[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,L,"sbcs"),R.write_shift(1,D[h]=="?"?"C":D[h],"sbcs"),R.write_shift(4,y),R.write_shift(1,B[h]||s[D[h]]||0),R.write_shift(1,I[h]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),y+=B[h]||s[D[h]]||0}var N=d.next(264);for(N.write_shift(4,13),h=0;h<65;++h)N.write_shift(4,0);for(h=0;h<u.length;++h){var P=d.next(v);for(P.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(D[y]){case"L":P.write_shift(1,u[h][y]==null?63:u[h][y]?84:70);break;case"B":P.write_shift(8,u[h][y]||0,"f");break;case"N":var U="0";for(typeof u[h][y]=="number"&&(U=u[h][y].toFixed(I[y]||0)),x=0;x<B[y]-U.length;++x)P.write_shift(1,32);P.write_shift(1,U,"sbcs");break;case"D":u[h][y]?(P.write_shift(4,("0000"+u[h][y].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(u[h][y].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+u[h][y].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var V=String(u[h][y]!=null?u[h][y]:"").slice(0,B[y]);for(P.write_shift(1,V,"sbcs"),x=0;x<B[y]-V.length;++x)P.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),d5=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Oa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,u){var g=e[u];return typeof g=="number"?ux(g):g},a=function(p,u,g){var h=u.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return h==59?p:ux(h)};e["|"]=254;function n(p,u){switch(u.type){case"base64":return s(rs(p),u);case"binary":return s(p,u);case"buffer":return s(lr&&Buffer.isBuffer(p)?p.toString("binary"):fc(p),u);case"array":return s(ol(p),u)}throw new Error("Unrecognized type "+u.type)}function s(p,u){var g=p.split(/[\n\r]+/),h=-1,y=-1,x=0,v=0,E=[],D=[],B=null,I={},_=[],S=[],O=[],M=0,T;for(+u.codepage>=0&&Es(+u.codepage);x!==g.length;++x){M=0;var R=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),L=R.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),N=L[0],P;if(R.length>0)switch(N){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&D.push(R.slice(3).replace(/;;/g,";"));break;case"C":var U=!1,V=!1,ie=!1,W=!1,z=-1,G=-1;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"A":break;case"X":y=parseInt(L[v].slice(1))-1,V=!0;break;case"Y":for(h=parseInt(L[v].slice(1))-1,V||(y=0),T=E.length;T<=h;++T)E[T]=[];break;case"K":P=L[v].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(Gs(P))?isNaN(Pd(P).getDate())||(P=Aa(P)):(P=Gs(P),B!==null&&pl(B)&&(P=xm(P))),typeof _r<"u"&&typeof P=="string"&&(u||{}).type!="string"&&(u||{}).codepage&&(P=_r.utils.decode(u.codepage,P)),U=!0;break;case"E":W=!0;var b=Td(L[v].slice(1),{r:h,c:y});E[h][y]=[E[h][y],b];break;case"S":ie=!0,E[h][y]=[E[h][y],"S5S"];break;case"G":break;case"R":z=parseInt(L[v].slice(1))-1;break;case"C":G=parseInt(L[v].slice(1))-1;break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}if(U&&(E[h][y]&&E[h][y].length==2?E[h][y][0]=P:E[h][y]=P,B=null),ie){if(W)throw new Error("SYLK shared formula cannot have own formula");var k=z>-1&&E[z][G];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");E[h][y][1]=O5(k[1],{r:h-z,c:y-G})}break;case"F":var j=0;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"X":y=parseInt(L[v].slice(1))-1,++j;break;case"Y":for(h=parseInt(L[v].slice(1))-1,T=E.length;T<=h;++T)E[T]=[];break;case"M":M=parseInt(L[v].slice(1))/20;break;case"F":break;case"G":break;case"P":B=D[parseInt(L[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=L[v].slice(1).split(" "),T=parseInt(O[0],10);T<=parseInt(O[1],10);++T)M=parseInt(O[2],10),S[T-1]=M===0?{hidden:!0}:{wch:M},sc(S[T-1]);break;case"C":y=parseInt(L[v].slice(1))-1,S[y]||(S[y]={});break;case"R":h=parseInt(L[v].slice(1))-1,_[h]||(_[h]={}),M>0?(_[h].hpt=M,_[h].hpx=qd(M)):M===0&&(_[h].hidden=!0);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}j<1&&(B=null);break;default:if(u&&u.WTF)throw new Error("SYLK bad record "+R)}}return _.length>0&&(I["!rows"]=_),S.length>0&&(I["!cols"]=S),u&&u.sheetRows&&(E=E.slice(0,u.sheetRows)),[E,I]}function o(p,u){var g=n(p,u),h=g[0],y=g[1],x=Yd(h,u);return Oa(y).forEach(function(v){x[v]=y[v]}),x}function A(p,u){return pc(o(p,u),u)}function c(p,u,g,h){var y="C;Y"+(g+1)+";X"+(h+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+ny(p.f,{r:g,c:h}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function l(p,u){u.forEach(function(g,h){var y="F;W"+(h+1)+" "+(h+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Qf(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=qf(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function d(p,u){u.forEach(function(g,h){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*Kf(g.hpx)+";"),y.length>2&&p.push(y+"R"+(h+1))})}function f(p,u){var g=["ID;PWXL;N;E"],h=[],y=gr(p["!ref"]),x,v=Array.isArray(p),E=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&l(g,p["!cols"]),p["!rows"]&&d(g,p["!rows"]),g.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var D=y.s.r;D<=y.e.r;++D)for(var B=y.s.c;B<=y.e.c;++B){var I=$t({r:D,c:B});x=v?(p[D]||[])[B]:p[I],!(!x||x.v==null&&(!x.f||x.F))&&h.push(c(x,p,D,B))}return g.join(E)+E+h.join(E)+E+"E"+E}return{to_workbook:A,to_sheet:o,from_sheet:f}}(),u5=function(){function e(s,o){switch(o.type){case"base64":return t(rs(s),o);case"binary":return t(s,o);case"buffer":return t(lr&&Buffer.isBuffer(s)?s.toString("binary"):fc(s),o);case"array":return t(ol(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var A=s.split(`
`),c=-1,l=-1,d=0,f=[];d!==A.length;++d){if(A[d].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var p=A[d].trim().split(","),u=p[0],g=p[1];++d;for(var h=A[d]||"";(h.match(/["]/g)||[]).length&1&&d<A.length-1;)h+=`
`+A[++d];switch(h=h.trim(),+u){case-1:if(h==="BOT"){f[++c]=[],l=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?f[c][l]=!0:h==="FALSE"?f[c][l]=!1:isNaN(Gs(g))?isNaN(Pd(g).getDate())?f[c][l]=g:f[c][l]=Aa(g):f[c][l]=Gs(g),++l;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),f[c][l++]=h!==""?h:null;break}if(h==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return Yd(e(s,o),o)}function a(s,o){return pc(r(s,o),o)}var n=function(){var s=function(c,l,d,f,p){c.push(l),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,l,d,f){c.push(l+","+d),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],d=gr(c["!ref"]),f,p=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,d.e.r-d.s.r+1,""),s(l,"TUPLES",0,d.e.c-d.s.c+1,""),s(l,"DATA",0,0,"");for(var u=d.s.r;u<=d.e.r;++u){o(l,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var h=$t({r:u,c:g});if(f=p?(c[u]||[])[g]:c[h],!f){o(l,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(l,1,0,"="+f.f):o(l,1,0,""):o(l,0,y,"V");break;case"b":o(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=as(f.z||Kt[14],cn(Aa(f.v)))),o(l,0,f.w,"V");break;default:o(l,1,0,"")}}}o(l,-1,0,"EOD");var x=`\r
`,v=l.join(x);return v}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),f5=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var u=f.split(`
`),g=-1,h=-1,y=0,x=[];y!==u.length;++y){var v=u[y].trim().split(":");if(v[0]==="cell"){var E=ma(v[1]);if(x.length<=E.r)for(g=x.length;g<=E.r;++g)x[g]||(x[g]=[]);switch(g=E.r,h=E.c,v[2]){case"t":x[g][h]=e(v[3]);break;case"v":x[g][h]=+v[3];break;case"vtf":var D=v[v.length-1];case"vtc":switch(v[3]){case"nl":x[g][h]=!!+v[4];break;default:x[g][h]=+v[4];break}v[2]=="vtf"&&(x[g][h]=[x[g][h],D])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function a(f,p){return Yd(r(f,p),p)}function n(f,p){return pc(a(f,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,A=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var p=[],u=[],g,h="",y=gi(f["!ref"]),x=Array.isArray(f),v=y.s.r;v<=y.e.r;++v)for(var E=y.s.c;E<=y.e.c;++E)if(h=$t({r:v,c:E}),g=x?(f[v]||[])[E]:f[h],!(!g||g.v==null||g.t==="z")){switch(u=["cell",h,"t"],g.t){case"s":case"str":u.push(t(g.v));break;case"n":g.f?(u[2]="vtf",u[3]="n",u[4]=g.v,u[5]=t(g.f)):(u[2]="v",u[3]=g.v);break;case"b":u[2]="vt"+(g.f?"f":"c"),u[3]="nl",u[4]=g.v?"1":"0",u[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var D=cn(Aa(g.v));u[2]="vtc",u[3]="nd",u[4]=""+D,u[5]=g.w||as(g.z||Kt[14],D);break;case"e":continue}p.push(u.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[s,o,A,o,l(f),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}}(),Qd=function(){function e(d,f,p,u,g){g.raw?f[p][u]=d:d===""||(d==="TRUE"?f[p][u]=!0:d==="FALSE"?f[p][u]=!1:isNaN(Gs(d))?isNaN(Pd(d).getDate())?f[p][u]=d:f[p][u]=Aa(d):f[p][u]=Gs(d))}function t(d,f){var p=f||{},u=[];if(!d||d.length===0)return u;for(var g=d.split(/[\r\n]/),h=g.length-1;h>=0&&g[h].length===0;)--h;for(var y=10,x=0,v=0;v<=h;++v)x=g[v].indexOf(" "),x==-1?x=g[v].length:x++,y=Math.max(y,x);for(v=0;v<=h;++v){u[v]=[];var E=0;for(e(g[v].slice(0,y).trim(),u,v,E,p),E=1;E<=(g[v].length-y)/10+1;++E)e(g[v].slice(y+(E-1)*10,y+E*10).trim(),u,v,E,p)}return p.sheetRows&&(u=u.slice(0,p.sheetRows)),u}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var f={},p=!1,u=0,g=0;u<d.length;++u)(g=d.charCodeAt(u))==34?p=!p:!p&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u]);if(!g.length){f=a;for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&g.push([f[u],u])}return g.sort(function(h,y){return h[0]-y[0]||a[h[1]]-a[y[1]]}),r[g.pop()[1]]||44}function s(d,f){var p=f||{},u="",g=p.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(u=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(u=d.charAt(4),d=d.slice(6)):u=n(d.slice(0,1024)):p&&p.FS?u=p.FS:u=n(d.slice(0,1024));var y=0,x=0,v=0,E=0,D=0,B=u.charCodeAt(0),I=!1,_=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var O=p.dateNF!=null?e3(p.dateNF):null;function M(){var T=d.slice(E,D),R={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)R.t="z";else if(p.raw)R.t="s",R.v=T;else if(T.trim().length===0)R.t="s",R.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(R.t="s",R.v=T.slice(2,-1).replace(/""/g,'"')):Ik(T)?(R.t="n",R.f=T.slice(1)):(R.t="s",R.v=T);else if(T=="TRUE")R.t="b",R.v=!0;else if(T=="FALSE")R.t="b",R.v=!1;else if(!isNaN(v=Gs(T)))R.t="n",p.cellText!==!1&&(R.w=T),R.v=v;else if(!isNaN(Pd(T).getDate())||O&&T.match(O)){R.z=p.dateNF||Kt[14];var L=0;O&&T.match(O)&&(T=t3(T,p.dateNF,T.match(O)||[]),L=1),p.cellDates?(R.t="d",R.v=Aa(T,L)):(R.t="n",R.v=cn(Aa(T,L))),p.cellText!==!1&&(R.w=as(R.z,R.v instanceof Date?cn(R.v):R.v)),p.cellNF||delete R.z}else R.t="s",R.v=T;if(R.t=="z"||(p.dense?(g[y]||(g[y]=[]),g[y][x]=R):g[$t({c:x,r:y})]=R),E=D+1,S=d.charCodeAt(E),h.e.c<x&&(h.e.c=x),h.e.r<y&&(h.e.r=y),_==B)++x;else if(x=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;D<d.length;++D)switch(_=d.charCodeAt(D)){case 34:S===34&&(I=!I);break;case B:case 10:case 13:if(!I&&M())break e;break}return D-E>0&&M(),g["!ref"]=or(h),g}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):Yd(t(d,f),f)}function A(d,f){var p="",u=f.type=="string"?[0,0,0,0]:fy(d,f);switch(f.type){case"base64":p=rs(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof _r<"u"?p=_r.utils.decode(f.codepage,d):p=lr&&Buffer.isBuffer(d)?d.toString("binary"):fc(d);break;case"array":p=ol(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return u[0]==239&&u[1]==187&&u[2]==191?p=Hr(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Hr(p):f.type=="binary"&&typeof _r<"u"&&f.codepage&&(p=_r.utils.decode(f.codepage,_r.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?f5.to_sheet(f.type=="string"?p:Hr(p),f):o(p,f)}function c(d,f){return pc(A(d,f),f)}function l(d){for(var f=[],p=gr(d["!ref"]),u,g=Array.isArray(d),h=p.s.r;h<=p.e.r;++h){for(var y=[],x=p.s.c;x<=p.e.c;++x){var v=$t({r:h,c:x});if(u=g?(d[h]||[])[x]:d[v],!u||u.v==null){y.push("          ");continue}for(var E=(u.w||(mo(u),u.w)||"").slice(0,10);E.length<10;)E+=" ";y.push(E+(x===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:A,from_sheet:l}}();function mR(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=d5.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return Qd.to_workbook(e,t)}}var Wc=function(){function e(b,k,j){if(b){Bn(b,b.l||0);for(var q=j.Enum||z;b.l<b.length;){var Y=b.read_shift(2),de=q[Y]||q[65535],ue=b.read_shift(2),pe=b.l+ue,ye=de.f&&de.f(b,ue,j);if(b.l=pe,k(ye,de,Y))return}}}function t(b,k){switch(k.type){case"base64":return r($i(rs(b)),k);case"binary":return r($i(b),k);case"buffer":case"array":return r(b,k)}throw"Unsupported type "+k.type}function r(b,k){if(!b)return b;var j=k||{},q=j.dense?[]:{},Y="Sheet1",de="",ue=0,pe={},ye=[],ve=[],ae={s:{r:0,c:0},e:{r:0,c:0}},Ke=j.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)j.Enum=z,e(b,function(He,Ze,$e){switch($e){case 0:j.vers=He,He>=4096&&(j.qpro=!0);break;case 6:ae=He;break;case 204:He&&(de=He);break;case 222:de=He;break;case 15:case 51:j.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:$e==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=j.dateNF||Kt[14],j.cellDates&&(He[1].t="d",He[1].v=xm(He[1].v))),j.qpro&&He[3]>ue&&(q["!ref"]=or(ae),pe[Y]=q,ye.push(Y),q=j.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},ue=He[3],Y=de||"Sheet"+(ue+1),de="");var et=j.dense?(q[He[0].r]||[])[He[0].c]:q[$t(He[0])];if(et){et.t=He[1].t,et.v=He[1].v,He[1].z!=null&&(et.z=He[1].z),He[1].f!=null&&(et.f=He[1].f);break}j.dense?(q[He[0].r]||(q[He[0].r]=[]),q[He[0].r][He[0].c]=He[1]):q[$t(He[0])]=He[1];break}},j);else if(b[2]==26||b[2]==14)j.Enum=G,b[2]==14&&(j.qpro=!0,b.l=0),e(b,function(He,Ze,$e){switch($e){case 204:Y=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>ue&&(q["!ref"]=or(ae),pe[Y]=q,ye.push(Y),q=j.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},ue=He[3],Y="Sheet"+(ue+1)),Ke>0&&He[0].r>=Ke)break;j.dense?(q[He[0].r]||(q[He[0].r]=[]),q[He[0].r][He[0].c]=He[1]):q[$t(He[0])]=He[1],ae.e.c<He[0].c&&(ae.e.c=He[0].c),ae.e.r<He[0].r&&(ae.e.r=He[0].r);break;case 27:He[14e3]&&(ve[He[14e3][0]]=He[14e3][1]);break;case 1537:ve[He[0]]=He[1],He[0]==ue&&(Y=He[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(q["!ref"]=or(ae),pe[de||Y]=q,ye.push(de||Y),!ve.length)return{SheetNames:ye,Sheets:pe};for(var Ee={},me=[],le=0;le<ve.length;++le)pe[ye[le]]?(me.push(ve[le]||ye[le]),Ee[ve[le]]=pe[ve[le]]||pe[ye[le]]):(me.push(ve[le]),Ee[ve[le]]={"!ref":"A1"});return{SheetNames:me,Sheets:Ee}}function a(b,k){var j=k||{};if(+j.codepage>=0&&Es(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Fi(),Y=gr(b["!ref"]),de=Array.isArray(b),ue=[];xt(q,0,s(1030)),xt(q,6,c(Y));for(var pe=Math.min(Y.e.r,8191),ye=Y.s.r;ye<=pe;++ye)for(var ve=Sa(ye),ae=Y.s.c;ae<=Y.e.c;++ae){ye===Y.s.r&&(ue[ae]=oa(ae));var Ke=ue[ae]+ve,Ee=de?(b[ye]||[])[ae]:b[Ke];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?xt(q,13,u(ye,ae,Ee.v)):xt(q,14,h(ye,ae,Ee.v));else{var me=mo(Ee);xt(q,15,f(ye,ae,me.slice(0,239)))}}return xt(q,1),q.end()}function n(b,k){var j=k||{};if(+j.codepage>=0&&Es(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Fi();xt(q,0,o(b));for(var Y=0,de=0;Y<b.SheetNames.length;++Y)(b.Sheets[b.SheetNames[Y]]||{})["!ref"]&&xt(q,27,W(b.SheetNames[Y],de++));var ue=0;for(Y=0;Y<b.SheetNames.length;++Y){var pe=b.Sheets[b.SheetNames[Y]];if(!(!pe||!pe["!ref"])){for(var ye=gr(pe["!ref"]),ve=Array.isArray(pe),ae=[],Ke=Math.min(ye.e.r,8191),Ee=ye.s.r;Ee<=Ke;++Ee)for(var me=Sa(Ee),le=ye.s.c;le<=ye.e.c;++le){Ee===ye.s.r&&(ae[le]=oa(le));var He=ae[le]+me,Ze=ve?(pe[Ee]||[])[le]:pe[He];if(!(!Ze||Ze.t=="z"))if(Ze.t=="n")xt(q,23,M(Ee,le,ue,Ze.v));else{var $e=mo(Ze);xt(q,22,_(Ee,le,ue,$e.slice(0,239)))}}++ue}}return xt(q,1),q.end()}function s(b){var k=Je(2);return k.write_shift(2,b),k}function o(b){var k=Je(26);k.write_shift(2,4096),k.write_shift(2,4),k.write_shift(4,0);for(var j=0,q=0,Y=0,de=0;de<b.SheetNames.length;++de){var ue=b.SheetNames[de],pe=b.Sheets[ue];if(!(!pe||!pe["!ref"])){++Y;var ye=gi(pe["!ref"]);j<ye.e.r&&(j=ye.e.r),q<ye.e.c&&(q=ye.e.c)}}return j>8191&&(j=8191),k.write_shift(2,j),k.write_shift(1,Y),k.write_shift(1,q),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(1,1),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(4,0),k}function A(b,k,j){var q={s:{c:0,r:0},e:{c:0,r:0}};return k==8&&j.qpro?(q.s.c=b.read_shift(1),b.l++,q.s.r=b.read_shift(2),q.e.c=b.read_shift(1),b.l++,q.e.r=b.read_shift(2),q):(q.s.c=b.read_shift(2),q.s.r=b.read_shift(2),k==12&&j.qpro&&(b.l+=2),q.e.c=b.read_shift(2),q.e.r=b.read_shift(2),k==12&&j.qpro&&(b.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function c(b){var k=Je(8);return k.write_shift(2,b.s.c),k.write_shift(2,b.s.r),k.write_shift(2,b.e.c),k.write_shift(2,b.e.r),k}function l(b,k,j){var q=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(q[0].c=b.read_shift(1),q[3]=b.read_shift(1),q[0].r=b.read_shift(2),b.l+=2):(q[2]=b.read_shift(1),q[0].c=b.read_shift(2),q[0].r=b.read_shift(2)),q}function d(b,k,j){var q=b.l+k,Y=l(b,k,j);if(Y[1].t="s",j.vers==20768){b.l++;var de=b.read_shift(1);return Y[1].v=b.read_shift(de,"utf8"),Y}return j.qpro&&b.l++,Y[1].v=b.read_shift(q-b.l,"cstr"),Y}function f(b,k,j){var q=Je(7+j.length);q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,b),q.write_shift(1,39);for(var Y=0;Y<q.length;++Y){var de=j.charCodeAt(Y);q.write_shift(1,de>=128?95:de)}return q.write_shift(1,0),q}function p(b,k,j){var q=l(b,k,j);return q[1].v=b.read_shift(2,"i"),q}function u(b,k,j){var q=Je(7);return q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,b),q.write_shift(2,j,"i"),q}function g(b,k,j){var q=l(b,k,j);return q[1].v=b.read_shift(8,"f"),q}function h(b,k,j){var q=Je(13);return q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,b),q.write_shift(8,j,"f"),q}function y(b,k,j){var q=b.l+k,Y=l(b,k,j);if(Y[1].v=b.read_shift(8,"f"),j.qpro)b.l=q;else{var de=b.read_shift(2);D(b.slice(b.l,b.l+de),Y),b.l+=de}return Y}function x(b,k,j){var q=k&32768;return k&=-32769,k=(q?b:0)+(k>=8192?k-16384:k),(q?"":"$")+(j?oa(k):Sa(k))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(b,k){Bn(b,0);for(var j=[],q=0,Y="",de="",ue="",pe="";b.l<b.length;){var ye=b[b.l++];switch(ye){case 0:j.push(b.read_shift(8,"f"));break;case 1:de=x(k[0].c,b.read_shift(2),!0),Y=x(k[0].r,b.read_shift(2),!1),j.push(de+Y);break;case 2:{var ve=x(k[0].c,b.read_shift(2),!0),ae=x(k[0].r,b.read_shift(2),!1);de=x(k[0].c,b.read_shift(2),!0),Y=x(k[0].r,b.read_shift(2),!1),j.push(ve+ae+":"+de+Y)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(b.read_shift(2));break;case 6:{for(var Ke="";ye=b[b.l++];)Ke+=String.fromCharCode(ye);j.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:pe=j.pop(),ue=j.pop(),j.push(["AND","OR"][ye-20]+"("+ue+","+pe+")");break;default:if(ye<32&&E[ye])pe=j.pop(),ue=j.pop(),j.push(ue+E[ye]+pe);else if(v[ye]){if(q=v[ye][1],q==69&&(q=b[b.l++]),q>j.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+j.join("|")+"|");return}var Ee=j.slice(-q);j.length-=q,j.push(v[ye][0]+"("+Ee.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}j.length==1?k[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function B(b){var k=[{c:0,r:0},{t:"n",v:0},0];return k[0].r=b.read_shift(2),k[3]=b[b.l++],k[0].c=b[b.l++],k}function I(b,k){var j=B(b);return j[1].t="s",j[1].v=b.read_shift(k-4,"cstr"),j}function _(b,k,j,q){var Y=Je(6+q.length);Y.write_shift(2,b),Y.write_shift(1,j),Y.write_shift(1,k),Y.write_shift(1,39);for(var de=0;de<q.length;++de){var ue=q.charCodeAt(de);Y.write_shift(1,ue>=128?95:ue)}return Y.write_shift(1,0),Y}function S(b,k){var j=B(b);j[1].v=b.read_shift(2);var q=j[1].v>>1;if(j[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return j[1].v=q,j}function O(b,k){var j=B(b),q=b.read_shift(4),Y=b.read_shift(4),de=b.read_shift(2);if(de==65535)return q===0&&Y===3221225472?(j[1].t="e",j[1].v=15):q===0&&Y===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ue=de&32768;return de=(de&32767)-16446,j[1].v=(1-ue*2)*(Y*Math.pow(2,de+32)+q*Math.pow(2,de)),j}function M(b,k,j,q){var Y=Je(14);if(Y.write_shift(2,b),Y.write_shift(1,j),Y.write_shift(1,k),q==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var de=0,ue=0,pe=0,ye=0;return q<0&&(de=1,q=-q),ue=Math.log2(q)|0,q/=Math.pow(2,ue-31),ye=q>>>0,ye&2147483648||(q/=2,++ue,ye=q>>>0),q-=ye,ye|=2147483648,ye>>>=0,q*=Math.pow(2,32),pe=q>>>0,Y.write_shift(4,pe),Y.write_shift(4,ye),ue+=16383+(de?32768:0),Y.write_shift(2,ue),Y}function T(b,k){var j=O(b);return b.l+=k-14,j}function R(b,k){var j=B(b),q=b.read_shift(4);return j[1].v=q>>6,j}function L(b,k){var j=B(b),q=b.read_shift(8,"f");return j[1].v=q,j}function N(b,k){var j=L(b);return b.l+=k-10,j}function P(b,k){return b[b.l+k-1]==0?b.read_shift(k,"cstr"):""}function U(b,k){var j=b[b.l++];j>k-1&&(j=k-1);for(var q="";q.length<j;)q+=String.fromCharCode(b[b.l++]);return q}function V(b,k,j){if(!(!j.qpro||k<21)){var q=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var Y=b.read_shift(k-21,"cstr");return[q,Y]}}function ie(b,k){for(var j={},q=b.l+k;b.l<q;){var Y=b.read_shift(2);if(Y==14e3){for(j[Y]=[0,""],j[Y][0]=b.read_shift(2);b[b.l];)j[Y][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return j}function W(b,k){var j=Je(5+b.length);j.write_shift(2,14e3),j.write_shift(2,k);for(var q=0;q<b.length;++q){var Y=b.charCodeAt(q);j[j.l++]=Y>127?95:Y}return j[j.l++]=0,j}var z={0:{n:"BOF",f:Ya},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:A},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:U},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:N},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function gR(e){var t={},r=e.match(ti),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Xt(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=S2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var xR=function(){var e=jf("t"),t=jf("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var A={t:"s",v:Sr(o[1])},c=s.match(t);return c&&(A.s=gR(c[1])),A}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(A){return A.v})}}(),yR=function(){var t=/(\r\n|\n)/g;function r(n,s,o){var A=[];n.u&&A.push("text-decoration: underline;"),n.uval&&A.push("text-underline-style:"+n.uval+";"),n.sz&&A.push("font-size:"+n.sz+"pt;"),n.outline&&A.push("text-effect: outline;"),n.shadow&&A.push("text-shadow: auto;"),s.push('<span style="'+A.join("")+'">'),n.b&&(s.push("<b>"),o.push("</b>")),n.i&&(s.push("<i>"),o.push("</i>")),n.strike&&(s.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),vR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wR=/<(?:\w+:)?r>/,ER=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Z2(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Sr(Hr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Hr(e),r&&(a.h=D2(a.t))):e.match(wR)&&(a.r=Hr(e),a.t=Sr(Hr((e.replace(ER,"").match(vR)||[]).join("").replace(ti,""))),r&&(a.h=yR(xR(a.r)))),a):{t:""}}var _R=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bR=/<(?:\w+:)?(?:si|sstItem)>/g,CR=/<\/(?:\w+:)?(?:si|sstItem)>/;function BR(e,t){var r=[],a="";if(!e)return r;var n=e.match(_R);if(n){a=n[2].replace(bR,"").split(CR);for(var s=0;s!=a.length;++s){var o=Z2(a[s].trim(),t);o!=null&&(r[r.length]=o)}n=Xt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var SR=/^\s|\s$|[\t\n\r]/;function p5(e,t){if(!t.bookSST)return"";var r=[Qa];r[r.length]=gt("sst",null,{xmlns:hl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(SR)&&(s+=' xml:space="preserve"'),s+=">"+Pr(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function TR(e){return[e.read_shift(4),e.read_shift(4)]}function OR(e,t){var r=[],a=!1;return iA(e,function(s,o,A){switch(A){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),r}function IR(e,t){return t||(t=Je(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var NR=Q3;function FR(e){var t=Fi();it(t,159,IR(e));for(var r=0;r<e.length;++r)it(t,19,NR(e[r]));return it(t,160),t.end()}function h5(e){if(typeof _r<"u")return _r.utils.encode(il,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Xo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function RR(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xo(e,4),t.U=Xo(e,4),t.W=Xo(e,4),t}function kR(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function DR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(kR(e));return t}function jR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function LR(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xo(e,4),t.U=Xo(e,4),t.W=Xo(e,4),t}function UR(e){var t=LR(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function m5(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function g5(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function MR(e){var t=Xo(e);switch(t.Minor){case 2:return[t.Minor,PR(e)];case 3:return[t.Minor,QR()];case 4:return[t.Minor,qR(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PR(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=m5(e,r),n=g5(e,e.length-e.l);return{t:"Std",h:a,v:n}}function QR(){throw new Error("File is password-protected: ECMA-376 Extensible")}function qR(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ti,function(s){var o=Xt(s);switch(xo(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(A){a[A]=o[A]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function KR(e,t){var r={},a=r.EncryptionVersionInfo=Xo(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=m5(e,n),t-=n,r.EncryptionVerifier=g5(e,t),r}function HR(e){var t={},r=t.EncryptionVersionInfo=Xo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ey(e){var t=0,r,a=h5(e),n=a.length+1,s,o,A,c,l;for(r=ic(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)o=r[s],A=t&16384?1:0,c=t<<1&32767,l=A|c,t=l^o;return t^52811}var x5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,A){return a(o^A)},s=function(o){for(var A=t[o.length-1],c=104,l=o.length-1;l>=0;--l)for(var d=o[l],f=0;f!=7;++f)d&64&&(A^=r[c]),d*=2,--c;return A};return function(o){for(var A=h5(o),c=s(A),l=A.length,d=ic(16),f=0;f!=16;++f)d[f]=0;var p,u,g;for((l&1)===1&&(p=c>>8,d[l]=n(e[0],p),--l,p=c&255,u=A[A.length-1],d[l]=n(u,p));l>0;)--l,p=c>>8,d[l]=n(A[l],p),--l,p=c&255,d[l]=n(A[l],p);for(l=15,g=15-A.length;g>0;)p=c>>8,d[l]=n(e[g],p),--l,--g,p=c&255,d[l]=n(A[l],p),--l,--g;return d}}(),GR=function(e,t,r,a,n){n||(n=t),a||(a=x5(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=a[r],o=(o>>5|o<<3)&255,n[s]=o,++r;return[n,r,a]},zR=function(e){var t=0,r=x5(e);return function(a){var n=GR("",a,t,r);return t=n[1],n[0]}};function VR(e,t,r,a){var n={key:Ya(e),verificationBytes:Ya(e)};return r.password&&(n.verifier=ey(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=zR(r.password)),n}function $R(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=HR(e):a.Data=KR(e,t),a}function YR(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?$R(e,t-2,a):VR(e,r.biff>=8?t:t-2,r,a),a}var y5=function(){function e(n,s){switch(s.type){case"base64":return t(rs(n),s);case"binary":return t(n,s);case"buffer":return t(lr&&Buffer.isBuffer(n)?n.toString("binary"):fc(n),s);case"array":return t(ol(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var o=s||{},A=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(A)&&(A[f]=[]);for(var p=/\\\w+\b/g,u=0,g,h=-1;g=p.exec(d);){switch(g[0]){case"\\cell":var y=d.slice(u,p.lastIndex-g[0].length);if(y[0]==" "&&(y=y.slice(1)),++h,y.length){var x={v:y,t:"s"};Array.isArray(A)?A[f][h]=x:A[$t({r:f,c:h})]=x}break}u=p.lastIndex}h>l.e.c&&(l.e.c=h)}),A["!ref"]=or(l),A}function r(n,s){return pc(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],o=gr(n["!ref"]),A,c=Array.isArray(n),l=o.s.r;l<=o.e.r;++l){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=$t({r:l,c:d});A=c?(n[l]||[])[d]:n[f],!(!A||A.v==null&&(!A.f||A.F))&&(s.push(" "+(A.w||(mo(A),A.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function WR(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Pf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function XR(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),o=n-s;if(o===0)return[0,0,t];var A=0,c=0,l=n+s;switch(c=o/(l>1?2-l:l),n){case t:A=((r-a)/o+6)%6;break;case r:A=(a-t)/o+2;break;case a:A=(t-r)/o+4;break}return[A/6,c,l/2]}function JR(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,o=[s,s,s],A=6*t,c;if(r!==0)switch(A|0){case 0:case 6:c=n*A,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-A),o[0]+=c,o[1]+=n;break;case 2:c=n*(A-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-A),o[1]+=c,o[2]+=n;break;case 4:c=n*(A-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-A),o[2]+=c,o[0]+=n;break}for(var l=0;l!=3;++l)o[l]=Math.round(o[l]*255);return o}function kh(e,t){if(t===0)return e;var r=XR(WR(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Pf(JR(r))}var v5=6,ZR=15,e6=1,Gn=v5;function Qf(e){return Math.floor((e+Math.round(128/Gn)/256)*Gn)}function qf(e){return Math.floor((e-5)/Gn*100+.5)/100}function Dh(e){return Math.round((e*Gn+5)/Gn*256)/256}function Og(e){return Dh(qf(Qf(e)))}function ty(e){var t=Math.abs(e-Og(e)),r=Gn;if(t>.005)for(Gn=e6;Gn<ZR;++Gn)Math.abs(e-Og(e))<=t&&(t=Math.abs(e-Og(e)),r=Gn);Gn=r}function sc(e){e.width?(e.wpx=Qf(e.width),e.wch=qf(e.wpx),e.MDW=Gn):e.wpx?(e.wch=qf(e.wpx),e.width=Dh(e.wch),e.MDW=Gn):typeof e.wch=="number"&&(e.width=Dh(e.wch),e.wpx=Qf(e.width),e.MDW=Gn),e.customWidth&&delete e.customWidth}var t6=96,w5=t6;function Kf(e){return e*96/w5}function qd(e){return e*w5/96}var r6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function a6(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(ti)||[]).forEach(function(o){var A=Xt(o);switch(xo(A[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},A.diagonalUp&&(n.diagonalUp=na(A.diagonalUp)),A.diagonalDown&&(n.diagonalDown=na(A.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in borders")}})}function n6(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(ti)||[]).forEach(function(o){var A=Xt(o);switch(xo(A[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":A.patternType&&(n.patternType=A.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),A.indexed&&(n.bgColor.indexed=parseInt(A.indexed,10)),A.theme&&(n.bgColor.theme=parseInt(A.theme,10)),A.tint&&(n.bgColor.tint=parseFloat(A.tint)),A.rgb&&(n.bgColor.rgb=A.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),A.theme&&(n.fgColor.theme=parseInt(A.theme,10)),A.tint&&(n.fgColor.tint=parseFloat(A.tint)),A.rgb!=null&&(n.fgColor.rgb=A.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in fills")}})}function i6(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(ti)||[]).forEach(function(o){var A=Xt(o);switch(xo(A[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":A.val&&(n.name=Hr(A.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=A.val?na(A.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=A.val?na(A.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(A.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=A.val?na(A.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=A.val?na(A.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=A.val?na(A.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=A.val?na(A.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=A.val?na(A.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":A.val&&(n.sz=+A.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":A.val&&(n.vertAlign=A.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":A.val&&(n.family=parseInt(A.val,10));break;case"<family/>":case"</family>":break;case"<scheme":A.val&&(n.scheme=A.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(A.val=="1")break;A.codepage=S2[parseInt(A.val,10)];break;case"<color":if(n.color||(n.color={}),A.auto&&(n.color.auto=na(A.auto)),A.rgb)n.color.rgb=A.rgb.slice(-6);else if(A.indexed){n.color.index=parseInt(A.indexed,10);var c=$c[n.color.index];n.color.index==81&&(c=$c[1]),c||(c=$c[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else A.theme&&(n.color.theme=parseInt(A.theme,10),A.tint&&(n.color.tint=parseFloat(A.tint)),A.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=kh(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in fonts")}})}function s6(e,t,r){t.NumberFmt=[];for(var a=Oa(Kt),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Kt[a[n]];var s=e[0].match(ti);if(s)for(n=0;n<s.length;++n){var o=Xt(s[n]);switch(xo(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var A=Sr(Hr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=A,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=A}po(A,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function o6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=gt("numFmt",null,{numFmtId:a,formatCode:Pr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=gt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var up=["numFmtId","fillId","fontId","borderId","xfId"],fp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function A6(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(ti)||[]).forEach(function(s){var o=Xt(s),A=0;switch(xo(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],A=0;A<up.length;++A)a[up[A]]&&(a[up[A]]=parseInt(a[up[A]],10));for(A=0;A<fp.length;++A)a[fp[A]]&&(a[fp[A]]=na(a[fp[A]]));if(t.NumberFmt&&a.numFmtId>392){for(A=392;A>60;--A)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[A]){a.numFmtId=A;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=na(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function c6(e){var t=[];return t[t.length]=gt("cellXfs",null),e.forEach(function(r){t[t.length]=gt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=gt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var l6=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(A,c,l){var d={};if(!A)return d;A=A.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=A.match(t))&&s6(f,d,l),(f=A.match(n))&&i6(f,d,c,l),(f=A.match(a))&&n6(f,d,c,l),(f=A.match(s))&&a6(f,d,c,l),(f=A.match(r))&&A6(f,d,l),d}}();function E5(e,t){var r=[Qa,gt("styleSheet",null,{xmlns:hl[0],"xmlns:vt":on.vt})],a;return e.SSF&&(a=o6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=c6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function d6(e,t){var r=e.read_shift(2),a=Jn(e);return[r,a]}function u6(e,t,r){r||(r=Je(6+4*t.length)),r.write_shift(2,e),yn(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function f6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=$3(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var A=e.read_shift(1);A>0&&(a.family=A);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=V3(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Jn(e),a}function p6(e,t){t||(t=Je(25+4*32)),t.write_shift(2,e.sz*20),Y3(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Nh(e.color,t);var a=0;return a=2,t.write_shift(1,a),yn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var h6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ig,m6=ei;function O4(e,t){t||(t=Je(4*3+8*7+16*1)),Ig||(Ig=mm(h6));var r=Ig[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Nh({auto:1},t),Nh({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function g6(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function _5(e,t,r){r||(r=Je(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Su(e,t){return t||(t=Je(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var x6=ei;function y6(e,t){return t||(t=Je(51)),t.write_shift(1,0),Su(null,t),Su(null,t),Su(null,t),Su(null,t),Su(null,t),t.length>t.l?t.slice(0,t.l):t}function v6(e,t){return t||(t=Je(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ih(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function w6(e,t,r){var a=Je(2052);return a.write_shift(4,e),Ih(t,a),Ih(r,a),a.length>a.l?a.slice(0,a.l):a}function E6(e,t,r){var a={};a.NumberFmt=[];for(var n in Kt)a.NumberFmt[n]=Kt[n];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return iA(e,function(c,l,d){switch(d){case 44:a.NumberFmt[c[0]]=c[1],po(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=kh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(l.T>0)s.push(d);else if(l.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function _6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(it(e,615,zs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&it(e,44,u6(n,t[n]))}),it(e,616))}}function b6(e){var t=1;it(e,611,zs(t)),it(e,43,p6({sz:12,color:{theme:1},name:"Calibri",family:2})),it(e,612)}function C6(e){var t=2;it(e,603,zs(t)),it(e,45,O4({patternType:"none"})),it(e,45,O4({patternType:"gray125"})),it(e,604)}function B6(e){var t=1;it(e,613,zs(t)),it(e,46,y6()),it(e,614)}function S6(e){var t=1;it(e,626,zs(t)),it(e,47,_5({numFmtId:0},65535)),it(e,627)}function T6(e,t){it(e,617,zs(t.length)),t.forEach(function(r){it(e,47,_5(r,0))}),it(e,618)}function O6(e){var t=1;it(e,619,zs(t)),it(e,48,v6({xfId:0,name:"Normal"})),it(e,620)}function I6(e){var t=0;it(e,505,zs(t)),it(e,506)}function N6(e){var t=0;it(e,508,w6(t,"TableStyleMedium9","PivotStyleMedium4")),it(e,509)}function F6(e,t){var r=Fi();return it(r,278),_6(r,e.SSF),b6(r),C6(r),B6(r),S6(r),T6(r,t.cellXfs),O6(r),I6(r),N6(r),it(r,279),r.end()}var R6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function k6(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ti)||[]).forEach(function(n){var s=Xt(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[R6.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function D6(){}function j6(){}var L6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,U6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,M6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function P6(e,t,r){t.themeElements={};var a;[["clrScheme",L6,k6],["fontScheme",U6,D6],["fmtScheme",M6,j6]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var Q6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function b5(e,t){(!e||e.length===0)&&(e=ry());var r,a={};if(!(r=e.match(Q6)))throw new Error("themeElements not found in theme");return P6(r[0],a,t),a.raw=e,a}function ry(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qa];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function q6(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var o;try{o=vb(s,{type:"array"})}catch{return}var A=Yi(o,"theme/theme/theme1.xml",!0);if(A)return b5(A,r)}}function K6(e){return e.read_shift(4)}function H6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=G6(e,4);break;case 2:t.xclrValue=a5(e);break;case 3:t.xclrValue=K6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function G6(e,t){return ei(e,t)}function z6(e,t){return ei(e,t)}function V6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=H6(e);break;case 6:a[1]=z6(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function $6(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(V6(e,r-e.l));return{ixfe:a,ext:s}}function Y6(e,t){t.forEach(function(r){switch(r[0]){}})}function W6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jn(e)}}function X6(e){var t=Je(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yn(e.name,t),t.slice(0,t.l)}function J6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Z6(e){var t=Je(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function ek(e,t){var r=Je(8+2*t.length);return r.write_shift(4,e),yn(t,r),r.slice(0,r.l)}function tk(e){return e.l+=4,e.read_shift(4)!=0}function rk(e,t){var r=Je(8);return r.write_shift(4,e),r.write_shift(4,1),r}function ak(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],o=!1,A=2;return iA(e,function(c,l,d){switch(d){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){A==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):A==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:A=c?1:0;break;case 338:A=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!l.T){if(!o||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function nk(){var e=Fi();return it(e,332),it(e,334,zs(1)),it(e,335,X6({name:"XLDAPR",version:12e4,flags:3496657072})),it(e,336),it(e,339,ek(1,"XLDAPR")),it(e,52),it(e,35,zs(514)),it(e,4096,zs(0)),it(e,4097,vs(1)),it(e,36),it(e,53),it(e,340),it(e,337,rk(1)),it(e,51,Z6([[1,0]])),it(e,338),it(e,333),e.end()}function ik(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,o;return e.replace(ti,function(A){var c=Xt(A);switch(xo(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(o=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):s==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return A}),a}function C5(){var e=[Qa];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function sk(e){var t=[];if(!e)return t;var r=1;return(e.match(ti)||[]).forEach(function(a){var n=Xt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function ok(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$t(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Ak(e,t,r){var a=[];return iA(e,function(s,o,A){switch(A){case 63:a.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+A.toString(16))}}),a}function ck(e,t,r,a){if(!e)return e;var n=a||{},s=!1;iA(e,function(A,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function lk(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var vd=1024;function B5(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[gt("xml",null,{"xmlns:v":Vi.v,"xmlns:o":Vi.o,"xmlns:x":Vi.x,"xmlns:mv":Vi.mv}).replace(/\/>/,">"),gt("o:shapelayout",gt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),gt("v:shapetype",[gt("v:stroke",null,{joinstyle:"miter"}),gt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];vd<e*1e3;)vd+=1e3;return t.forEach(function(s){var o=ma(s[0]),A={color2:"#BEFF82",type:"gradient"};A.type=="gradient"&&(A.angle="-180");var c=A.type=="gradient"?gt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=gt("v:fill",c,A),d={on:"t",obscured:"t"};++vd,n=n.concat(["<v:shape"+Lf({id:"_x0000_s"+vd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,gt("v:shadow",null,d),gt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Tn("x:AutoFill","False"),Tn("x:Row",String(o.r)),Tn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function I4(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(o){var A=ma(o.ref);if(n?(e[A.r]||(e[A.r]=[]),s=e[A.r][A.c]):s=e[o.ref],!s){s={t:"z"},n?e[A.r][A.c]=s:e[o.ref]=s;var c=gr(e["!ref"]||"BDWGO1000001:A1");c.s.r>A.r&&(c.s.r=A.r),c.e.r<A.r&&(c.e.r=A.r),c.s.c>A.c&&(c.s.c=A.c),c.e.c<A.c&&(c.e.c=A.c);var l=or(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(d.a==a[f].id){d.a=a[f].name||d.a;break}}s.c.push(d)})}function dk(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var A=o.match(/<(?:\w+:)?author[^>]*>(.*)/);A&&r.push(A[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var A=o.match(/<(?:\w+:)?comment[^>]*>/);if(A){var c=Xt(A[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ma(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&Z2(f[1])||{r:"",t:"",h:""};l.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),l.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=p.h),a.push(l)}}}}),a}function S5(e){var t=[Qa,gt("comments",null,{xmlns:hl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=Pr(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(Pr(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Tn("t",Pr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,A=1;A<s.length;++A)o+=`Reply:
    `+s[A]+`
`;t.push(Tn("t",Pr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function uk(e,t){var r=[],a=!1,n={},s=0;return e.replace(ti,function(A,c){var l=Xt(A);switch(xo(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=c+A.length;break;case"</text>":n.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return A}),r}function fk(e,t,r){var a=[Qa,gt("ThreadedComments",null,{xmlns:on.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(o,A){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};A==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(gt("threadedComment",Tn("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function pk(e,t){var r=[],a=!1;return e.replace(ti,function(s){var o=Xt(s);switch(xo(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function hk(e){var t=[Qa,gt("personList",null,{xmlns:on.TCMNT,"xmlns:x":hl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(gt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function mk(e){var t={};t.iauthor=e.read_shift(4);var r=yl(e);return t.rfx=r.s,t.ref=$t(r.s),e.l+=16,t}function gk(e,t){return t==null&&(t=Je(36)),t.write_shift(4,e[1].iauthor),Wd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var xk=Jn;function yk(e){return yn(e.slice(0,54))}function vk(e,t){var r=[],a=[],n={},s=!1;return iA(e,function(A,c,l){switch(l){case 632:a.push(A);break;case 635:n=A;break;case 637:n.t=A.t,n.h=A.h,n.r=A.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function wk(e){var t=Fi(),r=[];return it(t,628),it(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),it(t,632,yk(n.a)))})}),it(t,631),it(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:ma(a[0]),e:ma(a[0])};it(t,635,gk([s,n])),n.t&&n.t.length>0&&it(t,637,K3(n)),it(t,636),delete n.iauthor})}),it(t,634),it(t,629),t.end()}var Ek="application/vnd.ms-office.vbaProject";function _k(e){var t=Lt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Lt.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Lt.write(t)}function bk(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Lt.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var T5=["xlsb","xlsm","xlam","biff8","xla"];function Ck(){return{"!type":"dialog"}}function Bk(){return{"!type":"dialog"}}function Sk(){return{"!type":"macro"}}function Tk(){return{"!type":"macro"}}var Td=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,o){var A=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?A=!0:o.charAt(0)=="["&&(A=!0,o=o.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return A?d+=t.c:--d,c?l+=t.r:--l,n+(A?"":"$")+oa(d)+(c?"":"$")+Sa(l)}return function(n,s){return t=s,n.replace(e,r)}}(),ay=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ny=function(){return function(t,r){return t.replace(ay,function(a,n,s,o,A,c){var l=H2(o)-(s?0:r.c),d=K2(c)-(A?0:r.r),f=d==0?"":A?d+1:"["+d+"]",p=l==0?"":s?l+1:"["+l+"]";return n+"R"+f+"C"+p})}}();function O5(e,t){return e.replace(ay,function(r,a,n,s,o,A){return a+(n=="$"?n+s:oa(H2(s)+t.c))+(o=="$"?o+A:Sa(K2(A)+t.r))})}function Ok(e,t,r){var a=gi(t),n=a.s,s=ma(r),o={r:s.r-n.r,c:s.c-n.c};return O5(e,o)}function Ik(e){return e.length!=1}function N4(e){return e.replace(/_xlfn\./g,"")}function Ga(e){e.l+=1}function oc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function I5(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return N5(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),o=oc(e),A=oc(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:A[0],cRel:A[1],rRel:A[2]}}}function N5(e){var t=oc(e),r=oc(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Nk(e,t,r){if(r.biff<8)return N5(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=oc(e),o=oc(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function F5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Fk(e);var a=e.read_shift(r&&r.biff==12?4:2),n=oc(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Fk(e){var t=oc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Rk(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kk(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Dk(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,A=(s&32768)>>15;if(s&=16383,A==1)for(;n>524287;)n-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:o,rRel:A}}function Dk(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function jk(e,t,r){var a=(e[e.l++]&96)>>5,n=I5(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function Lk(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=I5(e,s,r);return[a,n,o]}function Uk(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Mk(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function Pk(e,t,r){var a=(e[e.l++]&96)>>5,n=Nk(e,t-1,r);return[a,n]}function Qk(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function F4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function qk(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function Kk(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Hk(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Gk(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function zk(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function R5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Vk(e){return e.read_shift(2),R5(e)}function $k(e){return e.read_shift(2),R5(e)}function Yk(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=F5(e,0,r);return[a,n]}function Wk(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=kk(e,0,r);return[a,n]}function Xk(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=F5(e,0,r);return[a,n,s]}function Jk(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[t8[n],j5[n],a]}function Zk(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:eD(e);return[n,(s[0]===0?j5:e8)[s[1]]]}function eD(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function tD(e,t,r){e.l+=r&&r.biff==2?3:4}function rD(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function aD(e){return e.l++,sA[e.read_shift(1)]}function nD(e){return e.l++,e.read_shift(2)}function iD(e){return e.l++,e.read_shift(1)!==0}function sD(e){return e.l++,$n(e)}function oD(e,t,r){return e.l++,o0(e,t-1,r)}function AD(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ra(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=sA[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$n(e);break;case 2:r[1]=vl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cD(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?yl:vm)(e));return n}function lD(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var A=0;A!=n;++A)o[s][A]=AD(e,r.biff);return o}function dD(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function uD(e,t,r){if(r.biff==5)return fD(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function fD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function pD(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function hD(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function mD(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function gD(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var xD=ei,yD=ei,vD=ei;function c0(e,t,r){return e.l+=2,[Rk(e)]}function iy(e){return e.l+=6,[]}var wD=c0,ED=iy,_D=iy,bD=c0;function k5(e){return e.l+=2,[Ya(e),e.read_shift(2)&1]}var CD=c0,BD=k5,SD=iy,TD=c0,OD=c0,ID=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ND(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),o=ID[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:s}}function FD(e){return e.l+=2,[e.read_shift(4)]}function RD(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function kD(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function DD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function LD(e){return e.l+=4,[0,0]}var R4={1:{n:"PtgExp",f:rD},2:{n:"PtgTbl",f:vD},3:{n:"PtgAdd",f:Ga},4:{n:"PtgSub",f:Ga},5:{n:"PtgMul",f:Ga},6:{n:"PtgDiv",f:Ga},7:{n:"PtgPower",f:Ga},8:{n:"PtgConcat",f:Ga},9:{n:"PtgLt",f:Ga},10:{n:"PtgLe",f:Ga},11:{n:"PtgEq",f:Ga},12:{n:"PtgGe",f:Ga},13:{n:"PtgGt",f:Ga},14:{n:"PtgNe",f:Ga},15:{n:"PtgIsect",f:Ga},16:{n:"PtgUnion",f:Ga},17:{n:"PtgRange",f:Ga},18:{n:"PtgUplus",f:Ga},19:{n:"PtgUminus",f:Ga},20:{n:"PtgPercent",f:Ga},21:{n:"PtgParen",f:Ga},22:{n:"PtgMissArg",f:Ga},23:{n:"PtgStr",f:oD},26:{n:"PtgSheet",f:RD},27:{n:"PtgEndSheet",f:kD},28:{n:"PtgErr",f:aD},29:{n:"PtgBool",f:iD},30:{n:"PtgInt",f:nD},31:{n:"PtgNum",f:sD},32:{n:"PtgArray",f:Qk},33:{n:"PtgFunc",f:Jk},34:{n:"PtgFuncVar",f:Zk},35:{n:"PtgName",f:dD},36:{n:"PtgRef",f:Yk},37:{n:"PtgArea",f:jk},38:{n:"PtgMemArea",f:pD},39:{n:"PtgMemErr",f:xD},40:{n:"PtgMemNoMem",f:yD},41:{n:"PtgMemFunc",f:hD},42:{n:"PtgRefErr",f:mD},43:{n:"PtgAreaErr",f:Uk},44:{n:"PtgRefN",f:Wk},45:{n:"PtgAreaN",f:Pk},46:{n:"PtgMemAreaN",f:DD},47:{n:"PtgMemNoMemN",f:jD},57:{n:"PtgNameX",f:uD},58:{n:"PtgRef3d",f:Xk},59:{n:"PtgArea3d",f:Lk},60:{n:"PtgRefErr3d",f:gD},61:{n:"PtgAreaErr3d",f:Mk},255:{}},UD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},MD={1:{n:"PtgElfLel",f:k5},2:{n:"PtgElfRw",f:TD},3:{n:"PtgElfCol",f:wD},6:{n:"PtgElfRwV",f:OD},7:{n:"PtgElfColV",f:bD},10:{n:"PtgElfRadical",f:CD},11:{n:"PtgElfRadicalS",f:SD},13:{n:"PtgElfColS",f:ED},15:{n:"PtgElfColSV",f:_D},16:{n:"PtgElfRadicalLel",f:BD},25:{n:"PtgList",f:ND},29:{n:"PtgSxName",f:FD},255:{}},PD={0:{n:"PtgAttrNoop",f:LD},1:{n:"PtgAttrSemi",f:zk},2:{n:"PtgAttrIf",f:Hk},4:{n:"PtgAttrChoose",f:qk},8:{n:"PtgAttrGoto",f:Kk},16:{n:"PtgAttrSum",f:tD},32:{n:"PtgAttrBaxcel",f:F4},33:{n:"PtgAttrBaxcel",f:F4},64:{n:"PtgAttrSpace",f:Vk},65:{n:"PtgAttrSpaceSemi",f:$k},128:{n:"PtgAttrIfError",f:Gk},255:{}};function l0(e,t,r,a){if(a.biff<8)return ei(e,t);for(var n=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=lD(e,0,a),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=cD(e,r[o][1],a),s.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&s.push(ei(e,t)),s}function d0(e,t,r){for(var a=e.l+t,n,s,o=[];a!=e.l;)t=a-e.l,s=e[e.l],n=R4[s]||R4[UD[s]],(s===24||s===25)&&(n=(s===24?MD:PD)[e[e.l+1]]),!n||!n.f?ei(e,t):o.push([n.n,n.f(e,t,r)]);return o}function QD(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var qD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KD(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function D5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function k4(e,t,r){var a=D5(e,t,r);return a=="#REF"?a:KD(a,r)}function Kn(e,t,r,a,n){var s=n&&n.biff||8,o={s:{c:0,r:0}},A=[],c,l,d,f=0,p=0,u,g="";if(!e[0]||!e[0][0])return"";for(var h=-1,y="",x=0,v=e[0].length;x<v;++x){var E=e[0][x];switch(E[0]){case"PtgUminus":A.push("-"+A.pop());break;case"PtgUplus":A.push("+"+A.pop());break;case"PtgPercent":A.push(A.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=A.pop(),l=A.pop(),h>=0){switch(e[0][h][1][0]){case 0:y=ba(" ",e[0][h][1][1]);break;case 1:y=ba("\r",e[0][h][1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}l=l+y,h=-1}A.push(l+qD[E[0]]+c);break;case"PtgIsect":c=A.pop(),l=A.pop(),A.push(l+" "+c);break;case"PtgUnion":c=A.pop(),l=A.pop(),A.push(l+","+c);break;case"PtgRange":c=A.pop(),l=A.pop(),A.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=cf(E[1][1],o,n),A.push(lf(d,s));break;case"PtgRefN":d=r?cf(E[1][1],r,n):E[1][1],A.push(lf(d,s));break;case"PtgRef3d":f=E[1][1],d=cf(E[1][2],o,n),g=k4(a,f,n),A.push(g+"!"+lf(d,s));break;case"PtgFunc":case"PtgFuncVar":var D=E[1][0],B=E[1][1];D||(D=0),D&=127;var I=D==0?[]:A.slice(-D);A.length-=D,B==="User"&&(B=I.shift()),A.push(B+"("+I.join(",")+")");break;case"PtgBool":A.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":A.push(E[1]);break;case"PtgNum":A.push(String(E[1]));break;case"PtgStr":A.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":A.push(E[1]);break;case"PtgAreaN":u=c4(E[1][1],r?{s:r}:o,n),A.push(Bg(u,n));break;case"PtgArea":u=c4(E[1][1],o,n),A.push(Bg(u,n));break;case"PtgArea3d":f=E[1][1],u=E[1][2],g=k4(a,f,n),A.push(g+"!"+Bg(u,n));break;case"PtgAttrSum":A.push("SUM("+A.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=E[1][2];var _=(a.names||[])[p-1]||(a[0]||[])[p],S=_?_.Name:"SH33TJSNAME"+String(p);S&&S.slice(0,6)=="_xlfn."&&!n.xlfn&&(S=S.slice(6)),A.push(S);break;case"PtgNameX":var O=E[1][1];p=E[1][2];var M;if(n.biff<=5)O<0&&(O=-O),a[O]&&(M=a[O][p]);else{var T="";if(((a[O]||[])[0]||[])[0]==14849||(((a[O]||[])[0]||[])[0]==1025?a[O][p]&&a[O][p].itab>0&&(T=a.SheetNames[a[O][p].itab-1]+"!"):T=a.SheetNames[p-1]+"!"),a[O]&&a[O][p])T+=a[O][p].Name;else if(a[0]&&a[0][p])T+=a[0][p].Name;else{var R=(D5(a,O,n)||"").split(";;");R[p-1]?T=R[p-1]:T+="SH33TJSERRX"}A.push(T);break}M||(M={Name:"SH33TJSERRY"}),A.push(M.Name);break;case"PtgParen":var L="(",N=")";if(h>=0){switch(y="",e[0][h][1][0]){case 2:L=ba(" ",e[0][h][1][1])+L;break;case 3:L=ba("\r",e[0][h][1][1])+L;break;case 4:N=ba(" ",e[0][h][1][1])+N;break;case 5:N=ba("\r",e[0][h][1][1])+N;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}A.push(L+A.pop()+N);break;case"PtgRefErr":A.push("#REF!");break;case"PtgRefErr3d":A.push("#REF!");break;case"PtgExp":d={c:E[1][1],r:E[1][0]};var P={c:r.c,r:r.r};if(a.sharedf[$t(d)]){var U=a.sharedf[$t(d)];A.push(Kn(U,o,P,a,n))}else{var V=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(d.c<l[0].s.c||d.c>l[0].e.c)&&!(d.r<l[0].s.r||d.r>l[0].e.r)){A.push(Kn(l[1],o,P,a,n)),V=!0;break}V||A.push(E[1])}break;case"PtgArray":A.push("{"+QD(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":A.push("");break;case"PtgAreaErr":A.push("#REF!");break;case"PtgAreaErr3d":A.push("#REF!");break;case"PtgList":A.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&h>=0&&ie.indexOf(e[0][x][0])==-1){E=e[0][h];var W=!0;switch(E[1][0]){case 4:W=!1;case 0:y=ba(" ",E[1][1]);break;case 5:W=!1;case 1:y=ba("\r",E[1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}A.push((W?y:"")+A.pop()+(W?"":y)),h=-1}}if(A.length>1&&n.WTF)throw new Error("bad formula stack");return A[0]}function HD(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],ei(e,t-2)];var A=d0(e,o,r);return t!==o+n&&(s=l0(e,t-o-n,A,r)),e.l=a,[A,s]}function GD(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],ei(e,t-2)];var A=d0(e,o,r);return t!==o+n&&(s=l0(e,t-o-n,A,r)),e.l=a,[A,s]}function zD(e,t,r,a){var n=e.l+t,s=d0(e,a,r),o;return n!==e.l&&(o=l0(e,n-e.l,s,r)),[s,o]}function VD(e,t,r){var a=e.l+t,n,s=e.read_shift(2),o=d0(e,s,r);return s==65535?[[],ei(e,t-2)]:(t!==s+2&&(n=l0(e,a-s-2,o,r)),[o,n])}function $D(e){var t;if(zo(e,e.l+6)!==65535)return[$n(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function YD(e){if(e==null){var t=Je(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Al(e);return Al(0)}function Ng(e,t,r){var a=e.l+t,n=yo(e);r.biff==2&&++e.l;var s=$D(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var A=GD(e,a-e.l,r);return{cell:n,val:s[0],formula:A,shared:o>>3&1,tt:s[1]}}function WD(e,t,r,a,n){var s=ll(t,r,n),o=YD(e.v),A=Je(6),c=33;A.write_shift(2,c),A.write_shift(4,0);for(var l=Je(e.bf.length),d=0;d<e.bf.length;++d)l[d]=e.bf[d];var f=xn([s,o,A,l]);return f}function wm(e,t,r){var a=e.read_shift(4),n=d0(e,a,r),s=e.read_shift(4),o=s>0?l0(e,s,n,r):null;return[n,o]}var XD=wm,Em=wm,JD=wm,ZD=wm,e8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function D4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r8(e){var t="of:="+e.replace(ay,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function a8(e){return e.replace(/\./,"!")}var uf={},Od={},ff=typeof Map<"u";function sy(e,t,r){var a=0,n=e.length;if(r){if(ff?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ff?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(ff?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function _m(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Gn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=qf(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Dh(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Xc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function hc(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){po(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function L5(e,t,r,a,n,s){try{a.cellNF&&(e.z=Kt[t])}catch(A){if(a.WTF)throw A}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Aa(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Kt[t]==null&&po(ZI[t]||"General",t),e.t==="e")e.w=e.w||sA[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Df(e.v);else if(e.t==="d"){var o=cn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Df(o)}else{if(e.v===void 0)return"";e.w=sl(e.v,Od)}else e.t==="d"?e.w=as(t,cn(e.v),Od):e.w=as(t,e.v,Od)}catch(A){if(a.WTF)throw A}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=kh(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=kh(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(A){if(a.WTF&&s.Fills)throw A}}}function n8(e,t,r){if(e&&e["!ref"]){var a=gr(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function i8(e,t){var r=gr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=or(r))}var s8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,o8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,A8=/<(?:\w:)?hyperlink [^>]*>/mg,c8=/"(\w*:\w*)"/,l8=/<(?:\w:)?col\b[^>]*[\/]?>/g,d8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,u8=/<(?:\w:)?pageMargins[^>]*\/>/g,U5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,f8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,p8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function h8(e,t,r,a,n,s,o){if(!e)return e;a||(a={"!id":{}});var A=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",d="",f=e.match(o8);f?(l=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):l=d=e;var p=l.match(U5);p?oy(p[0],A,n,r):(p=l.match(f8))&&g8(p[0],p[1]||"",A,n,r);var u=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var g=l.slice(u,u+50).match(c8);g&&i8(A,g[1])}var h=l.match(p8);h&&h[1]&&I8(h[1],n);var y=[];if(t.cellStyles){var x=l.match(l8);x&&C8(y,x)}f&&R8(f[1],A,t,c,s,o);var v=d.match(d8);v&&(A["!autofilter"]=S8(v[0]));var E=[],D=d.match(s8);if(D)for(u=0;u!=D.length;++u)E[u]=gr(D[u].slice(D[u].indexOf('"')+1));var B=d.match(A8);B&&E8(A,B,a);var I=d.match(u8);if(I&&(A["!margins"]=_8(Xt(I[0]))),!A["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(A["!ref"]=or(c)),t.sheetRows>0&&A["!ref"]){var _=gr(A["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),A["!fullref"]=A["!ref"],A["!ref"]=or(_))}return y.length>0&&(A["!cols"]=y),E.length>0&&(A["!merges"]=E),A}function m8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+or(e[r])+'"/>';return t+"</mergeCells>"}function oy(e,t,r,a){var n=Xt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Sr(Hr(n.codeName)))}function g8(e,t,r,a,n){oy(e.slice(0,e.indexOf(">")),r,a,n)}function x8(e,t,r,a,n){var s=!1,o={},A=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=lo(Pr(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),A=(A||"")+gt("outlinePr",null,l)}!s&&!A||(n[n.length]=gt("sheetPr",A,o))}var y8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],v8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function w8(e){var t={sheet:1};return y8.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),v8.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ey(e.password).toString(16).toUpperCase()),gt("sheetProtection",null,t)}function E8(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=Xt(Hr(t[n]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Sr(s.location))):(s.Target="#"+Sr(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var A=gr(s.ref),c=A.s.r;c<=A.e.r;++c)for(var l=A.s.c;l<=A.e.c;++l){var d=$t({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function _8(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function b8(e){return Xc(e),gt("pageMargins",null,e)}function C8(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Xt(t[a],!0);n.hidden&&(n.hidden=na(n.hidden));var s=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,ty(n.width)),sc(n);s<=o;)e[s++]=Zr(n)}}function B8(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=gt("col",null,_m(n,a)));return r[r.length]="</cols>",r.join("")}function S8(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function T8(e,t,r,a){var n=typeof e.ref=="string"?e.ref:or(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=gi(n);o.s.r==o.e.r&&(o.e.r=gi(t["!ref"]).e.r,n=or(o));for(var A=0;A<s.length;++A){var c=s[A];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return A==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),gt("autoFilter",null,{ref:n})}var O8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function I8(e,t){t.Views||(t.Views=[{}]),(e.match(O8)||[]).forEach(function(r,a){var n=Xt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),na(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function N8(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),gt("sheetViews",gt("sheetView",null,n),{})}function F8(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=sA[e.v];break;case"d":a&&a.cellDates?n=Aa(e.v,-1).toISOString():(e=Zr(e),e.t="n",n=""+(e.v=cn(Aa(e.v)))),typeof e.z>"u"&&(e.z=Kt[14]);break;default:n=e.v;break}var A=Tn("v",Pr(n)),c={r:t},l=hc(a.cellXfs,e,a);switch(l!==0&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){A=Tn("v",""+sy(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;A=gt("f",Pr(e.f),d)+(e.v!=null?A:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),gt("c",A,c)}var R8=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=jf("v"),o=jf("f");return function(c,l,d,f,p,u){for(var g=0,h="",y=[],x=[],v=0,E=0,D=0,B="",I,_,S=0,O=0,M,T,R=0,L=0,N=Array.isArray(u.CellXf),P,U=[],V=[],ie=Array.isArray(l),W=[],z={},G=!1,b=!!d.sheetStubs,k=c.split(t),j=0,q=k.length;j!=q;++j){h=k[j].trim();var Y=h.length;if(Y!==0){var de=0;e:for(g=0;g<Y;++g)switch(h[g]){case">":if(h[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(_=Xt(h.slice(de,g),!0),S=_.r!=null?parseInt(_.r,10):S+1,O=-1,d.sheetRows&&d.sheetRows<S)continue;z={},G=!1,_.ht&&(G=!0,z.hpt=parseFloat(_.ht),z.hpx=qd(z.hpt)),_.hidden=="1"&&(G=!0,z.hidden=!0),_.outlineLevel!=null&&(G=!0,z.level=+_.outlineLevel),G&&(W[S-1]=z)}break;case"<":de=g;break}if(de>=g)break;if(_=Xt(h.slice(de,g),!0),S=_.r!=null?parseInt(_.r,10):S+1,O=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(z={},G=!1,_.ht&&(G=!0,z.hpt=parseFloat(_.ht),z.hpx=qd(z.hpt)),_.hidden=="1"&&(G=!0,z.hidden=!0),_.outlineLevel!=null&&(G=!0,z.level=+_.outlineLevel),G&&(W[S-1]=z)),y=h.slice(g).split(e);for(var ue=0;ue!=y.length&&y[ue].trim().charAt(0)=="<";++ue);for(y=y.slice(ue),g=0;g!=y.length;++g)if(h=y[g].trim(),h.length!==0){if(x=h.match(r),v=g,E=0,D=0,h="<c "+(h.slice(0,1)=="<"?">":"")+h,x!=null&&x.length===2){for(v=0,B=x[1],E=0;E!=B.length&&!((D=B.charCodeAt(E)-64)<1||D>26);++E)v=26*v+D;--v,O=v}else++O;for(E=0;E!=h.length&&h.charCodeAt(E)!==62;++E);if(++E,_=Xt(h.slice(0,E),!0),_.r||(_.r=$t({r:S-1,c:O})),B=h.slice(E),I={t:""},(x=B.match(s))!=null&&x[1]!==""&&(I.v=Sr(x[1])),d.cellFormula){if((x=B.match(o))!=null&&x[1]!==""){if(I.f=Sr(Hr(x[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=N4(I.f)),x[0].indexOf('t="array"')>-1)I.F=(B.match(n)||[])[1],I.F.indexOf(":")>-1&&U.push([gr(I.F),I.F]);else if(x[0].indexOf('t="shared"')>-1){T=Xt(x[0]);var pe=Sr(Hr(x[1]));d.xlfn||(pe=N4(pe)),V[parseInt(T.si,10)]=[T,pe,_.r]}}else(x=B.match(/<f[^>]*\/>/))&&(T=Xt(x[0]),V[T.si]&&(I.f=Ok(V[T.si][1],V[T.si][2],_.r)));var ye=ma(_.r);for(E=0;E<U.length;++E)ye.r>=U[E][0].s.r&&ye.r<=U[E][0].e.r&&ye.c>=U[E][0].s.c&&ye.c<=U[E][0].e.c&&(I.F=U[E][1])}if(_.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(b)I.t="z";else continue;else I.t=_.t||"n";switch(f.s.c>O&&(f.s.c=O),f.e.c<O&&(f.e.c=O),I.t){case"n":if(I.v==""||I.v==null){if(!b)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!b)continue;I.t="z"}else M=uf[parseInt(I.v,10)],I.v=M.t,I.r=M.r,d.cellHTML&&(I.h=M.h);break;case"str":I.t="s",I.v=I.v!=null?Hr(I.v):"",d.cellHTML&&(I.h=D2(I.v));break;case"inlineStr":x=B.match(a),I.t="s",x!=null&&(M=Z2(x[1]))?(I.v=M.t,d.cellHTML&&(I.h=M.h)):I.v="";break;case"b":I.v=na(I.v);break;case"d":d.cellDates?I.v=Aa(I.v,1):(I.v=cn(Aa(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=Pb[I.v];break}if(R=L=0,P=null,N&&_.s!==void 0&&(P=u.CellXf[_.s],P!=null&&(P.numFmtId!=null&&(R=P.numFmtId),d.cellStyles&&P.fillId!=null&&(L=P.fillId))),L5(I,R,L,d,p,u),d.cellDates&&N&&I.t=="n"&&pl(Kt[R])&&(I.t="d",I.v=xm(I.v)),_.cm&&d.xlmeta){var ve=(d.xlmeta.Cell||[])[+_.cm-1];ve&&ve.type=="XLDAPR"&&(I.D=!0)}if(ie){var ae=ma(_.r);l[ae.r]||(l[ae.r]=[]),l[ae.r][ae.c]=I}else l[_.r]=I}}}}W.length>0&&(l["!rows"]=W)}}();function k8(e,t,r,a){var n=[],s=[],o=gr(e["!ref"]),A="",c,l="",d=[],f=0,p=0,u=e["!rows"],g=Array.isArray(e),h={r:l},y,x=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=oa(p);for(f=o.s.r;f<=o.e.r;++f){for(s=[],l=Sa(f),p=o.s.c;p<=o.e.c;++p){c=d[p]+l;var v=g?(e[f]||[])[p]:e[c];v!==void 0&&(A=F8(v,c,e,t))!=null&&s.push(A)}(s.length>0||u&&u[f])&&(h={r:l},u&&u[f]&&(y=u[f],y.hidden&&(h.hidden=1),x=-1,y.hpx?x=Kf(y.hpx):y.hpt&&(x=y.hpt),x>-1&&(h.ht=x,h.customHeight=1),y.level&&(h.outlineLevel=y.level)),n[n.length]=gt("row",s.join(""),h))}if(u)for(;f<u.length;++f)u&&u[f]&&(h={r:f+1},y=u[f],y.hidden&&(h.hidden=1),x=-1,y.hpx?x=Kf(y.hpx):y.hpt&&(x=y.hpt),x>-1&&(h.ht=x,h.customHeight=1),y.level&&(h.outlineLevel=y.level),n[n.length]=gt("row","",h));return n.join("")}function M5(e,t,r,a){var n=[Qa,gt("worksheet",null,{xmlns:hl[0],"xmlns:r":on.r})],s=r.SheetNames[e],o=0,A="",c=r.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",d=gr(l);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),l=or(d)}a||(a={}),c["!comments"]=[];var f=[];x8(c,r,e,t,n),n[n.length]=gt("dimension",null,{ref:l}),n[n.length]=N8(c,t,e,r),t.sheetFormat&&(n[n.length]=gt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=B8(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(A=k8(c,t),A.length>0&&(n[n.length]=A)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=w8(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=T8(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=m8(c["!merges"]));var p=-1,u,g=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(h){h[1].Target&&(u={ref:h[0]},h[1].Target.charAt(0)!="#"&&(g=Mr(a,-1,Pr(h[1].Target).replace(/#.*$/,""),ur.HLINK),u["r:id"]="rId"+g),(p=h[1].Target.indexOf("#"))>-1&&(u.location=Pr(h[1].Target.slice(p+1))),h[1].Tooltip&&(u.tooltip=Pr(h[1].Tooltip)),n[n.length]=gt("hyperlink",null,u))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=b8(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Tn("ignoredErrors",gt("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(g=Mr(a,-1,"../drawings/drawing"+(e+1)+".xml",ur.DRAW),n[n.length]=gt("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Mr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ur.VML),n[n.length]=gt("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function D8(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function j8(e,t,r){var a=Je(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=Kf(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var A=0,c=a.l;a.l+=4;for(var l={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,p=-1,u=d<<10;u<d+1<<10;++u){l.c=u;var g=Array.isArray(r)?(r[l.r]||[])[l.c]:r[$t(l)];g&&(f<0&&(f=u),p=u)}f<0||(++A,a.write_shift(4,f),a.write_shift(4,p))}var h=a.l;return a.l=c,a.write_shift(4,A),a.l=h,a.length>a.l?a.slice(0,a.l):a}function L8(e,t,r,a){var n=j8(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&it(e,0,n)}var U8=yl,M8=Wd;function P8(){}function Q8(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=H3(e),r}function q8(e,t,r){r==null&&(r=Je(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Nh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Db(e,r),r.slice(0,r.l)}function K8(e){var t=Os(e);return[t]}function H8(e,t,r){return r==null&&(r=Je(8)),ml(t,r)}function G8(e){var t=gl(e);return[t]}function z8(e,t,r){return r==null&&(r=Je(4)),xl(t,r)}function V8(e){var t=Os(e),r=e.read_shift(1);return[t,r,"b"]}function $8(e,t,r){return r==null&&(r=Je(9)),ml(t,r),r.write_shift(1,e.v?1:0),r}function Y8(e){var t=gl(e),r=e.read_shift(1);return[t,r,"b"]}function W8(e,t,r){return r==null&&(r=Je(5)),xl(t,r),r.write_shift(1,e.v?1:0),r}function X8(e){var t=Os(e),r=e.read_shift(1);return[t,r,"e"]}function J8(e,t,r){return r==null&&(r=Je(9)),ml(t,r),r.write_shift(1,e.v),r}function Z8(e){var t=gl(e),r=e.read_shift(1);return[t,r,"e"]}function ej(e,t,r){return r==null&&(r=Je(8)),xl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function tj(e){var t=Os(e),r=e.read_shift(4);return[t,r,"s"]}function rj(e,t,r){return r==null&&(r=Je(12)),ml(t,r),r.write_shift(4,t.v),r}function aj(e){var t=gl(e),r=e.read_shift(4);return[t,r,"s"]}function nj(e,t,r){return r==null&&(r=Je(8)),xl(t,r),r.write_shift(4,t.v),r}function ij(e){var t=Os(e),r=$n(e);return[t,r,"n"]}function sj(e,t,r){return r==null&&(r=Je(16)),ml(t,r),Al(e.v,r),r}function P5(e){var t=gl(e),r=$n(e);return[t,r,"n"]}function oj(e,t,r){return r==null&&(r=Je(12)),xl(t,r),Al(e.v,r),r}function Aj(e){var t=Os(e),r=$2(e);return[t,r,"n"]}function cj(e,t,r){return r==null&&(r=Je(12)),ml(t,r),jb(e.v,r),r}function lj(e){var t=gl(e),r=$2(e);return[t,r,"n"]}function dj(e,t,r){return r==null&&(r=Je(8)),xl(t,r),jb(e.v,r),r}function uj(e){var t=Os(e),r=G2(e);return[t,r,"is"]}function fj(e){var t=Os(e),r=Jn(e);return[t,r,"str"]}function pj(e,t,r){return r==null&&(r=Je(12+4*e.v.length)),ml(t,r),yn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hj(e){var t=gl(e),r=Jn(e);return[t,r,"str"]}function mj(e,t,r){return r==null&&(r=Je(8+4*e.v.length)),xl(t,r),yn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function gj(e,t,r){var a=e.l+t,n=Os(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"b"];if(r.cellFormula){e.l+=2;var A=Em(e,a-e.l,r);o[3]=Kn(A,null,n,r.supbooks,r)}else e.l=a;return o}function xj(e,t,r){var a=e.l+t,n=Os(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"e"];if(r.cellFormula){e.l+=2;var A=Em(e,a-e.l,r);o[3]=Kn(A,null,n,r.supbooks,r)}else e.l=a;return o}function yj(e,t,r){var a=e.l+t,n=Os(e);n.r=r["!row"];var s=$n(e),o=[n,s,"n"];if(r.cellFormula){e.l+=2;var A=Em(e,a-e.l,r);o[3]=Kn(A,null,n,r.supbooks,r)}else e.l=a;return o}function vj(e,t,r){var a=e.l+t,n=Os(e);n.r=r["!row"];var s=Jn(e),o=[n,s,"str"];if(r.cellFormula){e.l+=2;var A=Em(e,a-e.l,r);o[3]=Kn(A,null,n,r.supbooks,r)}else e.l=a;return o}var wj=yl,Ej=Wd;function _j(e,t){return t==null&&(t=Je(4)),t.write_shift(4,e),t}function bj(e,t){var r=e.l+t,a=yl(e),n=z2(e),s=Jn(e),o=Jn(e),A=Jn(e);e.l=r;var c={rfx:a,relId:n,loc:s,display:A};return o&&(c.Tooltip=o),c}function Cj(e,t){var r=Je(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Wd({s:ma(e[0]),e:ma(e[0])},r),V2("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return yn(n||"",r),yn(e[1].Tooltip||"",r),yn("",r),r.slice(0,r.l)}function Bj(){}function Sj(e,t,r){var a=e.l+t,n=Lb(e),s=e.read_shift(1),o=[n];if(o[2]=s,r.cellFormula){var A=XD(e,a-e.l,r);o[1]=A}else e.l=a;return o}function Tj(e,t,r){var a=e.l+t,n=yl(e),s=[n];if(r.cellFormula){var o=ZD(e,a-e.l,r);s[1]=o,e.l=a}else e.l=a;return s}function Oj(e,t,r){r==null&&(r=Je(18));var a=_m(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var Q5=["left","right","top","bottom","header","footer"];function Ij(e){var t={};return Q5.forEach(function(r){t[r]=$n(e)}),t}function Nj(e,t){return t==null&&(t=Je(6*8)),Xc(e),Q5.forEach(function(r){Al(e[r],t)}),t}function Fj(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Rj(e,t,r){r==null&&(r=Je(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function kj(e){var t=Je(24);return t.write_shift(4,4),t.write_shift(4,1),Wd(e,t),t}function Dj(e,t){return t==null&&(t=Je(16*4+2)),t.write_shift(2,e.password?ey(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function jj(){}function Lj(){}function Uj(e,t,r,a,n,s,o){if(!e)return e;var A=t||{};a||(a={"!id":{}});var c=A.dense?[]:{},l,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,u,g,h,y,x,v,E,D,B,I=[];A.biff=12,A["!row"]=0;var _=0,S=!1,O=[],M={},T=A.supbooks||n.supbooks||[[]];if(T.sharedf=M,T.arrayf=O,T.SheetNames=n.SheetNames||n.Sheets.map(function(ie){return ie.name}),!A.supbooks&&(A.supbooks=T,n.Names))for(var R=0;R<n.Names.length;++R)T[0][R+1]=n.Names[R];var L=[],N=[],P=!1;Hf[16]={n:"BrtShortReal",f:P5};var U;if(iA(e,function(W,z,G){if(!p)switch(G){case 148:l=W;break;case 0:u=W,A.sheetRows&&A.sheetRows<=u.r&&(p=!0),D=Sa(y=u.r),A["!row"]=u.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=qd(W.hpt)),N[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:W[2]},W[2]){case"n":g.v=W[1];break;case"s":E=uf[W[1]],g.v=E.t,g.r=E.r;break;case"b":g.v=!!W[1];break;case"e":g.v=W[1],A.cellText!==!1&&(g.w=sA[g.v]);break;case"str":g.t="s",g.v=W[1];break;case"is":g.t="s",g.v=W[1].t;break}if((h=o.CellXf[W[0].iStyleRef])&&L5(g,h.numFmtId,null,A,s,o),x=W[0].c==-1?x+1:W[0].c,A.dense?(c[y]||(c[y]=[]),c[y][x]=g):c[oa(x)+D]=g,A.cellFormula){for(S=!1,_=0;_<O.length;++_){var b=O[_];u.r>=b[0].s.r&&u.r<=b[0].e.r&&x>=b[0].s.c&&x<=b[0].e.c&&(g.F=or(b[0]),S=!0)}!S&&W.length>3&&(g.f=W[3])}if(d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),A.cellDates&&h&&g.t=="n"&&pl(Kt[h.numFmtId])){var k=QA(g.v);k&&(g.t="d",g.v=new Date(k.y,k.m-1,k.d,k.H,k.M,k.S,k.u))}U&&(U.type=="XLDAPR"&&(g.D=!0),U=void 0);break;case 1:case 12:if(!A.sheetStubs||f)break;g={t:"z",v:void 0},x=W[0].c==-1?x+1:W[0].c,A.dense?(c[y]||(c[y]=[]),c[y][x]=g):c[oa(x)+D]=g,d.s.r>u.r&&(d.s.r=u.r),d.s.c>x&&(d.s.c=x),d.e.r<u.r&&(d.e.r=u.r),d.e.c<x&&(d.e.c=x),U&&(U.type=="XLDAPR"&&(g.D=!0),U=void 0);break;case 176:I.push(W);break;case 49:U=((A.xlmeta||{}).Cell||[])[W-1];break;case 494:var j=a["!id"][W.relId];for(j?(W.Target=j.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=j):W.relId==""&&(W.Target="#"+W.loc),y=W.rfx.s.r;y<=W.rfx.e.r;++y)for(x=W.rfx.s.c;x<=W.rfx.e.c;++x)A.dense?(c[y]||(c[y]=[]),c[y][x]||(c[y][x]={t:"z",v:void 0}),c[y][x].l=W):(v=$t({c:x,r:y}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=W);break;case 426:if(!A.cellFormula)break;O.push(W),B=A.dense?c[y][x]:c[oa(x)+D],B.f=Kn(W[1],d,{r:u.r,c:x},T,A),B.F=or(W[0]);break;case 427:if(!A.cellFormula)break;M[$t(W[0].s)]=W[1],B=A.dense?c[y][x]:c[oa(x)+D],B.f=Kn(W[1],d,{r:u.r,c:x},T,A);break;case 60:if(!A.cellStyles)break;for(;W.e>=W.s;)L[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},P||(P=!0,ty(W.w/256)),sc(L[W.e+1]);break;case 161:c["!autofilter"]={ref:or(W)};break;case 476:c["!margins"]=W;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),W.name&&(n.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),W.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!z.T){if(!f||A.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},A),delete A.supbooks,delete A["!row"],!c["!ref"]&&(d.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=or(l||d)),A.sheetRows&&c["!ref"]){var V=gr(c["!ref"]);A.sheetRows<=+V.e.r&&(V.e.r=A.sheetRows-1,V.e.r>d.e.r&&(V.e.r=d.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>d.e.c&&(V.e.c=d.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),c["!fullref"]=c["!ref"],c["!ref"]=or(V))}return I.length>0&&(c["!merges"]=I),L.length>0&&(c["!cols"]=L),N.length>0&&(c["!rows"]=N),c}function Mj(e,t,r,a,n,s,o){if(t.v===void 0)return!1;var A="";switch(t.t){case"b":A=t.v?"1":"0";break;case"d":t=Zr(t),t.z=t.z||Kt[14],t.v=cn(Aa(t.v)),t.t="n";break;case"n":case"e":A=""+t.v;break;default:A=t.v;break}var c={r,c:a};switch(c.s=hc(n.cellXfs,t,n),t.l&&s["!links"].push([$t(c),t.l]),t.c&&s["!comments"].push([$t(c),t.c]),t.t){case"s":case"str":return n.bookSST?(A=sy(n.Strings,t.v,n.revStrings),c.t="s",c.v=A,o?it(e,18,nj(t,c)):it(e,7,rj(t,c))):(c.t="str",o?it(e,17,mj(t,c)):it(e,6,pj(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?it(e,13,dj(t,c)):it(e,2,cj(t,c)):o?it(e,16,oj(t,c)):it(e,5,sj(t,c)),!0;case"b":return c.t="b",o?it(e,15,W8(t,c)):it(e,4,$8(t,c)),!0;case"e":return c.t="e",o?it(e,14,ej(t,c)):it(e,3,J8(t,c)),!0}return o?it(e,12,z8(t,c)):it(e,1,H8(t,c)),!0}function Pj(e,t,r,a){var n=gr(t["!ref"]||"A1"),s,o="",A=[];it(e,145);var c=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=l;++d){o=Sa(d),L8(e,t,n,d);var f=!1;if(d<=n.e.r)for(var p=n.s.c;p<=n.e.c;++p){d===n.s.r&&(A[p]=oa(p)),s=A[p]+o;var u=c?(t[d]||[])[p]:t[s];if(!u){f=!1;continue}f=Mj(e,u,d,p,a,t,f)}}it(e,146)}function Qj(e,t){!t||!t["!merges"]||(it(e,177,_j(t["!merges"].length)),t["!merges"].forEach(function(r){it(e,176,Ej(r))}),it(e,178))}function qj(e,t){!t||!t["!cols"]||(it(e,390),t["!cols"].forEach(function(r,a){r&&it(e,60,Oj(a,r))}),it(e,391))}function Kj(e,t){!t||!t["!ref"]||(it(e,648),it(e,649,kj(gr(t["!ref"]))),it(e,650))}function Hj(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Mr(r,-1,a[1].Target.replace(/#.*$/,""),ur.HLINK);it(e,494,Cj(a,n))}}),delete t["!links"]}function Gj(e,t,r,a){if(t["!comments"].length>0){var n=Mr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);it(e,551,V2("rId"+n)),t["!legacy"]=n}}function zj(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:or(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,A=gi(s);A.s.r==A.e.r&&(A.e.r=gi(t["!ref"]).e.r,s=or(A));for(var c=0;c<o.length;++c){var l=o[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),it(e,161,Wd(gr(s))),it(e,162)}}function Vj(e,t,r){it(e,133),it(e,137,Rj(t,r)),it(e,138),it(e,134)}function $j(e,t){t["!protect"]&&it(e,535,Dj(t["!protect"]))}function Yj(e,t,r,a){var n=Fi(),s=r.SheetNames[e],o=r.Sheets[s]||{},A=s;try{r&&r.Workbook&&(A=r.Workbook.Sheets[e].CodeName||A)}catch{}var c=gr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],it(n,129),(r.vbaraw||o["!outline"])&&it(n,147,q8(A,o["!outline"])),it(n,148,M8(c)),Vj(n,o,r.Workbook),qj(n,o),Pj(n,o,e,t),$j(n,o),zj(n,o,r,e),Qj(n,o),Hj(n,o,a),o["!margins"]&&it(n,476,Nj(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Kj(n,o),Gj(n,o,e,a),it(n,130),n.end()}function Wj(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Sr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function Xj(e,t,r,a,n,s){var o=s||{"!type":"chart"};if(!e)return s;var A=0,c=0,l="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=Wj(f);d.s.r=d.s.c=0,d.e.c=A,l=oa(A),p[0].forEach(function(u,g){o[l+Sa(g)]={t:"n",v:u,z:p[1]},c=g}),d.e.r<c&&(d.e.r=c),++A}),A>0&&(o["!ref"]=or(d)),o}function Jj(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,A=e.match(U5);return A&&oy(A[0],s,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function Zj(e,t){e.l+=10;var r=Jn(e);return{name:r}}function eL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return iA(e,function(c,l,d){switch(d){case 550:s["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var Ay=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rL=[],aL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function j4(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=na(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function L4(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=na(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function q5(e){L4(e.WBProps,Ay),L4(e.CalcPr,aL),j4(e.WBView,tL),j4(e.Sheets,rL),Od.date1904=na(e.WBProps.date1904)}function nL(e){return!e.Workbook||!e.Workbook.WBProps?"false":na(e.Workbook.WBProps.date1904)?"true":"false"}var iL="][*?/\\".split("");function K5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return iL.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function sL(e,t,r){e.forEach(function(a,n){K5(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function H5(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];sL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)n8(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var oL=/<\w+:workbook/;function AL(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},o=0;if(e.replace(ti,function(c,l){var d=Xt(c);switch(xo(d[0])){case"<?xml":break;case"<workbook":c.match(oL)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ay.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=na(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Hr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Sr(Hr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Hr(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),na(d.hidden||"0")&&(s.Hidden=!0),o=l+c.length;break;case"</definedName>":s.Ref=Sr(Hr(e.slice(o,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),hl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return q5(r),r}function G5(e){var t=[Qa];t[t.length]=gt("workbook",null,{xmlns:hl[0],"xmlns:r":on.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ay.forEach(function(A){e.Workbook.WBProps[A[0]]!=null&&e.Workbook.WBProps[A[0]]!=A[1]&&(a[A[0]]=e.Workbook.WBProps[A[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=gt("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Pr(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=gt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(A){var c={name:A.Name};A.Comment&&(c.comment=A.Comment),A.Sheet!=null&&(c.localSheetId=""+A.Sheet),A.Hidden&&(c.hidden="1"),A.Ref&&(t[t.length]=gt("definedName",Pr(A.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=px(e),r.name=Jn(e),r}function lL(e,t){return t||(t=Je(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),V2(e.strRelID,t),yn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function dL(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Jn(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function uL(e,t){t||(t=Je(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Db(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fL(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function pL(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=G3(e),o=JD(e,0,r),A=z2(e);e.l=a;var c={Name:s,Ptg:o};return n<268435455&&(c.Sheet=n),A&&(c.Comment=A),c}function hL(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Hf[16]={n:"BrtFRTArchID$",f:fL},iA(e,function(c,l,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Kn(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),q5(r),r.Names=s,r.supbooks=o,r}function mL(e,t){it(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};it(e,156,lL(n))}it(e,144)}function gL(e,t){t||(t=Je(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return yn("SheetJS",t),yn(Rf.version,t),yn(Rf.version,t),yn("7262",t),t.length>t.l?t.slice(0,t.l):t}function xL(e,t){t||(t=Je(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function yL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(it(e,135),it(e,158,xL(n)),it(e,136))}}function vL(e,t){var r=Fi();return it(r,131),it(r,128,gL()),it(r,153,uL(e.Workbook&&e.Workbook.WBProps||null)),yL(r,e),mL(r,e),it(r,132),r.end()}function wL(e,t,r){return t.slice(-4)===".bin"?hL(e,r):AL(e,r)}function EL(e,t,r,a,n,s,o,A){return t.slice(-4)===".bin"?Uj(e,a,r,n,s,o,A):h8(e,a,r,n,s,o,A)}function _L(e,t,r,a,n,s,o,A){return t.slice(-4)===".bin"?eL(e,a,r,n,s):Jj(e,a,r,n,s)}function bL(e,t,r,a,n,s,o,A){return t.slice(-4)===".bin"?Sk():Tk()}function CL(e,t,r,a,n,s,o,A){return t.slice(-4)===".bin"?Ck():Bk()}function BL(e,t,r,a){return t.slice(-4)===".bin"?E6(e,r,a):l6(e,r,a)}function SL(e,t,r){return b5(e,r)}function TL(e,t,r){return t.slice(-4)===".bin"?OR(e,r):BR(e,r)}function OL(e,t,r){return t.slice(-4)===".bin"?vk(e,r):dk(e,r)}function IL(e,t,r){return t.slice(-4)===".bin"?Ak(e):sk(e)}function NL(e,t,r,a){return r.slice(-4)===".bin"?ck(e,t,r,a):void 0}function FL(e,t,r){return t.slice(-4)===".bin"?ak(e,t,r):ik(e,t,r)}function RL(e,t,r){return(t.slice(-4)===".bin"?vL:G5)(e)}function kL(e,t,r,a,n){return(t.slice(-4)===".bin"?Yj:M5)(e,r,a,n)}function DL(e,t,r){return(t.slice(-4)===".bin"?F6:E5)(e,r)}function jL(e,t,r){return(t.slice(-4)===".bin"?FR:p5)(e,r)}function LL(e,t,r){return(t.slice(-4)===".bin"?wk:S5)(e)}function UL(e){return(e.slice(-4)===".bin"?nk:C5)()}var z5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,V5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ls(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(z5),s,o,A,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(V5),(o=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?A="xmlns"+s[1].slice(6):A=s[1].slice(o+1),a[A]=s[2].slice(1,s[2].length-1));return a}function ML(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(z5),n,s,o,A;if(a)for(A=0;A!=a.length;++A)n=a[A].match(V5),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(s+1),r[o]=n[2].slice(1,n[2].length-1));return r}var pf;function PL(e,t){var r=pf[e]||Sr(e);return r==="General"?sl(t):as(r,t)}function QL(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=na(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Aa(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Sr(t)]=n}function qL(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||sA[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Df(e.v):e.w=sl(e.v):e.w=PL(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=pf[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&pl(a)){var n=QA(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function KL(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=r6[a.Pattern]||a.Pattern)}e[t.ID]=t}function HL(e,t,r,a,n,s,o,A,c,l){var d="General",f=a.StyleID,p={};l=l||{};var u=[],g=0;for(f===void 0&&A&&(f=A.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&u.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=na(e);break;case"String":a.t="s",a.r=e4(Sr(e)),a.v=e.indexOf("<")>-1?Sr(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Aa(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Sr(e):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Pb[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=e4(t||e));break}if(qL(a,d,l),l.cellFormula!==!1)if(a.Formula){var h=Sr(a.Formula);h.charCodeAt(0)==61&&(h=h.slice(1)),a.f=Td(h,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Td("RC:RC",n):a.ArrayRange&&(a.F=Td(a.ArrayRange,n),c.push([gr(a.F),a.F]))}else for(g=0;g<c.length;++g)n.r>=c[g][0].s.r&&n.r<=c[g][0].e.r&&n.c>=c[g][0].s.c&&n.c<=c[g][0].e.c&&(a.F=c[g][1]);l.cellStyles&&(u.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function GL(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rg(e,t){var r=t||{};Vd();var a=yd(j2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof _r<"u"?a=_r.utils.decode(65001,bh(a)):a=Hr(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=Zr(r);return o.type="string",Qd.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ze){n.indexOf("<"+Ze)>=0&&(s=!0)}),s)return SU(a,r);pf={"General Number":"General","General Date":Kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Kt[15],"Short Date":Kt[14],"Long Time":Kt[19],"Medium Time":Kt[18],"Short Time":Kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Kt[2],Standard:Kt[4],Percent:Kt[10],Scientific:Kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var A,c=[],l,d={},f=[],p=r.dense?[]:{},u="",g={},h={},y=Ls('<Data ss:Type="String">'),x=0,v=0,E=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},I={},_="",S=0,O=[],M={},T={},R=0,L=[],N=[],P={},U=[],V,ie=!1,W=[],z=[],G={},b=0,k=0,j={Sheets:[],WBProps:{date1904:!1}},q={};Uf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";A=Uf.exec(a);)switch(A[3]=(Y=A[3]).toLowerCase()){case"data":if(Y=="data"){if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&c.push([A[3],!0]);break}if(c[c.length-1][1])break;A[1]==="/"?HL(a.slice(x,A.index),_,y,c[c.length-1][0]=="comment"?P:g,{c:v,r:E},B,U[v],h,W,r):(_="",y=Ls(A[0]),x=A.index+A[0].length);break;case"cell":if(A[1]==="/")if(N.length>0&&(g.c=N),(!r.sheetRows||r.sheetRows>E)&&g.v!==void 0&&(r.dense?(p[E]||(p[E]=[]),p[E][v]=g):p[oa(v)+Sa(E)]=g),g.HRef&&(g.l={Target:Sr(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(b=v+(parseInt(g.MergeAcross,10)|0),k=E+(parseInt(g.MergeDown,10)|0),O.push({s:{c:v,r:E},e:{c:b,r:k}})),!r.sheetStubs)g.MergeAcross?v=b+1:++v;else if(g.MergeAcross||g.MergeDown){for(var de=v;de<=b;++de)for(var ue=E;ue<=k;++ue)(de>v||ue>E)&&(r.dense?(p[ue]||(p[ue]=[]),p[ue][de]={t:"z"}):p[oa(de)+Sa(ue)]={t:"z"});v=b+1}else++v;else g=ML(A[0]),g.Index&&(v=+g.Index-1),v<D.s.c&&(D.s.c=v),v>D.e.c&&(D.e.c=v),A[0].slice(-2)==="/>"&&++v,N=[];break;case"row":A[1]==="/"||A[0].slice(-2)==="/>"?(E<D.s.r&&(D.s.r=E),E>D.e.r&&(D.e.r=E),A[0].slice(-2)==="/>"&&(h=Ls(A[0]),h.Index&&(E=+h.Index-1)),v=0,++E):(h=Ls(A[0]),h.Index&&(E=+h.Index-1),G={},(h.AutoFitHeight=="0"||h.Height)&&(G.hpx=parseInt(h.Height,10),G.hpt=Kf(G.hpx),z[E]=G),h.Hidden=="1"&&(G.hidden=!0,z[E]=G));break;case"worksheet":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"));f.push(u),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(p["!ref"]=or(D),r.sheetRows&&r.sheetRows<=D.e.r&&(p["!fullref"]=p["!ref"],D.e.r=r.sheetRows-1,p["!ref"]=or(D))),O.length&&(p["!merges"]=O),U.length>0&&(p["!cols"]=U),z.length>0&&(p["!rows"]=z),d[u]=p}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=v=0,c.push([A[3],!1]),l=Ls(A[0]),u=Sr(l.Name),p=r.dense?[]:{},O=[],W=[],z=[],q={name:u,Hidden:0},j.Sheets.push(q);break;case"table":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else{if(A[0].slice(-2)=="/>")break;c.push([A[3],!1]),U=[],ie=!1}break;case"style":A[1]==="/"?KL(B,I,r):I=Ls(A[0]);break;case"numberformat":I.nf=Sr(Ls(A[0]).Format||"General"),pf[I.nf]&&(I.nf=pf[I.nf]);for(var pe=0;pe!=392&&Kt[pe]!=I.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(Kt[pe]==null){po(I.nf,pe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(V=Ls(A[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!ie&&V.wpx>10){ie=!0,Gn=v5;for(var ye=0;ye<U.length;++ye)U[ye]&&sc(U[ye])}ie&&sc(V),U[V.Index-1||U.length]=V;for(var ve=0;ve<+V.Span;++ve)U[U.length]=Zr(V);break;case"namedrange":if(A[1]==="/")break;j.Names||(j.Names=[]);var ae=Xt(A[0]),Ke={Name:ae.Name,Ref:Td(ae.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(Ke.Sheet=j.Sheets.length-1),j.Names.push(Ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(A[0].slice(-2)==="/>")break;A[1]==="/"?_+=a.slice(S,A.index):S=A.index+A[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Ls(A[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(A[0].slice(-2)==="/>")break;A[1]==="/"?mN(M,Y,a.slice(R,A.index)):R=A.index+A[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else c.push([A[3],!1]);break;case"comment":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"));GL(P),N.push(P)}else c.push([A[3],!1]),l=Ls(A[0]),P={a:l.Author};break;case"autofilter":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else if(A[0].charAt(A[0].length-2)!=="/"){var Ee=Ls(A[0]);p["!autofilter"]={ref:Td(Ee.Range).replace(/\$/g,"")},c.push([A[3],!0])}break;case"name":break;case"datavalidation":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&c.push([A[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(A[1]==="/"){if((l=c.pop())[0]!==A[3])throw new Error("Bad state: "+l.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&c.push([A[3],!0]);break;case"null":break;default:if(c.length==0&&A[3]=="document"||c.length==0&&A[3]=="uof")return q4(a,r);var me=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(A[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:me=!1}break;case"componentoptions":switch(A[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:me=!1}break;case"excelworkbook":switch(A[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:me=!1}break;case"workbookoptions":switch(A[3]){case"owcversion":break;case"height":break;case"width":break;default:me=!1}break;case"worksheetoptions":switch(A[3]){case"visible":if(A[0].slice(-2)!=="/>")if(A[1]==="/")switch(a.slice(R,A.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else R=A.index+A[0].length;break;case"header":p["!margins"]||Xc(p["!margins"]={},"xlml"),isNaN(+Xt(A[0]).Margin)||(p["!margins"].header=+Xt(A[0]).Margin);break;case"footer":p["!margins"]||Xc(p["!margins"]={},"xlml"),isNaN(+Xt(A[0]).Margin)||(p["!margins"].footer=+Xt(A[0]).Margin);break;case"pagemargins":var le=Xt(A[0]);p["!margins"]||Xc(p["!margins"]={},"xlml"),isNaN(+le.Top)||(p["!margins"].top=+le.Top),isNaN(+le.Left)||(p["!margins"].left=+le.Left),isNaN(+le.Right)||(p["!margins"].right=+le.Right),isNaN(+le.Bottom)||(p["!margins"].bottom=+le.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:me=!1}break;case"pivottable":case"pivotcache":switch(A[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:me=!1}break;case"pagebreaks":switch(A[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:me=!1}break;case"autofilter":switch(A[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:me=!1}break;case"querytable":switch(A[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:me=!1}break;case"datavalidation":switch(A[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:me=!1}break;case"sorting":case"conditionalformatting":switch(A[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:me=!1}break;case"mapinfo":case"schema":case"data":switch(A[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:me=!1}break;case"smarttags":break;default:me=!1;break}if(me||A[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+A[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(A[0].slice(-2)==="/>")break;A[1]==="/"?QL(T,Y,L,a.slice(R,A.index)):(L=A,R=A.index+A[0].length);break}if(r.WTF)throw"Unrecognized tag: "+A[3]+"|"+c.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=d),He.SheetNames=f,He.Workbook=j,He.SSF=Zr(Kt),He.Props=M,He.Custprops=T,He}function wx(e,t){switch(dy(t=t||{}),t.type||"base64"){case"base64":return Rg(rs(e),t);case"binary":case"buffer":case"file":return Rg(e,t);case"array":return Rg(fc(e),t)}}function zL(e,t){var r=[];return e.Props&&r.push(gN(e.Props,t)),e.Custprops&&r.push(xN(e.Props,e.Custprops)),r.join("")}function VL(){return""}function $L(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(gt("NumberFormat",null,{"ss:Format":Pr(Kt[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(gt("Style",s.join(""),o))}),gt("Styles",r.join(""))}function $5(e){return gt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ny(e.Ref,{r:0,c:0})})}function YL(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push($5(n)))}return gt("Names",r.join(""))}function WL(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],o=0;o<n.length;++o){var A=n[o];A.Sheet==r&&(A.Name.match(/^_xlfn\./)||s.push($5(A)))}return s.join("")}function XL(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(gt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(gt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(gt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(gt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Tn("ProtectContents","True")),e["!protect"].objects&&n.push(Tn("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Tn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Tn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Tn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":gt("WorksheetOptions",n.join(""),{xmlns:Vi.x})}function JL(e){return e.map(function(t){var r=v3(t.t||""),a=gt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return gt("Comment",a,{"ss:Author":t.a})}).join("")}function ZL(e,t,r,a,n,s,o){if(!e||e.v==null&&e.f==null)return"";var A={};if(e.f&&(A["ss:Formula"]="="+Pr(ny(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=ma(e.F.slice(t.length+1));A["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(A["ss:HRef"]=Pr(e.l.Target),e.l.Tooltip&&(A["x:HRefScreenTip"]=Pr(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],d=0;d!=l.length;++d)l[d].s.c!=o.c||l[d].s.r!=o.r||(l[d].e.c>l[d].s.c&&(A["ss:MergeAcross"]=l[d].e.c-l[d].s.c),l[d].e.r>l[d].s.r&&(A["ss:MergeDown"]=l[d].e.r-l[d].s.r));var f="",p="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=sA[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Kt[14]);break;case"s":f="String",p=y3(e.v||"");break}var u=hc(a.cellXfs,e,a);A["ss:StyleID"]="s"+(21+u),A["ss:Index"]=o.c+1;var g=e.v!=null?p:"",h=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(h+=JL(e.c)),gt("Cell",h,A)}function eU(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=qd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tU(e,t,r,a){if(!e["!ref"])return"";var n=gr(e["!ref"]),s=e["!merges"]||[],o=0,A=[];e["!cols"]&&e["!cols"].forEach(function(y,x){sc(y);var v=!!y.width,E=_m(x,y),D={"ss:Index":x+1};v&&(D["ss:Width"]=Qf(E.width)),y.hidden&&(D["ss:Hidden"]="1"),A.push(gt("Column",null,D))});for(var c=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var d=[eU(l,(e["!rows"]||[])[l])],f=n.s.c;f<=n.e.c;++f){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>l)&&!(s[o].e.c<f)&&!(s[o].e.r<l)){(s[o].s.c!=f||s[o].s.r!=l)&&(p=!0);break}if(!p){var u={r:l,c:f},g=$t(u),h=c?(e[l]||[])[f]:e[g];d.push(ZL(h,g,e,t,r,a,u))}}d.push("</Row>"),d.length>2&&A.push(d.join(""))}return A.join("")}function rU(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],o=s?WL(s,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=s?tU(s,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(XL(s,t,e,r)),a.join("")}function aU(e,t){t||(t={}),e.SSF||(e.SSF=Zr(Kt)),e.SSF&&(Vd(),i0(e.SSF),t.revssf=gm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],hc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(zL(e,t)),r.push(VL()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(gt("Worksheet",rU(a,t,e),{"ss:Name":Pr(e.SheetNames[a])}));return r[2]=$L(e,t),r[3]=YL(e),Qa+gt("Workbook",r.join(""),{xmlns:Vi.ss,"xmlns:o":Vi.o,"xmlns:x":Vi.x,"xmlns:ss":Vi.ss,"xmlns:dt":Vi.dt,"xmlns:html":Vi.html})}function nU(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=W3(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=X3(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iU=[60,1084,2066,2165,2175];function sU(e,t,r,a,n){var s=a,o=[],A=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&A.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(A)}o.push(A),r.l+=s;for(var c=zo(r,r.l),l=Ex[c],d=0;l!=null&&iU.indexOf(c)>-1;)s=zo(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),A=r.slice(d,r.l+4+s),o.push(A),r.l+=4+s,l=Ex[c=zo(r,r.l)];var f=xn(o);Bn(f,0);var p=0;f.lens=[];for(var u=0;u<o.length;++u)f.lens.push(p),p+=o[u].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,n)}function ro(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Kt[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||sA[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Df(e.v):e.w=sl(e.v):e.w=as(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&pl(Kt[a]||String(a))){var n=QA(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function pp(e,t,r){return{v:e,ixfe:t,t:r}}function oU(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},o={},A=null,c=[],l="",d={},f,p="",u,g,h,y,x={},v=[],E,D,B=[],I=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},O=function(ut){return ut<8?$c[ut]:ut<64&&I[ut-8]||$c[ut]},M=function(ut,ct,vr){var Rt=ct.XF.data;if(!(!Rt||!Rt.patternType||!vr||!vr.cellStyles)){ct.s={},ct.s.patternType=Rt.patternType;var Gr;(Gr=Pf(O(Rt.icvFore)))&&(ct.s.fgColor={rgb:Gr}),(Gr=Pf(O(Rt.icvBack)))&&(ct.s.bgColor={rgb:Gr})}},T=function(ut,ct,vr){if(!(G>1)&&!(vr.sheetRows&&ut.r>=vr.sheetRows)){if(vr.cellStyles&&ct.XF&&ct.XF.data&&M(ut,ct,vr),delete ct.ixfe,delete ct.XF,f=ut,p=$t(ut),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<o.s.r&&(o.s.r=ut.r),ut.c<o.s.c&&(o.s.c=ut.c),ut.r+1>o.e.r&&(o.e.r=ut.r+1),ut.c+1>o.e.c&&(o.e.c=ut.c+1),vr.cellFormula&&ct.f){for(var Rt=0;Rt<v.length;++Rt)if(!(v[Rt][0].s.c>ut.c||v[Rt][0].s.r>ut.r)&&!(v[Rt][0].e.c<ut.c||v[Rt][0].e.r<ut.r)){ct.F=or(v[Rt][0]),(v[Rt][0].s.c!=ut.c||v[Rt][0].s.r!=ut.r)&&delete ct.f,ct.f&&(ct.f=""+Kn(v[Rt][1],o,ut,W,R));break}}vr.dense?(n[ut.r]||(n[ut.r]=[]),n[ut.r][ut.c]=ct):n[p]=ct}},R={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var L,N=[],P=[],U=[],V=[],ie=!1,W=[];W.SheetNames=R.snames,W.sharedf=R.sharedf,W.arrayf=R.arrayf,W.names=[],W.XTI=[];var z=0,G=0,b=0,k=[],j=[],q;R.codepage=1200,Es(1200);for(var Y=!1;e.l<e.length-1;){var de=e.l,ue=e.read_shift(2);if(ue===0&&z===10)break;var pe=e.l===e.length?0:e.read_shift(2),ye=Ex[ue];if(ye&&ye.f){if(t.bookSheets&&z===133&&ue!==133)break;if(z=ue,ye.r===2||ye.r==12){var ve=e.read_shift(2);if(pe-=2,!R.enc&&ve!==ue&&((ve&255)<<8|ve>>8)!==ue)throw new Error("rt mismatch: "+ve+"!="+ue);ye.r==12&&(e.l+=10,pe-=10)}var ae={};if(ue===10?ae=ye.f(e,pe,R):ae=sU(ue,ye,e,pe,R),G==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(ue){case 34:r.opts.Date1904=_.WBProps.date1904=ae;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=ae,!t.password)throw new Error("File is password-protected");if(ae.valid==null)throw new Error("Encryption scheme unsupported");if(!ae.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=ae;break;case 66:var Ke=Number(ae);switch(Ke){case 21010:Ke=1200;break;case 32768:Ke=1e4;break;case 32769:Ke=1252;break}Es(R.codepage=Ke),Y=!0;break;case 317:R.rrtabid=ae;break;case 25:R.winlocked=ae;break;case 439:r.opts.RefreshAll=ae;break;case 12:r.opts.CalcCount=ae;break;case 16:r.opts.CalcDelta=ae;break;case 17:r.opts.CalcIter=ae;break;case 13:r.opts.CalcMode=ae;break;case 14:r.opts.CalcPrecision=ae;break;case 95:r.opts.CalcSaveRecalc=ae;break;case 15:R.CalcRefMode=ae;break;case 2211:r.opts.FullCalc=ae;break;case 129:ae.fDialog&&(n["!type"]="dialog"),ae.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),ae.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:B.push(ae);break;case 430:W.push([ae]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(ae);break;case 24:case 536:q={Name:ae.Name,Ref:Kn(ae.rgce,o,null,W,R)},ae.itab>0&&(q.Sheet=ae.itab-1),W.names.push(q),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(ae),ae.Name=="_xlnm._FilterDatabase"&&ae.itab>0&&ae.rgce&&ae.rgce[0]&&ae.rgce[0][0]&&ae.rgce[0][0][0]=="PtgArea3d"&&(j[ae.itab-1]={ref:or(ae.rgce[0][0][1][2])});break;case 22:R.ExternCount=ae;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(ae),W.XTI=W.XTI.concat(ae);break;case 2196:if(R.biff<8)break;q!=null&&(q.Comment=ae[1]);break;case 18:n["!protect"]=ae;break;case 19:ae!==0&&R.WTF&&console.error("Password verifier: "+ae);break;case 133:s[ae.pos]=ae,R.snames.push(ae.name);break;case 10:{if(--G)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=or(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ee=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=or(o),o.e.r=Ee}o.e.r++,o.e.c++}N.length>0&&(n["!merges"]=N),P.length>0&&(n["!objects"]=P),U.length>0&&(n["!cols"]=U),V.length>0&&(n["!rows"]=V),_.Sheets.push(S)}l===""?d=n:a[l]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ae.BIFFVer]||8),R.biffguess=ae.BIFFVer==0,ae.BIFFVer==0&&ae.dt==4096&&(R.biff=5,Y=!0,Es(R.codepage=28591)),R.biff==8&&ae.BIFFVer==0&&ae.dt==16&&(R.biff=2),G++)break;if(n=t.dense?[]:{},R.biff<8&&!Y&&(Y=!0,Es(R.codepage=t.codepage||1252)),R.biff<5||ae.BIFFVer==0&&ae.dt==4096){l===""&&(l="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var me={pos:e.l-pe,name:l};s[me.pos]=me,R.snames.push(l)}else l=(s[de]||{name:""}).name;ae.dt==32&&(n["!type"]="chart"),ae.dt==64&&(n["!type"]="macro"),N=[],P=[],R.arrayf=v=[],U=[],V=[],ie=!1,S={Hidden:(s[de]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[ae.r]||[])[ae.c]:n[$t({c:ae.c,r:ae.r})])&&++ae.c,E={ixfe:ae.ixfe,XF:B[ae.ixfe]||{},v:ae.val,t:"n"},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t);break;case 5:case 517:E={ixfe:ae.ixfe,XF:B[ae.ixfe],v:ae.val,t:ae.t},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t);break;case 638:E={ixfe:ae.ixfe,XF:B[ae.ixfe],v:ae.rknum,t:"n"},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t);break;case 189:for(var le=ae.c;le<=ae.C;++le){var He=ae.rkrec[le-ae.c][0];E={ixfe:He,XF:B[He],v:ae.rkrec[le-ae.c][1],t:"n"},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:le,r:ae.r},E,t)}break;case 6:case 518:case 1030:{if(ae.val=="String"){A=ae;break}if(E=pp(ae.val,ae.cell.ixfe,ae.tt),E.XF=B[E.ixfe],t.cellFormula){var Ze=ae.formula;if(Ze&&Ze[0]&&Ze[0][0]&&Ze[0][0][0]=="PtgExp"){var $e=Ze[0][0][1][0],et=Ze[0][0][1][1],je=$t({r:$e,c:et});x[je]?E.f=""+Kn(ae.formula,o,ae.cell,W,R):E.F=((t.dense?(n[$e]||[])[et]:n[je])||{}).F}else E.f=""+Kn(ae.formula,o,ae.cell,W,R)}b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T(ae.cell,E,t),A=ae}break;case 7:case 519:if(A)A.val=ae,E=pp(ae,A.cell.ixfe,"s"),E.XF=B[E.ixfe],t.cellFormula&&(E.f=""+Kn(A.formula,o,A.cell,W,R)),b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T(A.cell,E,t),A=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(ae);var _e=$t(ae[0].s);if(u=t.dense?(n[ae[0].s.r]||[])[ae[0].s.c]:n[_e],t.cellFormula&&u){if(!A||!_e||!u)break;u.f=""+Kn(ae[1],o,ae[0],W,R),u.F=or(ae[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!A)break;x[$t(A.cell)]=ae[0],u=t.dense?(n[A.cell.r]||[])[A.cell.c]:n[$t(A.cell)],(u||{}).f=""+Kn(ae[0],o,f,W,R)}}break;case 253:E=pp(c[ae.isst].t,ae.ixfe,"s"),c[ae.isst].h&&(E.h=c[ae.isst].h),E.XF=B[E.ixfe],b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:ae.ixfe,XF:B[ae.ixfe],t:"z"},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t));break;case 190:if(t.sheetStubs)for(var lt=ae.c;lt<=ae.C;++lt){var Ct=ae.ixfe[lt-ae.c];E={ixfe:Ct,XF:B[Ct],t:"z"},b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:lt,r:ae.r},E,t)}break;case 214:case 516:case 4:E=pp(ae.val,ae.ixfe,"s"),E.XF=B[E.ixfe],b>0&&(E.z=k[E.ixfe>>8&63]),ro(E,t,r.opts.Date1904),T({c:ae.c,r:ae.r},E,t);break;case 0:case 512:G===1&&(o=ae);break;case 252:c=ae;break;case 1054:if(R.biff==4){k[b++]=ae[1];for(var bt=0;bt<b+163&&Kt[bt]!=ae[1];++bt);bt>=163&&po(ae[1],b+163)}else po(ae[1],ae[0]);break;case 30:{k[b++]=ae;for(var Et=0;Et<b+163&&Kt[Et]!=ae;++Et);Et>=163&&po(ae,b+163)}break;case 229:N=N.concat(ae);break;case 93:P[ae.cmo[0]]=R.lastobj=ae;break;case 438:R.lastobj.TxO=ae;break;case 127:R.lastobj.ImData=ae;break;case 440:for(y=ae[0].s.r;y<=ae[0].e.r;++y)for(h=ae[0].s.c;h<=ae[0].e.c;++h)u=t.dense?(n[y]||[])[h]:n[$t({c:h,r:y})],u&&(u.l=ae[1]);break;case 2048:for(y=ae[0].s.r;y<=ae[0].e.r;++y)for(h=ae[0].s.c;h<=ae[0].e.c;++h)u=t.dense?(n[y]||[])[h]:n[$t({c:h,r:y})],u&&u.l&&(u.l.Tooltip=ae[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;u=t.dense?(n[ae[0].r]||[])[ae[0].c]:n[$t(ae[0])];var Mt=P[ae[2]];u||(t.dense?(n[ae[0].r]||(n[ae[0].r]=[]),u=n[ae[0].r][ae[0].c]={t:"z"}):u=n[$t(ae[0])]={t:"z"},o.e.r=Math.max(o.e.r,ae[0].r),o.s.r=Math.min(o.s.r,ae[0].r),o.e.c=Math.max(o.e.c,ae[0].c),o.s.c=Math.min(o.s.c,ae[0].c)),u.c||(u.c=[]),g={a:ae[1],t:Mt.TxO.t},u.c.push(g)}break;case 2173:Y6(B[ae.ixfe],ae.ext);break;case 125:{if(!R.cellStyles)break;for(;ae.e>=ae.s;)U[ae.e--]={width:ae.w/256,level:ae.level||0,hidden:!!(ae.flags&1)},ie||(ie=!0,ty(ae.w/256)),sc(U[ae.e+1])}break;case 520:{var Dt={};ae.level!=null&&(V[ae.r]=Dt,Dt.level=ae.level),ae.hidden&&(V[ae.r]=Dt,Dt.hidden=!0),ae.hpt&&(V[ae.r]=Dt,Dt.hpt=ae.hpt,Dt.hpx=qd(ae.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Xc(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=ae;break;case 161:n["!margins"]||Xc(n["!margins"]={}),n["!margins"].header=ae.header,n["!margins"].footer=ae.footer;break;case 574:ae.RTL&&(_.Views[0].RTL=!0);break;case 146:I=ae;break;case 2198:L=ae;break;case 140:D=ae;break;case 442:l?S.CodeName=ae||S.name:_.WBProps.CodeName=ae||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=pe}return r.SheetNames=Oa(s).sort(function(Bt,ut){return Number(Bt)-Number(ut)}).map(function(Bt){return s[Bt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&j.forEach(function(Bt,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=Bt}),r.Strings=c,r.SSF=Zr(Kt),R.enc&&(r.Encryption=R.enc),L&&(r.Themes=L),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),W.names.length>0&&(_.Names=W.names),r.Workbook=_,r}var hf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AU(e,t,r){var a=Lt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=x4(a,hx,hf.DSI);for(var s in n)t[s]=n[s]}catch(l){if(r.WTF)throw l}var o=Lt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var A=x4(o,mx,hf.SI);for(var c in A)t[c]==null&&(t[c]=A[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(zb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cU(e,t){var r=[],a=[],n=[],s=0,o,A=$v(hx,"n"),c=$v(mx,"n");if(e.Props)for(o=Oa(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(A,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?a:n).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Oa(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(A,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?a:n).push([o[s],e.Custprops[o[s]]]);var l=[];for(s=0;s<n.length;++s)Zb.indexOf(n[s][0])>-1||Gb.indexOf(n[s][0])>-1||n[s][1]!=null&&l.push(n[s]);a.length&&Lt.utils.cfb_add(t,"/SummaryInformation",y4(a,hf.SI,c,mx)),(r.length||l.length)&&Lt.utils.cfb_add(t,"/DocumentSummaryInformation",y4(r,hf.DSI,A,hx,l.length?l:null,hf.UDI))}function cy(e,t){t||(t={}),dy(t),hm(),t.codepage&&pm(t.codepage);var r,a;if(e.FullPaths){if(Lt.find(e,"/encryption"))throw new Error("File is password-protected");r=Lt.find(e,"!CompObj"),a=Lt.find(e,"/Workbook")||Lt.find(e,"/Book")}else{switch(t.type){case"base64":e=$i(rs(e));break;case"binary":e=$i(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Bn(e,0),a={content:e}}var n,s;if(r&&nU(r),t.bookProps&&!t.bookSheets)n={};else{var o=lr?"buffer":"array";if(a&&a.content)n=oU(a.content,t);else if((s=Lt.find(e,"PerfectOffice_MAIN"))&&s.content)n=Wc.to_workbook(s.content,(t.type=o,t));else if((s=Lt.find(e,"NativeContent_MAIN"))&&s.content)n=Wc.to_workbook(s.content,(t.type=o,t));else throw(s=Lt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Lt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=_k(e))}var A={};return e.FullPaths&&AU(e,A,t),n.Props=n.Custprops=A,t.bookFiles&&(n.cfb=e),n}function lU(e,t){var r=t||{},a=Lt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Lt.utils.cfb_add(a,n,Y5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&cU(e,a),r.biff==8&&e.vbaraw&&bk(a,Lt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Hf={0:{f:D8},1:{f:K8},2:{f:Aj},3:{f:X8},4:{f:V8},5:{f:ij},6:{f:fj},7:{f:tj},8:{f:vj},9:{f:yj},10:{f:gj},11:{f:xj},12:{f:G8},13:{f:lj},14:{f:Z8},15:{f:Y8},16:{f:P5},17:{f:hj},18:{f:aj},19:{f:G2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pL},40:{},42:{},43:{f:f6},44:{f:d6},45:{f:m6},46:{f:x6},47:{f:g6},48:{},49:{f:U3},50:{},51:{f:J6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l5},62:{f:uj},63:{f:ok},64:{f:jj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ei,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Fj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Q8},148:{f:U8,p:16},151:{f:Bj},152:{},153:{f:dL},154:{},155:{},156:{f:cL},157:{},158:{},159:{T:1,f:TR},160:{T:-1},161:{T:1,f:yl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:W6},336:{T:-1},337:{f:tk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:px},357:{},358:{},359:{},360:{T:1},361:{},362:{f:c5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Sj},427:{f:Tj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ij},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:P8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:px},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xk},633:{T:1},634:{T:-1},635:{T:1,f:mk},636:{T:-1},637:{f:q3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Zj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Lj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ex={6:{f:Ng},10:{f:CA},12:{f:Ya},13:{f:Ya},14:{f:Ra},15:{f:Ra},16:{f:$n},17:{f:Ra},18:{f:Ra},19:{f:Ya},20:{f:C4},21:{f:C4},23:{f:c5},24:{f:S4},25:{f:Ra},26:{},27:{},28:{f:LF},29:{},34:{f:Ra},35:{f:B4},38:{f:$n},39:{f:$n},40:{f:$n},41:{f:$n},42:{f:Ra},43:{f:Ra},47:{f:YR},49:{f:lF},51:{f:Ya},60:{},61:{f:iF},64:{f:Ra},65:{f:cF},66:{f:Ya},77:{},80:{},81:{},82:{},85:{f:Ya},89:{},90:{},91:{},92:{f:$N},93:{f:PF},94:{},95:{f:Ra},96:{},97:{},99:{f:Ra},125:{f:l5},128:{f:CF},129:{f:WN},130:{f:Ya},131:{f:Ra},132:{f:Ra},133:{f:XN},134:{},140:{f:$F},141:{f:Ya},144:{},146:{f:XF},151:{},152:{},153:{},154:{},155:{},156:{f:Ya},157:{},158:{},160:{f:nR},161:{f:eR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wF},190:{f:EF},193:{f:CA},197:{},198:{},199:{},200:{},201:{},202:{f:Ra},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ya},220:{},221:{f:Ra},222:{},224:{f:bF},225:{f:VN},226:{f:CA},227:{},229:{f:UF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ZN},253:{f:uF},255:{f:tF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:e5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ra},353:{f:CA},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:IF},431:{f:Ra},432:{},433:{},434:{},437:{},438:{f:KF},439:{f:Ra},440:{f:HF},441:{},442:{f:A0},443:{},444:{f:Ya},445:{},446:{},448:{f:CA},449:{f:nF,r:2},450:{f:CA},512:{f:E4},513:{f:aR},515:{f:TF},516:{f:pF},517:{f:b4},519:{f:iR},520:{f:rF},523:{},545:{f:T4},549:{f:w4},566:{},574:{f:oF},638:{f:vF},659:{},1048:{},1054:{f:mF},1084:{},1212:{f:kF},2048:{f:zF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:CA},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JF,r:12},2173:{f:$6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ra,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:RF,r:12},2197:{},2198:{f:q6,r:12},2199:{},2200:{},2201:{},2202:{f:DF,r:12},2203:{f:CA},2204:{},2205:{},2206:{},2207:{},2211:{f:aF},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ya},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:WF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:E4},1:{},2:{f:lR},3:{f:AR},4:{f:oR},5:{f:b4},7:{f:uR},8:{},9:{f:dp},11:{},22:{f:Ya},30:{f:xF},31:{},32:{},33:{f:T4},36:{},37:{f:w4},50:{f:fR},62:{},52:{},67:{},68:{f:Ya},69:{},86:{},126:{},127:{f:sR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pR},223:{},234:{},354:{},421:{},518:{f:Ng},521:{f:dp},536:{f:S4},547:{f:B4},561:{},579:{},1030:{f:Ng},1033:{f:dp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xt(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,s),s>0&&q2(r)&&e.push(r)}}function dU(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return xt(e,t,r,n);var s=t;if(!isNaN(s)){for(var o=r.parts||[],A=0,c=0,l=0;l+(o[A]||8224)<=8224;)l+=o[A]||8224,A++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l;c<n;){for(d=e.next(4),d.write_shift(2,60),l=0;l+(o[A]||8224)<=8224;)l+=o[A]||8224,A++;d.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l}}}function u0(e,t,r){return e||(e=Je(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function uU(e,t,r,a){var n=Je(9);return u0(n,e,t),t5(r,a||"b",n),n}function fU(e,t,r){var a=Je(8+2*r.length);return u0(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function pU(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?cn(Aa(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?xt(e,2,dR(r,a,n)):xt(e,3,cR(r,a,n));return;case"b":case"e":xt(e,5,uU(r,a,t.v,t.t));return;case"s":case"str":xt(e,4,fU(r,a,(t.v||"").slice(0,255)));return}xt(e,1,u0(null,r,a))}function hU(e,t,r,a){var n=Array.isArray(t),s=gr(t["!ref"]||"A1"),o,A="",c=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=or(s)}for(var l=s.s.r;l<=s.e.r;++l){A=Sa(l);for(var d=s.s.c;d<=s.e.c;++d){l===s.s.r&&(c[d]=oa(d)),o=c[d]+A;var f=n?(t[l]||[])[d]:t[o];f&&pU(e,f,l,d)}}}function mU(e,t){for(var r=t||{},a=Fi(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return xt(a,r.biff==4?1033:r.biff==3?521:9,J2(e,16,r)),hU(a,e.Sheets[e.SheetNames[n]],n,r),xt(a,10),a.end()}function gU(e,t,r){xt(e,49,dF({sz:12,name:"Arial"},r))}function xU(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&xt(e,1054,gF(n,t[n],r))})}function yU(e,t){var r=Je(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),xt(e,2151,r),r=Je(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s5(gr(t["!ref"]||"A1"),r),r.write_shift(4,4),xt(e,2152,r)}function vU(e,t){for(var r=0;r<16;++r)xt(e,224,_4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){xt(e,224,_4(a,0,t))})}function wU(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];xt(e,440,GF(a)),a[1].Tooltip&&xt(e,2048,VF(a))}delete t["!links"]}function EU(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&xt(e,125,ZF(_m(n,a),n))})}}function _U(e,t,r,a,n){var s=16+hc(n.cellXfs,t,n);if(t.v==null&&!t.bf){xt(e,513,ll(r,a,s));return}if(t.bf)xt(e,6,WD(t,r,a,n,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?cn(Aa(t.v)):t.v;xt(e,515,OF(r,a,o,s));break;case"b":case"e":xt(e,517,SF(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var A=sy(n.Strings,t.v,n.revStrings);xt(e,253,fF(r,a,A,s))}else xt(e,516,hF(r,a,(t.v||"").slice(0,255),s,n));break;default:xt(e,513,ll(r,a,s))}}function bU(e,t,r){var a=Fi(),n=r.SheetNames[e],s=r.Sheets[n]||{},o=(r||{}).Workbook||{},A=(o.Sheets||[])[e]||{},c=Array.isArray(s),l=t.biff==8,d,f="",p=[],u=gr(s["!ref"]||"A1"),g=l?65536:16384;if(u.e.c>255||u.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,g-1)}xt(a,2057,J2(r,16,t)),xt(a,13,vs(1)),xt(a,12,vs(100)),xt(a,15,di(!0)),xt(a,17,di(!1)),xt(a,16,Al(.001)),xt(a,95,di(!0)),xt(a,42,di(!1)),xt(a,43,di(!1)),xt(a,130,vs(1)),xt(a,128,BF()),xt(a,131,di(!1)),xt(a,132,di(!1)),l&&EU(a,s["!cols"]),xt(a,512,yF(u,t)),l&&(s["!links"]=[]);for(var h=u.s.r;h<=u.e.r;++h){f=Sa(h);for(var y=u.s.c;y<=u.e.c;++y){h===u.s.r&&(p[y]=oa(y)),d=p[y]+f;var x=c?(s[h]||[])[y]:s[d];x&&(_U(a,x,h,y,t),l&&x.l&&s["!links"].push([d,x.l]))}}var v=A.CodeName||A.name||n;return l&&xt(a,574,AF((o.Views||[])[0])),l&&(s["!merges"]||[]).length&&xt(a,229,MF(s["!merges"])),l&&wU(a,s),xt(a,442,r5(v)),l&&yU(a,s),xt(a,10),a.end()}function CU(e,t,r){var a=Fi(),n=(e||{}).Workbook||{},s=n.Sheets||[],o=n.WBProps||{},A=r.biff==8,c=r.biff==5;if(xt(a,2057,J2(e,5,r)),r.bookType=="xla"&&xt(a,135),xt(a,225,A?vs(1200):null),xt(a,193,SN(2)),c&&xt(a,191),c&&xt(a,192),xt(a,226),xt(a,92,YN("SheetJS",r)),xt(a,66,vs(A?1200:1252)),A&&xt(a,353,vs(0)),A&&xt(a,448),xt(a,317,rR(e.SheetNames.length)),A&&e.vbaraw&&xt(a,211),A&&e.vbaraw){var l=o.CodeName||"ThisWorkbook";xt(a,442,r5(l))}xt(a,156,vs(17)),xt(a,25,di(!1)),xt(a,18,di(!1)),xt(a,19,vs(0)),A&&xt(a,431,di(!1)),A&&xt(a,444,vs(0)),xt(a,61,sF()),xt(a,64,di(!1)),xt(a,141,vs(0)),xt(a,34,di(nL(e)=="true")),xt(a,14,di(!0)),A&&xt(a,439,di(!1)),xt(a,218,vs(0)),gU(a,e,r),xU(a,e.SSF,r),vU(a,r),A&&xt(a,352,di(!1));var d=a.end(),f=Fi();A&&xt(f,140,YF()),A&&r.Strings&&dU(f,252,eF(r.Strings)),xt(f,10);var p=f.end(),u=Fi(),g=0,h=0;for(h=0;h<e.SheetNames.length;++h)g+=(A?12:11)+(A?2:1)*e.SheetNames[h].length;var y=d.length+g+p.length;for(h=0;h<e.SheetNames.length;++h){var x=s[h]||{};xt(u,133,JN({pos:y,hs:x.Hidden||0,dt:0,name:e.SheetNames[h]},r)),y+=t[h].length}var v=u.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var E=[];return d.length&&E.push(d),v.length&&E.push(v),p.length&&E.push(p),xn(E)}function BU(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Zr(Kt)),e&&e.SSF&&(Vd(),i0(e.SSF),r.revssf=gm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uy(r),r.cellXfs=[],hc(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=bU(n,r,e);return a.unshift(CU(e,a,r)),xn(a)}function Y5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=gi(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return BU(e,t);case 4:case 3:case 2:return mU(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function U4(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=n.index,A=s&&s.index||e.length,c=d3(e.slice(o,A),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,d=0,f=0,p=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<c.length;++o){var h=c[o].trim(),y=h.slice(0,3).toLowerCase();if(y=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var x=h.split(/<\/t[dh]>/i);for(A=0;A<x.length;++A){var v=x[A].trim();if(v.match(/<t[dh]/i)){for(var E=v,D=0;E.charAt(0)=="<"&&(D=E.indexOf(">"))>-1;)E=E.slice(D+1);for(var B=0;B<g.length;++B){var I=g[B];I.s.c==d&&I.s.r<l&&l<=I.e.r&&(d=I.e.c+1,B=-1)}var _=Xt(v.slice(0,v.indexOf(">")));p=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||p>1)&&g.push({s:{r:l,c:d},e:{r:l+(f||1)-1,c:d+p-1}});var S=_.t||_["data-t"]||"";if(!E.length){d+=p;continue}if(E=_b(E),u.s.r>l&&(u.s.r=l),u.e.r<l&&(u.e.r=l),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),!E.length){d+=p;continue}var O={t:"s",v:E};r.raw||!E.trim().length||S=="s"||(E==="TRUE"?O={t:"b",v:!0}:E==="FALSE"?O={t:"b",v:!1}:isNaN(Gs(E))?isNaN(Pd(E).getDate())||(O={t:"d",v:Aa(E)},r.cellDates||(O={t:"n",v:cn(O.v)}),O.z=r.dateNF||Kt[14]):O={t:"n",v:Gs(E)}),r.dense?(a[l]||(a[l]=[]),a[l][d]=O):a[$t({r:l,c:d})]=O,d+=p}}}}return a["!ref"]=or(u),g.length&&(a["!merges"]=g),a}function W5(e,t,r,a){for(var n=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var A=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>o)&&!(n[l].e.r<r||n[l].e.c<o)){if(n[l].s.r<r||n[l].s.c<o){A=-1;break}A=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(A<0)){var d=$t({r,c:o}),f=a.dense?(e[r]||[])[o]:e[d],p=f&&f.v!=null&&(f.h||D2(f.w||(mo(f),f.w)||""))||"",u={};A>1&&(u.rowspan=A),c>1&&(u.colspan=c),a.editable?p='<span contenteditable="true">'+p+"</span>":f&&(u["data-t"]=f&&f.t||"z",f.v!=null&&(u["data-v"]=f.v),f.z!=null&&(u["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),u.id=(a.id||"sjs")+"-"+d,s.push(gt("td",p,u))}}var g="<tr>";return g+s.join("")+"</tr>"}var X5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',J5="</body></html>";function SU(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return pc(U4(r[0],t),t);var a=gy();return r.forEach(function(n,s){xy(a,U4(n,t),"Sheet"+(s+1))}),a}function Z5(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eC(e,t){var r=t||{},a=r.header!=null?r.header:X5,n=r.footer!=null?r.footer:J5,s=[a],o=gi(e["!ref"]);r.dense=Array.isArray(e),s.push(Z5(e,o,r));for(var A=o.s.r;A<=o.e.r;++A)s.push(W5(e,o,A,r));return s.push("</table>"+n),s.join("")}function tC(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?ma(a.origin):a.origin;n=o.r,s=o.c}var A=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,A.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var d=gi(e["!ref"]);l.s.r=Math.min(l.s.r,d.s.r),l.s.c=Math.min(l.s.c,d.s.c),l.e.r=Math.max(l.e.r,d.e.r),l.e.c=Math.max(l.e.c,d.e.c),n==-1&&(l.e.r=n=d.e.r+1)}var f=[],p=0,u=e["!rows"]||(e["!rows"]=[]),g=0,h=0,y=0,x=0,v=0,E=0;for(e["!cols"]||(e["!cols"]=[]);g<A.length&&h<c;++g){var D=A[g];if(M4(D)){if(a.display)continue;u[h]={hidden:!0}}var B=D.children;for(y=x=0;y<B.length;++y){var I=B[y];if(!(a.display&&M4(I))){var _=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):_b(I.innerHTML),S=I.getAttribute("data-z")||I.getAttribute("z");for(p=0;p<f.length;++p){var O=f[p];O.s.c==x+s&&O.s.r<h+n&&h+n<=O.e.r&&(x=O.e.c+1-s,p=-1)}E=+I.getAttribute("colspan")||1,((v=+I.getAttribute("rowspan")||1)>1||E>1)&&f.push({s:{r:h+n,c:x+s},e:{r:h+n+(v||1)-1,c:x+s+(E||1)-1}});var M={t:"s",v:_},T=I.getAttribute("data-t")||I.getAttribute("t")||"";_!=null&&(_.length==0?M.t=T||"z":a.raw||_.trim().length==0||T=="s"||(_==="TRUE"?M={t:"b",v:!0}:_==="FALSE"?M={t:"b",v:!1}:isNaN(Gs(_))?isNaN(Pd(_).getDate())||(M={t:"d",v:Aa(_)},a.cellDates||(M={t:"n",v:cn(M.v)}),M.z=a.dateNF||Kt[14]):M={t:"n",v:Gs(_)})),M.z===void 0&&S!=null&&(M.z=S);var R="",L=I.getElementsByTagName("A");if(L&&L.length)for(var N=0;N<L.length&&!(L[N].hasAttribute("href")&&(R=L[N].getAttribute("href"),R.charAt(0)!="#"));++N);R&&R.charAt(0)!="#"&&(M.l={Target:R}),a.dense?(e[h+n]||(e[h+n]=[]),e[h+n][x+s]=M):e[$t({c:x+s,r:h+n})]=M,l.e.c<x+s&&(l.e.c=x+s),x+=E}}++h}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,h-1+n),e["!ref"]=or(l),h>=c&&(e["!fullref"]=or((l.e.r=A.length-g+h-1+n,l))),e}function rC(e,t){var r=t||{},a=r.dense?[]:{};return tC(a,e,t)}function TU(e,t){return pc(rC(e,t),t)}function M4(e){var t="",r=OU(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function OU(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function IU(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Sr(t.replace(/<[^>]*>/g,""));return[r]}var P4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function aC(e,t){var r=t||{},a=j2(e),n=[],s,o,A={name:""},c="",l=0,d,f,p={},u=[],g=r.dense?[]:{},h,y,x={value:""},v="",E=0,D=[],B=-1,I=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,O={},M=[],T={},R=0,L=0,N=[],P=1,U=1,V=[],ie={Names:[]},W={},z=["",""],G=[],b={},k="",j=0,q=!1,Y=!1,de=0;for(Uf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");h=Uf.exec(a);)switch(h[3]=h[3].replace(/_.*$/,"")){case"table":case"工作表":h[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?g["!ref"]=or(_):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(g["!fullref"]=g["!ref"],_.e.r=r.sheetRows-1,g["!ref"]=or(_)),M.length&&(g["!merges"]=M),N.length&&(g["!rows"]=N),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),u.push(d.name),p[d.name]=g,Y=!1):h[0].charAt(h[0].length-2)!=="/"&&(d=Xt(h[0],!1),B=I=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,g=r.dense?[]:{},M=[],N=[],Y=!0);break;case"table-row-group":h[1]==="/"?--S:++S;break;case"table-row":case"行":if(h[1]==="/"){B+=P,P=1;break}if(f=Xt(h[0],!1),f.行号?B=f.行号-1:B==-1&&(B=0),P=+f["number-rows-repeated"]||1,P<10)for(de=0;de<P;++de)S>0&&(N[B+de]={level:S});I=-1;break;case"covered-table-cell":h[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(g[B]||(g[B]=[]),g[B][I]={t:"z"}):g[$t({r:B,c:I})]={t:"z"}),v="",D=[];break;case"table-cell":case"数据":if(h[0].charAt(h[0].length-2)==="/")++I,x=Xt(h[0],!1),U=parseInt(x["number-columns-repeated"]||"1",10),y={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(y.f=D4(Sr(x.formula))),(x.数据类型||x["value-type"])=="string"&&(y.t="s",y.v=Sr(x["string-value"]||""),r.dense?(g[B]||(g[B]=[]),g[B][I]=y):g[$t({r:B,c:I})]=y),I+=U-1;else if(h[1]!=="/"){++I,v="",E=0,D=[],U=1;var ue=P?B+P-1:B;if(I>_.e.c&&(_.e.c=I),I<_.s.c&&(_.s.c=I),B<_.s.r&&(_.s.r=B),ue>_.e.r&&(_.e.r=ue),x=Xt(h[0],!1),G=[],b={},y={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Sr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(R=parseInt(x["number-matrix-rows-spanned"],10)||0,L=parseInt(x["number-matrix-columns-spanned"],10)||0,T={s:{r:B,c:I},e:{r:B+R-1,c:I+L-1}},y.F=or(T),V.push([T,y.F])),x.formula)y.f=D4(x.formula);else for(de=0;de<V.length;++de)B>=V[de][0].s.r&&B<=V[de][0].e.r&&I>=V[de][0].s.c&&I<=V[de][0].e.c&&(y.F=V[de][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(R=parseInt(x["number-rows-spanned"],10)||0,L=parseInt(x["number-columns-spanned"],10)||0,T={s:{r:B,c:I},e:{r:B+R-1,c:I+L-1}},M.push(T)),x["number-columns-repeated"]&&(U=parseInt(x["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=na(x["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(x.value);break;case"percentage":y.t="n",y.v=parseFloat(x.value);break;case"currency":y.t="n",y.v=parseFloat(x.value);break;case"date":y.t="d",y.v=Aa(x["date-value"]),r.cellDates||(y.t="n",y.v=cn(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=A3(x["time-value"])/86400,r.cellDates&&(y.t="d",y.v=xm(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(x.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",x["string-value"]!=null&&(v=Sr(x["string-value"]),D=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(q=!1,y.t==="s"&&(y.v=v||"",D.length&&(y.R=D),q=E==0),W.Target&&(y.l=W),G.length>0&&(y.c=G,G=[]),v&&r.cellText!==!1&&(y.w=v),q&&(y.t="z",delete y.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var pe=0;pe<P;++pe){if(U=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[B+pe]||(g[B+pe]=[]),g[B+pe][I]=pe==0?y:Zr(y);--U>0;)g[B+pe][I+U]=Zr(y);else for(g[$t({r:B+pe,c:I})]=y;--U>0;)g[$t({r:B+pe,c:I+U})]=Zr(y);_.e.c<=I&&(_.e.c=I)}U=parseInt(x["number-columns-repeated"]||"1",10),I+=U-1,U=0,y={},v="",D=[]}W={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(h[1]==="/"){if((s=n.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!0]);break;case"annotation":if(h[1]==="/"){if((s=n.pop())[0]!==h[3])throw"Bad state: "+s;b.t=v,D.length&&(b.R=D),b.a=k,G.push(b)}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);k="",j=0,v="",E=0,D=[];break;case"creator":h[1]==="/"?k=a.slice(j,h.index):j=h.index+h[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(h[1]==="/"){if((s=n.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&n.push([h[3],!1]);v="",E=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(h[1]==="/"){if(O[A.name]=c,(s=n.pop())[0]!==h[3])throw"Bad state: "+s}else h[0].charAt(h[0].length-2)!=="/"&&(c="",A=Xt(h[0],!1),n.push([h[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Xt(h[0],!1),c+=P4[h[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Xt(h[0],!1),c+=P4[h[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(h[0].slice(-2)==="/>")break;if(h[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,h.index);break}else l=h.index+h[0].length;break;case"named-range":o=Xt(h[0],!1),z=Fg(o["cell-range-address"]);var ye={Name:o.name,Ref:z[0]+"!"+z[1]};Y&&(ye.Sheet=u.length),ie.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(h[1]==="/"&&(!x||!x["string-value"])){var ve=IU(a.slice(E,h.index));v=(v.length>0?v+`
`:"")+ve[0]}else Xt(h[0],!1),E=h.index+h[0].length;break;case"s":break;case"database-range":if(h[1]==="/")break;try{z=Fg(Xt(h[0])["target-range-address"]),p[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(h[1]!=="/"){if(W=Xt(h[0],!1),!W.href)break;W.Target=Sr(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(z=Fg(W.Target.slice(1)),W.Target="#"+z[0]+"!"+z[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(h[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(h)}}var ae={Sheets:p,SheetNames:u,Workbook:ie};return r.bookSheets&&delete ae.Sheets,ae}function Q4(e,t){t=t||{},xs(e,"META-INF/manifest.xml")&&AN($a(e,"META-INF/manifest.xml"),t);var r=Yi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=aC(Hr(r),t);return xs(e,"meta.xml")&&(a.Props=Kb($a(e,"meta.xml"))),a}function q4(e,t){return aC(e,t)}var NU=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qa+t}}(),K4=function(){var e=function(s){return Pr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,o,A){var c=[];c.push('      <table:table table:name="'+Pr(o.SheetNames[A])+`" table:style-name="ta1">
`);var l=0,d=0,f=gi(s["!ref"]||"A1"),p=s["!merges"]||[],u=0,g=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var h="",y=s["!rows"]||[];for(l=0;l<f.s.r;++l)h=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+h+`></table:table-row>
`);for(;l<=f.e.r;++l){for(h=y[l]?' table:style-name="ro'+y[l].ods+'"':"",c.push("        <table:table-row"+h+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var x=!1,v={},E="";for(u=0;u!=p.length;++u)if(!(p[u].s.c>d)&&!(p[u].s.r>l)&&!(p[u].e.c<d)&&!(p[u].e.r<l)){(p[u].s.c!=d||p[u].s.r!=l)&&(x=!0),v["table:number-columns-spanned"]=p[u].e.c-p[u].s.c+1,v["table:number-rows-spanned"]=p[u].e.r-p[u].s.r+1;break}if(x){c.push(r);continue}var D=$t({r:l,c:d}),B=g?(s[l]||[])[d]:s[D];if(B&&B.f&&(v["table:formula"]=Pr(r8(B.f)),B.F&&B.F.slice(0,D.length)==D)){var I=gi(B.F);v["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,v["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!B){c.push(t);continue}switch(B.t){case"b":E=B.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=B.v?"true":"false";break;case"n":E=B.w||String(B.v||0),v["office:value-type"]="float",v["office:value"]=B.v||0;break;case"s":case"str":E=B.v==null?"":B.v,v["office:value-type"]="string";break;case"d":E=B.w||Aa(B.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Aa(B.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(E);if(B.l&&B.l.Target){var S=B.l.Target;S=S.charAt(0)=="#"?"#"+a8(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=gt("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+gt("table:table-cell",gt("text:p",_,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var A=0;o.SheetNames.map(function(l){return o.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var d=0;d<l["!cols"].length;++d)if(l["!cols"][d]){var f=l["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;sc(f),f.ods=A;var p=l["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+A+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++A}}});var c=0;o.SheetNames.map(function(l){return o.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var d=0;d<l["!rows"].length;++d)if(l["!rows"][d]){l["!rows"][d].ods=c;var f=l["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,A){var c=[Qa],l=Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});A.bookType=="fods"?(c.push("<office:document"+l+d+`>
`),c.push(qb().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),A.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function nC(e,t){if(t.bookType=="fods")return K4(e,t);var r=F2(),a="",n=[],s=[];return a="mimetype",Ar(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ar(r,a,K4(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Ar(r,a,NU(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Ar(r,a,Qa+qb()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Ar(r,a,dN(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ar(r,a,cN(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _x(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Hr(fc(e))}function FU(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$i(lo(e))}function RU(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Ac(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function H4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function kU(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function DU(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function Gf(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ur(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ta(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Or(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Gf(e,r),s=n&7;n=Math.floor(n/8);var o=0,A;if(n==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);A=e.slice(c,r[0])}break;case 5:o=4,A=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,A=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Gf(e,r),A=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var l={data:A,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function _n(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Ur(a*8+n.type)),n.type==2&&t.push(Ur(n.data.length)),t.push(n.data))})}),Ac(t)}function ly(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ms(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Gf(e,a),s=Or(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:Ta(s[1][0].data),messages:[]};s[2].forEach(function(A){var c=Or(A.data),l=Ta(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(t=s[3])!=null&&t[0]&&(o.merge=Ta(s[3][0].data)>>>0>0),r.push(o)}return r}function Vl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Ur(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Ur(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Ur(o.data.length)}],a[2].push({data:_n(o.meta),type:2})});var s=_n(a);t.push(Ur(s.length)),t.push(s),n.forEach(function(o){return t.push(o)})}),Ac(t)}function jU(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Gf(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var A=o-59;o=t[r[0]],A>1&&(o|=t[r[0]+1]<<8),A>2&&(o|=t[r[0]+2]<<16),A>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=A}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,l=0;if(s==1?(l=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Ac(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var d=Ac(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function gs(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jU(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ac(t)}function $l(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=Ur(a),o=s.length;t.push(s),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Ac(t)}function LU(e,t,r,a){var n=dl(e),s=n.getUint32(4,!0),o=(a>1?12:8)+H4(s&(a>1?3470:398))*4,A=-1,c=-1,l=NaN,d=new Date(2001,0,1);s&512&&(A=n.getUint32(o,!0),o+=4),o+=H4(s&(a>1?12288:4096))*4,s&16&&(c=n.getUint32(o,!0),o+=4),s&32&&(l=n.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(A>-1)f={t:"s",v:r[A]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function UU(e,t,r){var a=dl(e),n=a.getUint32(8,!0),s=12,o=-1,A=-1,c=NaN,l=NaN,d=new Date(2001,0,1);n&1&&(c=kU(e,s),s+=16),n&2&&(l=a.getFloat64(s,!0),s+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(A=a.getUint32(s,!0),s+=4),n&16&&(o=a.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[A]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function kg(e,t){var r=new Uint8Array(32),a=dl(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,DU(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function Dg(e,t){var r=new Uint8Array(32),a=dl(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function MU(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return LU(e,t,r,e[0]);case 5:return UU(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function qn(e){var t=Or(e);return Gf(t[1][0].data)}function G4(e,t){var r=Or(t.data),a=Ta(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(o){var A=Or(o.data),c=Ta(A[1][0].data)>>>0;switch(a){case 1:s[c]=_x(A[3][0].data);break;case 8:{var l=e[qn(A[9][0].data)][0],d=Or(l.data),f=e[qn(d[1][0].data)][0],p=Ta(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var u=Or(f.data);s[c]=u[3].map(function(g){return _x(g.data)}).join("")}break}}),s}function PU(e,t){var r,a,n,s,o,A,c,l,d,f,p,u,g,h,y=Or(e),x=Ta(y[1][0].data)>>>0,v=Ta(y[2][0].data)>>>0,E=((a=(r=y[8])==null?void 0:r[0])==null?void 0:a.data)&&Ta(y[8][0].data)>0||!1,D,B;if((s=(n=y[7])==null?void 0:n[0])!=null&&s.data&&t!=0)D=(A=(o=y[7])==null?void 0:o[0])==null?void 0:A.data,B=(l=(c=y[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)D=(u=(p=y[4])==null?void 0:p[0])==null?void 0:u.data,B=(h=(g=y[3])==null?void 0:g[0])==null?void 0:h.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=E?4:1,_=dl(D),S=[],O=0;O<D.length/2;++O){var M=_.getUint16(O*2,!0);M<65535&&S.push([O,M])}if(S.length!=v)throw"Expected ".concat(v," cells, found ").concat(S.length);var T=[];for(O=0;O<S.length-1;++O)T[S[O][0]]=B.subarray(S[O][1]*I,S[O+1][1]*I);return S.length>=1&&(T[S[S.length-1][0]]=B.subarray(S[S.length-1][1]*I)),{R:x,cells:T}}function QU(e,t){var r,a=Or(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Ta(a[7][0].data)>>>0>0?1:0:-1,s=ly(a[5],function(o){return PU(o,n)});return{nrows:Ta(a[4][0].data)>>>0,data:s.reduce(function(o,A){return o[A.R]||(o[A.R]=[]),A.cells.forEach(function(c,l){if(o[A.R][l])throw new Error("Duplicate cell r=".concat(A.R," c=").concat(l));o[A.R][l]=c}),o},[])}}function qU(e,t,r){var a,n=Or(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ta(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Ta(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=or(s);var o=Or(n[4][0].data),A=G4(e,e[qn(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?G4(e,e[qn(o[17][0].data)][0]):[],l=Or(o[3][0].data),d=0;l[1].forEach(function(f){var p=Or(f.data),u=e[qn(p[2][0].data)][0],g=Ta(u.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var h=QU(e,u);h.data.forEach(function(y,x){y.forEach(function(v,E){var D=$t({r:d+x,c:E}),B=MU(v,A,c);B&&(r[D]=B)})}),d+=h.nrows})}function KU(e,t){var r=Or(t.data),a={"!ref":"A1"},n=e[qn(r[2][0].data)],s=Ta(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return qU(e,n[0],a),a}function HU(e,t){var r,a=Or(t.data),n={name:(r=a[1])!=null&&r[0]?_x(a[1][0].data):"",sheets:[]},s=ly(a[2],qn);return s.forEach(function(o){e[o].forEach(function(A){var c=Ta(A.meta[1][0].data);c==6e3&&n.sheets.push(KU(e,A))})}),n}function GU(e,t){var r=gy(),a=Or(t.data),n=ly(a[1],qn);if(n.forEach(function(s){e[s].forEach(function(o){var A=Ta(o.meta[1][0].data);if(A==2){var c=HU(e,o);c.sheets.forEach(function(l,d){xy(r,l,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jg(e){var t,r,a,n,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=gs(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ms(l)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var A=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Ta(s[1][0].meta[1][0].data)==1&&s[1][0];if(A||o.forEach(function(c){s[c].forEach(function(l){var d=Ta(l.meta[1][0].data)>>>0;if(d==1)if(!A)A=l;else throw new Error("Document has multiple roots")})}),!A)throw new Error("Cannot find Document root");return GU(s,A)}function zU(e,t,r){var a,n,s,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var A=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Ta(e[8][0].data)>0||!1;if(A)throw"Math only works with normal offsets";for(var c=0,l=dl(e[7][0].data),d=0,f=[],p=dl(e[4][0].data),u=0,g=[],h=0;h<t.length;++h){if(t[h]==null){l.setUint16(h*2,65535,!0),p.setUint16(h*2,65535);continue}l.setUint16(h*2,d,!0),p.setUint16(h*2,u,!0);var y,x;switch(typeof t[h]){case"string":y=kg({t:"s",v:t[h]},r),x=Dg({t:"s",v:t[h]},r);break;case"number":y=kg({t:"n",v:t[h]},r),x=Dg({t:"n",v:t[h]},r);break;case"boolean":y=kg({t:"b",v:t[h]},r),x=Dg({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}f.push(y),d+=y.length,g.push(x),u+=x.length,++c}for(e[2][0].data=Ur(c);h<e[7][0].data.length/2;++h)l.setUint16(h*2,65535,!0),p.setUint16(h*2,65535,!0);return e[6][0].data=Ac(f),e[3][0].data=Ac(g),c}function VU(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=gi(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(or(a)));var s=Lh(r,{range:a,header:1}),o=["~Sh33tJ5~"];s.forEach(function(k){return k.forEach(function(j){typeof j=="string"&&o.push(j)})});var A={},c=[],l=Lt.read(t.numbers,{type:"base64"});l.FileIndex.map(function(k,j){return[k,l.FullPaths[j]]}).forEach(function(k){var j=k[0],q=k[1];if(j.type==2&&j.name.match(/\.iwa/)){var Y=j.content,de=gs(Y),ue=ms(de);ue.forEach(function(pe){c.push(pe.id),A[pe.id]={deps:[],location:q,type:Ta(pe.messages[0].meta[1][0].data)}})}}),c.sort(function(k,j){return k-j});var d=c.filter(function(k){return k>1}).map(function(k){return[k,Ur(k)]});l.FileIndex.map(function(k,j){return[k,l.FullPaths[j]]}).forEach(function(k){var j=k[0];if(k[1],!!j.name.match(/\.iwa/)){var q=ms(gs(j.content));q.forEach(function(Y){Y.messages.forEach(function(de){d.forEach(function(ue){Y.messages.some(function(pe){return Ta(pe.meta[1][0].data)!=11006&&RU(pe.data,ue[1])})&&A[ue[0]].deps.push(Y.id)})})})}});for(var f=Lt.find(l,A[1].location),p=ms(gs(f.content)),u,g=0;g<p.length;++g){var h=p[g];h.id==1&&(u=h)}var y=qn(Or(u.messages[0].data)[1][0].data);for(f=Lt.find(l,A[y].location),p=ms(gs(f.content)),g=0;g<p.length;++g)h=p[g],h.id==y&&(u=h);for(y=qn(Or(u.messages[0].data)[2][0].data),f=Lt.find(l,A[y].location),p=ms(gs(f.content)),g=0;g<p.length;++g)h=p[g],h.id==y&&(u=h);for(y=qn(Or(u.messages[0].data)[2][0].data),f=Lt.find(l,A[y].location),p=ms(gs(f.content)),g=0;g<p.length;++g)h=p[g],h.id==y&&(u=h);var x=Or(u.messages[0].data);{x[6][0].data=Ur(a.e.r+1),x[7][0].data=Ur(a.e.c+1);var v=qn(x[46][0].data),E=Lt.find(l,A[v].location),D=ms(gs(E.content));{for(var B=0;B<D.length&&D[B].id!=v;++B);if(D[B].id!=v)throw"Bad ColumnRowUIDMapArchive";var I=Or(D[B].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var _=0;_<=a.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:Ur(_+420690)}],I[1].push({type:2,data:_n(S)}),I[2].push({type:0,data:Ur(_)}),I[3].push({type:0,data:Ur(_)})}I[4]=[],I[5]=[],I[6]=[];for(var O=0;O<=a.e.r;++O)S=[],S[1]=S[2]=[{type:0,data:Ur(O+726270)}],I[4].push({type:2,data:_n(S)}),I[5].push({type:0,data:Ur(O)}),I[6].push({type:0,data:Ur(O)});D[B].messages[0].data=_n(I)}E.content=$l(Vl(D)),E.size=E.content.length,delete x[46];var M=Or(x[4][0].data);{M[7][0].data=Ur(a.e.r+1);var T=Or(M[1][0].data),R=qn(T[2][0].data);E=Lt.find(l,A[R].location),D=ms(gs(E.content));{if(D[0].id!=R)throw"Bad HeaderStorageBucket";var L=Or(D[0].messages[0].data);for(O=0;O<s.length;++O){var N=Or(L[2][0].data);N[1][0].data=Ur(O),N[4][0].data=Ur(s[O].length),L[2][O]={type:L[2][0].type,data:_n(N)}}D[0].messages[0].data=_n(L)}E.content=$l(Vl(D)),E.size=E.content.length;var P=qn(M[2][0].data);E=Lt.find(l,A[P].location),D=ms(gs(E.content));{if(D[0].id!=P)throw"Bad HeaderStorageBucket";for(L=Or(D[0].messages[0].data),_=0;_<=a.e.c;++_)N=Or(L[2][0].data),N[1][0].data=Ur(_),N[4][0].data=Ur(a.e.r+1),L[2][_]={type:L[2][0].type,data:_n(N)};D[0].messages[0].data=_n(L)}E.content=$l(Vl(D)),E.size=E.content.length;var U=qn(M[4][0].data);(function(){for(var k=Lt.find(l,A[U].location),j=ms(gs(k.content)),q,Y=0;Y<j.length;++Y){var de=j[Y];de.id==U&&(q=de)}var ue=Or(q.messages[0].data);{ue[3]=[];var pe=[];o.forEach(function(ae,Ke){pe[1]=[{type:0,data:Ur(Ke)}],pe[2]=[{type:0,data:Ur(1)}],pe[3]=[{type:2,data:FU(ae)}],ue[3].push({type:2,data:_n(pe)})})}q.messages[0].data=_n(ue);var ye=Vl(j),ve=$l(ye);k.content=ve,k.size=k.content.length})();var V=Or(M[3][0].data);{var ie=V[1][0];delete V[2];var W=Or(ie.data);{var z=qn(W[2][0].data);(function(){for(var k=Lt.find(l,A[z].location),j=ms(gs(k.content)),q,Y=0;Y<j.length;++Y){var de=j[Y];de.id==z&&(q=de)}var ue=Or(q.messages[0].data);{delete ue[6],delete V[7];var pe=new Uint8Array(ue[5][0].data);ue[5]=[];for(var ye=0,ve=0;ve<=a.e.r;++ve){var ae=Or(pe);ye+=zU(ae,s[ve],o),ae[1][0].data=Ur(ve),ue[5].push({data:_n(ae),type:2})}ue[1]=[{type:0,data:Ur(a.e.c+1)}],ue[2]=[{type:0,data:Ur(a.e.r+1)}],ue[3]=[{type:0,data:Ur(ye)}],ue[4]=[{type:0,data:Ur(a.e.r+1)}]}q.messages[0].data=_n(ue);var Ke=Vl(j),Ee=$l(Ke);k.content=Ee,k.size=k.content.length})()}ie.data=_n(W)}M[3][0].data=_n(V)}x[4][0].data=_n(M)}u.messages[0].data=_n(x);var G=Vl(p),b=$l(G);return f.content=b,f.size=f.content.length,l}function iC(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function dy(e){iC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function uy(e){iC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function $U(e){return ur.WS.indexOf(e)>-1?"sheet":e==ur.CS?"chart":e==ur.DS?"dialog":e==ur.MS?"macro":e&&e.length?e:"sheet"}function YU(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,$U(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function WU(e,t,r,a,n,s,o,A,c,l,d,f){try{s[a]=df(Yi(e,r,!0),t);var p=$a(e,t),u;switch(A){case"sheet":u=EL(p,t,n,c,s[a],l,d,f);break;case"chart":if(u=_L(p,t,n,c,s[a],l,d,f),!u||!u["!drawel"])break;var g=Hu(u["!drawel"].Target,t),h=Mf(g),y=lk(Yi(e,g,!0),df(Yi(e,h,!0),g)),x=Hu(y,g),v=Mf(x);u=Xj(Yi(e,x,!0),x,c,df(Yi(e,v,!0),x),l,u);break;case"macro":u=bL(p,t,n,c,s[a],l,d,f);break;case"dialog":u=CL(p,t,n,c,s[a],l,d,f);break;default:throw new Error("Unrecognized sheet type "+A)}o[a]=u;var E=[];s&&s[a]&&Oa(s[a]).forEach(function(D){var B="";if(s[a][D].Type==ur.CMNT){B=Hu(s[a][D].Target,t);var I=OL($a(e,B,!0),B,c);if(!I||!I.length)return;I4(u,I,!1)}s[a][D].Type==ur.TCMNT&&(B=Hu(s[a][D].Target,t),E=E.concat(uk($a(e,B,!0),c)))}),E&&E.length&&I4(u,E,!0,c.people||[])}catch(D){if(c.WTF)throw D}}function fs(e){return e.charAt(0)=="/"?e.slice(1):e}function sC(e,t){if(Vd(),t=t||{},dy(t),xs(e,"META-INF/manifest.xml")||xs(e,"objectdata.xml"))return Q4(e,t);if(xs(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jg<"u"){if(e.FileIndex)return jg(e);var r=Lt.utils.cfb_new();return Xv(e).forEach(function(N){Ar(r,N,f3(e,N))}),jg(r)}throw new Error("Unsupported NUMBERS file")}if(!xs(e,"[Content_Types].xml"))throw xs(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xs(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Xv(e),n=sN(Yi(e,"[Content_Types].xml")),s=!1,o,A;if(n.workbooks.length===0&&(A="xl/workbook.xml",$a(e,A,!0)&&n.workbooks.push(A)),n.workbooks.length===0){if(A="xl/workbook.bin",!$a(e,A,!0))throw new Error("Could not find workbook");n.workbooks.push(A),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(uf=[],n.sst)try{uf=TL($a(e,fs(n.sst)),n.sst,t)}catch(N){if(t.WTF)throw N}t.cellStyles&&n.themes.length&&(c=SL(Yi(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(l=BL($a(e,fs(n.style)),n.style,c,t))}n.links.map(function(N){try{var P=df(Yi(e,Mf(fs(N))),N);return NL($a(e,fs(N)),P,N,t)}catch{}});var d=wL($a(e,fs(n.workbooks[0])),n.workbooks[0],t),f={},p="";n.coreprops.length&&(p=$a(e,fs(n.coreprops[0]),!0),p&&(f=Kb(p)),n.extprops.length!==0&&(p=$a(e,fs(n.extprops[0]),!0),p&&fN(p,f,t)));var u={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(p=Yi(e,fs(n.custprops[0]),!0),p&&(u=hN(p,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(P){return P.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=u),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var h={};t.bookDeps&&n.calcchain&&(h=IL($a(e,fs(n.calcchain)),n.calcchain));var y=0,x={},v,E;{var D=d.Sheets;f.Worksheets=D.length,f.SheetNames=[];for(var B=0;B!=D.length;++B)f.SheetNames[B]=D[B].name}var I=s?"bin":"xml",_=n.workbooks[0].lastIndexOf("/"),S=(n.workbooks[0].slice(0,_+1)+"_rels/"+n.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");xs(e,S)||(S="xl/_rels/workbook."+I+".rels");var O=df(Yi(e,S,!0),S.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=FL($a(e,fs(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=pk($a(e,fs(n.people[0])),t)),O&&(O=YU(O,d.Sheets));var M=$a(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var T="sheet";if(O&&O[y]?(v="xl/"+O[y][1].replace(/[\/]?xl\//,""),xs(e,v)||(v=O[y][1]),xs(e,v)||(v=S.replace(/_rels\/.*$/,"")+O[y][1]),T=O[y][2]):(v="xl/worksheets/sheet"+(y+1-M)+"."+I,v=v.replace(/sheet0\./,"sheet.")),E=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==y&&(R=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[y].toLowerCase()&&(R=1);if(!R)continue e}}WU(e,v,E,f.SheetNames[y],y,x,o,T,t,d,c,l)}return g={Directory:n,Workbook:d,Props:f,Custprops:u,Deps:h,Sheets:o,SheetNames:f.SheetNames,Strings:uf,Styles:l,Themes:c,SSF:Zr(Kt)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(N,P){N=N.replace(/^Root Entry[\/]/,""),g.keys.push(N),g.files[N]=e.FileIndex[P]}))),t&&t.bookVBA&&(n.vba.length>0?g.vbaraw=$a(e,fs(n.vba[0]),!0):n.defaults&&n.defaults.bin===Ek&&(g.vbaraw=$a(e,"xl/vbaProject.bin",!0))),g}function XU(e,t){var r=t||{},a="Workbook",n=Lt.find(e,a);try{if(a="/!DataSpaces/Version",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(RR(n.content),a="/!DataSpaces/DataSpaceMap",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=DR(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=jR(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);UR(n.content)}catch{}if(a="/EncryptionInfo",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var A=MR(n.content);if(a="/EncryptedPackage",n=Lt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(A[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(A[1],n.content,r.password||"",r);if(A[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(A[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function JU(e,t){return t.bookType=="ods"?nC(e,t):t.bookType=="numbers"?VU(e,t):t.bookType=="xlsb"?ZU(e,t):oC(e,t)}function ZU(e,t){vd=1024,e&&!e.SSF&&(e.SSF=Zr(Kt)),e&&e.SSF&&(Vd(),i0(e.SSF),t.revssf=gm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=T5.indexOf(t.bookType)>-1,n=W2();uy(t=t||{});var s=F2(),o="",A=0;if(t.cellXfs=[],hc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ar(s,o,Hb(e.Props,t)),n.coreprops.push(o),Mr(t.rels,2,o,ur.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ar(s,o,Vb(e.Props)),n.extprops.push(o),Mr(t.rels,3,o,ur.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(s,o,$b(e.Custprops)),n.custprops.push(o),Mr(t.rels,4,o,ur.CUST_PROPS)),A=1;A<=e.SheetNames.length;++A){var d={"!id":{}},f=e.Sheets[e.SheetNames[A-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+A+"."+r,Ar(s,o,kL(A-1,o,t,e,d)),n.sheets.push(o),Mr(t.wbrels,-1,"worksheets/sheet"+A+"."+r,ur.WS[0])}if(f){var u=f["!comments"],g=!1,h="";u&&u.length>0&&(h="xl/comments"+A+"."+r,Ar(s,h,LL(u,h)),n.comments.push(h),Mr(d,-1,"../comments"+A+"."+r,ur.CMNT),g=!0),f["!legacy"]&&g&&Ar(s,"xl/drawings/vmlDrawing"+A+".vml",B5(A,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ar(s,Mf(o),Sd(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(s,o,jL(t.Strings,o,t)),n.strs.push(o),Mr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),o="xl/workbook."+r,Ar(s,o,RL(e,o)),n.workbooks.push(o),Mr(t.rels,1,o,ur.WB),o="xl/theme/theme1.xml",Ar(s,o,ry(e.Themes,t)),n.themes.push(o),Mr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),o="xl/styles."+r,Ar(s,o,DL(e,o,t)),n.styles.push(o),Mr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(s,o,e.vbaraw),n.vba.push(o),Mr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),o="xl/metadata."+r,Ar(s,o,UL(o)),n.metadata.push(o),Mr(t.wbrels,-1,"metadata."+r,ur.XLMETA),Ar(s,"[Content_Types].xml",Qb(n,t)),Ar(s,"_rels/.rels",Sd(t.rels)),Ar(s,"xl/_rels/workbook."+r+".rels",Sd(t.wbrels)),delete t.revssf,delete t.ssf,s}function oC(e,t){vd=1024,e&&!e.SSF&&(e.SSF=Zr(Kt)),e&&e.SSF&&(Vd(),i0(e.SSF),t.revssf=gm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=T5.indexOf(t.bookType)>-1,n=W2();uy(t=t||{});var s=F2(),o="",A=0;if(t.cellXfs=[],hc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ar(s,o,Hb(e.Props,t)),n.coreprops.push(o),Mr(t.rels,2,o,ur.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ar(s,o,Vb(e.Props)),n.extprops.push(o),Mr(t.rels,3,o,ur.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(s,o,$b(e.Custprops)),n.custprops.push(o),Mr(t.rels,4,o,ur.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,A=1;A<=e.SheetNames.length;++A){var f={"!id":{}},p=e.Sheets[e.SheetNames[A-1]],u=(p||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+A+"."+r,Ar(s,o,M5(A-1,t,e,f)),n.sheets.push(o),Mr(t.wbrels,-1,"worksheets/sheet"+A+"."+r,ur.WS[0])}if(p){var g=p["!comments"],h=!1,y="";if(g&&g.length>0){var x=!1;g.forEach(function(v){v[1].forEach(function(E){E.T==!0&&(x=!0)})}),x&&(y="xl/threadedComments/threadedComment"+A+"."+r,Ar(s,y,fk(g,d,t)),n.threadedcomments.push(y),Mr(f,-1,"../threadedComments/threadedComment"+A+"."+r,ur.TCMNT)),y="xl/comments"+A+"."+r,Ar(s,y,S5(g)),n.comments.push(y),Mr(f,-1,"../comments"+A+"."+r,ur.CMNT),h=!0}p["!legacy"]&&h&&Ar(s,"xl/drawings/vmlDrawing"+A+".vml",B5(A,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Ar(s,Mf(o),Sd(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(s,o,p5(t.Strings,t)),n.strs.push(o),Mr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),o="xl/workbook."+r,Ar(s,o,G5(e)),n.workbooks.push(o),Mr(t.rels,1,o,ur.WB),o="xl/theme/theme1.xml",Ar(s,o,ry(e.Themes,t)),n.themes.push(o),Mr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),o="xl/styles."+r,Ar(s,o,E5(e,t)),n.styles.push(o),Mr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(s,o,e.vbaraw),n.vba.push(o),Mr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),o="xl/metadata."+r,Ar(s,o,C5()),n.metadata.push(o),Mr(t.wbrels,-1,"metadata."+r,ur.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ar(s,o,hk(d)),n.people.push(o),Mr(t.wbrels,-1,"persons/person.xml",ur.PEOPLE)),Ar(s,"[Content_Types].xml",Qb(n,t)),Ar(s,"_rels/.rels",Sd(t.rels)),Ar(s,"xl/_rels/workbook."+r+".rels",Sd(t.wbrels)),delete t.revssf,delete t.ssf,s}function fy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=rs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function e7(e,t){return Lt.find(e,"EncryptedPackage")?XU(e,t):cy(e,t)}function t7(e,t){var r,a=e,n=t||{};return n.type||(n.type=lr&&Buffer.isBuffer(e)?"buffer":"base64"),r=vb(a,n),sC(r,n)}function AC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return wx(e.slice(r),t);default:break e}return Qd.to_workbook(e,t)}function r7(e,t){var r="",a=fy(e,t);switch(t.type){case"base64":r=rs(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ol(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Hr(r)),t.type="binary",AC(r,t)}function a7(e,t){var r=e;return t.type=="base64"&&(r=rs(r)),r=_r.utils.decode(1200,r.slice(2),"str"),t.type="binary",AC(r,t)}function n7(e){return e.match(/[^\x00-\x7F]/)?lo(e):e}function Lg(e,t,r,a){return a?(r.type="string",Qd.to_workbook(e,r)):Qd.to_workbook(t,r)}function ul(e,t){hm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ul(new Uint8Array(e),(r=Zr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Od={},r.dateNF&&(Od.dateNF=r.dateNF),r.type||(r.type=lr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=lr?"buffer":"binary",a=i3(e),typeof Uint8Array<"u"&&!lr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=n7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),A=new Uint8Array(o);if(A.foo="bar",!A.foo)return r=Zr(r),r.type="array",ul(T2(a),r)}switch((n=fy(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return e7(Lt.read(a,r),r);break;case 9:if(n[1]<=8)return cy(a,r);break;case 60:return wx(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return mR(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return u5.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?t7(a,r):Lg(e,a,r,s);case 239:return n[3]===60?wx(a,r):Lg(e,a,r,s);case 255:if(n[1]===254)return a7(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Wc.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Wc.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return vx.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return y5.to_workbook(a,r);break;case 10:case 13:case 32:return r7(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return hR.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?vx.to_workbook(a,r):Lg(e,a,r,s)}function z4(e,t){var r=t||{};return r.type="file",ul(e,r)}function cC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return s0(t.file,Lt.write(e,{type:lr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Lt.write(e,t)}function i7(e,t){var r=Zr(t||{}),a=JU(e,r);return lC(a,r)}function s7(e,t){var r=Zr(t||{}),a=oC(e,r);return lC(a,r)}function lC(e,t){var r={},a=lr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(n0(n))}return t.password&&typeof encrypt_agile<"u"?cC(encrypt_agile(n,t.password),t):t.type==="file"?s0(t.file,n):t.type=="string"?Hr(n):n}function o7(e,t){var r=t||{},a=lU(e,r);return cC(a,r)}function so(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return kf(lo(a));case"binary":return lo(a);case"string":return e;case"file":return s0(t.file,a,"utf8");case"buffer":return lr?nA(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):so(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function A7(e,t){switch(t.type){case"base64":return kf(e);case"binary":return e;case"string":return e;case"file":return s0(t.file,e,"binary");case"buffer":return lr?nA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?kf(r):t.type=="string"?Hr(r):r;case"file":return s0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function py(e,t){hm(),H5(e);var r=Zr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=py(e,r);return r.type="array",n0(a)}return s7(e,r)}function bm(e,t){hm(),H5(e);var r=Zr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=bm(e,r);return r.type="array",n0(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return so(aU(e,r),r);case"slk":case"sylk":return so(d5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return so(eC(e.Sheets[e.SheetNames[n]],r),r);case"txt":return A7(fC(e.Sheets[e.SheetNames[n]],r),r);case"csv":return so(my(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return so(u5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return hp(vx.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return so(Qd.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return so(y5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return so(f5.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return so(nC(e,r),r);case"wk1":return hp(Wc.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return hp(Wc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),hp(Y5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),o7(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return i7(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hy(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function jh(e,t,r){var a=r||{};return a.type="file",a.file=t,hy(a),bm(e,a)}function c7(e,t,r){var a=r||{};return a.type="file",a.file=t,hy(a),py(e,a)}function l7(e,t,r,a){var n=r||{};n.type="file",n.file=e,hy(n),n.type="buffer";var s=a;return s instanceof Function||(s=r),KA.writeFile(e,bm(t,n),s)}function dC(e,t,r,a,n,s,o,A){var c=Sa(r),l=A.defval,d=A.raw||!Object.prototype.hasOwnProperty.call(A,"raw"),f=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var u=t.s.c;u<=t.e.c;++u){var g=o?e[r][u]:e[a[u]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[u]!=null&&(p[s[u]]=l);continue}var h=g.v;switch(g.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[u]!=null){if(h==null)if(g.t=="e"&&h===null)p[s[u]]=null;else if(l!==void 0)p[s[u]]=l;else if(d&&h===null)p[s[u]]=null;else continue;else p[s[u]]=d&&(g.t!=="n"||g.t==="n"&&A.rawNumbers!==!1)?h:mo(g,h,A);h!=null&&(f=!1)}}return{row:p,isempty:f}}function Lh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],o=0,A="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},d=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof d){case"string":c=gr(d);break;case"number":c=gr(e["!ref"]),c.s.r=d;break;default:c=d}a>0&&(n=0);var f=Sa(c.s.r),p=[],u=[],g=0,h=0,y=Array.isArray(e),x=c.s.r,v=0,E={};y&&!e[x]&&(e[x]=[]);var D=l.skipHidden&&e["!cols"]||[],B=l.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(D[v]||{}).hidden)switch(p[v]=oa(v),r=y?e[x][v]:e[p[v]+f],a){case 1:s[v]=v-c.s.c;break;case 2:s[v]=p[v];break;case 3:s[v]=l.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),A=o=mo(r,null,l),h=E[o]||0,!h)E[o]=1;else{do A=o+"_"+h++;while(E[A]);E[o]=h,E[A]=1}s[v]=A}for(x=c.s.r+n;x<=c.e.r;++x)if(!(B[x]||{}).hidden){var I=dC(e,c,x,p,a,s,y,l);(I.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(u[g++]=I.row)}return u.length=g,u}var V4=/"/g;function uC(e,t,r,a,n,s,o,A){for(var c=!0,l=[],d="",f=Sa(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var u=A.dense?(e[r]||[])[p]:e[a[p]+f];if(u==null)d="";else if(u.v!=null){c=!1,d=""+(A.rawNumbers&&u.t=="n"?u.v:mo(u,null,A));for(var g=0,h=0;g!==d.length;++g)if((h=d.charCodeAt(g))===n||h===s||h===34||A.forceQuotes){d='"'+d.replace(V4,'""')+'"';break}d=="ID"&&(d='"ID"')}else u.f!=null&&!u.F?(c=!1,d="="+u.f,d.indexOf(",")>=0&&(d='"'+d.replace(V4,'""')+'"')):d="";l.push(d)}return A.blankrows===!1&&c?null:l.join(o)}function my(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=gr(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),A=a.RS!==void 0?a.RS:`
`,c=A.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(f[g]=oa(g));for(var h=0,y=n.s.r;y<=n.e.r;++y)(u[y]||{}).hidden||(d=uC(e,n,y,f,o,c,s,a),d!=null&&(a.strip&&(d=d.replace(l,"")),(d||a.blankrows!==!1)&&r.push((h++?A:"")+d)));return delete a.dense,r.join("")}function fC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=my(e,t);if(typeof _r>"u"||t.type=="string")return r;var a=_r.utils.encode(1200,r,"str");return"ÿþ"+a}function d7(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=gr(e["!ref"]),s="",o=[],A,c=[],l=Array.isArray(e);for(A=n.s.c;A<=n.e.c;++A)o[A]=oa(A);for(var d=n.s.r;d<=n.e.r;++d)for(s=Sa(d),A=n.s.c;A<=n.e.c;++A)if(t=o[A]+s,r=l?(e[d]||[])[A]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function pC(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},o=0,A=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?ma(a.origin):a.origin;o=c.r,A=c.c}var l,d={s:{c:0,r:0},e:{c:A,r:o+t.length-1+n}};if(s["!ref"]){var f=gr(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+n)}else o==-1&&(o=0,d.e.r=t.length-1+n);var p=a.header||[],u=0;t.forEach(function(h,y){Oa(h).forEach(function(x){(u=p.indexOf(x))==-1&&(p[u=p.length]=x);var v=h[x],E="z",D="",B=$t({c:A+u,r:o+y+n});l=zf(s,B),v&&typeof v=="object"&&!(v instanceof Date)?s[B]=v:(typeof v=="number"?E="n":typeof v=="boolean"?E="b":typeof v=="string"?E="s":v instanceof Date?(E="d",a.cellDates||(E="n",v=cn(v)),D=a.dateNF||Kt[14]):v===null&&a.nullError&&(E="e",v=0),l?(l.t=E,l.v=v,delete l.w,delete l.R,D&&(l.z=D)):s[B]=l={t:E,v},D&&(l.z=D))})}),d.e.c=Math.max(d.e.c,A+p.length-1);var g=Sa(o);if(n)for(u=0;u<p.length;++u)s[oa(u+A)+g]={t:"s",v:p[u]};return s["!ref"]=or(d),s}function u7(e,t){return pC(null,e,t)}function zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=ma(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zf(e,$t(t)):zf(e,$t({r:t,c:r||0}))}function f7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gy(){return{SheetNames:[],Sheets:{}}}function xy(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var o=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(K5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function p7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=f7(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function h7(e,t){return e.z=t,e}function hC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function m7(e,t,r){return hC(e,"#"+t,r)}function g7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function x7(e,t,r,a){for(var n=typeof t!="string"?t:gr(t),s=typeof t=="string"?t:or(t),o=n.s.r;o<=n.e.r;++o)for(var A=n.s.c;A<=n.e.c;++A){var c=zf(e,o,A);c.t="n",c.F=s,delete c.v,o==n.s.r&&A==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var ui={encode_col:oa,encode_row:Sa,encode_cell:$t,encode_range:or,decode_col:H2,decode_row:K2,split_cell:L3,decode_cell:ma,decode_range:gi,format_cell:mo,sheet_add_aoa:kb,sheet_add_json:pC,sheet_add_dom:tC,aoa_to_sheet:Yd,json_to_sheet:u7,table_to_sheet:rC,table_to_book:TU,sheet_to_csv:my,sheet_to_txt:fC,sheet_to_json:Lh,sheet_to_html:eC,sheet_to_formulae:d7,sheet_to_row_object_array:Lh,sheet_get_cell:zf,book_new:gy,book_append_sheet:xy,book_set_sheet_visibility:p7,cell_set_number_format:h7,cell_set_hyperlink:hC,cell_set_internal_link:m7,cell_add_comment:g7,sheet_set_array_formula:x7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Cm;function y7(e){Cm=e}function v7(e,t){var r=Cm(),a=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var n=gr(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),A=a.RS!==void 0?a.RS:`
`,c=A.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(f[g]=oa(g));var h=n.s.r,y=!1,x=0;return r._read=function(){if(!y)return y=!0,r.push("\uFEFF");for(;h<=n.e.r;)if(++h,!(u[h-1]||{}).hidden&&(d=uC(e,n,h-1,f,o,c,s,a),d!=null&&(a.strip&&(d=d.replace(l,"")),d||a.blankrows!==!1)))return r.push((x++?A:"")+d);return r.push(null)},r}function w7(e,t){var r=Cm(),a=t||{},n=a.header!=null?a.header:X5,s=a.footer!=null?a.footer:J5;r.push(n);var o=gi(e["!ref"]);a.dense=Array.isArray(e),r.push(Z5(e,o,a));var A=o.s.r,c=!1;return r._read=function(){if(A>o.e.r)return c||(c=!0,r.push("</table>"+s)),r.push(null);for(;A<=o.e.r;){r.push(W5(e,o,A,a)),++A;break}},r}function E7(e,t){var r=Cm({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var a={t:"n",v:0},n=0,s=1,o=[],A=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)&&(n=3),typeof f){case"string":l=gr(f);break;case"number":l=gr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var p=Sa(l.s.r),u=[],g=0,h=Array.isArray(e),y=l.s.r,x=0,v={};h&&!e[y]&&(e[y]=[]);var E=d.skipHidden&&e["!cols"]||[],D=d.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(E[x]||{}).hidden)switch(u[x]=oa(x),a=h?e[y][x]:e[u[x]+p],n){case 1:o[x]=x-l.s.c;break;case 2:o[x]=u[x];break;case 3:o[x]=d.header[x-l.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),c=A=mo(a,null,d),g=v[A]||0,!g)v[A]=1;else{do c=A+"_"+g++;while(v[c]);v[A]=g,v[c]=1}o[x]=c}return y=l.s.r+s,r._read=function(){for(;y<=l.e.r;)if(!(D[y-1]||{}).hidden){var B=dC(e,l,y,u,n,o,h,d);if(++y,B.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows)){r.push(B.row);return}}return r.push(null)},r}var _7={to_json:E7,to_html:w7,to_csv:v7,set_readable:y7};const b7=Rf.version,C7=Object.freeze(Object.defineProperty({__proto__:null,CFB:Lt,SSF:pb,parse_xlscfb:cy,parse_zip:sC,read:ul,readFile:z4,readFileSync:z4,set_cptable:TI,set_fs:a3,stream:_7,utils:ui,version:b7,write:bm,writeFile:jh,writeFileAsync:l7,writeFileSync:jh,writeFileXLSX:c7,writeXLSX:py},Symbol.toStringTag,{value:"Module"}));class B7 extends Vc{constructor(){super("CMSDatabase");sr(this,"collateralCards");sr(this,"partners");sr(this,"documents");sr(this,"settings");sr(this,"inspections");sr(this,"documentIndexes");sr(this,"documentChunks");sr(this,"knowledgeTopics");sr(this,"knowledgeCategories");sr(this,"knowledgeSearchIndex");sr(this,"tasks");this.version(2).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id"}).upgrade(async()=>{console.log("Upgrading database to version 2...")}),this.version(3).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt"}).upgrade(async()=>{console.log("Upgrading database to version 3...")}),this.version(4).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page"}).upgrade(async()=>{console.log("Upgrading database to version 4...")}),this.version(5).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page",knowledgeTopics:"id, category",knowledgeCategories:"id",knowledgeSearchIndex:"keyword"}).upgrade(async()=>{console.log("Upgrading database to version 5...")}),this.version(6).stores({collateralCards:"id, mainCategory, status, number, name, createdAt, updatedAt, cbCode",partners:"id, type, role, inn, lastName, organizationName",documents:"id, name, type, category, uploadDate",settings:"id",inspections:"id, inspectionType, status, inspectionDate, collateralCardId, inspectorId, condition, createdAt, updatedAt",documentIndexes:"documentName",documentChunks:"id, documentName, page",knowledgeTopics:"id, category",knowledgeCategories:"id",knowledgeSearchIndex:"keyword",tasks:"id, employeeId, region, status, type, dueDate, createdAt"}).upgrade(async r=>{console.log("Upgrading database to version 6: migrating tasks from localStorage...");try{let a=null;try{a=localStorage.getItem("zadachnik_tasks")}catch{console.warn("Не удалось прочитать задачи из localStorage (возможно, данные слишком большие), пропускаем миграцию");return}if(a)try{const n=JSON.parse(a);if(Array.isArray(n)&&n.length>0){for(let o=0;o<n.length;o+=1e3){const A=n.slice(o,o+1e3);await r.table("tasks").bulkPut(A)}console.log(`✅ Мигрировано ${n.length} задач из localStorage в IndexedDB`);try{localStorage.removeItem("zadachnik_tasks")}catch{console.warn("Не удалось удалить задачи из localStorage (не критично)")}}}catch(n){console.error("Ошибка парсинга задач из localStorage:",n);try{localStorage.removeItem("zadachnik_tasks")}catch{}}}catch(a){console.error("Ошибка миграции задач:",a)}})}}const Yr=new B7;class S7{constructor(){sr(this,"db");this.db=Yr}async initDatabase(){try{await this.db.open(),console.log("Extended database initialized successfully"),await this.db.settings.get("app-settings")||await this.db.settings.add({id:"app-settings",theme:"light",language:"ru",sidebarCollapsed:!1})}catch(t){throw console.error("Failed to initialize database:",t),t}}async saveExtendedCard(t){try{const r=new Date,a={...t,updatedAt:r,createdAt:t.createdAt||r};return await this.db.collateralCards.put(a),a.id}catch(r){throw console.error("Failed to save collateral card:",r),r}}async getExtendedCards(t){try{let r=this.db.collateralCards.toCollection();if(t){if(t.mainCategory&&(r=this.db.collateralCards.where("mainCategory").equals(t.mainCategory)),t.status&&(r=r.filter(a=>a.status===t.status)),t.searchQuery){const a=t.searchQuery.toLowerCase();r=r.filter(n=>{var s,o,A;return n.name.toLowerCase().includes(a)||n.number.toLowerCase().includes(a)||((o=(s=n.address)==null?void 0:s.fullAddress)==null?void 0:o.toLowerCase().includes(a))||((A=n.partners)==null?void 0:A.some(c=>{var l,d,f;return((l=c.lastName)==null?void 0:l.toLowerCase().includes(a))||((d=c.firstName)==null?void 0:d.toLowerCase().includes(a))||((f=c.organizationName)==null?void 0:f.toLowerCase().includes(a))}))||!1})}t.dateFrom&&(r=r.filter(a=>a.createdAt>=t.dateFrom)),t.dateTo&&(r=r.filter(a=>a.createdAt<=t.dateTo)),t.region&&(r=r.filter(a=>{var n,s;return!!((s=(n=a.address)==null?void 0:n.region)!=null&&s.toLowerCase().includes(t.region.toLowerCase()))})),t.objectType&&(r=r.filter(()=>!0)),t.hasDocuments!==void 0&&(r=r.filter(a=>{var n,s;return t.hasDocuments?(((n=a.documents)==null?void 0:n.length)||0)>0:(((s=a.documents)==null?void 0:s.length)||0)===0})),t.areaFrom!==void 0&&(r=r.filter(a=>{var s,o;const n=((s=a.characteristics)==null?void 0:s.totalArea)||((o=a.characteristics)==null?void 0:o.area);return n&&n>=t.areaFrom})),t.areaTo!==void 0&&(r=r.filter(a=>{var s,o;const n=((s=a.characteristics)==null?void 0:s.totalArea)||((o=a.characteristics)==null?void 0:o.area);return n&&n<=t.areaTo}))}return await r.toArray()}catch(r){throw console.error("Failed to get collateral cards:",r),r}}async getExtendedCardById(t){try{return await this.db.collateralCards.get(t)}catch(r){throw console.error("Failed to get collateral card:",r),r}}async deleteExtendedCard(t){try{await this.db.collateralCards.delete(t)}catch(r){throw console.error("Failed to delete collateral card:",r),r}}async deleteExtendedCards(t){try{await this.db.collateralCards.bulkDelete(t)}catch(r){throw console.error("Failed to delete collateral cards:",r),r}}async savePartner(t){try{return await this.db.partners.put(t),t.id}catch(r){throw console.error("Failed to save partner:",r),r}}async getPartners(){try{return await this.db.partners.toArray()}catch(t){throw console.error("Failed to get partners:",t),t}}async searchPartners(t){try{const r=t.toLowerCase();return await this.db.partners.filter(a=>{var n,s,o,A;return!!((n=a.lastName)!=null&&n.toLowerCase().includes(r)||(s=a.firstName)!=null&&s.toLowerCase().includes(r)||(o=a.organizationName)!=null&&o.toLowerCase().includes(r)||(A=a.inn)!=null&&A.includes(t))}).toArray()}catch(r){throw console.error("Failed to search partners:",r),r}}async saveDocument(t){try{return await this.db.documents.put(t),t.id}catch(r){throw console.error("Failed to save document:",r),r}}async getDocuments(){try{return await this.db.documents.toArray()}catch(t){throw console.error("Failed to get documents:",t),t}}async getSettings(){try{return await this.db.settings.get("app-settings")||{theme:"light",language:"ru",sidebarCollapsed:!1}}catch(t){throw console.error("Failed to get settings:",t),t}}async saveSettings(t){try{const r=await this.getSettings();await this.db.settings.put({id:"app-settings",...r,...t})}catch(r){throw console.error("Failed to save settings:",r),r}}async getTasks(){try{return await this.db.tasks.toArray()}catch(t){throw console.error("Failed to get tasks:",t),t}}async saveTasks(t){try{await this.db.tasks.clear();const r=1e3;for(let a=0;a<t.length;a+=r){const n=t.slice(a,a+r);await this.db.tasks.bulkPut(n)}}catch(r){throw console.error("Failed to save tasks:",r),r}}async saveTask(t){try{await this.db.tasks.put(t)}catch(r){throw console.error("Failed to save task:",r),r}}async deleteTask(t){try{await this.db.tasks.delete(t)}catch(r){throw console.error("Failed to delete task:",r),r}}async getTasksByEmployeeId(t){try{return await this.db.tasks.where("employeeId").equals(t).toArray()}catch(r){throw console.error("Failed to get tasks by employeeId:",r),r}}async getTasksByRegion(t){try{return await this.db.tasks.where("region").equals(t).toArray()}catch(r){throw console.error("Failed to get tasks by region:",r),r}}async exportToExcel(t,r){try{const a=t.map(A=>{var c,l,d,f,p;return{ID:A.id,Номер:A.number,Название:A.name,Категория:this.translateCategory(A.mainCategory),"Вид объекта":A.classification.level1,Тип:A.classification.level2,"Код ЦБ":A.cbCode,Статус:A.status==="editing"?"Редактирование":"Утвержден",Адрес:((c=A.address)==null?void 0:c.fullAddress)||"",Собственники:((l=A.partners)==null?void 0:l.filter(u=>u.role==="owner").map(u=>this.getPartnerName(u)).join(", "))||"",Площадь:((d=A.characteristics)==null?void 0:d.totalArea)||((f=A.characteristics)==null?void 0:f.area)||"",Документов:((p=A.documents)==null?void 0:p.length)||0,"Дата создания":new Date(A.createdAt).toLocaleString("ru-RU"),"Дата обновления":new Date(A.updatedAt).toLocaleString("ru-RU")}}),n=ui.json_to_sheet(a),s=ui.book_new();ui.book_append_sheet(s,n,"Карточки");const o=30;return n["!cols"]=Object.keys(a[0]||{}).map(()=>({wch:o})),jh(s,`${r}.xlsx`),{success:!0,message:`Экспортировано ${t.length} записей`,filename:`${r}.xlsx`}}catch(a){return console.error("Failed to export to Excel:",a),{success:!1,message:"Ошибка при экспорте данных"}}}async exportBackup(){try{const t=await this.db.collateralCards.toArray(),r=await this.db.partners.toArray(),a=await this.db.documents.toArray(),n=await this.getSettings(),s={version:2,timestamp:new Date().toISOString(),data:{cards:t,partners:r,documents:a,settings:n}};return new Blob([JSON.stringify(s,null,2)],{type:"application/json"})}catch(t){throw console.error("Failed to export backup:",t),t}}async importBackup(t){try{const r=await t.text(),a=JSON.parse(r);if(!a.version||!a.data)throw new Error("Некорректный формат файла резервной копии");if(await this.db.collateralCards.clear(),await this.db.partners.clear(),await this.db.documents.clear(),a.data.cards&&Array.isArray(a.data.cards))for(const n of a.data.cards)n.createdAt=new Date(n.createdAt),n.updatedAt=new Date(n.updatedAt),await this.saveExtendedCard(n);if(a.data.partners&&Array.isArray(a.data.partners))for(const n of a.data.partners)await this.savePartner(n);if(a.data.documents&&Array.isArray(a.data.documents))for(const n of a.data.documents)await this.saveDocument(n);a.data.settings&&await this.saveSettings(a.data.settings),console.log("Backup imported successfully")}catch(r){throw console.error("Failed to import backup:",r),r}}translateCategory(t){return{real_estate:"Недвижимость",movable:"Движимое имущество",property_rights:"Имущественные права"}[t]||t}getPartnerName(t){return t.type==="individual"?[t.lastName,t.firstName,t.middleName].filter(Boolean).join(" "):t.organizationName||""}async getStatistics(){try{const t=await this.db.collateralCards.toArray();return{total:t.length,byCategory:{real_estate:t.filter(r=>r.mainCategory==="real_estate").length,movable:t.filter(r=>r.mainCategory==="movable").length,property_rights:t.filter(r=>r.mainCategory==="property_rights").length},byStatus:{editing:t.filter(r=>r.status==="editing").length,approved:t.filter(r=>r.status==="approved").length},withDocuments:t.filter(r=>{var a;return(((a=r.documents)==null?void 0:a.length)||0)>0}).length,withPartners:t.filter(r=>{var a;return(((a=r.partners)==null?void 0:a.length)||0)>0}).length}}catch(t){throw console.error("Failed to get statistics:",t),t}}}const Yt=new S7,T7=Object.freeze(Object.defineProperty({__proto__:null,default:Yt,extendedDb:Yr,extendedStorageService:Yt},Symbol.toStringTag,{value:"Module"})),Wi=[{code:"ЦО",name:"Центральный округ",cities:["Москва","Московская область","Ярославль","Воронеж","Тула","Калуга","Рязань","Тверь"]},{code:"СЗРЦ",name:"Северозападный Региональный центр",cities:["Санкт-Петербург","Ленинградская область","Мурманск","Архангельск","Псков","Великий Новгород"]},{code:"ЮРЦ",name:"Южный региональный центр",cities:["Краснодар","Ростов-на-Дону","Майкоп","Ставрополь","Анапа","Волгоград","Сочи","Новороссийск","Таганрог"]},{code:"СРЦ",name:"Сибирский региональный центр",cities:["Новосибирск","Омск","Красноярск","Иркутск","Барнаул","Томск"]},{code:"ЕКЦ",name:"Уральский региональный центр",cities:["Екатеринбург","Челябинск","Пермь","Уфа","Тюмень","Курган"]},{code:"ДВЦ",name:"Дальневосточный центр",cities:["Владивосток","Хабаровск","Южно-Сахалинск","Благовещенск","Петропавловск-Камчатский"]},{code:"ПРЦ",name:"Приволжский региональный центр",cities:["Казань","Нижний Новгород","Самара","Саратов","Ульяновск","Пенза"]},{code:"СЗРЦ2",name:"Северо-Кавказский региональный центр",cities:["Махачкала","Грозный","Нальчик","Владикавказ","Элиста"]}],yy=e=>Wi.find(t=>t.cities.some(r=>r.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(r.toLowerCase())))||null,$4="cms_employees";class O7{getEmployees(){try{const t=localStorage.getItem($4);if(!t)return this.getDefaultEmployees();const r=JSON.parse(t);return!Array.isArray(r)||r.length<100?(console.warn("Обнаружено недостаточное количество сотрудников, пересоздаем базу..."),this.getDefaultEmployees()):r}catch(t){return console.error("Ошибка загрузки сотрудников:",t),this.getDefaultEmployees()}}regenerateEmployees(){return console.log("Принудительная регенерация базы сотрудников..."),this.getDefaultEmployees()}saveEmployees(t){try{localStorage.setItem($4,JSON.stringify(t))}catch(r){console.error("Ошибка сохранения сотрудников:",r)}}getEmployeeById(t){return this.getEmployees().find(a=>a.id===t)}addEmployee(t){const r=this.getEmployees(),a={...t,id:`emp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveEmployees(r),a}updateEmployee(t,r){const a=this.getEmployees(),n=a.findIndex(s=>s.id===t);return n===-1?null:(a[n]={...a[n],...r,updatedAt:new Date().toISOString()},this.saveEmployees(a),a[n])}deleteEmployee(t){const r=this.getEmployees(),a=r.filter(n=>n.id!==t);return a.length===r.length?!1:(this.saveEmployees(a),!0)}getEmployeesByRegion(t){return this.getEmployees().filter(a=>a.region===t&&a.isActive)}getRegions(){const t=this.getEmployees(),r=new Set(t.map(a=>a.region));return Array.from(r).sort()}getMonitoringEmployees(){return this.getEmployees().filter(r=>r.isActive&&r.canMonitor===!0)}getAppraisalEmployees(){return this.getEmployees().filter(r=>r.isActive&&r.canAppraise===!0)}getMonitoringEmployeesByRegion(t){return this.getMonitoringEmployees().filter(r=>r.region===t)}getAppraisalEmployeesByRegion(t){return this.getAppraisalEmployees().filter(r=>r.region===t)}updateWorkload(t,r,a){const n=this.getEmployees(),s=n.findIndex(o=>o.id===t);s!==-1&&(r!==void 0&&(n[s].monitoringWorkload=r),a!==void 0&&(n[s].appraisalWorkload=a),this.saveEmployees(n))}getDefaultEmployees(){const t=[],r=["Иванов","Петров","Сидоров","Смирнов","Кузнецов","Попов","Соколов","Лебедев","Козлов","Новиков","Морозов","Волков","Соловьев","Васильев","Зайцев","Павлов","Семенов","Голубев","Виноградов","Богданов","Воробьев","Федоров","Михайлов","Белов","Тарасов","Беляев","Комаров","Орлов","Киселев","Макаров","Андреев","Ковалев","Ильин","Гусев","Титов","Кузьмин","Кудрявцев","Баранов","Куликов","Алексеев"],a=["Иван","Петр","Сергей","Александр","Дмитрий","Андрей","Михаил","Николай","Владимир","Алексей","Мария","Елена","Анна","Ольга","Татьяна","Наталья","Ирина","Светлана","Екатерина","Юлия","Анастасия","Дарья","Виктория","Евгения","Кристина","Ангелина","Валентина","Галина","Людмила","Надежда"],n=["Иванович","Петрович","Сергеевич","Александрович","Дмитриевич","Андреевич","Михайлович","Николаевич","Владимирович","Алексеевич","Ивановна","Петровна","Сергеевна","Александровна","Дмитриевна","Андреевна","Михайловна","Николаевна","Владимировна","Алексеевна"],s=["Менеджер по работе с залогами","Специалист по мониторингу","Специалист по оценке","Руководитель отдела","Ведущий специалист","Главный специалист","Эксперт","Аналитик"],o=["Отдел залогового обеспечения","Отдел мониторинга","Отдел оценки","Отдел рисков","Отдел кредитования"];let A=1;const c={ЦО:{monitoring:2,appraisal:7},СЗРЦ:{monitoring:6,appraisal:9},ЮРЦ:{monitoring:7,appraisal:10},СРЦ:{monitoring:10,appraisal:4},ЕКЦ:{monitoring:5,appraisal:12},ДВЦ:{monitoring:8,appraisal:9},ПРЦ:{monitoring:6,appraisal:6},СЗРЦ2:{monitoring:4,appraisal:6}};return Wi.forEach((l,d)=>{const p=Array.from({length:30},(x,v)=>v);for(let x=p.length-1;x>0;x--){const v=Math.floor(Math.random()*(x+1));[p[x],p[v]]=[p[v],p[x]]}const u=c[l.code]||{monitoring:5,appraisal:10},g=new Set(p.slice(0,u.monitoring)),h=new Set(p.slice(u.monitoring,u.monitoring+u.appraisal));let y=0;l.cities.forEach((x,v)=>{const E=Math.floor(30/l.cities.length),D=30%l.cities.length,B=E+(v<D?1:0);for(let I=0;I<B;I++){const _=y,S=_===0,O=(A-1)%r.length,M=r[O],T=a[(A-1)%a.length],R=n[(A-1)%n.length],L=g.has(_),N=h.has(_);let P=L?1:N?2:0,U=L?1:N?2:0;S&&(P=3,U=0);const V=s[P],ie=o[U],z=`${`${M.toLowerCase()}.${T.toLowerCase()}`}${A}@bank.ru`,b=`+7 (${495+d*10+v}) ${String(100+A%900).padStart(3,"0")}-${String(10+A%90).padStart(2,"0")}-${String(10+A%90).padStart(2,"0")}`,k=1970+A%30,j=A%12+1,q=A%28+1,Y=`${k}-${String(j).padStart(2,"0")}-${String(q).padStart(2,"0")}`,de=String(1e5+A).padStart(6,"0"),ue=Math.random(),pe=ue<.85?"working":ue<.9?"sick_leave":ue<.95?"vacation":"business_trip";t.push({id:`emp-${A}`,lastName:M,firstName:T,middleName:R,position:V,region:x,email:z,phone:b,department:ie,permissions:S?["registry_view","registry_edit","portfolio_view","portfolio_edit","tasks_view","tasks_edit","reports_view","reports_export","settings_view"]:["registry_view","portfolio_view","tasks_view"],isActive:!0,canMonitor:L,canAppraise:N,monitoringWorkload:0,appraisalWorkload:0,isManager:S,birthDate:Y,employeeNumber:de,status:pe,hireDate:`202${Math.floor(A/100)}-${String(A%12+1).padStart(2,"0")}-${String(A%28+1).padStart(2,"0")}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),A++,y++}})}),this.saveEmployees(t),t}}const fr=new O7,I7={token:{colorBgBase:"#1a1a1a",colorBgContainer:"#2d2d2d",colorTextBase:"#e6e6e6",colorPrimary:"#1890ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1890ff",borderRadius:6,boxShadow:"0 3px 6px -4px rgba(0, 0, 0, 0.48), 0 6px 16px 0 rgba(0, 0, 0, 0.32), 0 9px 28px 8px rgba(0, 0, 0, 0.2)"},components:{Layout:{bodyBg:"#1a1a1a",headerBg:"#2d2d2d",siderBg:"#262626"},Table:{headerBg:"#3a3a3a",rowHoverBg:"rgba(255, 255, 255, 0.06)"},Menu:{itemSelectedBg:"rgba(24, 144, 255, 0.15)"},Card:{colorBgContainer:"#2d2d2d"},Button:{colorPrimary:"#1890ff"}}},N7={token:{colorBgBase:"#ece9d8",colorBgContainer:"#ffffff",colorTextBase:"#000000",colorPrimary:"#0054e3",colorSuccess:"#00a651",colorWarning:"#ff8c00",colorError:"#d13438",colorInfo:"#0078d4",borderRadius:3,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"},components:{Button:{colorPrimary:"#0054e3"},Layout:{bodyBg:"#ece9d8",headerBg:"#0054e3"},Card:{colorBgContainer:"#ffffff"}}},F7={token:{colorBgBase:"#000000",colorBgContainer:"#0a0a0a",colorTextBase:"#ffffff",colorPrimary:"#ffffff",colorSuccess:"#ffffff",colorWarning:"#ffffff",colorError:"#ffffff",colorInfo:"#ffffff",colorTextLightSolid:"#000000",borderRadius:4,boxShadow:"0 2px 8px rgba(255, 255, 255, 0.1)"},components:{Layout:{bodyBg:"#000000",headerBg:"#0a0a0a",siderBg:"#050505"},Menu:{darkItemBg:"#050505",darkSubMenuItemBg:"#0a0a0a",darkItemSelectedBg:"#1a1a1a",darkItemColor:"#ffffff",darkItemHoverBg:"#151515"},Button:{colorPrimary:"#ffffff",colorPrimaryHover:"#e0e0e0"},Card:{colorBgContainer:"#0a0a0a"},Table:{headerBg:"#0a0a0a"},Modal:{contentBg:"#0a0a0a"},Drawer:{colorBgElevated:"#0a0a0a"},Input:{colorBgContainer:"#050505",colorBorder:"#ffffff",colorText:"#ffffff"},Select:{colorBgContainer:"#050505",colorBorder:"#ffffff",colorText:"#ffffff"},Switch:{colorPrimary:"#ffffff"},Tag:{colorBgContainer:"#1a1a1a",colorText:"#ffffff"}}},R7={token:{colorBgBase:"#000000",colorBgContainer:"#001100",colorTextBase:"#00ff00",colorPrimary:"#00ff00",colorSuccess:"#00ff00",colorWarning:"#ffff00",colorError:"#ff0000",colorInfo:"#00ffff",borderRadius:0,boxShadow:"0 0 10px rgba(0, 255, 0, 0.3), inset 0 0 10px rgba(0, 255, 0, 0.1)"},components:{Layout:{bodyBg:"#000000",headerBg:"#001100",siderBg:"#000800"},Menu:{darkItemBg:"#000800",darkSubMenuItemBg:"#001100",darkItemSelectedBg:"#002200",darkItemColor:"#00ff00",darkItemHoverBg:"#001a00"},Button:{colorPrimary:"#00ff00",colorPrimaryHover:"#00cc00"},Card:{colorBgContainer:"#001100"},Table:{headerBg:"#001100"},Modal:{contentBg:"#001100"},Drawer:{colorBgElevated:"#001100"},Input:{colorBgContainer:"#000800",colorBorder:"#00ff00",colorText:"#00ff00"},Select:{colorBgContainer:"#000800",colorBorder:"#00ff00",colorText:"#00ff00"},Switch:{colorPrimary:"#00ff00"}}},k7={token:{colorBgBase:"#f2f2f7",colorBgContainer:"#ffffff",colorTextBase:"#000000",colorPrimary:"#007aff",colorSuccess:"#34c759",colorWarning:"#ff9500",colorError:"#ff3b30",colorInfo:"#5ac8fa",borderRadius:12,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.08)",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", sans-serif'},components:{Layout:{bodyBg:"#f2f2f7",headerBg:"#ffffff",siderBg:"#f8f8f8"},Menu:{itemBg:"transparent",itemSelectedBg:"#007aff",itemHoverBg:"rgba(0, 122, 255, 0.1)",itemColor:"#000000",itemSelectedColor:"#ffffff",darkItemBg:"transparent",darkItemColor:"#000000",darkItemSelectedBg:"#007aff",darkItemSelectedColor:"#ffffff",darkItemHoverBg:"rgba(0, 122, 255, 0.1)"},Button:{colorPrimary:"#007aff",colorPrimaryHover:"#0051d5",borderRadius:12,controlHeight:44},Card:{colorBgContainer:"#ffffff",borderRadiusLG:16},Table:{headerBg:"#f9f9f9",borderRadiusLG:12},Modal:{contentBg:"#ffffff",borderRadiusLG:16},Drawer:{colorBgElevated:"#f2f2f7"},Input:{colorBgContainer:"#ffffff",colorBorder:"#d1d1d6",colorText:"#000000",borderRadius:10,controlHeight:44},Select:{colorBgContainer:"#ffffff",colorBorder:"#d1d1d6",colorText:"#000000",borderRadius:10,controlHeight:44},Switch:{colorPrimary:"#34c759"},Tag:{colorBgContainer:"#e5e5ea",colorText:"#000000",borderRadiusLG:8}}},D7={token:{colorBgBase:"#c0c0c0",colorBgContainer:"#c0c0c0",colorTextBase:"#000000",colorPrimary:"#000080",colorSuccess:"#008000",colorWarning:"#808000",colorError:"#800000",colorInfo:"#000080",borderRadius:0,boxShadow:"inset -1px -1px 0px #000000, inset 1px 1px 0px #ffffff, inset -2px -2px 0px #808080, inset 2px 2px 0px #dfdfdf"},components:{Layout:{bodyBg:"#008080",headerBg:"#000080",siderBg:"#c0c0c0"},Menu:{darkItemBg:"#c0c0c0",darkSubMenuItemBg:"#c0c0c0",darkItemSelectedBg:"#000080",darkItemColor:"#000000",darkItemHoverBg:"#0000a0"},Button:{colorPrimary:"#000080",colorPrimaryHover:"#0000a0",borderRadius:0},Card:{colorBgContainer:"#c0c0c0",borderRadiusLG:0},Table:{headerBg:"#000080",borderRadiusLG:0},Modal:{contentBg:"#c0c0c0",borderRadiusLG:0},Drawer:{colorBgElevated:"#c0c0c0"},Input:{colorBgContainer:"#ffffff",colorBorder:"#808080",colorText:"#000000",borderRadius:0},Select:{colorBgContainer:"#ffffff",colorBorder:"#808080",colorText:"#000000",borderRadius:0},Switch:{colorPrimary:"#000080"},Tag:{colorBgContainer:"#c0c0c0",colorText:"#000000",borderRadiusLG:0}}},mC=K.createContext(void 0),j7=({children:e})=>{const[t,r]=K.useState(()=>localStorage.getItem("cms-theme")||"dark-gray");K.useEffect(()=>{localStorage.setItem("cms-theme",t),document.documentElement.classList.add("theme-transitioning"),requestAnimationFrame(()=>{document.documentElement.setAttribute("data-theme",t),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},500)})},[t]);const a=()=>{switch(t){case"dark-gray":return{...I7,algorithm:UA.darkAlgorithm};case"windows-xp":return N7;case"windows-97":return D7;case"ios":return k7;case"matrix":return{...R7,algorithm:UA.darkAlgorithm};case"dark":return{...F7,algorithm:UA.darkAlgorithm};case"light":default:return{algorithm:UA.defaultAlgorithm}}};return i.jsx(mC.Provider,{value:{currentTheme:t,setTheme:r},children:i.jsx(JE,{theme:a(),children:e})})},Ug=()=>`demo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Rc=(e,t)=>new Date(e.getTime()+Math.random()*(t.getTime()-e.getTime())),Mg=e=>{const t=["Ленина","Пушкина","Гагарина","Мира","Советская","Кирова","Первомайская"],r=t[Math.floor(Math.random()*t.length)],a=Math.floor(Math.random()*200)+1,n=Math.floor(Math.random()*100)+1;return{fullAddress:`г. ${e}, ул. ${r}, д. ${a}, кв. ${n}`,postalCode:`${1e5+Math.floor(Math.random()*99999)}`,region:e,city:e,street:`ул. ${r}`,house:a.toString(),apartment:n.toString(),coordinates:{lat:55.7558+(Math.random()-.5)*.1,lon:37.6173+(Math.random()-.5)*.1}}},L7=[{level0:"Коммерческая недвижимость",level1:"Офис",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Торговое помещение",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Склад",level2:"Помещение"},{level0:"Коммерческая недвижимость",level1:"Производственное помещение",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Квартира",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Комната",level2:"Помещение"},{level0:"Жилая недвижимость",level1:"Дом",level2:"Здание"},{level0:"Жилая недвижимость",level1:"Дача",level2:"Здание"},{level0:"Промышленная недвижимость",level1:"Цех",level2:"Помещение"},{level0:"Промышленная недвижимость",level1:"Ангар",level2:"Сооружение"},{level0:"Коммерческая недвижимость",level1:"Парковочное место",level2:"Помещение"}],U7=[{level0:"Транспорт",level1:"Легковой автомобиль",level2:"Транспортное средство"},{level0:"Транспорт",level1:"Грузовой автомобиль",level2:"Транспортное средство"},{level0:"Транспорт",level1:"Спецтехника",level2:"Транспортное средство"},{level0:"Оборудование",level1:"Производственное оборудование",level2:"Станок"},{level0:"Оборудование",level1:"Офисное оборудование",level2:"Техника"},{level0:"Оборудование",level1:"Компьютерная техника",level2:"Техника"}],M7=[{level0:"Ценные бумаги",level1:"Акции",level2:"Долевые"},{level0:"Ценные бумаги",level1:"Облигации",level2:"Долговые"},{level0:"Права требования",level1:"Дебиторская задолженность",level2:"Требование"},{level0:"Интеллектуальная собственность",level1:"Патент",level2:"Право"},{level0:"Интеллектуальная собственность",level1:"Товарный знак",level2:"Право"}],P7=e=>{const r={area:(Math.floor(Math.random()*500)+20).toString(),floor:Math.floor(Math.random()*20)+1,totalFloors:Math.floor(Math.random()*25)+1,roomsCount:Math.floor(Math.random()*5)+1,cadastralNumber:`77:${Math.floor(Math.random()*99)}:${Math.floor(Math.random()*999999)}:${Math.floor(Math.random()*9999)}`,buildYear:Math.floor(Math.random()*50)+1970};return(e==="Квартира"||e==="Комната")&&(r.hasBalcony=Math.random()>.5,r.renovation=["Без ремонта","Косметический","Евроремонт","Дизайнерский"][Math.floor(Math.random()*4)]),(e==="Дом"||e==="Дача")&&(r.landArea=Math.floor(Math.random()*1e3)+100,r.hasGarage=Math.random()>.5),r},Q7=()=>{const e=["Toyota","Mercedes-Benz","BMW","Volkswagen","Ford","Hyundai","KIA"];return{brand:e[Math.floor(Math.random()*e.length)],model:`Model-${Math.floor(Math.random()*100)}`,year:Math.floor(Math.random()*10)+2014,vin:`VIN${Math.random().toString(36).substr(2,14).toUpperCase()}`,mileage:Math.floor(Math.random()*2e5)+1e4,color:["Черный","Белый","Серебристый","Синий","Красный"][Math.floor(Math.random()*5)],engineVolume:(Math.random()*3+1).toFixed(1),fuelType:["Бензин","Дизель","Электро","Гибрид"][Math.floor(Math.random()*4)]}},q7=()=>({manufacturer:["Siemens","ABB","Schneider","GE","Mitsubishi"][Math.floor(Math.random()*5)],model:`EQ-${Math.floor(Math.random()*1e4)}`,serialNumber:`SN${Math.random().toString(36).substr(2,10).toUpperCase()}`,productionYear:Math.floor(Math.random()*15)+2009,condition:["Новое","Хорошее","Удовлетворительное","Требует ремонта"][Math.floor(Math.random()*4)],power:`${Math.floor(Math.random()*100)+10} кВт`}),Pg=(e,t)=>{let r=1e6;return e==="real_estate"?r=Math.floor(Math.random()*5e7)+5e6:e==="movable"?t.includes("автомобиль")?r=Math.floor(Math.random()*5e6)+5e5:r=Math.floor(Math.random()*2e6)+1e5:r=Math.floor(Math.random()*1e7)+1e6,{marketValue:r,pledgeValue:Math.floor(r*(.6+Math.random()*.3)),evaluationDate:Rc(new Date(2023,0,1),new Date).toISOString().split("T")[0]}},K7=()=>{const e=[],t=["Москва","Санкт-Петербург","Новосибирск","Екатеринбург"],r=["editing","approved"];let a=1;return L7.forEach((n,s)=>{const o=t[s%t.length],A=r[s%r.length],c=Rc(new Date(2023,0,1),new Date);e.push({id:Ug(),number:`RE-${a.toString().padStart(4,"0")}`,name:`${n.level1} в ${o}`,mainCategory:"real_estate",classification:n,cbCode:100+s,status:A,address:Mg(o),characteristics:P7(n.level1),...Pg("real_estate",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Компания ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[{id:"1",name:"Свидетельство о собственности",type:"ownership",uploadDate:c.toISOString().split("T")[0]},{id:"2",name:"Кадастровый паспорт",type:"cadastral",uploadDate:c.toISOString().split("T")[0]}],photos:[],notes:"Демо-карточка недвижимости для тестирования системы"}),a++}),U7.forEach((n,s)=>{const o=t[s%t.length],A=r[s%r.length],c=Rc(new Date(2023,0,1),new Date);let l,d;n.level0==="Транспорт"?(l=Q7(),d=`${n.level1} - ${l.brand}`):(l=q7(),d=`${n.level1} - ${l.manufacturer}`),e.push({id:Ug(),number:`MV-${a.toString().padStart(4,"0")}`,name:d,mainCategory:"movable",classification:n,cbCode:200+s,status:A,address:Mg(o),characteristics:l,...Pg("movable",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Транспорт ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[{id:"1",name:"ПТС",type:"pts",uploadDate:c.toISOString().split("T")[0]}],photos:[],notes:"Демо-карточка движимого имущества для тестирования системы"}),a++}),M7.forEach((n,s)=>{const o=t[s%t.length],A=r[s%r.length],c=Rc(new Date(2023,0,1),new Date);e.push({id:Ug(),number:`PR-${a.toString().padStart(4,"0")}`,name:`${n.level1} - ${o}`,mainCategory:"property_rights",classification:n,cbCode:300+s,status:A,address:Mg(o),characteristics:{nominalValue:Math.floor(Math.random()*1e7)+1e5,quantity:Math.floor(Math.random()*1e3)+1,issuer:`ПАО "Эмитент ${s+1}"`},...Pg("property_rights",n.level1),createdAt:c,updatedAt:Rc(c,new Date),owner:{name:`ООО "Инвестор ${a}"`,inn:`${77e8+a}`,type:"legal"},documents:[],photos:[],notes:"Демо-карточка имущественных прав для тестирования системы"}),a++}),e},gC=K.createContext(void 0),H7=({children:e})=>{const t=Hd(),[r,a]=K.useState(!1),n=async()=>{try{a(!0);const o=K7();Ne.loading({content:"Загрузка демо-данных...",key:"demo"});for(const A of o)await Yt.saveExtendedCard(A);t(P1(o)),Ne.success({content:`Загружено ${o.length} демо-карточек`,key:"demo",duration:3})}catch(o){Ne.error({content:"Ошибка загрузки демо-данных",key:"demo"}),console.error(o)}finally{a(!1)}},s=async()=>{try{a(!0),Ne.loading({content:"Удаление демо-данных...",key:"clear"});const o=await Yt.getExtendedCards();for(const A of o)await Yt.deleteExtendedCard(A.id);t(P1([])),Ne.success({content:"Все демо-данные удалены",key:"clear",duration:3})}catch(o){Ne.error({content:"Ошибка удаления демо-данных",key:"clear"}),console.error(o)}finally{a(!1)}};return i.jsx(gC.Provider,{value:{loadDemoData:n,clearDemoData:s,isLoading:r},children:e})},G7=()=>{const e=K.useContext(mC);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},{Sider:z7}=_f,V7=({collapsed:e,onLoadDemoData:t,onClearDemoData:r,hasCards:a=!1})=>{const n=$s(),s=uc(),{currentTheme:o,setTheme:A}=G7(),c=[{key:"registry",label:"Реестр объектов",icon:i.jsx(JA,{}),path:"/registry"},{key:"portfolio",label:"Залоговый портфель",icon:i.jsx(ZE,{}),path:"/portfolio"},{key:"tasks",label:"Задачи",icon:i.jsx(eA,{}),path:"/tasks"},{key:"kpi",label:"KPI",icon:i.jsx(hT,{}),path:"/kpi",tooltip:"KPI и аналитика"},{key:"reports",label:"Отчеты",icon:i.jsx(Kc,{}),path:"/reports",tooltip:"Агрегирование отчетности"},{key:"collateral-dossier",label:"Залоговое досье",icon:i.jsx(L1,{}),path:"/collateral-dossier"},{key:"collateral-conclusions",label:"Залоговые заключения",icon:i.jsx(Qr,{}),path:"/collateral-conclusions"},{key:"insurance",label:"Страхование",icon:i.jsx(mT,{}),path:"/insurance"},{key:"fnp",label:"ФНП",icon:i.jsx(e_,{}),path:"/fnp",tooltip:"Регистрация залога движимого имущества ФНП"},{key:"analytics",label:"Аналитика",icon:i.jsx(rl,{}),path:"/analytics"},{key:"credit-risk",label:"Модуль мониторинга",icon:i.jsx(gT,{}),path:"/credit-risk",tooltip:"Модуль мониторинга"},{key:"appraisal",label:"Модуль оценки",icon:i.jsx(Jf,{}),path:"/appraisal",tooltip:"Автоматическая оценка объектов залога"},{key:"cms-check",label:"CMS Check",icon:i.jsx(Ko,{}),path:"/cms-check",tooltip:"Система дистанционных осмотров"},{key:"egrn",label:"ЕГРН",icon:i.jsx(Qr,{}),path:"/egrn",tooltip:"Регистрация ипотеки, снятие обременений, выписки ЕГРН"},{key:"upload",label:"Загрузка",icon:i.jsx(xT,{}),path:"/upload"},{key:"monitoring",label:"Мониторинг",icon:i.jsx(yT,{}),path:"/monitoring"},{key:"reference",label:"Справочная с ИИ",icon:i.jsx(bf,{}),path:"/reference",tooltip:"Консультации по нормативным документам, оценке и рабочим вопросам"},{key:"settings",label:"Настройки",icon:i.jsx(Hc,{}),path:"/settings"}],l=p=>{const u=c.find(g=>g.key===p);u&&(u.external&&u.path?window.open(u.path,"_blank","noopener,noreferrer"):u.path&&n(u.path))},d=c.map(p=>({key:p.key,icon:p.icon,label:p.tooltip?i.jsx(Xr,{title:p.tooltip,placement:"right",children:i.jsx("span",{children:p.label})}):p.label})),f=()=>{const p=s.pathname.split("/").filter(Boolean);return p.length===0?"registry":p[0]};return i.jsxs(z7,{collapsible:!0,collapsed:e,trigger:null,width:250,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[i.jsxs("div",{className:"sidebar-logo",onClick:()=>n("/"),style:{height:"64px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:e?"16px":"20px",fontWeight:"bold",transition:"all 0.2s",gap:"8px",padding:e?"8px":"12px",cursor:"pointer"},children:[i.jsx("img",{src:"/logo.png",alt:"CMS Logo",style:{height:e?"32px":"40px",width:"auto",objectFit:"contain",transition:"all 0.2s"}}),!e&&i.jsx("span",{style:{marginLeft:"8px"},children:"CMS"})]}),i.jsx(pT,{theme:"dark",mode:"inline",selectedKeys:[f()],items:d,onClick:({key:p})=>l(p),style:{flex:1,borderRight:0}}),!e&&i.jsx("div",{style:{padding:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"small",children:[i.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"14px"},children:"Настройки"}),i.jsxs("div",{style:{color:"#fff",fontSize:"12px"},children:["Тема:",i.jsx(Ye,{value:o,onChange:A,size:"small",style:{width:"100%",marginTop:"4px"},options:[{value:"light",label:"Светлая"},{value:"dark",label:"Темная"},{value:"dark-gray",label:"Темно-серая"},{value:"ios",label:"iOS"},{value:"windows-xp",label:"Windows XP"},{value:"windows-97",label:"Windows 97"},{value:"matrix",label:"Матрица"}]})]}),t&&i.jsx("div",{style:{marginTop:"8px"},children:i.jsx(Xr,{title:a?"Перезагрузить демо-данные (44)":"Загрузить демо-данные (44)",children:i.jsx(Be,{icon:i.jsx(JA,{}),onClick:t,type:a?"dashed":"primary",danger:a,size:"small",style:{width:"100%"}})})}),r&&a&&i.jsx("div",{style:{marginTop:"8px"},children:i.jsx(Xr,{title:"Удалить все демо-данные",children:i.jsx(Be,{icon:i.jsx(Bs,{}),onClick:r,type:"dashed",danger:!0,size:"small",style:{width:"100%"}})})}),i.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[i.jsx("div",{style:{color:"#fff",fontSize:"12px",marginBottom:"8px",opacity:.7},children:"Техническая поддержка:"}),i.jsx("a",{href:"mailto:cmsauto@bk.ru",style:{color:"#1890ff",fontSize:"12px",textDecoration:"none",display:"block",wordBreak:"break-all"},onMouseEnter:p=>p.currentTarget.style.textDecoration="underline",onMouseLeave:p=>p.currentTarget.style.textDecoration="none",children:"cmsauto@bk.ru"})]})]})})]})},{Header:$7}=_f,Y7=e=>{switch(e){case"owner":return"залогодателю (название, ИНН)";case"identifier":return"идентификатору (кадастровый номер, VIN, серийный номер, ID)";case"name":return"наименованию";case"type":return"типу объекта";case"kind":return"виду объекта";default:return"наименованию"}},W7=({onCreateCard:e,onExport:t,onImport:r,onSearch:a,onSearchAttributeChange:n,onToggleHeader:s,searchText:o="",searchAttribute:A="name",headerVisible:c=!0})=>{const l=Hd(),{sidebarCollapsed:d}=Cf(u=>u.app),f=()=>{l(EO())},p=[{key:"profile",icon:i.jsx(es,{}),label:"Профиль"},{type:"divider"},{key:"logout",icon:i.jsx(bT,{}),label:"Выход",danger:!0}];return i.jsxs($7,{style:{position:"fixed",top:0,left:d?"80px":"250px",right:0,zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"left 0.2s"},children:[i.jsxs(Fe,{size:"middle",children:[i.jsx(Be,{type:"text",icon:d?i.jsx(t_,{}):i.jsx(r_,{}),onClick:f,style:{fontSize:"16px",width:40,height:40}}),i.jsx(Be,{type:"text",icon:c?i.jsx(vT,{}):i.jsx(a_,{}),onClick:s,style:{fontSize:"16px",width:40,height:40},title:c?"Скрыть шапку":"Показать шапку"}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:e,children:"Создать карточку"}),i.jsx(Be,{icon:i.jsx(wT,{}),onClick:t,children:"Экспорт в Excel"}),i.jsx(Be,{icon:i.jsx(ET,{}),onClick:r,children:"Импорт"})]}),i.jsxs(Fe,{size:"middle",children:[i.jsx(Ye,{value:A,onChange:n,style:{width:150},options:[{value:"owner",label:"Залогодатель"},{value:"identifier",label:"Идентификатор"},{value:"name",label:"Наименование"},{value:"type",label:"Тип"},{value:"kind",label:"Вид"}]}),i.jsx(Re,{placeholder:`Поиск по ${Y7(A)}...`,prefix:i.jsx(Pa,{}),value:o,onChange:u=>a==null?void 0:a(u.target.value),style:{width:300},allowClear:!0}),i.jsx(_T,{menu:{items:p},placement:"bottomRight",children:i.jsx(tm,{icon:i.jsx(es,{}),style:{cursor:"pointer",backgroundColor:"#1890ff"}})})]})]})},X7=()=>{const e=K.useContext(gC);if(!e)throw new Error("useDemoData must be used within DemoDataProvider");return e},{Content:J7}=_f,Z7=()=>{const e=uc(),t=Cf(E=>E.app.sidebarCollapsed),r=Cf(E=>{var D;return((D=E.extendedCards)==null?void 0:D.filteredItems)||[]}),{loadDemoData:a,clearDemoData:n}=X7(),[s,o]=K.useState(""),[A,c]=K.useState("name"),[l,d]=K.useState(!0),f=["/reference","/monitoring","/settings","/upload","/egrn","/cms-check","/appraisal","/credit-risk","/analytics","/fnp","/insurance","/collateral-conclusions","/collateral-dossier","/reports","/kpi","/tasks","/portfolio"],p=e.pathname||e.hash.replace("#",""),u=f.some(E=>p===E||p===`#${E}`||e.hash===`#${E}`),g=l&&!u,h=()=>{},y=()=>{},x=()=>{},v=()=>{d(!l)};return i.jsxs(_f,{className:"main-layout",children:[i.jsx(V7,{collapsed:t,onLoadDemoData:a,onClearDemoData:n,hasCards:r.length>0}),i.jsxs(_f,{style:{marginLeft:t?80:250,transition:"margin-left 0.2s"},children:[g&&i.jsx(W7,{onCreateCard:h,onExport:y,onImport:x,onSearch:o,onSearchAttributeChange:c,onToggleHeader:v,searchText:s,searchAttribute:A,headerVisible:l}),i.jsxs(J7,{className:"main-content",style:{marginTop:g?64:0},children:[!g&&!u&&i.jsx("div",{style:{position:"fixed",top:16,left:t?96:266,zIndex:1001,transition:"left 0.2s"},children:i.jsx(Be,{type:"primary",icon:i.jsx(a_,{}),onClick:v,style:{boxShadow:"0 2px 8px rgba(0,0,0,0.15)",borderRadius:"50%",width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center"},title:"Показать шапку"})}),i.jsx(nT,{})]})]})]})},vy={"Коммерческая недвижимость":{АЗС:["Здание","Помещение","Сооружение"],Автосалоны:["Здание","Помещение"],Апартаменты:["Помещение"],Гаражи:["Здание","Помещение"],Гостиницы:["Здание","Помещение"],"Кафе/рестораны":["Здание","Помещение"],"Медицинские центры":["Здание","Помещение"],"Офисные здания":["Здание"],"Офисные помещения":["Помещение"],"Производственные помещения":["Помещение"],Склады:["Здание","Помещение","Сооружение"],"Торговые центры":["Здание"],"Торговые помещения":["Помещение"],"Торгово-развлекательные центры":["Здание"],"Здания свободного назначения":["Здание"],"Помещения свободного назначения":["Помещение"]},"Жилая недвижимость":{Квартира:["Помещение"],Комната:["Помещение"],"Жилой дом":["Здание"],Таунхаус:["Здание"],Дача:["Здание"],"Земельный участок":["Земельный участок"]},"Промышленная недвижимость":{"Производственные здания":["Здание"],"Производственные сооружения":["Сооружение"],Цеха:["Здание","Помещение"],Ангары:["Здание","Сооружение"],Элеваторы:["Сооружение"],Резервуары:["Сооружение"]}},eM={Квартира_Помещение:"apartment",Комната_Помещение:"room","Жилой дом_Здание":"house",Таунхаус_Здание:"townhouse",Дача_Здание:"house","Земельный участок_Земельный участок":"land_residential","Офисные помещения_Помещение":"office","Офисные здания_Здание":"office","Торговые помещения_Помещение":"retail","Торговые центры_Здание":"retail",Склады_Здание:"warehouse",Склады_Помещение:"warehouse",Склады_Сооружение:"warehouse",Гостиницы_Здание:"hotel",Гостиницы_Помещение:"hotel","Кафе/рестораны_Здание":"catering","Кафе/рестораны_Помещение":"catering",АЗС_Здание:"gas_station",АЗС_Помещение:"gas_station",АЗС_Сооружение:"gas_station",Автосалоны_Здание:"car_dealership",Автосалоны_Помещение:"car_dealership","Производственные здания_Здание":"industrial_building","Производственные сооружения_Сооружение":"industrial_building",Цеха_Здание:"workshop",Цеха_Помещение:"workshop"},wy={Квартира_Помещение:2010,Комната_Помещение:2030,"Жилой дом_Здание":2020,Таунхаус_Здание:2040,Дача_Здание:2050,"Земельный участок_Земельный участок":2060,"Офисные помещения_Помещение":1010,"Офисные здания_Здание":1011,"Торговые помещения_Помещение":1020,"Торговые центры_Здание":1021,Склады_Здание:1031,Склады_Помещение:1030,Склады_Сооружение:1032,Гостиницы_Здание:1040,Гостиницы_Помещение:1041,"Кафе/рестораны_Здание":1051,"Кафе/рестораны_Помещение":1050,АЗС_Здание:1060,АЗС_Помещение:1061,АЗС_Сооружение:1062,Автосалоны_Здание:1070,Автосалоны_Помещение:1071,Апартаменты_Помещение:1080,Гаражи_Здание:1090,Гаражи_Помещение:1091,"Медицинские центры_Здание":1100,"Медицинские центры_Помещение":1101,"Здания свободного назначения_Здание":1110,"Помещения свободного назначения_Помещение":1111,"Производственные помещения_Помещение":1120,"Торгово-развлекательные центры_Здание":1130,"Производственные здания_Здание":3010,"Производственные сооружения_Сооружение":3011,Цеха_Здание:3021,Цеха_Помещение:3020,Ангары_Здание:3030,Ангары_Сооружение:3031,Элеваторы_Сооружение:3040,Резервуары_Сооружение:3050},tM=Object.entries(vy).map(([e,t])=>({value:e,label:e,children:Object.entries(t).map(([r,a])=>({value:r,label:r,children:a.map(n=>{const s=`${r}_${n}`,o=wy[s]||0;return{value:n,label:n,cbCode:o}})}))})),xC=(e,t,r)=>{const a=`${t}_${r}`;return wy[a]||0},Y4=(e,t)=>{const r=`${e}_${t}`;return eM[r]||null},rM=e=>{const t=vy[e];return t?Object.keys(t).map(r=>({value:r,label:r})):[]},aM=(e,t)=>{const r=vy[e];if(!r)return[];const a=r[t];return a?a.map(n=>{const s=`${t}_${n}`,o=wy[s]||0;return{value:n,label:n,cbCode:o}}):[]},nM=(e,t,r)=>xC(e,t,r)!==0,iM=({value:e,onChange:t,disabled:r=!1})=>{const[a,n]=K.useState((e==null?void 0:e.level0)||""),[s,o]=K.useState((e==null?void 0:e.level1)||""),[A,c]=K.useState((e==null?void 0:e.level2)||""),[l,d]=K.useState(0),[f,p]=K.useState(!0);K.useEffect(()=>{e&&(n(e.level0||""),o(e.level1||""),c(e.level2||""))},[e]),K.useEffect(()=>{if(a&&s&&A){const v=xC(a,s,A),E=nM(a,s,A);d(v),p(E),E&&t&&t({level0:a,level1:s,level2:A},v)}else d(0),p(!0)},[a,s,A,t]);const u=v=>{n(v),o(""),c(""),d(0)},g=v=>{o(v),c(""),d(0)},h=v=>{c(v)},y=a?rM(a):[],x=a&&s?aM(a,s):[];return i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},children:[i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"middle",children:[i.jsxs("div",{style:{width:"100%"},children:[i.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Категория (Уровень 0)"}),i.jsx(Ye,{placeholder:"Выберите категорию",value:a||void 0,onChange:u,disabled:r,style:{width:"100%"},options:tM.map(v=>({value:v.value,label:v.label}))})]}),i.jsxs("div",{style:{width:"100%"},children:[i.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Вид объекта (Уровень 1)"}),i.jsx(Ye,{placeholder:"Выберите вид объекта",value:s||void 0,onChange:g,disabled:r||!a,style:{width:"100%"},options:y.map(v=>({value:v.value,label:v.label}))})]}),i.jsxs("div",{style:{width:"100%"},children:[i.jsx("div",{style:{marginBottom:8,fontSize:"14px",fontWeight:500},children:"Тип (Уровень 2)"}),i.jsx(Ye,{placeholder:"Выберите тип",value:A||void 0,onChange:h,disabled:r||!s,style:{width:"100%"},options:x.map(v=>({value:v.value,label:v.label}))})]})]}),a&&s&&A&&i.jsx(i.Fragment,{children:f?i.jsx(Nr,{message:`Код ЦБ: ${l}`,type:"success",showIcon:!0}):i.jsx(Nr,{message:"Некорректная комбинация классификации",type:"error",showIcon:!0})})]})},Vs=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,sM=e=>(typeof e=="string"?new Date(e):e).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),oM=({value:e=[],onChange:t,disabled:r=!1})=>{const[a,n]=K.useState(e),[s,o]=K.useState(!1),[A,c]=K.useState(null),[l]=ne.useForm(),d=[{value:"individual",label:"Физическое лицо"},{value:"legal",label:"Юридическое лицо"}],f=[{value:"owner",label:"Собственник"},{value:"pledgor",label:"Залогодатель"},{value:"appraiser",label:"Оценщик"},{value:"other",label:"Другое"}],p=()=>{l.resetFields(),c(null),o(!0)},u=E=>{c(E),l.setFieldsValue(E),o(!0)},g=E=>{const D=a.filter(B=>B.id!==E);n(D),t==null||t(D)},h=async()=>{try{const E=await l.validateFields(),D=new Date,B={id:(A==null?void 0:A.id)||Vs(),type:E.type,role:E.role,lastName:E.lastName,firstName:E.firstName,middleName:E.middleName,organizationName:E.organizationName,inn:E.inn,share:E.share,showInRegistry:E.showInRegistry!==void 0?E.showInRegistry:!0,createdAt:(A==null?void 0:A.createdAt)||D,updatedAt:D};let I;A?I=a.map(_=>_.id===A.id?B:_):I=[...a,B],n(I),t==null||t(I),o(!1),l.resetFields()}catch(E){console.error("Validation failed:",E)}},y=E=>E.type==="individual"?[E.lastName,E.firstName,E.middleName].filter(Boolean).join(" "):E.organizationName||"",x=E=>{const D={owner:"blue",pledgor:"green",appraiser:"orange",other:"default"},B={owner:"Собственник",pledgor:"Залогодатель",appraiser:"Оценщик",other:"Другое"};return i.jsx(at,{color:D[E],children:B[E]})},v=[{title:"Тип",dataIndex:"type",key:"type",width:80,render:E=>E==="individual"?i.jsx(es,{style:{fontSize:18}}):i.jsx(e_,{style:{fontSize:18}})},{title:"Наименование/ФИО",key:"name",render:(E,D)=>y(D)},{title:"ИНН",dataIndex:"inn",key:"inn",width:150},{title:"Роль",dataIndex:"role",key:"role",width:150,render:E=>x(E)},{title:"Доля (%)",dataIndex:"share",key:"share",width:100,render:E=>E!==void 0?`${E}%`:"-"},{title:"В реестре",dataIndex:"showInRegistry",key:"showInRegistry",width:100,render:E=>E?"Да":"Нет"},{title:"Действия",key:"actions",width:120,fixed:"right",render:(E,D)=>i.jsxs(Fe,{size:"small",children:[i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),onClick:()=>u(D),disabled:r,children:"Изменить"}),i.jsx(fo,{title:"Удалить партнера?",onConfirm:()=>g(D.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),disabled:r,children:"Удалить"})})]})}];return i.jsxs("div",{children:[i.jsx(Fe,{style:{marginBottom:16},children:i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:p,disabled:r,children:"Добавить партнера"})}),i.jsx(nr,{columns:v,dataSource:a,rowKey:"id",pagination:!1,size:"small"}),i.jsx(dr,{title:A?"Редактирование партнера":"Добавление партнера",open:s,onOk:h,onCancel:()=>{o(!1),l.resetFields()},width:700,okText:"Сохранить",cancelText:"Отмена",children:i.jsxs(ne,{form:l,layout:"vertical",initialValues:{showInRegistry:!0,type:"individual"},children:[i.jsx(ne.Item,{name:"type",label:"Тип партнера",rules:[{required:!0,message:"Выберите тип"}],children:i.jsx(Ye,{options:d})}),i.jsx(ne.Item,{noStyle:!0,shouldUpdate:(E,D)=>E.type!==D.type,children:({getFieldValue:E})=>E("type")==="individual"?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"lastName",label:"Фамилия",rules:[{required:!0,message:"Введите фамилию"}],children:i.jsx(Re,{placeholder:"Иванов"})}),i.jsx(ne.Item,{name:"firstName",label:"Имя",rules:[{required:!0,message:"Введите имя"}],children:i.jsx(Re,{placeholder:"Иван"})}),i.jsx(ne.Item,{name:"middleName",label:"Отчество",children:i.jsx(Re,{placeholder:"Иванович"})})]}):i.jsx(ne.Item,{name:"organizationName",label:"Наименование организации",rules:[{required:!0,message:"Введите наименование"}],children:i.jsx(Re,{placeholder:"ООО Рога и Копыта"})})}),i.jsx(ne.Item,{name:"inn",label:"ИНН",children:i.jsx(Re,{placeholder:"1234567890",maxLength:12})}),i.jsx(ne.Item,{name:"role",label:"Роль",rules:[{required:!0,message:"Выберите роль"}],children:i.jsx(Ye,{options:f})}),i.jsx(ne.Item,{name:"share",label:"Доля права (%)",children:i.jsx(fa,{min:0,max:100,step:.01,style:{width:"100%"}})}),i.jsx(ne.Item,{name:"showInRegistry",label:"Показывать в реестре",valuePropName:"checked",children:i.jsx(Ni,{})})]})})]})};class AM{constructor(){sr(this,"API_KEY","8369d552d89563916982831fbb6ddb90b7d38fe2");sr(this,"BASE_URL","https://suggestions.dadata.ru/suggestions/api/4_1/rs");sr(this,"requestCount",0);sr(this,"DAILY_LIMIT",1e4);sr(this,"lastResetDate",new Date().toDateString())}checkAndResetLimit(){const t=new Date().toDateString();t!==this.lastResetDate&&(this.requestCount=0,this.lastResetDate=t)}incrementRequestCount(){return this.checkAndResetLimit(),this.requestCount>=this.DAILY_LIMIT?(console.warn("DaData API daily limit reached"),!1):(this.requestCount++,!0)}getRemainingRequests(){return this.checkAndResetLimit(),this.DAILY_LIMIT-this.requestCount}async suggestAddress(t,r=10){if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");if(!t||t.length<3)return[];try{const a={query:t,count:r,from_bound:{value:"region"},to_bound:{value:"flat"}},n=await fetch(`${this.BASE_URL}/suggest/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify(a)});if(!n.ok)throw new Error(`DaData API error: ${n.status} ${n.statusText}`);return(await n.json()).suggestions||[]}catch(a){throw console.error("Error fetching address suggestions from DaData:",a),a}}async geolocateAddress(t,r,a=100){if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");try{const n={lat:t,lon:r,radius_meters:a,count:5},s=await fetch(`${this.BASE_URL}/geolocate/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify(n)});if(!s.ok)throw new Error(`DaData geolocate error: ${s.status}`);return(await s.json()).suggestions||[]}catch(n){throw console.error("Error geolocating address:",n),n}}async findByFiasId(t){var r;if(!this.incrementRequestCount())throw new Error("Превышен дневной лимит запросов к DaData API");try{const a=await fetch(`${this.BASE_URL}/findById/address`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${this.API_KEY}`},body:JSON.stringify({query:t,count:1})});if(!a.ok)throw new Error(`DaData findById error: ${a.status}`);return((r=(await a.json()).suggestions)==null?void 0:r[0])||null}catch(a){throw console.error("Error finding address by FIAS ID:",a),a}}async standardizeAddress(t){return(await this.suggestAddress(t,1))[0]||null}async validateAddress(t){try{const r=await this.standardizeAddress(t);if(!r)return{isValid:!1,qc:3,suggestion:null};const a=parseInt(r.data.qc||"3",10);return{isValid:a<=1,qc:a,suggestion:r}}catch{return{isValid:!1,qc:3,suggestion:null}}}}const Gu=new AM,bx=(e,t)=>({id:t||`addr-${Date.now()}`,region:e.data.region_with_type||void 0,district:e.data.area||void 0,city:e.data.city||void 0,settlement:e.data.settlement||void 0,street:e.data.street||void 0,house:e.data.house||void 0,building:e.data.block||void 0,apartment:e.data.flat||void 0,postalCode:e.data.postal_code||void 0,fullAddress:e.value,cadastralNumber:void 0,fias:e.data.fias_id,countryIsoCode:e.data.country_iso_code,regionFiasId:e.data.region_fias_id,regionKladrId:e.data.region_kladr_id,regionIsoCode:e.data.region_iso_code,regionType:e.data.region_type,cityFiasId:e.data.city_fias_id||void 0,cityType:e.data.city_type||void 0,cityDistrict:e.data.city_district||void 0,streetFiasId:e.data.street_fias_id||void 0,streetType:e.data.street_type||void 0,houseFiasId:e.data.house_fias_id||void 0,houseType:e.data.house_type||void 0,flatArea:e.data.flat_area?parseFloat(e.data.flat_area):void 0,squareMeterPrice:e.data.square_meter_price?parseFloat(e.data.square_meter_price):void 0,flatPrice:e.data.flat_price?parseFloat(e.data.flat_price):void 0,geoLat:e.data.geo_lat?parseFloat(e.data.geo_lat):void 0,geoLon:e.data.geo_lon?parseFloat(e.data.geo_lon):void 0,timezone:e.data.timezone||void 0,okato:e.data.okato,oktmo:e.data.oktmo,taxOffice:e.data.tax_office,taxOfficeLegal:e.data.tax_office_legal,metro:e.data.metro||void 0,qc:e.data.qc||void 0,qcGeo:e.data.qc_geo||void 0,qcComplete:e.data.qc_complete||void 0,qcHouse:e.data.qc_house||void 0,source:"dadata"}),W4=(e,t)=>{let r=null;return function(...n){const s=()=>{r=null,e(...n)};r&&clearTimeout(r),r=setTimeout(s,t)}},cM=({value:e,onChange:t,disabled:r=!1,placeholder:a="Начните вводить адрес (мин. 3 символа)...",showDetails:n=!0})=>{const[s,o]=K.useState((e==null?void 0:e.fullAddress)||""),[A,c]=K.useState([]),[l,d]=K.useState(!1),[f,p]=K.useState(null),[u,g]=K.useState(e),[h,y]=K.useState(0),x=K.useRef(W4(async _=>{if(_.length<3){c([]);return}d(!0),p(null);try{const S=await Gu.suggestAddress(_,10);c(S),y(Gu.getRemainingRequests())}catch(S){p("Ошибка при получении подсказок адреса. Проверьте подключение к интернету."),console.error("DaData suggestion error:",S),c([])}finally{d(!1)}},500));K.useEffect(()=>{x.current=W4(async _=>{if(_.length<3){c([]);return}d(!0),p(null);try{const S=await Gu.suggestAddress(_,10);c(S),y(Gu.getRemainingRequests())}catch(S){p("Ошибка при получении подсказок адреса. Проверьте подключение к интернету."),console.error("DaData suggestion error:",S),c([])}finally{d(!1)}},500)},[]);const v=_=>{o(_),_.length>=3?x.current(_):c([])},E=_=>{const S=A.find(O=>O.value===_);if(S){const O=bx(S,e==null?void 0:e.id);g(O),o(_),c([]),t&&t(O)}},D=_=>{switch(_){case"0":return"green";case"1":return"orange";case"2":return"red";case"3":return"red";default:return"default"}},B=_=>{switch(_){case"0":return"Адрес проверен";case"1":return"Требует уточнения";case"2":return"Плохое качество";case"3":return"Не распознан";default:return"Неизвестно"}},I=A.map(_=>({value:_.value,label:i.jsxs("div",{style:{padding:"4px 0"},children:[i.jsx("div",{children:_.value}),i.jsxs(Fe,{size:"small",style:{marginTop:4},children:[_.data.postal_code&&i.jsx(at,{color:"blue",style:{fontSize:11},children:_.data.postal_code}),_.data.qc&&i.jsx(at,{color:D(_.data.qc),style:{fontSize:11},children:B(_.data.qc)})]})]})}));return i.jsxs("div",{className:"dadata-address-input",children:[i.jsx(CT,{value:s,options:I,onSelect:E,onSearch:v,disabled:r,notFoundContent:l?i.jsx(Zn,{size:"small",tip:"Поиск адресов..."}):"Введите минимум 3 символа",style:{width:"100%"},dropdownStyle:{minWidth:400},children:i.jsx(Re,{prefix:i.jsx(Pa,{}),suffix:l&&i.jsx(Zn,{size:"small"}),placeholder:a,allowClear:!0})}),f&&i.jsx(Nr,{message:f,type:"error",showIcon:!0,closable:!0,onClose:()=>p(null),style:{marginTop:8}}),u&&n&&i.jsxs(Ge,{size:"small",style:{marginTop:12},title:"Детали адреса",children:[i.jsx(ft,{gutter:[8,8],children:i.jsx(Te,{span:24,children:i.jsxs(Fe,{size:"small",wrap:!0,children:[u.qc&&i.jsx(at,{color:D(u.qc),icon:u.qc==="0"?i.jsx(On,{}):i.jsx(fh,{}),children:B(u.qc)}),u.postalCode&&i.jsxs(at,{color:"blue",children:["Индекс: ",u.postalCode]}),u.fias&&i.jsxs(at,{color:"green",children:["ФИАС: ",u.fias.substring(0,8),"..."]}),u.geoLat&&u.geoLon&&i.jsxs(at,{color:"orange",icon:i.jsx(tA,{}),children:[u.geoLat.toFixed(4),", ",u.geoLon.toFixed(4)]})]})})}),i.jsxs(ft,{gutter:[12,8],style:{marginTop:12},children:[i.jsxs(Te,{span:12,children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Регион:"}),i.jsx("div",{style:{fontWeight:500},children:u.region||"-"})]}),i.jsxs(Te,{span:12,children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Город:"}),i.jsx("div",{style:{fontWeight:500},children:u.city||u.settlement||"-"})]}),i.jsxs(Te,{span:12,children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Улица:"}),i.jsx("div",{style:{fontWeight:500},children:u.street||"-"})]}),i.jsxs(Te,{span:12,children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Дом/Квартира:"}),i.jsx("div",{style:{fontWeight:500},children:[u.house,u.building,u.apartment].filter(Boolean).join(", ")||"-"})]})]}),u.metro&&u.metro.length>0&&i.jsxs("div",{style:{marginTop:12},children:[i.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:"Ближайшее метро:"}),i.jsx(Fe,{size:"small",wrap:!0,children:u.metro.map((_,S)=>i.jsxs(at,{color:"purple",children:[_.name," (",_.distance,"м)"]},S))})]}),i.jsxs("div",{style:{marginTop:12,fontSize:11,color:"#999"},children:["Осталось запросов сегодня: ",h," / 10000"]})]})]})};class lM{async getCurrentPosition(){return new Promise(t=>{if(!("geolocation"in navigator)){console.warn("Geolocation is not supported by this browser"),t(null);return}navigator.geolocation.getCurrentPosition(r=>{t({coordinates:{lat:r.coords.latitude,lon:r.coords.longitude},accuracy:r.coords.accuracy,timestamp:r.timestamp})},r=>{console.error("Error getting current position:",r);let a="Не удалось определить местоположение";switch(r.code){case r.PERMISSION_DENIED:a="Доступ к геолокации запрещен. Разрешите доступ в настройках браузера.";break;case r.POSITION_UNAVAILABLE:a="Информация о местоположении недоступна.";break;case r.TIMEOUT:a="Время ожидания определения местоположения истекло.";break}console.warn(a),t(null)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})}async getAddressFromCoordinates(t){try{return await Gu.geolocateAddress(t.lat,t.lon)}catch(r){return console.error("Error getting address from coordinates:",r),[]}}async getCurrentLocationWithAddress(){const t=await this.getCurrentPosition();if(!t)return null;const r=await this.getAddressFromCoordinates(t.coordinates);return{coordinates:t.coordinates,addresses:r}}calculateDistance(t,r){const n=this.deg2rad(r.lat-t.lat),s=this.deg2rad(r.lon-t.lon),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this.deg2rad(t.lat))*Math.cos(this.deg2rad(r.lat))*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}deg2rad(t){return t*(Math.PI/180)}formatDistance(t){return t<1?`${Math.round(t*1e3)} м`:`${t.toFixed(1)} км`}isGeolocationSupported(){return"geolocation"in navigator}async checkPermission(){if(!("permissions"in navigator))return null;try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(t){return console.error("Error checking geolocation permission:",t),null}}}const X4=new lM,dM=({onAddressSelect:e,initialCoordinates:t})=>{const[r,a]=K.useState(t||null),[n,s]=K.useState([]),[o,A]=K.useState(!1),[c,l]=K.useState(null),[d,f]=K.useState(null),p=async()=>{A(!0),l(null),s([]);try{const h=await X4.getCurrentLocationWithAddress();if(h){if(a(h.coordinates),s(h.addresses),f(h.coordinates?50:null),h.addresses.length>0){const y=bx(h.addresses[0]);e==null||e(y)}}else l("Не удалось определить местоположение. Проверьте разрешения браузера.")}catch(h){l(h.message||"Ошибка при определении местоположения"),console.error("Geolocation error:",h)}finally{A(!1)}},u=h=>{const y=bx(h);e==null||e(y)};return X4.isGeolocationSupported()?i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(tA,{}),i.jsx("span",{children:"Определение местоположения"})]}),extra:i.jsx(Be,{type:"primary",icon:i.jsx(BT,{}),onClick:p,loading:o,disabled:o,children:o?"Определение...":"Определить местоположение"}),children:[c&&i.jsx(Nr,{message:c,type:"error",showIcon:!0,closable:!0,onClose:()=>l(null),style:{marginBottom:16}}),o&&i.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:i.jsx(Zn,{size:"large",tip:"Определение вашего местоположения..."})}),!o&&r&&i.jsx("div",{children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsx(Ge,{size:"small",type:"inner",title:"Ваши координаты",children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsxs(at,{color:"blue",children:["Широта: ",r.lat.toFixed(6)]}),i.jsxs(at,{color:"green",children:["Долгота: ",r.lon.toFixed(6)]}),d&&i.jsxs(at,{color:"orange",children:["Точность: ~",d,"м"]})]}),i.jsx("a",{href:`https://yandex.ru/maps/?ll=${r.lon},${r.lat}&z=16`,target:"_blank",rel:"noopener noreferrer",children:"Открыть на Я.Картах"})]})}),n.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{style:{margin:"8px 0"},children:"Найденные адреса"}),i.jsx("div",{children:n.map((h,y)=>i.jsx(Ge,{size:"small",hoverable:!0,style:{marginBottom:8,cursor:"pointer"},onClick:()=>u(h),children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:500},children:h.value}),h.data.postal_code&&i.jsx(at,{color:"blue",style:{marginTop:4,fontSize:11},children:h.data.postal_code})]}),i.jsx(On,{style:{fontSize:20,color:"#52c41a"}})]})},y))})]}),n.length===0&&r&&!o&&i.jsx(Nr,{message:"Адреса не найдены",description:"Не удалось найти адреса рядом с вашим местоположением. Попробуйте ввести адрес вручную.",type:"info",showIcon:!0})]})}),!o&&!r&&!c&&i.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:[i.jsx(tA,{style:{fontSize:64,color:"#d9d9d9"}}),i.jsx("div",{style:{marginTop:16},children:'Нажмите кнопку "Определить местоположение" для автоматического поиска адреса'}),i.jsx("div",{style:{marginTop:8,fontSize:12},children:"Браузер запросит разрешение на доступ к вашему местоположению"})]}),i.jsx(Nr,{message:"Примечание",description:"Для работы геолокации необходимо разрешение браузера на доступ к местоположению. Функция работает лучше всего на мобильных устройствах.",type:"info",showIcon:!0,style:{marginTop:16}})]}):i.jsx(Nr,{message:"Геолокация не поддерживается",description:"Ваш браузер не поддерживает определение местоположения. Используйте ввод адреса вручную.",type:"warning",showIcon:!0})},uM=({value:e,onChange:t,disabled:r=!1,useDaData:a=!1,showGeoPicker:n=!1})=>{const[s,o]=K.useState({id:(e==null?void 0:e.id)||"",region:(e==null?void 0:e.region)||"",district:(e==null?void 0:e.district)||"",city:(e==null?void 0:e.city)||"",settlement:(e==null?void 0:e.settlement)||"",street:(e==null?void 0:e.street)||"",house:(e==null?void 0:e.house)||"",building:(e==null?void 0:e.building)||"",apartment:(e==null?void 0:e.apartment)||"",postalCode:(e==null?void 0:e.postalCode)||"",fullAddress:(e==null?void 0:e.fullAddress)||"",cadastralNumber:(e==null?void 0:e.cadastralNumber)||"",fias:(e==null?void 0:e.fias)||""});K.useEffect(()=>{e&&o(e)},[e]),K.useEffect(()=>{const d=[s.region,s.district,s.city,s.settlement,s.street,s.house&&`д. ${s.house}`,s.building&&`к. ${s.building}`,s.apartment&&`кв. ${s.apartment}`].filter(Boolean).join(", ");if(d!==s.fullAddress){const f={...s,fullAddress:d};o(f),t==null||t(f)}},[s.region,s.district,s.city,s.settlement,s.street,s.house,s.building,s.apartment]);const A=(l,d)=>{const f={...s,[l]:d};o(f),t==null||t(f)},c=l=>{const d={id:l.id||s.id||"",region:l.region,district:l.district,city:l.city,settlement:l.settlement,street:l.street,house:l.house,building:l.building,apartment:l.apartment,postalCode:l.postalCode,fullAddress:l.fullAddress,cadastralNumber:l.cadastralNumber,fias:l.fias};o(d),t==null||t(d)};return i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a&&i.jsxs(i.Fragment,{children:[i.jsx(cM,{value:e,onChange:c,disabled:r,showDetails:!0}),i.jsx(jt,{style:{margin:"12px 0"},children:"или введите вручную"})]}),n&&i.jsxs(i.Fragment,{children:[i.jsx(dM,{onAddressSelect:c,initialCoordinates:(e!=null&&e.fias,void 0)}),i.jsx(jt,{style:{margin:"12px 0"},children:"Детали адреса"})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Регион",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"Московская область",value:s.region,onChange:l=>A("region",l.target.value),disabled:r,prefix:i.jsx(tA,{})})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Район",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"Одинцовский район",value:s.district,onChange:l=>A("district",l.target.value),disabled:r})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Город",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"Москва",value:s.city,onChange:l=>A("city",l.target.value),disabled:r})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Населенный пункт",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"пос. Лесной",value:s.settlement,onChange:l=>A("settlement",l.target.value),disabled:r})})})]}),i.jsx(ft,{gutter:16,children:i.jsx(Te,{span:24,children:i.jsx(ne.Item,{label:"Улица",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"ул. Ленина",value:s.street,onChange:l=>A("street",l.target.value),disabled:r})})})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{label:"Дом",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"15",value:s.house,onChange:l=>A("house",l.target.value),disabled:r})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{label:"Корпус/Строение",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"1",value:s.building,onChange:l=>A("building",l.target.value),disabled:r})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{label:"Квартира/Офис",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"10",value:s.apartment,onChange:l=>A("apartment",l.target.value),disabled:r})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Почтовый индекс",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"123456",value:s.postalCode,onChange:l=>A("postalCode",l.target.value),disabled:r,maxLength:6})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Кадастровый номер",style:{marginBottom:8},children:i.jsx(Re,{placeholder:"77:01:0001001:1234",value:s.cadastralNumber,onChange:l=>A("cadastralNumber",l.target.value),disabled:r})})})]}),i.jsx(ft,{gutter:16,children:i.jsx(Te,{span:24,children:i.jsx(ne.Item,{label:"Полный адрес (автозаполнение)",style:{marginBottom:8},children:i.jsx(Re.TextArea,{value:s.fullAddress,onChange:l=>A("fullAddress",l.target.value),disabled:r,rows:2,placeholder:"Будет сформирован автоматически"})})})})]})},fM=({value:e=[],onChange:t,disabled:r=!1})=>{const[a,n]=K.useState(e),[s,o]=K.useState(!1),[A,c]=K.useState(!1),[l,d]=K.useState(null),[f]=ne.useForm(),[p,u]=K.useState([]),g=["Правоустанавливающие документы","Технические документы","Отчеты об оценке","Фотографии","Договоры","Прочее"],h=()=>{o(!0),f.resetFields(),u([])},y=async()=>{try{const S=await f.validateFields();if(p.length===0){Ne.error("Выберите файл для загрузки");return}const O=[];for(const T of p){const R=new FileReader,L=await new Promise((P,U)=>{R.onload=()=>P(R.result),R.onerror=U,R.readAsDataURL(T.originFileObj)}),N={id:Vs(),name:T.name,type:S.type||"Прочее",size:T.size,mimeType:T.type,uploadDate:new Date,category:S.category,description:S.description,fileData:L};O.push(N)}const M=[...a,...O];n(M),t==null||t(M),o(!1),Ne.success(`Загружено документов: ${O.length}`)}catch(S){console.error("Upload failed:",S)}},x=S=>{const O=a.filter(M=>M.id!==S);n(O),t==null||t(O),Ne.success("Документ удален")},v=S=>{if(!S.fileData){Ne.error("Данные файла недоступны");return}const O=document.createElement("a");O.href=S.fileData,O.download=S.name,document.body.appendChild(O),O.click(),document.body.removeChild(O),Ne.success("Файл скачан")},E=S=>{d(S),c(!0)},D=S=>{if(S===0)return"0 Bytes";const O=1024,M=["Bytes","KB","MB","GB"],T=Math.floor(Math.log(S)/Math.log(O));return Math.round(S/Math.pow(O,T)*100)/100+" "+M[T]},B=S=>S.startsWith("image/")?i.jsx(kA,{style:{color:"#52c41a"}}):S.includes("pdf")?i.jsx(kA,{style:{color:"#f5222d"}}):S.includes("word")?i.jsx(kA,{style:{color:"#1890ff"}}):S.includes("excel")||S.includes("spreadsheet")?i.jsx(kA,{style:{color:"#52c41a"}}):i.jsx(kA,{}),I=[{title:"Тип",dataIndex:"mimeType",key:"mimeType",width:60,render:S=>B(S)},{title:"Название",dataIndex:"name",key:"name"},{title:"Категория",dataIndex:"category",key:"category",width:200,render:S=>i.jsx(at,{children:S})},{title:"Размер",dataIndex:"size",key:"size",width:100,render:S=>D(S)},{title:"Дата загрузки",dataIndex:"uploadDate",key:"uploadDate",width:180,render:S=>sM(S)},{title:"Действия",key:"actions",width:200,fixed:"right",render:(S,O)=>i.jsxs(Fe,{size:"small",children:[i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>E(O),size:"small",children:"Просмотр"}),i.jsx(Be,{type:"link",icon:i.jsx(In,{}),onClick:()=>v(O),size:"small",children:"Скачать"}),i.jsx(fo,{title:"Удалить документ?",onConfirm:()=>x(O.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),size:"small",disabled:r,children:"Удалить"})})]})}],_={multiple:!0,fileList:p,onChange:({fileList:S})=>{u(S)},beforeUpload:()=>!1,onRemove:S=>{const O=p.indexOf(S),M=p.slice();M.splice(O,1),u(M)}};return i.jsxs("div",{children:[i.jsxs(Fe,{style:{marginBottom:16},children:[i.jsx(Be,{type:"primary",icon:i.jsx(Ii,{}),onClick:h,disabled:r,children:"Загрузить документы"}),a.length>0&&i.jsxs("span",{style:{color:"#999"},children:["Всего документов: ",a.length," (",D(a.reduce((S,O)=>S+O.size,0)),")"]})]}),i.jsx(nr,{columns:I,dataSource:a,rowKey:"id",pagination:!1,size:"small"}),i.jsx(dr,{title:"Загрузка документов",open:s,onOk:y,onCancel:()=>{o(!1),f.resetFields(),u([])},width:600,okText:"Загрузить",cancelText:"Отмена",children:i.jsxs(ne,{form:f,layout:"vertical",children:[i.jsx(ne.Item,{label:"Выберите файлы",children:i.jsxs(Xi.Dragger,{..._,children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(Ii,{})}),i.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файлы в эту область"}),i.jsx("p",{className:"ant-upload-hint",children:"Поддерживается загрузка одного или нескольких файлов"})]})}),i.jsx(ne.Item,{name:"category",label:"Категория документа",rules:[{required:!0,message:"Выберите категорию"}],children:i.jsx(Ye,{options:g.map(S=>({label:S,value:S})),placeholder:"Выберите категорию"})}),i.jsx(ne.Item,{name:"type",label:"Тип документа",children:i.jsx(Re,{placeholder:"Например: Свидетельство о праве собственности"})}),i.jsx(ne.Item,{name:"description",label:"Описание",children:i.jsx(Re.TextArea,{rows:3,placeholder:"Краткое описание документа"})})]})}),i.jsx(dr,{title:l==null?void 0:l.name,open:A,onCancel:()=>c(!1),footer:[i.jsx(Be,{icon:i.jsx(In,{}),onClick:()=>l&&v(l),children:"Скачать"},"download"),i.jsx(Be,{onClick:()=>c(!1),children:"Закрыть"},"close")],width:800,children:l&&l.fileData&&i.jsx("div",{style:{textAlign:"center"},children:l.mimeType.startsWith("image/")?i.jsx("img",{src:l.fileData,alt:l.name,style:{maxWidth:"100%",maxHeight:"600px"}}):l.mimeType==="application/pdf"?i.jsx("iframe",{src:l.fileData,style:{width:"100%",height:"600px",border:"none"},title:l.name}):i.jsxs("div",{style:{padding:"40px"},children:[i.jsx(kA,{style:{fontSize:64,color:"#999"}}),i.jsx("p",{style:{marginTop:16,color:"#999"},children:"Предпросмотр недоступен для данного типа файла"})]})})})]})},J4="cms_reference_data";class pM{async syncCollateralAttributesFromUnified(t=!1){var r,a;try{const n="cms_refdata_zalog_synced_at";if(!t&&localStorage.getItem(n))return!1;const s=((a=(r=import.meta)==null?void 0:r.env)==null?void 0:a.BASE_URL)??"/",o=new URL(s,window.location.origin),A=o.pathname.endsWith("/")?o.pathname:`${o.pathname}/`,c=`${o.origin}${A}Spravochniki/str/unified-attributes.json?v=${Date.now()}`,l=await fetch(c,{cache:"no-store"});if(!l.ok)return console.warn("Не удалось загрузить unified-attributes.json:",l.status,l.statusText),!1;const f=((await l.json()).attributes||[]).map((h,y)=>({id:h.id||`attr-${y}`,code:h.code||`code_${y}`,name:h.name||h.code||`Атрибут ${y+1}`,isActive:!0,sortOrder:y+1,metadata:{type:h.type||"string",group:h.code||"",section:h.level?`level_${h.level}`:"",sourceFiles:h.sourceFile||"",dependencyHints:h.dependencyHints||[],valuesCount:h.valuesCount||0}})),p=this.getDictionaries(),u=p.findIndex(h=>h.code==="collateral_attributes_zalog"),g=new Date().toISOString();return u>=0?p[u]={...p[u],name:"Атрибуты залога (обновлено из Spravochniki)",description:"Сформировано из Spravochniki/str/unified-attributes.json",items:f,updatedAt:g}:p.push({id:"dict-collateral-attributes-zalog",name:"Атрибуты залога (обновлено из Spravochniki)",code:"collateral_attributes_zalog",description:"Сформировано из Spravochniki/str/unified-attributes.json",items:f,createdAt:g,updatedAt:g}),this.saveDictionaries(p),localStorage.setItem(n,new Date().toISOString()),console.log(`Справочник collateral_attributes_zalog обновлен из unified-attributes.json. Элементов: ${f.length}`),!0}catch(n){return console.error("Ошибка синхронизации атрибутов залога из unified-attributes.json:",n),!1}}async syncAttributeLevelsFromPublic(t=!1){var r,a;try{const n="cms_refdata_attr_levels_synced_at";if(!t&&localStorage.getItem(n))return!1;const s=((a=(r=import.meta)==null?void 0:r.env)==null?void 0:a.BASE_URL)??"/",o=new URL(s,window.location.origin),A=o.pathname.endsWith("/")?o.pathname:`${o.pathname}/`,c=`${o.origin}${A}attribute-levels.json?v=${Date.now()}`,l=await fetch(c,{cache:"no-store"});if(!l.ok)return console.warn("Не удалось загрузить attribute-levels.json:",l.status,l.statusText),!1;const d=await l.json(),f=Array.isArray(d.items)?d.items:[],p=this.getDictionaries(),u=p.findIndex(h=>h.code==="attribute_levels"),g=new Date().toISOString();return u>=0?p[u]={...p[u],name:"Уровни атрибутов",description:"Иерархия уровней для атрибутов обеспечения",items:f,updatedAt:g}:p.push({id:"dict-attribute-levels",name:"Уровни атрибутов",code:"attribute_levels",description:"Иерархия уровней для атрибутов обеспечения",items:f,createdAt:g,updatedAt:g}),this.saveDictionaries(p),localStorage.setItem(n,new Date().toISOString()),console.log(`Справочник attribute_levels обновлен. Элементов: ${f.length}`),!0}catch(n){return console.error("Ошибка синхронизации уровней атрибутов:",n),!1}}getDictionaries(){try{const t=localStorage.getItem(J4);if(!t)return this.getDefaultDictionaries();const r=JSON.parse(t);if(!r.some(n=>n.code==="collateral_attributes_zalog")){const s=this.getDefaultDictionaries().find(o=>o.code==="collateral_attributes_zalog");s&&(r.push(s),this.saveDictionaries(r),console.log('Добавлен отсутствующий справочник "Атрибуты залога"'))}return r}catch(t){return console.error("Ошибка загрузки справочников:",t),this.getDefaultDictionaries()}}saveDictionaries(t){try{localStorage.setItem(J4,JSON.stringify(t))}catch(r){console.error("Ошибка сохранения справочников:",r)}}getDictionaryById(t){return this.getDictionaries().find(a=>a.id===t)}getDictionaryByCode(t){return this.getDictionaries().find(a=>a.code===t)}updateDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(s=>s.id===t);return n===-1?null:(a[n]={...a[n],...r,updatedAt:new Date().toISOString()},this.saveDictionaries(a),a[n])}addItemToDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(o=>o.id===t);if(n===-1)return null;const s={...r,id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};return a[n].items.push(s),a[n].updatedAt=new Date().toISOString(),this.saveDictionaries(a),s}updateItemInDictionary(t,r,a){const n=this.getDictionaries(),s=n.findIndex(A=>A.id===t);if(s===-1)return null;const o=n[s].items.findIndex(A=>A.id===r);return o===-1?null:(n[s].items[o]={...n[s].items[o],...a},n[s].updatedAt=new Date().toISOString(),this.saveDictionaries(n),n[s].items[o])}deleteItemFromDictionary(t,r){const a=this.getDictionaries(),n=a.findIndex(o=>o.id===t);if(n===-1)return!1;const s=a[n].items.length;return a[n].items=a[n].items.filter(o=>o.id!==r),a[n].items.length===s?!1:(a[n].updatedAt=new Date().toISOString(),this.saveDictionaries(a),!0)}getActiveItemsByCode(t){const r=this.getDictionaryByCode(t);return r?r.items.filter(a=>a.isActive).sort((a,n)=>(a.sortOrder||0)-(n.sortOrder||0)):[]}getDefaultDictionaries(){const t=new Date().toISOString(),r=[{id:"dict-regions",name:"Регионы",code:"regions",description:"Справочник регионов",items:[{id:"reg-1",name:"Москва",isActive:!0,sortOrder:1},{id:"reg-2",name:"Санкт-Петербург",isActive:!0,sortOrder:2},{id:"reg-3",name:"Новосибирск",isActive:!0,sortOrder:3},{id:"reg-4",name:"Екатеринбург",isActive:!0,sortOrder:4},{id:"reg-5",name:"Казань",isActive:!0,sortOrder:5},{id:"reg-6",name:"Нижний Новгород",isActive:!0,sortOrder:6}],createdAt:t,updatedAt:t},{id:"dict-segments",name:"Сегменты бизнеса",code:"segments",description:"Сегменты бизнеса для портфеля",items:[{id:"seg-1",code:"МБ",name:"МБ (Малый бизнес)",isActive:!0,sortOrder:1},{id:"seg-2",code:"СРБ",name:"СРБ (Средний бизнес)",isActive:!0,sortOrder:2},{id:"seg-3",code:"КБ",name:"КБ (Крупный бизнес)",isActive:!0,sortOrder:3},{id:"seg-4",name:"Корпоративный",isActive:!0,sortOrder:4},{id:"seg-5",name:"Розничный",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-groups",name:"Группы",code:"groups",description:"Группы портфеля",items:[{id:"grp-1",name:"Группа 1",isActive:!0,sortOrder:1},{id:"grp-2",name:"Группа 2",isActive:!0,sortOrder:2},{id:"grp-3",name:"Группа 3",isActive:!0,sortOrder:3}],createdAt:t,updatedAt:t},{id:"dict-liquidity",name:"Ликвидность",code:"liquidity",description:"Уровни ликвидности обеспечения",items:[{id:"liq-1",name:"высокая (срок реализации до 90 дней)",isActive:!0,sortOrder:1},{id:"liq-2",name:"удовлетворительная (срок реализации до 365 дней)",isActive:!0,sortOrder:2},{id:"liq-3",name:"низкая (срок реализации свыше 365 дней)",isActive:!0,sortOrder:3},{id:"liq-4",name:"малоудовлетворительная",isActive:!0,sortOrder:4}],createdAt:t,updatedAt:t},{id:"dict-collateral-categories",name:"Категории обеспечения",code:"collateral_categories",description:"Категории обеспечения из карточек сделок",items:[{id:"cat-1",name:"договор залога движимого имущества/оборудования",isActive:!0,sortOrder:1},{id:"cat-2",name:"договор залога недвижимого имущества",isActive:!0,sortOrder:2},{id:"cat-3",name:"договор ипотеки",isActive:!0,sortOrder:3},{id:"cat-4",name:"договор залога транспортных средств",isActive:!0,sortOrder:4},{id:"cat-5",name:"договор залога товаров в обороте",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-monitoring-types",name:"Типы мониторинга",code:"monitoring_types",description:"Типы мониторинга обеспечения",items:[{id:"mon-1",name:"Плановый",isActive:!0,sortOrder:1},{id:"mon-2",name:"Внеплановый",isActive:!0,sortOrder:2},{id:"mon-3",name:"Внеочередной",isActive:!0,sortOrder:3}],createdAt:t,updatedAt:t},{id:"dict-quality-categories",name:"Категории качества обеспечения",code:"quality_categories",description:"Категории качества обеспечения",items:[{id:"qual-1",name:"I категория",isActive:!0,sortOrder:1},{id:"qual-2",name:"II категория",isActive:!0,sortOrder:2},{id:"qual-3",name:"III категория",isActive:!0,sortOrder:3},{id:"qual-4",name:"IV категория",isActive:!0,sortOrder:4},{id:"qual-5",name:"V категория",isActive:!0,sortOrder:5}],createdAt:t,updatedAt:t},{id:"dict-collateral-attributes",name:"Атрибуты залогового имущества",code:"collateral_attributes",description:"Справочник атрибутов для различных типов залогового имущества",items:[{id:"attr-1",code:"GROUP_WHICH_CULTURE_BELONGS",name:"Группа, к которой относится культура",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10, Естественный ключ",isActive:!0,sortOrder:1,metadata:{type:"text",group:"Будущий урожай",required:!0,section:"4.10"}},{id:"attr-2",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10, Естественный ключ",isActive:!0,sortOrder:2,metadata:{type:"text",group:"Будущий урожай",required:!0,section:"4.10"}},{id:"attr-3",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:3,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-4",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:4,metadata:{type:"boolean",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-5",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:5,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-6",code:"GROUP_WHICH_CULTURE_BELONGS_OTHER",name:"Группа, к которой относится культура, иное",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:6,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-7",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:7,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-8",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Будущий урожай, Раздел: 4.10",isActive:!0,sortOrder:8,metadata:{type:"text",group:"Будущий урожай",required:!1,section:"4.10"}},{id:"attr-9",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:9,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-10",code:"QUANTITY",name:"Количество слитков, шт.",description:"Тип: number, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:10,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-11",code:"WEIGHT",name:"Масса, г.",description:"Тип: number, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11, Естественный ключ",isActive:!0,sortOrder:11,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11"}},{id:"attr-12",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:12,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-13",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:13,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-14",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:14,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-15",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:15,metadata:{type:"boolean",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-16",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Аффинированные драгоценные металлы в слитках, Раздел: 4.11",isActive:!0,sortOrder:16,metadata:{type:"text",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11"}},{id:"attr-17",code:"NUMBER_OF_DOCUMENT_OF_INTEL_ACT",name:"Номер документа, удостоверяющего исключительное право на результат интеллектуальной деятельности",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12, Естественный ключ",isActive:!0,sortOrder:17,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!0,section:"4.12"}},{id:"attr-18",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:18,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-19",code:"REGISTRATION_NUMBER_OF_RIGHTS",name:"Регистрационный номер прав на интеллектуальную собственность",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:19,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-20",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:20,metadata:{type:"text",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-21",code:"RIGHTS_EXPIRATION_DATE",name:"Дата окончания прав на результат интеллектуальной собственностиа",description:"Тип: date, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:21,metadata:{type:"date",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-22",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Исключительные права на интеллектуальную собственность, Раздел: 4.12",isActive:!0,sortOrder:22,metadata:{type:"boolean",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12"}},{id:"attr-23",code:"NUMBER_OF_PLEDGE_ACCOUNT",name:"Номер залогового счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13, Естественный ключ",isActive:!0,sortOrder:23,metadata:{type:"text",group:"Права по договору банковского счета",required:!0,section:"4.13"}},{id:"attr-24",code:"SUM_OF_DEPOSIT",name:"Сумма депозита/вклада, передаваемая в залог",description:"Тип: number, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:24,metadata:{type:"number",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-25",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:25,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-26",code:"DATEEND_OF_ARRENGEMENT",name:"Дата окончания договора депозита/вклада",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:26,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-27",code:"NAME_OF_BANK",name:"Наименование банка, в котором открыт депозит/вклад",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:27,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-28",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:28,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-29",code:"DATE_OF_ARRENGEMENT",name:"Дата заключения договора депозита/вклада",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:29,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-30",code:"PR_OF_PLEDGE_ACCOUNT",name:"Признак наличия залогового счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:30,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-31",code:"BANK_ACCOUNT_AGREEMENT_DATE",name:"Дата договора банковского счета",description:"Тип: date, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:31,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-32",code:"BANK_ACCOUNT_AGREEMENT_NUMBER",name:"Номер договора банковского счета",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:32,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-33",code:"INFORMATION_ABOUT_AMOUNT_MONEY",name:"Сведения о денежной сумме",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:33,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-34",code:"CURRENCY_OF_SUM",name:"Валюта депозита/вклада",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:34,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-35",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:35,metadata:{type:"boolean",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-36",code:"ACC_NUM_FOR_ACC_OF_DEP",name:"Номер счета по учету депозита/вклада",description:"Тип: text, Группа: Права по договору банковского счета, Раздел: 4.13",isActive:!0,sortOrder:36,metadata:{type:"text",group:"Права по договору банковского счета",required:!1,section:"4.13"}},{id:"attr-37",code:"ID_OOO",name:"id клиента",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:37,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-38",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14, Естественный ключ",isActive:!0,sortOrder:38,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14"}},{id:"attr-39",code:"SHARE_INFORMATION",name:"Значение идентификационного кода ООО",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14, Естественный ключ",isActive:!0,sortOrder:39,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14"}},{id:"attr-40",code:"NAME_OOO",name:"Наименование ООО",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:40,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-41",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:41,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-42",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:42,metadata:{type:"boolean",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-43",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:43,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-44",code:"TYPE_CODE_OOO",name:"Тип идентификационного кода субъекта (ООО)",description:"Тип: select, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:44,metadata:{type:"select",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-45",code:"PERCENTAGE_AUTHORIZED_CAPITAL",name:"Процент уставного капитала общества с ограниченной ответственностью, который составляет доля (часть доли)",description:"Тип: number, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:45,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-46",code:"ID_OOO",name:"Идентификационный код субъекта (ООО) или ID субъекта (ООО)",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:46,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-47",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Доли в уставных капиталах обществ с ограниченной ответственностью, Раздел: 4.14",isActive:!0,sortOrder:47,metadata:{type:"text",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14"}},{id:"attr-48",code:"NUMBER_OF_VEKSEL",name:"Номер векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:48,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-49",code:"RELEASE_DATE_VEKSEL",name:"Дата выпуска векселя",description:"Тип: date, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:49,metadata:{type:"date",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-50",code:"INN_ISSUER",name:"Значение идентификационного  кода субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:50,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-51",code:"DENOMINATION_VEKSEL",name:"Номинал векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:51,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-52",code:"NUMBER_BLANK_OF_VEKSEL",name:"Номер бланка векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:52,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-53",code:"SERIA_VEKSEL",name:"Серия векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15, Естественный ключ",isActive:!0,sortOrder:53,metadata:{type:"text",group:"Векселя",required:!0,section:"4.15"}},{id:"attr-54",code:"CODE_VEKSELEDERZHATEL_NONRESIDENT",name:"Признак кода векселедержателя (собственника) нерезидента",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:54,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-55",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:55,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-56",code:"VALUE_DEPOSITORY",name:"Значение идентификационного  кода субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:56,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-57",code:"CURRENCY_CODE_VEKSEL",name:"Код валюты векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:57,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-58",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:58,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-59",code:"NAME_DEPOSITORY",name:"Наименование субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:59,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-60",code:"SUBJECT_AVALIZATION",name:"Субъект авалирования/акцептования векселя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:60,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-61",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:61,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-62",code:"NAME_ISSUER",name:"Наименование субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:62,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-63",code:"VEKSEL_TYPE",name:"Тип векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:63,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-64",code:"VEKSEL_CURRENCY",name:"Валюта векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:64,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-65",code:"VEKSELEDATEL",name:"Векселедатель",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:65,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-66",code:"VEKSELEDERZHATEL",name:"Векселедержатель",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:66,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-67",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:67,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-68",code:"PERCENT_OF_VEKSEL",name:"Процентная ставка по векселю",description:"Тип: number, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:68,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-69",code:"VEKSEL_SIGN",name:"Признак векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:69,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-70",code:"DISCOUNT_OF_VEKSEL",name:"Дисконт по векселю",description:"Тип: number, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:70,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-71",code:"MATURITY_OF_VEKSEL",name:"Срок погашения векселя",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:71,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-72",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:72,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-73",code:"PLACE_OF_COMPILATION",name:"Место составления",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:73,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-74",code:"PLACE_OF_PAYMENT",name:"Место платежа",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:74,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-75",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:75,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-76",code:"SIGN_LEGAL_VEKSELEDATEL",name:"Признак юр. лица субъекта (векселедателя)",description:"Тип: boolean, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:76,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-77",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:77,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-78",code:"VEKSEL_CONDITION",name:"Состояние векселя на отчетную дату",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:78,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-79",code:"RECEIPT_DATE",name:"Дата поступления",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:79,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-80",code:"TERM_CONDITIONS_PAYMENT",name:"Срок и условия платежа (Дата 2)",description:"Тип: date, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:80,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-81",code:"CONDITIONS_PAYMENT",name:"Условия платежа",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:81,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-82",code:"SECURITY_TYPE",name:"Код типа ценной бумаги",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:82,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-83",code:"OKSM_COUNTRY_VEKSELEDATEL",name:"Код ОКСМ страны векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:83,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-84",code:"OGRN_VEKSELEDATEL",name:"ОГРН векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:84,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-85",code:"TYPE_CODE_VEKSELEDATEL",name:"Тип идентификационного кода субъекта (векселедателя)",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:85,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-86",code:"CODE_VEKSELEDATEL_NONRESIDENT",name:"Признак кода векселедателя нерезидента",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:86,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-87",code:"SIGN_VEKSELEDATEL",name:"Признак векселедателя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:87,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-88",code:"ID_VEKSEL",name:"Идентификационный код векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:88,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-89",code:"ID_VEKSELEDATEL",name:"Идентификационный код субъекта (векселедателя)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:89,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-90",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:90,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-91",code:"TYPE_DEPOSITORY",name:"Тип идентификационного кода субъекта (депозитария)",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:91,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-92",code:"LOCATION_OF_VEKSEL",name:"Местонахождения векселя",description:"Тип: select, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:92,metadata:{type:"select",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-93",code:"ID_DEPOSITORY",name:"Идентификационный код субъекта (депозитария) или ID субъекта (депозитария)",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:93,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-94",code:"attr_94",name:"Тип векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:94,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-95",code:"attr_95",name:"Код ОКСМ страны векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:95,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-96",code:"attr_96",name:"Тип идентификационного кода векселедателя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:96,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-97",code:"RATING_VEKSEL",name:"Номинал векселя",description:"Тип: text, Группа: Векселя, Раздел: 4.15",isActive:!0,sortOrder:97,metadata:{type:"text",group:"Векселя",required:!1,section:"4.15"}},{id:"attr-98",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16, Естественный ключ",isActive:!0,sortOrder:98,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!0,section:"4.16"}},{id:"attr-99",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:99,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-100",code:"GOVERNMENT_NUM_OF_SECURITIES",name:"Государственный регистрационный номер выпуска ценных бумаг",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:100,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-101",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:101,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-102",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип: date, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:102,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-103",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:103,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-104",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:104,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-105",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:105,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-106",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:106,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-107",code:"ISSUE_SECURITY_TYPE",name:"Код типа эмиссионной ценной бумаги",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:107,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-108",code:"COUNTRY_CODE_ISSUER",name:"Код ОКСМ страны эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:108,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-109",code:"OGRN_ISSUER",name:"ОГРН эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:109,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-110",code:"KPP_ISSUER",name:"КПП эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:110,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-111",code:"CODE_ISSUER_NONRESIDENT",name:"Признак кода эмитента нерезидента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:111,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-112",code:"SIGN_ISSUER",name:"Признак эмитента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:112,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-113",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:113,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-114",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:114,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-115",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:115,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-116",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:116,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-117",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:117,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-118",code:"AMOUNT_OF_SECURITIES",name:"Количество эмиссионных ценных бумаг, шт.",description:"Тип: number, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:118,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-119",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:119,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-120",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:120,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-121",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:121,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-122",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:122,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-123",code:"ID_NUM_SECURITIES",name:"Идентификационный номер выпуска ценных бумаг",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:123,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-124",code:"CLASS_SECURITIES",name:"Класс ценной бумаги",description:"Тип: text, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:124,metadata:{type:"text",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-125",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:125,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-126",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:126,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-127",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип: select, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:127,metadata:{type:"select",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-128",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Эмиссионные ценные бумаги, Раздел: 4.16",isActive:!0,sortOrder:128,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16"}},{id:"attr-129",code:"REG_NUM_OF_PIE_FUND",name:"Регистрационный номер правил доверительного управления паевым инвестиционным фондом",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17, Естественный ключ",isActive:!0,sortOrder:129,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17"}},{id:"attr-130",code:"AMOUNT_OF_PIES",name:"Количество паев паевого инвестиционного фонда, шт.",description:"Тип: number, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17, Естественный ключ",isActive:!0,sortOrder:130,metadata:{type:"number",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17"}},{id:"attr-131",code:"DATE_END_CONTRACT_OF_PIE_FUND",name:"Дата окончания срока действия договора доверительного управления паевым инвестиционным фондом",description:"Тип: date, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:131,metadata:{type:"date",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-132",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:132,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-133",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:133,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-134",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:134,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-135",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:135,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-136",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:136,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-137",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:137,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-138",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:138,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-139",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Инвестиционные паи (паи инвестиционных фондов), Раздел: 4.17",isActive:!0,sortOrder:139,metadata:{type:"text",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17"}},{id:"attr-140",code:"IND_DES_OF_MORTG_PART_CERT",name:"Индивидуальное обозначение ипотечных сертификатов участия",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18, Естественный ключ",isActive:!0,sortOrder:140,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!0,section:"4.18"}},{id:"attr-141",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:141,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-142",code:"DATE_END_TERM_CONTRACT_TRUST_MANAGEMENT_MORTGAGE_COVERAGE",name:"Дата окончания срока действия договора доверительного управления ипотечным покрытием",description:"Тип: date, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:142,metadata:{type:"date",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-143",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:143,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-144",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:144,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-145",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:145,metadata:{type:"boolean",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-146",code:"NUM_OF_MORTG_PART_CERTIF",name:"Количество ипотечных сертификатов участия, шт.",description:"Тип: number, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:146,metadata:{type:"number",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-147",code:"REGISTR_NUM",name:"Регистрационный номер правил доверительного управления ипотечным покрытием",description:"Тип: text, Группа: Ипотечные сертификаты участия, Раздел: 4.18",isActive:!0,sortOrder:147,metadata:{type:"text",group:"Ипотечные сертификаты участия",required:!1,section:"4.18"}},{id:"attr-148",code:"SERIA_SEC_PAPER",name:"Серия ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19, Естественный ключ",isActive:!0,sortOrder:148,metadata:{type:"text",group:"Прочие ценные бумаги",required:!0,section:"4.19"}},{id:"attr-149",code:"NUM_SECURITIES",name:"Номер ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19, Естественный ключ",isActive:!0,sortOrder:149,metadata:{type:"text",group:"Прочие ценные бумаги",required:!0,section:"4.19"}},{id:"attr-150",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:150,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-151",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:151,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-152",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:152,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-153",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:153,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-154",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:154,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-155",code:"AMOUNT_SHARE",name:"Количество ценных бумаг, шт.",description:"Тип: number, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:155,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-156",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:156,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-157",code:"TYPE_SECURITIES",name:"Вид ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:157,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-158",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип: number, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:158,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-159",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:159,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-160",code:"ISIN",name:"Код ISIN",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:160,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-161",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:161,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-162",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:162,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-163",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:163,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-164",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:164,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-165",code:"DATE_END",name:"Дата окончания",description:"Тип: date, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:165,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-166",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:166,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-167",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:167,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-168",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип: date, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:168,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-169",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип: boolean, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:169,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-170",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:170,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-171",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип: select, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:171,metadata:{type:"select",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-172",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:172,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-173",code:"attr_173",name:"Код ОКСМ страны эмитента",description:"Тип: text, Группа: Прочие ценные бумаги, Раздел: 4.19",isActive:!0,sortOrder:173,metadata:{type:"text",group:"Прочие ценные бумаги",required:!1,section:"4.19"}},{id:"attr-174",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2, Естественный ключ",isActive:!0,sortOrder:174,metadata:{type:"text",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!0,section:"4.2"}},{id:"attr-175",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:175,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-176",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:176,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-177",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Недвижимое имущество и права аренды недвижимого имущества, Раздел: 4.2",isActive:!0,sortOrder:177,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2"}},{id:"attr-178",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20, Естественный ключ",isActive:!0,sortOrder:178,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!0,section:"4.20"}},{id:"attr-179",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20, Естественный ключ",isActive:!0,sortOrder:179,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!0,section:"4.20"}},{id:"attr-180",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:180,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-181",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:181,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-182",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:182,metadata:{type:"boolean",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-183",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:183,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-184",code:"DATE_CONTRACT",name:"Дата договора/ контакта/ доп соглашения",description:"Тип: date, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:184,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-185",code:"SUBJECT_OF_CONTRACT",name:"Предмет контракта/договора",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:185,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-186",code:"COUNTERPARTY_UNDER_CONTRACT",name:"Контрагент по договору/контракту",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:186,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-187",code:"NUMBER_CONTRACT",name:"Номер договора/контракта/доп. соглашения",description:"Тип: text, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:187,metadata:{type:"text",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-188",code:"DATE_END_CONTRACT",name:"Дата окончания срока действия договора/ контракта/ доп соглашения",description:"Тип: date, Группа: Прочие имущественные Права требования, Раздел: 4.20",isActive:!0,sortOrder:188,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20"}},{id:"attr-189",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Здание, Раздел: 4.2.1, Естественный ключ",isActive:!0,sortOrder:189,metadata:{type:"text",group:"Здание",required:!0,section:"4.2.1"}},{id:"attr-190",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:190,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-191",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:191,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-192",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:192,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-193",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:193,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-194",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:194,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-195",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:195,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-196",code:"STREET",name:"Улица",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:196,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-197",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:197,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-198",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:198,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-199",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:199,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-200",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:200,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-201",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:201,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-202",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:202,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-203",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:203,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-204",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:204,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-205",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:205,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-206",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:206,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-207",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:207,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-208",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:208,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-209",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:209,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-210",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:210,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-211",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:211,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-212",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:212,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-213",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:213,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-214",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:214,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-215",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:215,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-216",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:216,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-217",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:217,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-218",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:218,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-219",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:219,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-220",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:220,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-221",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:221,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-222",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:222,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-223",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:223,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-224",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:224,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-225",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:225,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-226",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:226,metadata:{type:"select",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-227",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:227,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-228",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:228,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-229",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:229,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-230",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:230,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-231",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:231,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-232",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:232,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-233",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:233,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-234",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:234,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-235",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:235,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-236",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:236,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-237",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:237,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-238",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:238,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-239",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:239,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-240",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:240,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-241",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:241,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-242",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:242,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-243",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:243,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-244",code:"REGION",name:"Регион",description:"Тип: text, Группа: Здание, Раздел: 4.2.1",isActive:!0,sortOrder:244,metadata:{type:"text",group:"Здание",required:!1,section:"4.2.1"}},{id:"attr-245",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21, Естественный ключ",isActive:!0,sortOrder:245,metadata:{type:"text",group:"Прочие движимые вещи",required:!0,section:"4.21"}},{id:"attr-246",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21, Естественный ключ",isActive:!0,sortOrder:246,metadata:{type:"text",group:"Прочие движимые вещи",required:!0,section:"4.21"}},{id:"attr-247",code:"LOCATION_OTHER_MOVABLE_PROPERTY",name:"Местонахождение прочего движимого имущества",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:247,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-248",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:248,metadata:{type:"boolean",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-249",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:249,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-250",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Прочие движимые вещи, Раздел: 4.21",isActive:!0,sortOrder:250,metadata:{type:"text",group:"Прочие движимые вещи",required:!1,section:"4.21"}},{id:"attr-251",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2, Естественный ключ",isActive:!0,sortOrder:251,metadata:{type:"text",group:"Сооружение",required:!0,section:"4.2.2"}},{id:"attr-252",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:252,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-253",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:253,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-254",code:"STREET",name:"Улица",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:254,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-255",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:255,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-256",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:256,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-257",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:257,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-258",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:258,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-259",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:259,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-260",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:260,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-261",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:261,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-262",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:262,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-263",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:263,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-264",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:264,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-265",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:265,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-266",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:266,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-267",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:267,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-268",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:268,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-269",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:269,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-270",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:270,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-271",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:271,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-272",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:272,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-273",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:273,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-274",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:274,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-275",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:275,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-276",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:276,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-277",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:277,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-278",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:278,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-279",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:279,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-280",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:280,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-281",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:281,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-282",code:"REGION",name:"Регион",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:282,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-283",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:283,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-284",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:284,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-285",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:285,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-286",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:286,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-287",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:287,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-288",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:288,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-289",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:289,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-290",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:290,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-291",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:291,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-292",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:292,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-293",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:293,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-294",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:294,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-295",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:295,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-296",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:296,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-297",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:297,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-298",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:298,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-299",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:299,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-300",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:300,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-301",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:301,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-302",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:302,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-303",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:303,metadata:{type:"select",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-304",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:304,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-305",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:305,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-306",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Сооружение, Раздел: 4.2.2",isActive:!0,sortOrder:306,metadata:{type:"text",group:"Сооружение",required:!1,section:"4.2.2"}},{id:"attr-307",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3, Естественный ключ",isActive:!0,sortOrder:307,metadata:{type:"text",group:"Помещение",required:!0,section:"4.2.3"}},{id:"attr-308",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:308,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-309",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:309,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-310",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:310,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-311",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:311,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-312",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:312,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-313",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:313,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-314",code:"REGION",name:"Регион",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:314,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-315",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:315,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-316",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:316,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-317",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:317,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-318",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:318,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-319",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:319,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-320",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:320,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-321",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:321,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-322",code:"STREET",name:"Улица",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:322,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-323",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:323,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-324",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:324,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-325",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:325,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-326",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:326,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-327",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:327,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-328",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:328,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-329",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:329,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-330",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:330,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-331",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:331,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-332",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:332,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-333",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:333,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-334",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:334,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-335",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:335,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-336",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:336,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-337",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:337,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-338",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:338,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-339",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:339,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-340",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:340,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-341",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:341,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-342",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:342,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-343",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:343,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-344",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:344,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-345",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:345,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-346",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:346,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-347",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:347,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-348",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:348,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-349",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:349,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-350",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:350,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-351",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:351,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-352",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:352,metadata:{type:"select",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-353",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:353,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-354",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:354,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-355",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:355,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-356",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:356,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-357",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:357,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-358",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:358,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-359",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:359,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-360",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:360,metadata:{type:"text",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-361",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:361,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-362",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Помещение, Раздел: 4.2.3",isActive:!0,sortOrder:362,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3"}},{id:"attr-363",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4, Естественный ключ",isActive:!0,sortOrder:363,metadata:{type:"text",group:"Машино-место",required:!0,section:"4.2.4"}},{id:"attr-364",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:364,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-365",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:365,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-366",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:366,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-367",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:367,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-368",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:368,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-369",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:369,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-370",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:370,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-371",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:371,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-372",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:372,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-373",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:373,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-374",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:374,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-375",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:375,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-376",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:376,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-377",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:377,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-378",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:378,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-379",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:379,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-380",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:380,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-381",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:381,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-382",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:382,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-383",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:383,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-384",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:384,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-385",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:385,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-386",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:386,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-387",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:387,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-388",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:388,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-389",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:389,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-390",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:390,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-391",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:391,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-392",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:392,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-393",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:393,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-394",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:394,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-395",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:395,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-396",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:396,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-397",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:397,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-398",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:398,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-399",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:399,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-400",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:400,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-401",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:401,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-402",code:"STREET",name:"Улица",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:402,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-403",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:403,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-404",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:404,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-405",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:405,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-406",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:406,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-407",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:407,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-408",code:"REGION",name:"Регион",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:408,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-409",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:409,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-410",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:410,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-411",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:411,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-412",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:412,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-413",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:413,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-414",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:414,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-415",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:415,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-416",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:416,metadata:{type:"text",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-417",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:417,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-418",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Машино-место, Раздел: 4.2.4",isActive:!0,sortOrder:418,metadata:{type:"select",group:"Машино-место",required:!1,section:"4.2.4"}},{id:"attr-419",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5, Естественный ключ",isActive:!0,sortOrder:419,metadata:{type:"text",group:"Объект незавершенного строительства",required:!0,section:"4.2.5"}},{id:"attr-420",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:420,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-421",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:421,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-422",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:422,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-423",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:423,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-424",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:424,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-425",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:425,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-426",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:426,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-427",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:427,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-428",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:428,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-429",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:429,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-430",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:430,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-431",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:431,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-432",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:432,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-433",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:433,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-434",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:434,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-435",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:435,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-436",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:436,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-437",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:437,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-438",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:438,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-439",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:439,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-440",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:440,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-441",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:441,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-442",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:442,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-443",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:443,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-444",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:444,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-445",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:445,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-446",code:"REGION",name:"Регион",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:446,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-447",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:447,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-448",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:448,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-449",code:"STREET",name:"Улица",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:449,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-450",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:450,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-451",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:451,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-452",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:452,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-453",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:453,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-454",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:454,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-455",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:455,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-456",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:456,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-457",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:457,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-458",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:458,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-459",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:459,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-460",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:460,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-461",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:461,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-462",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:462,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-463",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:463,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-464",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:464,metadata:{type:"select",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-465",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:465,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-466",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:466,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-467",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:467,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-468",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:468,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-469",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:469,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-470",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:470,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-471",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:471,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-472",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:472,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-473",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:473,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-474",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Объект незавершенного строительства, Раздел: 4.2.5",isActive:!0,sortOrder:474,metadata:{type:"text",group:"Объект незавершенного строительства",required:!1,section:"4.2.5"}},{id:"attr-475",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6, Естественный ключ",isActive:!0,sortOrder:475,metadata:{type:"text",group:"Земельный участок",required:!0,section:"4.2.6"}},{id:"attr-476",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:476,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-477",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:477,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-478",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:478,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-479",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:479,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-480",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:480,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-481",code:"TYPE_OF_USE_OF_THE_LAND",name:"Вид разрешенного использования земельного участка",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:481,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-482",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:482,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-483",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:483,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-484",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:484,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-485",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:485,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-486",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:486,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-487",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:487,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-488",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:488,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-489",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:489,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-490",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:490,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-491",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:491,metadata:{type:"select",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-492",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:492,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-493",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:493,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-494",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:494,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-495",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:495,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-496",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:496,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-497",code:"AREA_DEVIATION",name:"Отклонение площади, +/-, (м²)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:497,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-498",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:498,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-499",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:499,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-500",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:500,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-501",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:501,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-502",code:"BUILDINGS_NOT_INCLUDED",name:"Признак наличия на земельном участке зданий/ строений/ сооружений Залогодателя, не включенных в предмет ипотеки",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:502,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-503",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:503,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-504",code:"NAME_LANDLORD",name:"Наименование арендодателя",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:504,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-505",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:505,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-506",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:506,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-507",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:507,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-508",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:508,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-509",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:509,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-510",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:510,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-511",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:511,metadata:{type:"select",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-512",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:512,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-513",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:513,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-514",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:514,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-515",code:"REGION",name:"Регион",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:515,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-516",code:"STREET",name:"Улица",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:516,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-517",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:517,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-518",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:518,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-519",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:519,metadata:{type:"text",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-520",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:520,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-521",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:521,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-522",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Земельный участок, Раздел: 4.2.6",isActive:!0,sortOrder:522,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6"}},{id:"attr-523",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7, Естественный ключ",isActive:!0,sortOrder:523,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!0,section:"4.2.7"}},{id:"attr-524",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:524,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-525",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:525,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-526",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:526,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-527",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:527,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-528",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:528,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-529",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:529,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-530",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:530,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-531",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:531,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-532",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:532,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-533",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:533,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-534",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:534,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-535",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:535,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-536",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:536,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-537",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:537,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-538",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:538,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-539",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:539,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-540",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:540,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-541",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:541,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-542",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:542,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-543",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:543,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-544",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:544,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-545",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:545,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-546",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:546,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-547",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:547,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-548",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:548,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-549",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:549,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-550",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:550,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-551",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:551,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-552",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:552,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-553",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:553,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-554",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:554,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-555",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:555,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-556",code:"STREET",name:"Улица",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:556,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-557",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:557,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-558",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:558,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-559",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:559,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-560",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:560,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-561",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:561,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-562",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:562,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-563",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:563,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-564",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:564,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-565",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:565,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-566",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:566,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-567",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:567,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-568",code:"REGION",name:"Регион",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:568,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-569",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:569,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-570",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:570,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-571",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:571,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-572",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:572,metadata:{type:"select",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-573",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:573,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-574",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:574,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-575",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:575,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-576",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:576,metadata:{type:"text",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-577",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:577,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-578",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Единый недвижимый комплекс, Раздел: 4.2.7",isActive:!0,sortOrder:578,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7"}},{id:"attr-579",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8, Естественный ключ",isActive:!0,sortOrder:579,metadata:{type:"text",group:"Имущественный комплекс",required:!0,section:"4.2.8"}},{id:"attr-580",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:580,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-581",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:581,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-582",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:582,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-583",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:583,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-584",code:"INDEX",name:"Индекс",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:584,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-585",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:585,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-586",code:"CITY",name:"Город/населенный пункт",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:586,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-587",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:587,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-588",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:588,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-589",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:589,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-590",code:"BUILDING",name:"дом",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:590,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-591",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:591,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-592",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:592,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-593",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:593,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-594",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:594,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-595",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:595,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-596",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:596,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-597",code:"ROOM",name:"Квартира",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:597,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-598",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:598,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-599",code:"ADDR_STR",name:"Адрес строкой",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:599,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-600",code:"REGION",name:"Регион",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:600,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-601",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:601,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-602",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:602,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-603",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:603,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-604",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:604,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-605",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:605,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-606",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:606,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-607",code:"VOLUME",name:"Объём (м3)",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:607,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-608",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:608,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-609",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:609,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-610",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:610,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-611",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:611,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-612",code:"STRUCTURE",name:"Строение",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:612,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-613",code:"FINANCIAL_MODEL_VALUATION",name:"Оценка с учетом финансовой модели заемщика ('N' - нет, 'Y' - да)",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:613,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-614",code:"STREET",name:"Улица",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:614,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-615",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:615,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-616",code:"FLOOR",name:"Этаж расположения",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:616,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-617",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:617,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-618",code:"CODE_FIAS",name:"Код фиас",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:618,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-619",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип: date, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:619,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-620",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:620,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-621",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:621,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-622",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:622,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-623",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:623,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-624",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:624,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-625",code:"SPREAD",name:"Протяженность (м)",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:625,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-626",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип: select, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:626,metadata:{type:"select",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-627",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:627,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-628",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:628,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-629",code:"LETTER",name:"Литера",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:629,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-630",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:630,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-631",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:631,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-632",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:632,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-633",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип: text, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:633,metadata:{type:"text",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-634",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип: number, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:634,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-635",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип: boolean, Группа: Имущественный комплекс, Раздел: 4.2.8",isActive:!0,sortOrder:635,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8"}},{id:"attr-636",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:636,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-637",code:"VIN",name:"VIN",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:637,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-638",code:"FRAME_CHASSIS_NUMBER",name:"Номер шасси/рамы",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3, Естественный ключ",isActive:!0,sortOrder:638,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3"}},{id:"attr-639",code:"MILEAGE",name:"Пробег, км",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:639,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-640",code:"COLOR_BODY",name:"Цвет кузова (кабины)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:640,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-641",code:"PRICE_OF_NEW_CAR",name:"Цена нового ТС",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:641,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-642",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:642,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-643",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:643,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-644",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:644,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-645",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:645,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-646",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:646,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-647",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:647,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-648",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:648,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-649",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:649,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-650",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:650,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-651",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:651,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-652",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:652,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-653",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:653,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-654",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:654,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-655",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:655,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-656",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:656,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-657",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:657,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-658",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:658,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-659",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:659,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-660",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:660,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-661",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:661,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-662",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:662,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-663",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:663,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-664",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:664,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-665",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:665,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-666",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:666,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-667",code:"ENGINE_VOLUME_SM",name:"Объем двигателя, см3",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:667,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-668",code:"BODY_NUMBER",name:"Номер кузова (кабины, прицепа)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:668,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-669",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:669,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-670",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:670,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-671",code:"MOTOR_NUMBER",name:"Номер двигателя",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:671,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-672",code:"NAME_OF_CERTIFICATE_TS",name:"Наименование свидетельства о регистрации ТС",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:672,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-673",code:"NAME_OF_TS",name:"Наименование паспорта ТС",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:673,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-674",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:674,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-675",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:675,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-676",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:676,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-677",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:677,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-678",code:"BRAND",name:"Марка",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:678,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-679",code:"COUNT_RTA",name:"Количество ДТП",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:679,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-680",code:"ACCIDENT_INVESTIGATION",name:"Следствие ДТП",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:680,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-681",code:"COLLATERAL_CONDITION",name:"Состояние ПЗ",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:681,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-682",code:"IDENTIFIED_DEFECTS",name:"Выявленные дефекты",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:682,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-683",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:683,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-684",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:684,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-685",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:685,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-686",code:"DATE_OF_CERTIFICATE_TS",name:"Дата свидетельства о регистрации ТС",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:686,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-687",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:687,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-688",code:"DATE_OF_PASSPORT_TS",name:"Дата паспорта ТС",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:688,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-689",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:689,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-690",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:690,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-691",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:691,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-692",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:692,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-693",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:693,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-694",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:694,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-695",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:695,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-696",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:696,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-697",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:697,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-698",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:698,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-699",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:699,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-700",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:700,metadata:{type:"select",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-701",code:"TYPE_INCIDENTS",name:"Тип происшествия",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:701,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-702",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:702,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-703",code:"MOTOR_TYPE",name:"Тип двигателя",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:703,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-704",code:"SERIA_NUMBER_OF_CERTIFICATE_TS",name:"Серия и номер свидетельства о регистрации ТС",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:704,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-705",code:"SERIAS_NUMBER_PASSPORT_TS",name:"Серия и номер паспорта ТС",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:705,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-706",code:"STATE",name:"Состояние",description:"Тип: text, Группа: Наземные безрельсовые механические транспортные средства, прицепы, Раздел: 4.3",isActive:!0,sortOrder:706,metadata:{type:"text",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3"}},{id:"attr-707",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:707,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-708",code:"PSEUDO_KEY",name:"Операция между группой 1 и 2(псевдо атрибут)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:708,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-709",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:709,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-710",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4, Естественный ключ",isActive:!0,sortOrder:710,metadata:{type:"text",group:"Машины и оборудование",required:!0,section:"4.4"}},{id:"attr-711",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:711,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-712",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:712,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-713",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:713,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-714",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:714,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-715",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:715,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-716",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:716,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-717",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:717,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-718",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:718,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-719",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:719,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-720",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:720,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-721",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:721,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-722",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:722,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-723",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:723,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-724",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:724,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-725",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:725,metadata:{type:"select",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-726",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:726,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-727",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:727,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-728",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:728,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-729",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:729,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-730",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:730,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-731",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:731,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-732",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:732,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-733",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:733,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-734",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:734,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-735",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:735,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-736",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:736,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-737",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:737,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-738",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:738,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-739",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:739,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-740",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:740,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-741",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:741,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-742",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:742,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-743",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:743,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-744",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:744,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-745",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:745,metadata:{type:"select",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-746",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:746,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-747",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:747,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-748",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:748,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-749",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:749,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-750",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:750,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-751",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:751,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-752",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:752,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-753",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:753,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-754",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:754,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-755",code:"BRAND",name:"Марка",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:755,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-756",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Машины и оборудование, Раздел: 4.4",isActive:!0,sortOrder:756,metadata:{type:"text",group:"Машины и оборудование",required:!1,section:"4.4"}},{id:"attr-757",code:"SERIAL_FACTORY_NUMBER",name:"Серийный (заводской) номер",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5, Естественный ключ",isActive:!0,sortOrder:757,metadata:{type:"text",group:"Воздушные суда",required:!0,section:"4.5"}},{id:"attr-758",code:"GLIDER_NUMBER",name:"Номер планера",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:758,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-759",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:759,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-760",code:"NAME_OF_MANUFACTURER",name:"Наименование изготовителя",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:760,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-761",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:761,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-762",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:762,metadata:{type:"boolean",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-763",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:763,metadata:{type:"number",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-764",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:764,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-765",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Воздушные суда, Раздел: 4.5",isActive:!0,sortOrder:765,metadata:{type:"text",group:"Воздушные суда",required:!1,section:"4.5"}},{id:"attr-766",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Плавучие сооружения, Раздел: 4.6, Естественный ключ",isActive:!0,sortOrder:766,metadata:{type:"text",group:"Плавучие сооружения",required:!0,section:"4.6"}},{id:"attr-767",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Плавучие сооружения, Раздел: 4.6, Естественный ключ",isActive:!0,sortOrder:767,metadata:{type:"text",group:"Плавучие сооружения",required:!0,section:"4.6"}},{id:"attr-768",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2, Естественный ключ",isActive:!0,sortOrder:768,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!0,section:"4.6.2"}},{id:"attr-769",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:769,metadata:{type:"number",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-770",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:770,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-771",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:771,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-772",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:772,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-773",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:773,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-774",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:774,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-775",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:775,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-776",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:776,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-777",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:777,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-778",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов, Раздел: 4.6.2",isActive:!0,sortOrder:778,metadata:{type:"text",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2"}},{id:"attr-779",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:779,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-780",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:780,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-781",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:781,metadata:{type:"number",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-782",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:782,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-783",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:783,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-784",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:784,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-785",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4, Естественный ключ",isActive:!0,sortOrder:785,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!0,section:"4.6.4"}},{id:"attr-786",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:786,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-787",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:787,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-788",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:788,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-789",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для иных целей, Раздел: 4.6.4",isActive:!0,sortOrder:789,metadata:{type:"text",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4"}},{id:"attr-790",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:790,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-791",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:791,metadata:{type:"number",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-792",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:792,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-793",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:793,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-794",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:794,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-795",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:795,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-796",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3, Естественный ключ",isActive:!0,sortOrder:796,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!0,section:"4.6.3"}},{id:"attr-797",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:797,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-798",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:798,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-799",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:799,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-800",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для рыболовства, Раздел: 4.6.3",isActive:!0,sortOrder:800,metadata:{type:"text",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3"}},{id:"attr-801",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:801,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-802",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:802,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-803",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:803,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-804",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:804,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-805",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5, Естественный ключ",isActive:!0,sortOrder:805,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!0,section:"4.6.5"}},{id:"attr-806",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:806,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-807",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:807,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-808",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:808,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-809",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:809,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-810",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:810,metadata:{type:"text",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-811",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Плавучие сооружения, не являющиеся судами, Раздел: 4.6.5",isActive:!0,sortOrder:811,metadata:{type:"number",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5"}},{id:"attr-812",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:812,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-813",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:813,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-814",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:814,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-815",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:815,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-816",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:816,metadata:{type:"number",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-817",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:817,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-818",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1, Естественный ключ",isActive:!0,sortOrder:818,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!0,section:"4.6.1"}},{id:"attr-819",code:"PASSENGER_CAPACITY_OF_THE_VESSEL",name:"Пассажировместимость судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:819,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-820",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:820,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-821",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:821,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-822",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:822,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-823",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:823,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-824",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:824,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-825",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:825,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-826",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:826,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-827",code:"NAME_OF_OTHER_TYPE",name:"Наименование иного типа маломерного судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:827,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-828",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:828,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-829",code:"LENGTH_SHIP",name:"Длина судна в метрах",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:829,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-830",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:830,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-831",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:831,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-832",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:832,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-833",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:833,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-834",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:834,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-835",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:835,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-836",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:836,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-837",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:837,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-838",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:838,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-839",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:839,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-840",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:840,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-841",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:841,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-842",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:842,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-843",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:843,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-844",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:844,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-845",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:845,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-846",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:846,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-847",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:847,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-848",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:848,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-849",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:849,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-850",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:850,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-851",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:851,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-852",code:"WEIGHT_OF_SHIP",name:"Масса судна в кг",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:852,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-853",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:853,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-854",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:854,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-855",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Суда, используемые для перевозки пассажиров и их багажа, Раздел: 4.6.1",isActive:!0,sortOrder:855,metadata:{type:"text",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1"}},{id:"attr-856",code:"NET_ADDRESS",name:"Сетевой номер",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7, Естественный ключ",isActive:!0,sortOrder:856,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!0,section:"4.7"}},{id:"attr-857",code:"RZHD_MPS",name:"Заводской номер/ номер РЖД/МПС",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7, Естественный ключ",isActive:!0,sortOrder:857,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!0,section:"4.7"}},{id:"attr-858",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:858,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-859",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:859,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-860",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:860,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-861",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип: number, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:861,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-862",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:862,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-863",code:"MODEL",name:"Модель",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:863,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-864",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:864,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-865",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:865,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-866",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:866,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-867",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:867,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-868",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:868,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-869",code:"DATE_WAGON_TECHNICAL_PASSPORT",name:"Дата технического паспорта вагона",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:869,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-870",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:870,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-871",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:871,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-872",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:872,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-873",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:873,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-874",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:874,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-875",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:875,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-876",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип: date, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:876,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-877",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:877,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-878",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:878,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-879",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:879,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-880",code:"WAGON_TECHNICAL_PASSPORT_NUMBER",name:"Номер технического паспорта вагона",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:880,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-881",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:881,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-882",code:"ADDRESS_LOCATION",name:"Адрес места нахождения (депо приписки)",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:882,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-883",code:"CARRIAGE_NUMBER",name:"Номер вагона",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:883,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-884",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип: text, Группа: Железнодорожный подвижной состав, Раздел: 4.7",isActive:!0,sortOrder:884,metadata:{type:"text",group:"Железнодорожный подвижной состав",required:!1,section:"4.7"}},{id:"attr-885",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8, Естественный ключ",isActive:!0,sortOrder:885,metadata:{type:"text",group:"Космические объекты",required:!0,section:"4.8"}},{id:"attr-886",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:886,metadata:{type:"boolean",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-887",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип: number, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:887,metadata:{type:"number",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-888",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:888,metadata:{type:"text",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-889",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Космические объекты, Раздел: 4.8",isActive:!0,sortOrder:889,metadata:{type:"text",group:"Космические объекты",required:!1,section:"4.8"}},{id:"attr-890",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:890,metadata:{type:"text",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-891",code:"NUMBER_OF_PRODUCT_UNITS",name:"Количество единиц измерения товара",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:891,metadata:{type:"number",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-892",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9, Естественный ключ",isActive:!0,sortOrder:892,metadata:{type:"text",group:"Товары в обороте",required:!0,section:"4.9"}},{id:"attr-893",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:893,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-894",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:894,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-895",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:895,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-896",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:896,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-897",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:897,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-898",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:898,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-899",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:899,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-900",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:900,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-901",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:901,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-902",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:902,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-903",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:903,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-904",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:904,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-905",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:905,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-906",code:"UNIT",name:"Единица измерения товара",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:906,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-907",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:907,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-908",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:908,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-909",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:909,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-910",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип: date, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:910,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-911",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:911,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-912",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:912,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-913",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип: date, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:913,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-914",code:"COST_PER_UNIT_OF_MEASURE_GOODS",name:"Стоимость за единицу измерения товара в руб.",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:914,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-915",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:915,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-916",code:"STORAGE_SPACE",name:"Количество места хранения",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:916,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-917",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:917,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-918",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип: select, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:918,metadata:{type:"select",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-919",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:919,metadata:{type:"boolean",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-920",code:"NUMBER_OF_STORAGE_LOCATIONS",name:"Количество мест хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:920,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-921",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип: select, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:921,metadata:{type:"select",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-922",code:"ACTUAL_BALANCE_OF_GOODS",name:"Фактический остаток товара, тыс.руб.",description:"Тип: number, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:922,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-923",code:"VENDOR_CODE",name:"Артикул",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:923,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-924",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип: text, Группа: Товары в обороте, Раздел: 4.9",isActive:!0,sortOrder:924,metadata:{type:"text",group:"Товары в обороте",required:!1,section:"4.9"}},{id:"attr-925",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип: text, Группа: Все имущество залогодателя, Естественный ключ",isActive:!0,sortOrder:925,metadata:{type:"text",group:"Все имущество залогодателя",required:!0,section:""}},{id:"attr-926",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип: text, Группа: Все имущество залогодателя, Естественный ключ",isActive:!0,sortOrder:926,metadata:{type:"text",group:"Все имущество залогодателя",required:!0,section:""}},{id:"attr-927",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип: boolean, Группа: Все имущество залогодателя",isActive:!0,sortOrder:927,metadata:{type:"boolean",group:"Все имущество залогодателя",required:!1,section:""}},{id:"attr-928",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип: text, Группа: Все имущество залогодателя",isActive:!0,sortOrder:928,metadata:{type:"text",group:"Все имущество залогодателя",required:!1,section:""}},{id:"attr-929",code:"id",name:"Идентификатор кредитной операции",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:929,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-930",code:"operationType",name:"Тип кредитной операции(сделка,лимит и пр)",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:930,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-931",code:"salePoint",name:"Точка продаж",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:931,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-932",code:"_",name:"Сегмент бизнеса",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:932,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-933",code:"___",name:"Сотрудник инициирующего подразделения (исполнитель) (КМ)",description:"Тип: text, Группа: сделка",isActive:!0,sortOrder:933,metadata:{type:"text",group:"сделка",required:!1,section:""}},{id:"attr-934",code:"_____",name:"Признак: объект залога является элементом группы",description:"Тип: boolean, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:934,metadata:{type:"boolean",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-935",code:"attr_935",name:"Группа",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:935,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-936",code:"type",name:"Вид/тип обеспечения",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:936,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-937",code:"collateralGuids",name:"Предмет залога",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:937,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-938",code:"status",name:"Статус",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:938,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-939",code:"category",name:"Категория Качества",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:939,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-940",code:"нет (рассмотреть перенос в динамические)",name:"Признак обеспечения",description:"Тип: boolean, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:940,metadata:{type:"boolean",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-941",code:"нет (рассмотреть перенос в динамические)",name:"Причины невозможности учета обеспечения для целей Инструкции о формировании РВПС",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:941,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-942",code:"нет (рассмотреть перенос в динамические)",name:"Залог выступает обеспечением обязательств",description:"Тип: text, Группа: Предметы обеспечения(залоги)",isActive:!0,sortOrder:942,metadata:{type:"text",group:"Предметы обеспечения(залоги)",required:!1,section:""}},{id:"attr-943",code:"id",name:"ID Залогодателя",description:"Тип: date, Группа: Владельцы",isActive:!0,sortOrder:943,metadata:{type:"date",group:"Владельцы",required:!1,section:""}},{id:"attr-944",code:"signLegal",name:"Признак юридического лица",description:"Тип: boolean, Группа: Владельцы",isActive:!0,sortOrder:944,metadata:{type:"boolean",group:"Владельцы",required:!1,section:""}},{id:"attr-945",code:"basicType",name:"Право владения",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:945,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-946",code:"additionalType",name:"Вид иного права",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:946,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-947",code:"share",name:"Размер доли в праве общей долевой собственности",description:"Тип: text, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:947,metadata:{type:"text",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-948",code:"rentDueDate",name:"Дата окончания срока аренды",description:"Тип: date, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:948,metadata:{type:"date",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-949",code:"isPrimaryOwner",name:"Признак основного владельца",description:"Тип: boolean, Группа: Владельцы. Информация о праве владения",isActive:!0,sortOrder:949,metadata:{type:"boolean",group:"Владельцы. Информация о праве владения",required:!1,section:""}},{id:"attr-950",code:"name",name:"Наименование документа-основания возникновения права владения у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:950,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-951",code:"number",name:"Номер документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:951,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-952",code:"startDate",name:"Дата документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:952,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-953",code:"dueDate",name:"Дата окончания документа-основания возникновения права владения  у Залогодателя",description:"Тип: date, Группа: Владельцы. Информация о праве владения. Документы",isActive:!0,sortOrder:953,metadata:{type:"date",group:"Владельцы. Информация о праве владения. Документы",required:!1,section:""}},{id:"attr-954",code:"basicType",name:"Вид обременения",description:"Тип: text, Группа: Внешние обременения",isActive:!0,sortOrder:954,metadata:{type:"text",group:"Внешние обременения",required:!1,section:""}},{id:"attr-955",code:"additionalType",name:"Вид иного обременения",description:"Тип: text, Группа: Внешние обременения",isActive:!0,sortOrder:955,metadata:{type:"text",group:"Внешние обременения",required:!1,section:""}},{id:"attr-956",code:"name",name:"Наименование документа, порождающего обременение",description:"Тип: text, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:956,metadata:{type:"text",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-957",code:"number",name:"Номер документа, порождающего обременение",description:"Тип: text, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:957,metadata:{type:"text",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-958",code:"startDate",name:"Дата документа, порождающего обременение",description:"Тип: date, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:958,metadata:{type:"date",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-959",code:"dueDate",name:"Дата окончания документа, порождающего обременение",description:"Тип: date, Группа: Внешние обременения. Документы",isActive:!0,sortOrder:959,metadata:{type:"date",group:"Внешние обременения. Документы",required:!1,section:""}},{id:"attr-960",code:"name",name:"Полное наименование стороны по документу, порождающему обременение",description:"Тип: text, Группа: Внешние обременения. Субьект",isActive:!0,sortOrder:960,metadata:{type:"text",group:"Внешние обременения. Субьект",required:!1,section:""}},{id:"attr-961",code:"itin",name:"ИНН стороны по документу, порождающему обременение",description:"Тип: text, Группа: Внешние обременения. Субьект",isActive:!0,sortOrder:961,metadata:{type:"text",group:"Внешние обременения. Субьект",required:!1,section:""}},{id:"attr-962",code:"valuationSubject.name",name:"Субъект оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:962,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-963",code:"evaluator.name",name:"Наименование оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:963,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-964",code:"evaluator.inn",name:"ИНН оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:964,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-965",code:"evaluator.reportNumber",name:"Номер отчета об оценке оценщика",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:965,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-966",code:"evaluator.reportDate",name:"Дата отчета об оценке оценщика",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:966,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-967",code:"assessmentSubject.name",name:"Субъект экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:967,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-968",code:"__",name:"Сотрудник проводивший оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:968,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-969",code:"____",name:"Наименование структурного подразделения Банка, проводившего оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:969,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-970",code:"valuationDate",name:"Дата оценки",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:970,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-971",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:971,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-972",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:972,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-973",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:973,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-974",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:974,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-975",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:975,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-976",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:976,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-977",code:"marketValues.type",name:"Тип стоимости (рыночная, ликвидационная, инвестиционная, справедливая, залоговая, кадастровая)",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:977,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-978",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:978,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-979",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:979,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-980",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:980,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-981",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:981,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-982",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:982,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-983",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:983,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-984",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:984,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-985",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:985,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-986",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:986,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-987",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:987,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-988",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:988,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-989",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:989,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-990",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:990,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-991",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:991,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-992",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:992,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-993",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:993,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-994",code:"marketValues.value",name:"Значение стоимости",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:994,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-995",code:"currency.code",name:"Код валюты",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:995,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-996",code:"currency.rate",name:"Курс валюты к рублю на дату оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:996,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-997",code:"discount",name:"Залоговый дисконт",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:997,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-998",code:"isRevaluationRequired",name:"Признак требования переоценки",description:"Тип: boolean, Группа: Оценка",isActive:!0,sortOrder:998,metadata:{type:"boolean",group:"Оценка",required:!1,section:""}},{id:"attr-999",code:"startDate",name:"Дата начала действия справедливой стоимости",description:"Тип: date, Группа: Оценка",isActive:!0,sortOrder:999,metadata:{type:"date",group:"Оценка",required:!1,section:""}},{id:"attr-1000",code:"needInsurance",name:"Признак необходимости страхования",description:"Тип: boolean, Группа: страхование",isActive:!0,sortOrder:1e3,metadata:{type:"boolean",group:"страхование",required:!1,section:""}},{id:"attr-1001",code:"number",name:"Номер договора страхования",description:"Тип: text, Группа: страхование",isActive:!0,sortOrder:1001,metadata:{type:"text",group:"страхование",required:!1,section:""}},{id:"attr-1002",code:"date",name:"Дата договора страхования",description:"Тип: date, Группа: страхование",isActive:!0,sortOrder:1002,metadata:{type:"date",group:"страхование",required:!1,section:""}},{id:"attr-1003",code:"name",name:"Наименование страховой компании",description:"Тип: text, Группа: страхование. Компания",isActive:!0,sortOrder:1003,metadata:{type:"text",group:"страхование. Компания",required:!1,section:""}},{id:"attr-1004",code:"itin",name:"ИНН страховой компании",description:"Тип: text, Группа: страхование. Компания",isActive:!0,sortOrder:1004,metadata:{type:"text",group:"страхование. Компания",required:!1,section:""}},{id:"attr-1005",code:"value",name:"Страховая сумма по договору в руб.",description:"Тип: number, Группа: страхование. Страховая сумма",isActive:!0,sortOrder:1005,metadata:{type:"number",group:"страхование. Страховая сумма",required:!1,section:""}},{id:"attr-1006",code:"includedInLoan",name:"Страховая премия по договору, если включена в сумму кредита в руб.",description:"Тип: text, Группа: страхование. Страховая сумма",isActive:!0,sortOrder:1006,metadata:{type:"text",group:"страхование. Страховая сумма",required:!1,section:""}},{id:"attr-1007",code:"lossRiskInsurance",name:"Страхование от риска утраты или повреждения",description:"Тип: text, Группа: страхование. Тип страхования",isActive:!0,sortOrder:1007,metadata:{type:"text",group:"страхование. Тип страхования",required:!1,section:""}},{id:"attr-1008",code:"titleInsurance",name:"Страхование титула",description:"Тип: text, Группа: страхование. Тип страхования",isActive:!0,sortOrder:1008,metadata:{type:"text",group:"страхование. Тип страхования",required:!1,section:""}},{id:"attr-1009",code:"start",name:"Период страхования с",description:"Тип: text, Группа: страхование. Страховой период",isActive:!0,sortOrder:1009,metadata:{type:"text",group:"страхование. Страховой период",required:!1,section:""}},{id:"attr-1010",code:"end",name:"Период страхования по",description:"Тип: text, Группа: страхование. Страховой период",isActive:!0,sortOrder:1010,metadata:{type:"text",group:"страхование. Страховой период",required:!1,section:""}},{id:"attr-1011",code:"start",name:"Оплаченный период страхования с",description:"Тип: text, Группа: страхование. Оплаченный период",isActive:!0,sortOrder:1011,metadata:{type:"text",group:"страхование. Оплаченный период",required:!1,section:""}},{id:"attr-1012",code:"end",name:"Оплаченный период страхования по",description:"Тип: text, Группа: страхование. Оплаченный период",isActive:!0,sortOrder:1012,metadata:{type:"text",group:"страхование. Оплаченный период",required:!1,section:""}},{id:"attr-1013",code:"name",name:"Наименование выгодоприобретателя",description:"Тип: date, Группа: страхование. Наименование выгодоприобретателя",isActive:!0,sortOrder:1013,metadata:{type:"date",group:"страхование. Наименование выгодоприобретателя",required:!1,section:""}},{id:"attr-1014",code:"______",name:"Признак необходимости отчеты об оценке для мониторинга (да/нет)",description:"Тип: boolean, Группа: мониторинг",isActive:!0,sortOrder:1014,metadata:{type:"boolean",group:"мониторинг",required:!1,section:""}},{id:"attr-1015",code:"____",name:"Структурное подразделение ответственное за мониторинг залоговой сделки",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1015,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1016",code:"__",name:"Периодичность мониторинга, срок",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1016,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1017",code:"__",name:"Периодичность мониторинга, срок",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1017,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1018",code:"__",name:"Периодичность мониторинга, дни",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1018,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1019",code:"__",name:"Дата фактической проверки",description:"Тип: date, Группа: мониторинг, Естественный ключ",isActive:!0,sortOrder:1019,metadata:{type:"date",group:"мониторинг",required:!0,section:""}},{id:"attr-1020",code:"__",name:"Дата планируемой проверки",description:"Тип: date, Группа: мониторинг",isActive:!0,sortOrder:1020,metadata:{type:"date",group:"мониторинг",required:!1,section:""}},{id:"attr-1021",code:"_",name:"Инициирующее подразделение",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1021,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1022",code:"attr_1022",name:"Исполнитель",description:"Тип: text, Группа: мониторинг",isActive:!0,sortOrder:1022,metadata:{type:"text",group:"мониторинг",required:!1,section:""}},{id:"attr-1023",code:"type",name:"Тип",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1023,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1024",code:"value",name:"Значение",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1024,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1025",code:"currency",name:"Валюта",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1025,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1026",code:"type",name:"Id валюты из справочника Currency",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1026,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1027",code:"isoType",name:"Код валюты",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1027,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1028",code:"date",name:"Дата курса валюты",description:"Тип: date, Группа: стоимость. Валюта",isActive:!0,sortOrder:1028,metadata:{type:"date",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1029",code:"rate",name:"Курс валюты к рублю на дату оценки",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1029,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1030",code:"name",name:"Наименование",description:"Тип: text, Группа: стоимость. Валюта",isActive:!0,sortOrder:1030,metadata:{type:"text",group:"стоимость. Валюта",required:!1,section:""}},{id:"attr-1031",code:"date",name:"Дата оценки",description:"Тип: date, Группа: стоимость",isActive:!0,sortOrder:1031,metadata:{type:"date",group:"стоимость",required:!1,section:""}},{id:"attr-1032",code:"discount",name:"Дисконт",description:"Тип: text, Группа: стоимость",isActive:!0,sortOrder:1032,metadata:{type:"text",group:"стоимость",required:!1,section:""}},{id:"attr-1033",code:"message",name:'Признак "по ВНД переоценка не требуется"',description:"Тип: boolean, Группа: стоимость",isActive:!0,sortOrder:1033,metadata:{type:"boolean",group:"стоимость",required:!1,section:""}},{id:"attr-1034",code:"subjectValuation",name:"Субъект оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1034,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1035",code:"subjectAssessment",name:"Субъект залоговой экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1035,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1036",code:"__",name:"Сотрудник проводивший оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1036,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1037",code:"____",name:"Наименование структурного подразделения Банка, проводившего оценку",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1037,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1038",code:"status",name:"Статус залога",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1038,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1039",code:"category",name:"Категория качества",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1039,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1040",code:"type",name:"Тип субъекта оценки",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1040,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1041",code:"name",name:"Наименование субъекта оценки",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1041,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1042",code:"inn",name:"ИНН независимого оценщика",description:"Тип: text, Группа: Оценщик",isActive:!0,sortOrder:1042,metadata:{type:"text",group:"Оценщик",required:!1,section:""}},{id:"attr-1043",code:"number",name:"Номер",description:"Тип: text, Группа: Отчет об оценке",isActive:!0,sortOrder:1043,metadata:{type:"text",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1044",code:"attr_1044",name:"Дата",description:"Тип: date, Группа: Отчет об оценке",isActive:!0,sortOrder:1044,metadata:{type:"date",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1045",code:"verificationPerformerName",name:"Субъект верификации Отчета",description:"Тип: text, Группа: Отчет об оценке",isActive:!0,sortOrder:1045,metadata:{type:"text",group:"Отчет об оценке",required:!1,section:""}},{id:"attr-1046",code:"documentType",name:"Документ оценки",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1046,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1047",code:"assessmentAuthority",name:"Субъект залоговой экспертизы",description:"Тип: text, Группа: Оценка",isActive:!0,sortOrder:1047,metadata:{type:"text",group:"Оценка",required:!1,section:""}},{id:"attr-1048",code:"isValuationRequired",name:"Признак переоценки",description:"Тип: boolean, Группа: Оценка",isActive:!0,sortOrder:1048,metadata:{type:"boolean",group:"Оценка",required:!1,section:""}},{id:"attr-1049",code:"name",name:"Название компании",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1049,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1050",code:"inn",name:"ИНН организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1050,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1051",code:"address",name:"Юридический адрес организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1051,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1052",code:"email",name:"Адрес электронной почты организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1052,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1053",code:"director",name:"Руководитель организации",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1053,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1054",code:"website",name:"Официальный вебсайт компании",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1054,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1055",code:"note",name:"Примечания",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1055,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1056",code:"jurisdiction",name:"Регионы, с которыми ассоциирована РОК",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1056,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1057",code:"nonresidentialProperty",name:"Флаг, говорящий о том, что РОК поддерживает оценку объектов нежилой недвижимости, в том числе земельных участков",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1057,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1058",code:"residentialPropertyWithLand",name:"Флаг, говорящий о том, что РОК поддерживает оценку жилых домов с земельным участком",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1058,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1059",code:"equipment",name:"Флаг, говорящий о том, что РОК поддерживает оценку оборудования",description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1059,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1060",code:"otherMovableProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочего" движимого имущества',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1060,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1061",code:"otherProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочего" имущества',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1061,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1062",code:"otherResidentialProperty",name:'Флаг, говорящий о том, что РОК поддерживает оценку "прочих" объектов жилой недвижимости',description:"Тип: text, Группа: Рекомендованные оценочные компании",isActive:!0,sortOrder:1062,metadata:{type:"text",group:"Рекомендованные оценочные компании",required:!1,section:""}},{id:"attr-1063",code:"Список документов",name:"documents",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1063,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1064",code:"Id документа в сервисе Оценка",name:"id",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1064,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1065",code:"Тип документа",name:"type",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1065,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1066",code:"Наименование документа",name:"name",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1066,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1067",code:"Дата документа",name:"date",description:"Тип: date, Группа: Список документов",isActive:!0,sortOrder:1067,metadata:{type:"date",group:"Список документов",required:!1,section:""}},{id:"attr-1068",code:"Номер документа",name:"number",description:"Тип: number, Группа: Список документов",isActive:!0,sortOrder:1068,metadata:{type:"number",group:"Список документов",required:!1,section:""}},{id:"attr-1069",code:"Ссылка на документ",name:"link",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1069,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1070",code:"Id документа в сервисе документов",name:"documentId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1070,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1071",code:"Id ПЗ",name:"collateralId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1071,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1072",code:"Id документа в СХК",name:"cssId",description:"Тип: text, Группа: Список документов",isActive:!0,sortOrder:1072,metadata:{type:"text",group:"Список документов",required:!1,section:""}},{id:"attr-1073",code:"pledgeAgreementId",name:"Идентификатор договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1073,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1074",code:"pledgeAgreementName",name:"Наименование договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1074,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1075",code:"pledgeAgreementNumber",name:"Номер договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1075,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1076",code:"pledgeAgreementStartDate",name:"Дата начала договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1076,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1077",code:"pledgeAgreementDueDate",name:"Дата окончания договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1077,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1078",code:"pledgeAgreementPlanDate",name:"Плановая дата окончания договора залога в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1078,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1079",code:"pledgeAgreementAmount",name:"Сумма договора залога в АБС",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1079,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1080",code:"pledgeAgreementCurrency",name:"Валюта договора залога в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1080,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1081",code:"loanAgreementId",name:"Идентификатор договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1081,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1082",code:'loanAgreementNumber"',name:"Номер договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1082,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1083",code:"loanAgreementStartDate",name:"Дата начала договора основного обязательства(кредитного) в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1083,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1084",code:"loanAgreementDueDate",name:"Дата окончания договора основного обязательства(кредитного) в АБС",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1084,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1085",code:"loanAgreementTerm",name:"Срок в месяцах договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1085,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1086",code:"loanAgreementLink",name:"Процент покрытия договора основного обязательства(кредитного) в АБС",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1086,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1087",code:"registrationNumber",name:"Номер регистрации обременения",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1087,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1088",code:"registrationDate",name:"Дата регистрации обременения",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1088,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1089",code:"accountNumber",name:"Внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1089,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1090",code:"offBalanceCost",name:"Баланс внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1090,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1091",code:"fairCost",name:"Справедливая стоимость категорируемого имущества на договоре залога",description:"Тип: number, Группа: Прочие",isActive:!0,sortOrder:1091,metadata:{type:"number",group:"Прочие",required:!1,section:""}},{id:"attr-1092",code:"status",name:"Статус обременения",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1092,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1093",code:"pledgeAccountingStartDate",name:"Дата постановки залога на учет",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1093,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1094",code:"pledgeAccountingRemovalDate",name:"Дата снятия залога с учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1094,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1095",code:"pledgeAgreementType",name:"Тип договора залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1095,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1096",code:"loanAgreementName",name:"Наименование договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1096,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1097",code:"loanAgreementStatus",name:"Статус договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1097,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1098",code:"loanAgreementType",name:"Тип договора основного обязательства(кредитного) в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1098,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1099",code:"salePoint",name:"Точка продаж в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1099,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1100",code:"linkType",name:"Характер связи залога с договором",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1100,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1101",code:"linkTypeChangeDate",name:"Дата закрытия связи залога с договором",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1101,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1102",code:"offBalanceAccount",name:"Внебалансовый счет",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1102,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1103",code:"idCft",name:"Идентификатор внебалансового счета в АБС",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1103,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1104",code:"accountNumber",name:"Внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1104,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1105",code:"offBalanceCost",name:"Баланс внебалансовый счет учета залога",description:"Тип: text, Группа: Прочие",isActive:!0,sortOrder:1105,metadata:{type:"text",group:"Прочие",required:!1,section:""}},{id:"attr-1106",code:"pledgeAccountingStartDate",name:"Дата открытия счета учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1106,metadata:{type:"date",group:"Прочие",required:!1,section:""}},{id:"attr-1107",code:"pledgeAccountingRemovalDate",name:"Дата закрытия счета учета",description:"Тип: date, Группа: Прочие",isActive:!0,sortOrder:1107,metadata:{type:"date",group:"Прочие",required:!1,section:""}}],createdAt:t,updatedAt:t},{id:"dict-collateral-attributes-zalog",name:"Атрибуты залога",code:"collateral_attributes_zalog",description:"Справочник атрибутов залога из файла atr1.xlsx",items:[{id:"zalog-attr-1",code:"GROUP_WHICH_CULTURE_BELONGS",name:"Группа, к которой относится культура",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:1,metadata:{type:"string",group:"Будущий урожай",required:!0,section:"4.10",naturalKey:!0}},{id:"zalog-attr-2",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:2,metadata:{type:"string",group:"Будущий урожай",required:!0,section:"4.10",naturalKey:!0}},{id:"zalog-attr-3",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:3,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-4",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: BOOLEAN",isActive:!0,sortOrder:4,metadata:{type:"boolean",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-5",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:5,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-6",code:"GROUP_WHICH_CULTURE_BELONGS_OTHER",name:"Группа, к которой относится культура, иное",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:6,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-7",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:7,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-8",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Будущий урожай; Раздел отчета: 4.10; Тип значения: STRING",isActive:!0,sortOrder:8,metadata:{type:"string",group:"Будущий урожай",required:!1,section:"4.10",naturalKey:!1}},{id:"zalog-attr-9",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:9,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-10",code:"QUANTITY",name:"Количество слитков, шт.",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:10,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-11",code:"WEIGHT",name:"Масса, г.",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:11,metadata:{type:"number",group:"Аффинированные драгоценные металлы в слитках",required:!0,section:"4.11",naturalKey:!0}},{id:"zalog-attr-12",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:12,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-13",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:13,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-14",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:14,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-15",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: BOOLEAN",isActive:!0,sortOrder:15,metadata:{type:"boolean",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-16",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Аффинированные драгоценные металлы в слитках; Раздел отчета: 4.11; Тип значения: STRING",isActive:!0,sortOrder:16,metadata:{type:"string",group:"Аффинированные драгоценные металлы в слитках",required:!1,section:"4.11",naturalKey:!1}},{id:"zalog-attr-17",code:"NUMBER_OF_DOCUMENT_OF_INTEL_ACT",name:"Номер документа, удостоверяющего исключительное право на результат интеллектуальной деятельности",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:17,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!0,section:"4.12",naturalKey:!0}},{id:"zalog-attr-18",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:18,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-19",code:"REGISTRATION_NUMBER_OF_RIGHTS",name:"Регистрационный номер прав на интеллектуальную собственность",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:19,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-20",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: STRING",isActive:!0,sortOrder:20,metadata:{type:"string",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-21",code:"RIGHTS_EXPIRATION_DATE",name:"Дата окончания прав на результат интеллектуальной собственностиа",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: DATE",isActive:!0,sortOrder:21,metadata:{type:"date",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-22",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Исключительные права на интеллектуальную собственность; Раздел отчета: 4.12; Тип значения: BOOLEAN",isActive:!0,sortOrder:22,metadata:{type:"boolean",group:"Исключительные права на интеллектуальную собственность",required:!1,section:"4.12",naturalKey:!1}},{id:"zalog-attr-23",code:"NUMBER_OF_PLEDGE_ACCOUNT",name:"Номер залогового счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:23,metadata:{type:"string",group:"Права по договору банковского счета",required:!0,section:"4.13",naturalKey:!0}},{id:"zalog-attr-24",code:"SUM_OF_DEPOSIT",name:"Сумма депозита/вклада, передаваемая в залог",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: NUMBER",isActive:!0,sortOrder:24,metadata:{type:"number",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-25",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:25,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-26",code:"DATEEND_OF_ARRENGEMENT",name:"Дата окончания договора депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:26,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-27",code:"NAME_OF_BANK",name:"Наименование банка, в котором открыт депозит/вклад",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:27,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-28",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:28,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-29",code:"DATE_OF_ARRENGEMENT",name:"Дата заключения договора депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:29,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-30",code:"PR_OF_PLEDGE_ACCOUNT",name:"Признак наличия залогового счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:30,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-31",code:"BANK_ACCOUNT_AGREEMENT_DATE",name:"Дата договора банковского счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: DATE",isActive:!0,sortOrder:31,metadata:{type:"date",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-32",code:"BANK_ACCOUNT_AGREEMENT_NUMBER",name:"Номер договора банковского счета",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:32,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-33",code:"INFORMATION_ABOUT_AMOUNT_MONEY",name:"Сведения о денежной сумме",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:33,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-34",code:"CURRENCY_OF_SUM",name:"Валюта депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:34,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-35",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: BOOLEAN",isActive:!0,sortOrder:35,metadata:{type:"boolean",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-36",code:"ACC_NUM_FOR_ACC_OF_DEP",name:"Номер счета по учету депозита/вклада",description:"Тип имущества: Права по договору банковского счета; Раздел отчета: 4.13; Тип значения: STRING",isActive:!0,sortOrder:36,metadata:{type:"string",group:"Права по договору банковского счета",required:!1,section:"4.13",naturalKey:!1}},{id:"zalog-attr-37",code:"ID_OOO",name:"id клиента",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:37,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-38",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:38,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14",naturalKey:!0}},{id:"zalog-attr-39",code:"SHARE_INFORMATION",name:"Значение идентификационного кода ООО",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:39,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!0,section:"4.14",naturalKey:!0}},{id:"zalog-attr-40",code:"NAME_OOO",name:"Наименование ООО",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:40,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-41",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: NUMBER",isActive:!0,sortOrder:41,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-42",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: BOOLEAN",isActive:!0,sortOrder:42,metadata:{type:"boolean",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-43",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:43,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-44",code:"TYPE_CODE_OOO",name:"Тип идентификационного кода субъекта (ООО)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: DIRECTORY",isActive:!0,sortOrder:44,metadata:{type:"directory",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-45",code:"PERCENTAGE_AUTHORIZED_CAPITAL",name:"Процент уставного капитала общества с ограниченной ответственностью, который составляет доля (часть доли)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: NUMBER",isActive:!0,sortOrder:45,metadata:{type:"number",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-46",code:"ID_OOO",name:"Идентификационный код субъекта (ООО) или ID субъекта (ООО)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:46,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-47",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Доли в уставных капиталах обществ с ограниченной ответственностью; Раздел отчета: 4.14; Тип значения: STRING",isActive:!0,sortOrder:47,metadata:{type:"string",group:"Доли в уставных капиталах обществ с ограниченной ответственностью",required:!1,section:"4.14",naturalKey:!1}},{id:"zalog-attr-48",code:"NUMBER_OF_VEKSEL",name:"Номер векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:48,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-49",code:"RELEASE_DATE_VEKSEL",name:"Дата выпуска векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE; Ключевой атрибут: Да",isActive:!0,sortOrder:49,metadata:{type:"date",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-50",code:"INN_ISSUER",name:"Значение идентификационного  кода субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:50,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-51",code:"DENOMINATION_VEKSEL",name:"Номинал векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:51,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-52",code:"NUMBER_BLANK_OF_VEKSEL",name:"Номер бланка векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:52,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-53",code:"SERIA_VEKSEL",name:"Серия векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:53,metadata:{type:"string",group:"Векселя",required:!0,section:"4.15",naturalKey:!0}},{id:"zalog-attr-54",code:"CODE_VEKSELEDERZHATEL_NONRESIDENT",name:"Признак кода векселедержателя (собственника) нерезидента",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:54,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-55",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:55,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-56",code:"VALUE_DEPOSITORY",name:"Значение идентификационного  кода субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:56,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-57",code:"CURRENCY_CODE_VEKSEL",name:"Код валюты векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:57,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-58",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:58,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-59",code:"NAME_DEPOSITORY",name:"Наименование субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:59,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-60",code:"SUBJECT_AVALIZATION",name:"Субъект авалирования/акцептования векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:60,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-61",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:61,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-62",code:"NAME_ISSUER",name:"Наименование субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:62,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-63",code:"VEKSEL_TYPE",name:"Тип векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:63,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-64",code:"VEKSEL_CURRENCY",name:"Валюта векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:64,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-65",code:"VEKSELEDATEL",name:"Векселедатель",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:65,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-66",code:"VEKSELEDERZHATEL",name:"Векселедержатель",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:66,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-67",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:67,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-68",code:"PERCENT_OF_VEKSEL",name:"Процентная ставка по векселю",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: NUMBER",isActive:!0,sortOrder:68,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-69",code:"VEKSEL_SIGN",name:"Признак векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:69,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-70",code:"DISCOUNT_OF_VEKSEL",name:"Дисконт по векселю",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: NUMBER",isActive:!0,sortOrder:70,metadata:{type:"number",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-71",code:"MATURITY_OF_VEKSEL",name:"Срок погашения векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:71,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-72",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:72,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-73",code:"PLACE_OF_COMPILATION",name:"Место составления",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:73,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-74",code:"PLACE_OF_PAYMENT",name:"Место платежа",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:74,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-75",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:75,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-76",code:"SIGN_LEGAL_VEKSELEDATEL",name:"Признак юр. лица субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: BOOLEAN",isActive:!0,sortOrder:76,metadata:{type:"boolean",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-77",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:77,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-78",code:"VEKSEL_CONDITION",name:"Состояние векселя на отчетную дату",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:78,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-79",code:"RECEIPT_DATE",name:"Дата поступления",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:79,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-80",code:"TERM_CONDITIONS_PAYMENT",name:"Срок и условия платежа (Дата 2)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DATE",isActive:!0,sortOrder:80,metadata:{type:"date",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-81",code:"CONDITIONS_PAYMENT",name:"Условия платежа",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:81,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-82",code:"SECURITY_TYPE",name:"Код типа ценной бумаги",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:82,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-83",code:"OKSM_COUNTRY_VEKSELEDATEL",name:"Код ОКСМ страны векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:83,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-84",code:"OGRN_VEKSELEDATEL",name:"ОГРН векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:84,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-85",code:"TYPE_CODE_VEKSELEDATEL",name:"Тип идентификационного кода субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:85,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-86",code:"CODE_VEKSELEDATEL_NONRESIDENT",name:"Признак кода векселедателя нерезидента",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:86,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-87",code:"SIGN_VEKSELEDATEL",name:"Признак векселедателя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:87,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-88",code:"ID_VEKSEL",name:"Идентификационный код векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:88,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-89",code:"ID_VEKSELEDATEL",name:"Идентификационный код субъекта (векселедателя)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:89,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-90",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:90,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-91",code:"TYPE_DEPOSITORY",name:"Тип идентификационного кода субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:91,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-92",code:"LOCATION_OF_VEKSEL",name:"Местонахождения векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: DIRECTORY",isActive:!0,sortOrder:92,metadata:{type:"directory",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-93",code:"ID_DEPOSITORY",name:"Идентификационный код субъекта (депозитария) или ID субъекта (депозитария)",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:93,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-97",code:"RATING_VEKSEL",name:"Номинал векселя",description:"Тип имущества: Векселя; Раздел отчета: 4.15; Тип значения: STRING",isActive:!0,sortOrder:97,metadata:{type:"string",group:"Векселя",required:!1,section:"4.15",naturalKey:!1}},{id:"zalog-attr-98",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:98,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!0,section:"4.16",naturalKey:!0}},{id:"zalog-attr-99",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:99,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-100",code:"GOVERNMENT_NUM_OF_SECURITIES",name:"Государственный регистрационный номер выпуска ценных бумаг",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:100,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-101",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:101,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-102",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DATE",isActive:!0,sortOrder:102,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-103",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:103,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-104",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:104,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-105",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:105,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-106",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:106,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-107",code:"ISSUE_SECURITY_TYPE",name:"Код типа эмиссионной ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:107,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-108",code:"COUNTRY_CODE_ISSUER",name:"Код ОКСМ страны эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:108,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-109",code:"OGRN_ISSUER",name:"ОГРН эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:109,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-110",code:"KPP_ISSUER",name:"КПП эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:110,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-111",code:"CODE_ISSUER_NONRESIDENT",name:"Признак кода эмитента нерезидента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:111,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-112",code:"SIGN_ISSUER",name:"Признак эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:112,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-113",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:113,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-114",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:114,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-115",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:115,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-116",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:116,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-117",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:117,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-118",code:"AMOUNT_OF_SECURITIES",name:"Количество эмиссионных ценных бумаг, шт.",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: NUMBER",isActive:!0,sortOrder:118,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-119",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:119,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-120",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:120,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-121",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: NUMBER",isActive:!0,sortOrder:121,metadata:{type:"number",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-122",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:122,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-123",code:"ID_NUM_SECURITIES",name:"Идентификационный номер выпуска ценных бумаг",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:123,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-124",code:"CLASS_SECURITIES",name:"Класс ценной бумаги",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: STRING",isActive:!0,sortOrder:124,metadata:{type:"string",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-125",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:125,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-126",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DATE",isActive:!0,sortOrder:126,metadata:{type:"date",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-127",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: DIRECTORY",isActive:!0,sortOrder:127,metadata:{type:"directory",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-128",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Эмиссионные ценные бумаги; Раздел отчета: 4.16; Тип значения: BOOLEAN",isActive:!0,sortOrder:128,metadata:{type:"boolean",group:"Эмиссионные ценные бумаги",required:!1,section:"4.16",naturalKey:!1}},{id:"zalog-attr-129",code:"REG_NUM_OF_PIE_FUND",name:"Регистрационный номер правил доверительного управления паевым инвестиционным фондом",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:129,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17",naturalKey:!0}},{id:"zalog-attr-130",code:"AMOUNT_OF_PIES",name:"Количество паев паевого инвестиционного фонда, шт.",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:130,metadata:{type:"number",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!0,section:"4.17",naturalKey:!0}},{id:"zalog-attr-131",code:"DATE_END_CONTRACT_OF_PIE_FUND",name:"Дата окончания срока действия договора доверительного управления паевым инвестиционным фондом",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: DATE",isActive:!0,sortOrder:131,metadata:{type:"date",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-132",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: BOOLEAN",isActive:!0,sortOrder:132,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-133",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: BOOLEAN",isActive:!0,sortOrder:133,metadata:{type:"boolean",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-134",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:134,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-135",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:135,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-136",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:136,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-137",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:137,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-138",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:138,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-139",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Инвестиционные паи (паи инвестиционных фондов); Раздел отчета: 4.17; Тип значения: STRING",isActive:!0,sortOrder:139,metadata:{type:"string",group:"Инвестиционные паи (паи инвестиционных фондов)",required:!1,section:"4.17",naturalKey:!1}},{id:"zalog-attr-140",code:"IND_DES_OF_MORTG_PART_CERT",name:"Индивидуальное обозначение ипотечных сертификатов участия",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:140,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!0,section:"4.18",naturalKey:!0}},{id:"zalog-attr-141",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:141,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-142",code:"DATE_END_TERM_CONTRACT_TRUST_MANAGEMENT_MORTGAGE_COVERAGE",name:"Дата окончания срока действия договора доверительного управления ипотечным покрытием",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: DATE",isActive:!0,sortOrder:142,metadata:{type:"date",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-143",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:143,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-144",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:144,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-145",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: BOOLEAN",isActive:!0,sortOrder:145,metadata:{type:"boolean",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-146",code:"NUM_OF_MORTG_PART_CERTIF",name:"Количество ипотечных сертификатов участия, шт.",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: NUMBER",isActive:!0,sortOrder:146,metadata:{type:"number",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-147",code:"REGISTR_NUM",name:"Регистрационный номер правил доверительного управления ипотечным покрытием",description:"Тип имущества: Ипотечные сертификаты участия; Раздел отчета: 4.18; Тип значения: STRING",isActive:!0,sortOrder:147,metadata:{type:"string",group:"Ипотечные сертификаты участия",required:!1,section:"4.18",naturalKey:!1}},{id:"zalog-attr-148",code:"SERIA_SEC_PAPER",name:"Серия ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:148,metadata:{type:"string",group:"Прочие ценные бумаги",required:!0,section:"4.19",naturalKey:!0}},{id:"zalog-attr-149",code:"NUM_SECURITIES",name:"Номер ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:149,metadata:{type:"string",group:"Прочие ценные бумаги",required:!0,section:"4.19",naturalKey:!0}},{id:"zalog-attr-150",code:"ID_ISSUER_SEC",name:"ID эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:150,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-151",code:"TYPE_CODE_ISSUER_SEC",name:"Тип идентификационного кода эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:151,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-152",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:152,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-153",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:153,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-154",code:"VALUE_TYPE_CODE_ISSUER_SEC",name:"Значение идентификационного  кода эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:154,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-155",code:"AMOUNT_SHARE",name:"Количество ценных бумаг, шт.",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: NUMBER",isActive:!0,sortOrder:155,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-156",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:156,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-157",code:"TYPE_SECURITIES",name:"Вид ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:157,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-158",code:"NOMINAL_VALUE",name:"Номинальная стоимость",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: NUMBER",isActive:!0,sortOrder:158,metadata:{type:"number",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-159",code:"ID_DEPOSITORY_SEC",name:"ID депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:159,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-160",code:"ISIN",name:"Код ISIN",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:160,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-161",code:"TYPE_SECURITY_ISSUER",name:"Тип эмитента ценной бумаги",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:161,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-162",code:"CURRENCY_NOMINAL_VALUE",name:"Валюта номинальной стоимости",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:162,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-163",code:"SIGN_QUOTA",name:"Признак котируемости",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:163,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-164",code:"SIGN_DEPOSITORY",name:"Признак соответствия депозитария требованиям ЦБ",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:164,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-165",code:"DATE_END",name:"Дата окончания",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DATE",isActive:!0,sortOrder:165,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-166",code:"NAME_DEPOSITORY_SEC",name:"Наименование депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:166,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-167",code:"OTHER_SECURITY_TYPE_CODE",name:"Код типа ценной бумаги(ЭЦБ и прочие)",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:167,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-168",code:"RELEASE_DATE",name:"Дата выпуска",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DATE",isActive:!0,sortOrder:168,metadata:{type:"date",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-169",code:"SEC_IN_LIST",name:"Признак включения в список ЦБ, допущенных к организованным торгам",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: BOOLEAN",isActive:!0,sortOrder:169,metadata:{type:"boolean",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-170",code:"VALUE_TYPE_CODE_DEPOSITORY_SEC",name:"Значение идентификационного  кода депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:170,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-171",code:"TYPE_CODE_DEPOSITORY_SEC",name:"Тип идентификационного кода депозитария",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: DIRECTORY",isActive:!0,sortOrder:171,metadata:{type:"directory",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-172",code:"NAME_ISSUER_SEC",name:"Наименование эмитента",description:"Тип имущества: Прочие ценные бумаги; Раздел отчета: 4.19; Тип значения: STRING",isActive:!0,sortOrder:172,metadata:{type:"string",group:"Прочие ценные бумаги",required:!1,section:"4.19",naturalKey:!1}},{id:"zalog-attr-174",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:174,metadata:{type:"string",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!0,section:"4.2",naturalKey:!0}},{id:"zalog-attr-175",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:175,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-176",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:176,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-177",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Недвижимое имущество и права аренды недвижимого имущества; Раздел отчета: 4.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:177,metadata:{type:"boolean",group:"Недвижимое имущество и права аренды недвижимого имущества",required:!1,section:"4.2",naturalKey:!1}},{id:"zalog-attr-178",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:178,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!0,section:"4.20",naturalKey:!0}},{id:"zalog-attr-179",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:179,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!0,section:"4.20",naturalKey:!0}},{id:"zalog-attr-180",code:"TYPE_CODE",name:"Тип идентификационного кода",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:180,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-181",code:"VALUE_TYPE_CODE",name:"Значение идентификационного кода",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:181,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-182",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: BOOLEAN",isActive:!0,sortOrder:182,metadata:{type:"boolean",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-183",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:183,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-184",code:"DATE_CONTRACT",name:"Дата договора/ контакта/ доп соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: DATE",isActive:!0,sortOrder:184,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-185",code:"SUBJECT_OF_CONTRACT",name:"Предмет контракта/договора",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:185,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-186",code:"COUNTERPARTY_UNDER_CONTRACT",name:"Контрагент по договору/контракту",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:186,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-187",code:"NUMBER_CONTRACT",name:"Номер договора/контракта/доп. соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: STRING",isActive:!0,sortOrder:187,metadata:{type:"string",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-188",code:"DATE_END_CONTRACT",name:"Дата окончания срока действия договора/ контракта/ доп соглашения",description:"Тип имущества: Прочие имущественные Права требования; Раздел отчета: 4.20; Тип значения: DATE",isActive:!0,sortOrder:188,metadata:{type:"date",group:"Прочие имущественные Права требования",required:!1,section:"4.20",naturalKey:!1}},{id:"zalog-attr-189",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:189,metadata:{type:"string",group:"Здание",required:!0,section:"4.2.1",naturalKey:!0}},{id:"zalog-attr-190",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:190,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-191",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:191,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-192",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:192,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-193",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:193,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-194",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:194,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-195",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:195,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-196",code:"STREET",name:"Улица",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:196,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-197",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:197,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-198",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:198,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-199",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:199,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-200",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:200,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-201",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:201,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-202",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:202,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-203",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:203,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-204",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:204,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-205",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:205,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-206",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:206,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-207",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:207,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-208",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:208,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-209",code:"BUILDING",name:"дом",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:209,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-210",code:"INDEX",name:"Индекс",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:210,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-211",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:211,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-212",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:212,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-213",code:"ROOM",name:"Квартира",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:213,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-214",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:214,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-215",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:215,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-216",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:216,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-217",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:217,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-218",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:218,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-219",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:219,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-220",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:220,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-221",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:221,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-222",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:222,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-223",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:223,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-224",code:"LETTER",name:"Литера",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:224,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-225",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:225,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-226",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DIRECTORY",isActive:!0,sortOrder:226,metadata:{type:"directory",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-227",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:227,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-228",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:228,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-229",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:229,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-230",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:230,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-231",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:231,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-232",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:232,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-233",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:233,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-234",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:234,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-235",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:235,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-236",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:236,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-237",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:237,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-238",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:238,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-239",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: DATE",isActive:!0,sortOrder:239,metadata:{type:"date",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-240",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: BOOLEAN",isActive:!0,sortOrder:240,metadata:{type:"boolean",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-241",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:241,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-242",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:242,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-243",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: NUMBER",isActive:!0,sortOrder:243,metadata:{type:"number",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-244",code:"REGION",name:"Регион",description:"Тип имущества: Здание; Раздел отчета: 4.2.1; Тип значения: STRING",isActive:!0,sortOrder:244,metadata:{type:"string",group:"Здание",required:!1,section:"4.2.1",naturalKey:!1}},{id:"zalog-attr-245",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:245,metadata:{type:"string",group:"Прочие движимые вещи",required:!0,section:"4.21",naturalKey:!0}},{id:"zalog-attr-246",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:246,metadata:{type:"string",group:"Прочие движимые вещи",required:!0,section:"4.21",naturalKey:!0}},{id:"zalog-attr-247",code:"LOCATION_OTHER_MOVABLE_PROPERTY",name:"Местонахождение прочего движимого имущества",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:247,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-248",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: BOOLEAN",isActive:!0,sortOrder:248,metadata:{type:"boolean",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-249",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:249,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-250",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Прочие движимые вещи; Раздел отчета: 4.21; Тип значения: STRING",isActive:!0,sortOrder:250,metadata:{type:"string",group:"Прочие движимые вещи",required:!1,section:"4.21",naturalKey:!1}},{id:"zalog-attr-251",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:251,metadata:{type:"string",group:"Сооружение",required:!0,section:"4.2.2",naturalKey:!0}},{id:"zalog-attr-252",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:252,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-253",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:253,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-254",code:"STREET",name:"Улица",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:254,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-255",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:255,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-256",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:256,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-257",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:257,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-258",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:258,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-259",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:259,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-260",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:260,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-261",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:261,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-262",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:262,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-263",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:263,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-264",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:264,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-265",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:265,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-266",code:"INDEX",name:"Индекс",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:266,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-267",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:267,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-268",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:268,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-269",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:269,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-270",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:270,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-271",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:271,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-272",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:272,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-273",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:273,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-274",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:274,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-275",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:275,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-276",code:"ROOM",name:"Квартира",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:276,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-277",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:277,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-278",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:278,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-279",code:"BUILDING",name:"дом",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:279,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-280",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:280,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-281",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:281,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-282",code:"REGION",name:"Регион",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:282,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-283",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:283,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-284",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:284,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-285",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:285,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-286",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:286,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-287",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:287,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-288",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:288,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-289",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:289,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-290",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DATE",isActive:!0,sortOrder:290,metadata:{type:"date",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-291",code:"LETTER",name:"Литера",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:291,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-292",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:292,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-293",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:293,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-294",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:294,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-295",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:295,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-296",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:296,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-297",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:297,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-298",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:298,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-299",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:299,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-300",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:300,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-301",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:301,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-302",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:302,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-303",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: DIRECTORY",isActive:!0,sortOrder:303,metadata:{type:"directory",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-304",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: NUMBER",isActive:!0,sortOrder:304,metadata:{type:"number",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-305",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: BOOLEAN",isActive:!0,sortOrder:305,metadata:{type:"boolean",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-306",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Сооружение; Раздел отчета: 4.2.2; Тип значения: STRING",isActive:!0,sortOrder:306,metadata:{type:"string",group:"Сооружение",required:!1,section:"4.2.2",naturalKey:!1}},{id:"zalog-attr-307",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:307,metadata:{type:"string",group:"Помещение",required:!0,section:"4.2.3",naturalKey:!0}},{id:"zalog-attr-308",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:308,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-309",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:309,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-310",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:310,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-311",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:311,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-312",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:312,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-313",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:313,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-314",code:"REGION",name:"Регион",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:314,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-315",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:315,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-316",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:316,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-317",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:317,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-318",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:318,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-319",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:319,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-320",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:320,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-321",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:321,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-322",code:"STREET",name:"Улица",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:322,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-323",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:323,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-324",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:324,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-325",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:325,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-326",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:326,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-327",code:"INDEX",name:"Индекс",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:327,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-328",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:328,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-329",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:329,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-330",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:330,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-331",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:331,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-332",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:332,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-333",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:333,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-334",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:334,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-335",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:335,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-336",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:336,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-337",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:337,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-338",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DATE",isActive:!0,sortOrder:338,metadata:{type:"date",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-339",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:339,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-340",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:340,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-341",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:341,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-342",code:"LETTER",name:"Литера",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:342,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-343",code:"BUILDING",name:"дом",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:343,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-344",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:344,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-345",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:345,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-346",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:346,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-347",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:347,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-348",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:348,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-349",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:349,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-350",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:350,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-351",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:351,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-352",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:352,metadata:{type:"directory",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-353",code:"ROOM",name:"Квартира",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:353,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-354",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:354,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-355",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:355,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-356",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:356,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-357",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:357,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-358",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:358,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-359",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:359,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-360",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: STRING",isActive:!0,sortOrder:360,metadata:{type:"string",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-361",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: NUMBER",isActive:!0,sortOrder:361,metadata:{type:"number",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-362",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Помещение; Раздел отчета: 4.2.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:362,metadata:{type:"boolean",group:"Помещение",required:!1,section:"4.2.3",naturalKey:!1}},{id:"zalog-attr-363",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:363,metadata:{type:"string",group:"Машино-место",required:!0,section:"4.2.4",naturalKey:!0}},{id:"zalog-attr-364",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:364,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-365",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:365,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-366",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:366,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-367",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:367,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-368",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:368,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-369",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:369,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-370",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:370,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-371",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:371,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-372",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:372,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-373",code:"LETTER",name:"Литера",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:373,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-374",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:374,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-375",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:375,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-376",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:376,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-377",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:377,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-378",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:378,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-379",code:"INDEX",name:"Индекс",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:379,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-380",code:"BUILDING",name:"дом",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:380,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-381",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:381,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-382",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:382,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-383",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:383,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-384",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:384,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-385",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:385,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-386",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:386,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-387",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:387,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-388",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:388,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-389",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:389,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-390",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:390,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-391",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:391,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-392",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:392,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-393",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:393,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-394",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:394,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-395",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:395,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-396",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:396,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-397",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:397,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-398",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:398,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-399",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: NUMBER",isActive:!0,sortOrder:399,metadata:{type:"number",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-400",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:400,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-401",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:401,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-402",code:"STREET",name:"Улица",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:402,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-403",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:403,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-404",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:404,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-405",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:405,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-406",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:406,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-407",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DATE",isActive:!0,sortOrder:407,metadata:{type:"date",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-408",code:"REGION",name:"Регион",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:408,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-409",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:409,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-410",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:410,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-411",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:411,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-412",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:412,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-413",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:413,metadata:{type:"boolean",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-414",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:414,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-415",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:415,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-416",code:"ROOM",name:"Квартира",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: STRING",isActive:!0,sortOrder:416,metadata:{type:"string",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-417",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:417,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-418",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Машино-место; Раздел отчета: 4.2.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:418,metadata:{type:"directory",group:"Машино-место",required:!1,section:"4.2.4",naturalKey:!1}},{id:"zalog-attr-419",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:419,metadata:{type:"string",group:"Объект незавершенного строительства",required:!0,section:"4.2.5",naturalKey:!0}},{id:"zalog-attr-420",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:420,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-421",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:421,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-422",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:422,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-423",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:423,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-424",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:424,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-425",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:425,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-426",code:"BUILDING",name:"дом",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:426,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-427",code:"INDEX",name:"Индекс",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:427,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-428",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:428,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-429",code:"ROOM",name:"Квартира",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:429,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-430",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:430,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-431",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:431,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-432",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:432,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-433",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:433,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-434",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:434,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-435",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:435,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-436",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:436,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-437",code:"LETTER",name:"Литера",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:437,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-438",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:438,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-439",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:439,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-440",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:440,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-441",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:441,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-442",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:442,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-443",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:443,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-444",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:444,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-445",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:445,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-446",code:"REGION",name:"Регион",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:446,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-447",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:447,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-448",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:448,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-449",code:"STREET",name:"Улица",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:449,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-450",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:450,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-451",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:451,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-452",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:452,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-453",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:453,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-454",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:454,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-455",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:455,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-456",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:456,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-457",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:457,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-458",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:458,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-459",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:459,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-460",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:460,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-461",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:461,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-462",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:462,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-463",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DATE",isActive:!0,sortOrder:463,metadata:{type:"date",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-464",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: DIRECTORY",isActive:!0,sortOrder:464,metadata:{type:"directory",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-465",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:465,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-466",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:466,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-467",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:467,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-468",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:468,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-469",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:469,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-470",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:470,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-471",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:471,metadata:{type:"boolean",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-472",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:472,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-473",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: NUMBER",isActive:!0,sortOrder:473,metadata:{type:"number",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-474",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Объект незавершенного строительства; Раздел отчета: 4.2.5; Тип значения: STRING",isActive:!0,sortOrder:474,metadata:{type:"string",group:"Объект незавершенного строительства",required:!1,section:"4.2.5",naturalKey:!1}},{id:"zalog-attr-475",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:475,metadata:{type:"string",group:"Земельный участок",required:!0,section:"4.2.6",naturalKey:!0}},{id:"zalog-attr-476",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:476,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-477",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:477,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-478",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:478,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-479",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:479,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-480",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:480,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-481",code:"TYPE_OF_USE_OF_THE_LAND",name:"Вид разрешенного использования земельного участка",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:481,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-482",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:482,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-483",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:483,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-484",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:484,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-485",code:"INDEX",name:"Индекс",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:485,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-486",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:486,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-487",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:487,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-488",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:488,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-489",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:489,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-490",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:490,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-491",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DIRECTORY",isActive:!0,sortOrder:491,metadata:{type:"directory",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-492",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:492,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-493",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:493,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-494",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:494,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-495",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:495,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-496",code:"ROOM",name:"Квартира",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:496,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-497",code:"AREA_DEVIATION",name:"Отклонение площади, +/-, (м²)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:497,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-498",code:"LETTER",name:"Литера",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:498,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-499",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:499,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-500",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:500,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-501",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:501,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-502",code:"BUILDINGS_NOT_INCLUDED",name:"Признак наличия на земельном участке зданий/ строений/ сооружений Залогодателя, не включенных в предмет ипотеки",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:502,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-503",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:503,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-504",code:"NAME_LANDLORD",name:"Наименование арендодателя",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:504,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-505",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:505,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-506",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:506,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-507",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:507,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-508",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:508,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-509",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:509,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-510",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:510,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-511",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DIRECTORY",isActive:!0,sortOrder:511,metadata:{type:"directory",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-512",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:512,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-513",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:513,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-514",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:514,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-515",code:"REGION",name:"Регион",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:515,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-516",code:"STREET",name:"Улица",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:516,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-517",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:517,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-518",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:518,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-519",code:"BUILDING",name:"дом",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: STRING",isActive:!0,sortOrder:519,metadata:{type:"string",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-520",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: NUMBER",isActive:!0,sortOrder:520,metadata:{type:"number",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-521",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: DATE",isActive:!0,sortOrder:521,metadata:{type:"date",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-522",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Земельный участок; Раздел отчета: 4.2.6; Тип значения: BOOLEAN",isActive:!0,sortOrder:522,metadata:{type:"boolean",group:"Земельный участок",required:!1,section:"4.2.6",naturalKey:!1}},{id:"zalog-attr-523",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:523,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!0,section:"4.2.7",naturalKey:!0}},{id:"zalog-attr-524",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:524,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-525",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:525,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-526",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:526,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-527",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:527,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-528",code:"BUILDING",name:"дом",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:528,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-529",code:"INDEX",name:"Индекс",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:529,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-530",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:530,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-531",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:531,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-532",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:532,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-533",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:533,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-534",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:534,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-535",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:535,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-536",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:536,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-537",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:537,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-538",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:538,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-539",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:539,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-540",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:540,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-541",code:"LETTER",name:"Литера",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:541,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-542",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:542,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-543",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:543,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-544",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:544,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-545",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:545,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-546",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:546,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-547",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:547,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-548",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DATE",isActive:!0,sortOrder:548,metadata:{type:"date",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-549",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:549,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-550",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:550,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-551",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:551,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-552",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:552,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-553",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:553,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-554",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:554,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-555",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:555,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-556",code:"STREET",name:"Улица",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:556,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-557",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:557,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-558",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:558,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-559",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:559,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-560",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:560,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-561",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:561,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-562",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:562,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-563",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:563,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-564",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:564,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-565",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:565,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-566",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:566,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-567",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:567,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-568",code:"REGION",name:"Регион",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:568,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-569",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:569,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-570",code:"ROOM",name:"Квартира",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:570,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-571",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:571,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-572",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: DIRECTORY",isActive:!0,sortOrder:572,metadata:{type:"directory",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-573",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:573,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-574",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:574,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-575",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:575,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-576",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: STRING",isActive:!0,sortOrder:576,metadata:{type:"string",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-577",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: NUMBER",isActive:!0,sortOrder:577,metadata:{type:"number",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-578",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Единый недвижимый комплекс; Раздел отчета: 4.2.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:578,metadata:{type:"boolean",group:"Единый недвижимый комплекс",required:!1,section:"4.2.7",naturalKey:!1}},{id:"zalog-attr-579",code:"CADASTRAL_NUMBER",name:"Кадастровый номер",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:579,metadata:{type:"string",group:"Имущественный комплекс",required:!0,section:"4.2.8",naturalKey:!0}},{id:"zalog-attr-580",code:"AGENCY_OF_DOCUMENT_WITH_DESCR",name:"Орган выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:580,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-581",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:581,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-582",code:"DATE_RECORD_EGRN",name:"Дата записи регистрации в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:582,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-583",code:"IS_NATUR_RISK",name:"Банк отслеживает риск возникновения ответственности за воздействие недвижимого имущества, переданного в залог, на окружающую среду",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:583,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-584",code:"INDEX",name:"Индекс",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:584,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-585",code:"DATE_OF_DOCUMENT_WITH_DESCR",name:"Дата выдачи документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:585,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-586",code:"CITY",name:"Город/населенный пункт",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:586,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-587",code:"ACCEPT_TO_BORROWER_SOLVENCY",name:"Обеспечение приемлемо с т.з. независимости кредитоспособности заемщика от объектов залога",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:587,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-588",code:"LENGTH_VOLUME",name:"Длина/объем",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:588,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-589",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:589,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-590",code:"BUILDING",name:"дом",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:590,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-591",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:591,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-592",code:"SHARE_SIZE_PERCENTAGE",name:"Размер доли в праве общей долевой собственности, процент",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:592,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-593",code:"CADASTRAL_COST",name:"Кадастровая стоимость, в руб.",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:593,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-594",code:"READINESS_DEGREE",name:"Степень готовности",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:594,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-595",code:"HOUSE_TYPE",name:"Тип дома",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:595,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-596",code:"APARTMENT_CONDITION",name:"Состояние квартиры",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:596,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-597",code:"ROOM",name:"Квартира",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:597,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-598",code:"PR_REGISTR_BOND",name:"Признак оформления закладной",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:598,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-599",code:"ADDR_STR",name:"Адрес строкой",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:599,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-600",code:"REGION",name:"Регион",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:600,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-601",code:"BELONGING_SECURITY_ZONES_MOSCOW",name:"Принадлежность к охранным зонам г. Москвы",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:601,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-602",code:"NUMBER_REGISTER_AGENCY",name:"Номер регистрирующего органа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:602,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-603",code:"DISTANCE_FROM_BANK",name:"Удаление от ближайшей ТП Банка в км.",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:603,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-604",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:604,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-605",code:"YEAR_OF_CONSTRUCTION",name:"Год постройки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:605,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-606",code:"ADMINISTRATIVE_AREA",name:"Район",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:606,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-607",code:"VOLUME",name:"Объём (м3)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:607,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-608",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:608,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-609",code:"REGISTRATION_RECORD_NUMBER_USRN",name:"Номер записи регистрации в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:609,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-610",code:"CODE_KLADR",name:"Код КЛАДР",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:610,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-611",code:"APPOINTMENT_EGRN",name:"Назначение в ЕГРН",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:611,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-612",code:"STRUCTURE",name:"Строение",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:612,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-613",code:"FINANCIAL_MODEL_VALUATION",name:"Оценка с учетом финансовой модели заемщика ('N' - нет, 'Y' - да)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:613,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-614",code:"STREET",name:"Улица",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:614,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-615",code:"REGISTRATION_AUTHORITY_NAME",name:"Наименование регистрирующего органа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:615,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-616",code:"FLOOR",name:"Этаж расположения",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:616,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-617",code:"PR_EXIST_PEOPLE_MORTGAGE",name:"Наличие лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:617,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-618",code:"CODE_FIAS",name:"Код фиас",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:618,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-619",code:"DATE_PRAVO_DOCUMENT",name:"Дата правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DATE",isActive:!0,sortOrder:619,metadata:{type:"date",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-620",code:"NUMBER_OF_ROOMS",name:"Количество комнат",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:620,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-621",code:"AMOUNT_OF_PEOPLE",name:"Количество лиц, место жительства которых зарегистрировано в предмете ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:621,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-622",code:"SERIES_NUMBER_OF_DOCUMENT",name:"Серия и номер правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:622,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-623",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:623,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-624",code:"NAME_PRAVO_DOCUMENT_WITH_DESCR",name:"Наименование документа, содержащего описание и характеристики объекта недвижимости",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:624,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-625",code:"SPREAD",name:"Протяженность (м)",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:625,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-626",code:"NAME_OF_PRAVO_DOCUMENT",name:"Наименование правоподтверждающего документа",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: DIRECTORY",isActive:!0,sortOrder:626,metadata:{type:"directory",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-627",code:"CONDITIONAL_NUMBER",name:"Условный номер",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:627,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-628",code:"CODE_OKTMO",name:"Код ОКТМО",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:628,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-629",code:"LETTER",name:"Литера",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:629,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-630",code:"PR_NECES_NOTARY_CERTIF_CONTRACT",name:"Признак необходимости нотариального удостоверения договора ипотеки",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:630,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-631",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:631,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-632",code:"LIVING_SPACE",name:"Жилая площадь м2",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:632,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-633",code:"CODE_OKSM",name:"Код ОКСМ",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: STRING",isActive:!0,sortOrder:633,metadata:{type:"string",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-634",code:"TOTAL_AREA",name:"Общая площадь м2",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: NUMBER",isActive:!0,sortOrder:634,metadata:{type:"number",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-635",code:"IS_CULTURE_OBJECT",name:"Признак отнесения к объектам культурного наследия",description:"Тип имущества: Имущественный комплекс; Раздел отчета: 4.2.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:635,metadata:{type:"boolean",group:"Имущественный комплекс",required:!1,section:"4.2.8",naturalKey:!1}},{id:"zalog-attr-636",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:636,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-637",code:"VIN",name:"VIN",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:637,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-638",code:"FRAME_CHASSIS_NUMBER",name:"Номер шасси/рамы",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:638,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!0,section:"4.3",naturalKey:!0}},{id:"zalog-attr-639",code:"MILEAGE",name:"Пробег, км",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:639,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-640",code:"COLOR_BODY",name:"Цвет кузова (кабины)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:640,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-641",code:"PRICE_OF_NEW_CAR",name:"Цена нового ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:641,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-642",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:642,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-643",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:643,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-644",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:644,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-645",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:645,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-646",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:646,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-647",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:647,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-648",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:648,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-649",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:649,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-650",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:650,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-651",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:651,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-652",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:652,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-653",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:653,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-654",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:654,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-655",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:655,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-656",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:656,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-657",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:657,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-658",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:658,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-659",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:659,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-660",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:660,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-661",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:661,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-662",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:662,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-663",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:663,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-664",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:664,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-665",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:665,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-666",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:666,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-667",code:"ENGINE_VOLUME_SM",name:"Объем двигателя, см3",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:667,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-668",code:"BODY_NUMBER",name:"Номер кузова (кабины, прицепа)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:668,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-669",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:669,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-670",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:670,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-671",code:"MOTOR_NUMBER",name:"Номер двигателя",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:671,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-672",code:"NAME_OF_CERTIFICATE_TS",name:"Наименование свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:672,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-673",code:"NAME_OF_TS",name:"Наименование паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:673,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-674",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:674,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-675",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:675,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-676",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:676,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-677",code:"MODEL",name:"Модель",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:677,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-678",code:"BRAND",name:"Марка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:678,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-679",code:"COUNT_RTA",name:"Количество ДТП",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:679,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-680",code:"ACCIDENT_INVESTIGATION",name:"Следствие ДТП",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:680,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-681",code:"COLLATERAL_CONDITION",name:"Состояние ПЗ",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:681,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-682",code:"IDENTIFIED_DEFECTS",name:"Выявленные дефекты",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:682,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-683",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:683,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-684",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:684,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-685",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:685,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-686",code:"DATE_OF_CERTIFICATE_TS",name:"Дата свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:686,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-687",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:687,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-688",code:"DATE_OF_PASSPORT_TS",name:"Дата паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:688,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-689",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:689,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-690",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:690,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-691",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:691,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-692",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:692,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-693",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DATE",isActive:!0,sortOrder:693,metadata:{type:"date",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-694",code:"DATA_EXTERNAL_SYSTEM",name:"Данные из внешних систем",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:694,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-695",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: NUMBER",isActive:!0,sortOrder:695,metadata:{type:"number",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-696",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: BOOLEAN",isActive:!0,sortOrder:696,metadata:{type:"boolean",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-697",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:697,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-698",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:698,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-699",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:699,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-700",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: DIRECTORY",isActive:!0,sortOrder:700,metadata:{type:"directory",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-701",code:"TYPE_INCIDENTS",name:"Тип происшествия",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:701,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-702",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:702,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-703",code:"MOTOR_TYPE",name:"Тип двигателя",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:703,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-704",code:"SERIA_NUMBER_OF_CERTIFICATE_TS",name:"Серия и номер свидетельства о регистрации ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:704,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-705",code:"SERIAS_NUMBER_PASSPORT_TS",name:"Серия и номер паспорта ТС",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:705,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-706",code:"STATE",name:"Состояние",description:"Тип имущества: Наземные безрельсовые механические транспортные средства, прицепы; Раздел отчета: 4.3; Тип значения: STRING",isActive:!0,sortOrder:706,metadata:{type:"string",group:"Наземные безрельсовые механические транспортные средства, прицепы",required:!1,section:"4.3",naturalKey:!1}},{id:"zalog-attr-707",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:707,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-708",code:"PSEUDO_KEY",name:"Операция между группой 1 и 2(псевдо атрибут)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:708,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-709",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:709,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-710",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:710,metadata:{type:"string",group:"Машины и оборудование",required:!0,section:"4.4",naturalKey:!0}},{id:"zalog-attr-711",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:711,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-712",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:712,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-713",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:713,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-714",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:714,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-715",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:715,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-716",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:716,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-717",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:717,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-718",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:718,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-719",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:719,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-720",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:720,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-721",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:721,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-722",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:722,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-723",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:723,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-724",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:724,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-725",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:725,metadata:{type:"directory",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-726",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:726,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-727",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:727,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-728",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:728,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-729",code:"MODEL",name:"Модель",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:729,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-730",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:730,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-731",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:731,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-732",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:732,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-733",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:733,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-734",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:734,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-735",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:735,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-736",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:736,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-737",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:737,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-738",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:738,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-739",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: NUMBER",isActive:!0,sortOrder:739,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-740",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:740,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-741",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:741,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-742",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:742,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-743",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:743,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-744",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:744,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-745",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DIRECTORY",isActive:!0,sortOrder:745,metadata:{type:"directory",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-746",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: NUMBER",isActive:!0,sortOrder:746,metadata:{type:"number",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-747",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: BOOLEAN",isActive:!0,sortOrder:747,metadata:{type:"boolean",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-748",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:748,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-749",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:749,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-750",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:750,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-751",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:751,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-752",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:752,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-753",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:753,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-754",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: DATE",isActive:!0,sortOrder:754,metadata:{type:"date",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-755",code:"BRAND",name:"Марка",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:755,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-756",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Машины и оборудование; Раздел отчета: 4.4; Тип значения: STRING",isActive:!0,sortOrder:756,metadata:{type:"string",group:"Машины и оборудование",required:!1,section:"4.4",naturalKey:!1}},{id:"zalog-attr-757",code:"SERIAL_FACTORY_NUMBER",name:"Серийный (заводской) номер",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:757,metadata:{type:"string",group:"Воздушные суда",required:!0,section:"4.5",naturalKey:!0}},{id:"zalog-attr-758",code:"GLIDER_NUMBER",name:"Номер планера",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:758,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-759",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:759,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-760",code:"NAME_OF_MANUFACTURER",name:"Наименование изготовителя",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:760,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-761",code:"ADDRESS_BASE",name:"Адрес места базирования",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:761,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-762",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: BOOLEAN",isActive:!0,sortOrder:762,metadata:{type:"boolean",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-763",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: NUMBER",isActive:!0,sortOrder:763,metadata:{type:"number",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-764",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:764,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-765",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Воздушные суда; Раздел отчета: 4.5; Тип значения: STRING",isActive:!0,sortOrder:765,metadata:{type:"string",group:"Воздушные суда",required:!1,section:"4.5",naturalKey:!1}},{id:"zalog-attr-766",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Плавучие сооружения; Раздел отчета: 4.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:766,metadata:{type:"string",group:"Плавучие сооружения",required:!0,section:"4.6",naturalKey:!0}},{id:"zalog-attr-767",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Плавучие сооружения; Раздел отчета: 4.6; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:767,metadata:{type:"string",group:"Плавучие сооружения",required:!0,section:"4.6",naturalKey:!0}},{id:"zalog-attr-768",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:768,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!0,section:"4.6.2",naturalKey:!0}},{id:"zalog-attr-769",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: NUMBER",isActive:!0,sortOrder:769,metadata:{type:"number",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-770",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:770,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-771",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:771,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-772",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:772,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-773",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:773,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-774",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:774,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-775",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:775,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-776",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:776,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-777",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:777,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-778",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов; Раздел отчета: 4.6.2; Тип значения: STRING",isActive:!0,sortOrder:778,metadata:{type:"string",group:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",required:!1,section:"4.6.2",naturalKey:!1}},{id:"zalog-attr-779",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:779,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-780",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:780,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-781",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: NUMBER",isActive:!0,sortOrder:781,metadata:{type:"number",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-782",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:782,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-783",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:783,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-784",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:784,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-785",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:785,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!0,section:"4.6.4",naturalKey:!0}},{id:"zalog-attr-786",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:786,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-787",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:787,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-788",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:788,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-789",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для иных целей; Раздел отчета: 4.6.4; Тип значения: STRING",isActive:!0,sortOrder:789,metadata:{type:"string",group:"Суда, используемые для иных целей",required:!1,section:"4.6.4",naturalKey:!1}},{id:"zalog-attr-790",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:790,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-791",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: NUMBER",isActive:!0,sortOrder:791,metadata:{type:"number",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-792",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:792,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-793",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:793,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-794",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:794,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-795",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:795,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-796",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:796,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!0,section:"4.6.3",naturalKey:!0}},{id:"zalog-attr-797",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:797,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-798",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:798,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-799",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:799,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-800",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для рыболовства; Раздел отчета: 4.6.3; Тип значения: STRING",isActive:!0,sortOrder:800,metadata:{type:"string",group:"Суда, используемые для рыболовства",required:!1,section:"4.6.3",naturalKey:!1}},{id:"zalog-attr-801",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:801,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-802",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:802,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-803",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:803,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-804",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:804,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-805",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:805,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!0,section:"4.6.5",naturalKey:!0}},{id:"zalog-attr-806",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:806,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-807",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:807,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-808",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:808,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-809",code:"DATE_OF_CADASTRAL_COST",name:"Дата определения кадастровой стоимости",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:809,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-810",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: STRING",isActive:!0,sortOrder:810,metadata:{type:"string",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-811",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Плавучие сооружения, не являющиеся судами; Раздел отчета: 4.6.5; Тип значения: NUMBER",isActive:!0,sortOrder:811,metadata:{type:"number",group:"Плавучие сооружения, не являющиеся судами",required:!1,section:"4.6.5",naturalKey:!1}},{id:"zalog-attr-812",code:"PL_OF_STATE_REGIST_OF_THE_VESSEL",name:"Порт (место) государственной регистрации судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:812,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-813",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:813,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-814",code:"ENGINE_POWER_KVT",name:"Мощность двигателя, кв.",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:814,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-815",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:815,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-816",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: NUMBER",isActive:!0,sortOrder:816,metadata:{type:"number",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-817",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:817,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-818",code:"FACTORY_NUMBER",name:"Заводской/серийный номер",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:818,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!0,section:"4.6.1",naturalKey:!0}},{id:"zalog-attr-819",code:"PASSENGER_CAPACITY_OF_THE_VESSEL",name:"Пассажировместимость судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:819,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-820",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:820,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-821",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:821,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-822",code:"ENGINE_POWER_LS",name:"Мощность двигателя, л. с.",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:822,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-823",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:823,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-824",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:824,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-825",code:"ID_OF_SHIP",name:"Идентификационный номер морской подвижной службы, присвоенный судовой радиостанции (MMSI)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:825,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-826",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:826,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-827",code:"NAME_OF_OTHER_TYPE",name:"Наименование иного типа маломерного судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:827,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-828",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:828,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-829",code:"LENGTH_SHIP",name:"Длина судна в метрах",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:829,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-830",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:830,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-831",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:831,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-832",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:832,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-833",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:833,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-834",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:834,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-835",code:"REGISTER_NUMBER",name:"Регистровый номер",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:835,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-836",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:836,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-837",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:837,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-838",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:838,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-839",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:839,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-840",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:840,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-841",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:841,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-842",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:842,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-843",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:843,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-844",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:844,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-845",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:845,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-846",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:846,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-847",code:"CLASS_OF_SHIP",name:"Класс судна",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:847,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-848",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:848,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-849",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:849,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-850",code:"MODEL",name:"Модель",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:850,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-851",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:851,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-852",code:"WEIGHT_OF_SHIP",name:"Масса судна в кг",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:852,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-853",code:"IMO",name:"Идентификационный номер судна (IMO)",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:853,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-854",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:854,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-855",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Суда, используемые для перевозки пассажиров и их багажа; Раздел отчета: 4.6.1; Тип значения: STRING",isActive:!0,sortOrder:855,metadata:{type:"string",group:"Суда, используемые для перевозки пассажиров и их багажа",required:!1,section:"4.6.1",naturalKey:!1}},{id:"zalog-attr-856",code:"NET_ADDRESS",name:"Сетевой номер",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:856,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!0,section:"4.7",naturalKey:!0}},{id:"zalog-attr-857",code:"RZHD_MPS",name:"Заводской номер/ номер РЖД/МПС",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:857,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!0,section:"4.7",naturalKey:!0}},{id:"zalog-attr-858",code:"DATE_OF_TRANSITION_RIGTHS",name:"Дата перехода права собственности на предмет залога к залогодателю по договору поставки",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:858,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-859",code:"PR_OFFICIAL_DEALER",name:"Признак официального дилера",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:859,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-860",code:"CURRENCY_OF_PURCHASE",name:"Валюта приобретения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:860,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-861",code:"PRICE_OF_PURCHASE",name:"Цена приобретения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: NUMBER",isActive:!0,sortOrder:861,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-862",code:"INN_OF_PROVIDER",name:"ИНН поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:862,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-863",code:"MODEL",name:"Модель",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:863,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-864",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:864,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-865",code:"INVENTORY_NUMBER",name:"Инвентарный номер",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:865,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-866",code:"NUMBER_OF_DEALER_CERTIFICATE",name:"Номер дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:866,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-867",code:"OGRN_OF_PROVIDER",name:"ОГРН поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:867,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-868",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:868,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-869",code:"DATE_WAGON_TECHNICAL_PASSPORT",name:"Дата технического паспорта вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:869,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-870",code:"PR_ACCREDIT_AS_PARTNER_OF_BANK",name:"Признак аккредитации в качестве Партнера Банка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:870,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-871",code:"FULL_NAME_OF_PROVIDER",name:"Полное наименование поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:871,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-872",code:"ENDDATE_OF_DEALER_CERTIFICATE",name:"Дата окончания дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:872,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-873",code:"COUNTRY_OF_ORIGIN",name:"Страна производства",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:873,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-874",code:"PR_BUY_IN_FUTURE",name:"Признак приобретаемого в будущем за счет кредитных средств имущества",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:874,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-875",code:"DATE_OF_DEALER_CERTIFICATE",name:"Дата дилерского сертификата/соглашения",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:875,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-876",code:"DATE_ACCREDIT_AS_PARTNER_OF_BANK",name:"Дата аккредитации в качестве Партнера банка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: DATE",isActive:!0,sortOrder:876,metadata:{type:"date",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-877",code:"MANUFACTORY_ORGANIZATION",name:"Организация - производитель",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:877,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-878",code:"LEGAL_ADDRES",name:"Юридический адрес поставщика",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:878,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-879",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: BOOLEAN",isActive:!0,sortOrder:879,metadata:{type:"boolean",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-880",code:"WAGON_TECHNICAL_PASSPORT_NUMBER",name:"Номер технического паспорта вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:880,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-881",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: NUMBER",isActive:!0,sortOrder:881,metadata:{type:"number",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-882",code:"ADDRESS_LOCATION",name:"Адрес места нахождения (депо приписки)",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:882,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-883",code:"CARRIAGE_NUMBER",name:"Номер вагона",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:883,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-884",code:"CODE_OKATO",name:"Код ОКАТО",description:"Тип имущества: Железнодорожный подвижной состав; Раздел отчета: 4.7; Тип значения: STRING",isActive:!0,sortOrder:884,metadata:{type:"string",group:"Железнодорожный подвижной состав",required:!1,section:"4.7",naturalKey:!1}},{id:"zalog-attr-885",code:"REGISTRATION_RECORD",name:"Регистрационная запись",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:885,metadata:{type:"string",group:"Космические объекты",required:!0,section:"4.8",naturalKey:!0}},{id:"zalog-attr-886",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: BOOLEAN",isActive:!0,sortOrder:886,metadata:{type:"boolean",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-887",code:"YEAR_OF_ISSUE",name:"Год выпуска",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: NUMBER",isActive:!0,sortOrder:887,metadata:{type:"number",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-888",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING",isActive:!0,sortOrder:888,metadata:{type:"string",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-889",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Космические объекты; Раздел отчета: 4.8; Тип значения: STRING",isActive:!0,sortOrder:889,metadata:{type:"string",group:"Космические объекты",required:!1,section:"4.8",naturalKey:!1}},{id:"zalog-attr-890",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:890,metadata:{type:"string",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-891",code:"NUMBER_OF_PRODUCT_UNITS",name:"Количество единиц измерения товара",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER; Ключевой атрибут: Да",isActive:!0,sortOrder:891,metadata:{type:"number",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-892",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:892,metadata:{type:"string",group:"Товары в обороте",required:!0,section:"4.9",naturalKey:!0}},{id:"zalog-attr-893",code:"FULL_NAME_OF_LESSOR",name:"Полное наименование арендодателя места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:893,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-894",code:"CODE_OKSM_STORAGE",name:"Код ОКСМ (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:894,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-895",code:"CODE_OKATO_STORAGE",name:"Код ОКАТО (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:895,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-896",code:"INDEX_STORAGE",name:"Индекс (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:896,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-897",code:"INN_OF_LESSOR",name:"ИНН арендодателя места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:897,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-898",code:"CITY_STORAGE",name:"Город/населенный пункт (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:898,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-899",code:"ADDR_STR_STORAGE",name:"Адрес строкой (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:899,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-900",code:"STRUCTURE_STORAGE",name:"Строение (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:900,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-901",code:"BUILDING_STORAGE",name:"Дом (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:901,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-902",code:"ADMINISTRATIVE_AREA_STORAGE",name:"Район (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:902,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-903",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:903,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-904",code:"ROOM_STORAGE",name:"Квартира (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:904,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-905",code:"LETTER_STORAGE",name:"Литера (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:905,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-906",code:"UNIT",name:"Единица измерения товара",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:906,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-907",code:"CODE_KLADR_STORAGE",name:"Код КЛАДР (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:907,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-908",code:"CODE_OKTMO_STORAGE",name:"Код ОКТМО (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:908,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-909",code:"REGION_STORAGE",name:"Регион (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:909,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-910",code:"END_DATE_OF_ARRANG_OF_STORAGE_PL",name:"Дата окончания договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DATE",isActive:!0,sortOrder:910,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-911",code:"CODE_FIAS_STORAGE",name:"Код фиас (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:911,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-912",code:"STREET_STORAGE",name:"Улица (места хранения)",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:912,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-913",code:"DATE_OF_ARRANG_OF_STORAGE_PLACE",name:"Дата договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DATE",isActive:!0,sortOrder:913,metadata:{type:"date",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-914",code:"COST_PER_UNIT_OF_MEASURE_GOODS",name:"Стоимость за единицу измерения товара в руб.",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:914,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-915",code:"TYPE_STORAGE_PLACE_OTHER",name:"Вид иного типа места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:915,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-916",code:"STORAGE_SPACE",name:"Количество места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:916,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-917",code:"RIGHT_STORAGE_OTHER",name:"Вид иного права в отношении места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:917,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-918",code:"RIGHT_STORAGE",name:"Право в отношении места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DIRECTORY",isActive:!0,sortOrder:918,metadata:{type:"directory",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-919",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: BOOLEAN",isActive:!0,sortOrder:919,metadata:{type:"boolean",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-920",code:"NUMBER_OF_STORAGE_LOCATIONS",name:"Количество мест хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:920,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-921",code:"TYPE_STORAGE_PLACE",name:"Тип места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: DIRECTORY",isActive:!0,sortOrder:921,metadata:{type:"directory",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-922",code:"ACTUAL_BALANCE_OF_GOODS",name:"Фактический остаток товара, тыс.руб.",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: NUMBER",isActive:!0,sortOrder:922,metadata:{type:"number",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-923",code:"VENDOR_CODE",name:"Артикул",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:923,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-924",code:"NUMBER_OF_ARRANGEMENT_RENT",name:"Номер договора аренды места хранения",description:"Тип имущества: Товары в обороте; Раздел отчета: 4.9; Тип значения: STRING",isActive:!0,sortOrder:924,metadata:{type:"string",group:"Товары в обороте",required:!1,section:"4.9",naturalKey:!1}},{id:"zalog-attr-925",code:"NAME_OF_PROPERTY",name:"Наименование",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:925,metadata:{type:"string",group:"Все имущество залогодателя",required:!0,section:"",naturalKey:!0}},{id:"zalog-attr-926",code:"OWNER_TIN",name:"Значение идентификационного кода залогодателя",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING; Ключевой атрибут: Да",isActive:!0,sortOrder:926,metadata:{type:"string",group:"Все имущество залогодателя",required:!0,section:"",naturalKey:!0}},{id:"zalog-attr-927",code:"HAVEL_MARKET",name:"Наличие ликвидного рынка",description:"Тип имущества: Все имущество залогодателя; Тип значения: BOOLEAN",isActive:!0,sortOrder:927,metadata:{type:"boolean",group:"Все имущество залогодателя",required:!1,section:"",naturalKey:!1}},{id:"zalog-attr-928",code:"TYPE_COLLATERAL",name:"Тип обеспечения(основной/дополнительный)",description:"Тип имущества: Все имущество залогодателя; Тип значения: STRING",isActive:!0,sortOrder:928,metadata:{type:"string",group:"Все имущество залогодателя",required:!1,section:"",naturalKey:!1}}],createdAt:t,updatedAt:t}];return this.saveDictionaries(r),r}}const Sn=new pM,Ey=()=>{const e=Sn.getDictionaryByCode("collateral_attributes_zalog");if(!e)return["Недвижимость","Движимое имущество","Имущественные права"];const t=new Set;e.items.forEach(a=>{var n;(n=a.metadata)!=null&&n.group&&t.add(a.metadata.group)});const r=Array.from(t).sort();return r.length===0?["Недвижимость","Движимое имущество","Имущественные права"]:r},Uh=e=>{const t=Sn.getDictionaryByCode("collateral_attributes_zalog");if(!t)return Z4(e);let r=t.items.filter(a=>{var n;return((n=a.metadata)==null?void 0:n.group)===e});return r.length===0&&(r=t.items.filter(a=>{var s;const n=((s=a.metadata)==null?void 0:s.group)||"";return n.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(n.toLowerCase())})),r.length===0&&(r=t.items.filter(a=>{const n=a.code||"",s=a.name||"";return n.toLowerCase().includes(e.toLowerCase())||s.toLowerCase().includes(e.toLowerCase())})),r.length===0?Z4(e):r.map(a=>{var n,s,o,A,c,l;return{code:a.code||"",name:a.name,type:(((n=a.metadata)==null?void 0:n.type)||"string").toLowerCase(),required:((s=a.metadata)==null?void 0:s.required)===!0||((o=a.metadata)==null?void 0:o.naturalKey)===!0,naturalKey:((A=a.metadata)==null?void 0:A.naturalKey)===!0,group:((c=a.metadata)==null?void 0:c.group)||"",section:((l=a.metadata)==null?void 0:l.section)||""}}).sort((a,n)=>a.naturalKey&&!n.naturalKey?-1:!a.naturalKey&&n.naturalKey?1:a.name.localeCompare(n.name))};function Z4(e){return[{code:"NAME_OF_PROPERTY",name:"Наименование объекта",type:"string",required:!0,naturalKey:!0,group:e,section:"main"},{code:"OWNER_TIN",name:"ИНН собственника/залогодателя",type:"string",required:!0,naturalKey:!1,group:e,section:"main"},{code:"ADDRESS_BASE",name:"Адрес объекта",type:"string",required:!0,naturalKey:!1,group:e,section:"main"},{code:"TYPE_COLLATERAL",name:"Тип залога",type:"string",required:!0,naturalKey:!1,group:e,section:"evaluation"},{code:"HAVEL_MARKET",name:"Рыночная стоимость",type:"number",required:!0,naturalKey:!1,group:e,section:"evaluation"}]}const yC=e=>{const t=[],r=[],a=[],n=[],s=["NAME_OF_PROPERTY","OWNER_TIN","ADDRESS_BASE"],o=["TYPE_COLLATERAL","HAVEL_MARKET"];return e.forEach(A=>{s.includes(A.code)?t.push(A):o.includes(A.code)?a.push(A):A.code.includes("DOCUMENT")||A.code.includes("FILE")?n.push(A):r.push(A)}),{main:t,characteristics:r,evaluation:a,documents:n}},hM=({initialValues:e,onSubmit:t,onCancel:r,loading:a=!1})=>{const n=$s(),[s]=ne.useForm(),[o,A]=K.useState("1"),[c,l]=K.useState((e==null?void 0:e.cbCode)||0),[d,f]=K.useState(null),[p,u]=K.useState(e==null?void 0:e.propertyType),[g,h]=K.useState(!1),[y,x]=K.useState((e==null?void 0:e.partners)||[]),[v,E]=K.useState(e==null?void 0:e.address),[D,B]=K.useState((e==null?void 0:e.characteristics)||{}),[I,_]=K.useState((e==null?void 0:e.documents)||[]),[S,O]=K.useState(!1),[M,T]=K.useState([]),[R,L]=K.useState(""),N=K.useMemo(()=>g?Ey():[],[g]),P=K.useMemo(()=>p?Uh(p):[],[p]),U=K.useMemo(()=>yC(P),[P]);K.useEffect(()=>{let ve=!0;return(async()=>{try{await Sn.syncCollateralAttributesFromUnified()}catch(ae){console.warn("Не удалось синхронизировать атрибуты залога из unified-attributes.json",ae)}finally{ve&&h(!0)}})(),()=>{ve=!1}},[]),K.useEffect(()=>{if(e&&(s.setFieldsValue({...e,egrnStatementDate:e.egrnStatementDate?We(e.egrnStatementDate):void 0}),e.classification)){const ve=Y4(e.classification.level1,e.classification.level2);f(ve)}},[e,s]);const V=(ve,ae)=>{s.setFieldsValue({classification:ve}),l(ae);const Ke=Y4(ve.level1,ve.level2);f(Ke),Ke!==d&&(B({}),s.setFieldsValue({characteristics:{}}))},ie=ve=>{u(ve),B({}),s.setFieldsValue({characteristics:{}})},W=K.useMemo(()=>{if(!(e!=null&&e.egrnStatementDate)||!e.mainCategory||e.mainCategory!=="real_estate")return!1;const ve=We(e.egrnStatementDate);return We().diff(ve,"days")>30},[e==null?void 0:e.egrnStatementDate,e==null?void 0:e.mainCategory]),z=()=>{const ve=e==null?void 0:e.id,ae=(v==null?void 0:v.cadastralNumber)||(D==null?void 0:D.objectCadastralNumber),Ke=s.getFieldValue("name");n(`/egrn?objectId=${ve}&cadastralNumber=${ae}&objectName=${encodeURIComponent(Ke||"")}`),Ne.info("Переход в модуль ЕГРН для заказа выписки")},G=()=>{const ve=s.getFieldValue("reference");ve?window.open(`#/portfolio?reference=${ve}`,"_blank"):Ne.warning("Не указан REFERENCE сделки")};K.useEffect(()=>{S&&(async()=>{try{const ae="./",Ke=new URL(ae,window.location.origin),Ee=Ke.pathname.endsWith("/")?Ke.pathname:`${Ke.pathname}/`,me=`${Ke.origin}${Ee}portfolioData.json?v=${Date.now()}`,le=await fetch(me,{cache:"no-store"});if(le.ok){const He=await le.json();T(He)}}catch(ae){console.warn("Не удалось загрузить договоры из портфеля",ae)}})()},[S]);const b=ve=>{if(s.setFieldsValue({reference:ve.reference,contractNumber:ve.contractNumber,contractId:ve.contractNumber}),ve.borrower&&ve.inn){const ae={id:Vs(),type:"legal",role:"owner",organizationName:ve.borrower,inn:String(ve.inn),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},Ke=y.filter(Ee=>Ee.role!=="owner");x([...Ke,ae])}if(ve.pledger){const ae={id:Vs(),type:"legal",role:"pledgor",organizationName:ve.pledger,inn:String(ve.inn||""),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},Ke=y.filter(Ee=>Ee.role!=="pledgor");x([...Ke,ae])}O(!1),Ne.success("Договор выбран, данные заемщика и залогодателя заполнены")},k=K.useMemo(()=>{if(!R)return M.slice(0,50);const ve=R.toLowerCase();return M.filter(ae=>{var Ke,Ee,me,le;return((Ke=ae.contractNumber)==null?void 0:Ke.toLowerCase().includes(ve))||((Ee=ae.reference)==null?void 0:Ee.toString().toLowerCase().includes(ve))||((me=ae.borrower)==null?void 0:me.toLowerCase().includes(ve))||((le=ae.pledger)==null?void 0:le.toLowerCase().includes(ve))}).slice(0,50)},[M,R]),j=()=>{const ve=s.getFieldValue("contractId"),ae=s.getFieldValue("contractNumber"),Ke=s.getFieldValue("reference");ve?n(`/portfolio?contractId=${ve}`):ae?n(`/portfolio?contractNumber=${ae}`):Ke?n(`/portfolio?reference=${Ke}`):Ne.warning("Не указан договор")},q=[{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120},{title:"Номер договора",dataIndex:"contractNumber",key:"contractNumber",width:150},{title:"Заемщик",dataIndex:"borrower",key:"borrower",width:200},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200},{title:"ИНН",dataIndex:"inn",key:"inn",width:120},{title:"Действия",key:"actions",width:100,render:(ve,ae)=>i.jsx(Be,{type:"link",size:"small",onClick:()=>b(ae),children:"Выбрать"})}],Y=async()=>{try{const ve=await s.validateFields(),ae=new Date,Ke={id:(e==null?void 0:e.id)||Vs(),...ve,cbCode:c,partners:y,address:v||void 0,characteristics:D,documents:I,propertyType:p,egrnStatementDate:ve.egrnStatementDate?ve.egrnStatementDate.format("YYYY-MM-DD"):void 0,createdAt:(e==null?void 0:e.createdAt)||ae,updatedAt:ae};t(Ke)}catch(ve){console.error("Validation failed:",ve),Ne.error("Пожалуйста, заполните все обязательные поля")}},de=K.useMemo(()=>y.find(ve=>ve.role==="owner"||ve.role==="pledgor"),[y]),ue=K.useMemo(()=>y.find(ve=>ve.role==="pledgor"),[y]),pe=s.getFieldValue("mainCategory")==="real_estate",ye=[{key:"1",label:"Главная",children:i.jsxs("div",{children:[i.jsx(ne.Item,{name:"name",label:"Наименование имущества (NAME_OF_PROPERTY)",rules:[{required:!0,message:"Введите наименование"}],children:i.jsx(Re,{placeholder:"Наименование имущества"})}),i.jsx(ne.Item,{label:"Адрес",children:i.jsx(uM,{value:v,onChange:E,useDaData:!0,showGeoPicker:!1})}),i.jsx(jt,{orientation:"left",children:"Клиент"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Заемщик",children:i.jsx(Re,{value:(de==null?void 0:de.organizationName)||`${(de==null?void 0:de.lastName)||""} ${(de==null?void 0:de.firstName)||""} ${(de==null?void 0:de.middleName)||""}`.trim(),disabled:!0,placeholder:"Выберите заемщика во вкладке партнеры"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"ИНН заемщика",children:i.jsx(Re,{value:de==null?void 0:de.inn,disabled:!0,placeholder:"ИНН"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"Залогодатель (OWNER_TIN)",children:i.jsx(Re,{value:(ue==null?void 0:ue.organizationName)||`${(ue==null?void 0:ue.lastName)||""} ${(ue==null?void 0:ue.firstName)||""} ${(ue==null?void 0:ue.middleName)||""}`.trim(),disabled:!0,placeholder:"Выберите залогодателя во вкладке партнеры"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{label:"ИНН залогодателя (OWNER_TIN)",children:i.jsx(Re,{value:ue==null?void 0:ue.inn,disabled:!0,placeholder:"ИНН залогодателя"})})})]}),i.jsx(ne.Item,{name:"propertyType",label:"Тип имущества (из справочника атрибутов залога)",children:i.jsx(Ye,{placeholder:"Выберите тип имущества",onChange:ie,value:p,children:N.map(ve=>i.jsx(Ye.Option,{value:ve,children:ve},ve))})}),i.jsx(ne.Item,{name:"mainCategory",label:"Основная категория",rules:[{required:!0,message:"Выберите категорию"}],children:i.jsxs(Ye,{placeholder:"Выберите категорию",children:[i.jsx(Ye.Option,{value:"real_estate",children:"Недвижимость"}),i.jsx(Ye.Option,{value:"movable",children:"Движимое имущество"}),i.jsx(Ye.Option,{value:"property_rights",children:"Имущественные права"})]})}),i.jsx(ne.Item,{name:"classification",label:"Классификация объекта",rules:[{validator:async(ve,ae)=>!ae||!ae.level0||!ae.level1||!ae.level2?Promise.reject(new Error("Заполните все уровни классификации")):c===0?Promise.reject(new Error("Некорректная комбинация классификации")):Promise.resolve()}],children:i.jsx(iM,{onChange:V})})]})},{key:"2",label:"Характеристики",children:i.jsxs("div",{children:[i.jsx("p",{style:{marginBottom:16,color:"#666"},children:"Все характеристики объекта согласно справочнику атрибутов залога"}),p?i.jsxs("div",{children:[U.characteristics.map(ve=>i.jsx(ne.Item,{name:["characteristics",ve.code],label:ve.name,rules:ve.required?[{required:!0,message:`Заполните ${ve.name}`}]:[],children:ve.type==="number"?i.jsx(Re,{type:"number",placeholder:ve.name}):ve.type==="boolean"?i.jsx(Ni,{}):ve.type==="date"?i.jsx(Rr,{style:{width:"100%"}}):i.jsx(Re,{placeholder:ve.name})},ve.code)),U.characteristics.length===0&&i.jsx("p",{style:{color:"#999",textAlign:"center",padding:"20px"},children:"Характеристики определяются после выбора типа имущества на главной вкладке"})]}):i.jsx("p",{style:{color:"#999",textAlign:"center",padding:"20px"},children:"Выберите тип имущества на главной вкладке для отображения характеристик"})]})},{key:"3",label:"Документы",children:i.jsxs("div",{children:[i.jsx(fM,{value:I,onChange:_}),i.jsx(jt,{}),i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},children:[i.jsx(Be,{type:"link",icon:i.jsx(eA,{}),onClick:G,style:{paddingLeft:0},children:"Перейти в Залоговое досье"}),pe&&i.jsxs("div",{children:[i.jsx(ne.Item,{name:"egrnStatementDate",label:"Дата выписки ЕГРН",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),W&&i.jsx(ne.Item,{children:i.jsx(Be,{type:"primary",danger:!0,icon:i.jsx(U1,{}),onClick:z,children:"Заказать выписку ЕГРН (выписка более 30 дней)"})})]})]})]})},{key:"4",label:"Заметки",children:i.jsxs("div",{children:[i.jsx(ne.Item,{name:"notes",label:"Комментарии",children:i.jsx(Re.TextArea,{rows:6,placeholder:"Комментарии по данному имуществу"})}),i.jsx(ne.Item,{name:"suspensiveConditions",label:"Отлагательные условия",children:i.jsx(Re.TextArea,{rows:6,placeholder:"Отлагательные условия по данному имуществу"})})]})},{key:"5",label:"Оценка",children:i.jsxs("div",{children:[i.jsx(ne.Item,{name:"marketValue",label:"Стоимость (рыночная)",children:i.jsx(Re,{type:"number",placeholder:"Рыночная стоимость, руб.",addonAfter:"₽"})}),i.jsx(ne.Item,{name:"pledgeValue",label:"Залоговая стоимость",children:i.jsx(Re,{type:"number",placeholder:"Залоговая стоимость, руб.",addonAfter:"₽"})}),i.jsx(ne.Item,{name:["characteristics","HAVEL_MARKET"],label:"Наличие ликвидного рынка (HAVEL_MARKET)",valuePropName:"checked",children:i.jsx(Ni,{})}),i.jsx(ne.Item,{name:["characteristics","TYPE_COLLATERAL"],label:"Тип обеспечения (TYPE_COLLATERAL - основной/дополнительный)",children:i.jsxs(Ye,{placeholder:"Выберите тип обеспечения",children:[i.jsx(Ye.Option,{value:"основной",children:"Основной"}),i.jsx(Ye.Option,{value:"дополнительный",children:"Дополнительный"})]})}),U.evaluation.map(ve=>i.jsx(ne.Item,{name:["characteristics",ve.code],label:ve.name,rules:ve.required?[{required:!0,message:`Заполните ${ve.name}`}]:[],children:ve.type==="number"?i.jsx(Re,{type:"number",placeholder:ve.name}):ve.type==="boolean"?i.jsx(Ni,{}):ve.type==="date"?i.jsx(Rr,{style:{width:"100%"}}):i.jsx(Re,{placeholder:ve.name})},ve.code))]})},{key:"6",label:"Договор",children:i.jsx("div",{children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"middle",children:[i.jsx(Be,{type:"primary",icon:i.jsx(Pa,{}),onClick:()=>O(!0),children:"Выбрать договор из портфеля"}),i.jsx(ne.Item,{name:"reference",label:"REFERENCE сделки",children:i.jsx(Re,{placeholder:"REFERENCE сделки из портфеля"})}),i.jsx(ne.Item,{name:"contractNumber",label:"Номер договора",children:i.jsx(Re,{placeholder:"Номер договора залога"})}),i.jsx(ne.Item,{name:"contractId",label:"ID договора (для навигации)",hidden:!0,children:i.jsx(Re,{})}),(s.getFieldValue("reference")||s.getFieldValue("contractNumber"))&&i.jsx(Be,{type:"default",icon:i.jsx(eA,{}),onClick:j,children:"Перейти к договору в портфеле"})]})})},{key:"7",label:"Партнеры",children:i.jsxs("div",{children:[i.jsx("p",{style:{marginBottom:16,color:"#666"},children:"Добавьте информацию о собственниках, залогодателях и других участниках сделки"}),i.jsx(oM,{value:y,onChange:x})]})}];return g?i.jsxs(ne,{form:s,layout:"vertical",initialValues:e,size:"middle",style:{padding:"0 8px"},children:[i.jsx(Ts,{activeKey:o,onChange:A,items:ye,style:{minHeight:"400px"},size:"small"}),i.jsx("div",{style:{marginTop:16,textAlign:"right",borderTop:"1px solid #f0f0f0",paddingTop:12,position:"sticky",bottom:0,background:"#fff",zIndex:10},children:i.jsxs(Fe,{children:[i.jsx(Be,{onClick:r,icon:i.jsx(n_,{}),children:"Отмена"}),i.jsx(Be,{type:"primary",onClick:Y,loading:a,icon:i.jsx(rm,{}),children:e?"Сохранить изменения":"Создать карточку"})]})}),i.jsxs(dr,{title:"Выбор договора из портфеля",open:S,onCancel:()=>O(!1),footer:null,width:800,children:[i.jsx(Re,{placeholder:"Поиск по REFERENCE, номеру договора, заемщику, залогодателю",prefix:i.jsx(Pa,{}),value:R,onChange:ve=>L(ve.target.value),style:{marginBottom:16}}),i.jsx(nr,{columns:q,dataSource:k,rowKey:ve=>`${ve.reference}-${ve.contractNumber}`,pagination:{pageSize:10},size:"small"})]})]}):null};class mM{constructor(){sr(this,"db",Yr)}async initDatabase(){try{this.db.isOpen()||await this.db.open(),console.log("Inspection database initialized successfully")}catch(t){throw console.error("Failed to initialize inspection database:",t),t}}async getInspections(){try{return await this.db.inspections.toArray()}catch(t){return console.error("Failed to get inspections:",t),[]}}async getInspectionById(t){try{return await this.db.inspections.get(t)}catch(r){console.error("Failed to get inspection:",r);return}}async getInspectionsByCardId(t){try{return await this.db.inspections.where("collateralCardId").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by card ID:",r),[]}}async getInspectionsByType(t){try{return await this.db.inspections.where("inspectionType").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by type:",r),[]}}async getInspectionsByStatus(t){try{return await this.db.inspections.where("status").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by status:",r),[]}}async getInspectionsByInspector(t){try{return await this.db.inspections.where("inspectorId").equals(t).toArray()}catch(r){return console.error("Failed to get inspections by inspector:",r),[]}}async createInspection(t){try{const r=new Date,a={...t,id:`insp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:r,updatedAt:r,history:t.history||[]};return await this.db.inspections.add(a),a.id}catch(r){throw console.error("Failed to create inspection:",r),r}}async generateClientLink(t){try{const r=await this.getInspectionById(t);if(!r)throw new Error("Inspection not found");const a=`${t}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n=new Date;n.setDate(n.getDate()+7);const s="./",o=s.endsWith("/")?s:`${s}/`,A=`${window.location.origin}${o}#/inspection/${a}`;await this.updateInspection(t,{clientLink:A,clientLinkExpiresAt:n,status:"sent_to_client",history:[...r.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"sent_to_client",user:r.createdByUser||"Система",userRole:"creator",comment:"Ссылка отправлена клиенту",status:"sent_to_client"}]});const c=JSON.parse(localStorage.getItem("inspection_tokens")||"{}");return c[a]={inspectionId:t,expiresAt:n.toISOString()},localStorage.setItem("inspection_tokens",JSON.stringify(c)),A}catch(r){throw console.error("Failed to generate client link:",r),r}}async getInspectionByToken(t){try{const a=JSON.parse(localStorage.getItem("inspection_tokens")||"{}")[t];return!a||new Date(a.expiresAt)<new Date?null:await this.getInspectionById(a.inspectionId)||null}catch(r){return console.error("Failed to get inspection by token:",r),null}}async submitForReview(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");await this.updateInspection(t,{status:"submitted_for_review",history:[...a.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"submitted",user:r,userRole:"inspector",comment:"Осмотр отправлен на проверку",status:"submitted_for_review"}]})}catch(a){throw console.error("Failed to submit for review:",a),a}}async approveInspection(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");await this.updateInspection(t,{status:"approved",approvedBy:r,approvedAt:new Date,history:[...a.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"approved",user:r,userRole:"approver",comment:"Осмотр согласован",status:"approved"}]})}catch(a){throw console.error("Failed to approve inspection:",a),a}}async requestRevision(t,r,a){try{const n=await this.getInspectionById(t);if(!n)throw new Error("Inspection not found");await this.updateInspection(t,{status:"needs_revision",revisionRequestedBy:r,revisionRequestedAt:new Date,revisionComment:a,history:[...n.history||[],{id:`hist-${Date.now()}`,date:new Date,action:"revision_requested",user:r,userRole:"reviewer",comment:a||"Требуется доработка",status:"needs_revision"}]})}catch(n){throw console.error("Failed to request revision:",n),n}}async addPhoto(t,r){try{const a=await this.getInspectionById(t);if(!a)throw new Error("Inspection not found");const n={id:`photo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...r,takenAt:new Date};await this.updateInspection(t,{photos:[...a.photos||[],n]})}catch(a){throw console.error("Failed to add photo:",a),a}}async updateInspection(t,r){try{if(!await this.db.inspections.get(t))throw new Error("Inspection not found");await this.db.inspections.update(t,{...r,updatedAt:new Date})}catch(a){throw console.error("Failed to update inspection:",a),a}}async deleteInspection(t){try{await this.db.inspections.delete(t)}catch(r){throw console.error("Failed to delete inspection:",r),r}}async deleteInspectionsByCardId(t){try{await this.db.inspections.where("collateralCardId").equals(t).delete()}catch(r){throw console.error("Failed to delete inspections by card ID:",r),r}}async getInspectionStats(){try{const t=await this.db.inspections.toArray(),r={total:t.length,byType:{},byStatus:{},byCondition:{}};return t.forEach(a=>{r.byType[a.inspectionType]=(r.byType[a.inspectionType]||0)+1,r.byStatus[a.status]=(r.byStatus[a.status]||0)+1,r.byCondition[a.condition]=(r.byCondition[a.condition]||0)+1}),r}catch(t){return console.error("Failed to get inspection stats:",t),{total:0,byType:{},byStatus:{},byCondition:{}}}}}const Ca=new mM,gM=Object.freeze(Object.defineProperty({__proto__:null,default:Ca},Symbol.toStringTag,{value:"Module"}));function xM(e){var s,o,A,c,l,d;if(!e)return"default";const t=e.mainCategory,r=((s=e.classification)==null?void 0:s.level0)||((A=(o=e.classification)==null?void 0:o.hierarchy)==null?void 0:A.level0)||"",a=((c=e.classification)==null?void 0:c.level1)||((d=(l=e.classification)==null?void 0:l.hierarchy)==null?void 0:d.level1)||"",n=e.propertyType||"";if(t==="real_estate")return r!=null&&r.includes("Жилая")||r!=null&&r.includes("жилая")?"residential_real_estate":r!=null&&r.includes("Коммерческая")||r!=null&&r.includes("коммерческая")?"commercial_real_estate":"real_estate";if(t==="movable"){const f=(a==null?void 0:a.toLowerCase())||"",p=(n==null?void 0:n.toLowerCase())||"";return f.includes("автомобиль")||f.includes("транспорт")||p.includes("автомобиль")||p.includes("транспорт")?"vehicle":f.includes("оборудование")||p.includes("оборудование")?"equipment":f.includes("судно")||f.includes("морск")||f.includes("речн")||p.includes("судно")||p.includes("морск")||p.includes("речн")?"vessel":f.includes("воздушн")||f.includes("самолет")||f.includes("вертолет")||p.includes("воздушн")||p.includes("самолет")||p.includes("вертолет")?"aircraft":f.includes("железнодорожн")||f.includes("вагон")||f.includes("локомотив")||p.includes("железнодорожн")||p.includes("вагон")||p.includes("локомотив")?"railway":f.includes("самоходн")||f.includes("техника")||p.includes("самоходн")||p.includes("техника")?"self_propelled":f.includes("тмц")||f.includes("товар")||f.includes("материал")||p.includes("тмц")||p.includes("товар")||p.includes("материал")?"inventory":"equipment"}if(t==="property_rights"){const f=(a==null?void 0:a.toLowerCase())||"",p=(n==null?void 0:n.toLowerCase())||"";return f.includes("дол")||f.includes("ук")||p.includes("дол")||p.includes("ук")?"shares":f.includes("товарн")||f.includes("знак")||p.includes("товарн")||p.includes("знак")?"trademark":"property_rights"}return"default"}function yM(e,t){if(!e)return"";switch(xM(e)){case"residential_real_estate":return wM(e);case"commercial_real_estate":return EM(e);case"vehicle":return _M(e);case"equipment":return bM(e);case"vessel":return CM(e,t);case"aircraft":return BM(e,t);case"railway":return SM(e,t);case"self_propelled":return TM(e);case"inventory":return OM(e);case"shares":return IM(e);case"trademark":return NM(e);default:return""}}const vM=(e,t)=>{var E,D,B,I,_,S;const r=window.open("","_blank");if(!r){alert("Не удалось открыть окно для печати. Разрешите всплывающие окна.");return}const a=(E=t==null?void 0:t.partners)==null?void 0:E.find(O=>O.role==="pledgor"),n=(D=t==null?void 0:t.partners)==null?void 0:D.find(O=>O.role==="owner"),s=a?a.type==="legal"?a.organizationName||"":`${a.lastName||""} ${a.firstName||""} ${a.middleName||""}`.trim():"",o=n?n.type==="legal"?n.organizationName||"":`${n.lastName||""} ${n.firstName||""} ${n.middleName||""}`.trim():"",A=(t==null?void 0:t.pledgeContractId)||((B=t==null?void 0:t.characteristics)==null?void 0:B.pledgeContractNumber)||"",c=((I=t==null?void 0:t.characteristics)==null?void 0:I.pledgeContractDate)||"",l=(t==null?void 0:t.loanContractId)||((_=t==null?void 0:t.characteristics)==null?void 0:_.loanContractNumber)||"",d=((S=t==null?void 0:t.characteristics)==null?void 0:S.loanContractDate)||"",f=e.inspectionMethod||"Визуальный осмотр",p=e.inspectionType==="primary"?"Первичный осмотр":e.inspectionType==="periodic"?"Периодический осмотр":e.inspectionType==="monitoring"?"Мониторинг":e.inspectionType==="unscheduled"?"Внеплановый осмотр":"Выборочный осмотр",u=e.propertyPresence||(e.condition!=="critical"?"Наличие имущества подтверждается":"Наличие имущества не подтверждается"),g=e.propertyCondition||(e.condition==="excellent"?"Имущество в отличном состоянии":e.condition==="good"?"Имущество в хорошем состоянии":e.condition==="satisfactory"?"Имущество в удовлетворительном состоянии":e.condition==="poor"?"Имущество в плохом состоянии":"Имущество в критическом состоянии"),h=e.storageConditions||e.overallCondition||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",y=e.conclusions||e.notes||(e.condition==="critical"?"Предлагаемое в залог имущество не возможно рассмотреть в качестве обеспечения":"Имущество соответствует требованиям для принятия в залог"),x=e.proposals||(e.recommendations&&e.recommendations.length>0?e.recommendations.map(O=>O.description).join("; "):"-"),v=`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Акт проверки наличия и состояния залога ${e.id}</title>
      <style>
        @media print {
          @page {
            size: A4;
            margin: 2cm;
          }
        }
        body {
          font-family: 'Times New Roman', serif;
          font-size: 12pt;
          line-height: 1.6;
          margin: 0;
          padding: 20px;
        }
        .header {
          text-align: center;
          margin-bottom: 30px;
        }
        .header .number {
          text-align: right;
          margin-bottom: 10px;
          font-size: 12pt;
        }
        .header h1 {
          font-size: 14pt;
          font-weight: bold;
          margin-bottom: 5px;
          text-transform: uppercase;
        }
        .header .subtitle {
          font-size: 12pt;
          margin-bottom: 20px;
        }
        .section {
          margin-bottom: 20px;
        }
        .section-row {
          margin-bottom: 15px;
          display: flex;
          align-items: flex-start;
        }
        .section-label {
          font-weight: bold;
          min-width: 300px;
          margin-right: 10px;
        }
        .section-value {
          flex: 1;
        }
        .contract-info {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin: 15px 0;
        }
        .contract-block {
          border: 1px solid #000;
          padding: 10px;
        }
        .contract-block .label {
          font-weight: bold;
          margin-bottom: 5px;
        }
        .info-table {
          width: 100%;
          border-collapse: collapse;
          margin-bottom: 15px;
        }
        .info-table td {
          padding: 8px 10px;
          border: 1px solid #000;
          vertical-align: top;
        }
        .info-table td:first-child {
          font-weight: bold;
          width: 40%;
          background-color: #f0f0f0;
        }
        .info-table thead td {
          font-weight: bold;
          background-color: #e8e8e8;
          text-align: center;
          vertical-align: middle;
        }
        .info-table tbody td {
          vertical-align: top;
        }
        .attachment-table {
          width: 100%;
          border-collapse: collapse;
          margin: 15px 0;
          font-size: 9pt;
        }
        .attachment-table td {
          border: 1px solid #000;
          padding: 4px 6px;
          vertical-align: top;
        }
        .attachment-table thead td {
          font-weight: bold;
          background-color: #e8e8e8;
          text-align: center;
          vertical-align: middle;
        }
        .photos-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
          margin: 15px 0;
        }
        .photo-item {
          border: 1px solid #000;
          padding: 5px;
          text-align: center;
        }
        .photo-item img {
          max-width: 100%;
          height: auto;
          max-height: 200px;
        }
        .photo-item .photo-desc {
          font-size: 10pt;
          margin-top: 5px;
        }
        .signatures {
          margin-top: 40px;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 40px;
        }
        .signature-block {
          text-align: left;
        }
        .signature-line {
          border-top: 1px solid #000;
          margin-top: 50px;
          padding-top: 5px;
          min-height: 60px;
        }
        .footer {
          margin-top: 30px;
          font-size: 9pt;
          text-align: left;
          color: #666;
          line-height: 1.4;
        }
        .underline {
          border-bottom: 1px solid #000;
          display: inline-block;
          min-width: 200px;
          margin: 0 5px;
        }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="number">№ <span class="underline">${e.id}</span></div>
        <h1>Акт*</h1>
        <div class="subtitle">проверки наличия и состояния залога</div>
      </div>

      <div class="section">
        <div class="section-row">
          <div class="section-label">Наименование Залогодателя</div>
          <div class="section-value">${s||"________________"}</div>
        </div>
        <div class="section-row">
          <div class="section-label">Наименование Заемщика</div>
          <div class="section-value">${o||"________________"}</div>
        </div>
      </div>

      <div class="section">
        <p>Проведена проверка состояния принятого обеспечения по договору залога: 
        <span class="underline">${A||""}</span> 
        оформленного в обеспечение кредитного договора: 
        <span class="underline">${l||""}</span></p>
        
        <div class="contract-info">
          <div class="contract-block">
            <div class="label">Договор залога</div>
            <div>Номер: ${A||"________________"}</div>
            <div>Дата: ${c?We(c).format("DD.MM.YYYY"):"________________"}</div>
          </div>
          <div class="contract-block">
            <div class="label">Кредитный договор</div>
            <div>Номер: ${l||"________________"}</div>
            <div>Дата: ${d?We(d).format("DD.MM.YYYY"):"________________"}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-row">
          <div class="section-label">Способ проверки:</div>
          <div class="section-value">${f}</div>
        </div>
        <div class="section-row">
          <div class="section-label">Тип осмотра:</div>
          <div class="section-value">${p}</div>
        </div>
      </div>

      <div class="section">
        <p><em>К Акту Проверки прикладывается Приложение 1 с описанием осматриваемого имущества</em></p>
        <p style="font-size: 10pt; color: #666; margin-top: 5px;">
          Приложения к актам осмотра могут дополняться/изменяться и не требуют дополнительного согласования
        </p>
      </div>

      <div class="section">
        <table class="info-table">
          <tr>
            <td>Наличие заложенного имущества</td>
            <td>${u}</td>
          </tr>
          <tr>
            <td>Состояние заложенного имущества</td>
            <td>${g}. ${e.overallCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению"}</td>
          </tr>
          <tr>
            <td>Соответствие условий хранения/эксплуатации заложенного имущества</td>
            <td>${h}</td>
          </tr>
          <tr>
            <td>Выводы</td>
            <td>${y}</td>
          </tr>
          <tr>
            <td>Предложения</td>
            <td>${x}</td>
          </tr>
        </table>
      </div>

      ${e.photos&&e.photos.length>0?`
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Приложение 1. Фотографии осматриваемого имущества (${e.photos.length})</div>
        <div class="photos-grid">
          ${e.photos.map((O,M)=>`
            <div class="photo-item">
              <img src="${O.url}" alt="Фото ${M+1}" />
              <div class="photo-desc">
                ${O.location||O.step||`Фото ${M+1}`}
                ${O.description?`<br>${O.description}`:""}
                ${O.takenAt?`<br>${We(O.takenAt).format("DD.MM.YYYY HH:mm")}`:""}
              </div>
            </div>
          `).join("")}
        </div>
      </div>
      `:""}

      ${yM(t,e)}

      ${e.defects&&e.defects.length>0?`
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Приложение 2. Выявленные дефекты</div>
        <table class="info-table">
          ${e.defects.map((O,M)=>`
            <tr>
              <td>Дефект ${M+1}</td>
              <td>${O.description} (${O.severity})${O.location?`, Местоположение: ${O.location}`:""}</td>
            </tr>
          `).join("")}
        </table>
      </div>
      `:""}

      <div class="section">
        <div class="section-row">
          <div class="section-label">Дата проведения проверки</div>
          <div class="section-value">${We(e.inspectionDate).format("DD.MM.YYYY")}</div>
        </div>
      </div>

      <div class="signatures">
        <div class="signature-block">
          <div class="signature-line">
            Сотрудник проводивший осмотр<br>
            ${e.inspectorName||"________________"}<br>
            ${e.inspectorPosition?`${e.inspectorPosition}`:""}
          </div>
        </div>
        <div class="signature-block">
          <div class="signature-line">
            Руководитель/заместитель руководителя<br>
            ${e.approvedBy||"________________"}<br>
            ${e.approvedAt?We(e.approvedAt).format("DD.MM.YYYY"):""}
          </div>
        </div>
      </div>

      <div class="footer">
        <p>*Акт осмотра составляется в электронном виде, подписывается ЭЦП работника, осуществившим осмотр и его руководителем подразделения. Актуализация данной формы и приложений к ней может проводиться без внесения изменений в настоящее Положение по согласованию с Директором/заместителем директора департамента управления рисками.</p>
        <p style="margin-top: 10px;">Документ сгенерирован автоматически ${We().format("DD.MM.YYYY HH:mm")}</p>
      </div>

      <script>
        window.onload = function() {
          window.print();
        };
      <\/script>
    </body>
    </html>
  `;r.document.write(v),r.document.close()};function wM(e){const t=e.characteristics||{},r=e.address||{},a=r.cadastralNumber||t.cadastralNumber||"",n=t.totalAreaSqm||t.totalArea||"",s=t.buildYear||t.yearOfConstruction||"",o=t.wallMaterial||"",A=t.floorMaterial||t.overlapMaterial||"",c=t.buildingCondition||t.condition||"",l=t.finishLevel||t.finishingLevel||"",d=t.finishCondition||"",f=t.bookValue||t.balanceValue||0;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Жилая недвижимость)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Общая площадь объекта, кв. м.<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Кадастровый номер объекта</td>
            <td style="text-align: center; font-weight: bold;">Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Год строительства</td>
            <td style="text-align: center; font-weight: bold;">Материал стен</td>
            <td style="text-align: center; font-weight: bold;">Материал перекрытий</td>
            <td style="text-align: center; font-weight: bold;">Состояние конструктивных элементов здания</td>
            <td style="text-align: center; font-weight: bold;">Уровень отделки</td>
            <td style="text-align: center; font-weight: bold;">Состояние отделки</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${n||""}</td>
            <td>${a||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
            <td style="text-align: center;">${s||""}</td>
            <td>${o||""}</td>
            <td>${A||""}</td>
            <td>${c||""}</td>
            <td>${l||""}</td>
            <td>${d||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function EM(e){var h,y,x,v,E,D;const t=e.characteristics||{},r=e.address||{},a=r.cadastralNumber||t.cadastralNumber||"",n=t.totalAreaSqm||t.totalArea||"",s=t.buildYear||t.yearOfConstruction||"",o=t.wallMaterial||"",A=t.floorMaterial||t.overlapMaterial||"",c=t.buildingCondition||t.condition||"",l=t.finishLevel||t.finishingLevel||"",d=t.finishCondition||"",f=t.bookValue||t.balanceValue||0,p=((h=e.classification)==null?void 0:h.level1)||((x=(y=e.classification)==null?void 0:y.hierarchy)==null?void 0:x.level1)||"",u=((v=e.classification)==null?void 0:v.level2)||((D=(E=e.classification)==null?void 0:E.hierarchy)==null?void 0:D.level2)||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Коммерческая недвижимость)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Общая площадь объекта, кв. м.<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Кадастровый номер объекта</td>
            <td style="text-align: center; font-weight: bold;">Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС<br><span style="color: red; font-size: 9pt;">Только цифры</span></td>
            <td style="text-align: center; font-weight: bold;">Год строительства</td>
            <td style="text-align: center; font-weight: bold;">Материал стен</td>
            <td style="text-align: center; font-weight: bold;">Материал перекрытий</td>
            <td style="text-align: center; font-weight: bold;">Состояние конструктивных элементов здания</td>
            <td style="text-align: center; font-weight: bold;">Уровень отделки</td>
            <td style="text-align: center; font-weight: bold;">Состояние отделки</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||`${p}, назначение: нежилое ${(u==null?void 0:u.toLowerCase())||"здание"}, площадь: ${n||""} кв.м.`}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${n||""}</td>
            <td>${a||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
            <td style="text-align: center;">${s||""}</td>
            <td>${o||""}</td>
            <td>${A||""}</td>
            <td>${c||""}</td>
            <td>${l||""}</td>
            <td>${d||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function _M(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",s=t.vin||t.identificationNumber||"",o=t.chassisNumber||"",A=t.bodyNumber||"",c=t.color||"",l=t.year||t.yearOfManufacture||"",d=t.inventoryNumber||"",f=t.registrationNumber||t.licensePlate||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (автотранспорт)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка</td>
            <td style="text-align: center; font-weight: bold;">Модель ТС</td>
            <td style="text-align: center; font-weight: bold;">Идентификационный номер (VIN)</td>
            <td style="text-align: center; font-weight: bold;">Номер шасси</td>
            <td style="text-align: center; font-weight: bold;">Номер кузова</td>
            <td style="text-align: center; font-weight: bold;">Цвет</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Регистрационный знак</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${s}</td>
            <td>${o}</td>
            <td>${A}</td>
            <td>${c}</td>
            <td style="text-align: center;">${l}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td>${r.fullAddress||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function bM(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",s=t.serialNumber||t.factoryNumber||"",o=t.year||t.yearOfManufacture||"",A=t.manufacturer||"",c=t.country||t.manufacturerCountry||"",l=t.inventoryNumber||"",d=t.bookValue||t.balanceValue||t.residualValue||0,f=t.additionalCharacteristics||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (оборудование)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка</td>
            <td style="text-align: center; font-weight: bold;">Модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Страна - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Производитель</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Остаточная балансовая стоимость, руб.</td>
            <td style="text-align: center; font-weight: bold;">Дополнительные характеристики</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${s}</td>
            <td style="text-align: center;">${o}</td>
            <td>${c}</td>
            <td>${A}</td>
            <td>${l}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${d?d.toLocaleString("ru-RU"):"0.00"}</td>
            <td>${f}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function CM(e,t){const r=e.characteristics||{},a=r.vesselName||e.name||"",n=r.imo||"",s=r.vesselType||"",o=r.callSign||"",A=r.portOfRegistration||"",c=r.placeOfConstruction||"",l=r.yearOfConstruction||"",d=r.hullMaterial||"",f=r.enginesCount||"",p=r.enginesPower||"",u=r.length||"",g=r.width||"",h=r.boardHeight||"",y=r.grossTonnage||"",x=r.netTonnage||"",v=r.deadweight||"",E=r.vesselClass||"",D=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (морские/речные суда)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование объекта</td>
            <td style="text-align: center; font-weight: bold;">Состояние имущества</td>
            <td style="text-align: center; font-weight: bold;">Наличие обременений</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена/выявленные разночтения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${`Судно "${a}", ИМО ${n}. Тип судна: ${s}. Позывной сигнал: ${o}. Морской порт регистрации: ${A}. Место и год постройки: ${c}, ${l}. Главный материал корпуса: ${d}. Число и мощность главных двигателей: ${f}, ${p} кВт. Главные размерения: Длина ${u} м. Ширина ${g} м. Высота борта ${h} м. Вместимость валовая ${y}. Вместимость чистая ${x}. Дедвейт ${v} р.т. Класс судна: ${E}.`}</td>
            <td>${(t==null?void 0:t.propertyCondition)||""}</td>
            <td></td>
            <td style="background-color: ${D?"#ffff00":"transparent"};">${D||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function BM(e,t){const r=e.characteristics||{},a=e.address||{},n=r.aircraftType||e.name||"",s=r.serialNumber||r.factoryNumber||"",o=r.gliderNumber||"",A=r.year||r.yearOfManufacture||"",c=r.manufacturer||"",l=r.model||"",d=r.operatingHours||r.flightHours||"",f=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"",p=(t==null?void 0:t.propertyCondition)||"",u=f;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (воздушное судно)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Вид воздушного судна</td>
            <td style="text-align: center; font-weight: bold;">Серийный (заводской номер)</td>
            <td style="text-align: center; font-weight: bold;">Номер планера</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Наименование изготовителя</td>
            <td style="text-align: center; font-weight: bold;">Тип (наименование)</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Наработка /налет часов</td>
            <td style="text-align: center; font-weight: bold;">Работоспособность подтверждена/не подтверждена</td>
            <td style="text-align: center; font-weight: bold;">Наличие/отсутствие повреждений</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${n}</td>
            <td>${s}</td>
            <td>${o}</td>
            <td style="text-align: center;">${A}</td>
            <td>${c}</td>
            <td>${l}</td>
            <td>${a.fullAddress||""}</td>
            <td>${d}</td>
            <td>${f||""}</td>
            <td>${p||""}</td>
            <td>${u||""}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function SM(e,t){const r=e.characteristics||{},a=r.make||r.brand||"",n=r.model||"",s=r.serialNumber||r.factoryNumber||"",o=r.year||r.yearOfConstruction||"",A=r.identificationMarks||"",c=r.wagonNumber||"",l=r.depot||"",d=r.inventoryNumber||"",f=r.country||r.manufacturerCountry||"",p=(t==null?void 0:t.propertyPresence)==="Наличие имущества подтверждается"?"Подтверждена":"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Железнодорожный транспорт)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка, модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер</td>
            <td style="text-align: center; font-weight: bold;">Год постройки</td>
            <td style="text-align: center; font-weight: bold;">Идентификационные признаки</td>
            <td style="text-align: center; font-weight: bold;">Номер вагона</td>
            <td style="text-align: center; font-weight: bold;">Депо приписки</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Страна - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Идентификация подтверждена/не подтверждена /выявленные разночтения</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Комментарии</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a} ${n}</td>
            <td>${s}</td>
            <td style="text-align: center;">${o}</td>
            <td>${A}</td>
            <td>${c}</td>
            <td>${l}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td style="background-color: ${p?"#ffff00":"transparent"};">${p||""}</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function TM(e){const t=e.characteristics||{},r=e.address||{},a=t.make||t.brand||"",n=t.model||"",s=t.serialNumber||t.factoryNumber||"",o=t.color||"",A=t.year||t.yearOfManufacture||"",c=t.manufacturer||"",l=t.inventoryNumber||"",d=t.registrationNumber||"",f=t.bookValue||t.balanceValue||t.residualValue||0;return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (Самоходная техника)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование</td>
            <td style="text-align: center; font-weight: bold;">Марка машины</td>
            <td style="text-align: center; font-weight: bold;">Модель</td>
            <td style="text-align: center; font-weight: bold;">Заводской номер машины (рамы)</td>
            <td style="text-align: center; font-weight: bold;">Цвет</td>
            <td style="text-align: center; font-weight: bold;">Год выпуска</td>
            <td style="text-align: center; font-weight: bold;">Предприятие - изготовитель</td>
            <td style="text-align: center; font-weight: bold;">Инвентарный номер</td>
            <td style="text-align: center; font-weight: bold;">Регистрационный знак</td>
            <td style="text-align: center; font-weight: bold;">Адрес местоположения</td>
            <td style="text-align: center; font-weight: bold;">Остаточная балансовая стоимость единицы, руб.</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td>${n}</td>
            <td>${s}</td>
            <td>${o}</td>
            <td style="text-align: center;">${A}</td>
            <td>${c}</td>
            <td>${l}</td>
            <td>${d}</td>
            <td>${r.fullAddress||""}</td>
            <td style="text-align: right;">${f?f.toLocaleString("ru-RU"):"0.00"}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function OM(e){const t=e.characteristics||{},r=e.address||{},a=t.unit||t.unitOfMeasurement||"",n=t.quantity||"",s=r.fullAddress||"",o="",A="",c=t.storageLocation||"",l=t.storageSystem||"",d=t.securityAlarm||"",f=t.storageConditions||"",p=t.features||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (ТМЦ)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование имущества/товаров</td>
            <td style="text-align: center; font-weight: bold;">Единица измерения</td>
            <td style="text-align: center; font-weight: bold;">Количество</td>
            <td style="text-align: center; font-weight: bold;">Местонахождение имущества</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Соответствие товара количественным характеристикам</td>
            <td style="text-align: center; font-weight: bold;">Характеристики места хранения</td>
            <td style="text-align: center; font-weight: bold;">Система хранения</td>
            <td style="text-align: center; font-weight: bold;">Наличие охранно-пожарной сигнализации</td>
            <td style="text-align: center; font-weight: bold;">Условия хранения</td>
            <td style="text-align: center; font-weight: bold;">Особенности</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${e.name||""}</td>
            <td>${a}</td>
            <td style="text-align: right;">${n}</td>
            <td>${s}</td>
            <td>${o}</td>
            <td>${A}</td>
            <td>${c}</td>
            <td>${l}</td>
            <td>${d}</td>
            <td>${f}</td>
            <td>${p}</td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function IM(e){var o;const t=(o=e.partners)==null?void 0:o.find(A=>A.role==="owner"),r=t?t.type==="legal"?t.organizationName||"":`${t.lastName||""} ${t.firstName||""} ${t.middleName||""}`.trim():"",a=(t==null?void 0:t.share)||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра (доли в УК)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Наименование собственника</td>
            <td style="text-align: center; font-weight: bold;">Доля в УК</td>
            <td style="text-align: center; font-weight: bold;">Подтверждение собственника и доли в УК выписок из ЕГРЮЛ</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${r}</td>
            <td style="text-align: right;">${a}%</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}function NM(e){const t=e.characteristics||{},r=t.certificateNumber||"",a=t.certificateIssuedBy||"",n=e.name||"",s=t.applicationNumber||"",o=t.priority||"",A=t.registrationDate||"",c=t.registrationPeriod||"";return`
    <div class="section" style="page-break-before: always;">
      <div style="font-weight: bold; margin-bottom: 15px; text-align: center;">
        Приложение к акту осмотра на исключительные права на товарные знаки (знаки обслуживания)
      </div>
      <table class="attachment-table">
        <thead>
          <tr>
            <td style="text-align: center; font-weight: bold;">№ п/п</td>
            <td style="text-align: center; font-weight: bold;">№ В ЗМ</td>
            <td style="text-align: center; font-weight: bold;">Свидетельство на товарный знак (знак обслуживания) (№, кем выдано)</td>
            <td style="text-align: center; font-weight: bold;">Наименование товарного знака (знака обслуживания)</td>
            <td style="text-align: center; font-weight: bold;">Номер заявки</td>
            <td style="text-align: center; font-weight: bold;">Приоритет товарного знака</td>
            <td style="text-align: center; font-weight: bold;">Дата регистрации</td>
            <td style="text-align: center; font-weight: bold;">Срок действия регистрации</td>
            <td style="text-align: center; font-weight: bold;">Выявленные обременения</td>
            <td style="text-align: center; font-weight: bold;">Комментарии</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="text-align: center;">1</td>
            <td></td>
            <td>${r}${a?`, ${a}`:""}</td>
            <td>${n}</td>
            <td>${s}</td>
            <td>${o}</td>
            <td>${A?We(A).format("DD.MM.YYYY"):""}</td>
            <td>${c}</td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  `}const{Text:jo}=mt,{TextArea:FM}=Re,vC=({visible:e,inspectionId:t,onClose:r,onApprove:a,onRequestRevision:n})=>{var _;const[s,o]=K.useState(null),[A,c]=K.useState(null),[l,d]=K.useState(!1),[f,p]=K.useState("");K.useEffect(()=>{console.log("InspectionCardModal props changed:",{visible:e,inspectionId:t})},[e,t]);const u=K.useCallback(async()=>{if(!t){console.warn("loadInspection called without inspectionId");return}console.log("Loading inspection:",t),d(!0);try{const S=await Ca.getInspectionById(t);if(console.log("Loaded inspection:",S),o(S||null),!S)Ne.warning("Осмотр не найден");else if(S.collateralCardId)try{const O=await Yt.getExtendedCardById(S.collateralCardId);O&&c(O)}catch(O){console.error("Failed to load collateral card:",O)}}catch(S){console.error("Ошибка загрузки осмотра:",S),Ne.error("Не удалось загрузить осмотр")}finally{d(!1)}},[t]);K.useEffect(()=>{console.log("InspectionCardModal useEffect:",{visible:e,inspectionId:t}),e&&t?u():(o(null),p(""))},[e,t,u]);const g=()=>{t&&a&&(a(t),u())},h=()=>{t&&n&&f.trim()&&(n(t,f),p(""),u())},y=()=>{s?vM(s,A||void 0):Ne.error("Осмотр не загружен")},x=S=>({scheduled:"blue",sent_to_client:"cyan",in_progress:"orange",submitted_for_review:"purple",needs_revision:"red",approved:"green",completed:"green",cancelled:"red"})[S]||"default",v=S=>({scheduled:"Запланирован",sent_to_client:"Отправлен клиенту",in_progress:"В процессе",submitted_for_review:"На проверке",needs_revision:"Требует доработки",approved:"Согласован",completed:"Завершен",cancelled:"Отменен"})[S]||S,E=S=>{switch(S){case"created":return i.jsx(zn,{style:{color:"#1890ff"}});case"sent_to_client":return i.jsx(zn,{style:{color:"#13c2c2"}});case"submitted":return i.jsx(zn,{style:{color:"#722ed1"}});case"reviewed":return i.jsx(On,{style:{color:"#52c41a"}});case"approved":return i.jsx(On,{style:{color:"#52c41a"}});case"revision_requested":return i.jsx(ZA,{style:{color:"#ff4d4f"}});default:return i.jsx(zn,{})}},D=[{key:"info",label:"Информация",children:s?i.jsxs(we,{bordered:!0,column:2,children:[i.jsx(we.Item,{label:"Тип осмотра",children:s.inspectionType}),i.jsx(we.Item,{label:"Статус",children:i.jsx(at,{color:x(s.status),children:v(s.status)})}),i.jsx(we.Item,{label:"Дата осмотра",children:s.inspectionDate?We(s.inspectionDate instanceof Date?s.inspectionDate:new Date(s.inspectionDate)).format("DD.MM.YYYY HH:mm"):"Не указана"}),i.jsx(we.Item,{label:"Объект",children:s.collateralName}),i.jsx(we.Item,{label:"Адрес",children:s.address||"Не указан"}),i.jsxs(we.Item,{label:"Исполнитель",children:[s.inspectorName,s.inspectorType==="client"&&i.jsx(at,{color:"orange",style:{marginLeft:8},children:"Клиент"}),s.inspectorType==="employee"&&i.jsx(at,{color:"blue",style:{marginLeft:8},children:"Сотрудник"})]}),s.inspectorPhone&&i.jsx(we.Item,{label:"Телефон",children:s.inspectorPhone}),s.inspectorEmail&&i.jsx(we.Item,{label:"Email",children:s.inspectorEmail}),i.jsx(we.Item,{label:"Состояние",children:i.jsx(at,{color:s.condition==="excellent"?"green":s.condition==="good"?"blue":s.condition==="satisfactory"?"orange":"red",children:s.condition})}),s.notes&&i.jsx(we.Item,{label:"Примечания",span:2,children:s.notes}),s.latitude&&s.longitude&&i.jsx(we.Item,{label:"Геолокация",span:2,children:i.jsxs(Fe,{children:[i.jsx(tA,{}),i.jsxs(jo,{children:[s.latitude.toFixed(6),", ",s.longitude.toFixed(6)]}),i.jsx(Be,{type:"link",size:"small",onClick:()=>{window.open(`https://yandex.ru/maps/?pt=${s.longitude},${s.latitude}&z=16`,"_blank")},children:"Открыть на карте"})]})})]}):i.jsx(Br,{description:"Данные не загружены"})},{key:"photos",label:i.jsxs(Fe,{children:[i.jsx(Ko,{}),"Фотографии (",((_=s==null?void 0:s.photos)==null?void 0:_.length)||0,")"]}),children:s!=null&&s.photos&&s.photos.length>0?i.jsx(ft,{gutter:[16,16],children:s.photos.map(S=>i.jsx(Te,{xs:24,sm:12,md:8,lg:6,children:i.jsx(Ge,{hoverable:!0,cover:i.jsx(am,{src:S.url,alt:S.description||"Фото осмотра",preview:{mask:"Просмотр"},style:{height:200,objectFit:"cover"}}),children:i.jsx(Ge.Meta,{title:S.location||S.step||"Фото",description:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsx(jo,{type:"secondary",style:{fontSize:12},children:S.takenAt?We(S.takenAt instanceof Date?S.takenAt:new Date(S.takenAt)).format("DD.MM.YYYY HH:mm"):"Не указана"}),S.latitude&&S.longitude&&i.jsxs(jo,{type:"secondary",style:{fontSize:12},children:[i.jsx(tA,{})," ",S.latitude.toFixed(4),", ",S.longitude.toFixed(4)]}),S.description&&i.jsx(jo,{style:{fontSize:12},children:S.description})]})})})},S.id))}):i.jsx(Br,{description:"Фотографии отсутствуют"})},{key:"history",label:"Хронология",children:s!=null&&s.history&&s.history.length>0?i.jsx(mv,{children:s.history.map(S=>i.jsx(mv.Item,{dot:E(S.action),children:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs(Fe,{children:[i.jsx(jo,{strong:!0,children:S.user}),i.jsx(at,{color:x(S.status),children:v(S.status)})]}),i.jsx(jo,{type:"secondary",children:S.date?We(S.date instanceof Date?S.date:new Date(S.date)).format("DD.MM.YYYY HH:mm"):"Не указана"}),i.jsx(jo,{children:S.action==="created"?"Создал осмотр":S.action==="sent_to_client"?"Отправил клиенту":S.action==="submitted"?"Отправил на проверку":S.action==="reviewed"?"Проверил":S.action==="approved"?"Согласовал":S.action==="revision_requested"?"Запросил доработку":S.action}),S.comment&&i.jsx(jo,{type:"secondary",style:{display:"block",marginTop:4},children:S.comment})]})},S.id))}):i.jsx(Br,{description:"Хронология отсутствует"})}],B=(s==null?void 0:s.status)==="submitted_for_review",I=(s==null?void 0:s.status)==="submitted_for_review";return console.log("InspectionCardModal render:",{visible:e,inspectionId:t,hasInspection:!!s}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Qr,{}),i.jsx("span",{children:"Карточка осмотра"}),s&&i.jsx(at,{color:x(s.status),children:v(s.status)})]}),open:e,onCancel:()=>{console.log("Modal onCancel called"),r()},footer:[i.jsx(Be,{icon:i.jsx(In,{}),onClick:y,children:"Скачать PDF"},"pdf"),I&&i.jsx(Be,{danger:!0,onClick:h,disabled:!f.trim(),children:"Запросить доработку"},"revision"),B&&i.jsx(Be,{type:"primary",onClick:g,children:"Согласовать"},"approve"),i.jsx(Be,{onClick:r,children:"Закрыть"},"close")].filter(Boolean),width:900,className:"inspection-card-modal",children:l?i.jsx(Zn,{size:"large",style:{display:"block",textAlign:"center",padding:"40px"}}):s?i.jsxs(i.Fragment,{children:[I&&i.jsx(Ge,{size:"small",style:{marginBottom:16},children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},children:[i.jsx(jo,{strong:!0,children:"Комментарий к доработке:"}),i.jsx(FM,{rows:3,value:f,onChange:S=>p(S.target.value),placeholder:"Укажите, что нужно доработать в осмотре"})]})}),i.jsx(Ts,{items:D})]}):i.jsx(Br,{description:"Осмотр не найден"})})},Mh={Здание:{typeName:"Здание",requiresInspection:!0,requiresEgrn:!0},"Земельный участок":{typeName:"Земельный участок",requiresInspection:!0,requiresEgrn:!0},Помещение:{typeName:"Помещение",requiresInspection:!0,requiresEgrn:!0},Сооружение:{typeName:"Сооружение",requiresInspection:!0,requiresEgrn:!0},"Машино-место":{typeName:"Машино-место",requiresInspection:!0,requiresEgrn:!0},"Единый недвижимый комплекс":{typeName:"Единый недвижимый комплекс",requiresInspection:!0,requiresEgrn:!0},"Имущественный комплекс":{typeName:"Имущественный комплекс",requiresInspection:!0,requiresEgrn:!0},"Объект незавершенного строительства":{typeName:"Объект незавершенного строительства",requiresInspection:!0,requiresEgrn:!0},"Недвижимое имущество и права аренды недвижимого имущества":{typeName:"Недвижимое имущество и права аренды недвижимого имущества",requiresInspection:!0,requiresEgrn:!0},"Воздушные суда":{typeName:"Воздушные суда",requiresInspection:!0,requiresEgrn:!1},"Все имущество залогодателя":{typeName:"Все имущество залогодателя",requiresInspection:!0,requiresEgrn:!1},"Железнодорожный подвижной состав":{typeName:"Железнодорожный подвижной состав",requiresInspection:!0,requiresEgrn:!1},"Космические объекты":{typeName:"Космические объекты",requiresInspection:!0,requiresEgrn:!1},"Машины и оборудование":{typeName:"Машины и оборудование",requiresInspection:!0,requiresEgrn:!1},"Наземные безрельсовые механические транспортные средства, прицепы":{typeName:"Наземные безрельсовые механические транспортные средства, прицепы",requiresInspection:!0,requiresEgrn:!1},"Плавучие сооружения":{typeName:"Плавучие сооружения",requiresInspection:!0,requiresEgrn:!1},"Плавучие сооружения, не являющиеся судами":{typeName:"Плавучие сооружения, не являющиеся судами",requiresInspection:!0,requiresEgrn:!1},"Прочие движимые вещи":{typeName:"Прочие движимые вещи",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для иных целей":{typeName:"Суда, используемые для иных целей",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов":{typeName:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для перевозки пассажиров и их багажа":{typeName:"Суда, используемые для перевозки пассажиров и их багажа",requiresInspection:!0,requiresEgrn:!1},"Суда, используемые для рыболовства":{typeName:"Суда, используемые для рыболовства",requiresInspection:!0,requiresEgrn:!1},"Товары в обороте":{typeName:"Товары в обороте",requiresInspection:!0,requiresEgrn:!1},"Аффинированные драгоценные металлы в слитках":{typeName:"Аффинированные драгоценные металлы в слитках",requiresInspection:!1,requiresEgrn:!1},"Будущий урожай":{typeName:"Будущий урожай",requiresInspection:!1,requiresEgrn:!1},Векселя:{typeName:"Векселя",requiresInspection:!1,requiresEgrn:!1},"Доли в уставных капиталах обществ с ограниченной ответственностью":{typeName:"Доли в уставных капиталах обществ с ограниченной ответственностью",requiresInspection:!1,requiresEgrn:!1},"Инвестиционные паи (паи инвестиционных фондов)":{typeName:"Инвестиционные паи (паи инвестиционных фондов)",requiresInspection:!1,requiresEgrn:!1},"Ипотечные сертификаты участия":{typeName:"Ипотечные сертификаты участия",requiresInspection:!1,requiresEgrn:!1},"Исключительные права на интеллектуальную собственность":{typeName:"Исключительные права на интеллектуальную собственность",requiresInspection:!1,requiresEgrn:!1},"Права по договору банковского счета":{typeName:"Права по договору банковского счета",requiresInspection:!1,requiresEgrn:!1},"Прочие имущественные Права требования":{typeName:"Прочие имущественные Права требования",requiresInspection:!1,requiresEgrn:!1},"Прочие ценные бумаги":{typeName:"Прочие ценные бумаги",requiresInspection:!1,requiresEgrn:!1},"Эмиссионные ценные бумаги":{typeName:"Эмиссионные ценные бумаги",requiresInspection:!1,requiresEgrn:!1}};function RM(e){if(!e)return!1;const t=Mh[e];if(t)return t.requiresInspection;const r=e.trim();for(const[a,n]of Object.entries(Mh))if(r.includes(a)||a.includes(r))return n.requiresInspection;return!!(r.toLowerCase().includes("здание")||r.toLowerCase().includes("помещение")||r.toLowerCase().includes("участок")||r.toLowerCase().includes("сооружение"))}function kM(e){if(!e)return!1;const t=Mh[e];if(t)return t.requiresEgrn;const r=e.trim();for(const[a,n]of Object.entries(Mh))if(r.includes(a)||a.includes(r))return n.requiresEgrn;return!!(r.toLowerCase().includes("здание")||r.toLowerCase().includes("помещение")||r.toLowerCase().includes("участок")||r.toLowerCase().includes("сооружение")||r.toLowerCase().includes("машино-место"))}class DM{constructor(){sr(this,"STORAGE_KEY","ai_feedback")}saveFeedback(t){try{const r=this.getAllFeedbacks();r.push({...t,timestamp:t.timestamp}),r.length>1e3&&r.shift(),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}catch(r){console.error("Ошибка сохранения обратной связи:",r)}}getAllFeedbacks(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t).map(a=>({...a,timestamp:new Date(a.timestamp)})):[]}catch(t){return console.error("Ошибка загрузки обратной связи:",t),[]}}getFeedbackStats(){const t=this.getAllFeedbacks(),r=t.filter(n=>n.rating==="like").length,a=t.filter(n=>n.rating==="dislike").length;return{likes:r,dislikes:a,total:t.length}}getGoodExamples(t=5){return this.getAllFeedbacks().filter(a=>a.rating==="like").slice(-t).reverse()}getBadExamples(t=5){return this.getAllFeedbacks().filter(a=>a.rating==="dislike").slice(-t).reverse()}analyzeDislikes(){const t=this.getBadExamples(20),r=new Map;t.forEach(s=>{s.question.toLowerCase().split(/\s+/).forEach(A=>{A.length>3&&r.set(A,(r.get(A)||0)+1)})});const a=Array.from(r.entries()).sort((s,o)=>o[1]-s[1]).slice(0,5).map(([s])=>s),n=[];return t.length>0&&n.push("Обратите внимание на вопросы, связанные с: "+a.join(", ")),{commonTopics:a,suggestions:n}}clearAll(){localStorage.removeItem(this.STORAGE_KEY)}}const Jc=new DM;class jM{constructor(){sr(this,"indexes",new Map);sr(this,"chunks",[]);sr(this,"workerInitialized",!1)}async initializeWorker(){if(!(this.workerInitialized||typeof window>"u"))try{const t=await pi(()=>import("./pdf-CHhNo-mi.js"),[],import.meta.url);if(t.GlobalWorkerOptions.workerSrc=`https://unpkg.com/pdfjs-dist@${t.version}/build/pdf.worker.min.mjs`,typeof window<"u"&&window.console){const r=console.warn;console.warn=(...a)=>{const n=a.join(" ");n.includes("TT: undefined function")||n.includes("Warning: TT:")||n.includes("Missing or invalid font")||r.apply(console,a)}}this.workerInitialized=!0}catch(t){console.error("Ошибка инициализации PDF.js worker:",t);try{const r=await pi(()=>import("./pdf-CHhNo-mi.js"),[],import.meta.url);r.GlobalWorkerOptions.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${r.version}/build/pdf.worker.min.mjs`,this.workerInitialized=!0,console.log("PDF.js worker инициализирован (fallback):",r.GlobalWorkerOptions.workerSrc)}catch(r){console.error("Критическая ошибка инициализации PDF.js worker:",r)}}}createChunks(t,r,a=1){const n=[];if(!t||t.trim().length===0)return n;const s=t.split(/[.!?]\s+/).filter(c=>c.trim().length>0);let o="",A=0;for(let c=0;c<s.length;c++){const l=s[c].trim(),d=o?`${o}. ${l}`:l;if(d.length>1e3&&o){const f=this.extractKeywords(o);n.push({id:`${r}-${a}-${A}`,documentName:r,page:a,text:o,keywords:f}),o=l,A=c}else o=d}if(o.trim().length>0){const c=this.extractKeywords(o);n.push({id:`${r}-${a}-${A}-final`,documentName:r,page:a,text:o,keywords:c})}return n}async indexPDF(t){const r=console.warn;try{await this.initializeWorker();const a=await t.arrayBuffer(),o=await(await pi(()=>import("./pdf-CHhNo-mi.js"),[],import.meta.url)).getDocument({data:a,verbosity:0,stopAtErrors:!1,isEvalSupported:!1,disableFontFace:!1,useSystemFonts:!0}).promise;console.warn=(...f)=>{const p=f.join(" ");p.includes("TT: undefined function")||p.includes("Warning: TT:")||p.includes("Missing or invalid font")||p.includes("pdf.worker")||r.apply(console,f)};const A=o.numPages,c=[],l=[];for(let f=1;f<=A;f++){const g=(await(await o.getPage(f)).getTextContent()).items.map(h=>h.str).join(" ").trim();if(g.length>0){l.push(g);const h=this.createChunks(g,t.name,f);c.push(...h)}}const d={documentName:t.name,chunks:c,totalPages:A,indexedAt:new Date};return this.indexes.set(t.name,d),this.chunks.push(...c),this.saveToStorage().catch(f=>console.error("Ошибка сохранения индекса PDF:",f)),console.warn=r,d}catch(a){throw console.warn=r,console.error("Ошибка индексации PDF:",a),a}}async indexDOCX(t){try{const r=await pi(()=>import("./index-Be8gggM1.js").then(d=>d.i),__vite__mapDeps([0,1]),import.meta.url),a=await t.arrayBuffer(),s=(await r.extractRawText({arrayBuffer:a})).value;if(!s||s.trim().length===0)throw new Error("Документ не содержит текста");const o=2e3,A=[];for(let d=0;d<s.length;d+=o)A.push(s.slice(d,d+o));const c=[];A.forEach((d,f)=>{const p=this.createChunks(d,t.name,f+1);c.push(...p)});const l={documentName:t.name,chunks:c,totalPages:A.length,indexedAt:new Date};return this.indexes.set(t.name,l),this.chunks.push(...c),this.saveToStorage(t.name).catch(d=>console.error("Ошибка сохранения индекса DOCX:",d)),l}catch(r){throw console.error("Ошибка индексации DOCX:",r),r}}async indexXLSX(t){try{const r=await pi(()=>Promise.resolve().then(()=>C7),void 0,import.meta.url),a=await t.arrayBuffer(),n=r.read(a,{type:"array"}),s=[];let o=0;const A=[];if(n.SheetNames.forEach((l,d)=>{const f=n.Sheets[l],u=r.utils.sheet_to_json(f,{header:1,defval:""}).map(g=>Array.isArray(g)?g.filter(h=>h&&String(h).trim()).join(" | "):String(g).trim()).filter(g=>g.length>0).join(`
`);if(u.trim().length>0){A.push(`Лист "${l}":
${u}`);const g=this.createChunks(u,t.name,d+1);s.push(...g),o++}}),s.length===0)throw new Error("Документ не содержит данных");const c={documentName:t.name,chunks:s,totalPages:o||1,indexedAt:new Date};return this.indexes.set(t.name,c),this.chunks.push(...s),this.saveToStorage(t.name).catch(l=>console.error("Ошибка сохранения индекса XLSX:",l)),c}catch(r){throw console.error("Ошибка индексации XLSX:",r),r}}async indexImage(t){try{const r=await new Promise((s,o)=>{const A=new FileReader;A.onload=()=>{const c=A.result;s(c)},A.onerror=o,A.readAsDataURL(t)}),a={id:`${t.name}-image-1`,documentName:t.name,page:1,text:`[Изображение: ${t.name}]`,keywords:this.extractKeywordsFromImageName(t.name),imageData:r,isImage:!0},n={documentName:t.name,chunks:[a],totalPages:1,indexedAt:new Date};return this.indexes.set(t.name,n),this.chunks.push(a),this.saveToStorage(t.name).catch(s=>console.error("Ошибка сохранения индекса изображения:",s)),n}catch(r){throw console.error("Ошибка индексации изображения:",r),r}}extractKeywordsFromImageName(t){const r=[],a=t.toLowerCase(),n=["залог","ипотека","недвижимость","квартира","дом","офис","склад","автомобиль","транспорт","документ","договор","свидетельство","выписка","егрн","кадастр","оценка","отчет","акт","осмотр"];for(const s of n)a.includes(s)&&r.push(s);return r}async indexDocument(t){const r=t.name.toLowerCase();if(r.endsWith(".pdf"))return await this.indexPDF(t);if(r.endsWith(".docx"))return await this.indexDOCX(t);if(r.endsWith(".xlsx")||r.endsWith(".xls"))return await this.indexXLSX(t);if(this.isImageFile(r))return await this.indexImage(t);throw new Error(`Неподдерживаемый формат файла: ${t.name}. Поддерживаются: PDF, DOCX, XLSX, XLS, JPG, JPEG, PNG, GIF, BMP, WEBP`)}isImageFile(t){return[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(a=>t.endsWith(a))}extractKeywords(t){const r=[],a=t.toLowerCase(),n=["залог","залоговое имущество","залогодатель","залогодержатель","залоговое право","ипотека","ипотечное кредитование","ипотечный договор","ипотечное жилищное кредитование","ltv","loan-to-value","залоговая стоимость","рыночная стоимость","кадастровая стоимость","оценка","оценщик","отчет об оценке","переоценка","независимая оценка","договор залога","договор ипотеки","залоговое право","право залога","обременение","снятие обременения","регистрация залога","государственная регистрация","недвижимость","квартира","дом","земельный участок","коммерческая недвижимость","транспортное средство","автомобиль","оборудование","движимое имущество","росреестр","егрн","кадастровый номер","кадастровый учет","кредит","кредитный договор","задолженность","основной долг","проценты","нормативный документ","регламент","инструкция","положение","политика","риск","управление рисками","мониторинг","контроль","анализ рисков","страхование","страховой полис","страховая сумма","обращение взыскания","реализация залога","продажа залога","проверка залога","осмотр залога","мониторинг залога"];for(const s of n)a.includes(s.toLowerCase())&&r.push(s);return[...new Set(r)]}search(t,r=5){const a=t.toLowerCase(),n=a.split(/\s+/).filter(o=>o.length>2);return this.chunks.map(o=>{let A=0;const c=o.text.toLowerCase();for(const l of o.keywords)a.includes(l.toLowerCase())&&(A+=10);for(const l of n){const d=(c.match(new RegExp(l,"g"))||[]).length;A+=d*2}return c.includes(a)&&(A+=20),{chunk:o,score:A}}).filter(o=>o.score>0).sort((o,A)=>A.score-o.score).slice(0,r).map(o=>o.chunk)}getIndexedDocuments(){return Array.from(this.indexes.values())}async saveToStorage(t){try{if(t){const r=this.indexes.get(t);if(!r)return;const a={documentName:r.documentName,totalPages:r.totalPages,indexedAt:r.indexedAt};await Promise.all([Yr.documentChunks.where("documentName").equals(t).delete(),Yr.documentIndexes.where("documentName").equals(t).delete()]),await Yr.documentIndexes.put(a);const n=r.chunks.map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,imageData:o.imageData,isImage:o.isImage})),s=1e3;for(let o=0;o<n.length;o+=s){const A=n.slice(o,o+s);await Yr.documentChunks.bulkPut(A)}}else{const r=Array.from(this.indexes.values()).map(o=>({documentName:o.documentName,totalPages:o.totalPages,indexedAt:o.indexedAt}));if(r.length===0)return;const a=r.map(o=>o.documentName);await Promise.all([Yr.documentChunks.where("documentName").anyOf(a).delete(),Yr.documentIndexes.where("documentName").anyOf(a).delete()]),await Yr.documentIndexes.bulkPut(r);const n=this.chunks.map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,imageData:o.imageData,isImage:o.isImage})),s=1e3;for(let o=0;o<n.length;o+=s){const A=n.slice(o,o+s);await Yr.documentChunks.bulkPut(A)}}}catch(r){console.error("Ошибка сохранения индексов в IndexedDB:",r);try{const a={indexes:Array.from(this.indexes.values()).map(n=>({documentName:n.documentName,totalPages:n.totalPages,indexedAt:n.indexedAt.toISOString()}))};localStorage.setItem("documentIndexes_fallback",JSON.stringify(a))}catch(a){console.error("Ошибка сохранения в localStorage (fallback):",a)}}}async loadFromStorage(){try{const t=await Yr.documentIndexes.toArray(),r=await Yr.documentChunks.toArray();this.indexes.clear(),this.chunks=[];const a=new Map;for(const n of r)a.has(n.documentName)||a.set(n.documentName,[]),a.get(n.documentName).push({id:n.id,documentName:n.documentName,page:n.page,text:n.text,keywords:n.keywords,imageData:n.imageData,isImage:n.isImage});for(const n of t){const s=a.get(n.documentName)||[],o={documentName:n.documentName,chunks:s,totalPages:n.totalPages,indexedAt:n.indexedAt instanceof Date?n.indexedAt:new Date(n.indexedAt)};this.indexes.set(o.documentName,o),this.chunks.push(...s)}if(t.length===0){const n=localStorage.getItem("documentIndexes");if(n)try{const s=JSON.parse(n);this.indexes.clear(),this.chunks=[];for(const o of s.indexes||[]){const A={...o,indexedAt:new Date(o.indexedAt)};this.indexes.set(A.documentName,A),this.chunks.push(...A.chunks)}await this.saveToStorage(),localStorage.removeItem("documentIndexes")}catch(s){console.error("Ошибка миграции из localStorage:",s)}}}catch(t){console.error("Ошибка загрузки индексов из IndexedDB:",t);try{const r=localStorage.getItem("documentIndexes_fallback");if(r){const a=JSON.parse(r);this.indexes.clear(),this.chunks=[];for(const n of a.indexes||[]){const s={documentName:n.documentName,chunks:(a.chunks||[]).filter(o=>o.documentName===n.documentName).map(o=>({id:o.id,documentName:o.documentName,page:o.page,text:o.text,keywords:o.keywords,isImage:o.isImage})),totalPages:n.totalPages,indexedAt:new Date(n.indexedAt)};this.indexes.set(s.documentName,s),this.chunks.push(...s.chunks)}}}catch(r){console.error("Ошибка загрузки из localStorage (fallback):",r)}}}async clearIndexes(){this.indexes.clear(),this.chunks=[];try{await Yr.documentIndexes.clear(),await Yr.documentChunks.clear(),localStorage.removeItem("documentIndexes"),localStorage.removeItem("documentIndexes_fallback")}catch(t){console.error("Ошибка очистки индексов:",t)}}updateDocumentIndex(t){this.indexes.set(t.documentName,t);const r=this.chunks.filter(a=>a.documentName!==t.documentName);this.chunks=[...r,...t.chunks],this.saveToStorage(t.documentName).catch(a=>console.error("Ошибка обновления индекса:",a))}extractKeywordsPublic(t){return this.extractKeywords(t)}}const fi=new jM;class LM{constructor(){sr(this,"topics",new Map);sr(this,"categories",new Map);sr(this,"searchIndex",new Map);sr(this,"searchCache",null)}async buildFromDocuments(){const t=fi.getIndexedDocuments();for(const r of t){const a=this.extractTopics(r.chunks);for(const n of a){this.topics.set(n.id,n);for(const s of n.keywords){const o=s.toLowerCase();this.searchIndex.has(o)||this.searchIndex.set(o,[]),this.searchIndex.get(o).push(n.id)}this.categories.has(n.category)||this.categories.set(n.category,{id:n.category,name:this.getCategoryName(n.category),description:"",topics:[]}),this.categories.get(n.category).topics.push(n)}}this.saveToStorage().catch(r=>console.error("Ошибка сохранения базы знаний:",r)),this.searchCache=null}extractTopics(t){const r=[],a=new Set;for(const n of t){if(a.has(n.id))continue;const s=this.detectCategory(n),o=this.findRelatedChunks(n,t,a),A=o.map(f=>f.text).join(" ").trim();if(A.length<100)continue;const c=this.extractTitle(A),l=this.extractKeywords(A,n.keywords),d={id:`topic-${n.id}`,title:c,category:s,keywords:l,content:this.cleanText(A),page:n.page};r.push(d),o.forEach(f=>a.add(f.id))}return r}detectCategory(t){const r=t.text.toLowerCase(),a=t.keywords.map(n=>n.toLowerCase());return r.includes("понятие залога")||r.includes("сущность залога")||r.includes("определение залога")||r.includes("залог как способ")||r.includes("залог")&&(r.includes("понятие")||r.includes("сущность")||r.includes("определение"))?"collateral_concept":r.includes("виды залога")||r.includes("типы залога")||r.includes("классификация залога")||r.includes("разновидности залога")||r.includes("залог")&&(r.includes("вид")||r.includes("тип")||r.includes("классификац"))?"collateral_types":a.some(n=>["ипотека","ипотечный","ипотечное"].includes(n))||r.includes("ипотечн")||r.includes("ипотечное кредитование")||r.includes("ипотечный договор")||r.includes("ипотечное жилищное кредитование")?"mortgage":r.includes("договор залога")||r.includes("залоговый договор")||r.includes("заключение договора залога")||r.includes("условия договора залога")||a.some(n=>["договор","соглашение"].includes(n))&&r.includes("залог")?"pledge_contract":r.includes("предмет залога")||r.includes("объект залога")||r.includes("имущество в залоге")||r.includes("залоговое имущество")||r.includes("предмет")&&r.includes("залог")?"collateral_object":a.some(n=>["оценка","оценить","стоимость"].includes(n))||r.includes("оценк")||r.includes("независимая оценка")||r.includes("отчет об оценке")||r.includes("оценщик")||r.includes("рыночная стоимость")||r.includes("залоговая стоимость")?"appraisal":a.some(n=>["ltv","loan-to-value"].includes(n))||r.includes("ltv")||r.includes("loan-to-value")||r.includes("соотношение займа к стоимости")||r.includes("залоговая стоимость")&&(r.includes("расчет")||r.includes("определение"))?"ltv_calculation":a.some(n=>["регистрация","росреестр","егрн"].includes(n))||r.includes("регистрац")||r.includes("росреестр")||r.includes("государственная регистрация")||r.includes("регистрация залога")||r.includes("егрн")||r.includes("кадастровый учет")?"registration":r.includes("обременение")||r.includes("снятие обременения")||r.includes("прекращение обременения")||r.includes("освобождение от обременения")?"encumbrance":a.some(n=>["риск","риски"].includes(n))||r.includes("риск")||r.includes("управление рисками")||r.includes("анализ рисков")||r.includes("контроль рисков")||r.includes("минимизация рисков")?"risks":r.includes("мониторинг залога")||r.includes("контроль залога")||r.includes("проверка залога")||r.includes("осмотр залога")||r.includes("проверка наличия залога")?"monitoring":r.includes("обращение взыскания")||r.includes("взыскание на залог")||r.includes("реализация залога")||r.includes("продажа залога")||r.includes("обращение взыскания на предмет залога")?"enforcement":r.includes("страхование залога")||r.includes("страхование залогового имущества")||a.some(n=>["страхование","страховой полис"].includes(n))||r.includes("страхование")&&r.includes("залог")?"insurance":a.some(n=>["норматив","регламент","инструкция","закон","кодекс"].includes(n))||r.includes("норматив")||r.includes("регламент")||r.includes("гражданский кодекс")||r.includes("федеральный закон")||r.includes("нормативно-правовой")||r.includes("законодательство")?"regulations":(r.includes("недвижимость")||r.includes("квартира")||r.includes("дом")||r.includes("земельный участок"))&&r.includes("залог")?"real_estate_collateral":(r.includes("движимое имущество")||r.includes("автомобиль")||r.includes("транспортное средство")||r.includes("оборудование"))&&r.includes("залог")?"movable_collateral":r.includes("права залогодателя")||r.includes("права залогодержателя")||r.includes("обязанности залогодателя")||r.includes("обязанности залогодержателя")||r.includes("права и обязанности")||r.includes("право")&&r.includes("залог")?"rights_obligations":r.includes("залогодатель")||r.includes("залогодержатель")||r.includes("стороны")&&r.includes("договор залога")?"parties":r.includes("залог")||a.some(n=>["залоговое имущество"].includes(n))?"collateral_general":"general"}findRelatedChunks(t,r,a){const n=[t],s=new Set(t.keywords.map(o=>o.toLowerCase()));for(const o of r)if(!(a.has(o.id)||o.id===t.id)&&Math.abs(o.page-t.page)<=2){const A=new Set(o.keywords.map(l=>l.toLowerCase()));[...s].filter(l=>A.has(l)).length>0&&n.push(o)}return n}extractTitle(t){const r=t.split(`
`).filter(o=>o.trim().length>0),a=[/^(?:Глава|Раздел|§|Часть)\s*\d+[.\s]*(.+)$/i,/^\d+[.\s]+\d*[.\s]*([А-ЯЁ][^.!?]{10,80})$/,/^([А-ЯЁ][А-Яа-яё\s]{10,80})$/,/^([А-ЯЁ][^:]{10,80}):/];for(let o=0;o<Math.min(5,r.length);o++){const A=r[o].trim();for(const c of a){const l=A.match(c);if(l){const d=l[1]||l[0];if(d.length>10&&d.length<100&&!d.endsWith(".")&&d.split(" ").length<15)return d.trim()}}if(A.length>10&&A.length<100&&/^[А-ЯЁ]/.test(A)&&A.split(" ").length<15&&!A.endsWith(".")&&!A.endsWith(",")&&!A.includes("что")&&!A.includes("как")&&!A.includes("когда"))return A}const n=t.split(/[.!?]/)[0].trim();if(n.length>10&&n.length<100)return n;const s=t.split(/\s+/).slice(0,12).join(" ");return s.length>80?s.slice(0,77)+"...":s}extractKeywords(t,r){const a=new Set(r),n=t.toLowerCase(),s=["залог","залоговое имущество","залогодатель","залогодержатель","ипотека","ипотечный договор","ипотечное кредитование","ltv","loan-to-value","залоговая стоимость","рыночная стоимость","оценка","оценщик","отчет об оценке","переоценка","договор залога","договор ипотеки","залоговое право","обременение","снятие обременения","регистрация залога","недвижимость","квартира","дом","земельный участок","транспортное средство","автомобиль","оборудование","росреестр","егрн","кадастровый номер","кредит","кредитный договор","задолженность","нормативный документ","регламент","инструкция","риск","управление рисками","мониторинг","страхование","страховой полис"];for(const o of s)n.includes(o.toLowerCase())&&a.add(o);return Array.from(a)}cleanText(t){return t.replace(/\s+/g," ").replace(/\n\s*\n/g,`

`).trim()}getCategoryName(t){return{collateral_concept:"Понятие и сущность залога",collateral_types:"Виды и типы залога",collateral_general:"Общие вопросы залога",collateral_object:"Предмет залога",mortgage:"Ипотека и ипотечное кредитование",pledge_contract:"Договор залога",appraisal:"Оценка залогового имущества",ltv_calculation:"LTV и залоговая стоимость",registration:"Регистрация залога",encumbrance:"Обременение и снятие обременения",risks:"Риски и управление рисками",monitoring:"Мониторинг залога",enforcement:"Обращение взыскания на залог",insurance:"Страхование залога",regulations:"Нормативные документы и законодательство",real_estate_collateral:"Недвижимость как предмет залога",movable_collateral:"Движимое имущество как предмет залога",parties:"Залогодатель и залогодержатель",rights_obligations:"Права и обязанности сторон",general:"Общие вопросы"}[t]||"Общие вопросы"}search(t,r=5){const a=`${t.toLowerCase()}-${r}`;if(this.searchCache&&this.searchCache.key===a)return this.searchCache.results;if(!t||t.trim().length===0)return[];const n=t.toLowerCase().trim(),s=n.split(/\s+/).filter(d=>d.length>2);if(s.length===0&&n.length<3)return[];const o=new Map,A=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");for(const d of s){const f=this.searchIndex.get(d);if(f)for(const p of f){const u=o.get(p)||0;o.set(p,u+10)}}const c=s.length===0||o.size<r*2?Array.from(this.topics.entries()):Array.from(o.keys()).map(d=>[d,this.topics.get(d)]).filter(([,d])=>d);for(const[d,f]of c){if(!f)continue;const p=f.content.toLowerCase(),u=f.title.toLowerCase();let g=o.get(d)||0;u.includes(n)&&(g+=30);try{const h=(p.match(A)||[]).length;g+=h*2}catch{p.includes(n)&&(g+=2)}if(s.length>0)for(const h of s)try{const y=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),x=(p.match(y)||[]).length;g+=x}catch{p.includes(h)&&(g+=1)}g>0&&o.set(d,g)}return Array.from(o.entries()).sort((d,f)=>f[1]-d[1]).slice(0,r).map(([d])=>this.topics.get(d)).filter(d=>d!==void 0)}getCategories(){return Array.from(this.categories.values())}getTopic(t){return this.topics.get(t)}getTopicsByCategory(t){const r=this.categories.get(t);return r?r.topics:[]}async saveToStorage(){try{await Promise.all([Yr.knowledgeTopics.clear(),Yr.knowledgeCategories.clear(),Yr.knowledgeSearchIndex.clear()]);const t=Array.from(this.topics.values()).map(o=>({id:o.id,title:o.title,category:o.category,keywords:o.keywords,content:o.content,page:o.page,relatedTopics:o.relatedTopics})),r=1e3;for(let o=0;o<t.length;o+=r){const A=t.slice(o,o+r);await Yr.knowledgeTopics.bulkPut(A)}const a=Array.from(this.categories.values()).map(o=>({id:o.id,name:o.name,description:o.description,topicIds:o.topics.map(A=>A.id)}));a.length>0&&await Yr.knowledgeCategories.bulkPut(a);const n=Array.from(this.searchIndex.entries()).map(([o,A])=>({keyword:o,topicIds:A})),s=1e3;for(let o=0;o<n.length;o+=s){const A=n.slice(o,o+s);await Yr.knowledgeSearchIndex.bulkPut(A)}}catch(t){console.error("Ошибка сохранения базы знаний в IndexedDB:",t);try{const r={categories:Array.from(this.categories.values()).map(a=>({id:a.id,name:a.name,description:a.description,topicCount:a.topics.length})),topicCount:this.topics.size,version:"1.0",updatedAt:new Date().toISOString()};localStorage.setItem("knowledgeBase_fallback",JSON.stringify(r))}catch(r){console.error("Ошибка сохранения в localStorage (fallback):",r)}}}async loadFromStorage(){var t;try{const r=await Yr.knowledgeTopics.toArray();this.topics.clear();for(const s of r){const o={id:s.id,title:s.title,category:s.category,keywords:s.keywords,content:s.content,page:s.page,relatedTopics:s.relatedTopics};this.topics.set(o.id,o)}const a=await Yr.knowledgeSearchIndex.toArray();this.searchIndex.clear();for(const s of a)this.searchIndex.set(s.keyword,s.topicIds);const n=await Yr.knowledgeCategories.toArray();this.categories.clear();for(const s of n){const o=s.topicIds.map(c=>this.topics.get(c)).filter(c=>c!==void 0),A={id:s.id,name:s.name,description:s.description,topics:o};this.categories.set(A.id,A)}if(r.length===0){const s=localStorage.getItem("knowledgeBase");if(s)try{const o=JSON.parse(s);this.topics.clear(),this.categories.clear(),this.searchIndex.clear();for(const A of o.topics||[]){this.topics.set(A.id,A);for(const c of A.keywords){const l=c.toLowerCase();this.searchIndex.has(l)||this.searchIndex.set(l,[]),this.searchIndex.get(l).push(A.id)}}for(const A of o.categories||[])this.categories.set(A.id,A);await this.saveToStorage(),localStorage.removeItem("knowledgeBase")}catch(o){console.error("Ошибка миграции из localStorage:",o)}}}catch(r){console.error("Ошибка загрузки базы знаний из IndexedDB:",r);try{const a=localStorage.getItem("knowledgeBase_fallback");if(a){const n=JSON.parse(a);console.log(`Загружены метаданные базы знаний: ${n.topicCount} тем, ${((t=n.categories)==null?void 0:t.length)||0} категорий`)}}catch(a){console.error("Ошибка загрузки из localStorage (fallback):",a)}}}async clear(){this.topics.clear(),this.categories.clear(),this.searchIndex.clear();try{await Promise.all([Yr.knowledgeTopics.clear(),Yr.knowledgeCategories.clear(),Yr.knowledgeSearchIndex.clear()]),localStorage.removeItem("knowledgeBase"),localStorage.removeItem("knowledgeBase_fallback")}catch(t){console.error("Ошибка очистки базы знаний:",t)}}}const bn=new LM;class UM{constructor(){sr(this,"STORAGE_KEY","ai_learning_patterns");sr(this,"INSIGHTS_KEY","ai_document_insights");sr(this,"CATEGORY_EXPERIENCE_KEY","ai_category_experience");sr(this,"patterns",new Map);sr(this,"documentInsights",new Map);sr(this,"categoryExperience",{})}initialize(){this.loadPatterns(),this.loadDocumentInsights(),this.loadCategoryExperience()}analyzeFeedback(){const t=Jc.getAllFeedbacks();if(t.length===0)return;const r=new Map;t.forEach(a=>{const n=this.extractQuestionPattern(a.question);r.has(n)||r.set(n,[]),r.get(n).push(a)}),r.forEach((a,n)=>{const s=a.filter(c=>c.rating==="like").length,o=a.length,A=o>0?s/o:0;if(s>0&&A>=.5){const c=a.filter(u=>u.rating==="like").sort((u,g)=>g.timestamp.getTime()-u.timestamp.getTime())[0],l=this.extractKeywords(a[0].question),d=this.detectCategory(a[0].question),f={questionPattern:n,successfulAnswerTemplate:this.extractAnswerTemplate(c.answer),keywords:l,category:d,successRate:A,usageCount:o,lastUpdated:new Date},p=this.patterns.get(n);!p||A>p.successRate?this.patterns.set(n,f):p&&(p.usageCount=o,p.successRate=A,p.lastUpdated=new Date)}}),this.savePatterns()}analyzeDocuments(){const t=fi.getIndexedDocuments();console.log(`📚 Анализирую ${t.length} документов для обучения модели...`),t.forEach(r=>{const a=bn.getCategories().flatMap(d=>d.topics),n=r.documentName.toLowerCase(),s=a.filter(d=>d.content.toLowerCase().includes(n)||r.chunks.some(p=>p.text.toLowerCase().includes(d.title.toLowerCase()))),o=s.map(d=>d.title).slice(0,15),A=new Set;r.chunks.forEach(d=>{d.keywords.forEach(u=>A.add(u));const f=d.text.toLowerCase();["оценка","стоимость","рыночная","залоговая","ltv","риск","риски","регистрация","ипотека","обременение","росреестр","егрн","кадастр","недвижимость","движимое имущество","бизнес","активы","залог","договор","соглашение","норматив","требование","процедура","метод","подход","анализ","мониторинг","осмотр","проверка"].forEach(u=>{f.includes(u)&&A.add(u)})});const c=this.generateCommonQuestions(s);if(c.length<5){const d=this.generateQuestionsFromKeywords(Array.from(A));c.push(...d.slice(0,5-c.length))}this.extractPatternsFromDocument(r);const l={documentName:r.documentName,importantTopics:o,commonQuestions:c.slice(0,10),keywords:Array.from(A).slice(0,30),lastAnalyzed:new Date};this.documentInsights.set(r.documentName,l),console.log(`✅ Проанализирован документ: ${r.documentName} (${o.length} тем, ${A.size} ключевых слов)`)}),this.saveDocumentInsights(),console.log(`🎓 Анализ документов завершен. Извлечено инсайтов: ${this.documentInsights.size}`)}generateQuestionsFromKeywords(t){const r=[],a=["Как {keyword}?","Что такое {keyword}?","Какие требования к {keyword}?","Как правильно {keyword}?","Какие особенности {keyword}?"];return t.slice(0,10).forEach(n=>{a.forEach(s=>{s.includes("{keyword}")&&r.push(s.replace("{keyword}",n))})}),r.slice(0,10)}extractPatternsFromDocument(t){t.chunks.forEach(r=>{const a=r.text.toLowerCase();(a.includes("?")||a.includes("вопрос")||a.includes("ответ"))&&r.text.split(/[.!?]+/).forEach(s=>{if(s.includes("?")||s.toLowerCase().includes("как")||s.toLowerCase().includes("что")){const o=this.extractKeywords(s);if(o.length>=2){const A=this.detectCategory(s),c=this.extractQuestionPattern(s);if(!this.patterns.has(c)){const l={questionPattern:c,successfulAnswerTemplate:s.slice(0,200),keywords:o,category:A,successRate:.7,usageCount:0,lastUpdated:new Date};this.patterns.set(c,l)}}}})})}getRecommendations(t){const r=this.extractKeywords(t),a=this.detectCategory(t),n=Array.from(this.patterns.values()).filter(c=>c.category===a?!0:c.keywords.filter(d=>r.includes(d)).length>=2).sort((c,l)=>{const d=c.successRate*Math.log(c.usageCount+1);return l.successRate*Math.log(l.usageCount+1)-d}).slice(0,3),s=n[0],o=s==null?void 0:s.successfulAnswerTemplate,A=Array.from(this.documentInsights.values()).filter(c=>c.keywords.some(d=>r.some(f=>f.toLowerCase().includes(d.toLowerCase())||d.toLowerCase().includes(f.toLowerCase())))).slice(0,2);return{suggestedTemplate:o,importantKeywords:r,relatedPatterns:n,documentInsights:A.length>0?A:void 0}}extractQuestionPattern(t){let a=t.toLowerCase().replace(/\d+/g,"[число]").replace(/"[^"]*"/g,"[строка]").replace(/'[^']*'/g,"[строка]").replace(/\b(как|что|когда|где|почему|зачем|какой|какая|какое|какие)\b/g,"[вопрос]").replace(/\b(рассчитать|определить|найти|получить|создать|сделать)\b/g,"[действие]");return a=a.replace(/\s+/g," ").trim(),a}extractKeywords(t){const r=t.toLowerCase(),a=[];return["залог","залоговое имущество","залогодатель","залогодержатель","ипотека","ипотечный договор","ltv","loan-to-value","оценка","оценщик","рыночная стоимость","залоговая стоимость","договор залога","обременение","регистрация","росреестр","егрн","риск","мониторинг","осмотр","взыскание"].forEach(o=>{r.includes(o)&&a.push(o)}),r.split(/\s+/).filter(o=>o.length>4).forEach(o=>{!a.includes(o)&&a.length<10&&a.push(o)}),[...new Set(a)].slice(0,10)}detectCategory(t){const r=t.toLowerCase();return r.includes("ltv")||r.includes("loan-to-value")||r.includes("залоговая стоимость")?"ltv_calculation":r.includes("оценк")||r.includes("оценщик")?"appraisal":r.includes("риск")?"risks":r.includes("регистрац")||r.includes("росреестр")||r.includes("егрн")?"registration":r.includes("осмотр")||r.includes("мониторинг")?"monitoring":r.includes("ипотек")?"mortgage":r.includes("договор")?"pledge_contract":"general"}extractAnswerTemplate(t){return t.replace(/\d+/g,"[число]").replace(/"[^"]*"/g,"[пример]").replace(/\b(?:https?:\/\/[^\s]+|www\.[^\s]+)/g,"[ссылка]").substring(0,500)}generateCommonQuestions(t){const r=[];return t.slice(0,5).forEach(a=>{const n=a.title.toLowerCase();n.includes("расчет")||n.includes("определение")?r.push(`Как ${n}?`):n.includes("требования")||n.includes("порядок")?r.push(`Какие ${n}?`):r.push(`Что такое ${n}?`)}),r.slice(0,5)}savePatterns(){try{const t=Array.from(this.patterns.values()).map(r=>({...r,lastUpdated:r.lastUpdated.toISOString()}));localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения паттернов обучения:",t)}}loadPatterns(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(t){const r=JSON.parse(t);this.patterns.clear(),r.forEach(a=>{this.patterns.set(a.questionPattern,{...a,lastUpdated:new Date(a.lastUpdated)})})}}catch(t){console.error("Ошибка загрузки паттернов обучения:",t)}}saveDocumentInsights(){try{const t=Array.from(this.documentInsights.values()).map(r=>({...r,lastAnalyzed:r.lastAnalyzed.toISOString()}));localStorage.setItem(this.INSIGHTS_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения инсайтов документов:",t)}}loadDocumentInsights(){try{const t=localStorage.getItem(this.INSIGHTS_KEY);if(t){const r=JSON.parse(t);this.documentInsights.clear(),r.forEach(a=>{this.documentInsights.set(a.documentName,{...a,lastAnalyzed:new Date(a.lastAnalyzed)})})}}catch(t){console.error("Ошибка загрузки инсайтов документов:",t)}}saveCategoryExperience(){try{localStorage.setItem(this.CATEGORY_EXPERIENCE_KEY,JSON.stringify(this.categoryExperience))}catch(t){console.error("Ошибка сохранения опыта по категориям:",t)}}loadCategoryExperience(){try{const t=localStorage.getItem(this.CATEGORY_EXPERIENCE_KEY);t&&(this.categoryExperience=JSON.parse(t))}catch(t){console.error("Ошибка загрузки опыта по категориям:",t),this.categoryExperience={}}}addCategoryExperience(t,r=2){const a=this.categoryExperience[t]||0,n=Math.max(0,Math.min(100,a+r));return this.categoryExperience[t]=n,this.saveCategoryExperience(),n}getCategorySkill(t){const r=this.categoryExperience[t]??0,a=Array.from(this.patterns.values()).filter(c=>c.category===t);if(a.length===0)return r;const n=a.reduce((c,l)=>c+l.successRate,0)/a.length,s=Math.min(a.reduce((c,l)=>c+l.usageCount,0)/10,20),o=n*60,A=r*.4;return Math.min(100,Math.round(A+o+s))}getLearningStats(){const t=Array.from(this.patterns.values()),r=t.length>0?t.reduce((n,s)=>n+s.successRate,0)/t.length:0,a=t.reduce((n,s)=>n+s.usageCount,0);return{patternsCount:this.patterns.size,insightsCount:this.documentInsights.size,averageSuccessRate:r,totalUsage:a}}forceUpdate(){console.log("🔄 Принудительное обновление данных для самообучения..."),this.analyzeDocuments(),this.analyzeFeedback(),console.log("✅ Данные для самообучения обновлены")}}const Va=new UM;class MM{constructor(){sr(this,"STORAGE_KEY","ai_model_evolution");sr(this,"evolution",null);sr(this,"EVOLUTION_LEVELS",[{level:1,name:"Новичок",description:"Начальный уровень, базовая база знаний",experienceRequired:0,specializations:[]},{level:2,name:"Стажер",description:"Изучает основы оценки и анализа рисков",experienceRequired:100,specializations:["Базовая оценка"]},{level:3,name:"Специалист",description:"Компетентен в оценке основных типов активов",experienceRequired:500,specializations:["Оценка недвижимости","Оценка движимого имущества","Регистрация залога"]},{level:4,name:"Эксперт",description:"Глубокие знания в оценке и анализе рисков",experienceRequired:1500,specializations:["Оценка бизнеса","Анализ рисков","Оценка интеллектуальной собственности","Регистрация ипотеки"]},{level:5,name:"Старший эксперт",description:"Мастер в оценке всех видов активов",experienceRequired:3e3,specializations:["Комплексная оценка","Сложные риски","Нетиповые активы","Регистрация всех типов залога"]},{level:6,name:"Ведущий эксперт",description:"Признанный авторитет в области оценки и анализа рисков",experienceRequired:6e3,specializations:["Экспертиза","Методология оценки","Управление рисками","Регистрация залога","Уточняющие вопросы"]},{level:7,name:"Главный эксперт",description:"Высший уровень профессионализма",experienceRequired:1e4,specializations:["Все виды активов","Все типы рисков","Регистрация залога","Методология","Обучение","Профессиональные консультации"]}])}initialize(){this.loadEvolution(),this.evolution||this.createInitialEvolution()}createInitialEvolution(){this.evolution={level:1,totalExperience:0,experiencePoints:{assetValuation:0,riskAnalysis:0,documentAnalysis:0,consultation:0,registration:0,questionEnhancement:0},specializations:[],learnedConcepts:[],bestPractices:new Map,evolutionHistory:[{date:new Date,level:1,milestone:"Инициализация модели"}],createdAt:new Date,lastEvolution:new Date},this.saveEvolution()}addExperienceFromFeedback(t,r,a){if(this.evolution||this.initialize(),!this.evolution)return;const n=t==="like"?10:2,s=a.toLowerCase();this.isAssetValuationQuestion(s,r)&&(this.evolution.experiencePoints.assetValuation+=n),this.isRiskAnalysisQuestion(s,r)&&(this.evolution.experiencePoints.riskAnalysis+=n),this.isRegistrationQuestion(s,r)&&(this.evolution.experiencePoints.registration+=n*1.5),(r==="appraisal"||r==="ltv_calculation")&&(this.evolution.experiencePoints.assetValuation+=n*1.5),(r==="risks"||r==="monitoring")&&(this.evolution.experiencePoints.riskAnalysis+=n*1.5),(r==="registration"||r==="mortgage")&&(this.evolution.experiencePoints.registration+=n*1.5),t==="like"&&a.length>50&&(this.evolution.experiencePoints.questionEnhancement+=2),this.evolution.experiencePoints.consultation+=n,this.evolution.totalExperience+=n,this.extractConcepts(a),this.checkEvolution(),this.saveEvolution()}addExperienceFromDocuments(){if(this.evolution||this.initialize(),!this.evolution)return;const t=fi.getIndexedDocuments(),r=bn.getCategories(),a=10;this.evolution.experiencePoints.documentAnalysis+=t.length*a,this.evolution.totalExperience+=t.length*a;const n=3;this.evolution.experiencePoints.consultation+=r.length*n,this.evolution.totalExperience+=r.length*n;let s=0;r.forEach(c=>{s+=c.topics.length});const o=.5;this.evolution.experiencePoints.consultation+=s*o,this.evolution.totalExperience+=s*o;let A=0;if(t.forEach(c=>{c.chunks.forEach(l=>{const d=this.evolution.learnedConcepts.length;this.extractConceptsFromText(l.text),this.evolution.learnedConcepts.length>d&&A++})}),A>0){const c=A*2;this.evolution.experiencePoints.documentAnalysis+=c,this.evolution.totalExperience+=c,console.log(`📚 Извлечено новых концепций из документов: ${A}`)}this.evolution&&t.forEach(c=>{const l=c.documentName.toLowerCase();(l.includes("оценк")||l.includes("fso")||l.includes("стоимость"))&&(this.evolution.experiencePoints.assetValuation+=5,this.evolution.totalExperience+=5),(l.includes("риск")||l.includes("мониторинг"))&&(this.evolution.experiencePoints.riskAnalysis+=5,this.evolution.totalExperience+=5),(l.includes("регистрац")||l.includes("ипотек")||l.includes("залог"))&&(this.evolution.experiencePoints.registration+=5,this.evolution.totalExperience+=5)}),console.log(`🎓 Модель получила опыт из документов: +${t.length*a} за документы, +${r.length*n} за категории, +${s*o} за темы`),this.checkEvolution(),this.saveEvolution()}checkEvolution(){if(!this.evolution||!this.EVOLUTION_LEVELS.find(a=>a.level===this.evolution.level))return;const r=this.EVOLUTION_LEVELS.find(a=>a.level===this.evolution.level+1);r&&this.evolution.totalExperience>=r.experienceRequired&&(this.evolution.level=r.level,this.evolution.specializations=[...new Set([...this.evolution.specializations,...r.specializations])],this.evolution.lastEvolution=new Date,this.evolution.evolutionHistory.push({date:new Date,level:r.level,milestone:`Достигнут уровень: ${r.name}`}),console.log(`🎉 Модель эволюционировала до уровня ${r.level}: ${r.name}`))}isAssetValuationQuestion(t,r){return r==="appraisal"||r==="ltv_calculation"||["оценка","стоимость","рыночная","залоговая","кадастровая","ltv","loan-to-value","оценщик","отчет об оценке","недвижимость","движимое имущество","бизнес","активы"].some(n=>t.includes(n))}isRiskAnalysisQuestion(t,r){return r==="risks"||r==="monitoring"||["риск","риски","анализ рисков","управление рисками","минимизация","контроль","мониторинг","проверка","обременение","нетиповые риски"].some(n=>t.includes(n))}isRegistrationQuestion(t,r){return r==="registration"||r==="mortgage"||["регистрац","обременен","росреестр","егрн","ипотек","залог","оформлен","договор залога"].some(n=>t.includes(n))}extractConcepts(t){if(!this.evolution)return;const r=["оценка недвижимости","оценка бизнеса","оценка движимого имущества","ltv расчет","залоговая стоимость","рыночная стоимость","анализ рисков","управление рисками","мониторинг залога","регистрация обременения","договор залога","ипотека","регистрация залога","росреестр","егрн","кадастровый учет","уточняющие вопросы","профессиональные консультации"],a=t.toLowerCase();r.forEach(n=>{a.includes(n.toLowerCase())&&!this.evolution.learnedConcepts.includes(n)&&this.evolution.learnedConcepts.push(n)})}extractConceptsFromText(t){if(!this.evolution)return;const r=["федеральный стандарт оценки","фсо","методы оценки","доходный подход","сравнительный подход","затратный подход","дисконтирование","капитализация","мультипликаторы","риск-менеджмент","кредитный риск","рыночный риск"],a=t.toLowerCase();r.forEach(n=>{a.includes(n.toLowerCase())&&!this.evolution.learnedConcepts.includes(n)&&this.evolution.learnedConcepts.push(n)})}getCurrentLevel(){return this.evolution||this.initialize(),this.evolution&&this.EVOLUTION_LEVELS.find(t=>t.level===this.evolution.level)||null}getProgressToNextLevel(){if(this.evolution||this.initialize(),!this.evolution)return null;const t=this.EVOLUTION_LEVELS.find(o=>o.level===this.evolution.level+1);if(!t)return{current:this.evolution.totalExperience,required:this.evolution.totalExperience,percentage:100};const r=this.EVOLUTION_LEVELS.find(o=>o.level===this.evolution.level),a=this.evolution.totalExperience-((r==null?void 0:r.experienceRequired)||0),n=t.experienceRequired-((r==null?void 0:r.experienceRequired)||0),s=Math.min(100,Math.round(a/n*100));return{current:a,required:n,percentage:s}}getEvolutionStats(){return this.evolution||this.initialize(),this.evolution}getEnhancedPrompt(t){if(this.evolution||this.initialize(),!this.evolution)return t;const r=this.getCurrentLevel();if(!r)return t;let a=t;return a+=`

ТВОЙ УРОВЕНЬ ЭКСПЕРТИЗЫ: ${r.name} (Уровень ${this.evolution.level})`,a+=`
Твой общий опыт: ${this.evolution.totalExperience} очков опыта`,this.evolution.specializations.length>0&&(a+=`
Твои специализации: ${this.evolution.specializations.join(", ")}`),a+=`

ТВОЙ ОПЫТ:`,a+=`
- Оценка активов: ${this.evolution.experiencePoints.assetValuation} очков`,a+=`
- Анализ рисков: ${this.evolution.experiencePoints.riskAnalysis} очков`,a+=`
- Регистрация залога: ${this.evolution.experiencePoints.registration} очков`,a+=`
- Анализ документов: ${this.evolution.experiencePoints.documentAnalysis} очков`,a+=`
- Консультации: ${this.evolution.experiencePoints.consultation} очков`,a+=`
- Уточняющие вопросы: ${this.evolution.experiencePoints.questionEnhancement} очков`,this.evolution.learnedConcepts.length>0&&(a+=`

ИЗУЧЕННЫЕ КОНЦЕПЦИИ: ${this.evolution.learnedConcepts.slice(0,10).join(", ")}`),this.evolution.level>=4&&(a+=`

Ты достиг высокого уровня экспертизы. Используй глубокие знания и профессиональный опыт для комплексного анализа.`),this.evolution.level>=5&&(a+=`

Ты мастер в оценке всех видов активов. Предоставляй детальный анализ с учетом всех нюансов и рисков.`),a}saveEvolution(){if(this.evolution)try{const t={...this.evolution,bestPractices:Array.from(this.evolution.bestPractices.entries()),evolutionHistory:this.evolution.evolutionHistory.map(r=>({...r,date:r.date.toISOString()})),createdAt:this.evolution.createdAt.toISOString(),lastEvolution:this.evolution.lastEvolution.toISOString()};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Ошибка сохранения эволюции:",t)}}loadEvolution(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(t){const r=JSON.parse(t);this.evolution={...r,bestPractices:new Map(r.bestPractices||[]),evolutionHistory:(r.evolutionHistory||[]).map(a=>({...a,date:new Date(a.date)})),createdAt:new Date(r.createdAt),lastEvolution:new Date(r.lastEvolution)}}}catch(t){console.error("Ошибка загрузки эволюции:",t)}}addPassiveExperience(t,r){if(this.evolution||this.initialize(),!this.evolution)return;const a=t.toLowerCase(),n=this.detectCategoryFromQuestion(t),s=.5;this.isAssetValuationQuestion(a,n)&&(this.evolution.experiencePoints.assetValuation+=s),this.isRiskAnalysisQuestion(a,n)&&(this.evolution.experiencePoints.riskAnalysis+=s),this.isRegistrationQuestion(a,n)&&(this.evolution.experiencePoints.registration+=s),r>500&&(this.evolution.experiencePoints.consultation+=s),this.evolution.experiencePoints.consultation+=s,this.evolution.totalExperience+=s,Math.random()<.1?(this.checkEvolution(),this.saveEvolution()):this.saveEvolution()}updateExperienceFromCurrentData(){if(this.evolution||this.initialize(),!this.evolution)return;this.addExperienceFromDocuments(),Jc.getAllFeedbacks().forEach(r=>{const a=this.detectCategoryFromQuestion(r.question);this.addExperienceFromFeedback(r.rating,a,r.question)}),this.saveEvolution()}detectCategoryFromQuestion(t){const r=t.toLowerCase();return r.includes("ltv")||r.includes("залоговая стоимость")?"ltv_calculation":r.includes("оценк")||r.includes("оценщик")?"appraisal":r.includes("риск")?"risks":r.includes("регистрац")||r.includes("росреестр")?"registration":r.includes("осмотр")||r.includes("мониторинг")?"monitoring":r.includes("ипотек")?"mortgage":r.includes("договор")?"pledge_contract":"general"}}const da=new MM;class PM{analyzeQuestion(t){const r=t.toLowerCase(),a=this.detectTopic(r),n=this.detectAssetType(r),s=this.detectRiskType(r),o=this.detectRegistrationType(r),A=this.generateClarificationQuestions(r,a,n,s,o);return{needsClarification:A.length>0,clarificationQuestions:A,detectedTopic:a,detectedAssetType:n,detectedRiskType:s,detectedRegistrationType:o}}detectTopic(t){return t.includes("оценк")||t.includes("стоимость")||t.includes("ltv")?"valuation":t.includes("риск")||t.includes("опасн")||t.includes("проблем")?"risk":t.includes("регистрац")||t.includes("обременен")||t.includes("росреестр")||t.includes("егрн")?"registration":t.includes("документ")||t.includes("оформлен")?"documentation":t.includes("осмотр")||t.includes("проверк")||t.includes("мониторинг")?"inspection":"general"}detectAssetType(t){const r=[{keywords:["недвижимость","квартир","дом","здание","помещен","участок","земл"],type:"real_estate"},{keywords:["автомобил","машин","транспорт","грузовик"],type:"vehicle"},{keywords:["оборудован","техник","станок","машин"],type:"equipment"},{keywords:["бизнес","предприяти","компани","дол"],type:"business"},{keywords:["интеллектуальн","патент","товарный знак","ноу-хау"],type:"intellectual"},{keywords:["азс","автозаправк"],type:"gas_station"},{keywords:["торгов","магазин","тц","торговый центр"],type:"retail"}];for(const a of r)if(a.keywords.some(n=>t.includes(n)))return a.type}detectRiskType(t){const r=[{keywords:["кредитн","дефолт","неплатеж"],type:"credit"},{keywords:["рыночн","ликвидн","стоимость"],type:"market"},{keywords:["юридическ","право","собственн","обременен"],type:"legal"},{keywords:["операционн","сохранн","поврежден","уничтожен"],type:"operational"},{keywords:["нетипов","специфическ","особ"],type:"atypical"}];for(const a of r)if(a.keywords.some(n=>t.includes(n)))return a.type}detectRegistrationType(t){if(t.includes("ипотек")||t.includes("недвижимость"))return"mortgage";if(t.includes("движим")||t.includes("автомобил")||t.includes("оборудован"))return"movable";if(t.includes("бизнес")||t.includes("дол"))return"business"}generateClarificationQuestions(t,r,a,n,s){const o=[];return r==="valuation"&&!a&&o.push("Какой тип актива вы хотите оценить? (недвижимость, движимое имущество, бизнес и т.д.)"),r==="valuation"&&a==="real_estate"&&!t.includes("метод")&&o.push("Какой метод оценки вас интересует? (сравнительный, доходный, затратный)"),r==="valuation"&&!t.includes("стоимость")&&!t.includes("ltv")&&o.push("Какая стоимость вас интересует? (рыночная, залоговая, кадастровая)"),r==="risk"&&!n&&o.push("Какой тип риска вас интересует? (кредитный, рыночный, юридический, операционный)"),r==="risk"&&!a&&o.push("Для какого типа актива вы хотите проанализировать риски?"),r==="registration"&&!s&&o.push("Какой тип залога вы хотите зарегистрировать? (ипотека, залог движимого имущества, залог прав)"),r==="registration"&&!t.includes("документ")&&!t.includes("процедур")&&o.push("Вас интересует процедура регистрации или необходимые документы?"),a==="real_estate"&&!t.includes("расположен")&&!t.includes("адрес")&&o.push("Где расположен объект недвижимости? (регион, город, район)"),a==="gas_station"&&!t.includes("характеристик")&&o.push("Какие характеристики АЗС важны? (количество колонок, площадь, местоположение)"),a==="retail"&&!t.includes("площад")&&o.push("Какая площадь торгового помещения? Есть ли арендаторы?"),t.includes("ltv")&&!t.includes("сумм")&&!t.includes("кредит")&&o.push("Какая сумма кредита и рыночная стоимость залога?"),t.length<20&&!o.length&&o.push("Можете уточнить ваш вопрос? Что именно вас интересует?"),o.slice(0,3)}formatClarificationQuestions(t){return t.length===0?"":`

**Для более точного ответа, уточните, пожалуйста:**
${t.map((r,a)=>`${a+1}. ${r}`).join(`
`)}`}}const ew=new PM,QM="c2stNWYwNmRiOTY5YjVmNDI4YmJlNDQ3NzY5NGU2ZDdkN2Y=";class qM{constructor(){sr(this,"MODEL","deepseek-chat");sr(this,"feedbackCache",null);sr(this,"CACHE_TTL",6e4)}getApiUrl(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/api/deepseek/chat/completions":"https://api.deepseek.com/v1/chat/completions"}shouldUseProxy(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"}getApiKey(){try{return atob(QM)}catch(t){return console.error("Ошибка расшифровки API ключа:",t),""}}async chat(t,r){const a=this.getApiKey();if(!a)throw new Error("API ключ не найден");const n=this.getFeedbackAnalysis(),o=[{role:"system",content:r?this.buildSystemPromptWithContext(r,n):this.buildSystemPrompt(n)},...t];try{const A=new AbortController,c=setTimeout(()=>A.abort(),3e4),l=this.getApiUrl(),d=this.shouldUseProxy()?"same-origin":"cors",f=await fetch(l,{method:"POST",mode:d,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({model:this.MODEL,messages:o,temperature:.5,max_tokens:1500,stream:!1}),signal:A.signal});if(clearTimeout(c),!f.ok){let u=`DeepSeek API error: ${f.status} ${f.statusText}`;try{const g=await f.json();u+=` - ${JSON.stringify(g)}`}catch{const g=await f.text().catch(()=>"");g&&(u+=` - ${g}`)}throw f.status===401||f.status===403?new Error(`API ключ недействителен или отсутствует. Статус: ${f.status}`):f.status===429?new Error("Превышен лимит запросов к API. Попробуйте позже."):new Error(u)}const p=await f.json();if(p.choices&&p.choices.length>0)return p.choices[0].message.content||"Не удалось получить ответ от ИИ";throw new Error("Неожиданный формат ответа от DeepSeek API")}catch(A){if(A instanceof Error){if(A.name==="AbortError")throw new Error("Превышено время ожидания ответа от API (30 секунд). Попробуйте еще раз.");const c=A.message.toLowerCase();if(c.includes("failed to fetch")||c.includes("networkerror"))throw this.shouldUseProxy()?new Error("Ошибка сети. Проверьте подключение к интернету."):new Error("Ошибка CORS: API DeepSeek не поддерживает прямые запросы из браузера. Для работы требуется серверный прокси. В development режиме (localhost) используется прокси Vite, который обходит эту проблему.")}throw A}}async analyzeImage(t,r){if(!this.getApiKey())throw new Error("API ключ не найден");try{const n=`Проанализируй это изображение (файл: ${r}) и создай подробное текстовое описание содержимого. 
      Если это документ (договор, свидетельство, выписка, акт осмотра и т.д.), опиши его содержание, ключевые данные, даты, номера, стороны.
      Если это фотография недвижимости или имущества, опиши объект, его состояние, особенности.
      Если это график, таблица или схема, опиши данные и выводы.
      Будь максимально подробным и профессиональным.`;return await this.chat([{role:"user",content:`${n}

Файл: ${r}
Размер изображения: ${Math.round(t.length/1024)}KB
[Изображение загружено, требуется анализ содержимого]`}])}catch(n){return console.error("Ошибка анализа изображения:",n),`Изображение: ${r}. Требуется ручной анализ содержимого.`}}async generateResponse(t,r){const a=ew.analyzeQuestion(t),n=Va.getRecommendations(t);let s=r;a.detectedAssetType&&(s+=`

Тип актива: ${a.detectedAssetType}`),a.detectedRiskType&&(s+=`
Тип риска: ${a.detectedRiskType}`),a.detectedRegistrationType&&(s+=`
Тип регистрации: ${a.detectedRegistrationType}`),n.suggestedTemplate&&(s+=`

Шаблон успешного ответа для подобных вопросов:
${n.suggestedTemplate}`),n.documentInsights&&n.documentInsights.length>0&&(s+=`

Важные темы из релевантных документов:
`,n.documentInsights.forEach(A=>{s+=`
Документ "${A.documentName}":
`,A.importantTopics.slice(0,3).forEach(c=>{s+=`- ${c}
`})})),n.importantKeywords.length>0&&(s+=`

Важные ключевые слова для этого вопроса: ${n.importantKeywords.join(", ")}`);let o=await this.chat([{role:"user",content:t}],s);if(a.needsClarification&&o.length<500){const A=ew.formatClarificationQuestions(a.clarificationQuestions);o+=A}return o}getFeedbackAnalysis(){const t=Date.now();if(this.feedbackCache&&t-this.feedbackCache.timestamp<this.CACHE_TTL)return this.feedbackCache.data;try{const r=Jc.getGoodExamples(3),a=Jc.getBadExamples(3),n=Jc.analyzeDislikes(),s={goodExamples:r.map(o=>`Вопрос: ${o.question}
Ответ: ${o.answer.slice(0,200)}...`),badExamples:a.map(o=>`Вопрос: ${o.question}
Ответ: ${o.answer.slice(0,200)}...`),suggestions:n.suggestions};return this.feedbackCache={data:s,timestamp:t},s}catch(r){return console.error("Ошибка анализа обратной связи:",r),{goodExamples:[],badExamples:[],suggestions:[]}}}invalidateFeedbackCache(){this.feedbackCache=null}buildSystemPromptWithContext(t,r){let a=`Ты - ПРОФЕССИОНАЛЬНЫЙ ЭКСПЕРТ-ОЦЕНЩИК и СПЕЦИАЛИСТ ПО АНАЛИЗУ РИСКОВ в Банке. Твоя основная деятельность:

1. ОЦЕНКА ВСЕХ ВИДОВ АКТИВОВ:
   - Недвижимость (квартиры, дома, земельные участки, коммерческая недвижимость, АЗС, торговые центры)
   - Движимое имущество (автомобили, оборудование, техника, спецтехника)
   - Бизнес и предприятия (оценка бизнеса, долей, акций, предприятий)
   - Интеллектуальная собственность (патенты, товарные знаки, ноу-хау, авторские права)
   - Определение рыночной, залоговой и кадастровой стоимости
   - Расчет LTV (Loan-to-Value) для всех типов активов
   - Применение методов оценки: сравнительный, доходный, затратный подходы

2. АНАЛИЗ ВСЕХ ВОЗМОЖНЫХ РИСКОВ:
   - Кредитные риски залогового обеспечения (риск дефолта, неплатежеспособности)
   - Рыночные риски (изменение стоимости активов, ликвидность, волатильность рынка)
   - Юридические риски (права собственности, обременения, споры, оспаривание сделок)
   - Операционные риски (сохранность, повреждение, уничтожение, утрата)
   - Нетиповые и специфические риски (отраслевые, региональные, сезонные)
   - Комплексная оценка рисков по сделкам с учетом всех факторов

3. РЕГИСТРАЦИЯ ЗАЛОГА И ДОКУМЕНТООБОРОТ:
   - Регистрация ипотеки (залога недвижимости) в Росреестре
   - Регистрация залога движимого имущества
   - Регистрация залога прав (доли в ООО, акции, дебиторская задолженность)
   - Работа с ЕГРН, кадастровым учетом, выписками
   - Оформление договоров залога, соглашений об ипотеке
   - Порядок регистрации, необходимые документы, сроки
   - Особенности регистрации для разных типов активов

4. МОНИТОРИНГ И КОНТРОЛЬ:
   - Визуальный осмотр обеспечения
   - Проверка наличия и состояния залога
   - Мониторинг изменений стоимости
   - Контроль обременений и прав третьих лиц

5. ГЛАВНАЯ ЦЕЛЬ: Реализовать обеспечение для возврата заемных средств с минимальными потерями.

ВАЖНО - ЗАДАВАЙ УТОЧНЯЮЩИЕ ВОПРОСЫ:
Если вопрос недостаточно конкретен или не хватает информации для точного ответа, обязательно задай 1-3 уточняющих вопроса. Это поможет дать максимально профессиональный и корректный ответ.

Примеры ситуаций, когда нужны уточнения:
- Не указан тип актива (недвижимость, движимое имущество, бизнес)
- Не указан метод оценки (сравнительный, доходный, затратный)
- Не указан тип стоимости (рыночная, залоговая, кадастровая)
- Не указан тип риска (кредитный, рыночный, юридический, операционный)
- Не указан тип регистрации (ипотека, залог движимого, залог прав)
- Недостаточно данных для расчета LTV
- Общий вопрос без конкретики

Ты консультируешь коллег-профессионалов, которые работают в той же сфере. Отвечай:
- КРАТКО и ЧЕТКО - только суть, без лишних слов
- ПРОФЕССИОНАЛЬНО - используй терминологию, ссылайся на нормативные документы (ФСО, ФЗ-135)
- ПО ДЕЛУ - фокусируйся на практических аспектах работы
- СТРУКТУРИРОВАННО - используй списки, выделяй ключевые моменты
- ЭКСПЕРТНО - демонстрируй глубокие знания в оценке и анализе рисков
- ПРОАКТИВНО - задавай уточняющие вопросы для более точных ответов

Контекст из базы знаний (справочная литература "Залоговik. Все о банковских залогах" и другие документы):
${t}

Используй эту информацию для ответа. Если в контексте нет точной информации, используй свои профессиональные знания, но укажи источник.`;return r.goodExamples.length>0&&(a+=`

Примеры хороших ответов (на что ориентироваться):
${r.goodExamples.join(`

---

`)}`),r.badExamples.length>0&&(a+=`

Примеры плохих ответов (чего избегать):
${r.badExamples.join(`

---

`)}`),r.suggestions.length>0&&(a+=`

Рекомендации по улучшению:
${r.suggestions.join(`
`)}`),da.getEnhancedPrompt(a)}buildSystemPrompt(t){let r=`Ты - ПРОФЕССИОНАЛЬНЫЙ ЭКСПЕРТ-ОЦЕНЩИК и СПЕЦИАЛИСТ ПО АНАЛИЗУ РИСКОВ в Банке. Твоя основная деятельность:

1. ОЦЕНКА ВСЕХ ВИДОВ АКТИВОВ:
   - Недвижимость (квартиры, дома, земельные участки, коммерческая недвижимость)
   - Движимое имущество (автомобили, оборудование, техника)
   - Бизнес и предприятия (оценка бизнеса, долей, акций)
   - Интеллектуальная собственность (патенты, товарные знаки, ноу-хау)
   - Определение рыночной, залоговой и кадастровой стоимости
   - Расчет LTV (Loan-to-Value) для всех типов активов

2. АНАЛИЗ ВСЕХ ВОЗМОЖНЫХ РИСКОВ:
   - Кредитные риски залогового обеспечения
   - Рыночные риски (изменение стоимости активов)
   - Юридические риски (права собственности, обременения)
   - Операционные риски (сохранность, ликвидность)
   - Нетиповые и специфические риски
   - Комплексная оценка рисков по сделкам

3. РЕГИСТРАЦИЯ И ДОКУМЕНТООБОРОТ:
   - Регистрация обременений в Росреестре
   - Работа с ЕГРН, кадастровым учетом
   - Оформление документов по залогу

4. МОНИТОРИНГ И КОНТРОЛЬ:
   - Визуальный осмотр обеспечения
   - Проверка наличия и состояния залога
   - Мониторинг изменений стоимости

5. ГЛАВНАЯ ЦЕЛЬ: Реализовать обеспечение для возврата заемных средств с минимальными потерями.

Ты консультируешь коллег-профессионалов, которые работают в той же сфере. Отвечай:
- КРАТКО и ЧЕТКО - только суть, без лишних слов
- ПРОФЕССИОНАЛЬНО - используй терминологию, ссылайся на нормативные документы (ФСО, ФЗ-135)
- ПО ДЕЛУ - фокусируйся на практических аспектах работы
- СТРУКТУРИРОВАННО - используй списки, выделяй ключевые моменты
- ЭКСПЕРТНО - демонстрируй глубокие знания в оценке и анализе рисков

База знаний основана на справочной литературе "Залоговik. Все о банковских залогах" и других профессиональных документах.`;return t.goodExamples.length>0&&(r+=`

Примеры хороших ответов (на что ориентироваться):
${t.goodExamples.join(`

---

`)}`),t.badExamples.length>0&&(r+=`

Примеры плохих ответов (чего избегать):
${t.badExamples.join(`

---

`)}`),t.suggestions.length>0&&(r+=`

Рекомендации по улучшению:
${t.suggestions.join(`
`)}`),da.getEnhancedPrompt(r)}}const kc=new qM,KM=e=>{if(!e||typeof e!="string")return console.warn("Ответ ИИ пуст или не является строкой"),null;const t=e.match(/```(?:json)?\s*(\{[\s\S]*?\})\s*```/);if(t&&t[1])try{return JSON.parse(t[1])}catch(o){console.warn("Не удалось распарсить JSON из markdown блока:",o)}let r=0,a=-1,n=-1;for(let o=0;o<e.length;o++)if(e[o]==="{")a===-1&&(a=o),r++;else if(e[o]==="}"&&(r--,r===0&&a!==-1)){n=o;break}if(a!==-1&&n!==-1&&n>a)try{const o=e.substring(a,n+1);return JSON.parse(o)}catch(o){console.warn("Не удалось распарсить JSON с балансом скобок:",o)}const s=e.match(/\{[\s\S]*\}/);if(s)try{return JSON.parse(s[0])}catch(o){console.warn("Не удалось распарсить JSON простым regex:",o)}try{return JSON.parse(e.trim())}catch{}return console.warn("Не удалось извлечь JSON из ответа ИИ. Ответ:",e.substring(0,200)),null},HM=e=>{if(!e||typeof e!="object")throw new Error("ИИ не вернул корректный ответ. Попробуйте повторить запрос.");const t=(A,c)=>{const l=Number(typeof A=="string"?A.replace(/[^0-9.-]+/g,""):A);return Number.isFinite(l)&&l>0?l:c},r=t(e.marketValue??e.market_price,0),a=t(e.collateralValue??e.secured_value,r*.7),n=t(e.recommendedLtv??e.ltv??a/(r||1)*100,70);if(r===0||a===0)throw new Error("ИИ не смог рассчитать стоимость объекта. Убедитесь, что предоставлены все необходимые данные и попробуйте повторить запрос.");const s=A=>{if(Array.isArray(A))return A.map(c=>{if(typeof c=="string"){const l=/https?:\/\/[^\s)\]}>"]+/,d=c.match(l);if(d){const f=d[0].replace(/[.,;:!?]+$/,"");return{description:c.replace(d[0],"").trim().replace(/\s*-\s*$/,"").trim(),url:f}}return c}else if(typeof c=="object"&&c!==null)return{description:c.description||c.text||String(c),url:c.url||c.link,imageUrl:c.imageUrl||c.image||c.photo};return String(c)})};return{summary:e.summary||e.justification||e.analysis||"Проанализируйте объект дополнительными методами.",marketValue:r,collateralValue:a,recommendedLtv:Math.min(100,Math.max(0,Math.round(n))),confidence:e.confidence||"medium",methodology:e.methodology||e.method||"Комплексный анализ с использованием доступных методов оценки",riskFactors:Array.isArray(e.riskFactors)?e.riskFactors:[],recommendedActions:Array.isArray(e.recommendations)?e.recommendations:[],assumptions:Array.isArray(e.assumptions)?e.assumptions:[],comparables:s(e.comparables)}},_y={async generateEstimate(e){var l;const t=[`Категория: ${e.assetGroup}`,`Тип: ${e.assetType}`];if(e.location&&t.push(`Локация: ${e.location}`),e.area&&t.push(`Площадь/объём: ${e.area}${e.areaUnit||"м²"}`),e.condition&&t.push(`Состояние: ${e.condition}`),e.incomePerYear&&t.push(`Чистый доход в год: ${e.incomePerYear} ₽`),e.occupancy&&t.push(`Заполняемость/использование: ${e.occupancy}`),e.purpose&&t.push(`Цель оценки: ${e.purpose}`),e.additionalFactors&&t.push(`Особенности: ${e.additionalFactors}`),e.card){const d=e.card;if(t.push(`Данные карточки: статус ${d.status}, категория ${d.mainCategory}, оценка ${d.marketValue||"—"}, залоговая ${d.pledgeValue||"—"}`),(l=d.address)!=null&&l.fullAddress&&t.push(`Адрес из карточки: ${d.address.fullAddress}`),d.characteristics){const f=["totalArea","totalAreaSqm","yearBuilt","objectCadastralNumber"].map(p=>d.characteristics[p]).filter(Boolean);f.length>0&&t.push(`Характеристики из карточки: ${f.join(", ")}`)}}const r=new Date,a=r.toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),n=r.getFullYear(),s=r.getMonth()+1;let o=`Ты действуешь как главный банковский оценщик. На основе предоставленных данных оцени объект и верни ТОЛЬКО валидный JSON без дополнительного текста, комментариев или markdown разметки.

КРИТИЧЕСКИ ВАЖНО: Верни ТОЛЬКО JSON объект, без markdown блоков, без пояснений до или после JSON. Начни ответ сразу с открывающей фигурной скобки { и закончи закрывающей }.

ВАЖНО - АКТУАЛЬНАЯ ДАТА ОЦЕНКИ:
Текущая дата: ${a} (${n} год, ${s} месяц).
Все расчеты и оценки должны быть выполнены на эту дату. Используй актуальные рыночные данные на ${n} год. При указании аналогов используй актуальные цены на ${a}. Не используй устаревшие данные из прошлых периодов.

Структура JSON:
{
  "summary": "краткое обоснование оценки",
  "marketValue": 0,
  "collateralValue": 0,
  "recommendedLtv": 0,
  "confidence": "high|medium|low",
  "methodology": "описание применённых подходов",
  "riskFactors": ["..."],
  "recommendedActions": ["..."],
  "assumptions": ["..."],
  "comparables": [
    "описание аналога 1 с URL: https://example.com/analog1",
    {
      "description": "описание аналога 2",
      "url": "https://example.com/analog2",
      "imageUrl": "https://example.com/image2.jpg"
    }
  ]
}

ВАЖНО для comparables:
- Если используешь строки, включай URL прямо в текст (например: "Nissan Teana 2.4 2004, 140тыс.км - 280 000 руб. https://avito.ru/item123")
- Если используешь объекты, указывай description, url (ссылка на источник) и imageUrl (ссылка на изображение аналога, если доступна)
- Старайся находить реальные ссылки на аналоги с сайтов объявлений (Avito, Drom, Циан и т.д.)

Указывай значения в рублях. Если данных недостаточно, делай профессиональные допущения и фиксируй их в assumptions.`;if(e.skills){const d=e.skills,f=[];d.incomeApproach>0&&(f.push(`Доходный подход (приоритет: ${d.incomeApproach}%):`),d.incomeMethods.dcf>50&&f.push(`- Дисконтирование денежных потоков (DCF) - приоритет ${d.incomeMethods.dcf}%`),d.incomeMethods.directCapitalization>50&&f.push(`- Прямая капитализация - приоритет ${d.incomeMethods.directCapitalization}%`),d.incomeMethods.grossRentMultiplier>50&&f.push(`- Множитель валового дохода - приоритет ${d.incomeMethods.grossRentMultiplier}%`)),d.comparativeApproach>0&&(f.push(`Сравнительный подход (приоритет: ${d.comparativeApproach}%):`),d.comparativeMethods.salesComparison>50&&f.push(`- Сравнение продаж - приоритет ${d.comparativeMethods.salesComparison}%`),d.comparativeMethods.marketExtraction>50&&f.push(`- Извлечение из рынка - приоритет ${d.comparativeMethods.marketExtraction}%`)),d.costApproach>0&&(f.push(`Затратный подход (приоритет: ${d.costApproach}%):`),d.costMethods.replacementCost>50&&f.push(`- Стоимость замещения - приоритет ${d.costMethods.replacementCost}%`),d.costMethods.reproductionCost>50&&f.push(`- Стоимость воспроизводства - приоритет ${d.costMethods.reproductionCost}%`),d.costMethods.depreciation>50&&f.push(`- Учет износа - приоритет ${d.costMethods.depreciation}%`)),f.length>0&&(o+=`

Настройки приоритетов методов оценки:
${f.join(`
`)}

Используй указанные методы и приоритеты при расчете оценки.`)}let A=null;const c=3;for(let d=1;d<=c;d++)try{const f=await kc.chat([{role:"user",content:`Оцени объект "${e.objectName}" и верни ТОЛЬКО валидный JSON без дополнительного текста. ОБЯЗАТЕЛЬНО используй все доступные методы оценки (доходный, сравнительный, затратный подходы) и проведи комплексный анализ. Не используй эвристические расчеты.

Данные:
${t.join(`
`)}

Верни ответ в формате чистого JSON, начиная с { и заканчивая }. Без markdown блоков, без пояснений.`}],o+`

ВАЖНО: Всегда используй профессиональные методы оценки (доходный, сравнительный, затратный подходы). Никогда не используй эвристические расчеты. Если данных недостаточно, сделай профессиональные допущения и четко укажи их в assumptions.

КРИТИЧЕСКИ ВАЖНО: Верни ТОЛЬКО JSON объект, без markdown разметки (\`\`\`json), без пояснений до или после JSON. Начни ответ сразу с { и закончи }.`),p=KM(f);if(!p)throw new Error("ИИ не вернул JSON в ответе");const u=HM(p);return Va.addCategoryExperience("appraisal",4),u}catch(f){if(A=f instanceof Error?f:new Error(String(f)),console.error(`Ошибка генерации оценки через AI (попытка ${d}/${c}):`,f),d===c)throw Va.addCategoryExperience("appraisal",1),new Error(`Не удалось получить оценку от ИИ после ${c} попыток. ${A.message}. Пожалуйста, проверьте данные и попробуйте еще раз.`);await new Promise(p=>setTimeout(p,1e3*d))}throw A||new Error("Неизвестная ошибка при генерации оценки")}},wC="ai_appraisal_results",Qg=()=>{try{const e=localStorage.getItem(wC);return e?JSON.parse(e):[]}catch(e){return console.error("Ошибка загрузки AI оценок:",e),[]}},tw=e=>{try{localStorage.setItem(wC,JSON.stringify(e))}catch(t){console.error("Ошибка сохранения AI оценок:",t)}},Ph={getAll(){return Qg()},getByCard(e){return Qg().filter(t=>t.cardId===e)},getLatestByCard(e){const t=Ph.getByCard(e);return t.length===0?null:t.sort((r,a)=>r.createdAt>a.createdAt?-1:1)[0]},add(e){const t=Qg(),r={...e,id:`ai-appraisal-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,createdAt:new Date().toISOString()};return t.push(r),tw(t),r},clear(){tw([])}},qg=[{key:"real_estate",label:"Недвижимое имущество",description:"Здания, помещения, коммерческие объекты, АЗС, склады",keywords:["недвиж","здан","помещ","офис","торгов","склад","азс","сооруж","комплекс","жил","нежил","центр"]},{key:"land",label:"Земельные участки",description:"Земля в собственности или аренде",keywords:["земель","участ","аграр","сельск","пастбищ","кадастр"]},{key:"movable",label:"Движимое имущество",description:"Оборудование, транспорт, спецтехника, ЖД состав",keywords:["движим","оборуд","машин","транспорт","спецтех","подвиж","состав","вагон","автотранспорт","техника","суда","кораб","флот"]},{key:"metals_goods",label:"Товары и материалы",description:"Будущий урожай, товары в обороте, металлы, сырьё",keywords:["урожай","товар","сырь","металл","драгоцен","материал","запас"]},{key:"equity",label:"Доли, акции и ценные бумаги",description:"Доли в УК, акции, паи, ценные бумаги",keywords:["дол","уставн","акци","ценн","па","вексел","облигац","ипотечн","сертификат"]},{key:"rights",label:"Права и требования",description:"Права требования, интеллектуальная собственность, договоры",keywords:["прав","требован","интеллект","собствен","договор","депозит","банк","ип"]}],GM=e=>e.toLowerCase().replace(/[^a-z0-9а-яё]+/gi,"-").replace(/^-+|-+$/g,""),zM=()=>{try{return Sn.getDictionaryByCode("collateral_attributes")||null}catch(e){return console.warn("Не удалось загрузить справочник атрибутов залога для таксономии:",e),null}},VM=()=>{const e=zM();if(!e)return qg.map(n=>({key:n.key,label:n.label,description:n.description,types:[]}));const t=new Map;e.items.forEach(n=>{var c;const s=(c=n.metadata)==null?void 0:c.group;if(!s)return;const o=s.trim();if(!o)return;const A=GM(o);t.has(A)||t.set(A,{key:A,label:o,sourceGroup:o})});const r=[],a=qg.map(n=>({key:n.key,label:n.label,description:n.description,types:[]}));return t.forEach(n=>{const s=n.sourceGroup.toLowerCase(),o=a.find(A=>{var c;return A&&A.key?(c=qg.find(l=>l.key===A.key))==null?void 0:c.keywords.some(l=>s.includes(l)):!1});o?o.types.push(n):r.push(n)}),r.length>0&&a.push({key:"other",label:"Прочие активы и требования",description:"Категории активов из справочников, не вошедшие в основные группы",types:r}),a.forEach(n=>{n.types.sort((s,o)=>s.label.localeCompare(o.label,"ru"))}),a},{Title:$M,Text:Ai}=mt,YM=({card:e})=>{var de,ue,pe,ye,ve,ae,Ke;const t=$s(),[r,a]=K.useState([]),[n,s]=K.useState(!1),[o,A]=K.useState(!1),[c,l]=K.useState(null),[d,f]=K.useState([]),[p,u]=K.useState(!1),[g,h]=K.useState(!1),[y]=ne.useForm(),x=K.useMemo(()=>VM(),[]),v=K.useCallback(async()=>{s(!0);try{const Ee=await Ca.getInspectionsByCardId(e.id);a(Ee)}catch(Ee){console.error("Ошибка загрузки осмотров:",Ee)}finally{s(!1)}},[e.id]);K.useEffect(()=>{v()},[v]),K.useEffect(()=>{f(Ph.getByCard(e.id))},[e.id]);const E=Ee=>{l(Ee),A(!0)},D=()=>{var me,le,He,Ze,$e,et;const Ee=O;y.setFieldsValue({assetGroup:Ee.assetGroup,assetType:Ee.assetType,location:(me=e.address)==null?void 0:me.fullAddress,area:((le=e.characteristics)==null?void 0:le.totalAreaSqm)||((He=e.characteristics)==null?void 0:He.totalArea),areaUnit:"м²",condition:((Ze=e.characteristics)==null?void 0:Ze.STATE)||(($e=e.characteristics)==null?void 0:$e.CONDITION)||((et=e.characteristics)==null?void 0:et.condition),purpose:"Обновление карточки обеспечения",additionalFactors:e.notes}),u(!0)},B=async()=>{var Ee;try{const me=await y.validateFields();h(!0);const le=await _y.generateEstimate({objectName:e.name||me.assetType||"Объект обеспечения",assetGroup:me.assetGroup,assetType:me.assetType,location:me.location||((Ee=e.address)==null?void 0:Ee.fullAddress),area:me.area?Number(me.area):void 0,areaUnit:me.areaUnit,condition:me.condition,incomePerYear:me.incomePerYear?Number(me.incomePerYear):void 0,purpose:me.purpose,additionalFactors:me.additionalFactors,card:e}),He=Ph.add({cardId:e.id,objectId:e.id,objectName:e.name||"Объект обеспечения",estimate:le,input:{objectName:e.name||"Объект обеспечения",assetGroup:me.assetGroup,assetType:me.assetType,location:me.location,area:me.area?Number(me.area):void 0,areaUnit:me.areaUnit,condition:me.condition,incomePerYear:me.incomePerYear?Number(me.incomePerYear):void 0,purpose:me.purpose,additionalFactors:me.additionalFactors,card:e}});f(Ze=>[He,...Ze]),Ne.success("AI оценка сохранена для карточки"),u(!1)}catch(me){if(me!=null&&me.errorFields)return;console.error("Ошибка выполнения AI оценки карточки:",me),Ne.error("Не удалось выполнить оценку ИИ")}finally{h(!1)}},I=Ee=>{switch(Ee){case"editing":return"orange";case"approved":return"green";default:return"default"}},_=Ee=>{switch(Ee){case"editing":return"Редактирование";case"approved":return"Согласовано";default:return Ee}},S=Ee=>{switch(Ee){case"real_estate":return"real_estate";case"movable":return"movable";case"property_rights":return"rights";default:return"real_estate"}},O=K.useMemo(()=>{if(x.length===0)return{assetGroup:void 0,assetType:void 0};const Ee=S(e.mainCategory);let me=x.find(He=>He.key===Ee);me||(me=x[0]);let le=me==null?void 0:me.types.find(He=>{var Ze;return He.label===e.propertyType||He.label===((Ze=e.classification)==null?void 0:Ze.level2)});return!le&&(me!=null&&me.types.length)&&(le=me.types[0]),{assetGroup:me==null?void 0:me.key,assetType:le==null?void 0:le.key}},[e.classification,e.mainCategory,e.propertyType,x]),M=K.useMemo(()=>d.length===0?null:[...d].sort((Ee,me)=>Ee.createdAt>me.createdAt?-1:1)[0],[d]),T=()=>{switch(e.mainCategory){case"real_estate":return i.jsx(ph,{});case"movable":return i.jsx(TT,{});case"property_rights":return i.jsx(Jf,{});default:return i.jsx(ST,{})}},R=()=>{switch(e.mainCategory){case"real_estate":return"Недвижимость";case"movable":return"Движимое имущество";case"property_rights":return"Имущественные права";default:return"Неизвестно"}},L=Ee=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(Ee),N=K.useMemo(()=>e.propertyType?Uh(e.propertyType):[],[e.propertyType]),P=K.useMemo(()=>yC(N),[N]),U=K.useMemo(()=>{var Ee;return(Ee=e.partners)==null?void 0:Ee.find(me=>{var le;return me.role==="owner"||me.role==="pledgor"&&!((le=e.partners)!=null&&le.find(He=>He.role==="owner"))})},[e.partners]),V=K.useMemo(()=>{var Ee;return(Ee=e.partners)==null?void 0:Ee.find(me=>me.role==="pledgor")},[e.partners]),ie=K.useMemo(()=>{if(!e.egrnStatementDate||e.mainCategory!=="real_estate")return!1;const Ee=We(e.egrnStatementDate);return We().diff(Ee,"days")>30},[e.egrnStatementDate,e.mainCategory]),W=()=>{var me,le;const Ee=((me=e.address)==null?void 0:me.cadastralNumber)||((le=e.characteristics)==null?void 0:le.objectCadastralNumber);t(`/egrn?objectId=${e.id}&cadastralNumber=${Ee}&objectName=${encodeURIComponent(e.name||"")}`)},z=()=>{e.contractId?t(`/portfolio?contractId=${e.contractId}`):e.contractNumber?t(`/portfolio?contractNumber=${e.contractNumber}`):e.reference&&t(`/portfolio?reference=${e.reference}`)},G=()=>{e.reference&&window.open(`#/portfolio?reference=${e.reference}`,"_blank")},b=e.propertyType||((de=e.classification)==null?void 0:de.level2)||"",k=K.useMemo(()=>RM(b),[b]),j=K.useMemo(()=>kM(b),[b]),q=Ee=>Ee==null||Ee===""?"—":typeof Ee=="boolean"?Ee?"Да":"Нет":typeof Ee=="number"?String(Ee):typeof Ee=="string"&&Ee.match(/^\d{4}-\d{2}-\d{2}/)?We(Ee).format("DD.MM.YYYY"):String(Ee),Y=[{key:"1",label:"Главная",children:i.jsxs("div",{children:[i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Наименование (NAME_OF_PROPERTY)",span:2,children:e.name||"—"}),i.jsx(we.Item,{label:"Адрес",span:2,children:((ue=e.address)==null?void 0:ue.fullAddress)||"—"}),i.jsx(we.Item,{label:"Заемщик",span:1,children:(U==null?void 0:U.organizationName)||`${(U==null?void 0:U.lastName)||""} ${(U==null?void 0:U.firstName)||""} ${(U==null?void 0:U.middleName)||""}`.trim()||"—"}),i.jsx(we.Item,{label:"ИНН заемщика",span:1,children:(U==null?void 0:U.inn)||"—"}),i.jsx(we.Item,{label:"Залогодатель (OWNER_TIN)",span:1,children:(V==null?void 0:V.organizationName)||`${(V==null?void 0:V.lastName)||""} ${(V==null?void 0:V.firstName)||""} ${(V==null?void 0:V.middleName)||""}`.trim()||"—"}),i.jsx(we.Item,{label:"ИНН залогодателя (OWNER_TIN)",span:1,children:(V==null?void 0:V.inn)||"—"}),e.propertyType&&i.jsx(we.Item,{label:"Тип имущества",span:2,children:e.propertyType})]}),P.characteristics.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Характеристики"}),i.jsx(we,{bordered:!0,column:2,size:"small",children:P.characteristics.map(Ee=>{var le;const me=(le=e.characteristics)==null?void 0:le[Ee.code];return me==null||me===""?null:i.jsx(we.Item,{label:Ee.name,span:Ee.code==="NAME_OF_PROPERTY"?2:1,children:q(me)},Ee.code)})})]})]})},{key:"2",label:"Характеристики",children:i.jsx("div",{children:P.characteristics.length>0?i.jsx(we,{bordered:!0,column:2,size:"small",children:P.characteristics.map(Ee=>{var le;const me=(le=e.characteristics)==null?void 0:le[Ee.code];return me==null||me===""?null:i.jsx(we.Item,{label:Ee.name,children:q(me)},Ee.code)})}):i.jsx(mt.Text,{type:"secondary",children:"Характеристики не указаны"})})},{key:"3",label:"Документы",children:i.jsxs("div",{children:[e.documents&&e.documents.length>0?i.jsx(Ba,{dataSource:e.documents,renderItem:Ee=>i.jsx(Ba.Item,{children:i.jsxs(Fe,{children:[i.jsx(Qr,{}),i.jsx(Ai,{strong:!0,children:Ee.name}),i.jsxs(Ai,{type:"secondary",children:["(",Ee.type,")"]}),Ee.uploadDate&&i.jsxs(Ai,{type:"secondary",children:["- ",new Date(Ee.uploadDate).toLocaleDateString("ru-RU")]})]})})}):i.jsx(mt.Text,{type:"secondary",children:"Документы не загружены"}),i.jsx(jt,{}),i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},children:[i.jsx(Be,{type:"link",icon:i.jsx(eA,{}),onClick:G,style:{paddingLeft:0},children:"Перейти в Залоговое досье"}),j&&i.jsxs("div",{children:[i.jsx(we,{bordered:!0,column:1,size:"small",children:i.jsx(we.Item,{label:"Дата выписки ЕГРН",children:e.egrnStatementDate?We(e.egrnStatementDate).format("DD.MM.YYYY"):"—"})}),ie&&i.jsx(Be,{type:"primary",danger:!0,icon:i.jsx(U1,{}),onClick:W,style:{marginTop:16},children:"Заказать выписку ЕГРН (выписка более 30 дней)"})]})]})]})},{key:"4",label:"Заметки",children:i.jsx("div",{children:i.jsxs(we,{bordered:!0,column:1,size:"small",children:[i.jsx(we.Item,{label:"Комментарии",children:e.notes||"—"}),i.jsx(we.Item,{label:"Отлагательные условия",children:e.suspensiveConditions||"—"})]})})},{key:"5",label:"Оценка",children:i.jsxs("div",{children:[i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(yt,{title:"Рыночная стоимость",value:e.marketValue||0,formatter:Ee=>L(Number(Ee)),valueStyle:{color:"#3f8600"}})}),i.jsx(Te,{span:12,children:i.jsx(yt,{title:"Залоговая стоимость",value:e.pledgeValue||0,formatter:Ee=>L(Number(Ee)),valueStyle:{color:"#1890ff"}})})]}),i.jsx(jt,{}),i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Наличие ликвидного рынка (HAVEL_MARKET)",children:(pe=e.characteristics)!=null&&pe.HAVEL_MARKET?"Да":"Нет"}),i.jsx(we.Item,{label:"Тип обеспечения (TYPE_COLLATERAL)",children:((ye=e.characteristics)==null?void 0:ye.TYPE_COLLATERAL)||"—"}),P.evaluation.map(Ee=>{var le;const me=(le=e.characteristics)==null?void 0:le[Ee.code];return me==null||me===""?null:i.jsx(we.Item,{label:Ee.name,children:q(me)},Ee.code)})]})]})},{key:"6",label:"Договор",children:i.jsxs("div",{children:[i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"REFERENCE сделки",span:2,children:e.reference||"—"}),i.jsx(we.Item,{label:"Номер договора",span:2,children:e.contractNumber||"—"})]}),(e.reference||e.contractNumber)&&i.jsx(Be,{type:"primary",icon:i.jsx(eA,{}),onClick:z,style:{marginTop:16},children:"Перейти к договору в портфеле"})]})},{key:"9",label:i.jsxs(Fe,{children:[i.jsx(MA,{}),"Оценка ИИ"]}),children:i.jsxs("div",{children:[M?i.jsxs(i.Fragment,{children:[i.jsx(Nr,{type:"info",showIcon:!0,message:`Рыночная стоимость: ${L(M.estimate.marketValue)} · Залоговая: ${L(M.estimate.collateralValue)}`,description:i.jsxs("div",{children:[i.jsx(Ai,{strong:!0,children:"Методология:"})," ",M.estimate.methodology,i.jsx("br",{}),i.jsx(Ai,{strong:!0,children:"Уровень уверенности:"})," ",M.estimate.confidence,i.jsx("br",{}),i.jsx(Ai,{strong:!0,children:"Риски:"})," ",M.estimate.riskFactors.join("; ")||"не выявлены",i.jsx("br",{}),i.jsx(Ai,{strong:!0,children:"Рекомендации:"})," ",M.estimate.recommendedActions.join("; ")||"—"]}),style:{marginBottom:16}}),M.estimate.summary&&i.jsxs(mt.Paragraph,{children:[i.jsx(Ai,{strong:!0,children:"Краткие выводы:"})," ",M.estimate.summary]})]}):i.jsx(Br,{description:"Оценка ИИ ещё не выполнялась"}),i.jsx(jt,{}),i.jsx(Fe,{wrap:!0,children:i.jsx(Be,{type:"primary",icon:i.jsx(MA,{}),onClick:D,children:"Запросить новую оценку"})}),d.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{}),i.jsx(Ba,{header:"История AI оценок",dataSource:d,renderItem:Ee=>i.jsx(Ba.Item,{children:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsx(Ai,{strong:!0,children:We(Ee.createdAt).format("DD.MM.YYYY HH:mm")}),i.jsxs(Ai,{children:["Рыночная: ",L(Ee.estimate.marketValue)," · Залоговая:"," ",L(Ee.estimate.collateralValue)]}),i.jsx(Ai,{type:"secondary",children:Ee.estimate.summary})]})})})]})]})},...k?[{key:"7",label:i.jsxs(Fe,{children:[i.jsx(Ko,{}),"Осмотры (",r.length,")"]}),children:i.jsxs("div",{children:[i.jsxs(Fe,{style:{width:"100%",justifyContent:"space-between",marginBottom:16},children:[i.jsx(Ai,{strong:!0,children:"Осмотры объекта"}),i.jsx(Be,{size:"small",icon:i.jsx(MA,{}),onClick:D,children:"Оценка ИИ"})]}),n?i.jsx(Br,{description:"Загрузка осмотров..."}):r.length===0?i.jsx(Br,{description:"Осмотры отсутствуют"}):i.jsx(Ba,{dataSource:r,renderItem:Ee=>i.jsx(Ba.Item,{actions:[i.jsx(Be,{type:"link",onClick:()=>E(Ee.id),children:"Открыть"})],children:i.jsx(Ba.Item.Meta,{title:i.jsxs(Fe,{children:[i.jsx("span",{children:Ee.inspectionType}),i.jsx(at,{color:Ee.status==="approved"?"green":Ee.status==="submitted_for_review"?"purple":Ee.status==="in_progress"?"orange":Ee.status==="needs_revision"?"red":"blue",children:Ee.status==="approved"?"Согласован":Ee.status==="submitted_for_review"?"На проверке":Ee.status==="in_progress"?"В процессе":Ee.status==="needs_revision"?"Требует доработки":Ee.status==="scheduled"?"Запланирован":Ee.status})]}),description:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs(Ai,{type:"secondary",children:["Дата: ",We(Ee.inspectionDate).format("DD.MM.YYYY HH:mm")]}),i.jsxs(Ai,{type:"secondary",children:["Исполнитель: ",Ee.inspectorName,Ee.inspectorType==="client"&&i.jsx(at,{color:"orange",style:{marginLeft:8},children:"Клиент"})]}),Ee.photos&&Ee.photos.length>0&&i.jsxs(Ai,{type:"secondary",children:["Фотографий: ",Ee.photos.length]})]})})})}),i.jsx(jt,{}),i.jsx(Be,{type:"primary",icon:i.jsx(Ko,{}),onClick:()=>t(`/cms-check?cardId=${e.id}`),children:"Создать осмотр"})]})}]:[],...j?[{key:"8",label:i.jsxs(Fe,{children:[i.jsx(Zu,{}),"Выписка ЕГРН"]}),children:i.jsxs("div",{children:[i.jsxs(we,{bordered:!0,column:1,size:"small",children:[i.jsx(we.Item,{label:"Дата выписки ЕГРН",children:e.egrnStatementDate?We(e.egrnStatementDate).format("DD.MM.YYYY"):"—"}),i.jsx(we.Item,{label:"Кадастровый номер",children:((ve=e.address)==null?void 0:ve.cadastralNumber)||((ae=e.characteristics)==null?void 0:ae.objectCadastralNumber)||"—"})]}),i.jsx(jt,{}),i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},children:[ie&&i.jsx(Be,{type:"primary",danger:!0,icon:i.jsx(U1,{}),onClick:W,children:"Заказать выписку ЕГРН (выписка более 30 дней)"}),i.jsx(Be,{type:"default",icon:i.jsx(Zu,{}),onClick:()=>{var me,le;const Ee=((me=e.address)==null?void 0:me.cadastralNumber)||((le=e.characteristics)==null?void 0:le.objectCadastralNumber);t(`/egrn?objectId=${e.id}&cadastralNumber=${Ee}&objectName=${encodeURIComponent(e.name||"")}`)},children:"Перейти в модуль ЕГРН"})]})]})}]:[]];return i.jsxs("div",{className:"collateral-card-view",children:[i.jsx(Ge,{className:"card-header-section",children:i.jsx(ft,{gutter:[16,16],align:"middle",children:i.jsx(Te,{flex:"auto",children:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs(Fe,{children:[T(),i.jsx($M,{level:3,style:{margin:0},children:e.name})]}),i.jsxs(Fe,{children:[i.jsx(at,{color:"blue",children:e.number}),i.jsx(at,{color:I(e.status),children:_(e.status)}),i.jsx(at,{children:R()}),e.propertyType&&i.jsx(at,{color:"purple",children:e.propertyType})]})]})})})}),i.jsx(Ge,{style:{marginTop:16},children:i.jsx(Ts,{items:Y,defaultActiveKey:"1"})}),i.jsx(vC,{visible:o,inspectionId:c,onClose:()=>{A(!1),l(null),v()},onApprove:async Ee=>{await Ca.approveInspection(Ee,"Система"),v()},onRequestRevision:async(Ee,me)=>{await Ca.requestRevision(Ee,"Система",me),v()}}),i.jsx(dr,{title:"AI-оценка объекта",open:p,onOk:B,onCancel:()=>u(!1),confirmLoading:g,okText:"Запросить оценку",cancelText:"Отмена",children:i.jsxs(ne,{layout:"vertical",form:y,children:[i.jsx(ne.Item,{label:"Категория",name:"assetGroup",rules:[{required:!0,message:"Выберите категорию"}],children:i.jsx(Ye,{options:x.map(Ee=>({label:Ee.label,value:Ee.key})),onChange:()=>y.setFieldsValue({assetType:void 0})})}),i.jsx(ne.Item,{label:"Тип актива",name:"assetType",dependencies:["assetGroup"],rules:[{required:!0,message:"Выберите тип актива"}],children:i.jsx(Ye,{placeholder:"Выберите тип",options:((Ke=x.find(Ee=>Ee.key===y.getFieldValue("assetGroup")))==null?void 0:Ke.types.map(Ee=>({label:Ee.label,value:Ee.key})))||[]})}),i.jsx(ne.Item,{label:"Локация",name:"location",children:i.jsx(Re,{placeholder:"Адрес или регион"})}),i.jsx(ne.Item,{label:"Площадь / объем",name:"area",children:i.jsx(fa,{style:{width:"100%"},min:0,placeholder:"Например, 1200"})}),i.jsx(ne.Item,{label:"Единица измерения",name:"areaUnit",initialValue:"м²",children:i.jsx(Re,{placeholder:"м², га, шт."})}),i.jsx(ne.Item,{label:"Состояние",name:"condition",children:i.jsx(Re,{placeholder:"Например, требует ремонта"})}),i.jsx(ne.Item,{label:"Чистый доход (₽/год)",name:"incomePerYear",children:i.jsx(fa,{style:{width:"100%"},min:0})}),i.jsx(ne.Item,{label:"Цель оценки",name:"purpose",children:i.jsx(Re,{placeholder:"Например, актуализация стоимости"})}),i.jsx(ne.Item,{label:"Дополнительные факторы",name:"additionalFactors",children:i.jsx(Re.TextArea,{rows:3,placeholder:"Обременения, особенности участка, условия эксплуатации..."})})]})})]})},WM=({data:e,loading:t,onEdit:r,onView:a,onDelete:n,onDoubleClick:s})=>{const o=e,A=[{title:"№",dataIndex:"number",key:"number",width:100,fixed:"left",sorter:(c,l)=>c.number.localeCompare(l.number)},{title:"Наименование",dataIndex:"name",key:"name",width:250,sorter:(c,l)=>c.name.localeCompare(l.name),render:(c,l)=>i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:500},children:c}),i.jsx("div",{style:{fontSize:12,color:"var(--ant-color-text-secondary)"},children:l.classification.level1})]})},{title:"Тип",dataIndex:"mainCategory",key:"mainCategory",width:120,filters:[{text:"Недвижимость",value:"real_estate"},{text:"Движимое имущество",value:"movable"},{text:"Имущественные права",value:"property_rights"}],onFilter:(c,l)=>l.mainCategory===c,render:c=>{const d={real_estate:{color:"blue",text:"Недвижимость"},movable:{color:"green",text:"Движимое"},property_rights:{color:"orange",text:"Имущественные права"}}[c]||{color:"default",text:c||"Не указано"};return i.jsx(at,{color:d.color,children:d.text})}},{title:"Статус",dataIndex:"status",key:"status",width:120,filters:[{text:"Редактирование",value:"editing"},{text:"Согласовано",value:"approved"},{text:"Архив",value:"archived"}],onFilter:(c,l)=>l.status===c,render:c=>{const d={editing:{color:"orange",text:"Редактирование"},approved:{color:"green",text:"Согласовано"},archived:{color:"default",text:"Архив"}}[c]||{color:"default",text:c||"Не указано"};return i.jsx(at,{color:d.color,children:d.text})}},{title:"Адрес",dataIndex:"addresses",key:"address",width:300,render:c=>{var l;return i.jsx("div",{children:((l=c==null?void 0:c[0])==null?void 0:l.fullAddress)||"Не указан"})}},{title:"Дата создания",dataIndex:"createdAt",key:"createdAt",width:120,sorter:(c,l)=>new Date(c.createdAt).getTime()-new Date(l.createdAt).getTime(),render:c=>new Date(c).toLocaleDateString("ru-RU")},{title:"Действия",key:"actions",width:120,fixed:"right",render:(c,l)=>i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx(Xr,{title:"Просмотр",children:i.jsx(Be,{type:"text",icon:i.jsx(Ss,{}),size:"small",onClick:()=>a(l.id)})}),i.jsx(Xr,{title:"Редактировать",children:i.jsx(Be,{type:"text",icon:i.jsx(Ri,{}),size:"small",onClick:()=>r(l.id)})}),i.jsx(Xr,{title:"Удалить",children:i.jsx(Be,{type:"text",icon:i.jsx(Bs,{}),size:"small",danger:!0,onClick:()=>n(l.id)})})]})}];return i.jsx("div",{className:"registry-table-container",children:i.jsx(nr,{columns:A,dataSource:o,loading:t,rowKey:"id",scroll:{x:1200},pagination:{pageSize:30,showSizeChanger:!0,showQuickJumper:!0,showTotal:(c,l)=>`Показано ${l[0]}-${l[1]} из ${c} записей`,pageSizeOptions:["15","30","50","100"]},onRow:c=>({onDoubleClick:()=>s(c),style:{cursor:"pointer"}}),size:"middle",className:"registry-table"})})},Ea=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,zi=e=>e[Math.floor(Math.random()*e.length)],XM=["КБ","СРБ","МСБ","КК"],JM=["СВХ","КК","МСБ","КБ"],ZM=["Кредитная линия. Единый продукт.","Кредит на пополнение оборотных средств","Инвестиционный кредит","Овердрафт"],rw=['ООО "Рога и Копыта"','ООО "Вектор"','ООО "Альфа"','ООО "Бета"','ООО "Гамма"','ООО "Дельта"','ООО "Омега"','ООО "Сигма"','ООО "Тета"','ООО "Фи"','ООО "ЭНЕРГИЯ-Плюс"','ООО "Ромашка"','ООО "Протуберанец"','ООО "Сибирь-Холод"'],eP=["договор залога недвижимого имущества","договор залога движимого имущества/оборудования","договор залога транспортных средств","договор залога товаров в обороте","договор залога ценных бумаг","договор залога имущественных прав"],tP=["Основное","Дополнительное","Формальное"],rP=["Первичный","последующий"],aP=["Высокая","Средняя","Малоудовлетворительная","Низкая"],nP=["физический","документарный","комбинированный"],aw=()=>Ea(1e9,9999999999),Lo=e=>{const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return`${t}.${r}.${a}`},EC=e=>{const t=e.toLowerCase();return t.includes("недвижимость")||t.includes("здание")||t.includes("помещение")||t.includes("квартира")?"договор залога недвижимого имущества":t.includes("транспорт")||t.includes("автомобиль")||t.includes("машина")?"договор залога транспортных средств":t.includes("оборудование")||t.includes("машина")||t.includes("станок")?"договор залога движимого имущества/оборудования":t.includes("товар")||t.includes("продукт")?"договор залога товаров в обороте":t.includes("ценная бумага")||t.includes("акция")||t.includes("облигация")?"договор залога ценных бумаг":t.includes("право")||t.includes("требование")?"договор залога имущественных прав":zi(eP)},iP=(e,t,r,a,n,s)=>{const o=2e7+t,A=2023+t%2,c=Ea(1,12),l=Ea(1,28),d=new Date(A,c-1,l),f=d,p=new Date(d);p.setFullYear(p.getFullYear()+Ea(1,3));const u=`${Ea(100,999)}.${Ea(100,999)}/${A%100}-${Ea(1,9)}`,g=`${u}-З`,h=Ea(1e6,5e7),y=Math.floor(h*(.3+Math.random()*.5)),x=Math.ceil(y/.8),v=Math.ceil(y/.7),E=Ea(Math.max(x,5e5),Math.max(v,h)),D=Math.floor(E*.75),B=new Date(d);B.setDate(B.getDate()+Ea(1,30));const I=new Date;I.setDate(I.getDate()-Ea(0,180));const _=new Date(I);return _.setMonth(_.getMonth()+Ea(3,12)),{segment:zi(XM),group:zi(JM),reference:o,pledger:n,inn:s,borrower:r,contractNumber:u,contractDate:Lo(d),type:zi(ZM),openDate:Lo(f),closeDate:Lo(p),debtRub:y,limitRub:h,overduePrincipal:Math.random()>.8?Ea(0,Math.floor(y*.1)):0,overdueInterest:Math.random()>.9?Ea(0,Math.floor(y*.05)):0,collateralReference:5e8+t,collateralContractNumber:g,collateralContractDate:Lo(B),collateralCategory:EC(e),collateralValue:D,marketValue:E,initialValuationDate:Lo(B),currentMarketValue:E+Ea(-1e5,1e5),currentValuationDate:Lo(new Date(B.getTime()+Ea(30,365)*24*60*60*1e3)),fairValue:Math.random()>.5?String(E+Ea(-5e4,5e4)):"-",collateralType:zi(tP),collateralPurpose:`залог ${e.toLowerCase()}`,collateralInfo:`${e} (${Ea(1,10)} ед.)`,collateralLocation:`г. ${zi(["Москва","Санкт-Петербург","Краснодар","Екатеринбург","Ростов-на-Дону"])}, ул. ${zi(["Ленина","Пушкина","Гагарина","Мира","Советская"])}, ${Ea(1,200)}`,liquidity:zi(aP),qualityCategory:Math.random()>.7?zi(["I","II","III"]):"-",registrationDate:Math.random()>.5?Lo(new Date(d.getTime()+Ea(1,30)*24*60*60*1e3)):"-",priority:zi(rP),monitoringType:zi(nP),lastMonitoringDate:Lo(I),nextMonitoringDate:Lo(_),owner:null,account9131:`9131281${String(Ea(1e9,9999999999)).padStart(10,"0")}`}},sP=()=>{const e=Ey(),t=[];let r=1;const a=new Map;return e.forEach(n=>{const s=Ea(5,10);for(let o=0;o<s;o++){const A=`${n}-${Math.floor(o/5)}`;let c,l,d,f;if(a.has(A)){const u=a.get(A);c=u.borrower,l=u.borrowerInn,d=u.pledger,f=u.pledgerInn}else c=zi(rw),l=aw(),d=zi(rw.filter(u=>u!==c)),f=aw(),a.set(A,{borrower:c,borrowerInn:l,pledger:d,pledgerInn:f});const p=iP(n,r,c,l,d,f);t.push(p),r++}}),t},oP=(e,t)=>{const r=EC(t);return e.filter(a=>{var n;return a.collateralCategory===r||((n=a.collateralPurpose)==null?void 0:n.toLowerCase().includes(t.toLowerCase()))})},Kg={"Легковой автомобиль":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.","Грузовой автомобиль":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Автобус:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Мотоцикл:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Трактор:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Спецтехника:"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.","Транспортные средства":"Наземные безрельсовые механические транспортные средства, прицепы, и т.д.",Квартира:"Недвижимое имущество",Дом:"Недвижимое имущество",Здание:"Недвижимое имущество",Помещение:"Недвижимое имущество","Земельный участок":"Недвижимое имущество","Недвижимое имущество":"Недвижимое имущество",Оборудование:"Оборудование",Станки:"Оборудование","Производственное оборудование":"Оборудование","Товары в обороте":"Товары в обороте",Товары:"Товары в обороте","Ценные бумаги":"Ценные бумаги",Акции:"Ценные бумаги",Облигации:"Ценные бумаги","Имущественные права":"Имущественные права","Права требования":"Имущественные права","Будущий урожай":"Будущий урожай","Денежные средства":"Денежные средства","Драгоценные металлы":"Драгоценные металлы"},AP=e=>{if(Kg[e])return Kg[e];for(const[t,r]of Object.entries(Kg))if(e.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(e.toLowerCase()))return r;return e},Da=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,HA=e=>e[Math.floor(Math.random()*e.length)],cP=['ООО "Рога и Копыта"','ООО "Вектор"','ООО "Альфа"','ООО "Бета"','ООО "Гамма"','ООО "Дельта"','ООО "Омега"','ООО "Сигма"','ООО "Тета"','ООО "Фи"'],lP=["Иванов","Петров","Сидоров","Смирнов","Кузнецов","Попов","Соколов","Лебедев","Козлов","Новиков"],dP=["Иван","Петр","Сергей","Александр","Дмитрий","Андрей","Михаил","Николай","Владимир","Алексей"],uP=["Иванович","Петрович","Сергеевич","Александрович","Дмитриевич","Андреевич","Михайлович","Николаевич","Владимирович","Алексеевич"],fP=["Московская область","Ленинградская область","Краснодарский край","Свердловская область","Ростовская область"],pP=["Москва","Санкт-Петербург","Краснодар","Екатеринбург","Ростов-на-Дону"],Vf=(e=!0)=>e?`${Da(1e9,9999999999)}`:`${Da(1e11,999999999999)}`,_C=()=>{const e=HA(fP),t=HA(pP),r=`ул. ${HA(["Ленина","Пушкина","Гагарина","Мира","Советская"])}`,a=Da(1,200).toString(),n=Da(1,10)>5?Da(1,5).toString():void 0,s=Da(1,200).toString();return{id:Vs(),region:e,city:t,street:r,house:a,building:n,apartment:s,postalCode:`${Da(1e5,999999)}`,fullAddress:`${e}, ${t}, ${r}, д. ${a}${n?`, к. ${n}`:""}, кв. ${s}`}},nw=(e,t=!1)=>{if(t){const r=HA(lP),a=HA(dP),n=HA(uP);return{id:Vs(),type:"individual",role:e,lastName:r,firstName:a,middleName:n,inn:Vf(!1),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}}else return{id:Vs(),type:"legal",role:e,organizationName:HA(cP),inn:Vf(!0),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}},hP=(e,t)=>{switch(e.type){case"number":return e.code==="QUANTITY"||e.code.includes("COUNT")?Da(1,100):e.code==="WEIGHT"?Da(100,1e4):e.code.includes("SUM")||e.code.includes("VALUE")||e.code.includes("AMOUNT")?Da(1e5,1e7):Da(1,1e3);case"boolean":return Math.random()>.5;case"date":{const r=new Date;return r.setDate(r.getDate()-Da(0,365)),r.toISOString().split("T")[0]}case"string":default:return e.code==="OWNER_TIN"?Vf(Math.random()>.5):e.code==="NAME_OF_PROPERTY"?`Объект ${e.group} #${t+1}`:e.code==="ADDRESS_BASE"?_C().fullAddress:e.code.includes("NUMBER")||e.code.includes("CODE")?`${Da(1e5,999999)}`:`Значение ${e.name} #${t+1}`}},mP=(e,t,r)=>{const a=AP(e),n=a?Uh(a):[],s=n.length===0?Uh(e):[],o=n.length>0?n:s,A={};return o.forEach(c=>{A[c.code]=hP(c,t)}),r&&(r.reference&&(A.CONTRACT_REFERENCE=String(r.reference)),r.contractNumber&&(A.CONTRACT_NUMBER=r.contractNumber),r.contractDate&&(A.CONTRACT_DATE=r.contractDate),r.collateralContractNumber&&(A.COLLATERAL_CONTRACT_NUMBER=r.collateralContractNumber),r.collateralContractDate&&(A.COLLATERAL_CONTRACT_DATE=r.collateralContractDate),r.limitRub&&(A.CREDIT_LIMIT=typeof r.limitRub=="number"?r.limitRub:parseFloat(String(r.limitRub))),r.debtRub&&(A.CURRENT_DEBT=typeof r.debtRub=="number"?r.debtRub:parseFloat(String(r.debtRub))),r.currentMarketValue&&(A.MARKET_VALUE=typeof r.currentMarketValue=="number"?r.currentMarketValue:parseFloat(String(r.currentMarketValue))),r.collateralValue&&(A.COLLATERAL_VALUE=typeof r.collateralValue=="number"?r.collateralValue:parseFloat(String(r.collateralValue))),r.collateralCategory&&(A.COLLATERAL_CATEGORY=r.collateralCategory),r.collateralType&&(A.COLLATERAL_TYPE=r.collateralType),r.collateralPurpose&&(A.COLLATERAL_PURPOSE=r.collateralPurpose),r.collateralInfo&&(A.COLLATERAL_INFO=r.collateralInfo),r.collateralLocation&&(A.COLLATERAL_LOCATION=r.collateralLocation),r.liquidity&&(A.LIQUIDITY=r.liquidity),r.priority&&(A.PRIORITY=r.priority),r.monitoringType&&(A.MONITORING_TYPE=r.monitoringType),r.lastMonitoringDate&&(A.LAST_MONITORING_DATE=r.lastMonitoringDate),r.nextMonitoringDate&&(A.NEXT_MONITORING_DATE=r.nextMonitoringDate),r.initialValuationDate&&(A.INITIAL_VALUATION_DATE=r.initialValuationDate),r.currentValuationDate&&(A.CURRENT_VALUATION_DATE=r.currentValuationDate),r.borrower&&(A.BORROWER_NAME=r.borrower),r.pledger&&(A.PLEDGER_NAME=r.pledger),r.inn&&(A.BORROWER_INN=String(r.inn),A.PLEDGER_INN=String(r.inn))),A},gP=(e,t=50,r)=>{const a=[],n=oP(r,e);let s="property_rights";e.includes("недвижимость")||e.includes("здание")||e.includes("помещение")?s="real_estate":(e.includes("транспорт")||e.includes("автомобиль")||e.includes("оборудование"))&&(s="movable");const o=()=>s==="real_estate"?{level0:"Жилая недвижимость",level1:"Квартира",level2:"Помещение"}:s==="movable"?{level0:"Движимое имущество",level1:"Легковой автомобиль",level2:"Помещение"}:{level0:"Имущественные права",level1:"Права требования",level2:"Помещение"};for(let A=0;A<t;A++){let c;if(n.length>0){const M=A%n.length;c=n[M]}let l,d;c?(l={id:Vs(),type:"legal",role:"owner",organizationName:c.borrower||'ООО "Заемщик"',inn:String(c.inn||Vf(!0)),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date},d={id:Vs(),type:"legal",role:"pledgor",organizationName:c.pledger||'ООО "Залогодатель"',inn:String(c.inn||Vf(!0)),share:100,showInRegistry:!0,createdAt:new Date,updatedAt:new Date}):(l=nw("owner",Math.random()>.5),d=nw("pledgor",Math.random()>.5));const f=_C(),p=mP(e,A,c);p.NAME_OF_PROPERTY||(p.NAME_OF_PROPERTY=`${e} #${A+1}`),p.OWNER_TIN||(p.OWNER_TIN=d.inn),c&&p.BORROWER_NAME&&(l.organizationName=p.BORROWER_NAME),c&&p.PLEDGER_NAME&&(d.organizationName=p.PLEDGER_NAME),c&&p.BORROWER_INN&&(l.inn=p.BORROWER_INN),c&&p.PLEDGER_INN&&(d.inn=p.PLEDGER_INN);let u;c!=null&&c.currentMarketValue?u=typeof c.currentMarketValue=="number"?c.currentMarketValue:parseInt(String(c.currentMarketValue)):c!=null&&c.marketValue?u=typeof c.marketValue=="number"?c.marketValue:parseInt(String(c.marketValue)):p.marketValue?u=typeof p.marketValue=="number"?p.marketValue:parseInt(String(p.marketValue)):u=Da(1e6,1e7);const g=Math.floor(u*.75),h=new Date,y=new Date(h);y.setDate(y.getDate()-Da(30,365));const x=s==="real_estate"?12:6,v=new Date(y);v.setMonth(v.getMonth()+x),Math.floor((v.getTime()-h.getTime())/(1e3*60*60*24))>60&&v.setDate(h.getDate()+Da(1,60));const D=new Date(h);D.setDate(D.getDate()-Da(0,180));let B=12;s==="movable"?B=6:(e.includes("товар")||e.includes("сырье"))&&(B=3);const I=new Date(D);I.setMonth(I.getMonth()+B),Math.floor((I.getTime()-h.getTime())/(1e3*60*60*24))>60&&I.setDate(h.getDate()+Da(1,60));const S=M=>{const T=String(M.getDate()).padStart(2,"0"),R=String(M.getMonth()+1).padStart(2,"0"),L=M.getFullYear();return`${T}.${R}.${L}`},O={id:Vs(),number:`КО-2024-${String(A+1).padStart(4,"0")}`,name:p.NAME_OF_PROPERTY||`${e} #${A+1}`,mainCategory:s,classification:o(),cbCode:s==="real_estate"?2010:s==="movable"?3010:4010,status:HA(["editing","approved"]),partners:[l,d],address:f,characteristics:p,documents:[],propertyType:e,marketValue:u,pledgeValue:g,evaluationDate:S(y),lastEvaluationDate:S(y),nextEvaluationDate:S(v),monitoringDate:S(D),nextMonitoringDate:S(I),monitoringFrequencyMonths:B,reference:c!=null&&c.reference?String(c.reference):`REF-${Da(1e4,99999)}`,contractNumber:(c==null?void 0:c.contractNumber)||`ДОГ-${Da(1e3,9999)}/${Da(2020,2024)}`,contractId:(c==null?void 0:c.contractNumber)||void 0,createdAt:new Date(2024,0,1+A),updatedAt:new Date(2024,0,1+A)};a.push(O)}return a},xP=async()=>{const e=Ey(),t=[];let r=1,a=[];try{const n="./",s=new URL(n,window.location.origin),o=s.pathname.endsWith("/")?s.pathname:`${s.pathname}/`,A=`${s.origin}${o}portfolioData.json?v=${Date.now()}`,c=await fetch(A,{cache:"no-store"});c.ok&&(a=await c.json())}catch(n){console.warn("Не удалось загрузить договоры из portfolioData.json, используем сгенерированные",n)}return a.length===0&&(a=sP()),e.forEach(n=>{const s=gP(n,50,a);s.forEach(o=>{o.number=`КО-2024-${String(r).padStart(4,"0")}`,r++}),t.push(...s)}),t},bC=.75,yP=.7,vP=e=>{let t=e.marketValue||0;(!t||t<=0)&&(t=1e6);const r=Math.floor(t*bC);return{...e,marketValue:t,pledgeValue:r}},wP=e=>{const t=typeof e.debtRub=="number"?e.debtRub:parseFloat(String(e.debtRub||0));let r=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0));if((!r||r<=0)&&(r=1e6),t>0&&r>0&&t/r<yP){const s=Math.ceil(t/.8),o=Math.ceil(t/.7);r<s&&(r=s),r>o&&(r=o)}const a=Math.floor(r*bC);return{...e,marketValue:r,collateralValue:a,currentMarketValue:r}},EP=e=>e.map(t=>wP(t)),_P=()=>{const e=Hd(),t=$s(),r=uc(),{filteredItems:a,loading:n}=Cf(U=>U.extendedCards),[s,o]=K.useState(!1),[A,c]=K.useState(null),[l,d]=K.useState(null),[f,p]=K.useState(!1),[u,g]=K.useState(!1),[h,y]=K.useState([]),[x,v]=K.useState(!0),[E,D]=K.useState([]),B=async()=>{try{e(Sv(!0));const U=await Yt.getExtendedCards();e(P1(U))}catch(U){Ne.error("Ошибка загрузки данных"),console.error(U)}finally{e(Sv(!1))}};K.useEffect(()=>{B()},[]),K.useEffect(()=>{if(a.length>0){const V=new URLSearchParams(r.search).get("objectId");if(V){const ie=a.find(W=>W.id===V);ie&&(d(ie),p(!0),window.history.replaceState({},"",r.pathname))}}},[a,r.search,r.pathname]),K.useEffect(()=>{(async()=>{try{const V="./",ie=new URL(V,window.location.origin),W=ie.pathname.endsWith("/")?ie.pathname:`${ie.pathname}/`,z=`${ie.origin}${W}collateralDossier.json?v=${Date.now()}`,G=await fetch(z,{cache:"no-store"});if(!G.ok)throw new Error(`Failed to load dossier (${G.status})`);const b=await G.json();y(b.documents)}catch(V){console.warn("Не удалось загрузить данные залогового досье",V)}finally{v(!1)}})()},[]);const I=U=>{const V=a.find(ie=>ie.id===U);V&&(c(V),o(!0))},_=async U=>{try{await Yt.deleteExtendedCard(U),e(NO(U)),Ne.success("Карточка удалена")}catch(V){Ne.error("Ошибка удаления карточки"),console.error(V)}},S=U=>{const V=a.find(ie=>ie.id===U);V&&(d(V),p(!0))},O=U=>{S(U.id)},M=()=>{p(!1),d(null)},T=()=>{if(!l)return;const U=String(l.number??l.id??""),V=h.filter(ie=>String(ie.reference)===U);D(V),g(!0)},R=a.map(U=>({id:U.id,number:U.number,name:U.name,mainCategory:U.mainCategory,status:U.status,classification:U.classification,addresses:U.address?[{fullAddress:U.address.fullAddress}]:[],owner:U.owner,characteristics:U.characteristics,createdAt:U.createdAt,updatedAt:U.updatedAt})),L=async U=>{try{await Yt.saveExtendedCard(U),A?(e(IO(U)),Ne.success("Карточка обновлена")):(e(OO(U)),Ne.success("Карточка создана")),o(!1),c(null)}catch(V){Ne.error("Ошибка сохранения карточки"),console.error(V)}},N=()=>{c(null),o(!0)},P=async()=>{try{Ne.loading({content:"Генерация демо-карточек...",key:"generating",duration:0});const U=await xP();let V=0,ie=0;for(const W of U)try{const z=vP(W);await Yt.saveExtendedCard(z),V++}catch(z){ie++,console.error(`Ошибка создания карточки ${W.number}:`,z)}await B(),Ne.destroy("generating"),Ne.success(`Создано ${V} демо-карточек${ie>0?`, ошибок: ${ie}`:""}`)}catch(U){Ne.destroy("generating"),Ne.error("Ошибка генерации демо-данных"),console.error(U)}};return i.jsxs("div",{children:[i.jsxs(Fe,{style:{marginBottom:16},wrap:!0,children:[i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:N,children:"Создать карточку"}),i.jsx(fo,{title:"Генерация демо-данных",description:"Создать 50 карточек на каждый тип имущества из справочника? Это может занять некоторое время.",onConfirm:P,okText:"Да",cancelText:"Нет",children:i.jsx(Be,{icon:i.jsx(JA,{}),children:"Создать демо-данные (50 карточек на каждый тип)"})})]}),i.jsx(WM,{data:R,loading:n,onEdit:I,onView:S,onDelete:_,onDoubleClick:O}),i.jsx(dr,{title:A?"Редактирование карточки":"Создание карточки",open:s,onCancel:()=>{o(!1),c(null)},footer:null,width:"100%",style:{top:0,maxWidth:"none",padding:0},styles:{body:{height:"calc(100vh - 110px)",overflowY:"auto"}},destroyOnClose:!0,centered:!0,children:i.jsx(hM,{initialValues:A||void 0,onSubmit:L,onCancel:()=>{o(!1),c(null)}})}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx("span",{children:"Карточка объекта"}),l&&i.jsxs(mt.Text,{type:"secondary",style:{fontSize:"14px",fontWeight:"normal"},children:["ID: ",l.id]})]}),open:f,onCancel:M,footer:[(l==null?void 0:l.reference)&&i.jsx(Be,{icon:i.jsx(eA,{}),onClick:()=>{t(`/portfolio?q=${l.reference}`),M()},children:"Перейти в портфель"},"portfolio"),i.jsx(Be,{type:"primary",onClick:T,disabled:!l,children:"Залоговое досье"},"dossier"),i.jsx(Be,{onClick:M,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},destroyOnClose:!0,children:l&&i.jsx(YM,{card:l})}),i.jsx(dr,{title:"Залоговое досье по договору",open:u,onCancel:()=>g(!1),footer:[i.jsx(Be,{type:"primary",onClick:()=>g(!1),children:"Закрыть"},"close")],width:720,children:x?i.jsx(Br,{description:"Загрузка документов..."}):E.length===0?i.jsx(Br,{description:"По данному договору нет документов"}):i.jsx(Ba,{dataSource:E,renderItem:U=>i.jsxs(Ba.Item,{children:[i.jsx(Ba.Item.Meta,{title:i.jsxs(Fe,{children:[i.jsx(at,{color:U.statusColor||"blue",children:U.status}),i.jsx("span",{children:U.docType})]}),description:i.jsxs(mt.Text,{type:"secondary",children:[U.folderPath.join(" / ")," · ",U.lastUpdated]})}),i.jsxs("div",{children:[i.jsx("div",{children:U.fileName}),i.jsx(mt.Text,{type:"secondary",children:U.responsible})]})]})})})]})};var Yn=Uint8Array,Ji=Uint16Array,by=Int32Array,Bm=new Yn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Sm=new Yn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Cx=new Yn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),CC=function(e,t){for(var r=new Ji(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new by(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},BC=CC(Bm,2),SC=BC.b,Bx=BC.r;SC[28]=258,Bx[258]=28;var TC=CC(Sm,0),bP=TC.b,iw=TC.r,Sx=new Ji(32768);for(var sa=0;sa<32768;++sa){var BA=(sa&43690)>>1|(sa&21845)<<1;BA=(BA&52428)>>2|(BA&13107)<<2,BA=(BA&61680)>>4|(BA&3855)<<4,Sx[sa]=((BA&65280)>>8|(BA&255)<<8)>>1}var ho=function(e,t,r){for(var a=e.length,n=0,s=new Ji(t);n<a;++n)e[n]&&++s[e[n]-1];var o=new Ji(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;var A;if(r){A=new Ji(1<<t);var c=15-t;for(n=0;n<a;++n)if(e[n])for(var l=n<<4|e[n],d=t-e[n],f=o[e[n]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)A[Sx[f]>>c]=l}else for(A=new Ji(a),n=0;n<a;++n)e[n]&&(A[n]=Sx[o[e[n]-1]++]>>15-e[n]);return A},cc=new Yn(288);for(var sa=0;sa<144;++sa)cc[sa]=8;for(var sa=144;sa<256;++sa)cc[sa]=9;for(var sa=256;sa<280;++sa)cc[sa]=7;for(var sa=280;sa<288;++sa)cc[sa]=8;var $f=new Yn(32);for(var sa=0;sa<32;++sa)$f[sa]=5;var CP=ho(cc,9,0),BP=ho(cc,9,1),SP=ho($f,5,0),TP=ho($f,5,1),Hg=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Us=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},Gg=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Cy=function(e){return(e+7)/8|0},OC=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Yn(e.subarray(t,r))},OP=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qs=function(e,t,r){var a=new Error(t||OP[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,qs),!r)throw a;return a},IP=function(e,t,r,a){var n=e.length,s=0;if(!n||t.f&&!t.l)return r||new Yn(0);var o=!r,A=o||t.i!=2,c=t.i;o&&(r=new Yn(n*3));var l=function(ve){var ae=r.length;if(ve>ae){var Ke=new Yn(Math.max(ae*2,ve));Ke.set(r),r=Ke}},d=t.f||0,f=t.p||0,p=t.b||0,u=t.l,g=t.d,h=t.m,y=t.n,x=n*8;do{if(!u){d=Us(e,f,1);var v=Us(e,f+1,3);if(f+=3,v)if(v==1)u=BP,g=TP,h=9,y=5;else if(v==2){var I=Us(e,f,31)+257,_=Us(e,f+10,15)+4,S=I+Us(e,f+5,31)+1;f+=14;for(var O=new Yn(S),M=new Yn(19),T=0;T<_;++T)M[Cx[T]]=Us(e,f+T*3,7);f+=_*3;for(var R=Hg(M),L=(1<<R)-1,N=ho(M,R,1),T=0;T<S;){var P=N[Us(e,f,L)];f+=P&15;var E=P>>4;if(E<16)O[T++]=E;else{var U=0,V=0;for(E==16?(V=3+Us(e,f,3),f+=2,U=O[T-1]):E==17?(V=3+Us(e,f,7),f+=3):E==18&&(V=11+Us(e,f,127),f+=7);V--;)O[T++]=U}}var ie=O.subarray(0,I),W=O.subarray(I);h=Hg(ie),y=Hg(W),u=ho(ie,h,1),g=ho(W,y,1)}else qs(1);else{var E=Cy(f)+4,D=e[E-4]|e[E-3]<<8,B=E+D;if(B>n){c&&qs(0);break}A&&l(p+D),r.set(e.subarray(E,B),p),t.b=p+=D,t.p=f=B*8,t.f=d;continue}if(f>x){c&&qs(0);break}}A&&l(p+131072);for(var z=(1<<h)-1,G=(1<<y)-1,b=f;;b=f){var U=u[Gg(e,f)&z],k=U>>4;if(f+=U&15,f>x){c&&qs(0);break}if(U||qs(2),k<256)r[p++]=k;else if(k==256){b=f,u=null;break}else{var j=k-254;if(k>264){var T=k-257,q=Bm[T];j=Us(e,f,(1<<q)-1)+SC[T],f+=q}var Y=g[Gg(e,f)&G],de=Y>>4;Y||qs(3),f+=Y&15;var W=bP[de];if(de>3){var q=Sm[de];W+=Gg(e,f)&(1<<q)-1,f+=q}if(f>x){c&&qs(0);break}A&&l(p+131072);var ue=p+j;if(p<W){var pe=s-W,ye=Math.min(W,ue);for(pe+p<0&&qs(3);p<ye;++p)r[p]=a[pe+p]}for(;p<ue;++p)r[p]=r[p-W]}}t.l=u,t.p=b,t.b=p,t.f=d,u&&(d=1,t.m=h,t.d=g,t.n=y)}while(!d);return p!=r.length&&o?OC(r,0,p):r.subarray(0,p)},Uo=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Tu=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},zg=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:NC,l:0};if(n==1){var o=new Yn(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(B,I){return B.f-I.f}),r.push({s:-1,f:25001});var A=r[0],c=r[1],l=0,d=1,f=2;for(r[0]={s:-1,f:A.f+c.f,l:A,r:c};d!=n-1;)A=r[r[l].f<r[f].f?l++:f++],c=r[l!=d&&r[l].f<r[f].f?l++:f++],r[d++]={s:-1,f:A.f+c.f,l:A,r:c};for(var p=s[0].s,a=1;a<n;++a)s[a].s>p&&(p=s[a].s);var u=new Ji(p+1),g=Tx(r[d-1],u,0);if(g>t){var a=0,h=0,y=g-t,x=1<<y;for(s.sort(function(I,_){return u[_.s]-u[I.s]||I.f-_.f});a<n;++a){var v=s[a].s;if(u[v]>t)h+=x-(1<<g-u[v]),u[v]=t;else break}for(h>>=y;h>0;){var E=s[a].s;u[E]<t?h-=1<<t-u[E]++-1:++a}for(;a>=0&&h;--a){var D=s[a].s;u[D]==t&&(--u[D],++h)}g=t}return{t:new Yn(u),l:g}},Tx=function(e,t,r){return e.s==-1?Math.max(Tx(e.l,t,r+1),Tx(e.r,t,r+1)):t[e.s]=r},sw=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ji(++t),a=0,n=e[0],s=1,o=function(c){r[a++]=c},A=1;A<=t;++A)if(e[A]==n&&A!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=e[A]}return{c:r.subarray(0,a),n:t}},Ou=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},IC=function(e,t,r){var a=r.length,n=Cy(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var s=0;s<a;++s)e[n+s+4]=r[s];return(n+4+a)*8},ow=function(e,t,r,a,n,s,o,A,c,l,d){Uo(t,d++,r),++n[256];for(var f=zg(n,15),p=f.t,u=f.l,g=zg(s,15),h=g.t,y=g.l,x=sw(p),v=x.c,E=x.n,D=sw(h),B=D.c,I=D.n,_=new Ji(19),S=0;S<v.length;++S)++_[v[S]&31];for(var S=0;S<B.length;++S)++_[B[S]&31];for(var O=zg(_,7),M=O.t,T=O.l,R=19;R>4&&!M[Cx[R-1]];--R);var L=l+5<<3,N=Ou(n,cc)+Ou(s,$f)+o,P=Ou(n,p)+Ou(s,h)+o+14+3*R+Ou(_,M)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&L<=N&&L<=P)return IC(t,d,e.subarray(c,c+l));var U,V,ie,W;if(Uo(t,d,1+(P<N)),d+=2,P<N){U=ho(p,u,0),V=p,ie=ho(h,y,0),W=h;var z=ho(M,T,0);Uo(t,d,E-257),Uo(t,d+5,I-1),Uo(t,d+10,R-4),d+=14;for(var S=0;S<R;++S)Uo(t,d+3*S,M[Cx[S]]);d+=3*R;for(var G=[v,B],b=0;b<2;++b)for(var k=G[b],S=0;S<k.length;++S){var j=k[S]&31;Uo(t,d,z[j]),d+=M[j],j>15&&(Uo(t,d,k[S]>>5&127),d+=k[S]>>12)}}else U=CP,V=cc,ie=SP,W=$f;for(var S=0;S<A;++S){var q=a[S];if(q>255){var j=q>>18&31;Tu(t,d,U[j+257]),d+=V[j+257],j>7&&(Uo(t,d,q>>23&31),d+=Bm[j]);var Y=q&31;Tu(t,d,ie[Y]),d+=W[Y],Y>3&&(Tu(t,d,q>>5&8191),d+=Sm[Y])}else Tu(t,d,U[q]),d+=V[q]}return Tu(t,d,U[256]),d+V[256]},NP=new by([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),NC=new Yn(0),FP=function(e,t,r,a,n,s){var o=s.z||e.length,A=new Yn(a+o+5*(1+Math.ceil(o/7e3))+n),c=A.subarray(a,A.length-n),l=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=NP[t-1],p=f>>13,u=f&8191,g=(1<<r)-1,h=s.p||new Ji(32768),y=s.h||new Ji(g+1),x=Math.ceil(r/3),v=2*x,E=function(Ee){return(e[Ee]^e[Ee+1]<<x^e[Ee+2]<<v)&g},D=new by(25e3),B=new Ji(288),I=new Ji(32),_=0,S=0,O=s.i||0,M=0,T=s.w||0,R=0;O+2<o;++O){var L=E(O),N=O&32767,P=y[L];if(h[N]=P,y[L]=N,T<=O){var U=o-O;if((_>7e3||M>24576)&&(U>423||!l)){d=ow(e,c,0,D,B,I,S,M,R,O-R,d),M=_=S=0,R=O;for(var V=0;V<286;++V)B[V]=0;for(var V=0;V<30;++V)I[V]=0}var ie=2,W=0,z=u,G=N-P&32767;if(U>2&&L==E(O-G))for(var b=Math.min(p,U)-1,k=Math.min(32767,O),j=Math.min(258,U);G<=k&&--z&&N!=P;){if(e[O+ie]==e[O+ie-G]){for(var q=0;q<j&&e[O+q]==e[O+q-G];++q);if(q>ie){if(ie=q,W=G,q>b)break;for(var Y=Math.min(G,q-2),de=0,V=0;V<Y;++V){var ue=O-G+V&32767,pe=h[ue],ye=ue-pe&32767;ye>de&&(de=ye,P=ue)}}}N=P,P=h[N],G+=N-P&32767}if(W){D[M++]=268435456|Bx[ie]<<18|iw[W];var ve=Bx[ie]&31,ae=iw[W]&31;S+=Bm[ve]+Sm[ae],++B[257+ve],++I[ae],T=O+ie,++_}else D[M++]=e[O],++B[e[O]]}}for(O=Math.max(O,T);O<o;++O)D[M++]=e[O],++B[e[O]];d=ow(e,c,l,D,B,I,S,M,R,O-R,d),l||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=h,s.i=O,s.w=T)}else{for(var O=s.w||0;O<o+l;O+=65535){var Ke=O+65535;Ke>=o&&(c[d/8|0]=l,Ke=o),d=IC(c,d+1,e.subarray(O,Ke))}s.i=o}return OC(A,0,a+Cy(d)+n)},FC=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=r.length|0,o=0;o!=s;){for(var A=Math.min(o+2655,s);o<A;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},RP=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new Yn(s.length+e.length);o.set(s),o.set(e,s.length),e=o,n.w=s.length}return FP(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},RC=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},kP=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=FC();n.p(t.dictionary),RC(e,2,n.d())}},DP=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&qs(6,"invalid zlib data"),(e[1]>>5&1)==1&&qs(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Ox(e,t){t||(t={});var r=FC();r.p(e);var a=RP(e,t,t.dictionary?6:2,4);return kP(a,t),RC(a,a.length-4,r.d()),a}function jP(e,t){return IP(e.subarray(DP(e),-4),{i:2},t,t)}var LP=typeof TextDecoder<"u"&&new TextDecoder,UP=0;try{LP.decode(NC,{stream:!0}),UP=1}catch{}var Vt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Vg(){Vt.console&&typeof Vt.console.log=="function"&&Vt.console.log.apply(Vt.console,arguments)}var $r={log:Vg,warn:function(e){Vt.console&&(typeof Vt.console.warn=="function"?Vt.console.warn.apply(Vt.console,arguments):Vg.call(null,arguments))},error:function(e){Vt.console&&(typeof Vt.console.error=="function"?Vt.console.error.apply(Vt.console,arguments):Vg(e))}};function $g(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){Dc(a.response,t,r)},a.onerror=function(){$r.error("could not download file")},a.send()}function Aw(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function mp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var mf,Ix,Dc=Vt.saveAs||((typeof window>"u"?"undefined":Jr(window))!=="object"||window!==Vt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Vt.URL||Vt.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?Aw(n.href)?$g(e,t,r):mp(n,n.target="_blank"):mp(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){mp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Aw(e))$g(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){mp(a)})}else navigator.msSaveOrOpenBlob(function(n,s){return s===void 0?s={autoBom:!1}:Jr(s)!=="object"&&($r.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return $g(e,t,r);var n=e.type==="application/octet-stream",s=/constructor/i.test(Vt.HTMLElement)||Vt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&s)&&(typeof FileReader>"u"?"undefined":Jr(FileReader))==="object"){var A=new FileReader;A.onloadend=function(){var d=A.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},A.readAsDataURL(e)}else{var c=Vt.URL||Vt.webkitURL,l=c.createObjectURL(e);a?a.location=l:location.href=l,a=null,setTimeout(function(){c.revokeObjectURL(l)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function kC(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(A){return[parseInt(A[1],16),parseInt(A[2],16),parseInt(A[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(A){return[parseInt(A[1]+A[1],16),parseInt(A[2]+A[2],16),parseInt(A[3]+A[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,o=n.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var A=this.r.toString(16),c=this.g.toString(16),l=this.b.toString(16);return A.length==1&&(A="0"+A),c.length==1&&(c="0"+c),l.length==1&&(l="0"+l),"#"+A+c+l}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Yg(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=jn(r,a,n,s,t[0],7,-680876936),s=jn(s,r,a,n,t[1],12,-389564586),n=jn(n,s,r,a,t[2],17,606105819),a=jn(a,n,s,r,t[3],22,-1044525330),r=jn(r,a,n,s,t[4],7,-176418897),s=jn(s,r,a,n,t[5],12,1200080426),n=jn(n,s,r,a,t[6],17,-1473231341),a=jn(a,n,s,r,t[7],22,-45705983),r=jn(r,a,n,s,t[8],7,1770035416),s=jn(s,r,a,n,t[9],12,-1958414417),n=jn(n,s,r,a,t[10],17,-42063),a=jn(a,n,s,r,t[11],22,-1990404162),r=jn(r,a,n,s,t[12],7,1804603682),s=jn(s,r,a,n,t[13],12,-40341101),n=jn(n,s,r,a,t[14],17,-1502002290),r=Ln(r,a=jn(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=Ln(s,r,a,n,t[6],9,-1069501632),n=Ln(n,s,r,a,t[11],14,643717713),a=Ln(a,n,s,r,t[0],20,-373897302),r=Ln(r,a,n,s,t[5],5,-701558691),s=Ln(s,r,a,n,t[10],9,38016083),n=Ln(n,s,r,a,t[15],14,-660478335),a=Ln(a,n,s,r,t[4],20,-405537848),r=Ln(r,a,n,s,t[9],5,568446438),s=Ln(s,r,a,n,t[14],9,-1019803690),n=Ln(n,s,r,a,t[3],14,-187363961),a=Ln(a,n,s,r,t[8],20,1163531501),r=Ln(r,a,n,s,t[13],5,-1444681467),s=Ln(s,r,a,n,t[2],9,-51403784),n=Ln(n,s,r,a,t[7],14,1735328473),r=Un(r,a=Ln(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Un(s,r,a,n,t[8],11,-2022574463),n=Un(n,s,r,a,t[11],16,1839030562),a=Un(a,n,s,r,t[14],23,-35309556),r=Un(r,a,n,s,t[1],4,-1530992060),s=Un(s,r,a,n,t[4],11,1272893353),n=Un(n,s,r,a,t[7],16,-155497632),a=Un(a,n,s,r,t[10],23,-1094730640),r=Un(r,a,n,s,t[13],4,681279174),s=Un(s,r,a,n,t[0],11,-358537222),n=Un(n,s,r,a,t[3],16,-722521979),a=Un(a,n,s,r,t[6],23,76029189),r=Un(r,a,n,s,t[9],4,-640364487),s=Un(s,r,a,n,t[12],11,-421815835),n=Un(n,s,r,a,t[15],16,530742520),r=Mn(r,a=Un(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Mn(s,r,a,n,t[7],10,1126891415),n=Mn(n,s,r,a,t[14],15,-1416354905),a=Mn(a,n,s,r,t[5],21,-57434055),r=Mn(r,a,n,s,t[12],6,1700485571),s=Mn(s,r,a,n,t[3],10,-1894986606),n=Mn(n,s,r,a,t[10],15,-1051523),a=Mn(a,n,s,r,t[1],21,-2054922799),r=Mn(r,a,n,s,t[8],6,1873313359),s=Mn(s,r,a,n,t[15],10,-30611744),n=Mn(n,s,r,a,t[6],15,-1560198380),a=Mn(a,n,s,r,t[13],21,1309151649),r=Mn(r,a,n,s,t[4],6,-145523070),s=Mn(s,r,a,n,t[11],10,-1120210379),n=Mn(n,s,r,a,t[2],15,718787259),a=Mn(a,n,s,r,t[9],21,-343485551),e[0]=GA(r,e[0]),e[1]=GA(a,e[1]),e[2]=GA(n,e[2]),e[3]=GA(s,e[3])}function Tm(e,t,r,a,n,s){return t=GA(GA(t,e),GA(a,s)),GA(t<<n|t>>>32-n,r)}function jn(e,t,r,a,n,s,o){return Tm(t&r|~t&a,e,t,n,s,o)}function Ln(e,t,r,a,n,s,o){return Tm(t&a|r&~a,e,t,n,s,o)}function Un(e,t,r,a,n,s,o){return Tm(t^r^a,e,t,n,s,o)}function Mn(e,t,r,a,n,s,o){return Tm(r^(t|~a),e,t,n,s,o)}function DC(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Yg(a,MP(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Yg(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,Yg(a,n),a}function MP(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}mf=Vt.atob.bind(Vt),Ix=Vt.btoa.bind(Vt);var cw="0123456789abcdef".split("");function PP(e){for(var t="",r=0;r<4;r++)t+=cw[e>>8*r+4&15]+cw[e>>8*r&15];return t}function QP(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Nx(e){return DC(e).map(QP).join("")}var qP=function(e){for(var t=0;t<e.length;t++)e[t]=PP(e[t]);return e.join("")}(DC("hello"))!="5d41402abc4b2a76b9719d911017c592";function GA(e,t){if(qP){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Fx(e,t){var r,a,n,s;if(e!==r){for(var o=(n=e,s=1+(256/e.length>>0),new Array(s+1).join(n)),A=[],c=0;c<256;c++)A[c]=c;var l=0;for(c=0;c<256;c++){var d=A[c];l=(l+d+o.charCodeAt(c))%256,A[c]=A[l],A[l]=d}r=e,a=A}else A=a;var f=t.length,p=0,u=0,g="";for(c=0;c<f;c++)u=(u+(d=A[p=(p+1)%256]))%256,A[p]=A[u],A[u]=d,o=A[(A[p]+A[u])%256],g+=String.fromCharCode(t.charCodeAt(c)^o);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var lw={print:4,modify:8,copy:16,"annot-forms":32};function pd(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(A){if(lw.perm!==void 0)throw new Error("Invalid permission: "+A);n+=lw[A]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^n)),this.encryptionKey=Nx(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Fx(this.encryptionKey,this.padding)}function hd(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?t+="#"+("0"+n.toString(16)).slice(-2):t+=e[a]}return t}function dw(e){if(Jr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,a)}catch(A){Vt.console&&$r.error("jsPDF PubSub Error",A.message,A)}o[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Qh(e){if(!(this instanceof Qh))return new Qh(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function jC(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Lc(e,t,r,a,n){if(!(this instanceof Lc))return new Lc(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,jC.call(this,a,n)}function wd(e,t,r,a,n){if(!(this instanceof wd))return new wd(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,jC.call(this,a,n)}function Ht(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],o=[],A=1,c=16,l="S",d=null;Jr(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),A=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),l=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},u={internal:{},__private__:{}};u.__private__.PubSub=dw;var g="1.3",h=u.__private__.getPdfVersion=function(){return g};u.__private__.setPdfVersion=function(C){g=C};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return y};var x=u.__private__.getPageFormat=function(C){return y[C]};n=n||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},E=v.COMPAT;function D(){this.saveGraphicsState(),le(new kt(ct,0,0,-ct,0,dA()*ct).toString()+" cm"),this.setFontSize(this.getFontSize()/ct),l="n",E=v.ADVANCED}function B(){this.restoreGraphicsState(),l="S",E=v.COMPAT}var I=u.__private__.combineFontStyleAndFontWeight=function(C,J){if(C=="bold"&&J=="normal"||C=="bold"&&J==400||C=="normal"&&J=="italic"||C=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(C=J==400||J==="normal"?C==="italic"?"italic":"normal":J!=700&&J!=="bold"||C!=="normal"?(J==700?"bold":J)+""+C:"bold"),C};u.advancedAPI=function(C){var J=E===v.COMPAT;return J&&D.call(this),typeof C!="function"||(C(this),J&&B.call(this)),this},u.compatAPI=function(C){var J=E===v.ADVANCED;return J&&B.call(this),typeof C!="function"||(C(this),J&&D.call(this)),this},u.isAdvancedAPI=function(){return E===v.ADVANCED};var _,S=function(C){if(E!==v.ADVANCED)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},O=u.roundToPrecision=u.__private__.roundToPrecision=function(C,J){var xe=t||J;if(isNaN(C)||isNaN(xe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(xe).replace(/0+$/,"")};_=u.hpf=u.__private__.hpf=typeof c=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return O(C,c)}:c==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return O(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return O(C,16)};var M=u.f2=u.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return O(C,2)},T=u.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return O(C,3)},R=u.scale=u.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return E===v.COMPAT?C*ct:E===v.ADVANCED?C:void 0},L=function(C){return E===v.COMPAT?dA()-C:E===v.ADVANCED?C:void 0},N=function(C){return R(L(C))};u.__private__.setPrecision=u.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(t=parseInt(C,10))};var P,U="00000000000000000000000000000000",V=u.__private__.getFileId=function(){return U},ie=u.__private__.setFileId=function(C){return U=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():U.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Rn=new pd(d.userPermissions,d.userPassword,d.ownerPassword,U)),U};u.setFileId=function(C){return ie(C),this},u.getFileId=function(){return V()};var W=u.__private__.convertDateToPDFDate=function(C){var J=C.getTimezoneOffset(),xe=J<0?"+":"-",Ce=Math.floor(Math.abs(J/60)),Pe=Math.abs(J%60),Xe=[xe,j(Ce),"'",j(Pe),"'"].join("");return["D:",C.getFullYear(),j(C.getMonth()+1),j(C.getDate()),j(C.getHours()),j(C.getMinutes()),j(C.getSeconds()),Xe].join("")},z=u.__private__.convertPDFDateToDate=function(C){var J=parseInt(C.substr(2,4),10),xe=parseInt(C.substr(6,2),10)-1,Ce=parseInt(C.substr(8,2),10),Pe=parseInt(C.substr(10,2),10),Xe=parseInt(C.substr(12,2),10),At=parseInt(C.substr(14,2),10);return new Date(J,xe,Ce,Pe,Xe,At,0)},G=u.__private__.setCreationDate=function(C){var J;if(C===void 0&&(C=new Date),C instanceof Date)J=W(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=C}return P=J},b=u.__private__.getCreationDate=function(C){var J=P;return C==="jsDate"&&(J=z(P)),J};u.setCreationDate=function(C){return G(C),this},u.getCreationDate=function(C){return b(C)};var k,j=u.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},q=u.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},Y=0,de=[],ue=[],pe=0,ye=[],ve=[],ae=!1,Ke=ue,Ee=function(){Y=0,pe=0,ue=[],de=[],ye=[],te=ge(),Z=ge()};u.__private__.setCustomOutputDestination=function(C){ae=!0,Ke=C};var me=function(C){ae||(Ke=C)};u.__private__.resetCustomOutputDestination=function(){ae=!1,Ke=ue};var le=u.__private__.out=function(C){return C=C.toString(),pe+=C.length+1,Ke.push(C),Ke},He=u.__private__.write=function(C){return le(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},Ze=u.__private__.getArrayBuffer=function(C){for(var J=C.length,xe=new ArrayBuffer(J),Ce=new Uint8Array(xe);J--;)Ce[J]=C.charCodeAt(J);return xe},$e=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return $e};var et=e.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(C){return et=E===v.ADVANCED?C/ct:C,this};var je,_e=u.__private__.getFontSize=u.getFontSize=function(){return E===v.COMPAT?et:et*ct},lt=e.R2L||!1;u.__private__.setR2L=u.setR2L=function(C){return lt=C,this},u.__private__.getR2L=u.getR2L=function(){return lt};var Ct,bt=u.__private__.setZoomMode=function(C){var J=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))je=C;else if(isNaN(C)){if(J.indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');je=C}else je=parseInt(C,10)};u.__private__.getZoomMode=function(){return je};var Et,Mt=u.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');Ct=C};u.__private__.getPageMode=function(){return Ct};var Dt=u.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');Et=C};u.__private__.getLayoutMode=function(){return Et},u.__private__.setDisplayMode=u.setDisplayMode=function(C,J,xe){return bt(C),Dt(J),Mt(xe),this};var Bt={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(C){if(Object.keys(Bt).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Bt[C]},u.__private__.getDocumentProperties=function(){return Bt},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(C){for(var J in Bt)Bt.hasOwnProperty(J)&&C[J]&&(Bt[J]=C[J]);return this},u.__private__.setDocumentProperty=function(C,J){if(Object.keys(Bt).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Bt[C]=J};var ut,ct,vr,Rt,Gr,pr={},vt={},Tr=[],rr={},ln={},kr={},ri={},Di=null,Dr=0,Gt=[],wr=new dw(u),ns=e.hotfixes||[],ga={},yi={},vi=[],kt=function C(J,xe,Ce,Pe,Xe,At){if(!(this instanceof C))return new C(J,xe,Ce,Pe,Xe,At);isNaN(J)&&(J=1),isNaN(xe)&&(xe=0),isNaN(Ce)&&(Ce=0),isNaN(Pe)&&(Pe=1),isNaN(Xe)&&(Xe=0),isNaN(At)&&(At=0),this._matrix=[J,xe,Ce,Pe,Xe,At]};Object.defineProperty(kt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(kt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(kt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(kt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(kt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(kt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(kt.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(kt.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(kt.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(kt.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(kt.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(kt.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(kt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(kt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(kt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(kt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),kt.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_).join(C)},kt.prototype.multiply=function(C){var J=C.sx*this.sx+C.shy*this.shx,xe=C.sx*this.shy+C.shy*this.sy,Ce=C.shx*this.sx+C.sy*this.shx,Pe=C.shx*this.shy+C.sy*this.sy,Xe=C.tx*this.sx+C.ty*this.shx+this.tx,At=C.tx*this.shy+C.ty*this.sy+this.ty;return new kt(J,xe,Ce,Pe,Xe,At)},kt.prototype.decompose=function(){var C=this.sx,J=this.shy,xe=this.shx,Ce=this.sy,Pe=this.tx,Xe=this.ty,At=Math.sqrt(C*C+J*J),Tt=(C/=At)*xe+(J/=At)*Ce;xe-=C*Tt,Ce-=J*Tt;var Ut=Math.sqrt(xe*xe+Ce*Ce);return Tt/=Ut,C*(Ce/=Ut)<J*(xe/=Ut)&&(C=-C,J=-J,Tt=-Tt,At=-At),{scale:new kt(At,0,0,Ut,0,0),translate:new kt(1,0,0,1,Pe,Xe),rotate:new kt(C,J,-J,C,0,0),skew:new kt(1,0,Tt,1,0,0)}},kt.prototype.toString=function(C){return this.join(" ")},kt.prototype.inversed=function(){var C=this.sx,J=this.shy,xe=this.shx,Ce=this.sy,Pe=this.tx,Xe=this.ty,At=1/(C*Ce-J*xe),Tt=Ce*At,Ut=-J*At,ar=-xe*At,Zt=C*At;return new kt(Tt,Ut,ar,Zt,-Tt*Pe-ar*Xe,-Ut*Pe-Zt*Xe)},kt.prototype.applyToPoint=function(C){var J=C.x*this.sx+C.y*this.shx+this.tx,xe=C.x*this.shy+C.y*this.sy+this.ty;return new Tl(J,xe)},kt.prototype.applyToRectangle=function(C){var J=this.applyToPoint(C),xe=this.applyToPoint(new Tl(C.x+C.w,C.y+C.h));return new su(J.x,J.y,xe.x-J.x,xe.y-J.y)},kt.prototype.clone=function(){var C=this.sx,J=this.shy,xe=this.shx,Ce=this.sy,Pe=this.tx,Xe=this.ty;return new kt(C,J,xe,Ce,Pe,Xe)},u.Matrix=kt;var ai=u.matrixMult=function(C,J){return J.multiply(C)},Ja=new kt(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=Ja;var Za=function(C,J){if(!ln[C]){var xe=(J instanceof Lc?"Sh":"P")+(Object.keys(rr).length+1).toString(10);J.id=xe,ln[C]=xe,rr[xe]=J,wr.publish("addPattern",J)}};u.ShadingPattern=Lc,u.TilingPattern=wd,u.addShadingPattern=function(C,J){return S("addShadingPattern()"),Za(C,J),this},u.beginTilingPattern=function(C){S("beginTilingPattern()"),B0(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},u.endTilingPattern=function(C,J){S("endTilingPattern()"),J.stream=ve[k].join(`
`),Za(C,J),wr.publish("endTilingPattern",J),vi.pop().restore()};var ca=u.__private__.newObject=function(){var C=ge();return H(C,!0),C},ge=u.__private__.newObjectDeferred=function(){return Y++,de[Y]=function(){return pe},Y},H=function(C,J){return J=typeof J=="boolean"&&J,de[C]=pe,J&&le(C+" 0 obj"),C},Ae=u.__private__.newAdditionalObject=function(){var C={objId:ge(),content:""};return ye.push(C),C},te=ge(),Z=ge(),se=u.__private__.decodeColorString=function(C){var J=C.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length===5&&(J[4]==="k"||J[4]==="K")&&(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var xe=parseFloat(J[0]);J=[xe,xe,xe,"r"]}for(var Ce="#",Pe=0;Pe<3;Pe++)Ce+=("0"+Math.floor(255*parseFloat(J[Pe])).toString(16)).slice(-2);return Ce},ce=u.__private__.encodeColorString=function(C){var J;typeof C=="string"&&(C={ch1:C});var xe=C.ch1,Ce=C.ch2,Pe=C.ch3,Xe=C.ch4,At=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof xe=="string"&&xe.charAt(0)!=="#"){var Tt=new kC(xe);if(Tt.ok)xe=Tt.toHex();else if(!/^\d*\.?\d*$/.test(xe))throw new Error('Invalid color "'+xe+'" passed to jsPDF.encodeColorString.')}if(typeof xe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(xe)&&(xe="#"+xe[1]+xe[1]+xe[2]+xe[2]+xe[3]+xe[3]),typeof xe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(xe)){var Ut=parseInt(xe.substr(1),16);xe=Ut>>16&255,Ce=Ut>>8&255,Pe=255&Ut}if(Ce===void 0||Xe===void 0&&xe===Ce&&Ce===Pe)if(typeof xe=="string")J=xe+" "+At[0];else switch(C.precision){case 2:J=M(xe/255)+" "+At[0];break;case 3:default:J=T(xe/255)+" "+At[0]}else if(Xe===void 0||Jr(Xe)==="object"){if(Xe&&!isNaN(Xe.a)&&Xe.a===0)return J=["1.","1.","1.",At[1]].join(" ");if(typeof xe=="string")J=[xe,Ce,Pe,At[1]].join(" ");else switch(C.precision){case 2:J=[M(xe/255),M(Ce/255),M(Pe/255),At[1]].join(" ");break;default:case 3:J=[T(xe/255),T(Ce/255),T(Pe/255),At[1]].join(" ")}}else if(typeof xe=="string")J=[xe,Ce,Pe,Xe,At[2]].join(" ");else switch(C.precision){case 2:J=[M(xe),M(Ce),M(Pe),M(Xe),At[2]].join(" ");break;case 3:default:J=[T(xe),T(Ce),T(Pe),T(Xe),At[2]].join(" ")}return J},Se=u.__private__.getFilters=function(){return o},Me=u.__private__.putStream=function(C){var J=(C=C||{}).data||"",xe=C.filters||Se(),Ce=C.alreadyAppliedFilters||[],Pe=C.addLength1||!1,Xe=J.length,At=C.objectId,Tt=function(kn){return kn};if(d!==null&&At===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Tt=Rn.encryptor(At,0));var Ut={};xe===!0&&(xe=["FlateEncode"]);var ar=C.additionalKeyValues||[],Zt=(Ut=Ht.API.processDataByFilters!==void 0?Ht.API.processDataByFilters(J,xe):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(Ce)?Ce.join(" "):Ce.toString());if(Ut.data.length!==0&&(ar.push({key:"Length",value:Ut.data.length}),Pe===!0&&ar.push({key:"Length1",value:Xe})),Zt.length!=0)if(Zt.split("/").length-1==1)ar.push({key:"Filter",value:Zt});else{ar.push({key:"Filter",value:"["+Zt+"]"});for(var Er=0;Er<ar.length;Er+=1)if(ar[Er].key==="DecodeParms"){for(var ha=[],ya=0;ya<Ut.reverseChain.split("/").length-1;ya+=1)ha.push("null");ha.push(ar[Er].value),ar[Er].value="["+ha.join(" ")+"]"}}le("<<");for(var qa=0;qa<ar.length;qa++)le("/"+ar[qa].key+" "+ar[qa].value);le(">>"),Ut.data.length!==0&&(le("stream"),le(Tt(Ut.data)),le("endstream"))},be=u.__private__.putPage=function(C){var J=C.number,xe=C.data,Ce=C.objId,Pe=C.contentsObjId;H(Ce,!0),le("<</Type /Page"),le("/Parent "+C.rootDictionaryObjId+" 0 R"),le("/Resources "+C.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(_(C.mediaBox.bottomLeftX))+" "+parseFloat(_(C.mediaBox.bottomLeftY))+" "+_(C.mediaBox.topRightX)+" "+_(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&le("/CropBox ["+_(C.cropBox.bottomLeftX)+" "+_(C.cropBox.bottomLeftY)+" "+_(C.cropBox.topRightX)+" "+_(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&le("/BleedBox ["+_(C.bleedBox.bottomLeftX)+" "+_(C.bleedBox.bottomLeftY)+" "+_(C.bleedBox.topRightX)+" "+_(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&le("/TrimBox ["+_(C.trimBox.bottomLeftX)+" "+_(C.trimBox.bottomLeftY)+" "+_(C.trimBox.topRightX)+" "+_(C.trimBox.topRightY)+"]"),C.artBox!==null&&le("/ArtBox ["+_(C.artBox.bottomLeftX)+" "+_(C.artBox.bottomLeftY)+" "+_(C.artBox.topRightX)+" "+_(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&le("/UserUnit "+C.userUnit),wr.publish("putPage",{objId:Ce,pageContext:Gt[J],pageNumber:J,page:xe}),le("/Contents "+Pe+" 0 R"),le(">>"),le("endobj");var Xe=xe.join(`
`);return E===v.ADVANCED&&(Xe+=`
Q`),H(Pe,!0),Me({data:Xe,filters:Se(),objectId:Pe}),le("endobj"),Ce},ke=u.__private__.putPages=function(){var C,J,xe=[];for(C=1;C<=Dr;C++)Gt[C].objId=ge(),Gt[C].contentsObjId=ge();for(C=1;C<=Dr;C++)xe.push(be({number:C,data:ve[C],objId:Gt[C].objId,contentsObjId:Gt[C].contentsObjId,mediaBox:Gt[C].mediaBox,cropBox:Gt[C].cropBox,bleedBox:Gt[C].bleedBox,trimBox:Gt[C].trimBox,artBox:Gt[C].artBox,userUnit:Gt[C].userUnit,rootDictionaryObjId:te,resourceDictionaryObjId:Z}));H(te,!0),le("<</Type /Pages");var Ce="/Kids [";for(J=0;J<Dr;J++)Ce+=xe[J]+" 0 R ";le(Ce+"]"),le("/Count "+Dr),le(">>"),le("endobj"),wr.publish("postPutPages")},Ue=function(C){wr.publish("putFont",{font:C,out:le,newObject:ca,putStream:Me}),C.isAlreadyPutted!==!0&&(C.objectNumber=ca(),le("<<"),le("/Type /Font"),le("/BaseFont /"+hd(C.postScriptName)),le("/Subtype /Type1"),typeof C.encoding=="string"&&le("/Encoding /"+C.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},ze=function(){for(var C in pr)pr.hasOwnProperty(C)&&(f===!1||f===!0&&p.hasOwnProperty(C))&&Ue(pr[C])},dt=function(C){C.objectNumber=ca();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[_(C.x),_(C.y),_(C.x+C.width),_(C.y+C.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var xe=C.pages[1].join(`
`);Me({data:xe,additionalKeyValues:J,objectId:C.objectNumber}),le("endobj")},pt=function(){for(var C in ga)ga.hasOwnProperty(C)&&dt(ga[C])},st=function(C,J){var xe,Ce=[],Pe=1/(J-1);for(xe=0;xe<1;xe+=Pe)Ce.push(xe);if(Ce.push(1),C[0].offset!=0){var Xe={offset:0,color:C[0].color};C.unshift(Xe)}if(C[C.length-1].offset!=1){var At={offset:1,color:C[C.length-1].color};C.push(At)}for(var Tt="",Ut=0,ar=0;ar<Ce.length;ar++){for(xe=Ce[ar];xe>C[Ut+1].offset;)Ut++;var Zt=C[Ut].offset,Er=(xe-Zt)/(C[Ut+1].offset-Zt),ha=C[Ut].color,ya=C[Ut+1].color;Tt+=q(Math.round((1-Er)*ha[0]+Er*ya[0]).toString(16))+q(Math.round((1-Er)*ha[1]+Er*ya[1]).toString(16))+q(Math.round((1-Er)*ha[2]+Er*ya[2]).toString(16))}return Tt.trim()},ht=function(C,J){J||(J=21);var xe=ca(),Ce=st(C.colors,J),Pe=[];Pe.push({key:"FunctionType",value:"0"}),Pe.push({key:"Domain",value:"[0.0 1.0]"}),Pe.push({key:"Size",value:"["+J+"]"}),Pe.push({key:"BitsPerSample",value:"8"}),Pe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Me({data:Ce,additionalKeyValues:Pe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:xe}),le("endobj"),C.objectNumber=ca(),le("<< /ShadingType "+C.type),le("/ColorSpace /DeviceRGB");var Xe="/Coords ["+_(parseFloat(C.coords[0]))+" "+_(parseFloat(C.coords[1]))+" ";C.type===2?Xe+=_(parseFloat(C.coords[2]))+" "+_(parseFloat(C.coords[3])):Xe+=_(parseFloat(C.coords[2]))+" "+_(parseFloat(C.coords[3]))+" "+_(parseFloat(C.coords[4]))+" "+_(parseFloat(C.coords[5])),le(Xe+="]"),C.matrix&&le("/Matrix ["+C.matrix.toString()+"]"),le("/Function "+xe+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},Qt=function(C,J){var xe=ge(),Ce=ca();J.push({resourcesOid:xe,objectOid:Ce}),C.objectNumber=Ce;var Pe=[];Pe.push({key:"Type",value:"/Pattern"}),Pe.push({key:"PatternType",value:"1"}),Pe.push({key:"PaintType",value:"1"}),Pe.push({key:"TilingType",value:"1"}),Pe.push({key:"BBox",value:"["+C.boundingBox.map(_).join(" ")+"]"}),Pe.push({key:"XStep",value:_(C.xStep)}),Pe.push({key:"YStep",value:_(C.yStep)}),Pe.push({key:"Resources",value:xe+" 0 R"}),C.matrix&&Pe.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),Me({data:C.stream,additionalKeyValues:Pe,objectId:C.objectNumber}),le("endobj")},xr=function(C){var J;for(J in rr)rr.hasOwnProperty(J)&&(rr[J]instanceof Lc?ht(rr[J]):rr[J]instanceof wd&&Qt(rr[J],C))},br=function(C){for(var J in C.objectNumber=ca(),le("<<"),C)switch(J){case"opacity":le("/ca "+M(C[J]));break;case"stroke-opacity":le("/CA "+M(C[J]))}le(">>"),le("endobj")},xa=function(){var C;for(C in kr)kr.hasOwnProperty(C)&&br(kr[C])},wi=function(){for(var C in le("/XObject <<"),ga)ga.hasOwnProperty(C)&&ga[C].objectNumber>=0&&le("/"+C+" "+ga[C].objectNumber+" 0 R");wr.publish("putXobjectDict"),le(">>")},Ei=function(){Rn.oid=ca(),le("<<"),le("/Filter /Standard"),le("/V "+Rn.v),le("/R "+Rn.r),le("/U <"+Rn.toHexString(Rn.U)+">"),le("/O <"+Rn.toHexString(Rn.O)+">"),le("/P "+Rn.P),le(">>"),le("endobj")},Fn=function(){for(var C in le("/Font <<"),pr)pr.hasOwnProperty(C)&&(f===!1||f===!0&&p.hasOwnProperty(C))&&le("/"+C+" "+pr[C].objectNumber+" 0 R");le(">>")},ji=function(){if(Object.keys(rr).length>0){for(var C in le("/Shading <<"),rr)rr.hasOwnProperty(C)&&rr[C]instanceof Lc&&rr[C].objectNumber>=0&&le("/"+C+" "+rr[C].objectNumber+" 0 R");wr.publish("putShadingPatternDict"),le(">>")}},is=function(C){if(Object.keys(rr).length>0){for(var J in le("/Pattern <<"),rr)rr.hasOwnProperty(J)&&rr[J]instanceof u.TilingPattern&&rr[J].objectNumber>=0&&rr[J].objectNumber<C&&le("/"+J+" "+rr[J].objectNumber+" 0 R");wr.publish("putTilingPatternDict"),le(">>")}},ni=function(){if(Object.keys(kr).length>0){var C;for(C in le("/ExtGState <<"),kr)kr.hasOwnProperty(C)&&kr[C].objectNumber>=0&&le("/"+C+" "+kr[C].objectNumber+" 0 R");wr.publish("putGStateDict"),le(">>")}},pa=function(C){H(C.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Fn(),ji(),is(C.objectOid),ni(),wi(),le(">>"),le("endobj")},zr=function(){var C=[];ze(),xa(),pt(),xr(C),wr.publish("putResources"),C.forEach(pa),pa({resourcesOid:Z,objectOid:Number.MAX_SAFE_INTEGER}),wr.publish("postPutResources")},en=function(){wr.publish("putAdditionalObjects");for(var C=0;C<ye.length;C++){var J=ye[C];H(J.objId,!0),le(J.content),le("endobj")}wr.publish("postPutAdditionalObjects")},Is=function(C){vt[C.fontName]=vt[C.fontName]||{},vt[C.fontName][C.fontStyle]=C.id},Ns=function(C,J,xe,Ce,Pe){var Xe={id:"F"+(Object.keys(pr).length+1).toString(10),postScriptName:C,fontName:J,fontStyle:xe,encoding:Ce,isStandardFont:Pe||!1,metadata:{}};return wr.publish("addFont",{font:Xe,instance:this}),pr[Xe.id]=Xe,Is(Xe),Xe.id},El=function(C){for(var J=0,xe=$e.length;J<xe;J++){var Ce=Ns.call(this,C[J][0],C[J][1],C[J][2],$e[J][3],!0);f===!1&&(p[Ce]=!0);var Pe=C[J][0].split("-");Is({id:Ce,fontName:Pe[0],fontStyle:Pe[1]||""})}wr.publish("addFonts",{fonts:pr,dictionary:vt})},Li=function(C){return C.foo=function(){try{return C.apply(this,arguments)}catch(Ce){var J=Ce.stack||"";~J.indexOf(" at ")&&(J=J.split(" at ")[1]);var xe="Error in function "+J.split(`
`)[0].split("<")[0]+": "+Ce.message;if(!Vt.console)throw new Error(xe);Vt.console.error(xe,Ce),Vt.alert&&alert(xe)}},C.foo.bar=C,C.foo},_o=function(C,J){var xe,Ce,Pe,Xe,At,Tt,Ut,ar,Zt;if(Pe=(J=J||{}).sourceEncoding||"Unicode",At=J.outputEncoding,(J.autoencode||At)&&pr[ut].metadata&&pr[ut].metadata[Pe]&&pr[ut].metadata[Pe].encoding&&(Xe=pr[ut].metadata[Pe].encoding,!At&&pr[ut].encoding&&(At=pr[ut].encoding),!At&&Xe.codePages&&(At=Xe.codePages[0]),typeof At=="string"&&(At=Xe[At]),At)){for(Ut=!1,Tt=[],xe=0,Ce=C.length;xe<Ce;xe++)(ar=At[C.charCodeAt(xe)])?Tt.push(String.fromCharCode(ar)):Tt.push(C[xe]),Tt[xe].charCodeAt(0)>>8&&(Ut=!0);C=Tt.join("")}for(xe=C.length;Ut===void 0&&xe!==0;)C.charCodeAt(xe-1)>>8&&(Ut=!0),xe--;if(!Ut)return C;for(Tt=J.noBOM?[]:[254,255],xe=0,Ce=C.length;xe<Ce;xe++){if((Zt=(ar=C.charCodeAt(xe))>>8)>>8)throw new Error("Character at position "+xe+" of string '"+C+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Tt.push(Zt),Tt.push(ar-(Zt<<8))}return String.fromCharCode.apply(void 0,Tt)},tn=u.__private__.pdfEscape=u.pdfEscape=function(C,J){return _o(C,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},oA=u.__private__.beginPage=function(C){ve[++Dr]=[],Gt[Dr]={objId:0,contentsObjId:0,userUnit:Number(A),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},Fs(Dr),me(ve[k])},AA=function(C,J){var xe,Ce,Pe;switch(r=J||r,typeof C=="string"&&(xe=x(C.toLowerCase()),Array.isArray(xe)&&(Ce=xe[0],Pe=xe[1])),Array.isArray(C)&&(Ce=C[0]*ct,Pe=C[1]*ct),isNaN(Ce)&&(Ce=n[0],Pe=n[1]),(Ce>14400||Pe>14400)&&($r.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ce=Math.min(14400,Ce),Pe=Math.min(14400,Pe)),n=[Ce,Pe],r.substr(0,1)){case"l":Pe>Ce&&(n=[Pe,Ce]);break;case"p":Ce>Pe&&(n=[Pe,Ce])}oA(n),w0(ru),le(Rs),nu!==0&&le(nu+" J"),iu!==0&&le(iu+" j"),wr.publish("addPage",{pageNumber:Dr})},Jd=function(C){C>0&&C<=Dr&&(ve.splice(C,1),Gt.splice(C,1),Dr--,k>Dr&&(k=Dr),this.setPage(k))},Fs=function(C){C>0&&C<=Dr&&(k=C)},bo=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return ve.length-1},Co=function(C,J,xe){var Ce,Pe=void 0;return xe=xe||{},C=C!==void 0?C:pr[ut].fontName,J=J!==void 0?J:pr[ut].fontStyle,Ce=C.toLowerCase(),vt[Ce]!==void 0&&vt[Ce][J]!==void 0?Pe=vt[Ce][J]:vt[C]!==void 0&&vt[C][J]!==void 0?Pe=vt[C][J]:xe.disableWarning===!1&&$r.warn("Unable to look up font label for font '"+C+"', '"+J+"'. Refer to getFontList() for available fonts."),Pe||xe.noFallback||(Pe=vt.times[J])==null&&(Pe=vt.times.normal),Pe},m0=u.__private__.putInfo=function(){var C=ca(),J=function(Ce){return Ce};for(var xe in d!==null&&(J=Rn.encryptor(C,0)),le("<<"),le("/Producer ("+tn(J("jsPDF "+Ht.version))+")"),Bt)Bt.hasOwnProperty(xe)&&Bt[xe]&&le("/"+xe.substr(0,1).toUpperCase()+xe.substr(1)+" ("+tn(J(Bt[xe]))+")");le("/CreationDate ("+tn(J(P))+")"),le(">>"),le("endobj")},mc=u.__private__.putCatalog=function(C){var J=(C=C||{}).rootDictionaryObjId||te;switch(ca(),le("<<"),le("/Type /Catalog"),le("/Pages "+J+" 0 R"),je||(je="fullwidth"),je){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var xe=""+je;xe.substr(xe.length-1)==="%"&&(je=parseInt(je)/100),typeof je=="number"&&le("/OpenAction [3 0 R /XYZ null null "+M(je)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}Ct&&le("/PageMode /"+Ct),wr.publish("putCatalog"),le(">>"),le("endobj")},Zd=u.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(Y+1)),le("/Root "+Y+" 0 R"),le("/Info "+(Y-1)+" 0 R"),d!==null&&le("/Encrypt "+Rn.oid+" 0 R"),le("/ID [ <"+U+"> <"+U+"> ]"),le(">>")},Pm=u.__private__.putHeader=function(){le("%PDF-"+g),le("%ºß¬à")},Qm=u.__private__.putXRef=function(){var C="0000000000";le("xref"),le("0 "+(Y+1)),le("0000000000 65535 f ");for(var J=1;J<=Y;J++)typeof de[J]=="function"?le((C+de[J]()).slice(-10)+" 00000 n "):de[J]!==void 0?le((C+de[J]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},Bo=u.__private__.buildDocument=function(){Ee(),me(ue),wr.publish("buildDocument"),Pm(),ke(),en(),zr(),d!==null&&Ei(),m0(),mc();var C=pe;return Qm(),Zd(),le("startxref"),le(""+C),le("%%EOF"),me(ve[k]),ue.join(`
`)},_l=u.__private__.getBlob=function(C){return new Blob([Ze(C)],{type:"application/pdf"})},bl=u.output=u.__private__.output=Li(function(C,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",C){case void 0:return Bo();case"save":u.save(J.filename);break;case"arraybuffer":return Ze(Bo());case"blob":return _l(Bo());case"bloburi":case"bloburl":if(Vt.URL!==void 0&&typeof Vt.URL.createObjectURL=="function")return Vt.URL&&Vt.URL.createObjectURL(_l(Bo()))||void 0;$r.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var xe="",Ce=Bo();try{xe=Ix(Ce)}catch{xe=Ix(unescape(encodeURIComponent(Ce)))}return"data:application/pdf;filename="+J.filename+";base64,"+xe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Vt)==="[object Window]"){var Pe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Xe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(Pe=J.pdfObjectUrl,Xe="");var At='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Pe+'"'+Xe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Tt=Vt.open();return Tt!==null&&Tt.document.write(At),Tt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Vt)==="[object Window]"){var Ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',ar=Vt.open();if(ar!==null){ar.document.write(Ut);var Zt=this;ar.document.documentElement.querySelector("#pdfViewer").onload=function(){ar.document.title=J.filename,ar.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Zt.output("bloburl"))}}return ar}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Vt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Er='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',ha=Vt.open();if(ha!==null&&(ha.document.write(Er),ha.document.title=J.filename),ha||typeof safari>"u")return ha;break;case"datauri":case"dataurl":return Vt.document.location.href=this.output("datauristring",J);default:return null}}),g0=function(C){return Array.isArray(ns)===!0&&ns.indexOf(C)>-1};switch(a){case"pt":ct=1;break;case"mm":ct=72/25.4;break;case"cm":ct=72/2.54;break;case"in":ct=72;break;case"px":ct=g0("px_scaling")==1?.75:96/72;break;case"pc":case"em":ct=12;break;case"ex":ct=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ct=a}var Rn=null;G(),ie();var qm=function(C){return d!==null?Rn.encryptor(C,0):function(J){return J}},x0=u.__private__.getPageInfo=u.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Gt[C].objId,pageNumber:C,pageContext:Gt[C]}},Jt=u.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in Gt)if(Gt[J].objId===C)break;return x0(J)},Km=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:Gt[k].objId,pageNumber:k,pageContext:Gt[k]}};u.addPage=function(){return AA.apply(this,arguments),this},u.setPage=function(){return Fs.apply(this,arguments),me.call(this,ve[k]),this},u.insertPage=function(C){return this.addPage(),this.movePage(k,C),this},u.movePage=function(C,J){var xe,Ce;if(C>J){xe=ve[C],Ce=Gt[C];for(var Pe=C;Pe>J;Pe--)ve[Pe]=ve[Pe-1],Gt[Pe]=Gt[Pe-1];ve[J]=xe,Gt[J]=Ce,this.setPage(J)}else if(C<J){xe=ve[C],Ce=Gt[C];for(var Xe=C;Xe<J;Xe++)ve[Xe]=ve[Xe+1],Gt[Xe]=Gt[Xe+1];ve[J]=xe,Gt[J]=Ce,this.setPage(J)}return this},u.deletePage=function(){return Jd.apply(this,arguments),this},u.__private__.text=u.text=function(C,J,xe,Ce,Pe){var Xe,At,Tt,Ut,ar,Zt,Er,ha,ya,qa=(Ce=Ce||{}).scope||this;if(typeof C=="number"&&typeof J=="number"&&(typeof xe=="string"||Array.isArray(xe))){var kn=xe;xe=J,J=C,C=kn}if(arguments[3]instanceof kt?(S("The transform parameter of text() with a Matrix value"),ya=Pe):(Tt=arguments[4],Ut=arguments[5],Jr(Er=arguments[3])==="object"&&Er!==null||(typeof Tt=="string"&&(Ut=Tt,Tt=null),typeof Er=="string"&&(Ut=Er,Er=null),typeof Er=="number"&&(Tt=Er,Er=null),Ce={flags:Er,angle:Tt,align:Ut})),isNaN(J)||isNaN(xe)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return qa;var dn="",ks=!1,Ui=typeof Ce.lineHeightFactor=="number"?Ce.lineHeightFactor:xc,eo=qa.internal.scaleFactor;function S0(ea){return ea=ea.split("	").join(Array(Ce.TabLen||9).join(" ")),tn(ea,Er)}function lu(ea){for(var ta,Na=ea.concat(),rn=[],No=Na.length;No--;)typeof(ta=Na.shift())=="string"?rn.push(ta):Array.isArray(ea)&&(ta.length===1||ta[1]===void 0&&ta[2]===void 0)?rn.push(ta[0]):rn.push([ta[0],ta[1],ta[2]]);return rn}function du(ea,ta){var Na;if(typeof ea=="string")Na=ta(ea)[0];else if(Array.isArray(ea)){for(var rn,No,yu=ea.concat(),Ml=[],F0=yu.length;F0--;)typeof(rn=yu.shift())=="string"?Ml.push(ta(rn)[0]):Array.isArray(rn)&&typeof rn[0]=="string"&&(No=ta(rn[0],rn[1],rn[2]),Ml.push([No[0],No[1],No[2]]));Na=Ml}return Na}var Il=!1,uu=!0;if(typeof C=="string")Il=!0;else if(Array.isArray(C)){var fu=C.concat();At=[];for(var Nl,vn=fu.length;vn--;)(typeof(Nl=fu.shift())!="string"||Array.isArray(Nl)&&typeof Nl[0]!="string")&&(uu=!1);Il=uu}if(Il===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var Fl=et/qa.internal.scaleFactor,Rl=Fl*(Ui-1);switch(Ce.baseline){case"bottom":xe-=Rl;break;case"top":xe+=Fl-Rl;break;case"hanging":xe+=Fl-2*Rl;break;case"middle":xe+=Fl/2-Rl}if((Zt=Ce.maxWidth||0)>0&&(typeof C=="string"?C=qa.splitTextToSize(C,Zt):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(ea,ta){return ea.concat(qa.splitTextToSize(ta,Zt))},[]))),Xe={text:C,x:J,y:xe,options:Ce,mutex:{pdfEscape:tn,activeFontKey:ut,fonts:pr,activeFontSize:et}},wr.publish("preProcessText",Xe),C=Xe.text,Tt=(Ce=Xe.options).angle,!(ya instanceof kt)&&Tt&&typeof Tt=="number"){Tt*=Math.PI/180,Ce.rotationDirection===0&&(Tt=-Tt),E===v.ADVANCED&&(Tt=-Tt);var kl=Math.cos(Tt),pu=Math.sin(Tt);ya=new kt(kl,pu,-pu,kl,0,0)}else Tt&&Tt instanceof kt&&(ya=Tt);E!==v.ADVANCED||ya||(ya=Ja),(ar=Ce.charSpace||Sl)!==void 0&&(dn+=_(R(ar))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ha=Ce.horizontalScale)!==void 0&&(dn+=_(100*ha)+` Tz
`),Ce.lang;var _i=-1,Zm=Ce.renderingMode!==void 0?Ce.renderingMode:Ce.stroke,hu=qa.internal.getCurrentPageInfo().pageContext;switch(Zm){case 0:case!1:case"fill":_i=0;break;case 1:case!0:case"stroke":_i=1;break;case 2:case"fillThenStroke":_i=2;break;case 3:case"invisible":_i=3;break;case 4:case"fillAndAddForClipping":_i=4;break;case 5:case"strokeAndAddPathForClipping":_i=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":_i=6;break;case 7:case"addToPathForClipping":_i=7}var T0=hu.usedRenderingMode!==void 0?hu.usedRenderingMode:-1;_i!==-1?dn+=_i+` Tr
`:T0!==-1&&(dn+=`0 Tr
`),_i!==-1&&(hu.usedRenderingMode=_i),Ut=Ce.align||"left";var ss,Dl=et*Ui,O0=qa.internal.pageSize.getWidth(),I0=pr[ut];ar=Ce.charSpace||Sl,Zt=Ce.maxWidth||0,Er=Object.assign({autoencode:!0,noBOM:!0},Ce.flags);var uA=[],wc=function(ea){return qa.getStringUnitWidth(ea,{font:I0,charSpace:ar,fontSize:et,doKerning:!1})*et/eo};if(Object.prototype.toString.call(C)==="[object Array]"){var bi;At=lu(C),Ut!=="left"&&(ss=At.map(wc));var ii,fA=0;if(Ut==="right"){J-=ss[0],C=[],vn=At.length;for(var To=0;To<vn;To++)To===0?(ii=Zs(J),bi=So(xe)):(ii=R(fA-ss[To]),bi=-Dl),C.push([At[To],ii,bi]),fA=ss[To]}else if(Ut==="center"){J-=ss[0]/2,C=[],vn=At.length;for(var Oo=0;Oo<vn;Oo++)Oo===0?(ii=Zs(J),bi=So(xe)):(ii=R((fA-ss[Oo])/2),bi=-Dl),C.push([At[Oo],ii,bi]),fA=ss[Oo]}else if(Ut==="left"){C=[],vn=At.length;for(var jl=0;jl<vn;jl++)C.push(At[jl])}else if(Ut==="justify"&&I0.encoding==="Identity-H"){C=[],vn=At.length,Zt=Zt!==0?Zt:O0;for(var Io=0,Ia=0;Ia<vn;Ia++)if(bi=Ia===0?So(xe):-Dl,ii=Ia===0?Zs(J):Io,Ia<vn-1){var mu=R((Zt-ss[Ia])/(At[Ia].split(" ").length-1)),si=At[Ia].split(" ");C.push([si[0]+" ",ii,bi]),Io=0;for(var os=1;os<si.length;os++){var Ll=(wc(si[os-1]+" "+si[os])-wc(si[os]))*eo+mu;os==si.length-1?C.push([si[os],Ll,0]):C.push([si[os]+" ",Ll,0]),Io-=Ll}}else C.push([At[Ia],ii,bi]);C.push(["",Io,0])}else{if(Ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],vn=At.length,Zt=Zt!==0?Zt:O0,Ia=0;Ia<vn;Ia++)bi=Ia===0?So(xe):-Dl,ii=Ia===0?Zs(J):0,Ia<vn-1?uA.push(_(R((Zt-ss[Ia])/(At[Ia].split(" ").length-1)))):uA.push(0),C.push([At[Ia],ii,bi])}}var N0=typeof Ce.R2L=="boolean"?Ce.R2L:lt;N0===!0&&(C=du(C,function(ea,ta,Na){return[ea.split("").reverse().join(""),ta,Na]})),Xe={text:C,x:J,y:xe,options:Ce,mutex:{pdfEscape:tn,activeFontKey:ut,fonts:pr,activeFontSize:et}},wr.publish("postProcessText",Xe),C=Xe.text,ks=Xe.mutex.isHex||!1;var gu=pr[ut].encoding;gu!=="WinAnsiEncoding"&&gu!=="StandardEncoding"||(C=du(C,function(ea,ta,Na){return[S0(ea),ta,Na]})),At=lu(C),C=[];for(var Ec,_c,pA,bc=0,Ul=1,Cc=Array.isArray(At[0])?Ul:bc,hA="",xu=function(ea,ta,Na){var rn="";return Na instanceof kt?(Na=typeof Ce.angle=="number"?ai(Na,new kt(1,0,0,1,ea,ta)):ai(new kt(1,0,0,1,ea,ta),Na),E===v.ADVANCED&&(Na=ai(new kt(1,0,0,-1,0,0),Na)),rn=Na.join(" ")+` Tm
`):rn=_(ea)+" "+_(ta)+` Td
`,rn},As=0;As<At.length;As++){switch(hA="",Cc){case Ul:pA=(ks?"<":"(")+At[As][0]+(ks?">":")"),Ec=parseFloat(At[As][1]),_c=parseFloat(At[As][2]);break;case bc:pA=(ks?"<":"(")+At[As]+(ks?">":")"),Ec=Zs(J),_c=So(xe)}uA!==void 0&&uA[As]!==void 0&&(hA=uA[As]+` Tw
`),As===0?C.push(hA+xu(Ec,_c,ya)+pA):Cc===bc?C.push(hA+pA):Cc===Ul&&C.push(hA+xu(Ec,_c,ya)+pA)}C=Cc===bc?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var cs=`BT
/`;return cs+=ut+" "+et+` Tf
`,cs+=_(et*Ui)+` TL
`,cs+=yc+`
`,cs+=dn,cs+=C,le(cs+="ET"),p[ut]=!0,qa};var Hm=u.__private__.clip=u.clip=function(C){return le(C==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return Hm("evenodd")},u.__private__.discardPath=u.discardPath=function(){return le("n"),this};var Js=u.__private__.isValidStyle=function(C){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(J=!0),J};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(C){return Js(C)&&(l=C),this};var y0=u.__private__.getStyle=u.getStyle=function(C){var J=l;switch(C){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=C}return J},v0=u.close=function(){return le("h"),this};u.stroke=function(){return le("S"),this},u.fill=function(C){return Cl("f",C),this},u.fillEvenOdd=function(C){return Cl("f*",C),this},u.fillStroke=function(C){return Cl("B",C),this},u.fillStrokeEvenOdd=function(C){return Cl("B*",C),this};var Cl=function(C,J){Jr(J)==="object"?zm(J,C):le(C)},eu=function(C){C===null||E===v.ADVANCED&&C===void 0||(C=y0(C),le(C))};function Gm(C,J,xe,Ce,Pe){var Xe=new wd(J||this.boundingBox,xe||this.xStep,Ce||this.yStep,this.gState,Pe||this.matrix);Xe.stream=this.stream;var At=C+"$$"+this.cloneIndex+++"$$";return Za(At,Xe),Xe}var zm=function(C,J){var xe=ln[C.key],Ce=rr[xe];if(Ce instanceof Lc)le("q"),le(Vm(J)),Ce.gState&&u.setGState(Ce.gState),le(C.matrix.toString()+" cm"),le("/"+xe+" sh"),le("Q");else if(Ce instanceof wd){var Pe=new kt(1,0,0,-1,0,dA());C.matrix&&(Pe=Pe.multiply(C.matrix||Ja),xe=Gm.call(Ce,C.key,C.boundingBox,C.xStep,C.yStep,Pe).id),le("q"),le("/Pattern cs"),le("/"+xe+" scn"),Ce.gState&&u.setGState(Ce.gState),le(J),le("Q")}},Vm=function(C){switch(C){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},tu=u.moveTo=function(C,J){return le(_(R(C))+" "+_(N(J))+" m"),this},gc=u.lineTo=function(C,J){return le(_(R(C))+" "+_(N(J))+" l"),this},cA=u.curveTo=function(C,J,xe,Ce,Pe,Xe){return le([_(R(C)),_(N(J)),_(R(xe)),_(N(Ce)),_(R(Pe)),_(N(Xe)),"c"].join(" ")),this};u.__private__.line=u.line=function(C,J,xe,Ce,Pe){if(isNaN(C)||isNaN(J)||isNaN(xe)||isNaN(Ce)||!Js(Pe))throw new Error("Invalid arguments passed to jsPDF.line");return E===v.COMPAT?this.lines([[xe-C,Ce-J]],C,J,[1,1],Pe||"S"):this.lines([[xe-C,Ce-J]],C,J,[1,1]).stroke()},u.__private__.lines=u.lines=function(C,J,xe,Ce,Pe,Xe){var At,Tt,Ut,ar,Zt,Er,ha,ya,qa,kn,dn,ks;if(typeof C=="number"&&(ks=xe,xe=J,J=C,C=ks),Ce=Ce||[1,1],Xe=Xe||!1,isNaN(J)||isNaN(xe)||!Array.isArray(C)||!Array.isArray(Ce)||!Js(Pe)||typeof Xe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(tu(J,xe),At=Ce[0],Tt=Ce[1],ar=C.length,kn=J,dn=xe,Ut=0;Ut<ar;Ut++)(Zt=C[Ut]).length===2?(kn=Zt[0]*At+kn,dn=Zt[1]*Tt+dn,gc(kn,dn)):(Er=Zt[0]*At+kn,ha=Zt[1]*Tt+dn,ya=Zt[2]*At+kn,qa=Zt[3]*Tt+dn,kn=Zt[4]*At+kn,dn=Zt[5]*Tt+dn,cA(Er,ha,ya,qa,kn,dn));return Xe&&v0(),eu(Pe),this},u.path=function(C){for(var J=0;J<C.length;J++){var xe=C[J],Ce=xe.c;switch(xe.op){case"m":tu(Ce[0],Ce[1]);break;case"l":gc(Ce[0],Ce[1]);break;case"c":cA.apply(this,Ce);break;case"h":v0()}}return this},u.__private__.rect=u.rect=function(C,J,xe,Ce,Pe){if(isNaN(C)||isNaN(J)||isNaN(xe)||isNaN(Ce)||!Js(Pe))throw new Error("Invalid arguments passed to jsPDF.rect");return E===v.COMPAT&&(Ce=-Ce),le([_(R(C)),_(N(J)),_(R(xe)),_(R(Ce)),"re"].join(" ")),eu(Pe),this},u.__private__.triangle=u.triangle=function(C,J,xe,Ce,Pe,Xe,At){if(isNaN(C)||isNaN(J)||isNaN(xe)||isNaN(Ce)||isNaN(Pe)||isNaN(Xe)||!Js(At))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[xe-C,Ce-J],[Pe-xe,Xe-Ce],[C-Pe,J-Xe]],C,J,[1,1],At,!0),this},u.__private__.roundedRect=u.roundedRect=function(C,J,xe,Ce,Pe,Xe,At){if(isNaN(C)||isNaN(J)||isNaN(xe)||isNaN(Ce)||isNaN(Pe)||isNaN(Xe)||!Js(At))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Tt=4/3*(Math.SQRT2-1);return Pe=Math.min(Pe,.5*xe),Xe=Math.min(Xe,.5*Ce),this.lines([[xe-2*Pe,0],[Pe*Tt,0,Pe,Xe-Xe*Tt,Pe,Xe],[0,Ce-2*Xe],[0,Xe*Tt,-Pe*Tt,Xe,-Pe,Xe],[2*Pe-xe,0],[-Pe*Tt,0,-Pe,-Xe*Tt,-Pe,-Xe],[0,2*Xe-Ce],[0,-Xe*Tt,Pe*Tt,-Xe,Pe,-Xe]],C+Pe,J,[1,1],At,!0),this},u.__private__.ellipse=u.ellipse=function(C,J,xe,Ce,Pe){if(isNaN(C)||isNaN(J)||isNaN(xe)||isNaN(Ce)||!Js(Pe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Xe=4/3*(Math.SQRT2-1)*xe,At=4/3*(Math.SQRT2-1)*Ce;return tu(C+xe,J),cA(C+xe,J-At,C+Xe,J-Ce,C,J-Ce),cA(C-Xe,J-Ce,C-xe,J-At,C-xe,J),cA(C-xe,J+At,C-Xe,J+Ce,C,J+Ce),cA(C+Xe,J+Ce,C+xe,J+At,C+xe,J),eu(Pe),this},u.__private__.circle=u.circle=function(C,J,xe,Ce){if(isNaN(C)||isNaN(J)||isNaN(xe)||!Js(Ce))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,J,xe,xe,Ce)},u.setFont=function(C,J,xe){return xe&&(J=I(J,xe)),ut=Co(C,J,{disableWarning:!1}),this};var $m=u.__private__.getFont=u.getFont=function(){return pr[Co.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var C,J,xe={};for(C in vt)if(vt.hasOwnProperty(C))for(J in xe[C]=[],vt[C])vt[C].hasOwnProperty(J)&&xe[C].push(J);return xe},u.addFont=function(C,J,xe,Ce,Pe){var Xe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Xe.indexOf(arguments[3])!==-1?Pe=arguments[3]:arguments[3]&&Xe.indexOf(arguments[3])==-1&&(xe=I(xe,Ce)),Pe=Pe||"Identity-H",Ns.call(this,C,J,xe,Pe)};var xc,ru=e.lineWidth||.200025,Bl=u.__private__.getLineWidth=u.getLineWidth=function(){return ru},w0=u.__private__.setLineWidth=u.setLineWidth=function(C){return ru=C,le(_(R(C))+" w"),this};u.__private__.setLineDash=Ht.API.setLineDash=Ht.API.setLineDashPattern=function(C,J){if(C=C||[],J=J||0,isNaN(J)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(xe){return _(R(xe))}).join(" "),J=_(R(J)),le("["+C+"] "+J+" d"),this};var E0=u.__private__.getLineHeight=u.getLineHeight=function(){return et*xc};u.__private__.getLineHeight=u.getLineHeight=function(){return et*xc};var _0=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(xc=C),this},b0=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return xc};_0(e.lineHeight);var Zs=u.__private__.getHorizontalCoordinate=function(C){return R(C)},So=u.__private__.getVerticalCoordinate=function(C){return E===v.ADVANCED?C:Gt[k].mediaBox.topRightY-Gt[k].mediaBox.bottomLeftY-R(C)},Ym=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(C){return _(Zs(C))},lA=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(C){return _(So(C))},Rs=e.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return se(Rs)},u.__private__.setStrokeColor=u.setDrawColor=function(C,J,xe,Ce){return Rs=ce({ch1:C,ch2:J,ch3:xe,ch4:Ce,pdfColorType:"draw",precision:2}),le(Rs),this};var au=e.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return se(au)},u.__private__.setFillColor=u.setFillColor=function(C,J,xe,Ce){return au=ce({ch1:C,ch2:J,ch3:xe,ch4:Ce,pdfColorType:"fill",precision:2}),le(au),this};var yc=e.textColor||"0 g",Wm=u.__private__.getTextColor=u.getTextColor=function(){return se(yc)};u.__private__.setTextColor=u.setTextColor=function(C,J,xe,Ce){return yc=ce({ch1:C,ch2:J,ch3:xe,ch4:Ce,pdfColorType:"text",precision:3}),this};var Sl=e.charSpace,Xm=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(Sl||0)};u.__private__.setCharSpace=u.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Sl=C,this};var nu=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(C){var J=u.CapJoinStyles[C];if(J===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return nu=J,le(J+" J"),this};var iu=0;u.__private__.setLineJoin=u.setLineJoin=function(C){var J=u.CapJoinStyles[C];if(J===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return iu=J,le(J+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(_(R(C))+" M"),this},u.GState=Qh,u.setGState=function(C){(C=typeof C=="string"?kr[ri[C]]:C0(null,C)).equals(Di)||(le("/"+C.id+" gs"),Di=C)};var C0=function(C,J){if(!C||!ri[C]){var xe=!1;for(var Ce in kr)if(kr.hasOwnProperty(Ce)&&kr[Ce].equals(J)){xe=!0;break}if(xe)J=kr[Ce];else{var Pe="GS"+(Object.keys(kr).length+1).toString(10);kr[Pe]=J,J.id=Pe}return C&&(ri[C]=J.id),wr.publish("addGState",J),J}};u.addGState=function(C,J){return C0(C,J),this},u.saveGraphicsState=function(){return le("q"),Tr.push({key:ut,size:et,color:yc}),this},u.restoreGraphicsState=function(){le("Q");var C=Tr.pop();return ut=C.key,et=C.size,yc=C.color,Di=null,this},u.setCurrentTransformationMatrix=function(C){return le(C.toString()+" cm"),this},u.comment=function(C){return le("#"+C),this};var Tl=function(C,J){var xe=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return xe},set:function(Xe){isNaN(Xe)||(xe=parseFloat(Xe))}});var Ce=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ce},set:function(Xe){isNaN(Xe)||(Ce=parseFloat(Xe))}});var Pe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Pe},set:function(Xe){Pe=Xe.toString()}}),this},su=function(C,J,xe,Ce){Tl.call(this,C,J),this.type="rect";var Pe=xe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Pe},set:function(At){isNaN(At)||(Pe=parseFloat(At))}});var Xe=Ce||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Xe},set:function(At){isNaN(At)||(Xe=parseFloat(At))}}),this},ou=function(){this.page=Dr,this.currentPage=k,this.pages=ve.slice(0),this.pagesContext=Gt.slice(0),this.x=vr,this.y=Rt,this.matrix=Gr,this.width=vc(k),this.height=dA(k),this.outputDestination=Ke,this.id="",this.objectNumber=-1};ou.prototype.restore=function(){Dr=this.page,k=this.currentPage,Gt=this.pagesContext,ve=this.pages,vr=this.x,Rt=this.y,Gr=this.matrix,Au(k,this.width),cu(k,this.height),Ke=this.outputDestination};var B0=function(C,J,xe,Ce,Pe){vi.push(new ou),Dr=k=0,ve=[],vr=C,Rt=J,Gr=Pe,oA([xe,Ce])},Jm=function(C){if(yi[C])vi.pop().restore();else{var J=new ou,xe="Xo"+(Object.keys(ga).length+1).toString(10);J.id=xe,yi[C]=xe,ga[xe]=J,wr.publish("addFormObject",J),vi.pop().restore()}};for(var Ol in u.beginFormObject=function(C,J,xe,Ce,Pe){return B0(C,J,xe,Ce,Pe),this},u.endFormObject=function(C){return Jm(C),this},u.doFormObject=function(C,J){var xe=ga[yi[C]];return le("q"),le(J.toString()+" cm"),le("/"+xe.id+" Do"),le("Q"),this},u.getFormObject=function(C){var J=ga[yi[C]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},u.save=function(C,J){return C=C||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(Dc(_l(Bo()),C),typeof Dc.unload=="function"&&Vt.setTimeout&&setTimeout(Dc.unload,911),this):new Promise(function(xe,Ce){try{var Pe=Dc(_l(Bo()),C);typeof Dc.unload=="function"&&Vt.setTimeout&&setTimeout(Dc.unload,911),xe(Pe)}catch(Xe){Ce(Xe.message)}})},Ht.API)Ht.API.hasOwnProperty(Ol)&&(Ol==="events"&&Ht.API.events.length?function(C,J){var xe,Ce,Pe;for(Pe=J.length-1;Pe!==-1;Pe--)xe=J[Pe][0],Ce=J[Pe][1],C.subscribe.apply(C,[xe].concat(typeof Ce=="function"?[Ce]:Ce))}(wr,Ht.API.events):u[Ol]=Ht.API[Ol]);var vc=u.getPageWidth=function(C){return(Gt[C=C||k].mediaBox.topRightX-Gt[C].mediaBox.bottomLeftX)/ct},Au=u.setPageWidth=function(C,J){Gt[C].mediaBox.topRightX=J*ct+Gt[C].mediaBox.bottomLeftX},dA=u.getPageHeight=function(C){return(Gt[C=C||k].mediaBox.topRightY-Gt[C].mediaBox.bottomLeftY)/ct},cu=u.setPageHeight=function(C,J){Gt[C].mediaBox.topRightY=J*ct+Gt[C].mediaBox.bottomLeftY};return u.internal={pdfEscape:tn,getStyle:y0,getFont:$m,getFontSize:_e,getCharSpace:Xm,getTextColor:Wm,getLineHeight:E0,getLineHeightFactor:b0,getLineWidth:Bl,write:He,getHorizontalCoordinate:Zs,getVerticalCoordinate:So,getCoordinateString:Ym,getVerticalCoordinateString:lA,collections:{},newObject:ca,newAdditionalObject:Ae,newObjectDeferred:ge,newObjectDeferredBegin:H,getFilters:Se,putStream:Me,events:wr,scaleFactor:ct,pageSize:{getWidth:function(){return vc(k)},setWidth:function(C){Au(k,C)},getHeight:function(){return dA(k)},setHeight:function(C){cu(k,C)}},encryptionOptions:d,encryption:Rn,getEncryptor:qm,output:bl,getNumberOfPages:bo,pages:ve,out:le,f2:M,f3:T,getPageInfo:x0,getPageInfoByObjId:Jt,getCurrentPageInfo:Km,getPDFVersion:h,Point:Tl,Rectangle:su,Matrix:kt,hasHotfix:g0},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return vc(k)},set:function(C){Au(k,C)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return dA(k)},set:function(C){cu(k,C)},enumerable:!0,configurable:!0}),El.call(u,$e),ut="F1",AA(n,r),wr.publish("initialized"),u}pd.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},pd.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},pd.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},pd.prototype.processOwnerPassword=function(e,t){return Fx(Nx(t).substr(0,5),e)},pd.prototype.encryptor=function(e,t){var r=Nx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return Fx(r,a)}},Qh.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Jr(e)!==Jr(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},Ht.API={events:[]},Ht.version="2.5.2";var _a=Ht.API,By=1,wl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Yl=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},tr=function(e){return e.toFixed(2)},SA=function(e){return e.toFixed(5)};_a.__acroform__={};var ki=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},uw=function(e){return e*By},oo=function(e){var t=new UC,r=Ft.internal.getHeight(e)||0,a=Ft.internal.getWidth(e)||0;return t.BBox=[0,0,Number(tr(a)),Number(tr(r))],t},KP=_a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},HP=_a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},GP=_a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},ja=_a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return GP(e,t-1)},La=_a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return KP(e,t-1)},Ua=_a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return HP(e,t-1)},zP=_a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],o=e[2],A=e[3],c={};return c.lowerLeft_X=r(n)||0,c.lowerLeft_Y=a(s+A)||0,c.upperRight_X=r(n+o)||0,c.upperRight_Y=a(s)||0,[Number(tr(c.lowerLeft_X)),Number(tr(c.lowerLeft_Y)),Number(tr(c.upperRight_X)),Number(tr(c.upperRight_Y))]},VP=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=Rx(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+tr(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=oo(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Rx=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(T){return T.split(`
`)}):n.map(function(T){return[T]});var s=r,o=Ft.internal.getHeight(e)||0;o=o<0?-o:o;var A=Ft.internal.getWidth(e)||0;A=A<0?-A:A;var c=function(T,R,L){if(T+1<n.length){var N=R+" "+n[T+1][0];return gp(N,e,L).width<=A-4}return!1};s++;e:for(;s>0;){t="",s--;var l,d,f=gp("3",e,s).height,p=e.multiline?o-s:(o-f)/2,u=p+=2,g=0,h=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+gp(t,e,s=12).width+", FieldWidth:"+A+`
`;break}for(var x="",v=0,E=0;E<n.length;E++)if(n.hasOwnProperty(E)){var D=!1;if(n[E].length!==1&&y!==n[E].length-1){if((f+2)*(v+2)+2>o)continue e;x+=n[E][y],D=!0,h=E,E--}else{x=(x+=n[E][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var B=parseInt(E),I=c(B,x,s),_=E>=n.length-1;if(I&&!_){x+=" ",y=0;continue}if(I||_){if(_)h=B;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;h=B}}for(var S="",O=g;O<=h;O++){var M=n[O];if(e.multiline){if(O===h){S+=M[y]+" ",y=(y+1)%M.length;continue}if(O===g){S+=M[M.length-1]+" ";continue}}S+=M[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=gp(S,e,s).width,e.textAlign){case"right":l=A-d-2;break;case"center":l=(A-d)/2;break;case"left":default:l=2}t+=tr(l)+" "+tr(u)+` Td
`,t+="("+wl(S)+`) Tj
`,t+=-tr(l)+` 0 Td
`,u=-(s+2),d=0,g=D?h:h+1,v++,x=""}break}return a.text=t,a.fontSize=s,a},gp=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},$P={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},YP=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},WP=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),Jr(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete e[a]}},XP=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ys.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify($P)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");By=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new MC,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&YP(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var A=a[o],c=[],l=A.Rect;if(A.Rect&&(A.Rect=zP(A.Rect,n)),n.internal.newObjectDeferredBegin(A.objId,!0),A.DA=Ft.createDefaultAppearanceStream(A),Jr(A)==="object"&&typeof A.getKeyValueListForStream=="function"&&(c=A.getKeyValueListForStream()),A.Rect=l,A.hasAppearanceStream&&!A.appearanceStreamContent){var d=VP(A);c.push({key:"AP",value:"<</N "+d+">>"}),n.internal.acroformPlugin.xForms.push(d)}if(A.appearanceStreamContent){var f="";for(var p in A.appearanceStreamContent)if(A.appearanceStreamContent.hasOwnProperty(p)){var u=A.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var o in u)if(u.hasOwnProperty(o)){var g=u[o];typeof g=="function"&&(g=g.call(n,A)),f+="/"+o+" "+g+" ",n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g)}}else typeof(g=u)=="function"&&(g=g.call(n,A)),f+="/"+o+" "+g,n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:A.objId}),n.internal.out("endobj")}s&&WP(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},LC=_a.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(s!==0&&(n+=" "),Jr(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+wl(a(e[s].toString()))+")"):n+=e[s].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Wg=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+wl(a(e))+")"},uo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};uo.prototype.toString=function(){return this.objId+" 0 R"},uo.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},uo.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:LC(n,this.objId,this.scope)}):n instanceof uo?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var UC=function(){uo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ki(UC,uo);var MC=function(){uo.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wl(r(e))+")"}},set:function(r){e=r}})};ki(MC,uo);var Ys=function e(){uo.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ja(t,3)},set:function(x){x?this.F=La(t,3):this.F=Ua(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(x){a=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(x){a[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(x){a[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(x){a[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(x){a[3]=x}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof qh)return;s="FieldObject"+e.FieldNum++}var x=function(v){return v};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+wl(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var A="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return A},set:function(x){A=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/By:l},set:function(x){l=x}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(x){d=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof qh||this instanceof Zc))return Wg(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof mn?p:Wg(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof mn?x:x.substr(0,1)==="("?Yl(x.substr(1,x.length-2)):Yl(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?Yl(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof mn?"/"+x:x}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof mn?u:Wg(u,this.objId,this.scope)},set:function(x){x=x.toString(),u=this instanceof mn?x:x.substr(0,1)==="("?Yl(x.substr(1,x.length-2)):Yl(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?Yl(u.substr(1,u.length-1)):u},set:function(x){x=x.toString(),u=this instanceof mn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,h=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){x=!!x,h=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(x){g=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,1)},set:function(x){x?this.Ff=La(this.Ff,1):this.Ff=Ua(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,2)},set:function(x){x?this.Ff=La(this.Ff,2):this.Ff=Ua(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,3)},set:function(x){x?this.Ff=La(this.Ff,3):this.Ff=Ua(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};ki(Ys,uo);var Id=function(){Ys.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return LC(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=function(s,o,A){A||(A=1);for(var c,l=[];c=o.exec(s);)l.push(c[A]);return l}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,18)},set:function(r){r?this.Ff=La(this.Ff,18):this.Ff=Ua(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=La(this.Ff,19):this.Ff=Ua(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,20)},set:function(r){r?(this.Ff=La(this.Ff,20),t.sort()):this.Ff=Ua(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,22)},set:function(r){r?this.Ff=La(this.Ff,22):this.Ff=Ua(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,23)},set:function(r){r?this.Ff=La(this.Ff,23):this.Ff=Ua(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,27)},set:function(r){r?this.Ff=La(this.Ff,27):this.Ff=Ua(this.Ff,27)}}),this.hasAppearanceStream=!1};ki(Id,Ys);var Nd=function(){Id.call(this),this.fontName="helvetica",this.combo=!1};ki(Nd,Id);var Fd=function(){Nd.call(this),this.combo=!0};ki(Fd,Nd);var nh=function(){Fd.call(this),this.edit=!0};ki(nh,Fd);var mn=function(){Ys.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,15)},set:function(r){r?this.Ff=La(this.Ff,15):this.Ff=Ua(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,16)},set:function(r){r?this.Ff=La(this.Ff,16):this.Ff=Ua(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,17)},set:function(r){r?this.Ff=La(this.Ff,17):this.Ff=Ua(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,26)},set:function(r){r?this.Ff=La(this.Ff,26):this.Ff=Ua(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+wl(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){Jr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ki(mn,Ys);var ih=function(){mn.call(this),this.pushButton=!0};ki(ih,mn);var Rd=function(){mn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ki(Rd,mn);var qh=function(){var e,t;Ys.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(A){return A};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),a)o.push("/"+s+" ("+wl(n(a[s]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Jr(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ft.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ki(qh,Ys),Rd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Rd.prototype.createOption=function(e){var t=new qh;return t.Parent=this,t.optionName=e,this.Kids.push(t),JP.call(this.scope,t),t};var sh=function(){mn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ft.CheckBox.createAppearanceStream()};ki(sh,mn);var Zc=function(){Ys.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,13)},set:function(t){t?this.Ff=La(this.Ff,13):this.Ff=Ua(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,21)},set:function(t){t?this.Ff=La(this.Ff,21):this.Ff=Ua(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,23)},set:function(t){t?this.Ff=La(this.Ff,23):this.Ff=Ua(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,24)},set:function(t){t?this.Ff=La(this.Ff,24):this.Ff=Ua(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,25)},set:function(t){t?this.Ff=La(this.Ff,25):this.Ff=Ua(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,26)},set:function(t){t?this.Ff=La(this.Ff,26):this.Ff=Ua(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ki(Zc,Ys);var oh=function(){Zc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ja(this.Ff,14)},set:function(e){e?this.Ff=La(this.Ff,14):this.Ff=Ua(this.Ff,14)}}),this.password=!0};ki(oh,Zc);var Ft={CheckBox:{createAppearanceStream:function(){return{N:{On:Ft.CheckBox.YesNormal},D:{On:Ft.CheckBox.YesPushDown,Off:Ft.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=Rx(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+tr(Ft.internal.getWidth(e))+" "+tr(Ft.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+tr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=Ft.internal.getHeight(e),o=Ft.internal.getWidth(e),A=Rx(e,e.caption);return n.push("1 g"),n.push("0 0 "+tr(o)+" "+tr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+tr(o-1)+" "+tr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+tr(A.fontSize)+" Tf "+a),n.push(A.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+tr(Ft.internal.getWidth(e))+" "+tr(Ft.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Ft.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Ft.RadioButton.Circle.YesNormal,t.D[e]=Ft.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Ft.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+SA(Ft.internal.getWidth(e)/2)+" "+SA(Ft.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Ft.internal.Bezier_C).toFixed(5)),o=Number((a*Ft.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+SA(Ft.internal.getWidth(e)/2)+" "+SA(Ft.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+SA(Ft.internal.getWidth(e)/2)+" "+SA(Ft.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.getWidth(e)<=Ft.internal.getHeight(e)?Ft.internal.getWidth(e)/4:Ft.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Ft.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+SA(Ft.internal.getWidth(e)/2)+" "+SA(Ft.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Ft.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Ft.RadioButton.Cross.YesNormal,t.D[e]=Ft.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=oo(e);t.scope=e.scope;var r=[],a=Ft.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+tr(Ft.internal.getWidth(e)-2)+" "+tr(Ft.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(tr(a.x1.x)+" "+tr(a.x1.y)+" m"),r.push(tr(a.x2.x)+" "+tr(a.x2.y)+" l"),r.push(tr(a.x4.x)+" "+tr(a.x4.y)+" m"),r.push(tr(a.x3.x)+" "+tr(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=Ft.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+tr(Ft.internal.getWidth(e))+" "+tr(Ft.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+tr(Ft.internal.getWidth(e)-2)+" "+tr(Ft.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(tr(r.x1.x)+" "+tr(r.x1.y)+" m"),a.push(tr(r.x2.x)+" "+tr(r.x2.y)+" l"),a.push(tr(r.x4.x)+" "+tr(r.x4.y)+" m"),a.push(tr(r.x3.x)+" "+tr(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=oo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+tr(Ft.internal.getWidth(e))+" "+tr(Ft.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Ft.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Ft.internal.getWidth(e),r=Ft.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Ft.internal.getWidth=function(e){var t=0;return Jr(e)==="object"&&(t=uw(e.Rect[2])),t},Ft.internal.getHeight=function(e){var t=0;return Jr(e)==="object"&&(t=uw(e.Rect[3])),t};var JP=_a.addField=function(e){if(XP(this,e),!(e instanceof Ys))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};_a.AcroFormChoiceField=Id,_a.AcroFormListBox=Nd,_a.AcroFormComboBox=Fd,_a.AcroFormEditBox=nh,_a.AcroFormButton=mn,_a.AcroFormPushButton=ih,_a.AcroFormRadioButton=Rd,_a.AcroFormCheckBox=sh,_a.AcroFormTextField=Zc,_a.AcroFormPasswordField=oh,_a.AcroFormAppearance=Ft,_a.AcroForm={ChoiceField:Id,ListBox:Nd,ComboBox:Fd,EditBox:nh,Button:mn,PushButton:ih,RadioButton:Rd,CheckBox:sh,TextField:Zc,PasswordField:oh,Appearance:Ft},Ht.AcroForm={ChoiceField:Id,ListBox:Nd,ComboBox:Fd,EditBox:nh,Button:mn,PushButton:ih,RadioButton:Rd,CheckBox:sh,TextField:Zc,PasswordField:oh,Appearance:Ft};Ht.AcroForm;function PC(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(T,R){var L,N,P,U,V,ie=t;if((R=R||t)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(I(T))for(V in r)for(P=r[V],L=0;L<P.length;L+=1){for(U=!0,N=0;N<P[L].length;N+=1)if(P[L][N]!==void 0&&P[L][N]!==T[N]){U=!1;break}if(U===!0){ie=V;break}}else for(V in r)for(P=r[V],L=0;L<P.length;L+=1){for(U=!0,N=0;N<P[L].length;N+=1)if(P[L][N]!==void 0&&P[L][N]!==T.charCodeAt(N)){U=!1;break}if(U===!0){ie=V;break}}return ie===t&&R!==t&&(ie=R),ie},n=function T(R){for(var L=this.internal.write,N=this.internal.putStream,P=(0,this.internal.getFilters)();P.indexOf("FlateEncode")!==-1;)P.splice(P.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var U=[];if(U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Image"}),U.push({key:"Width",value:R.width}),U.push({key:"Height",value:R.height}),R.colorSpace===y.INDEXED?U.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(U.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===y.DEVICE_CMYK&&U.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),U.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&U.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var V="",ie=0,W=R.transparency.length;ie<W;ie++)V+=R.transparency[ie]+" "+R.transparency[ie]+" ";U.push({key:"Mask",value:"["+V+"]"})}R.sMask!==void 0&&U.push({key:"SMask",value:R.objectId+1+" 0 R"});var z=R.filter!==void 0?["/"+R.filter]:void 0;if(N({data:R.data,additionalKeyValues:U,alreadyAppliedFilters:z,objectId:R.objectId}),L("endobj"),"sMask"in R&&R.sMask!==void 0){var G="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,b={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:G,data:R.sMask};"filter"in R&&(b.filter=R.filter),T.call(this,b)}if(R.colorSpace===y.INDEXED){var k=this.internal.newObject();N({data:S(new Uint8Array(R.palette)),objectId:k}),L("endobj")}},s=function(){var T=this.internal.collections.addImage_images;for(var R in T)n.call(this,T[R])},o=function(){var T,R=this.internal.collections.addImage_images,L=this.internal.write;for(var N in R)L("/I"+(T=R[N]).index,T.objectId,"0","R")},A=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var T=this.internal.collections.addImage_images;return A.call(this),T},l=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(T){return typeof e["process"+T.toUpperCase()]=="function"},f=function(T){return Jr(T)==="object"&&T.nodeType===1},p=function(T,R){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var L=""+T.getAttribute("src");if(L.indexOf("data:image/")===0)return mf(unescape(L).split("base64,").pop());var N=e.loadFile(L,!0);if(N!==void 0)return N}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var P;switch(R){case"PNG":P="image/png";break;case"WEBP":P="image/webp";break;case"JPEG":case"JPG":default:P="image/jpeg"}return mf(T.toDataURL(P,1).split("base64,").pop())}},u=function(T){var R=this.internal.collections.addImage_images;if(R){for(var L in R)if(T===R[L].alias)return R[L]}},g=function(T,R,L){return T||R||(T=-96,R=-96),T<0&&(T=-1*L.width*72/T/this.internal.scaleFactor),R<0&&(R=-1*L.height*72/R/this.internal.scaleFactor),T===0&&(T=R*L.width/L.height),R===0&&(R=T*L.height/L.width),[T,R]},h=function(T,R,L,N,P,U){var V=g.call(this,L,N,P),ie=this.internal.getCoordinateString,W=this.internal.getVerticalCoordinateString,z=c.call(this);if(L=V[0],N=V[1],z[P.index]=P,U){U*=Math.PI/180;var G=Math.cos(U),b=Math.sin(U),k=function(q){return q.toFixed(4)},j=[k(G),k(b),k(-1*b),k(G),0,0,"cm"]}this.internal.write("q"),U?(this.internal.write([1,"0","0",1,ie(T),W(R+N),"cm"].join(" ")),this.internal.write(j.join(" ")),this.internal.write([ie(L),"0","0",ie(N),"0","0","cm"].join(" "))):this.internal.write([ie(L),"0","0",ie(N),ie(T),W(R+N),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+P.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(T){var R,L,N=0;if(typeof T=="string")for(L=T.length,R=0;R<L;R++)N=(N<<5)-N+T.charCodeAt(R),N|=0;else if(I(T))for(L=T.byteLength/2,R=0;R<L;R++)N=(N<<5)-N+T[R],N|=0;return N},E=e.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var R=!0;return T.length===0&&(R=!1),T.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(R=!1),R},D=e.__addimage__.extractImageFromDataUrl=function(T){var R=(T=T||"").split("base64,"),L=null;if(R.length===2){var N=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(R[0]);Array.isArray(N)&&(L={mimeType:N[1],charset:N[2],data:R[1]})}return L},B=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(T){return B()&&T instanceof ArrayBuffer};var I=e.__addimage__.isArrayBufferView=function(T){return B()&&typeof Uint32Array<"u"&&(T instanceof Int8Array||T instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array)},_=e.__addimage__.binaryStringToUint8Array=function(T){for(var R=T.length,L=new Uint8Array(R),N=0;N<R;N++)L[N]=T.charCodeAt(N);return L},S=e.__addimage__.arrayBufferToBinaryString=function(T){for(var R="",L=I(T)?T:new Uint8Array(T),N=0;N<L.length;N+=8192)R+=String.fromCharCode.apply(null,L.subarray(N,N+8192));return R};e.addImage=function(){var T,R,L,N,P,U,V,ie,W;if(typeof arguments[1]=="number"?(R=t,L=arguments[1],N=arguments[2],P=arguments[3],U=arguments[4],V=arguments[5],ie=arguments[6],W=arguments[7]):(R=arguments[1],L=arguments[2],N=arguments[3],P=arguments[4],U=arguments[5],V=arguments[6],ie=arguments[7],W=arguments[8]),Jr(T=arguments[0])==="object"&&!f(T)&&"imageData"in T){var z=T;T=z.imageData,R=z.format||R||t,L=z.x||L||0,N=z.y||N||0,P=z.w||z.width||P,U=z.h||z.height||U,V=z.alias||V,ie=z.compression||ie,W=z.rotation||z.angle||W}var G=this.internal.getFilters();if(ie===void 0&&G.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(L)||isNaN(N))throw new Error("Invalid coordinates passed to jsPDF.addImage");A.call(this);var b=O.call(this,T,R,V,ie);return h.call(this,L,N,P,U,b,W),this};var O=function(T,R,L,N){var P,U,V;if(typeof T=="string"&&a(T)===t){T=unescape(T);var ie=M(T,!1);(ie!==""||(ie=e.loadFile(T,!0))!==void 0)&&(T=ie)}if(f(T)&&(T=p(T,R)),R=a(T,R),!d(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((V=L)==null||V.length===0)&&(L=function(W){return typeof W=="string"||I(W)?v(W):I(W.data)?v(W.data):null}(T)),(P=u.call(this,L))||(B()&&(T instanceof Uint8Array||R==="RGBA"||(U=T,T=_(T))),P=this["process"+R.toUpperCase()](T,l.call(this),L,function(W){return W&&typeof W=="string"&&(W=W.toUpperCase()),W in e.image_compression?W:x.NONE}(N),U)),!P)throw new Error("An unknown error occurred whilst processing the image.");return P},M=e.__addimage__.convertBase64ToBinaryString=function(T,R){var L;R=typeof R!="boolean"||R;var N,P="";if(typeof T=="string"){N=(L=D(T))!==null?L.data:T;try{P=mf(N)}catch(U){if(R)throw E(N)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+U.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return P};e.getImageProperties=function(T){var R,L,N="";if(f(T)&&(T=p(T)),typeof T=="string"&&a(T)===t&&((N=M(T,!1))===""&&(N=e.loadFile(T)||""),T=N),L=a(T),!d(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(!B()||T instanceof Uint8Array||(T=_(T)),!(R=this["process"+L.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=L,R}})(Ht.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ht.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,s,o=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),l=r.pageContext.annotations,d=!1,f=0;f<l.length&&!d;f++)switch((a=l[f]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<l.length;p++){a=l[p];var u=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var h=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(h.objId),v=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+A(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+A(a.bounds.y)+"] ")+"/Contents ("+u(x(a.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+u(x(v))+") >>",h.content=s;var E=h.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+A(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+A(a.bounds.y)+"] ")+" /Parent "+E,a.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(h.objId,"0 R",y.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+A(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+A(a.bounds.y+a.bounds.h)+"] ";var D=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+u(g(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+D+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var B=this.annotations._nameMap[a.options.name];a.options.pageNumber=B.page,a.options.top=B.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+u(g(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var I=A(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+I+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,s,o){var A=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;A.pageContext.annotations.push({finalBounds:{x:c(r),y:l(a),w:c(r+n),h:l(a+s)},options:o,type:"link"})},e.textWithLink=function(r,a,n,s){var o,A,c=this.getTextWidth(r),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){A=s.maxWidth;var d=this.splitTextToSize(r,A).length;o=Math.ceil(l*d)}else A=c,o=l;return this.text(r,a,n,s),n+=.2*l,s.align==="center"&&(a-=c/2),s.align==="right"&&(a-=c),this.link(a,n-l,A,o,s),c},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(Ht.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(h){return t[h.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(h){return typeof h=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(h)},A=e.__arabicParser__.isArabicEndLetter=function(h){return o(h)&&s(h)&&t[h.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(h){return o(h)&&n.indexOf(h.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(h){return o(h)&&s(h)&&t[h.charCodeAt(0)].length>=1};var l=e.__arabicParser__.arabicLetterHasFinalForm=function(h){return o(h)&&s(h)&&t[h.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(h){return o(h)&&s(h)&&t[h.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(h){return o(h)&&s(h)&&t[h.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(h){var y=0,x=r,v="",E=0;for(y=0;y<h.length;y+=1)x[h.charCodeAt(y)]!==void 0?(E++,typeof(x=x[h.charCodeAt(y)])=="number"&&(v+=String.fromCharCode(x),x=r,E=0),y===h.length-1&&(x=r,v+=h.charAt(y-(E-1)),y-=E-1,E=0)):(x=r,v+=h.charAt(y-E),y-=E,E=0);return v};e.__arabicParser__.isArabicDiacritic=function(h){return h!==void 0&&a[h.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(h,y,x){return o(h)?s(h)===!1?-1:!l(h)||!o(y)&&!o(x)||!o(x)&&A(y)||A(h)&&!o(y)||A(h)&&c(y)||A(h)&&A(y)?0:d(h)&&o(y)&&!A(y)&&o(x)&&l(x)?3:A(h)||!o(x)?1:2:-1},u=function(h){var y=0,x=0,v=0,E="",D="",B="",I=(h=h||"").split("\\s+"),_=[];for(y=0;y<I.length;y+=1){for(_.push(""),x=0;x<I[y].length;x+=1)E=I[y][x],D=I[y][x-1],B=I[y][x+1],o(E)?(v=p(E,D,B),_[y]+=v!==-1?String.fromCharCode(t[E.charCodeAt(0)][v]):E):_[y]+=E;_[y]=f(_[y])}return _.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var h,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var v=0;for(x=[],v=0;v<y.length;v+=1)Array.isArray(y[v])?x.push([u(y[v][0]),y[v][1],y[v][2]]):x.push([u(y[v])]);h=x}else h=u(y);return typeof arguments[0]=="string"?h:(arguments[0].text=h,arguments[0])};e.events.push(["preProcessText",g])}(Ht.API),Ht.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(A){r=A}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(A){a=isNaN(A)||Number.isInteger(A)===!1||A<0?150:A,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(A){n=isNaN(A)||Number.isInteger(A)===!1||A<0?300:A,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(A){s=A}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(A){o=A}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ht.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(h){c=h}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(h){l=h}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(h){d=h}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(h){f=h}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(h){p=h}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(h){u=h}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(h){g=h}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,l){a.call(this);var d=(l=l||{}).fontSize||this.getFontSize(),f=l.font||this.getFont(),p=l.scaleFactor||this.internal.scaleFactor,u=0,g=0,h=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=l.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(E,D){return E.concat(y.splitTextToSize(D,x))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)u<(h=this.getStringUnitWidth(c[v],{font:f})*d)&&(u=h);return u!==0&&(g=c.length),{w:u/=p,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var l=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===c.lineNumber?(c.x=(l.x||0)+(l.width||0),c.y=l.y||0):l.y+l.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,u&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=l.y+l.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,l,d,f,p){if(a.call(this),!d)throw new Error("No data for PDF table.");var u,g,h,y,x=[],v=[],E=[],D={},B={},I=[],_=[],S=(p=p||{}).autoSize||!1,O=p.printHeaders!==!1,M=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,T=p.margins||Object.assign({width:this.getPageWidth()},t),R=typeof p.padding=="number"?p.padding:3,L=p.headerBackgroundColor||"#c8c8c8",N=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=N,this.setFontSize(M),f==null)v=x=Object.keys(d[0]),E=x.map(function(){return"left"});else if(Array.isArray(f)&&Jr(f[0])==="object")for(x=f.map(function(z){return z.name}),v=f.map(function(z){return z.prompt||z.name||""}),E=f.map(function(z){return z.align||"left"}),u=0;u<f.length;u+=1)B[f[u].name]=f[u].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(v=x=f,E=x.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(u=0;u<x.length;u+=1){for(D[y=x[u]]=d.map(function(z){return z[y]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(v[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=D[y],this.setFont(void 0,"normal"),h=0;h<g.length;h+=1)I.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[y]=Math.max.apply(null,I)+R+R,I=[]}if(O){var P={};for(u=0;u<x.length;u+=1)P[x[u]]={},P[x[u]].text=v[u],P[x[u]].align=E[u];var U=A.call(this,P,B);_=x.map(function(z){return new s(c,l,B[z],U,P[z].text,void 0,P[z].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var V=f.reduce(function(z,G){return z[G.name]=G.align,z},{});for(u=0;u<d.length;u+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:u,data:d[u]},this);var ie=A.call(this,d[u],B);for(h=0;h<x.length;h+=1){var W=d[u][x[h]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:u,col:h,data:W},this),o.call(this,new s(c,l,B[x[h]],ie,W,u+2,V[x[h]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=l,this};var A=function(c,l){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(u){var g=c[u];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,l[u]-d-d)},this).map(function(u){return this.getLineHeightFactor()*u.length*f/p+d+d},this).reduce(function(u,g){return Math.max(u,g)},0)};e.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,l){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){d=this.internal.__cell__.tableHeaderRow[u].clone(),l&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(Ht.API);var QC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],kx=PC(qC),KC=[100,200,300,400,500,600,700,800,900],ZP=PC(KC);function Dx(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return QC[s=s||"normal"]?s:"normal"}(e.style),a=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),n=function(s){return typeof kx[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function fw(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var e9={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},pw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function hw(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function t9(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},e9,r.genericFontFamilies||{}),s=null,o=null,A=0;A<t.length;++A)if(n[(s=Dx(t[A])).family]&&(s.family=n[s.family]),e.hasOwnProperty(s.family)){o=e[s.family];break}if(!(o=o||e[a]))throw new Error("Could not find a font-family for the rule '"+hw(s)+"' and default family '"+a+"'.");if(o=function(c,l){if(l[c])return l[c];var d=kx[c],f=d<=kx.normal?-1:1,p=fw(l,qC,d,f);if(!p)throw new Error("Could not find a matching font-stretch value for "+c);return p}(s.stretch,o),o=function(c,l){if(l[c])return l[c];for(var d=QC[c],f=0;f<d.length;++f)if(l[d[f]])return l[d[f]];throw new Error("Could not find a matching font-style for "+c)}(s.style,o),!(o=function(c,l){if(l[c])return l[c];if(c===400&&l[500])return l[500];if(c===500&&l[400])return l[400];var d=ZP[c],f=fw(l,KC,d,c<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+c);return f}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+hw(s)+"'.");return o}function mw(e){return e.trimLeft()}function r9(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function a9(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var xp,gw,xw,Xg=["times"];(function(e){var t,r,a,n,s,o,A,c,l,d=function(b){return b=b||{},this.isStrokeTransparent=b.isStrokeTransparent||!1,this.strokeOpacity=b.strokeOpacity||1,this.strokeStyle=b.strokeStyle||"#000000",this.fillStyle=b.fillStyle||"#000000",this.isFillTransparent=b.isFillTransparent||!1,this.fillOpacity=b.fillOpacity||1,this.font=b.font||"10px sans-serif",this.textBaseline=b.textBaseline||"alphabetic",this.textAlign=b.textAlign||"left",this.lineWidth=b.lineWidth||1,this.lineJoin=b.lineJoin||"miter",this.lineCap=b.lineCap||"butt",this.path=b.path||[],this.transform=b.transform!==void 0?b.transform.clone():new c,this.globalCompositeOperation=b.globalCompositeOperation||"normal",this.globalAlpha=b.globalAlpha||1,this.clip_path=b.clip_path||[],this.currentPoint=b.currentPoint||new o,this.miterLimit=b.miterLimit||10,this.lastPoint=b.lastPoint||new o,this.lineDashOffset=b.lineDashOffset||0,this.lineDash=b.lineDash||[],this.margin=b.margin||[0,0,0,0],this.prevPageLastElemOffset=b.prevPageLastElemOffset||0,this.ignoreClearRect=typeof b.ignoreClearRect!="boolean"||b.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,A=this.internal.Rectangle,c=this.internal.Matrix,l=new d}]);var f=function(b){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var k=b;Object.defineProperty(this,"pdf",{get:function(){return k}});var j=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return j},set:function(me){j=!!me}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(me){q=!!me}});var Y=0;Object.defineProperty(this,"posX",{get:function(){return Y},set:function(me){isNaN(me)||(Y=me)}});var de=0;Object.defineProperty(this,"posY",{get:function(){return de},set:function(me){isNaN(me)||(de=me)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(me){var le;typeof me=="number"?le=[me,me,me,me]:((le=new Array(4))[0]=me[0],le[1]=me.length>=2?me[1]:le[0],le[2]=me.length>=3?me[2]:le[0],le[3]=me.length>=4?me[3]:le[1]),l.margin=le}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(me){ue=me}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(me){pe=me}});var ye=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ye},set:function(me){ye=me}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(me){me instanceof d&&(l=me)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(me){l.path=me}});var ve=[];Object.defineProperty(this,"ctxStack",{get:function(){return ve},set:function(me){ve=me}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(me){var le;le=p(me),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(me){var le=p(me);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(me){["butt","round","square"].indexOf(me)!==-1&&(this.ctx.lineCap=me,this.pdf.setLineCap(me))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(me){isNaN(me)||(this.ctx.lineWidth=me,this.pdf.setLineWidth(me))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(me){["bevel","round","miter"].indexOf(me)!==-1&&(this.ctx.lineJoin=me,this.pdf.setLineJoin(me))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(me){isNaN(me)||(this.ctx.miterLimit=me,this.pdf.setMiterLimit(me))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(me){this.ctx.textBaseline=me}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(me){["right","end","center","left","start"].indexOf(me)!==-1&&(this.ctx.textAlign=me)}});var ae=null;function Ke(me,le){if(ae===null){var He=function(Ze){var $e=[];return Object.keys(Ze).forEach(function(et){Ze[et].forEach(function(je){var _e=null;switch(je){case"bold":_e={family:et,weight:"bold"};break;case"italic":_e={family:et,style:"italic"};break;case"bolditalic":_e={family:et,weight:"bold",style:"italic"};break;case"":case"normal":_e={family:et}}_e!==null&&(_e.ref={name:et,style:je},$e.push(_e))})}),$e}(me.getFontList());ae=function(Ze){for(var $e={},et=0;et<Ze.length;++et){var je=Dx(Ze[et]),_e=je.family,lt=je.stretch,Ct=je.style,bt=je.weight;$e[_e]=$e[_e]||{},$e[_e][lt]=$e[_e][lt]||{},$e[_e][lt][Ct]=$e[_e][lt][Ct]||{},$e[_e][lt][Ct][bt]=je}return $e}(He.concat(le))}return ae}var Ee=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ee},set:function(me){ae=null,Ee=me}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(me){var le;if(this.ctx.font=me,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(me))!==null){var He=le[1],Ze=(le[2],le[3]),$e=le[4],et=(le[5],le[6]),je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec($e)[2];$e=Math.floor(je==="px"?parseFloat($e)*this.pdf.internal.scaleFactor:je==="em"?parseFloat($e)*this.pdf.getFontSize():parseFloat($e)*this.pdf.internal.scaleFactor),this.pdf.setFontSize($e);var _e=function(Bt){var ut,ct,vr=[],Rt=Bt.trim();if(Rt==="")return Xg;if(Rt in pw)return[pw[Rt]];for(;Rt!=="";){switch(ct=null,ut=(Rt=mw(Rt)).charAt(0)){case'"':case"'":ct=r9(Rt.substring(1),ut);break;default:ct=a9(Rt)}if(ct===null||(vr.push(ct[0]),(Rt=mw(ct[1]))!==""&&Rt.charAt(0)!==","))return Xg;Rt=Rt.replace(/^,/,"")}return vr}(et);if(this.fontFaces){var lt=t9(Ke(this.pdf,this.fontFaces),_e.map(function(Bt){return{family:Bt,stretch:"normal",weight:Ze,style:He}}));this.pdf.setFont(lt.ref.name,lt.ref.style)}else{var Ct="";(Ze==="bold"||parseInt(Ze,10)>=700||He==="bold")&&(Ct="bold"),He==="italic"&&(Ct+="italic"),Ct.length===0&&(Ct="normal");for(var bt="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Mt=0;Mt<_e.length;Mt++){if(this.pdf.internal.getFont(_e[Mt],Ct,{noFallback:!0,disableWarning:!0})!==void 0){bt=_e[Mt];break}if(Ct==="bolditalic"&&this.pdf.internal.getFont(_e[Mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=_e[Mt],Ct="bold";else if(this.pdf.internal.getFont(_e[Mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=_e[Mt],Ct="normal";break}}if(bt===""){for(var Dt=0;Dt<_e.length;Dt++)if(Et[_e[Dt]]){bt=Et[_e[Dt]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,Ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(me){this.ctx.globalCompositeOperation=me}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(me){this.ctx.globalAlpha=me}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(me){this.ctx.lineDashOffset=me,G.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(me){this.ctx.lineDash=me,G.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(me){this.ctx.ignoreClearRect=!!me}})};f.prototype.setLineDash=function(b){this.lineDash=b},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){D.call(this,"fill",!1)},f.prototype.stroke=function(){D.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(b,k){if(isNaN(b)||isNaN(k))throw $r.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var j=this.ctx.transform.applyToPoint(new o(b,k));this.path.push({type:"mt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(b,k)},f.prototype.closePath=function(){var b=new o(0,0),k=0;for(k=this.path.length-1;k!==-1;k--)if(this.path[k].type==="begin"&&Jr(this.path[k+1])==="object"&&typeof this.path[k+1].x=="number"){b=new o(this.path[k+1].x,this.path[k+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(b.x,b.y)},f.prototype.lineTo=function(b,k){if(isNaN(b)||isNaN(k))throw $r.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var j=this.ctx.transform.applyToPoint(new o(b,k));this.path.push({type:"lt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(j.x,j.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),D.call(this,null,!0)},f.prototype.quadraticCurveTo=function(b,k,j,q){if(isNaN(j)||isNaN(q)||isNaN(b)||isNaN(k))throw $r.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Y=this.ctx.transform.applyToPoint(new o(j,q)),de=this.ctx.transform.applyToPoint(new o(b,k));this.path.push({type:"qct",x1:de.x,y1:de.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new o(Y.x,Y.y)},f.prototype.bezierCurveTo=function(b,k,j,q,Y,de){if(isNaN(Y)||isNaN(de)||isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q))throw $r.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new o(Y,de)),pe=this.ctx.transform.applyToPoint(new o(b,k)),ye=this.ctx.transform.applyToPoint(new o(j,q));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:ye.x,y2:ye.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new o(ue.x,ue.y)},f.prototype.arc=function(b,k,j,q,Y,de){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q)||isNaN(Y))throw $r.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(de=!!de,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new o(b,k));b=ue.x,k=ue.y;var pe=this.ctx.transform.applyToPoint(new o(0,j)),ye=this.ctx.transform.applyToPoint(new o(0,0));j=Math.sqrt(Math.pow(pe.x-ye.x,2)+Math.pow(pe.y-ye.y,2))}Math.abs(Y-q)>=2*Math.PI&&(q=0,Y=2*Math.PI),this.path.push({type:"arc",x:b,y:k,radius:j,startAngle:q,endAngle:Y,counterclockwise:de})},f.prototype.arcTo=function(b,k,j,q,Y){throw new Error("arcTo not implemented.")},f.prototype.rect=function(b,k,j,q){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q))throw $r.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(b,k),this.lineTo(b+j,k),this.lineTo(b+j,k+q),this.lineTo(b,k+q),this.lineTo(b,k),this.lineTo(b+j,k),this.lineTo(b,k)},f.prototype.fillRect=function(b,k,j,q){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q))throw $r.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var Y={};this.lineCap!=="butt"&&(Y.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Y.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(b,k,j,q),this.fill(),Y.hasOwnProperty("lineCap")&&(this.lineCap=Y.lineCap),Y.hasOwnProperty("lineJoin")&&(this.lineJoin=Y.lineJoin)}},f.prototype.strokeRect=function(b,k,j,q){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q))throw $r.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(b,k,j,q),this.stroke())},f.prototype.clearRect=function(b,k,j,q){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q))throw $r.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(b,k,j,q))},f.prototype.save=function(b){b=typeof b!="boolean"||b;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("q");if(this.pdf.setPage(k),b){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},f.prototype.restore=function(b){b=typeof b!="boolean"||b;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("Q");this.pdf.setPage(k),b&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(b){var k,j,q,Y;if(b.isCanvasGradient===!0&&(b=b.getColor()),!b)return{r:0,g:0,b:0,a:0,style:b};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(b))k=0,j=0,q=0,Y=0;else{var de=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(b);if(de!==null)k=parseInt(de[1]),j=parseInt(de[2]),q=parseInt(de[3]),Y=1;else if((de=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(b))!==null)k=parseInt(de[1]),j=parseInt(de[2]),q=parseInt(de[3]),Y=parseFloat(de[4]);else{if(Y=1,typeof b=="string"&&b.charAt(0)!=="#"){var ue=new kC(b);b=ue.ok?ue.toHex():"#000000"}b.length===4?(k=b.substring(1,2),k+=k,j=b.substring(2,3),j+=j,q=b.substring(3,4),q+=q):(k=b.substring(1,3),j=b.substring(3,5),q=b.substring(5,7)),k=parseInt(k,16),j=parseInt(j,16),q=parseInt(q,16)}}return{r:k,g:j,b:q,a:Y,style:b}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(b,k,j,q){if(isNaN(k)||isNaN(j)||typeof b!="string")throw $r.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!u.call(this)){var Y=ie(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;R.call(this,{text:b,x:k,y:j,scale:de,angle:Y,align:this.textAlign,maxWidth:q})}},f.prototype.strokeText=function(b,k,j,q){if(isNaN(k)||isNaN(j)||typeof b!="string")throw $r.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){q=isNaN(q)?void 0:q;var Y=ie(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;R.call(this,{text:b,x:k,y:j,scale:de,renderingMode:"stroke",angle:Y,align:this.textAlign,maxWidth:q})}},f.prototype.measureText=function(b){if(typeof b!="string")throw $r.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var k=this.pdf,j=this.pdf.internal.scaleFactor,q=k.internal.getFontSize(),Y=k.getStringUnitWidth(b)*q/k.internal.scaleFactor,de=function(ue){var pe=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this};return new de({width:Y*=Math.round(96*j/72*1e4)/1e4})},f.prototype.scale=function(b,k){if(isNaN(b)||isNaN(k))throw $r.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var j=new c(b,0,0,k,0,0);this.ctx.transform=this.ctx.transform.multiply(j)},f.prototype.rotate=function(b){if(isNaN(b))throw $r.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var k=new c(Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0);this.ctx.transform=this.ctx.transform.multiply(k)},f.prototype.translate=function(b,k){if(isNaN(b)||isNaN(k))throw $r.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var j=new c(1,0,0,1,b,k);this.ctx.transform=this.ctx.transform.multiply(j)},f.prototype.transform=function(b,k,j,q,Y,de){if(isNaN(b)||isNaN(k)||isNaN(j)||isNaN(q)||isNaN(Y)||isNaN(de))throw $r.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new c(b,k,j,q,Y,de);this.ctx.transform=this.ctx.transform.multiply(ue)},f.prototype.setTransform=function(b,k,j,q,Y,de){b=isNaN(b)?1:b,k=isNaN(k)?0:k,j=isNaN(j)?0:j,q=isNaN(q)?1:q,Y=isNaN(Y)?0:Y,de=isNaN(de)?0:de,this.ctx.transform=new c(b,k,j,q,Y,de)};var h=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(b,k,j,q,Y,de,ue,pe,ye){var ve=this.pdf.getImageProperties(b),ae=1,Ke=1,Ee=1,me=1;q!==void 0&&pe!==void 0&&(Ee=pe/q,me=ye/Y,ae=ve.width/q*pe/q,Ke=ve.height/Y*ye/Y),de===void 0&&(de=k,ue=j,k=0,j=0),q!==void 0&&pe===void 0&&(pe=q,ye=Y),q===void 0&&pe===void 0&&(pe=ve.width,ye=ve.height);for(var le,He=this.ctx.transform.decompose(),Ze=ie(He.rotate.shx),$e=new c,et=($e=($e=($e=$e.multiply(He.translate)).multiply(He.skew)).multiply(He.scale)).applyToRectangle(new A(de-k*Ee,ue-j*me,q*ae,Y*Ke)),je=y.call(this,et),_e=[],lt=0;lt<je.length;lt+=1)_e.indexOf(je[lt])===-1&&_e.push(je[lt]);if(E(_e),this.autoPaging)for(var Ct=_e[0],bt=_e[_e.length-1],Et=Ct;Et<bt+1;Et++){this.pdf.setPage(Et);var Mt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Dt=Et===1?this.posY+this.margin[0]:this.margin[0],Bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ct=Et===1?0:Bt+(Et-2)*ut;if(this.ctx.clip_path.length!==0){var vr=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(le,this.posX+this.margin[3],-ct+Dt+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=vr}var Rt=JSON.parse(JSON.stringify(et));Rt=v([Rt],this.posX+this.margin[3],-ct+Dt+this.ctx.prevPageLastElemOffset)[0];var Gr=(Et>Ct||Et<bt)&&h.call(this);Gr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mt,ut,null).clip().discardPath()),this.pdf.addImage(b,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,Ze),Gr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(b,"JPEG",et.x,et.y,et.w,et.h,null,null,Ze)};var y=function(b,k,j){var q=[];k=k||this.pdf.internal.pageSize.width,j=j||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Y=this.posY+this.ctx.prevPageLastElemOffset;switch(b.type){default:case"mt":case"lt":q.push(Math.floor((b.y+Y)/j)+1);break;case"arc":q.push(Math.floor((b.y+Y-b.radius)/j)+1),q.push(Math.floor((b.y+Y+b.radius)/j)+1);break;case"qct":var de=W(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x,b.y);q.push(Math.floor((de.y+Y)/j)+1),q.push(Math.floor((de.y+de.h+Y)/j)+1);break;case"bct":var ue=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x2,b.y2,b.x,b.y);q.push(Math.floor((ue.y+Y)/j)+1),q.push(Math.floor((ue.y+ue.h+Y)/j)+1);break;case"rect":q.push(Math.floor((b.y+Y)/j)+1),q.push(Math.floor((b.y+b.h+Y)/j)+1)}for(var pe=0;pe<q.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<q[pe];)x.call(this);return q},x=function(){var b=this.fillStyle,k=this.strokeStyle,j=this.font,q=this.lineCap,Y=this.lineWidth,de=this.lineJoin;this.pdf.addPage(),this.fillStyle=b,this.strokeStyle=k,this.font=j,this.lineCap=q,this.lineWidth=Y,this.lineJoin=de},v=function(b,k,j){for(var q=0;q<b.length;q++)switch(b[q].type){case"bct":b[q].x2+=k,b[q].y2+=j;case"qct":b[q].x1+=k,b[q].y1+=j;case"mt":case"lt":case"arc":default:b[q].x+=k,b[q].y+=j}return b},E=function(b){return b.sort(function(k,j){return k-j})},D=function(b,k){for(var j,q,Y=this.fillStyle,de=this.strokeStyle,ue=this.lineCap,pe=this.lineWidth,ye=Math.abs(pe*this.ctx.transform.scaleX),ve=this.lineJoin,ae=JSON.parse(JSON.stringify(this.path)),Ke=JSON.parse(JSON.stringify(this.path)),Ee=[],me=0;me<Ke.length;me++)if(Ke[me].x!==void 0)for(var le=y.call(this,Ke[me]),He=0;He<le.length;He+=1)Ee.indexOf(le[He])===-1&&Ee.push(le[He]);for(var Ze=0;Ze<Ee.length;Ze++)for(;this.pdf.internal.getNumberOfPages()<Ee[Ze];)x.call(this);if(E(Ee),this.autoPaging)for(var $e=Ee[0],et=Ee[Ee.length-1],je=$e;je<et+1;je++){this.pdf.setPage(je),this.fillStyle=Y,this.strokeStyle=de,this.lineCap=ue,this.lineWidth=ye,this.lineJoin=ve;var _e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],lt=je===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=je===1?0:Ct+(je-2)*bt;if(this.ctx.clip_path.length!==0){var Mt=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(j,this.posX+this.margin[3],-Et+lt+this.ctx.prevPageLastElemOffset),B.call(this,b,!0),this.path=Mt}if(q=JSON.parse(JSON.stringify(ae)),this.path=v(q,this.posX+this.margin[3],-Et+lt+this.ctx.prevPageLastElemOffset),k===!1||je===0){var Dt=(je>$e||je<et)&&h.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_e,bt,null).clip().discardPath()),B.call(this,b,k),Dt&&this.pdf.restoreGraphicsState()}this.lineWidth=pe}else this.lineWidth=ye,B.call(this,b,k),this.lineWidth=pe;this.path=ae},B=function(b,k){if((b!=="stroke"||k||!g.call(this))&&(b==="stroke"||k||!u.call(this))){for(var j,q,Y=[],de=this.path,ue=0;ue<de.length;ue++){var pe=de[ue];switch(pe.type){case"begin":Y.push({begin:!0});break;case"close":Y.push({close:!0});break;case"mt":Y.push({start:pe,deltas:[],abs:[]});break;case"lt":var ye=Y.length;if(de[ue-1]&&!isNaN(de[ue-1].x)&&(j=[pe.x-de[ue-1].x,pe.y-de[ue-1].y],ye>0)){for(;ye>=0;ye--)if(Y[ye-1].close!==!0&&Y[ye-1].begin!==!0){Y[ye-1].deltas.push(j),Y[ye-1].abs.push(pe);break}}break;case"bct":j=[pe.x1-de[ue-1].x,pe.y1-de[ue-1].y,pe.x2-de[ue-1].x,pe.y2-de[ue-1].y,pe.x-de[ue-1].x,pe.y-de[ue-1].y],Y[Y.length-1].deltas.push(j);break;case"qct":var ve=de[ue-1].x+2/3*(pe.x1-de[ue-1].x),ae=de[ue-1].y+2/3*(pe.y1-de[ue-1].y),Ke=pe.x+2/3*(pe.x1-pe.x),Ee=pe.y+2/3*(pe.y1-pe.y),me=pe.x,le=pe.y;j=[ve-de[ue-1].x,ae-de[ue-1].y,Ke-de[ue-1].x,Ee-de[ue-1].y,me-de[ue-1].x,le-de[ue-1].y],Y[Y.length-1].deltas.push(j);break;case"arc":Y.push({deltas:[],abs:[],arc:!0}),Array.isArray(Y[Y.length-1].abs)&&Y[Y.length-1].abs.push(pe)}}q=k?null:b==="stroke"?"stroke":"fill";for(var He=!1,Ze=0;Ze<Y.length;Ze++)if(Y[Ze].arc)for(var $e=Y[Ze].abs,et=0;et<$e.length;et++){var je=$e[et];je.type==="arc"?S.call(this,je.x,je.y,je.radius,je.startAngle,je.endAngle,je.counterclockwise,void 0,k,!He):L.call(this,je.x,je.y),He=!0}else if(Y[Ze].close===!0)this.pdf.internal.out("h"),He=!1;else if(Y[Ze].begin!==!0){var _e=Y[Ze].start.x,lt=Y[Ze].start.y;N.call(this,Y[Ze].deltas,_e,lt),He=!0}q&&O.call(this,q),k&&M.call(this)}},I=function(b){var k=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,j=k*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return b-j;case"top":return b+k-j;case"hanging":return b+k-2*j;case"middle":return b+k/2-j;case"ideographic":return b;case"alphabetic":default:return b}},_=function(b){return b+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var b=function(){};return b.colorStops=[],b.addColorStop=function(k,j){this.colorStops.push([k,j])},b.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},b.isCanvasGradient=!0,b},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(b,k,j,q,Y,de,ue,pe,ye){for(var ve=U.call(this,j,q,Y,de),ae=0;ae<ve.length;ae++){var Ke=ve[ae];ae===0&&(ye?T.call(this,Ke.x1+b,Ke.y1+k):L.call(this,Ke.x1+b,Ke.y1+k)),P.call(this,b,k,Ke.x2,Ke.y2,Ke.x3,Ke.y3,Ke.x4,Ke.y4)}pe?M.call(this):O.call(this,ue)},O=function(b){switch(b){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(b,k){this.pdf.internal.out(r(b)+" "+a(k)+" m")},R=function(b){var k;switch(b.align){case"right":case"end":k="right";break;case"center":k="center";break;case"left":case"start":default:k="left"}var j=this.pdf.getTextDimensions(b.text),q=I.call(this,b.y),Y=_.call(this,q)-j.h,de=this.ctx.transform.applyToPoint(new o(b.x,q)),ue=this.ctx.transform.decompose(),pe=new c;pe=(pe=(pe=pe.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var ye,ve,ae,Ke=this.ctx.transform.applyToRectangle(new A(b.x,q,j.w,j.h)),Ee=pe.applyToRectangle(new A(b.x,Y,j.w,j.h)),me=y.call(this,Ee),le=[],He=0;He<me.length;He+=1)le.indexOf(me[He])===-1&&le.push(me[He]);if(E(le),this.autoPaging)for(var Ze=le[0],$e=le[le.length-1],et=Ze;et<$e+1;et++){this.pdf.setPage(et);var je=et===1?this.posY+this.margin[0]:this.margin[0],_e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[2],Ct=lt-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],Et=bt-this.margin[3],Mt=et===1?0:_e+(et-2)*Ct;if(this.ctx.clip_path.length!==0){var Dt=this.path;ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ye,this.posX+this.margin[3],-1*Mt+je),B.call(this,"fill",!0),this.path=Dt}var Bt=v([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-Mt+je+this.ctx.prevPageLastElemOffset)[0];b.scale>=.01&&(ve=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ve*b.scale),ae=this.lineWidth,this.lineWidth=ae*b.scale);var ut=this.autoPaging!=="text";if(ut||Bt.y+Bt.h<=lt){if(ut||Bt.y>=je&&Bt.x<=bt){var ct=ut?b.text:this.pdf.splitTextToSize(b.text,b.maxWidth||bt-Bt.x)[0],vr=v([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Mt+je+this.ctx.prevPageLastElemOffset)[0],Rt=ut&&(et>Ze||et<$e)&&h.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Ct,null).clip().discardPath()),this.pdf.text(ct,vr.x,vr.y,{angle:b.angle,align:k,renderingMode:b.renderingMode}),Rt&&this.pdf.restoreGraphicsState()}}else Bt.y<lt&&(this.ctx.prevPageLastElemOffset+=lt-Bt.y);b.scale>=.01&&(this.pdf.setFontSize(ve),this.lineWidth=ae)}else b.scale>=.01&&(ve=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ve*b.scale),ae=this.lineWidth,this.lineWidth=ae*b.scale),this.pdf.text(b.text,de.x+this.posX,de.y+this.posY,{angle:b.angle,align:k,renderingMode:b.renderingMode,maxWidth:b.maxWidth}),b.scale>=.01&&(this.pdf.setFontSize(ve),this.lineWidth=ae)},L=function(b,k,j,q){j=j||0,q=q||0,this.pdf.internal.out(r(b+j)+" "+a(k+q)+" l")},N=function(b,k,j){return this.pdf.lines(b,k,j,null,null)},P=function(b,k,j,q,Y,de,ue,pe){this.pdf.internal.out([t(n(j+b)),t(s(q+k)),t(n(Y+b)),t(s(de+k)),t(n(ue+b)),t(s(pe+k)),"c"].join(" "))},U=function(b,k,j,q){for(var Y=2*Math.PI,de=Math.PI/2;k>j;)k-=Y;var ue=Math.abs(j-k);ue<Y&&q&&(ue=Y-ue);for(var pe=[],ye=q?-1:1,ve=k;ue>1e-5;){var ae=ve+ye*Math.min(ue,de);pe.push(V.call(this,b,ve,ae)),ue-=Math.abs(ae-ve),ve=ae}return pe},V=function(b,k,j){var q=(j-k)/2,Y=b*Math.cos(q),de=b*Math.sin(q),ue=Y,pe=-de,ye=ue*ue+pe*pe,ve=ye+ue*Y+pe*de,ae=4/3*(Math.sqrt(2*ye*ve)-ve)/(ue*de-pe*Y),Ke=ue-ae*pe,Ee=pe+ae*ue,me=Ke,le=-Ee,He=q+k,Ze=Math.cos(He),$e=Math.sin(He);return{x1:b*Math.cos(k),y1:b*Math.sin(k),x2:Ke*Ze-Ee*$e,y2:Ke*$e+Ee*Ze,x3:me*Ze-le*$e,y3:me*$e+le*Ze,x4:b*Math.cos(j),y4:b*Math.sin(j)}},ie=function(b){return 180*b/Math.PI},W=function(b,k,j,q,Y,de){var ue=b+.5*(j-b),pe=k+.5*(q-k),ye=Y+.5*(j-Y),ve=de+.5*(q-de),ae=Math.min(b,Y,ue,ye),Ke=Math.max(b,Y,ue,ye),Ee=Math.min(k,de,pe,ve),me=Math.max(k,de,pe,ve);return new A(ae,Ee,Ke-ae,me-Ee)},z=function(b,k,j,q,Y,de,ue,pe){var ye,ve,ae,Ke,Ee,me,le,He,Ze,$e,et,je,_e,lt,Ct=j-b,bt=q-k,Et=Y-j,Mt=de-q,Dt=ue-Y,Bt=pe-de;for(ve=0;ve<41;ve++)Ze=(le=(ae=b+(ye=ve/40)*Ct)+ye*((Ee=j+ye*Et)-ae))+ye*(Ee+ye*(Y+ye*Dt-Ee)-le),$e=(He=(Ke=k+ye*bt)+ye*((me=q+ye*Mt)-Ke))+ye*(me+ye*(de+ye*Bt-me)-He),ve==0?(et=Ze,je=$e,_e=Ze,lt=$e):(et=Math.min(et,Ze),je=Math.min(je,$e),_e=Math.max(_e,Ze),lt=Math.max(lt,$e));return new A(Math.round(et),Math.round(je),Math.round(_e-et),Math.round(lt-je))},G=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var b,k,j=(b=this.ctx.lineDash,k=this.ctx.lineDashOffset,JSON.stringify({lineDash:b,lineDashOffset:k}));this.prevLineDash!==j&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=j)}}})(Ht.API),function(e){var t=function(s){var o,A,c,l,d,f,p,u,g,h;for(A=[],c=0,l=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;l>c;c+=4)(d=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(f=(d=((d=((d=((d=(d-(h=d%85))/85)-(g=d%85))/85)-(u=d%85))/85)-(p=d%85))/85)%85,A.push(f+33,p+33,u+33,g+33,h+33)):A.push(122);return function(y,x){for(var v=x;v>0;v--)y.pop()}(A,o.length),String.fromCharCode.apply(String,A)+"~>"},r=function(s){var o,A,c,l,d,f=String,p="length",u=255,g="charCodeAt",h="slice",y="replace";for(s[h](-2),s=s[h](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),c=[],l=0,d=(s+=o="uuuuu"[h](s[p]%5||5))[p];d>l;l+=5)A=52200625*(s[g](l)-33)+614125*(s[g](l+1)-33)+7225*(s[g](l+2)-33)+85*(s[g](l+3)-33)+(s[g](l+4)-33),c.push(u&A>>24,u&A>>16,u&A>>8,u&A);return function(x,v){for(var E=v;E>0;E--)x.pop()}(c,o[p]),f.fromCharCode.apply(f,c)},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var A="",c=0;c<s.length;c+=2)A+=String.fromCharCode("0x"+(s[c]+s[c+1]));return A},n=function(s){for(var o=new Uint8Array(s.length),A=s.length;A--;)o[A]=s.charCodeAt(A);return s=(o=Ox(o)).reduce(function(c,l){return c+String.fromCharCode(l)},"")};e.processDataByFilters=function(s,o){var A=0,c=s||"",l=[];for(typeof(o=o||[])=="string"&&(o=[o]),A=0;A<o.length;A+=1)switch(o[A]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[A]+'" is not implemented')}return{data:c,reverseChain:l.reverse().join(" ")}}}(Ht.API),function(e){e.loadFile=function(t,r,a){return function(n,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var A=void 0;try{A=function(c,l,d){var f=new XMLHttpRequest,p=0,u=function(g){var h=g.length,y=[],x=String.fromCharCode;for(p=0;p<h;p+=1)y.push(x(255&g.charCodeAt(p)));return y.join("")};if(f.open("GET",c,!l),f.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(f.onload=function(){f.status===200?d(u(this.responseText)):d(void 0)}),f.send(null),l&&f.status===200)return u(f.responseText)}(n,s,o)}catch{}return A}(t,r,a)},e.loadImageFile=e.loadFile}(Ht.API),function(e){function t(){return(Vt.html2canvas?Promise.resolve(Vt.html2canvas):pi(()=>Promise.resolve().then(()=>GG),void 0,import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Vt.DOMPurify?Promise.resolve(Vt.DOMPurify):pi(()=>import("./purify.es-C_uT9hQ1.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var A=Jr(o);return A==="undefined"?"undefined":A==="string"||o instanceof String?"string":A==="number"||o instanceof Number?"number":A==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":A==="object"?"object":"unknown"},n=function(o,A){var c=document.createElement(o);for(var l in A.className&&(c.className=A.className),A.innerHTML&&A.dompurify&&(c.innerHTML=A.dompurify.sanitize(A.innerHTML)),A.style)c.style[l]=A.style[l];return c},s=function o(A){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),l=o.convert(Promise.resolve(),c);return l=(l=l.setProgress(1,o,1,[o])).set(A)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,A){return o.__proto__=A||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,A){return this.then(function(){switch(A=A||function(c){switch(a(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},A=function c(l,d){for(var f=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),p=l.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(c(p,d));return l.nodeType===1&&(l.nodeName==="CANVAS"?(f.width=l.width,f.height=l.height,f.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(f.value=l.value),f.addEventListener("load",function(){f.scrollTop=l.scrollTop,f.scrollLeft=l.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);A.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(A),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(A){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,A(this.prop.container,c)}).then(function(A){(this.opt.html2canvas.onrendered||function(){})(A),this.prop.canvas=A,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(A){var c=this.opt.jsPDF,l=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=l,l)for(var p=0;p<l.length;++p){var u=l[p],g=u.src.find(function(h){return h.format==="truetype"});g&&c.addFont(g.url,u.ref.name,u.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,c.context2d.save(!0),A(this.prop.container,f)}).then(function(A){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(A),this.prop.canvas=A,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,A,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,A):this.outputPdf(o,A)},s.prototype.outputPdf=function(o,A){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,A)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(a(o)!=="object")return this;var A=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(A)})},s.prototype.get=function(o,A){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return A?A(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function A(c,l){return Math.floor(c*l/72*96)}return this.then(function(){(o=o||Ht.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:A(o.inner.width,o.k),height:A(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,A,c,l){return o!=null&&(this.progress.val=o),A!=null&&(this.progress.state=A),c!=null&&(this.progress.n=c),l!=null&&(this.progress.stack=l),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,A,c,l){return this.setProgress(o?this.progress.val+o:null,A||null,c?this.progress.n+c:null,l?this.progress.stack.concat(l):null)},s.prototype.then=function(o,A){var c=this;return this.thenCore(o,A,function(l,d){return c.updateProgress(null,null,1,[l]),Promise.prototype.then.call(this,function(f){return c.updateProgress(null,l),f}).then(l,d).then(function(f){return c.updateProgress(1),f})})},s.prototype.thenCore=function(o,A,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),A&&(A=A.bind(this));var l=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),d=c.call(l,o,A);return s.convert(d,this.__proto__)},s.prototype.thenExternal=function(o,A){return Promise.prototype.then.call(this,o,A)},s.prototype.thenList=function(o){var A=this;return o.forEach(function(c){A=A.thenCore(c)}),A},s.prototype.catch=function(o){o&&(o=o.bind(this));var A=Promise.prototype.catch.call(this,o);return s.convert(A,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Ht.getPageSize=function(o,A,c){if(Jr(o)==="object"){var l=o;o=l.orientation,A=l.unit||A,c=l.format||c}A=A||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,f=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(A){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+A}var u,g=0,h=0;if(p.hasOwnProperty(f))g=p[f][1]/d,h=p[f][0]/d;else try{g=c[1],h=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",h>g&&(u=h,h=g,g=u);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>h&&(u=h,h=g,g=u)}return{width:h,height:g,unit:A,k:d,orientation:o}},e.html=function(o,A){(A=A||{}).callback=A.callback||function(){},A.html2canvas=A.html2canvas||{},A.html2canvas.canvas=A.html2canvas.canvas||this.canvas,A.jsPDF=A.jsPDF||this,A.fontFaces=A.fontFaces?A.fontFaces.map(Dx):null;var c=new s(A);return A.worker?c:c.from(o).doCallback()}}(Ht.API),Ht.API.addJS=function(e){return xw=e,this.internal.events.subscribe("postPutResources",function(){xp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(xp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),gw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+xw+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){xp!==void 0&&gw!==void 0&&this.internal.out("/Names <</JavaScript "+xp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var o=n[s],A=a.exec(o);if(A!=null){var c=A[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,d=[];for(s=0;s<l;s++){var f=r.internal.newObject();d.push(f);var p=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var u=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+u+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var o={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var o=a.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var A=this.count=this.count_r({count:0},o);if(A>0&&this.line("/Count "+A),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var l=0;l<a.children.length;l++)this.renderItems(a.children[l])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])}(Ht.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,s,o,A){var c,l=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(f){for(var p,u=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,h={width:0,height:0,numcomponents:1},y=4;y<g;y+=2){if(y+=u,t.indexOf(f.charCodeAt(y+1))!==-1){p=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),h={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:p,numcomponents:f.charCodeAt(y+9)};break}u=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return h}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:A=this.color_spaces.DEVICE_GRAY;break;case 4:A=this.color_spaces.DEVICE_CMYK;break;case 3:A=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:A,bitsPerComponent:8,filter:l,index:a,alias:n}}return d}}(Ht.API);var Wl,yp,yw,vw,ww,n9=function(){var e,t,r;function a(s){var o,A,c,l,d,f,p,u,g,h,y,x,v,E;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(o=this.readUInt32(),g=(function(){var D,B;for(B=[],D=0;D<4;++D)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),l=this.readUInt16()||100,f.delay=1e3*d/l,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,o-=4),s=(f!=null?f.data:void 0)||this.imgData,x=0;0<=o?x<o:x>o;0<=o?++x:--x)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((h=c-this.transparency.indexed.length)>0)for(v=0;0<=h?v<h:v>h;0<=h?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":p=(y=this.read(o)).indexOf(0),u=String.fromCharCode.apply(String,y.slice(0,p)),this.text[u]=String.fromCharCode.apply(String,y.slice(p+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(E=this.colorType)===4||E===6,A=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*A,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(s){var o,A;for(A=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)A.push(this.data[this.pos++]);return A},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,A=new Uint8Array(this.width*this.height*o),c=0,l=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function d(f,p,u,g){var h,y,x,v,E,D,B,I,_,S,O,M,T,R,L,N,P,U,V,ie,W,z=Math.ceil((l.width-f)/u),G=Math.ceil((l.height-p)/g),b=l.width==z&&l.height==G;for(R=o*z,M=b?A:new Uint8Array(R*G),D=s.length,T=0,y=0;T<G&&c<D;){switch(s[c++]){case 0:for(v=P=0;P<R;v=P+=1)M[y++]=s[c++];break;case 1:for(v=U=0;U<R;v=U+=1)h=s[c++],E=v<o?0:M[y-o],M[y++]=(h+E)%256;break;case 2:for(v=V=0;V<R;v=V+=1)h=s[c++],x=(v-v%o)/o,L=T&&M[(T-1)*R+x*o+v%o],M[y++]=(L+h)%256;break;case 3:for(v=ie=0;ie<R;v=ie+=1)h=s[c++],x=(v-v%o)/o,E=v<o?0:M[y-o],L=T&&M[(T-1)*R+x*o+v%o],M[y++]=(h+Math.floor((E+L)/2))%256;break;case 4:for(v=W=0;W<R;v=W+=1)h=s[c++],x=(v-v%o)/o,E=v<o?0:M[y-o],T===0?L=N=0:(L=M[(T-1)*R+x*o+v%o],N=x&&M[(T-1)*R+(x-1)*o+v%o]),B=E+L-N,I=Math.abs(B-E),S=Math.abs(B-L),O=Math.abs(B-N),_=I<=S&&I<=O?E:S<=O?L:N,M[y++]=(h+_)%256;break;default:throw new Error("Invalid filter algorithm: "+s[c-1])}if(!b){var k=((p+T*g)*l.width+f)*o,j=T*R;for(v=0;v<z;v+=1){for(var q=0;q<o;q+=1)A[k++]=M[j++];k+=(u-1)*o}}T++}}return s=jP(s),l.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),A},a.prototype.decodePalette=function(){var s,o,A,c,l,d,f,p,u;for(A=this.palette,d=this.transparency.indexed||[],l=new Uint8Array((d.length||0)+A.length),c=0,s=0,o=f=0,p=A.length;f<p;o=f+=3)l[c++]=A[o],l[c++]=A[o+1],l[c++]=A[o+2],l[c++]=(u=d[s++])!=null?u:255;return l},a.prototype.copyToImageData=function(s,o){var A,c,l,d,f,p,u,g,h,y,x;if(c=this.colors,h=null,A=this.hasAlphaChannel,this.palette.length&&(h=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),c=4,A=!0),g=(l=s.data||s).length,f=h||o,d=p=0,c===1)for(;d<g;)u=h?4*o[d/4]:p,y=f[u++],l[d++]=y,l[d++]=y,l[d++]=y,l[d++]=A?f[u++]:255,p=u;else for(;d<g;)u=h?4*o[d/4]:p,l[d++]=f[u++],l[d++]=f[u++],l[d++]=f[u++],l[d++]=A?f[u++]:255,p=u},a.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var n=function(){if(Object.prototype.toString.call(Vt)==="[object Window]"){try{t=Vt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return n(),e=function(s){var o;if(n()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(s){var o,A,c,l,d,f,p,u;if(this.animation){for(u=[],A=d=0,f=(p=this.animation.frames).length;d<f;A=++d)o=p[A],c=s.createImageData(o.width,o.height),l=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,l),o.imageData=c,u.push(o.image=e(c));return u}},a.prototype.renderFrame=function(s,o){var A,c,l;return A=(c=this.animation.frames)[o],l=c[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(l!=null?l.disposeOp:void 0)===1?s.clearRect(l.xOffset,l.yOffset,l.width,l.height):(l!=null?l.disposeOp:void 0)===2&&s.putImageData(l.imageData,l.xOffset,l.yOffset),A.blendOp===0&&s.clearRect(A.xOffset,A.yOffset,A.width,A.height),s.drawImage(A.image,A.xOffset,A.yOffset)},a.prototype.animate=function(s){var o,A,c,l,d,f,p=this;return A=0,f=this.animation,l=f.numFrames,c=f.frames,d=f.numPlays,(o=function(){var u,g;if(u=A++%l,g=c[u],p.renderFrame(s,u),l>1&&A/l<d)return p.animation._timeout=setTimeout(o,g.delay)})()},a.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},a.prototype.render=function(s){var o,A;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(A=o.createImageData(this.width,this.height),this.copyToImageData(A,this.decodePixels()),o.putImageData(A,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function i9(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,o=1<<(7&n)+1;e[t++],e[t++];var A=null,c=null;s&&(A=t,c=o,t+=3*o);var l=!0,d=[],f=0,p=null,u=0,g=null;for(this.width=r,this.height=a;l&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var h=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],!(1&h)&&(p=null),u=h>>2&7,t++;break;case 254:for(;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,D=e[t++],B=D>>6&1,I=1<<(7&D)+1,_=A,S=c,O=!1;D>>7&&(O=!0,_=t,S=I,t+=3*I);var M=t;for(t++;;){var T;if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}d.push({x:y,y:x,width:v,height:E,has_local_palette:O,palette_offset:_,palette_size:S,data_offset:M,data_length:t-M,transparent_index:p,interlaced:!!B,delay:f,disposal:u});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(R){if(R<0||R>=d.length)throw new Error("Frame index out of range.");return d[R]},this.decodeAndBlitFrameBGRA=function(R,L){var N=this.frameInfo(R),P=N.width*N.height,U=new Uint8Array(P);Ew(e,N.data_offset,U,P);var V=N.palette_offset,ie=N.transparent_index;ie===null&&(ie=256);var W=N.width,z=r-W,G=W,b=4*(N.y*r+N.x),k=4*((N.y+N.height)*r+N.x),j=b,q=4*z;N.interlaced===!0&&(q+=4*r*7);for(var Y=8,de=0,ue=U.length;de<ue;++de){var pe=U[de];if(G===0&&(G=W,(j+=q)>=k&&(q=4*z+4*r*(Y-1),j=b+(W+z)*(Y<<1),Y>>=1)),pe===ie)j+=4;else{var ye=e[V+3*pe],ve=e[V+3*pe+1],ae=e[V+3*pe+2];L[j++]=ae,L[j++]=ve,L[j++]=ye,L[j++]=255}--G}},this.decodeAndBlitFrameRGBA=function(R,L){var N=this.frameInfo(R),P=N.width*N.height,U=new Uint8Array(P);Ew(e,N.data_offset,U,P);var V=N.palette_offset,ie=N.transparent_index;ie===null&&(ie=256);var W=N.width,z=r-W,G=W,b=4*(N.y*r+N.x),k=4*((N.y+N.height)*r+N.x),j=b,q=4*z;N.interlaced===!0&&(q+=4*r*7);for(var Y=8,de=0,ue=U.length;de<ue;++de){var pe=U[de];if(G===0&&(G=W,(j+=q)>=k&&(q=4*z+4*r*(Y-1),j=b+(W+z)*(Y<<1),Y>>=1)),pe===ie)j+=4;else{var ye=e[V+3*pe],ve=e[V+3*pe+1],ae=e[V+3*pe+2];L[j++]=ye,L[j++]=ve,L[j++]=ae,L[j++]=255}--G}}}function Ew(e,t,r,a){for(var n=e[t++],s=1<<n,o=s+1,A=o+1,c=n+1,l=(1<<c)-1,d=0,f=0,p=0,u=e[t++],g=new Int32Array(4096),h=null;;){for(;d<16&&u!==0;)f|=e[t++]<<d,d+=8,u===1?u=e[t++]:--u;if(d<c)break;var y=f&l;if(f>>=c,d-=c,y!==s){if(y===o)break;for(var x=y<A?y:h,v=0,E=x;E>s;)E=g[E]>>8,++v;var D=E;if(p+v+(x!==y?1:0)>a)return void $r.log("Warning, gif stream longer than expected.");r[p++]=D;var B=p+=v;for(x!==y&&(r[p++]=D),E=x;v--;)E=g[E],r[--B]=255&E,E>>=8;h!==null&&A<4096&&(g[A++]=h<<8|D,A>=l+1&&c<12&&(++c,l=l<<1|1)),h=y}else A=o+1,l=(1<<(c=n+1))-1,h=null}return p!==a&&$r.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Jg(e){var t,r,a,n,s,o=Math.floor,A=new Array(64),c=new Array(64),l=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),u=new Array(64),g=new Array(64),h=[],y=0,x=7,v=new Array(64),E=new Array(64),D=new Array(64),B=new Array(256),I=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],P=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function U(b,k){for(var j=0,q=0,Y=new Array,de=1;de<=16;de++){for(var ue=1;ue<=b[de];ue++)Y[k[q]]=[],Y[k[q]][0]=j,Y[k[q]][1]=de,q++,j++;j*=2}return Y}function V(b){for(var k=b[0],j=b[1]-1;j>=0;)k&1<<j&&(y|=1<<x),j--,--x<0&&(y==255?(ie(255),ie(0)):ie(y),x=7,y=0)}function ie(b){h.push(b)}function W(b){ie(b>>8&255),ie(255&b)}function z(b,k,j,q,Y){for(var de,ue=Y[0],pe=Y[240],ye=function($e,et){var je,_e,lt,Ct,bt,Et,Mt,Dt,Bt,ut,ct=0;for(Bt=0;Bt<8;++Bt){je=$e[ct],_e=$e[ct+1],lt=$e[ct+2],Ct=$e[ct+3],bt=$e[ct+4],Et=$e[ct+5],Mt=$e[ct+6];var vr=je+(Dt=$e[ct+7]),Rt=je-Dt,Gr=_e+Mt,pr=_e-Mt,vt=lt+Et,Tr=lt-Et,rr=Ct+bt,ln=Ct-bt,kr=vr+rr,ri=vr-rr,Di=Gr+vt,Dr=Gr-vt;$e[ct]=kr+Di,$e[ct+4]=kr-Di;var Gt=.707106781*(Dr+ri);$e[ct+2]=ri+Gt,$e[ct+6]=ri-Gt;var wr=.382683433*((kr=ln+Tr)-(Dr=pr+Rt)),ns=.5411961*kr+wr,ga=1.306562965*Dr+wr,yi=.707106781*(Di=Tr+pr),vi=Rt+yi,kt=Rt-yi;$e[ct+5]=kt+ns,$e[ct+3]=kt-ns,$e[ct+1]=vi+ga,$e[ct+7]=vi-ga,ct+=8}for(ct=0,Bt=0;Bt<8;++Bt){je=$e[ct],_e=$e[ct+8],lt=$e[ct+16],Ct=$e[ct+24],bt=$e[ct+32],Et=$e[ct+40],Mt=$e[ct+48];var ai=je+(Dt=$e[ct+56]),Ja=je-Dt,Za=_e+Mt,ca=_e-Mt,ge=lt+Et,H=lt-Et,Ae=Ct+bt,te=Ct-bt,Z=ai+Ae,se=ai-Ae,ce=Za+ge,Se=Za-ge;$e[ct]=Z+ce,$e[ct+32]=Z-ce;var Me=.707106781*(Se+se);$e[ct+16]=se+Me,$e[ct+48]=se-Me;var be=.382683433*((Z=te+H)-(Se=ca+Ja)),ke=.5411961*Z+be,Ue=1.306562965*Se+be,ze=.707106781*(ce=H+ca),dt=Ja+ze,pt=Ja-ze;$e[ct+40]=pt+ke,$e[ct+24]=pt-ke,$e[ct+8]=dt+Ue,$e[ct+56]=dt-Ue,ct++}for(Bt=0;Bt<64;++Bt)ut=$e[Bt]*et[Bt],u[Bt]=ut>0?ut+.5|0:ut-.5|0;return u}(b,k),ve=0;ve<64;++ve)g[_[ve]]=ye[ve];var ae=g[0]-j;j=g[0],ae==0?V(q[0]):(V(q[p[de=32767+ae]]),V(f[de]));for(var Ke=63;Ke>0&&g[Ke]==0;)Ke--;if(Ke==0)return V(ue),j;for(var Ee,me=1;me<=Ke;){for(var le=me;g[me]==0&&me<=Ke;)++me;var He=me-le;if(He>=16){Ee=He>>4;for(var Ze=1;Ze<=Ee;++Ze)V(pe);He&=15}de=32767+g[me],V(Y[(He<<4)+p[de]]),V(f[de]),me++}return Ke!=63&&V(ue),j}function G(b){b=Math.min(Math.max(b,1),100),s!=b&&(function(k){for(var j=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var Y=o((j[q]*k+50)/100);Y=Math.min(Math.max(Y,1),255),A[_[q]]=Y}for(var de=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var pe=o((de[ue]*k+50)/100);pe=Math.min(Math.max(pe,1),255),c[_[ue]]=pe}for(var ye=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ve=0,ae=0;ae<8;ae++)for(var Ke=0;Ke<8;Ke++)l[ve]=1/(A[_[ve]]*ye[ae]*ye[Ke]*8),d[ve]=1/(c[_[ve]]*ye[ae]*ye[Ke]*8),ve++}(b<50?Math.floor(5e3/b):Math.floor(200-2*b)),s=b)}this.encode=function(b,k){k&&G(k),h=new Array,y=0,x=7,W(65496),W(65504),W(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),W(1),W(1),ie(0),ie(0),function(){W(65499),W(132),ie(0);for(var _e=0;_e<64;_e++)ie(A[_e]);ie(1);for(var lt=0;lt<64;lt++)ie(c[lt])}(),function(_e,lt){W(65472),W(17),ie(8),W(lt),W(_e),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)}(b.width,b.height),function(){W(65476),W(418),ie(0);for(var _e=0;_e<16;_e++)ie(S[_e+1]);for(var lt=0;lt<=11;lt++)ie(O[lt]);ie(16);for(var Ct=0;Ct<16;Ct++)ie(M[Ct+1]);for(var bt=0;bt<=161;bt++)ie(T[bt]);ie(1);for(var Et=0;Et<16;Et++)ie(R[Et+1]);for(var Mt=0;Mt<=11;Mt++)ie(L[Mt]);ie(17);for(var Dt=0;Dt<16;Dt++)ie(N[Dt+1]);for(var Bt=0;Bt<=161;Bt++)ie(P[Bt])}(),W(65498),W(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var j=0,q=0,Y=0;y=0,x=7,this.encode.displayName="_encode_";for(var de,ue,pe,ye,ve,ae,Ke,Ee,me,le=b.data,He=b.width,Ze=b.height,$e=4*He,et=0;et<Ze;){for(de=0;de<$e;){for(ve=$e*et+de,Ke=-1,Ee=0,me=0;me<64;me++)ae=ve+(Ee=me>>3)*$e+(Ke=4*(7&me)),et+Ee>=Ze&&(ae-=$e*(et+1+Ee-Ze)),de+Ke>=$e&&(ae-=de+Ke-$e+4),ue=le[ae++],pe=le[ae++],ye=le[ae++],v[me]=(I[ue]+I[pe+256>>0]+I[ye+512>>0]>>16)-128,E[me]=(I[ue+768>>0]+I[pe+1024>>0]+I[ye+1280>>0]>>16)-128,D[me]=(I[ue+1280>>0]+I[pe+1536>>0]+I[ye+1792>>0]>>16)-128;j=z(v,l,j,t,a),q=z(E,d,q,r,n),Y=z(D,d,Y,r,n),de+=32}et+=8}if(x>=0){var je=[];je[1]=x+1,je[0]=(1<<x+1)-1,V(je)}return W(65497),new Uint8Array(h)},e=e||50,function(){for(var b=String.fromCharCode,k=0;k<256;k++)B[k]=b(k)}(),t=U(S,O),r=U(R,L),a=U(M,T),n=U(N,P),function(){for(var b=1,k=2,j=1;j<=15;j++){for(var q=b;q<k;q++)p[32767+q]=j,f[32767+q]=[],f[32767+q][1]=j,f[32767+q][0]=q;for(var Y=-(k-1);Y<=-b;Y++)p[32767+Y]=j,f[32767+Y]=[],f[32767+Y][1]=j,f[32767+Y][0]=k-1+Y;b<<=1,k<<=1}}(),function(){for(var b=0;b<256;b++)I[b]=19595*b,I[b+256>>0]=38470*b,I[b+512>>0]=7471*b+32768,I[b+768>>0]=-11059*b,I[b+1024>>0]=-21709*b,I[b+1280>>0]=32768*b+8421375,I[b+1536>>0]=-27439*b,I[b+1792>>0]=-5329*b}(),G(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ms(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _w(e){function t(S){if(!S)throw Error("assert :P")}function r(S,O,M){for(var T=0;4>T;T++)if(S[O+T]!=M.charCodeAt(T))return!0;return!1}function a(S,O,M,T,R){for(var L=0;L<R;L++)S[O+L]=M[T+L]}function n(S,O,M,T){for(var R=0;R<T;R++)S[O+R]=M}function s(S){return new Int32Array(S)}function o(S,O){for(var M=[],T=0;T<S;T++)M.push(new O);return M}function A(S,O){var M=[];return function T(R,L,N){for(var P=N[L],U=0;U<P&&(R.push(N.length>L+1?[]:new O),!(N.length<L+1));U++)T(R[U],L+1,N)}(M,0,S),M}var c=function(){var S=this;function O(m,w){for(var F=1<<w-1>>>0;m&F;)F>>>=1;return F?(m&F-1)+F:m}function M(m,w,F,Q,X){t(!(Q%F));do m[w+(Q-=F)]=X;while(0<Q)}function T(m,w,F,Q,X){if(t(2328>=X),512>=X)var ee=s(512);else if((ee=s(X))==null)return 0;return function(re,oe,fe,he,Oe,Qe){var qe,Le,nt=oe,Ve=1<<fe,Ie=s(16),De=s(16);for(t(Oe!=0),t(he!=null),t(re!=null),t(0<fe),Le=0;Le<Oe;++Le){if(15<he[Le])return 0;++Ie[he[Le]]}if(Ie[0]==Oe)return 0;for(De[1]=0,qe=1;15>qe;++qe){if(Ie[qe]>1<<qe)return 0;De[qe+1]=De[qe]+Ie[qe]}for(Le=0;Le<Oe;++Le)qe=he[Le],0<he[Le]&&(Qe[De[qe]++]=Le);if(De[15]==1)return(he=new R).g=0,he.value=Qe[0],M(re,nt,1,Ve,he),Ve;var tt,ot=-1,rt=Ve-1,Ot=0,wt=1,qt=1,_t=1<<fe;for(Le=0,qe=1,Oe=2;qe<=fe;++qe,Oe<<=1){if(wt+=qt<<=1,0>(qt-=Ie[qe]))return 0;for(;0<Ie[qe];--Ie[qe])(he=new R).g=qe,he.value=Qe[Le++],M(re,nt+Ot,Oe,_t,he),Ot=O(Ot,qe)}for(qe=fe+1,Oe=2;15>=qe;++qe,Oe<<=1){if(wt+=qt<<=1,0>(qt-=Ie[qe]))return 0;for(;0<Ie[qe];--Ie[qe]){if(he=new R,(Ot&rt)!=ot){for(nt+=_t,tt=1<<(ot=qe)-fe;15>ot&&!(0>=(tt-=Ie[ot]));)++ot,tt<<=1;Ve+=_t=1<<(tt=ot-fe),re[oe+(ot=Ot&rt)].g=tt+fe,re[oe+ot].value=nt-oe-ot}he.g=qe-fe,he.value=Qe[Le++],M(re,nt+(Ot>>fe),Oe,_t,he),Ot=O(Ot,qe)}}return wt!=2*De[15]-1?0:Ve}(m,w,F,Q,X,ee)}function R(){this.value=this.g=0}function L(){this.value=this.g=0}function N(){this.G=o(5,R),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(vn,L)}function P(m,w,F,Q){t(m!=null),t(w!=null),t(2147483648>Q),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=w,m.pa=F,m.Jd=w,m.Yc=F+Q,m.Zc=4<=Q?F+Q-4+1:F,de(m)}function U(m,w){for(var F=0;0<w--;)F|=pe(m,128)<<w;return F}function V(m,w){var F=U(m,w);return ue(m)?-F:F}function ie(m,w,F,Q){var X,ee=0;for(t(m!=null),t(w!=null),t(4294967288>Q),m.Sb=Q,m.Ra=0,m.u=0,m.h=0,4<Q&&(Q=4),X=0;X<Q;++X)ee+=w[F+X]<<8*X;m.Ra=ee,m.bb=Q,m.oa=w,m.pa=F}function W(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<kl-8>>>0,++m.bb,m.u-=8;j(m)&&(m.h=1,m.u=0)}function z(m,w){if(t(0<=w),!m.h&&w<=Rl){var F=k(m)&Fl[w];return m.u+=w,W(m),F}return m.h=1,m.u=0}function G(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function b(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function k(m){return m.Ra>>>(m.u&kl-1)>>>0}function j(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>kl}function q(m,w){m.u=w,m.h=j(m)}function Y(m){m.u>=pu&&(t(m.u>=pu),W(m))}function de(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ue(m){return U(m,1)}function pe(m,w){var F=m.Ca;0>m.b&&de(m);var Q=m.b,X=F*w>>>8,ee=(m.I>>>Q>X)+0;for(ee?(F-=X,m.I-=X+1<<Q>>>0):F=X+1,Q=F,X=0;256<=Q;)X+=8,Q>>=8;return Q=7^X+_i[Q],m.b-=Q,m.Ca=(F<<Q)-1,ee}function ye(m,w,F){m[w+0]=F>>24&255,m[w+1]=F>>16&255,m[w+2]=F>>8&255,m[w+3]=F>>0&255}function ve(m,w){return m[w+0]<<0|m[w+1]<<8}function ae(m,w){return ve(m,w)|m[w+2]<<16}function Ke(m,w){return ve(m,w)|ve(m,w+2)<<16}function Ee(m,w){var F=1<<w;return t(m!=null),t(0<w),m.X=s(F),m.X==null?0:(m.Mb=32-w,m.Xa=w,1)}function me(m,w){t(m!=null),t(w!=null),t(m.Xa==w.Xa),a(w.X,0,m.X,0,1<<w.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function He(m,w,F,Q){t(F!=null),t(Q!=null);var X=F[0],ee=Q[0];return X==0&&(X=(m*ee+w/2)/w),ee==0&&(ee=(w*X+m/2)/m),0>=X||0>=ee?0:(F[0]=X,Q[0]=ee,1)}function Ze(m,w){return m+(1<<w)-1>>>w}function $e(m,w){return((4278255360&m)+(4278255360&w)>>>0&4278255360)+((16711935&m)+(16711935&w)>>>0&16711935)>>>0}function et(m,w){S[w]=function(F,Q,X,ee,re,oe,fe){var he;for(he=0;he<re;++he){var Oe=S[m](oe[fe+he-1],X,ee+he);oe[fe+he]=$e(F[Q+he],Oe)}}}function je(){this.ud=this.hd=this.jd=0}function _e(m,w){return((4278124286&(m^w))>>>1)+(m&w)>>>0}function lt(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function Ct(m,w){return lt(m+(m-w+.5>>1))}function bt(m,w,F){return Math.abs(w-F)-Math.abs(m-F)}function Et(m,w,F,Q,X,ee,re){for(Q=ee[re-1],F=0;F<X;++F)ee[re+F]=Q=$e(m[w+F],Q)}function Mt(m,w,F,Q,X){var ee;for(ee=0;ee<F;++ee){var re=m[w+ee],oe=re>>8&255,fe=16711935&(fe=(fe=16711935&re)+((oe<<16)+oe));Q[X+ee]=(4278255360&re)+fe>>>0}}function Dt(m,w){w.jd=m>>0&255,w.hd=m>>8&255,w.ud=m>>16&255}function Bt(m,w,F,Q,X,ee){var re;for(re=0;re<Q;++re){var oe=w[F+re],fe=oe>>>8,he=oe,Oe=255&(Oe=(Oe=oe>>>16)+((m.jd<<24>>24)*(fe<<24>>24)>>>5));he=255&(he=(he=he+((m.hd<<24>>24)*(fe<<24>>24)>>>5))+((m.ud<<24>>24)*(Oe<<24>>24)>>>5)),X[ee+re]=(4278255360&oe)+(Oe<<16)+he}}function ut(m,w,F,Q,X){S[w]=function(ee,re,oe,fe,he,Oe,Qe,qe,Le){for(fe=Qe;fe<qe;++fe)for(Qe=0;Qe<Le;++Qe)he[Oe++]=X(oe[Q(ee[re++])])},S[m]=function(ee,re,oe,fe,he,Oe,Qe){var qe=8>>ee.b,Le=ee.Ea,nt=ee.K[0],Ve=ee.w;if(8>qe)for(ee=(1<<ee.b)-1,Ve=(1<<qe)-1;re<oe;++re){var Ie,De=0;for(Ie=0;Ie<Le;++Ie)Ie&ee||(De=Q(fe[he++])),Oe[Qe++]=X(nt[De&Ve]),De>>=qe}else S["VP8LMapColor"+F](fe,he,nt,Ve,Oe,Qe,re,oe,Le)}}function ct(m,w,F,Q,X){for(F=w+F;w<F;){var ee=m[w++];Q[X++]=ee>>16&255,Q[X++]=ee>>8&255,Q[X++]=ee>>0&255}}function vr(m,w,F,Q,X){for(F=w+F;w<F;){var ee=m[w++];Q[X++]=ee>>16&255,Q[X++]=ee>>8&255,Q[X++]=ee>>0&255,Q[X++]=ee>>24&255}}function Rt(m,w,F,Q,X){for(F=w+F;w<F;){var ee=(re=m[w++])>>16&240|re>>12&15,re=re>>0&240|re>>28&15;Q[X++]=ee,Q[X++]=re}}function Gr(m,w,F,Q,X){for(F=w+F;w<F;){var ee=(re=m[w++])>>16&248|re>>13&7,re=re>>5&224|re>>3&31;Q[X++]=ee,Q[X++]=re}}function pr(m,w,F,Q,X){for(F=w+F;w<F;){var ee=m[w++];Q[X++]=ee>>0&255,Q[X++]=ee>>8&255,Q[X++]=ee>>16&255}}function vt(m,w,F,Q,X,ee){if(ee==0)for(F=w+F;w<F;)ye(Q,((ee=m[w++])[0]>>24|ee[1]>>8&65280|ee[2]<<8&16711680|ee[3]<<24)>>>0),X+=32;else a(Q,X,m,w,F)}function Tr(m,w){S[w][0]=S[m+"0"],S[w][1]=S[m+"1"],S[w][2]=S[m+"2"],S[w][3]=S[m+"3"],S[w][4]=S[m+"4"],S[w][5]=S[m+"5"],S[w][6]=S[m+"6"],S[w][7]=S[m+"7"],S[w][8]=S[m+"8"],S[w][9]=S[m+"9"],S[w][10]=S[m+"10"],S[w][11]=S[m+"11"],S[w][12]=S[m+"12"],S[w][13]=S[m+"13"],S[w][14]=S[m+"0"],S[w][15]=S[m+"0"]}function rr(m){return m==rg||m==ag||m==U0||m==ng}function ln(){this.eb=[],this.size=this.A=this.fb=0}function kr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ri(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ln,this.f.kb=new kr,this.sd=null}function Di(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Dr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Gt(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function wr(m,w){var F=m.T,Q=w.ba.f.RGBA,X=Q.eb,ee=Q.fb+m.ka*Q.A,re=ds[w.ba.S],oe=m.y,fe=m.O,he=m.f,Oe=m.N,Qe=m.ea,qe=m.W,Le=w.cc,nt=w.dc,Ve=w.Mc,Ie=w.Nc,De=m.ka,tt=m.ka+m.T,ot=m.U,rt=ot+1>>1;for(De==0?re(oe,fe,null,null,he,Oe,Qe,qe,he,Oe,Qe,qe,X,ee,null,null,ot):(re(w.ec,w.fc,oe,fe,Le,nt,Ve,Ie,he,Oe,Qe,qe,X,ee-Q.A,X,ee,ot),++F);De+2<tt;De+=2)Le=he,nt=Oe,Ve=Qe,Ie=qe,Oe+=m.Rc,qe+=m.Rc,ee+=2*Q.A,re(oe,(fe+=2*m.fa)-m.fa,oe,fe,Le,nt,Ve,Ie,he,Oe,Qe,qe,X,ee-Q.A,X,ee,ot);return fe+=m.fa,m.j+tt<m.o?(a(w.ec,w.fc,oe,fe,ot),a(w.cc,w.dc,he,Oe,rt),a(w.Mc,w.Nc,Qe,qe,rt),F--):1&tt||re(oe,fe,null,null,he,Oe,Qe,qe,he,Oe,Qe,qe,X,ee+Q.A,null,null,ot),F}function ns(m,w,F){var Q=m.F,X=[m.J];if(Q!=null){var ee=m.U,re=w.ba.S,oe=re==L0||re==U0;w=w.ba.f.RGBA;var fe=[0],he=m.ka;fe[0]=m.T,m.Kb&&(he==0?--fe[0]:(--he,X[0]-=m.width),m.j+m.ka+m.T==m.o&&(fe[0]=m.o-m.j-he));var Oe=w.eb;he=w.fb+he*w.A,m=ta(Q,X[0],m.width,ee,fe,Oe,he+(oe?0:3),w.A),t(F==fe),m&&rr(re)&&cs(Oe,he,oe,ee,fe,w.A)}return 0}function ga(m){var w=m.ma,F=w.ba.S,Q=11>F,X=F==D0||F==j0||F==L0||F==tg||F==12||rr(F);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!uu(w.Oa,m,X?11:12))return 0;if(X&&rr(F)&&At(),m.da)alert("todo:use_scaling");else{if(Q){if(w.Ib=Gt,m.Kb){if(F=m.U+1>>1,w.memory=s(m.U+2*F),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+m.U,w.Mc=w.cc,w.Nc=w.dc+F,w.Ib=wr,At()}}else alert("todo:EmitYUV");X&&(w.Jb=ns,Q&&Pe())}if(Q&&!Jy){for(m=0;256>m;++m)jS[m]=89858*(m-128)+P0>>M0,MS[m]=-22014*(m-128)+P0,US[m]=-45773*(m-128),LS[m]=113618*(m-128)+P0>>M0;for(m=wu;m<og;++m)w=76283*(m-16)+P0>>M0,PS[m-wu]=Ui(w,255),QS[m-wu]=Ui(w+8>>4,15);Jy=1}return 1}function yi(m){var w=m.ma,F=m.U,Q=m.T;return t(!(1&m.ka)),0>=F||0>=Q?0:(F=w.Ib(m,w),w.Jb!=null&&w.Jb(m,w,F),w.Dc+=F,1)}function vi(m){m.ma.memory=null}function kt(m,w,F,Q){return z(m,8)!=47?0:(w[0]=z(m,14)+1,F[0]=z(m,14)+1,Q[0]=z(m,1),z(m,3)!=0?0:!m.h)}function ai(m,w){if(4>m)return m+1;var F=m-2>>1;return(2+(1&m)<<F)+z(w,F)+1}function Ja(m,w){return 120<w?w-120:1<=(F=((F=ES[w-1])>>4)*m+(8-(15&F)))?F:1;var F}function Za(m,w,F){var Q=k(F),X=m[w+=255&Q].g-8;return 0<X&&(q(F,F.u+8),Q=k(F),w+=m[w].value,w+=Q&(1<<X)-1),q(F,F.u+m[w].g),m[w].value}function ca(m,w,F){return F.g+=m.g,F.value+=m.value<<w>>>0,t(8>=F.g),m.g}function ge(m,w,F){var Q=m.xc;return t((w=Q==0?0:m.vc[m.md*(F>>Q)+(w>>Q)])<m.Wb),m.Ya[w]}function H(m,w,F,Q){var X=m.ab,ee=m.c*w,re=m.C;w=re+w;var oe=F,fe=Q;for(Q=m.Ta,F=m.Ua;0<X--;){var he=m.gc[X],Oe=re,Qe=w,qe=oe,Le=fe,nt=(fe=Q,oe=F,he.Ea);switch(t(Oe<Qe),t(Qe<=he.nc),he.hc){case 2:T0(qe,Le,(Qe-Oe)*nt,fe,oe);break;case 0:var Ve=Oe,Ie=Qe,De=fe,tt=oe,ot=(_t=he).Ea;Ve==0&&(Zm(qe,Le,null,null,1,De,tt),Et(qe,Le+1,0,0,ot-1,De,tt+1),Le+=ot,tt+=ot,++Ve);for(var rt=1<<_t.b,Ot=rt-1,wt=Ze(ot,_t.b),qt=_t.K,_t=_t.w+(Ve>>_t.b)*wt;Ve<Ie;){var Ir=qt,jr=_t,Cr=1;for(hu(qe,Le,De,tt-ot,1,De,tt);Cr<ot;){var hr=(Cr&~Ot)+rt;hr>ot&&(hr=ot),(0,uA[Ir[jr++]>>8&15])(qe,Le+ +Cr,De,tt+Cr-ot,hr-Cr,De,tt+Cr),Cr=hr}Le+=ot,tt+=ot,++Ve&Ot||(_t+=wt)}Qe!=he.nc&&a(fe,oe-nt,fe,oe+(Qe-Oe-1)*nt,nt);break;case 1:for(nt=qe,Ie=Le,ot=(qe=he.Ea)-(tt=qe&~(De=(Le=1<<he.b)-1)),Ve=Ze(qe,he.b),rt=he.K,he=he.w+(Oe>>he.b)*Ve;Oe<Qe;){for(Ot=rt,wt=he,qt=new je,_t=Ie+tt,Ir=Ie+qe;Ie<_t;)Dt(Ot[wt++],qt),wc(qt,nt,Ie,Le,fe,oe),Ie+=Le,oe+=Le;Ie<Ir&&(Dt(Ot[wt++],qt),wc(qt,nt,Ie,ot,fe,oe),Ie+=ot,oe+=ot),++Oe&De||(he+=Ve)}break;case 3:if(qe==fe&&Le==oe&&0<he.b){for(Ie=fe,qe=nt=oe+(Qe-Oe)*nt-(tt=(Qe-Oe)*Ze(he.Ea,he.b)),Le=fe,De=oe,Ve=[],tt=(ot=tt)-1;0<=tt;--tt)Ve[tt]=Le[De+tt];for(tt=ot-1;0<=tt;--tt)Ie[qe+tt]=Ve[tt];ss(he,Oe,Qe,fe,nt,fe,oe)}else ss(he,Oe,Qe,qe,Le,fe,oe)}oe=Q,fe=F}fe!=F&&a(Q,F,oe,fe,ee)}function Ae(m,w){var F=m.V,Q=m.Ba+m.c*m.C,X=w-m.C;if(t(w<=m.l.o),t(16>=X),0<X){var ee=m.l,re=m.Ta,oe=m.Ua,fe=ee.width;if(H(m,X,F,Q),X=oe=[oe],t((F=m.C)<(Q=w)),t(ee.v<ee.va),Q>ee.o&&(Q=ee.o),F<ee.j){var he=ee.j-F;F=ee.j,X[0]+=he*fe}if(F>=Q?F=0:(X[0]+=4*ee.v,ee.ka=F-ee.j,ee.U=ee.va-ee.v,ee.T=Q-F,F=1),F){if(oe=oe[0],11>(F=m.ca).S){var Oe=F.f.RGBA,Qe=(Q=F.S,X=ee.U,ee=ee.T,he=Oe.eb,Oe.A),qe=ee;for(Oe=Oe.fb+m.Ma*Oe.A;0<qe--;){var Le=re,nt=oe,Ve=X,Ie=he,De=Oe;switch(Q){case k0:bi(Le,nt,Ve,Ie,De);break;case D0:ii(Le,nt,Ve,Ie,De);break;case rg:ii(Le,nt,Ve,Ie,De),cs(Ie,De,0,Ve,1,0);break;case Ky:Oo(Le,nt,Ve,Ie,De);break;case j0:vt(Le,nt,Ve,Ie,De,1);break;case ag:vt(Le,nt,Ve,Ie,De,1),cs(Ie,De,0,Ve,1,0);break;case L0:vt(Le,nt,Ve,Ie,De,0);break;case U0:vt(Le,nt,Ve,Ie,De,0),cs(Ie,De,1,Ve,1,0);break;case tg:fA(Le,nt,Ve,Ie,De);break;case ng:fA(Le,nt,Ve,Ie,De),ea(Ie,De,Ve,1,0);break;case Hy:To(Le,nt,Ve,Ie,De);break;default:t(0)}oe+=fe,Oe+=Qe}m.Ma+=ee}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=F.height)}}m.C=w,t(m.C<=m.i)}function te(m){var w;if(0<m.ua)return 0;for(w=0;w<m.Wb;++w){var F=m.Ya[w].G,Q=m.Ya[w].H;if(0<F[1][Q[1]+0].g||0<F[2][Q[2]+0].g||0<F[3][Q[3]+0].g)return 0}return 1}function Z(m,w,F,Q,X,ee){if(m.Z!=0){var re=m.qd,oe=m.rd;for(t(gA[m.Z]!=null);w<F;++w)gA[m.Z](re,oe,Q,X,Q,X,ee),re=Q,oe=X,X+=ee;m.qd=re,m.rd=oe}}function se(m,w){var F=m.l.ma,Q=F.Z==0||F.Z==1?m.l.j:m.C;if(Q=m.C<Q?Q:m.C,t(w<=m.l.o),w>Q){var X=m.l.width,ee=F.ca,re=F.tb+X*Q,oe=m.V,fe=m.Ba+m.c*Q,he=m.gc;t(m.ab==1),t(he[0].hc==3),O0(he[0],Q,w,oe,fe,ee,re),Z(F,Q,w,ee,re,X)}m.C=m.Ma=w}function ce(m,w,F,Q,X,ee,re){var oe=m.$/Q,fe=m.$%Q,he=m.m,Oe=m.s,Qe=F+m.$,qe=Qe;X=F+Q*X;var Le=F+Q*ee,nt=280+Oe.ua,Ve=m.Pb?oe:16777216,Ie=0<Oe.ua?Oe.Wa:null,De=Oe.wc,tt=Qe<Le?ge(Oe,fe,oe):null;t(m.C<ee),t(Le<=X);var ot=!1;e:for(;;){for(;ot||Qe<Le;){var rt=0;if(oe>=Ve){var Ot=Qe-F;t((Ve=m).Pb),Ve.wd=Ve.m,Ve.xd=Ot,0<Ve.s.ua&&me(Ve.s.Wa,Ve.s.vb),Ve=oe+bS}if(fe&De||(tt=ge(Oe,fe,oe)),t(tt!=null),tt.Qb&&(w[Qe]=tt.qb,ot=!0),!ot)if(Y(he),tt.jc){rt=he,Ot=w;var wt=Qe,qt=tt.pd[k(rt)&vn-1];t(tt.jc),256>qt.g?(q(rt,rt.u+qt.g),Ot[wt]=qt.value,rt=0):(q(rt,rt.u+qt.g-256),t(256<=qt.value),rt=qt.value),rt==0&&(ot=!0)}else rt=Za(tt.G[0],tt.H[0],he);if(he.h)break;if(ot||256>rt){if(!ot)if(tt.nd)w[Qe]=(tt.qb|rt<<8)>>>0;else{if(Y(he),ot=Za(tt.G[1],tt.H[1],he),Y(he),Ot=Za(tt.G[2],tt.H[2],he),wt=Za(tt.G[3],tt.H[3],he),he.h)break;w[Qe]=(wt<<24|ot<<16|rt<<8|Ot)>>>0}if(ot=!1,++Qe,++fe>=Q&&(fe=0,++oe,re!=null&&oe<=ee&&!(oe%16)&&re(m,oe),Ie!=null))for(;qe<Qe;)rt=w[qe++],Ie.X[(506832829*rt&4294967295)>>>Ie.Mb]=rt}else if(280>rt){if(rt=ai(rt-256,he),Ot=Za(tt.G[4],tt.H[4],he),Y(he),Ot=Ja(Q,Ot=ai(Ot,he)),he.h)break;if(Qe-F<Ot||X-Qe<rt)break e;for(wt=0;wt<rt;++wt)w[Qe+wt]=w[Qe+wt-Ot];for(Qe+=rt,fe+=rt;fe>=Q;)fe-=Q,++oe,re!=null&&oe<=ee&&!(oe%16)&&re(m,oe);if(t(Qe<=X),fe&De&&(tt=ge(Oe,fe,oe)),Ie!=null)for(;qe<Qe;)rt=w[qe++],Ie.X[(506832829*rt&4294967295)>>>Ie.Mb]=rt}else{if(!(rt<nt))break e;for(ot=rt-280,t(Ie!=null);qe<Qe;)rt=w[qe++],Ie.X[(506832829*rt&4294967295)>>>Ie.Mb]=rt;rt=Qe,t(!(ot>>>(Ot=Ie).Xa)),w[rt]=Ot.X[ot],ot=!0}ot||t(he.h==j(he))}if(m.Pb&&he.h&&Qe<X)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&me(m.s.vb,m.s.Wa);else{if(he.h)break e;re!=null&&re(m,oe>ee?ee:oe),m.a=0,m.$=Qe-F}return 1}return m.a=3,0}function Se(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var w=m.Wa;w!=null&&(w.X=null),m.vb=null,t(m!=null)}function Me(){var m=new Jm;return m==null?null:(m.a=0,m.xb=Vy,Tr("Predictor","VP8LPredictors"),Tr("Predictor","VP8LPredictors_C"),Tr("PredictorAdd","VP8LPredictorsAdd"),Tr("PredictorAdd","VP8LPredictorsAdd_C"),T0=Mt,wc=Bt,bi=ct,ii=vr,fA=Rt,To=Gr,Oo=pr,S.VP8LMapColor32b=Dl,S.VP8LMapColor8b=I0,m)}function be(m,w,F,Q,X){var ee=1,re=[m],oe=[w],fe=Q.m,he=Q.s,Oe=null,Qe=0;e:for(;;){if(F)for(;ee&&z(fe,1);){var qe=re,Le=oe,nt=Q,Ve=1,Ie=nt.m,De=nt.gc[nt.ab],tt=z(Ie,2);if(nt.Oc&1<<tt)ee=0;else{switch(nt.Oc|=1<<tt,De.hc=tt,De.Ea=qe[0],De.nc=Le[0],De.K=[null],++nt.ab,t(4>=nt.ab),tt){case 0:case 1:De.b=z(Ie,3)+2,Ve=be(Ze(De.Ea,De.b),Ze(De.nc,De.b),0,nt,De.K),De.K=De.K[0];break;case 3:var ot,rt=z(Ie,8)+1,Ot=16<rt?0:4<rt?1:2<rt?2:3;if(qe[0]=Ze(De.Ea,Ot),De.b=Ot,ot=Ve=be(rt,1,0,nt,De.K)){var wt,qt=rt,_t=De,Ir=1<<(8>>_t.b),jr=s(Ir);if(jr==null)ot=0;else{var Cr=_t.K[0],hr=_t.w;for(jr[0]=_t.K[0][0],wt=1;wt<1*qt;++wt)jr[wt]=$e(Cr[hr+wt],jr[wt-1]);for(;wt<4*Ir;++wt)jr[wt]=0;_t.K[0]=null,_t.K[0]=jr,ot=1}}Ve=ot;break;case 2:break;default:t(0)}ee=Ve}}if(re=re[0],oe=oe[0],ee&&z(fe,1)&&!(ee=1<=(Qe=z(fe,4))&&11>=Qe)){Q.a=3;break e}var Vr;if(Vr=ee)t:{var qr,ir,Ka,Ci=Q,Ha=re,Bi=oe,Lr=Qe,Pi=F,Qi=Ci.m,un=Ci.s,wn=[null],oi=1,us=0,to=_S[Lr];r:for(;;){if(Pi&&z(Qi,1)){var fn=z(Qi,3)+2,Ro=Ze(Ha,fn),Bc=Ze(Bi,fn),Pl=Ro*Bc;if(!be(Ro,Bc,0,Ci,wn))break r;for(wn=wn[0],un.xc=fn,qr=0;qr<Pl;++qr){var xA=wn[qr]>>8&65535;wn[qr]=xA,xA>=oi&&(oi=xA+1)}}if(Qi.h)break r;for(ir=0;5>ir;++ir){var va=Gy[ir];!ir&&0<Lr&&(va+=1<<Lr),us<va&&(us=va)}var Ag=o(oi*to,R),tv=oi,rv=o(tv,N);if(rv==null)var q0=null;else t(65536>=tv),q0=rv;var Eu=s(us);if(q0==null||Eu==null||Ag==null){Ci.a=1;break r}var K0=Ag;for(qr=Ka=0;qr<oi;++qr){var js=q0[qr],Ql=js.G,ql=js.H,av=0,H0=1,nv=0;for(ir=0;5>ir;++ir){va=Gy[ir],Ql[ir]=K0,ql[ir]=Ka,!ir&&0<Lr&&(va+=1<<Lr);n:{var G0,cg=va,z0=Ci,_u=Eu,HS=K0,GS=Ka,lg=0,yA=z0.m,zS=z(yA,1);if(n(_u,0,0,cg),zS){var VS=z(yA,1)+1,$S=z(yA,1),iv=z(yA,$S==0?1:8);_u[iv]=1,VS==2&&(_u[iv=z(yA,8)]=1);var V0=1}else{var sv=s(19),ov=z(yA,4)+4;if(19<ov){z0.a=3;var $0=0;break n}for(G0=0;G0<ov;++G0)sv[wS[G0]]=z(yA,3);var dg=void 0,bu=void 0,Av=z0,YS=sv,Y0=cg,cv=_u,ug=0,vA=Av.m,lv=8,dv=o(128,R);a:for(;T(dv,0,7,YS,19);){if(z(vA,1)){var WS=2+2*z(vA,3);if((dg=2+z(vA,WS))>Y0)break a}else dg=Y0;for(bu=0;bu<Y0&&dg--;){Y(vA);var uv=dv[0+(127&k(vA))];q(vA,vA.u+uv.g);var Kl=uv.value;if(16>Kl)cv[bu++]=Kl,Kl!=0&&(lv=Kl);else{var XS=Kl==16,fv=Kl-16,JS=yS[fv],pv=z(vA,xS[fv])+JS;if(bu+pv>Y0)break a;for(var ZS=XS?lv:0;0<pv--;)cv[bu++]=ZS}}ug=1;break a}ug||(Av.a=3),V0=ug}(V0=V0&&!yA.h)&&(lg=T(HS,GS,8,_u,cg)),V0&&lg!=0?$0=lg:(z0.a=3,$0=0)}if($0==0)break r;if(H0&&vS[ir]==1&&(H0=K0[Ka].g==0),av+=K0[Ka].g,Ka+=$0,3>=ir){var Cu,fg=Eu[0];for(Cu=1;Cu<va;++Cu)Eu[Cu]>fg&&(fg=Eu[Cu]);nv+=fg}}if(js.nd=H0,js.Qb=0,H0&&(js.qb=(Ql[3][ql[3]+0].value<<24|Ql[1][ql[1]+0].value<<16|Ql[2][ql[2]+0].value)>>>0,av==0&&256>Ql[0][ql[0]+0].value&&(js.Qb=1,js.qb+=Ql[0][ql[0]+0].value<<8)),js.jc=!js.Qb&&6>nv,js.jc){var W0,ko=js;for(W0=0;W0<vn;++W0){var wA=W0,EA=ko.pd[wA],X0=ko.G[0][ko.H[0]+wA];256<=X0.value?(EA.g=X0.g+256,EA.value=X0.value):(EA.g=0,EA.value=0,wA>>=ca(X0,8,EA),wA>>=ca(ko.G[1][ko.H[1]+wA],16,EA),wA>>=ca(ko.G[2][ko.H[2]+wA],0,EA),ca(ko.G[3][ko.H[3]+wA],24,EA))}}}un.vc=wn,un.Wb=oi,un.Ya=q0,un.yc=Ag,Vr=1;break t}Vr=0}if(!(ee=Vr)){Q.a=3;break e}if(0<Qe){if(he.ua=1<<Qe,!Ee(he.Wa,Qe)){Q.a=1,ee=0;break e}}else he.ua=0;var pg=Q,hv=re,eT=oe,hg=pg.s,mg=hg.xc;if(pg.c=hv,pg.i=eT,hg.md=Ze(hv,mg),hg.wc=mg==0?-1:(1<<mg)-1,F){Q.xb=NS;break e}if((Oe=s(re*oe))==null){Q.a=1,ee=0;break e}ee=(ee=ce(Q,Oe,0,re,oe,oe,null))&&!fe.h;break e}return ee?(X!=null?X[0]=Oe:(t(Oe==null),t(F)),Q.$=0,F||Se(he)):Se(he),ee}function ke(m,w){var F=m.c*m.i,Q=F+w+16*w;return t(m.c<=w),m.V=s(Q),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+F+w,1)}function Ue(m,w){var F=m.C,Q=w-F,X=m.V,ee=m.Ba+m.c*F;for(t(w<=m.l.o);0<Q;){var re=16<Q?16:Q,oe=m.l.ma,fe=m.l.width,he=fe*re,Oe=oe.ca,Qe=oe.tb+fe*F,qe=m.Ta,Le=m.Ua;H(m,re,X,ee),Na(qe,Le,Oe,Qe,he),Z(oe,F,F+re,Oe,Qe,fe),Q-=re,X+=re*m.c,F+=re}t(F==w),m.C=m.Ma=w}function ze(){this.ub=this.yd=this.td=this.Rb=0}function dt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function pt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function st(){this.Yb=function(){var m=[];return function w(F,Q,X){for(var ee=X[Q],re=0;re<ee&&(F.push(X.length>Q+1?[]:0),!(X.length<Q+1));re++)w(F[re],Q+1,X)}(m,0,[3,11]),m}()}function ht(){this.jb=s(3),this.Wc=A([4,8],st),this.Xc=A([4,17],st)}function Qt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function xr(){this.ld=this.La=this.dd=this.tc=0}function br(){this.Na=this.la=0}function xa(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function wi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ei(){this.uc=this.M=this.Nb=0,this.wa=Array(new xr),this.Y=0,this.ya=Array(new wi),this.aa=0,this.l=new is}function Fn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ji(){this.cb=this.a=0,this.sc="",this.m=new G,this.Od=new ze,this.Kc=new dt,this.ed=new Qt,this.Qa=new pt,this.Ic=this.$c=this.Aa=0,this.D=new Ei,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,G),this.ia=0,this.pb=o(4,xa),this.Pa=new ht,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fn),this.Hd=0,this.rb=Array(new br),this.sb=0,this.wa=Array(new xr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new wi),this.L=this.aa=0,this.gd=A([4,2],xr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function is(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ni(){var m=new ji;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,vu||(vu=Is)),m}function pa(m,w,F){return m.a==0&&(m.a=w,m.sc=F,m.cb=0),0}function zr(m,w,F){return 3<=F&&m[w+0]==157&&m[w+1]==1&&m[w+2]==42}function en(m,w){if(m==null)return 0;if(m.a=0,m.sc="OK",w==null)return pa(m,2,"null VP8Io passed to VP8GetHeaders()");var F=w.data,Q=w.w,X=w.ha;if(4>X)return pa(m,7,"Truncated header.");var ee=F[Q+0]|F[Q+1]<<8|F[Q+2]<<16,re=m.Od;if(re.Rb=!(1&ee),re.td=ee>>1&7,re.yd=ee>>4&1,re.ub=ee>>5,3<re.td)return pa(m,3,"Incorrect keyframe parameters.");if(!re.yd)return pa(m,4,"Frame not displayable.");Q+=3,X-=3;var oe=m.Kc;if(re.Rb){if(7>X)return pa(m,7,"cannot parse picture header");if(!zr(F,Q,X))return pa(m,3,"Bad code word");oe.c=16383&(F[Q+4]<<8|F[Q+3]),oe.Td=F[Q+4]>>6,oe.i=16383&(F[Q+6]<<8|F[Q+5]),oe.Ud=F[Q+6]>>6,Q+=7,X-=7,m.za=oe.c+15>>4,m.Ub=oe.i+15>>4,w.width=oe.c,w.height=oe.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,n((ee=m.Pa).jb,0,255,ee.jb.length),t((ee=m.Qa)!=null),ee.Cb=0,ee.Bb=0,ee.Fb=1,n(ee.Zb,0,0,ee.Zb.length),n(ee.Lb,0,0,ee.Lb)}if(re.ub>X)return pa(m,7,"bad partition length");P(ee=m.m,F,Q,re.ub),Q+=re.ub,X-=re.ub,re.Rb&&(oe.Ld=ue(ee),oe.Kd=ue(ee)),oe=m.Qa;var fe,he=m.Pa;if(t(ee!=null),t(oe!=null),oe.Cb=ue(ee),oe.Cb){if(oe.Bb=ue(ee),ue(ee)){for(oe.Fb=ue(ee),fe=0;4>fe;++fe)oe.Zb[fe]=ue(ee)?V(ee,7):0;for(fe=0;4>fe;++fe)oe.Lb[fe]=ue(ee)?V(ee,6):0}if(oe.Bb)for(fe=0;3>fe;++fe)he.jb[fe]=ue(ee)?U(ee,8):255}else oe.Bb=0;if(ee.Ka)return pa(m,3,"cannot parse segment header");if((oe=m.ed).zd=ue(ee),oe.Tb=U(ee,6),oe.wb=U(ee,3),oe.Pc=ue(ee),oe.Pc&&ue(ee)){for(he=0;4>he;++he)ue(ee)&&(oe.vd[he]=V(ee,6));for(he=0;4>he;++he)ue(ee)&&(oe.od[he]=V(ee,6))}if(m.L=oe.Tb==0?0:oe.zd?1:2,ee.Ka)return pa(m,3,"cannot parse filter header");var Oe=X;if(X=fe=Q,Q=fe+Oe,oe=Oe,m.Xb=(1<<U(m.m,2))-1,Oe<3*(he=m.Xb))F=7;else{for(fe+=3*he,oe-=3*he,Oe=0;Oe<he;++Oe){var Qe=F[X+0]|F[X+1]<<8|F[X+2]<<16;Qe>oe&&(Qe=oe),P(m.Jc[+Oe],F,fe,Qe),fe+=Qe,oe-=Qe,X+=3}P(m.Jc[+he],F,fe,oe),F=fe<Q?0:5}if(F!=0)return pa(m,F,"cannot parse partitions");for(F=U(fe=m.m,7),X=ue(fe)?V(fe,4):0,Q=ue(fe)?V(fe,4):0,oe=ue(fe)?V(fe,4):0,he=ue(fe)?V(fe,4):0,fe=ue(fe)?V(fe,4):0,Oe=m.Qa,Qe=0;4>Qe;++Qe){if(Oe.Cb){var qe=Oe.Zb[Qe];Oe.Fb||(qe+=F)}else{if(0<Qe){m.pb[Qe]=m.pb[0];continue}qe=F}var Le=m.pb[Qe];Le.Sc[0]=ig[Ui(qe+X,127)],Le.Sc[1]=sg[Ui(qe+0,127)],Le.Eb[0]=2*ig[Ui(qe+Q,127)],Le.Eb[1]=101581*sg[Ui(qe+oe,127)]>>16,8>Le.Eb[1]&&(Le.Eb[1]=8),Le.Qc[0]=ig[Ui(qe+he,117)],Le.Qc[1]=sg[Ui(qe+fe,127)],Le.lc=qe+fe}if(!re.Rb)return pa(m,4,"Not a key frame.");for(ue(ee),re=m.Pa,F=0;4>F;++F){for(X=0;8>X;++X)for(Q=0;3>Q;++Q)for(oe=0;11>oe;++oe)he=pe(ee,OS[F][X][Q][oe])?U(ee,8):SS[F][X][Q][oe],re.Wc[F][X].Yb[Q][oe]=he;for(X=0;17>X;++X)re.Xc[F][X]=re.Wc[F][IS[X]]}return m.kc=ue(ee),m.kc&&(m.Bd=U(ee,8)),m.cb=1}function Is(m,w,F,Q,X,ee,re){var oe=w[X].Yb[F];for(F=0;16>X;++X){if(!pe(m,oe[F+0]))return X;for(;!pe(m,oe[F+1]);)if(oe=w[++X].Yb[0],F=0,X==16)return 16;var fe=w[X+1].Yb;if(pe(m,oe[F+2])){var he=m,Oe=0;if(pe(he,(qe=oe)[(Qe=F)+3]))if(pe(he,qe[Qe+6])){for(oe=0,Qe=2*(Oe=pe(he,qe[Qe+8]))+(qe=pe(he,qe[Qe+9+Oe])),Oe=0,qe=CS[Qe];qe[oe];++oe)Oe+=Oe+pe(he,qe[oe]);Oe+=3+(8<<Qe)}else pe(he,qe[Qe+7])?(Oe=7+2*pe(he,165),Oe+=pe(he,145)):Oe=5+pe(he,159);else Oe=pe(he,qe[Qe+4])?3+pe(he,qe[Qe+5]):2;oe=fe[2]}else Oe=1,oe=fe[1];fe=re+BS[X],0>(he=m).b&&de(he);var Qe,qe=he.b,Le=(Qe=he.Ca>>1)-(he.I>>qe)>>31;--he.b,he.Ca+=Le,he.Ca|=1,he.I-=(Qe+1&Le)<<qe,ee[fe]=((Oe^Le)-Le)*Q[(0<X)+0]}return 16}function Ns(m){var w=m.rb[m.sb-1];w.la=0,w.Na=0,n(m.zc,0,0,m.zc.length),m.ja=0}function El(m,w){if(m==null)return 0;if(w==null)return pa(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!en(m,w))return 0;if(t(m.cb),w.ac==null||w.ac(w)){w.ob&&(m.L=0);var F=Q0[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=w.v-F>>4,m.zb=w.j-F>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=w.o+15+F>>4,m.Hb=w.va+15+F>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var Q=m.ed;for(F=0;4>F;++F){var X;if(m.Qa.Cb){var ee=m.Qa.Lb[F];m.Qa.Fb||(ee+=Q.Tb)}else ee=Q.Tb;for(X=0;1>=X;++X){var re=m.gd[F][X],oe=ee;if(Q.Pc&&(oe+=Q.vd[0],X&&(oe+=Q.od[0])),0<(oe=0>oe?0:63<oe?63:oe)){var fe=oe;0<Q.wb&&(fe=4<Q.wb?fe>>2:fe>>1)>9-Q.wb&&(fe=9-Q.wb),1>fe&&(fe=1),re.dd=fe,re.tc=2*oe+fe,re.ld=40<=oe?2:15<=oe?1:0}else re.tc=0;re.La=X}}}F=0}else pa(m,6,"Frame setup failed"),F=m.a;if(F=F==0){if(F){m.$c=0,0<m.Aa||(m.Ic=KS);e:{F=m.Ic,Q=4*(fe=m.za);var he=32*fe,Oe=fe+1,Qe=0<m.L?fe*(0<m.Aa?2:1):0,qe=(m.Aa==2?2:1)*fe;if((re=Q+832+(X=3*(16*F+Q0[m.L])/2*he)+(ee=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=re)F=0;else{if(re>m.Vb){if(m.Vb=0,m.Ec=s(re),m.Fc=0,m.Ec==null){F=pa(m,1,"no memory during frame initialization.");break e}m.Vb=re}re=m.Ec,oe=m.Fc,m.Ac=re,m.Bc=oe,oe+=Q,m.Gd=o(he,Fn),m.Hd=0,m.rb=o(Oe+1,br),m.sb=1,m.wa=Qe?o(Qe,xr):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=fe),t(!0),m.oc=re,m.pc=oe,oe+=832,m.ya=o(qe,wi),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=fe),m.R=16*fe,m.B=8*fe,fe=(he=Q0[m.L])*m.R,he=he/2*m.B,m.sa=re,m.ta=oe+fe,m.qa=m.sa,m.ra=m.ta+16*F*m.R+he,m.Ha=m.qa,m.Ia=m.ra+8*F*m.B+he,m.$c=0,oe+=X,m.mb=ee?re:null,m.nb=ee?oe:null,t(oe+ee<=m.Fc+m.Vb),Ns(m),n(m.Ac,m.Bc,0,Q),F=1}}if(F){if(w.ka=0,w.y=m.sa,w.O=m.ta,w.f=m.qa,w.N=m.ra,w.ea=m.Ha,w.Vd=m.Ia,w.fa=m.R,w.Rc=m.B,w.F=null,w.J=0,!F0){for(F=-255;255>=F;++F)rn[255+F]=0>F?-F:F;for(F=-1020;1020>=F;++F)No[1020+F]=-128>F?-128:127<F?127:F;for(F=-112;112>=F;++F)yu[112+F]=-16>F?-16:15<F?15:F;for(F=-255;510>=F;++F)Ml[255+F]=0>F?0:255<F?255:F;F0=1}jl=m0,Io=Jd,mu=Fs,si=bo,os=Co,Ia=AA,Ll=au,N0=yc,gu=Xm,Ec=nu,_c=Wm,pA=Sl,bc=iu,Ul=C0,Cc=b0,hA=Zs,xu=So,As=Ym,Ds[0]=Js,Ds[1]=Zd,Ds[2]=Km,Ds[3]=Hm,Ds[4]=y0,Ds[5]=Cl,Ds[6]=v0,Ds[7]=eu,Ds[8]=zm,Ds[9]=Gm,mA[0]=g0,mA[1]=Qm,mA[2]=Bo,mA[3]=_l,mA[4]=Rn,mA[5]=qm,mA[6]=x0,Fo[0]=cA,Fo[1]=Pm,Fo[2]=Vm,Fo[3]=tu,Fo[4]=xc,Fo[5]=$m,Fo[6]=ru,F=1}else F=0}F&&(F=function(Le,nt){for(Le.M=0;Le.M<Le.Va;++Le.M){var Ve,Ie=Le.Jc[Le.M&Le.Xb],De=Le.m,tt=Le;for(Ve=0;Ve<tt.za;++Ve){var ot=De,rt=tt,Ot=rt.Ac,wt=rt.Bc+4*Ve,qt=rt.zc,_t=rt.ya[rt.aa+Ve];if(rt.Qa.Bb?_t.$b=pe(ot,rt.Pa.jb[0])?2+pe(ot,rt.Pa.jb[2]):pe(ot,rt.Pa.jb[1]):_t.$b=0,rt.kc&&(_t.Ad=pe(ot,rt.Bd)),_t.Za=!pe(ot,145)+0,_t.Za){var Ir=_t.Ob,jr=0;for(rt=0;4>rt;++rt){var Cr,hr=qt[0+rt];for(Cr=0;4>Cr;++Cr){hr=TS[Ot[wt+Cr]][hr];for(var Vr=zy[pe(ot,hr[0])];0<Vr;)Vr=zy[2*Vr+pe(ot,hr[Vr])];hr=-Vr,Ot[wt+Cr]=hr}a(Ir,jr,Ot,wt,4),jr+=4,qt[0+rt]=hr}}else hr=pe(ot,156)?pe(ot,128)?1:3:pe(ot,163)?2:0,_t.Ob[0]=hr,n(Ot,wt,hr,4),n(qt,0,hr,4);_t.Dd=pe(ot,142)?pe(ot,114)?pe(ot,183)?1:3:2:0}if(tt.m.Ka)return pa(Le,7,"Premature end-of-partition0 encountered.");for(;Le.ja<Le.za;++Le.ja){if(tt=Ie,ot=(De=Le).rb[De.sb-1],Ot=De.rb[De.sb+De.ja],Ve=De.ya[De.aa+De.ja],wt=De.kc?Ve.Ad:0)ot.la=Ot.la=0,Ve.Za||(ot.Na=Ot.Na=0),Ve.Hc=0,Ve.Gc=0,Ve.ia=0;else{var qr,ir;if(ot=Ot,Ot=tt,wt=De.Pa.Xc,qt=De.ya[De.aa+De.ja],_t=De.pb[qt.$b],rt=qt.ad,Ir=0,jr=De.rb[De.sb-1],hr=Cr=0,n(rt,Ir,0,384),qt.Za)var Ka=0,Ci=wt[3];else{Vr=s(16);var Ha=ot.Na+jr.Na;if(Ha=vu(Ot,wt[1],Ha,_t.Eb,0,Vr,0),ot.Na=jr.Na=(0<Ha)+0,1<Ha)jl(Vr,0,rt,Ir);else{var Bi=Vr[0]+3>>3;for(Vr=0;256>Vr;Vr+=16)rt[Ir+Vr]=Bi}Ka=1,Ci=wt[0]}var Lr=15&ot.la,Pi=15&jr.la;for(Vr=0;4>Vr;++Vr){var Qi=1&Pi;for(Bi=ir=0;4>Bi;++Bi)Lr=Lr>>1|(Qi=(Ha=vu(Ot,Ci,Ha=Qi+(1&Lr),_t.Sc,Ka,rt,Ir))>Ka)<<7,ir=ir<<2|(3<Ha?3:1<Ha?2:rt[Ir+0]!=0),Ir+=16;Lr>>=4,Pi=Pi>>1|Qi<<7,Cr=(Cr<<8|ir)>>>0}for(Ci=Lr,Ka=Pi>>4,qr=0;4>qr;qr+=2){for(ir=0,Lr=ot.la>>4+qr,Pi=jr.la>>4+qr,Vr=0;2>Vr;++Vr){for(Qi=1&Pi,Bi=0;2>Bi;++Bi)Ha=Qi+(1&Lr),Lr=Lr>>1|(Qi=0<(Ha=vu(Ot,wt[2],Ha,_t.Qc,0,rt,Ir)))<<3,ir=ir<<2|(3<Ha?3:1<Ha?2:rt[Ir+0]!=0),Ir+=16;Lr>>=2,Pi=Pi>>1|Qi<<5}hr|=ir<<4*qr,Ci|=Lr<<4<<qr,Ka|=(240&Pi)<<qr}ot.la=Ci,jr.la=Ka,qt.Hc=Cr,qt.Gc=hr,qt.ia=43690&hr?0:_t.ia,wt=!(Cr|hr)}if(0<De.L&&(De.wa[De.Y+De.ja]=De.gd[Ve.$b][Ve.Za],De.wa[De.Y+De.ja].La|=!wt),tt.Ka)return pa(Le,7,"Premature end-of-file encountered.")}if(Ns(Le),De=nt,tt=1,Ve=(Ie=Le).D,ot=0<Ie.L&&Ie.M>=Ie.zb&&Ie.M<=Ie.Va,Ie.Aa==0)e:{if(Ve.M=Ie.M,Ve.uc=ot,du(Ie,Ve),tt=1,Ve=(ir=Ie.D).Nb,ot=(hr=Q0[Ie.L])*Ie.R,Ot=hr/2*Ie.B,Vr=16*Ve*Ie.R,Bi=8*Ve*Ie.B,wt=Ie.sa,qt=Ie.ta-ot+Vr,_t=Ie.qa,rt=Ie.ra-Ot+Bi,Ir=Ie.Ha,jr=Ie.Ia-Ot+Bi,Pi=(Lr=ir.M)==0,Cr=Lr>=Ie.Va-1,Ie.Aa==2&&du(Ie,ir),ir.uc)for(Qi=(Ha=Ie).D.M,t(Ha.D.uc),ir=Ha.yb;ir<Ha.Hb;++ir){Ka=ir,Ci=Qi;var un=(wn=(va=Ha).D).Nb;qr=va.R;var wn=wn.wa[wn.Y+Ka],oi=va.sa,us=va.ta+16*un*qr+16*Ka,to=wn.dd,fn=wn.tc;if(fn!=0)if(t(3<=fn),va.L==1)0<Ka&&hA(oi,us,qr,fn+4),wn.La&&As(oi,us,qr,fn),0<Ci&&Cc(oi,us,qr,fn+4),wn.La&&xu(oi,us,qr,fn);else{var Ro=va.B,Bc=va.qa,Pl=va.ra+8*un*Ro+8*Ka,xA=va.Ha,va=va.Ia+8*un*Ro+8*Ka;un=wn.ld,0<Ka&&(N0(oi,us,qr,fn+4,to,un),Ec(Bc,Pl,xA,va,Ro,fn+4,to,un)),wn.La&&(pA(oi,us,qr,fn,to,un),Ul(Bc,Pl,xA,va,Ro,fn,to,un)),0<Ci&&(Ll(oi,us,qr,fn+4,to,un),gu(Bc,Pl,xA,va,Ro,fn+4,to,un)),wn.La&&(_c(oi,us,qr,fn,to,un),bc(Bc,Pl,xA,va,Ro,fn,to,un))}}if(Ie.ia&&alert("todo:DitherRow"),De.put!=null){if(ir=16*Lr,Lr=16*(Lr+1),Pi?(De.y=Ie.sa,De.O=Ie.ta+Vr,De.f=Ie.qa,De.N=Ie.ra+Bi,De.ea=Ie.Ha,De.W=Ie.Ia+Bi):(ir-=hr,De.y=wt,De.O=qt,De.f=_t,De.N=rt,De.ea=Ir,De.W=jr),Cr||(Lr-=hr),Lr>De.o&&(Lr=De.o),De.F=null,De.J=null,Ie.Fa!=null&&0<Ie.Fa.length&&ir<Lr&&(De.J=cu(Ie,De,ir,Lr-ir),De.F=Ie.mb,De.F==null&&De.F.length==0)){tt=pa(Ie,3,"Could not decode alpha data.");break e}ir<De.j&&(hr=De.j-ir,ir=De.j,t(!(1&hr)),De.O+=Ie.R*hr,De.N+=Ie.B*(hr>>1),De.W+=Ie.B*(hr>>1),De.F!=null&&(De.J+=De.width*hr)),ir<Lr&&(De.O+=De.v,De.N+=De.v>>1,De.W+=De.v>>1,De.F!=null&&(De.J+=De.v),De.ka=ir-De.j,De.U=De.va-De.v,De.T=Lr-ir,tt=De.put(De))}Ve+1!=Ie.Ic||Cr||(a(Ie.sa,Ie.ta-ot,wt,qt+16*Ie.R,ot),a(Ie.qa,Ie.ra-Ot,_t,rt+8*Ie.B,Ot),a(Ie.Ha,Ie.Ia-Ot,Ir,jr+8*Ie.B,Ot))}if(!tt)return pa(Le,6,"Output aborted.")}return 1}(m,w)),w.bc!=null&&w.bc(w),F&=1}return F?(m.cb=0,F):0}function Li(m,w,F,Q,X){X=m[w+F+32*Q]+(X>>3),m[w+F+32*Q]=-256&X?0>X?0:255:X}function _o(m,w,F,Q,X,ee){Li(m,w,0,F,Q+X),Li(m,w,1,F,Q+ee),Li(m,w,2,F,Q-ee),Li(m,w,3,F,Q-X)}function tn(m){return(20091*m>>16)+m}function oA(m,w,F,Q){var X,ee=0,re=s(16);for(X=0;4>X;++X){var oe=m[w+0]+m[w+8],fe=m[w+0]-m[w+8],he=(35468*m[w+4]>>16)-tn(m[w+12]),Oe=tn(m[w+4])+(35468*m[w+12]>>16);re[ee+0]=oe+Oe,re[ee+1]=fe+he,re[ee+2]=fe-he,re[ee+3]=oe-Oe,ee+=4,w++}for(X=ee=0;4>X;++X)oe=(m=re[ee+0]+4)+re[ee+8],fe=m-re[ee+8],he=(35468*re[ee+4]>>16)-tn(re[ee+12]),Li(F,Q,0,0,oe+(Oe=tn(re[ee+4])+(35468*re[ee+12]>>16))),Li(F,Q,1,0,fe+he),Li(F,Q,2,0,fe-he),Li(F,Q,3,0,oe-Oe),ee++,Q+=32}function AA(m,w,F,Q){var X=m[w+0]+4,ee=35468*m[w+4]>>16,re=tn(m[w+4]),oe=35468*m[w+1]>>16;_o(F,Q,0,X+re,m=tn(m[w+1]),oe),_o(F,Q,1,X+ee,m,oe),_o(F,Q,2,X-ee,m,oe),_o(F,Q,3,X-re,m,oe)}function Jd(m,w,F,Q,X){oA(m,w,F,Q),X&&oA(m,w+16,F,Q+4)}function Fs(m,w,F,Q){Io(m,w+0,F,Q,1),Io(m,w+32,F,Q+128,1)}function bo(m,w,F,Q){var X;for(m=m[w+0]+4,X=0;4>X;++X)for(w=0;4>w;++w)Li(F,Q,w,X,m)}function Co(m,w,F,Q){m[w+0]&&si(m,w+0,F,Q),m[w+16]&&si(m,w+16,F,Q+4),m[w+32]&&si(m,w+32,F,Q+128),m[w+48]&&si(m,w+48,F,Q+128+4)}function m0(m,w,F,Q){var X,ee=s(16);for(X=0;4>X;++X){var re=m[w+0+X]+m[w+12+X],oe=m[w+4+X]+m[w+8+X],fe=m[w+4+X]-m[w+8+X],he=m[w+0+X]-m[w+12+X];ee[0+X]=re+oe,ee[8+X]=re-oe,ee[4+X]=he+fe,ee[12+X]=he-fe}for(X=0;4>X;++X)re=(m=ee[0+4*X]+3)+ee[3+4*X],oe=ee[1+4*X]+ee[2+4*X],fe=ee[1+4*X]-ee[2+4*X],he=m-ee[3+4*X],F[Q+0]=re+oe>>3,F[Q+16]=he+fe>>3,F[Q+32]=re-oe>>3,F[Q+48]=he-fe>>3,Q+=64}function mc(m,w,F){var Q,X=w-32,ee=Mi,re=255-m[X-1];for(Q=0;Q<F;++Q){var oe,fe=ee,he=re+m[w-1];for(oe=0;oe<F;++oe)m[w+oe]=fe[he+m[X+oe]];w+=32}}function Zd(m,w){mc(m,w,4)}function Pm(m,w){mc(m,w,8)}function Qm(m,w){mc(m,w,16)}function Bo(m,w){var F;for(F=0;16>F;++F)a(m,w+32*F,m,w-32,16)}function _l(m,w){var F;for(F=16;0<F;--F)n(m,w,m[w-1],16),w+=32}function bl(m,w,F){var Q;for(Q=0;16>Q;++Q)n(w,F+32*Q,m,16)}function g0(m,w){var F,Q=16;for(F=0;16>F;++F)Q+=m[w-1+32*F]+m[w+F-32];bl(Q>>5,m,w)}function Rn(m,w){var F,Q=8;for(F=0;16>F;++F)Q+=m[w-1+32*F];bl(Q>>4,m,w)}function qm(m,w){var F,Q=8;for(F=0;16>F;++F)Q+=m[w+F-32];bl(Q>>4,m,w)}function x0(m,w){bl(128,m,w)}function Jt(m,w,F){return m+2*w+F+2>>2}function Km(m,w){var F,Q=w-32;for(Q=new Uint8Array([Jt(m[Q-1],m[Q+0],m[Q+1]),Jt(m[Q+0],m[Q+1],m[Q+2]),Jt(m[Q+1],m[Q+2],m[Q+3]),Jt(m[Q+2],m[Q+3],m[Q+4])]),F=0;4>F;++F)a(m,w+32*F,Q,0,Q.length)}function Hm(m,w){var F=m[w-1],Q=m[w-1+32],X=m[w-1+64],ee=m[w-1+96];ye(m,w+0,16843009*Jt(m[w-1-32],F,Q)),ye(m,w+32,16843009*Jt(F,Q,X)),ye(m,w+64,16843009*Jt(Q,X,ee)),ye(m,w+96,16843009*Jt(X,ee,ee))}function Js(m,w){var F,Q=4;for(F=0;4>F;++F)Q+=m[w+F-32]+m[w-1+32*F];for(Q>>=3,F=0;4>F;++F)n(m,w+32*F,Q,4)}function y0(m,w){var F=m[w-1+0],Q=m[w-1+32],X=m[w-1+64],ee=m[w-1-32],re=m[w+0-32],oe=m[w+1-32],fe=m[w+2-32],he=m[w+3-32];m[w+0+96]=Jt(Q,X,m[w-1+96]),m[w+1+96]=m[w+0+64]=Jt(F,Q,X),m[w+2+96]=m[w+1+64]=m[w+0+32]=Jt(ee,F,Q),m[w+3+96]=m[w+2+64]=m[w+1+32]=m[w+0+0]=Jt(re,ee,F),m[w+3+64]=m[w+2+32]=m[w+1+0]=Jt(oe,re,ee),m[w+3+32]=m[w+2+0]=Jt(fe,oe,re),m[w+3+0]=Jt(he,fe,oe)}function v0(m,w){var F=m[w+1-32],Q=m[w+2-32],X=m[w+3-32],ee=m[w+4-32],re=m[w+5-32],oe=m[w+6-32],fe=m[w+7-32];m[w+0+0]=Jt(m[w+0-32],F,Q),m[w+1+0]=m[w+0+32]=Jt(F,Q,X),m[w+2+0]=m[w+1+32]=m[w+0+64]=Jt(Q,X,ee),m[w+3+0]=m[w+2+32]=m[w+1+64]=m[w+0+96]=Jt(X,ee,re),m[w+3+32]=m[w+2+64]=m[w+1+96]=Jt(ee,re,oe),m[w+3+64]=m[w+2+96]=Jt(re,oe,fe),m[w+3+96]=Jt(oe,fe,fe)}function Cl(m,w){var F=m[w-1+0],Q=m[w-1+32],X=m[w-1+64],ee=m[w-1-32],re=m[w+0-32],oe=m[w+1-32],fe=m[w+2-32],he=m[w+3-32];m[w+0+0]=m[w+1+64]=ee+re+1>>1,m[w+1+0]=m[w+2+64]=re+oe+1>>1,m[w+2+0]=m[w+3+64]=oe+fe+1>>1,m[w+3+0]=fe+he+1>>1,m[w+0+96]=Jt(X,Q,F),m[w+0+64]=Jt(Q,F,ee),m[w+0+32]=m[w+1+96]=Jt(F,ee,re),m[w+1+32]=m[w+2+96]=Jt(ee,re,oe),m[w+2+32]=m[w+3+96]=Jt(re,oe,fe),m[w+3+32]=Jt(oe,fe,he)}function eu(m,w){var F=m[w+0-32],Q=m[w+1-32],X=m[w+2-32],ee=m[w+3-32],re=m[w+4-32],oe=m[w+5-32],fe=m[w+6-32],he=m[w+7-32];m[w+0+0]=F+Q+1>>1,m[w+1+0]=m[w+0+64]=Q+X+1>>1,m[w+2+0]=m[w+1+64]=X+ee+1>>1,m[w+3+0]=m[w+2+64]=ee+re+1>>1,m[w+0+32]=Jt(F,Q,X),m[w+1+32]=m[w+0+96]=Jt(Q,X,ee),m[w+2+32]=m[w+1+96]=Jt(X,ee,re),m[w+3+32]=m[w+2+96]=Jt(ee,re,oe),m[w+3+64]=Jt(re,oe,fe),m[w+3+96]=Jt(oe,fe,he)}function Gm(m,w){var F=m[w-1+0],Q=m[w-1+32],X=m[w-1+64],ee=m[w-1+96];m[w+0+0]=F+Q+1>>1,m[w+2+0]=m[w+0+32]=Q+X+1>>1,m[w+2+32]=m[w+0+64]=X+ee+1>>1,m[w+1+0]=Jt(F,Q,X),m[w+3+0]=m[w+1+32]=Jt(Q,X,ee),m[w+3+32]=m[w+1+64]=Jt(X,ee,ee),m[w+3+64]=m[w+2+64]=m[w+0+96]=m[w+1+96]=m[w+2+96]=m[w+3+96]=ee}function zm(m,w){var F=m[w-1+0],Q=m[w-1+32],X=m[w-1+64],ee=m[w-1+96],re=m[w-1-32],oe=m[w+0-32],fe=m[w+1-32],he=m[w+2-32];m[w+0+0]=m[w+2+32]=F+re+1>>1,m[w+0+32]=m[w+2+64]=Q+F+1>>1,m[w+0+64]=m[w+2+96]=X+Q+1>>1,m[w+0+96]=ee+X+1>>1,m[w+3+0]=Jt(oe,fe,he),m[w+2+0]=Jt(re,oe,fe),m[w+1+0]=m[w+3+32]=Jt(F,re,oe),m[w+1+32]=m[w+3+64]=Jt(Q,F,re),m[w+1+64]=m[w+3+96]=Jt(X,Q,F),m[w+1+96]=Jt(ee,X,Q)}function Vm(m,w){var F;for(F=0;8>F;++F)a(m,w+32*F,m,w-32,8)}function tu(m,w){var F;for(F=0;8>F;++F)n(m,w,m[w-1],8),w+=32}function gc(m,w,F){var Q;for(Q=0;8>Q;++Q)n(w,F+32*Q,m,8)}function cA(m,w){var F,Q=8;for(F=0;8>F;++F)Q+=m[w+F-32]+m[w-1+32*F];gc(Q>>4,m,w)}function $m(m,w){var F,Q=4;for(F=0;8>F;++F)Q+=m[w+F-32];gc(Q>>3,m,w)}function xc(m,w){var F,Q=4;for(F=0;8>F;++F)Q+=m[w-1+32*F];gc(Q>>3,m,w)}function ru(m,w){gc(128,m,w)}function Bl(m,w,F){var Q=m[w-F],X=m[w+0],ee=3*(X-Q)+eg[1020+m[w-2*F]-m[w+F]],re=R0[112+(ee+4>>3)];m[w-F]=Mi[255+Q+R0[112+(ee+3>>3)]],m[w+0]=Mi[255+X-re]}function w0(m,w,F,Q){var X=m[w+0],ee=m[w+F];return ls[255+m[w-2*F]-m[w-F]]>Q||ls[255+ee-X]>Q}function E0(m,w,F,Q){return 4*ls[255+m[w-F]-m[w+0]]+ls[255+m[w-2*F]-m[w+F]]<=Q}function _0(m,w,F,Q,X){var ee=m[w-3*F],re=m[w-2*F],oe=m[w-F],fe=m[w+0],he=m[w+F],Oe=m[w+2*F],Qe=m[w+3*F];return 4*ls[255+oe-fe]+ls[255+re-he]>Q?0:ls[255+m[w-4*F]-ee]<=X&&ls[255+ee-re]<=X&&ls[255+re-oe]<=X&&ls[255+Qe-Oe]<=X&&ls[255+Oe-he]<=X&&ls[255+he-fe]<=X}function b0(m,w,F,Q){var X=2*Q+1;for(Q=0;16>Q;++Q)E0(m,w+Q,F,X)&&Bl(m,w+Q,F)}function Zs(m,w,F,Q){var X=2*Q+1;for(Q=0;16>Q;++Q)E0(m,w+Q*F,1,X)&&Bl(m,w+Q*F,1)}function So(m,w,F,Q){var X;for(X=3;0<X;--X)b0(m,w+=4*F,F,Q)}function Ym(m,w,F,Q){var X;for(X=3;0<X;--X)Zs(m,w+=4,F,Q)}function lA(m,w,F,Q,X,ee,re,oe){for(ee=2*ee+1;0<X--;){if(_0(m,w,F,ee,re))if(w0(m,w,F,oe))Bl(m,w,F);else{var fe=m,he=w,Oe=F,Qe=fe[he-2*Oe],qe=fe[he-Oe],Le=fe[he+0],nt=fe[he+Oe],Ve=fe[he+2*Oe],Ie=27*(tt=eg[1020+3*(Le-qe)+eg[1020+Qe-nt]])+63>>7,De=18*tt+63>>7,tt=9*tt+63>>7;fe[he-3*Oe]=Mi[255+fe[he-3*Oe]+tt],fe[he-2*Oe]=Mi[255+Qe+De],fe[he-Oe]=Mi[255+qe+Ie],fe[he+0]=Mi[255+Le-Ie],fe[he+Oe]=Mi[255+nt-De],fe[he+2*Oe]=Mi[255+Ve-tt]}w+=Q}}function Rs(m,w,F,Q,X,ee,re,oe){for(ee=2*ee+1;0<X--;){if(_0(m,w,F,ee,re))if(w0(m,w,F,oe))Bl(m,w,F);else{var fe=m,he=w,Oe=F,Qe=fe[he-Oe],qe=fe[he+0],Le=fe[he+Oe],nt=R0[112+((Ve=3*(qe-Qe))+4>>3)],Ve=R0[112+(Ve+3>>3)],Ie=nt+1>>1;fe[he-2*Oe]=Mi[255+fe[he-2*Oe]+Ie],fe[he-Oe]=Mi[255+Qe+Ve],fe[he+0]=Mi[255+qe-nt],fe[he+Oe]=Mi[255+Le-Ie]}w+=Q}}function au(m,w,F,Q,X,ee){lA(m,w,F,1,16,Q,X,ee)}function yc(m,w,F,Q,X,ee){lA(m,w,1,F,16,Q,X,ee)}function Wm(m,w,F,Q,X,ee){var re;for(re=3;0<re;--re)Rs(m,w+=4*F,F,1,16,Q,X,ee)}function Sl(m,w,F,Q,X,ee){var re;for(re=3;0<re;--re)Rs(m,w+=4,1,F,16,Q,X,ee)}function Xm(m,w,F,Q,X,ee,re,oe){lA(m,w,X,1,8,ee,re,oe),lA(F,Q,X,1,8,ee,re,oe)}function nu(m,w,F,Q,X,ee,re,oe){lA(m,w,1,X,8,ee,re,oe),lA(F,Q,1,X,8,ee,re,oe)}function iu(m,w,F,Q,X,ee,re,oe){Rs(m,w+4*X,X,1,8,ee,re,oe),Rs(F,Q+4*X,X,1,8,ee,re,oe)}function C0(m,w,F,Q,X,ee,re,oe){Rs(m,w+4,1,X,8,ee,re,oe),Rs(F,Q+4,1,X,8,ee,re,oe)}function Tl(){this.ba=new ri,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Dr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function su(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ou(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function B0(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new N,this.yc=new R}function Jm(){this.xb=this.a=0,this.l=new is,this.ca=new ri,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new b,this.Pb=0,this.wd=new b,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new B0,this.ab=0,this.gc=o(4,ou),this.Oc=0}function Ol(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new is,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vc(m,w,F,Q,X,ee,re){for(m=m==null?0:m[w+0],w=0;w<re;++w)X[ee+w]=m+F[Q+w]&255,m=X[ee+w]}function Au(m,w,F,Q,X,ee,re){var oe;if(m==null)vc(null,null,F,Q,X,ee,re);else for(oe=0;oe<re;++oe)X[ee+oe]=m[w+oe]+F[Q+oe]&255}function dA(m,w,F,Q,X,ee,re){if(m==null)vc(null,null,F,Q,X,ee,re);else{var oe,fe=m[w+0],he=fe,Oe=fe;for(oe=0;oe<re;++oe)he=Oe+(fe=m[w+oe])-he,Oe=F[Q+oe]+(-256&he?0>he?0:255:he)&255,he=fe,X[ee+oe]=Oe}}function cu(m,w,F,Q){var X=w.width,ee=w.o;if(t(m!=null&&w!=null),0>F||0>=Q||F+Q>ee)return null;if(!m.Cc){if(m.ga==null){var re;if(m.ga=new Ol,(re=m.ga==null)||(re=w.width*w.o,t(m.Gb.length==0),m.Gb=s(re),m.Uc=0,m.Gb==null?re=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,re=1),re=!re),!re){re=m.ga;var oe=m.Fa,fe=m.P,he=m.qc,Oe=m.mb,Qe=m.nb,qe=fe+1,Le=he-1,nt=re.l;if(t(oe!=null&&Oe!=null&&w!=null),gA[0]=null,gA[1]=vc,gA[2]=Au,gA[3]=dA,re.ca=Oe,re.tb=Qe,re.c=w.width,re.i=w.height,t(0<re.c&&0<re.i),1>=he)w=0;else if(re.$a=oe[fe+0]>>0&3,re.Z=oe[fe+0]>>2&3,re.Lc=oe[fe+0]>>4&3,fe=oe[fe+0]>>6&3,0>re.$a||1<re.$a||4<=re.Z||1<re.Lc||fe)w=0;else if(nt.put=yi,nt.ac=ga,nt.bc=vi,nt.ma=re,nt.width=w.width,nt.height=w.height,nt.Da=w.Da,nt.v=w.v,nt.va=w.va,nt.j=w.j,nt.o=w.o,re.$a)e:{t(re.$a==1),w=Me();t:for(;;){if(w==null){w=0;break e}if(t(re!=null),re.mc=w,w.c=re.c,w.i=re.i,w.l=re.l,w.l.ma=re,w.l.width=re.c,w.l.height=re.i,w.a=0,ie(w.m,oe,qe,Le),!be(re.c,re.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&te(w.s)?(re.ic=1,oe=w.c*w.i,w.Ta=null,w.Ua=0,w.V=s(oe),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(re.ic=0,w=ke(w,re.c)),!w))break t;w=1;break e}re.mc=null,w=0}else w=Le>=re.c*re.i;re=!w}if(re)return null;m.ga.Lc!=1?m.Ga=0:Q=ee-F}t(m.ga!=null),t(F+Q<=ee);e:{if(w=(oe=m.ga).c,ee=oe.l.o,oe.$a==0){if(qe=m.rc,Le=m.Vc,nt=m.Fa,fe=m.P+1+F*w,he=m.mb,Oe=m.nb+F*w,t(fe<=m.P+m.qc),oe.Z!=0)for(t(gA[oe.Z]!=null),re=0;re<Q;++re)gA[oe.Z](qe,Le,nt,fe,he,Oe,w),qe=he,Le=Oe,Oe+=w,fe+=w;else for(re=0;re<Q;++re)a(he,Oe,nt,fe,w),qe=he,Le=Oe,Oe+=w,fe+=w;m.rc=qe,m.Vc=Le}else{if(t(oe.mc!=null),w=F+Q,t((re=oe.mc)!=null),t(w<=re.i),re.C>=w)w=1;else if(oe.ic||Pe(),oe.ic){oe=re.V,qe=re.Ba,Le=re.c;var Ve=re.i,Ie=(nt=1,fe=re.$/Le,he=re.$%Le,Oe=re.m,Qe=re.s,re.$),De=Le*Ve,tt=Le*w,ot=Qe.wc,rt=Ie<tt?ge(Qe,he,fe):null;t(Ie<=De),t(w<=Ve),t(te(Qe));t:for(;;){for(;!Oe.h&&Ie<tt;){if(he&ot||(rt=ge(Qe,he,fe)),t(rt!=null),Y(Oe),256>(Ve=Za(rt.G[0],rt.H[0],Oe)))oe[qe+Ie]=Ve,++Ie,++he>=Le&&(he=0,++fe<=w&&!(fe%16)&&se(re,fe));else{if(!(280>Ve)){nt=0;break t}Ve=ai(Ve-256,Oe);var Ot,wt=Za(rt.G[4],rt.H[4],Oe);if(Y(Oe),!(Ie>=(wt=Ja(Le,wt=ai(wt,Oe)))&&De-Ie>=Ve)){nt=0;break t}for(Ot=0;Ot<Ve;++Ot)oe[qe+Ie+Ot]=oe[qe+Ie+Ot-wt];for(Ie+=Ve,he+=Ve;he>=Le;)he-=Le,++fe<=w&&!(fe%16)&&se(re,fe);Ie<tt&&he&ot&&(rt=ge(Qe,he,fe))}t(Oe.h==j(Oe))}se(re,fe>w?w:fe);break t}!nt||Oe.h&&Ie<De?(nt=0,re.a=Oe.h?5:3):re.$=Ie,w=nt}else w=ce(re,re.V,re.Ba,re.c,re.i,w,Ue);if(!w){Q=0;break e}}F+Q>=ee&&(m.Cc=1),Q=1}if(!Q)return null;if(m.Cc&&((Q=m.ga)!=null&&(Q.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+F*X}function C(m,w,F,Q,X,ee){for(;0<X--;){var re,oe=m,fe=w+(F?1:0),he=m,Oe=w+(F?0:3);for(re=0;re<Q;++re){var Qe=he[Oe+4*re];Qe!=255&&(Qe*=32897,oe[fe+4*re+0]=oe[fe+4*re+0]*Qe>>23,oe[fe+4*re+1]=oe[fe+4*re+1]*Qe>>23,oe[fe+4*re+2]=oe[fe+4*re+2]*Qe>>23)}w+=ee}}function J(m,w,F,Q,X){for(;0<Q--;){var ee;for(ee=0;ee<F;++ee){var re=m[w+2*ee+0],oe=15&(he=m[w+2*ee+1]),fe=4369*oe,he=(240&he|he>>4)*fe>>16;m[w+2*ee+0]=(240&re|re>>4)*fe>>16&240|(15&re|re<<4)*fe>>16>>4&15,m[w+2*ee+1]=240&he|oe}w+=X}}function xe(m,w,F,Q,X,ee,re,oe){var fe,he,Oe=255;for(he=0;he<X;++he){for(fe=0;fe<Q;++fe){var Qe=m[w+fe];ee[re+4*fe]=Qe,Oe&=Qe}w+=F,re+=oe}return Oe!=255}function Ce(m,w,F,Q,X){var ee;for(ee=0;ee<X;++ee)F[Q+ee]=m[w+ee]>>8}function Pe(){cs=C,ea=J,ta=xe,Na=Ce}function Xe(m,w,F){S[m]=function(Q,X,ee,re,oe,fe,he,Oe,Qe,qe,Le,nt,Ve,Ie,De,tt,ot){var rt,Ot=ot-1>>1,wt=oe[fe+0]|he[Oe+0]<<16,qt=Qe[qe+0]|Le[nt+0]<<16;t(Q!=null);var _t=3*wt+qt+131074>>2;for(w(Q[X+0],255&_t,_t>>16,Ve,Ie),ee!=null&&(_t=3*qt+wt+131074>>2,w(ee[re+0],255&_t,_t>>16,De,tt)),rt=1;rt<=Ot;++rt){var Ir=oe[fe+rt]|he[Oe+rt]<<16,jr=Qe[qe+rt]|Le[nt+rt]<<16,Cr=wt+Ir+qt+jr+524296,hr=Cr+2*(Ir+qt)>>3;_t=hr+wt>>1,wt=(Cr=Cr+2*(wt+jr)>>3)+Ir>>1,w(Q[X+2*rt-1],255&_t,_t>>16,Ve,Ie+(2*rt-1)*F),w(Q[X+2*rt-0],255&wt,wt>>16,Ve,Ie+(2*rt-0)*F),ee!=null&&(_t=Cr+qt>>1,wt=hr+jr>>1,w(ee[re+2*rt-1],255&_t,_t>>16,De,tt+(2*rt-1)*F),w(ee[re+2*rt+0],255&wt,wt>>16,De,tt+(2*rt+0)*F)),wt=Ir,qt=jr}1&ot||(_t=3*wt+qt+131074>>2,w(Q[X+ot-1],255&_t,_t>>16,Ve,Ie+(ot-1)*F),ee!=null&&(_t=3*qt+wt+131074>>2,w(ee[re+ot-1],255&_t,_t>>16,De,tt+(ot-1)*F)))}}function At(){ds[k0]=FS,ds[D0]=$y,ds[Ky]=RS,ds[j0]=Yy,ds[L0]=Wy,ds[tg]=Xy,ds[Hy]=kS,ds[rg]=$y,ds[ag]=Yy,ds[U0]=Wy,ds[ng]=Xy}function Tt(m){return m&-16384?0>m?0:255:m>>DS}function Ut(m,w){return Tt((19077*m>>8)+(26149*w>>8)-14234)}function ar(m,w,F){return Tt((19077*m>>8)-(6419*w>>8)-(13320*F>>8)+8708)}function Zt(m,w){return Tt((19077*m>>8)+(33050*w>>8)-17685)}function Er(m,w,F,Q,X){Q[X+0]=Ut(m,F),Q[X+1]=ar(m,w,F),Q[X+2]=Zt(m,w)}function ha(m,w,F,Q,X){Q[X+0]=Zt(m,w),Q[X+1]=ar(m,w,F),Q[X+2]=Ut(m,F)}function ya(m,w,F,Q,X){var ee=ar(m,w,F);w=ee<<3&224|Zt(m,w)>>3,Q[X+0]=248&Ut(m,F)|ee>>5,Q[X+1]=w}function qa(m,w,F,Q,X){var ee=240&Zt(m,w)|15;Q[X+0]=240&Ut(m,F)|ar(m,w,F)>>4,Q[X+1]=ee}function kn(m,w,F,Q,X){Q[X+0]=255,Er(m,w,F,Q,X+1)}function dn(m,w,F,Q,X){ha(m,w,F,Q,X),Q[X+3]=255}function ks(m,w,F,Q,X){Er(m,w,F,Q,X),Q[X+3]=255}function Ui(m,w){return 0>m?0:m>w?w:m}function eo(m,w,F){S[m]=function(Q,X,ee,re,oe,fe,he,Oe,Qe){for(var qe=Oe+(-2&Qe)*F;Oe!=qe;)w(Q[X+0],ee[re+0],oe[fe+0],he,Oe),w(Q[X+1],ee[re+0],oe[fe+0],he,Oe+F),X+=2,++re,++fe,Oe+=2*F;1&Qe&&w(Q[X+0],ee[re+0],oe[fe+0],he,Oe)}}function S0(m,w,F){return F==0?m==0?w==0?6:5:w==0?4:0:F}function lu(m,w,F,Q,X){switch(m>>>30){case 3:Io(w,F,Q,X,0);break;case 2:Ia(w,F,Q,X);break;case 1:si(w,F,Q,X)}}function du(m,w){var F,Q,X=w.M,ee=w.Nb,re=m.oc,oe=m.pc+40,fe=m.oc,he=m.pc+584,Oe=m.oc,Qe=m.pc+600;for(F=0;16>F;++F)re[oe+32*F-1]=129;for(F=0;8>F;++F)fe[he+32*F-1]=129,Oe[Qe+32*F-1]=129;for(0<X?re[oe-1-32]=fe[he-1-32]=Oe[Qe-1-32]=129:(n(re,oe-32-1,127,21),n(fe,he-32-1,127,9),n(Oe,Qe-32-1,127,9)),Q=0;Q<m.za;++Q){var qe=w.ya[w.aa+Q];if(0<Q){for(F=-1;16>F;++F)a(re,oe+32*F-4,re,oe+32*F+12,4);for(F=-1;8>F;++F)a(fe,he+32*F-4,fe,he+32*F+4,4),a(Oe,Qe+32*F-4,Oe,Qe+32*F+4,4)}var Le=m.Gd,nt=m.Hd+Q,Ve=qe.ad,Ie=qe.Hc;if(0<X&&(a(re,oe-32,Le[nt].y,0,16),a(fe,he-32,Le[nt].f,0,8),a(Oe,Qe-32,Le[nt].ea,0,8)),qe.Za){var De=re,tt=oe-32+16;for(0<X&&(Q>=m.za-1?n(De,tt,Le[nt].y[15],4):a(De,tt,Le[nt+1].y,0,4)),F=0;4>F;F++)De[tt+128+F]=De[tt+256+F]=De[tt+384+F]=De[tt+0+F];for(F=0;16>F;++F,Ie<<=2)De=re,tt=oe+Zy[F],Ds[qe.Ob[F]](De,tt),lu(Ie,Ve,16*+F,De,tt)}else if(De=S0(Q,X,qe.Ob[0]),mA[De](re,oe),Ie!=0)for(F=0;16>F;++F,Ie<<=2)lu(Ie,Ve,16*+F,re,oe+Zy[F]);for(F=qe.Gc,De=S0(Q,X,qe.Dd),Fo[De](fe,he),Fo[De](Oe,Qe),Ie=Ve,De=fe,tt=he,255&(qe=F>>0)&&(170&qe?mu(Ie,256,De,tt):os(Ie,256,De,tt)),qe=Oe,Ie=Qe,255&(F>>=8)&&(170&F?mu(Ve,320,qe,Ie):os(Ve,320,qe,Ie)),X<m.Ub-1&&(a(Le[nt].y,0,re,oe+480,16),a(Le[nt].f,0,fe,he+224,8),a(Le[nt].ea,0,Oe,Qe+224,8)),F=8*ee*m.B,Le=m.sa,nt=m.ta+16*Q+16*ee*m.R,Ve=m.qa,qe=m.ra+8*Q+F,Ie=m.Ha,De=m.Ia+8*Q+F,F=0;16>F;++F)a(Le,nt+F*m.R,re,oe+32*F,16);for(F=0;8>F;++F)a(Ve,qe+F*m.B,fe,he+32*F,8),a(Ie,De+F*m.B,Oe,Qe+32*F,8)}}function Il(m,w,F,Q,X,ee,re,oe,fe){var he=[0],Oe=[0],Qe=0,qe=fe!=null?fe.kd:0,Le=fe??new su;if(m==null||12>F)return 7;Le.data=m,Le.w=w,Le.ha=F,w=[w],F=[F],Le.gb=[Le.gb];e:{var nt=w,Ve=F,Ie=Le.gb;if(t(m!=null),t(Ve!=null),t(Ie!=null),Ie[0]=0,12<=Ve[0]&&!r(m,nt[0],"RIFF")){if(r(m,nt[0]+8,"WEBP")){Ie=3;break e}var De=Ke(m,nt[0]+4);if(12>De||4294967286<De){Ie=3;break e}if(qe&&De>Ve[0]-8){Ie=7;break e}Ie[0]=De,nt[0]+=12,Ve[0]-=12}Ie=0}if(Ie!=0)return Ie;for(De=0<Le.gb[0],F=F[0];;){e:{var tt=m;Ve=w,Ie=F;var ot=he,rt=Oe,Ot=nt=[0];if((_t=Qe=[Qe])[0]=0,8>Ie[0])Ie=7;else{if(!r(tt,Ve[0],"VP8X")){if(Ke(tt,Ve[0]+4)!=10){Ie=3;break e}if(18>Ie[0]){Ie=7;break e}var wt=Ke(tt,Ve[0]+8),qt=1+ae(tt,Ve[0]+12);if(2147483648<=qt*(tt=1+ae(tt,Ve[0]+15))){Ie=3;break e}Ot!=null&&(Ot[0]=wt),ot!=null&&(ot[0]=qt),rt!=null&&(rt[0]=tt),Ve[0]+=18,Ie[0]-=18,_t[0]=1}Ie=0}}if(Qe=Qe[0],nt=nt[0],Ie!=0)return Ie;if(Ve=!!(2&nt),!De&&Qe)return 3;if(ee!=null&&(ee[0]=!!(16&nt)),re!=null&&(re[0]=Ve),oe!=null&&(oe[0]=0),re=he[0],nt=Oe[0],Qe&&Ve&&fe==null){Ie=0;break}if(4>F){Ie=7;break}if(De&&Qe||!De&&!Qe&&!r(m,w[0],"ALPH")){F=[F],Le.na=[Le.na],Le.P=[Le.P],Le.Sa=[Le.Sa];e:{wt=m,Ie=w,De=F;var _t=Le.gb;ot=Le.na,rt=Le.P,Ot=Le.Sa,qt=22,t(wt!=null),t(De!=null),tt=Ie[0];var Ir=De[0];for(t(ot!=null),t(Ot!=null),ot[0]=null,rt[0]=null,Ot[0]=0;;){if(Ie[0]=tt,De[0]=Ir,8>Ir){Ie=7;break e}var jr=Ke(wt,tt+4);if(4294967286<jr){Ie=3;break e}var Cr=8+jr+1&-2;if(qt+=Cr,0<_t&&qt>_t){Ie=3;break e}if(!r(wt,tt,"VP8 ")||!r(wt,tt,"VP8L")){Ie=0;break e}if(Ir[0]<Cr){Ie=7;break e}r(wt,tt,"ALPH")||(ot[0]=wt,rt[0]=tt+8,Ot[0]=jr),tt+=Cr,Ir-=Cr}}if(F=F[0],Le.na=Le.na[0],Le.P=Le.P[0],Le.Sa=Le.Sa[0],Ie!=0)break}F=[F],Le.Ja=[Le.Ja],Le.xa=[Le.xa];e:if(_t=m,Ie=w,De=F,ot=Le.gb[0],rt=Le.Ja,Ot=Le.xa,wt=Ie[0],tt=!r(_t,wt,"VP8 "),qt=!r(_t,wt,"VP8L"),t(_t!=null),t(De!=null),t(rt!=null),t(Ot!=null),8>De[0])Ie=7;else{if(tt||qt){if(_t=Ke(_t,wt+4),12<=ot&&_t>ot-12){Ie=3;break e}if(qe&&_t>De[0]-8){Ie=7;break e}rt[0]=_t,Ie[0]+=8,De[0]-=8,Ot[0]=qt}else Ot[0]=5<=De[0]&&_t[wt+0]==47&&!(_t[wt+4]>>5),rt[0]=De[0];Ie=0}if(F=F[0],Le.Ja=Le.Ja[0],Le.xa=Le.xa[0],w=w[0],Ie!=0)break;if(4294967286<Le.Ja)return 3;if(oe==null||Ve||(oe[0]=Le.xa?2:1),re=[re],nt=[nt],Le.xa){if(5>F){Ie=7;break}oe=re,qe=nt,Ve=ee,m==null||5>F?m=0:5<=F&&m[w+0]==47&&!(m[w+4]>>5)?(De=[0],_t=[0],ot=[0],ie(rt=new b,m,w,F),kt(rt,De,_t,ot)?(oe!=null&&(oe[0]=De[0]),qe!=null&&(qe[0]=_t[0]),Ve!=null&&(Ve[0]=ot[0]),m=1):m=0):m=0}else{if(10>F){Ie=7;break}oe=nt,m==null||10>F||!zr(m,w+3,F-3)?m=0:(qe=m[w+0]|m[w+1]<<8|m[w+2]<<16,Ve=16383&(m[w+7]<<8|m[w+6]),m=16383&(m[w+9]<<8|m[w+8]),1&qe||3<(qe>>1&7)||!(qe>>4&1)||qe>>5>=Le.Ja||!Ve||!m?m=0:(re&&(re[0]=Ve),oe&&(oe[0]=m),m=1))}if(!m||(re=re[0],nt=nt[0],Qe&&(he[0]!=re||Oe[0]!=nt)))return 3;fe!=null&&(fe[0]=Le,fe.offset=w-fe.w,t(4294967286>w-fe.w),t(fe.offset==fe.ha-F));break}return Ie==0||Ie==7&&Qe&&fe==null?(ee!=null&&(ee[0]|=Le.na!=null&&0<Le.na.length),Q!=null&&(Q[0]=re),X!=null&&(X[0]=nt),0):Ie}function uu(m,w,F){var Q=w.width,X=w.height,ee=0,re=0,oe=Q,fe=X;if(w.Da=m!=null&&0<m.Da,w.Da&&(oe=m.cd,fe=m.bd,ee=m.v,re=m.j,11>F||(ee&=-2,re&=-2),0>ee||0>re||0>=oe||0>=fe||ee+oe>Q||re+fe>X))return 0;if(w.v=ee,w.j=re,w.va=ee+oe,w.o=re+fe,w.U=oe,w.T=fe,w.da=m!=null&&0<m.da,w.da){if(!He(oe,fe,F=[m.ib],ee=[m.hb]))return 0;w.ib=F[0],w.hb=ee[0]}return w.ob=m!=null&&m.ob,w.Kb=m==null||!m.Sd,w.da&&(w.ob=w.ib<3*Q/4&&w.hb<3*X/4,w.Kb=0),1}function fu(m){if(m==null)return 2;if(11>m.S){var w=m.f.RGBA;w.fb+=(m.height-1)*w.A,w.A=-w.A}else w=m.f.kb,m=m.height,w.O+=(m-1)*w.fa,w.fa=-w.fa,w.N+=(m-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(m-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(m-1)*w.lb,w.lb=-w.lb);return 0}function Nl(m,w,F,Q){if(Q==null||0>=m||0>=w)return 2;if(F!=null){if(F.Da){var X=F.cd,ee=F.bd,re=-2&F.v,oe=-2&F.j;if(0>re||0>oe||0>=X||0>=ee||re+X>m||oe+ee>w)return 2;m=X,w=ee}if(F.da){if(!He(m,w,X=[F.ib],ee=[F.hb]))return 2;m=X[0],w=ee[0]}}Q.width=m,Q.height=w;e:{var fe=Q.width,he=Q.height;if(m=Q.S,0>=fe||0>=he||!(m>=k0&&13>m))m=2;else{if(0>=Q.Rd&&Q.sd==null){re=ee=X=w=0;var Oe=(oe=fe*ev[m])*he;if(11>m||(ee=(he+1)/2*(w=(fe+1)/2),m==12&&(re=(X=fe)*he)),(he=s(Oe+2*ee+re))==null){m=1;break e}Q.sd=he,11>m?((fe=Q.f.RGBA).eb=he,fe.fb=0,fe.A=oe,fe.size=Oe):((fe=Q.f.kb).y=he,fe.O=0,fe.fa=oe,fe.Fd=Oe,fe.f=he,fe.N=0+Oe,fe.Ab=w,fe.Cd=ee,fe.ea=he,fe.W=0+Oe+ee,fe.Db=w,fe.Ed=ee,m==12&&(fe.F=he,fe.J=0+Oe+2*ee),fe.Tc=re,fe.lb=X)}if(w=1,X=Q.S,ee=Q.width,re=Q.height,X>=k0&&13>X)if(11>X)m=Q.f.RGBA,w&=(oe=Math.abs(m.A))*(re-1)+ee<=m.size,w&=oe>=ee*ev[X],w&=m.eb!=null;else{m=Q.f.kb,oe=(ee+1)/2,Oe=(re+1)/2,fe=Math.abs(m.fa),he=Math.abs(m.Ab);var Qe=Math.abs(m.Db),qe=Math.abs(m.lb),Le=qe*(re-1)+ee;w&=fe*(re-1)+ee<=m.Fd,w&=he*(Oe-1)+oe<=m.Cd,w=(w&=Qe*(Oe-1)+oe<=m.Ed)&fe>=ee&he>=oe&Qe>=oe,w&=m.y!=null,w&=m.f!=null,w&=m.ea!=null,X==12&&(w&=qe>=ee,w&=Le<=m.Tc,w&=m.F!=null)}else w=0;m=w?0:2}}return m!=0||F!=null&&F.fd&&(m=fu(Q)),m}var vn=64,Fl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Rl=24,kl=32,pu=8,_i=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];et("Predictor0","PredictorAdd0"),S.Predictor0=function(){return 4278190080},S.Predictor1=function(m){return m},S.Predictor2=function(m,w,F){return w[F+0]},S.Predictor3=function(m,w,F){return w[F+1]},S.Predictor4=function(m,w,F){return w[F-1]},S.Predictor5=function(m,w,F){return _e(_e(m,w[F+1]),w[F+0])},S.Predictor6=function(m,w,F){return _e(m,w[F-1])},S.Predictor7=function(m,w,F){return _e(m,w[F+0])},S.Predictor8=function(m,w,F){return _e(w[F-1],w[F+0])},S.Predictor9=function(m,w,F){return _e(w[F+0],w[F+1])},S.Predictor10=function(m,w,F){return _e(_e(m,w[F-1]),_e(w[F+0],w[F+1]))},S.Predictor11=function(m,w,F){var Q=w[F+0];return 0>=bt(Q>>24&255,m>>24&255,(w=w[F-1])>>24&255)+bt(Q>>16&255,m>>16&255,w>>16&255)+bt(Q>>8&255,m>>8&255,w>>8&255)+bt(255&Q,255&m,255&w)?Q:m},S.Predictor12=function(m,w,F){var Q=w[F+0];return(lt((m>>24&255)+(Q>>24&255)-((w=w[F-1])>>24&255))<<24|lt((m>>16&255)+(Q>>16&255)-(w>>16&255))<<16|lt((m>>8&255)+(Q>>8&255)-(w>>8&255))<<8|lt((255&m)+(255&Q)-(255&w)))>>>0},S.Predictor13=function(m,w,F){var Q=w[F-1];return(Ct((m=_e(m,w[F+0]))>>24&255,Q>>24&255)<<24|Ct(m>>16&255,Q>>16&255)<<16|Ct(m>>8&255,Q>>8&255)<<8|Ct(m>>0&255,Q>>0&255))>>>0};var Zm=S.PredictorAdd0;S.PredictorAdd1=Et,et("Predictor2","PredictorAdd2"),et("Predictor3","PredictorAdd3"),et("Predictor4","PredictorAdd4"),et("Predictor5","PredictorAdd5"),et("Predictor6","PredictorAdd6"),et("Predictor7","PredictorAdd7"),et("Predictor8","PredictorAdd8"),et("Predictor9","PredictorAdd9"),et("Predictor10","PredictorAdd10"),et("Predictor11","PredictorAdd11"),et("Predictor12","PredictorAdd12"),et("Predictor13","PredictorAdd13");var hu=S.PredictorAdd2;ut("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),ut("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var T0,ss=S.ColorIndexInverseTransform,Dl=S.MapARGB,O0=S.VP8LColorIndexInverseTransformAlpha,I0=S.MapAlpha,uA=S.VP8LPredictorsAdd=[];uA.length=16,(S.VP8LPredictors=[]).length=16,(S.VP8LPredictorsAdd_C=[]).length=16,(S.VP8LPredictors_C=[]).length=16;var wc,bi,ii,fA,To,Oo,jl,Io,Ia,mu,si,os,Ll,N0,gu,Ec,_c,pA,bc,Ul,Cc,hA,xu,As,cs,ea,ta,Na,rn=s(511),No=s(2041),yu=s(225),Ml=s(767),F0=0,eg=No,R0=yu,Mi=Ml,ls=rn,k0=0,D0=1,Ky=2,j0=3,L0=4,tg=5,Hy=6,rg=7,ag=8,U0=9,ng=10,xS=[2,3,7],yS=[3,3,11],Gy=[280,256,256,256,40],vS=[0,1,1,1,0],wS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ES=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_S=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],bS=8,ig=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],sg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],vu=null,CS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],BS=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],zy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],SS=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],TS=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],OS=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],IS=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],mA=[],Ds=[],Fo=[],NS=1,Vy=2,gA=[],ds=[];Xe("UpsampleRgbLinePair",Er,3),Xe("UpsampleBgrLinePair",ha,3),Xe("UpsampleRgbaLinePair",ks,4),Xe("UpsampleBgraLinePair",dn,4),Xe("UpsampleArgbLinePair",kn,4),Xe("UpsampleRgba4444LinePair",qa,2),Xe("UpsampleRgb565LinePair",ya,2);var FS=S.UpsampleRgbLinePair,RS=S.UpsampleBgrLinePair,$y=S.UpsampleRgbaLinePair,Yy=S.UpsampleBgraLinePair,Wy=S.UpsampleArgbLinePair,Xy=S.UpsampleRgba4444LinePair,kS=S.UpsampleRgb565LinePair,M0=16,P0=1<<M0-1,wu=-227,og=482,DS=6,Jy=0,jS=s(256),LS=s(256),US=s(256),MS=s(256),PS=s(og-wu),QS=s(og-wu);eo("YuvToRgbRow",Er,3),eo("YuvToBgrRow",ha,3),eo("YuvToRgbaRow",ks,4),eo("YuvToBgraRow",dn,4),eo("YuvToArgbRow",kn,4),eo("YuvToRgba4444Row",qa,2),eo("YuvToRgb565Row",ya,2);var Zy=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Q0=[0,2,8],qS=[8,7,6,4,4,2,2,2,1,1,1,1],KS=1;this.WebPDecodeRGBA=function(m,w,F,Q,X){var ee=D0,re=new Tl,oe=new ri;re.ba=oe,oe.S=ee,oe.width=[oe.width],oe.height=[oe.height];var fe=oe.width,he=oe.height,Oe=new Di;if(Oe==null||m==null)var Qe=2;else t(Oe!=null),Qe=Il(m,w,F,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(Qe!=0?fe=0:(fe!=null&&(fe[0]=Oe.width[0]),he!=null&&(he[0]=Oe.height[0]),fe=1),fe){oe.width=oe.width[0],oe.height=oe.height[0],Q!=null&&(Q[0]=oe.width),X!=null&&(X[0]=oe.height);e:{if(Q=new is,(X=new su).data=m,X.w=w,X.ha=F,X.kd=1,w=[0],t(X!=null),((m=Il(X.data,X.w,X.ha,null,null,null,w,null,X))==0||m==7)&&w[0]&&(m=4),(w=m)==0){if(t(re!=null),Q.data=X.data,Q.w=X.w+X.offset,Q.ha=X.ha-X.offset,Q.put=yi,Q.ac=ga,Q.bc=vi,Q.ma=re,X.xa){if((m=Me())==null){re=1;break e}if(function(qe,Le){var nt=[0],Ve=[0],Ie=[0];t:for(;;){if(qe==null)return 0;if(Le==null)return qe.a=2,0;if(qe.l=Le,qe.a=0,ie(qe.m,Le.data,Le.w,Le.ha),!kt(qe.m,nt,Ve,Ie)){qe.a=3;break t}if(qe.xb=Vy,Le.width=nt[0],Le.height=Ve[0],!be(nt[0],Ve[0],1,qe,null))break t;return 1}return t(qe.a!=0),0}(m,Q)){if(Q=(w=Nl(Q.width,Q.height,re.Oa,re.ba))==0){t:{Q=m;r:for(;;){if(Q==null){Q=0;break t}if(t(Q.s.yc!=null),t(Q.s.Ya!=null),t(0<Q.s.Wb),t((F=Q.l)!=null),t((X=F.ma)!=null),Q.xb!=0){if(Q.ca=X.ba,Q.tb=X.tb,t(Q.ca!=null),!uu(X.Oa,F,j0)){Q.a=2;break r}if(!ke(Q,F.width)||F.da)break r;if((F.da||rr(Q.ca.S))&&Pe(),11>Q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Q.ca.f.kb.F!=null&&Pe()),Q.Pb&&0<Q.s.ua&&Q.s.vb.X==null&&!Ee(Q.s.vb,Q.s.Wa.Xa)){Q.a=1;break r}Q.xb=0}if(!ce(Q,Q.V,Q.Ba,Q.c,Q.i,F.o,Ae))break r;X.Dc=Q.Ma,Q=1;break t}t(Q.a!=0),Q=0}Q=!Q}Q&&(w=m.a)}else w=m.a}else{if((m=new ni)==null){re=1;break e}if(m.Fa=X.na,m.P=X.P,m.qc=X.Sa,en(m,Q)){if((w=Nl(Q.width,Q.height,re.Oa,re.ba))==0){if(m.Aa=0,F=re.Oa,t((X=m)!=null),F!=null){if(0<(fe=0>(fe=F.Md)?0:100<fe?255:255*fe/100)){for(he=Oe=0;4>he;++he)12>(Qe=X.pb[he]).lc&&(Qe.ia=fe*qS[0>Qe.lc?0:Qe.lc]>>3),Oe|=Qe.ia;Oe&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=F.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}El(m,Q)||(w=m.a)}}else w=m.a}w==0&&re.Oa!=null&&re.Oa.fd&&(w=fu(re.ba))}re=w}ee=re!=0?null:11>ee?oe.f.RGBA.eb:oe.f.kb.y}else ee=null;return ee};var ev=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(S,O){for(var M="",T=0;T<4;T++)M+=String.fromCharCode(S[O++]);return M}function d(S,O){return(S[O+0]<<0|S[O+1]<<8|S[O+2]<<16)>>>0}function f(S,O){return(S[O+0]<<0|S[O+1]<<8|S[O+2]<<16|S[O+3]<<24)>>>0}new c;var p=[0],u=[0],g=[],h=new c,y=e,x=function(S,O){var M={},T=0,R=!1,L=0,N=0;if(M.frames=[],!function(k,j,q,Y){for(var de=0;de<Y;de++)if(k[j+de]!=q.charCodeAt(de))return!0;return!1}(S,O,"RIFF",4)){var P,U;for(f(S,O+=4),O+=8;O<S.length;){var V=l(S,O),ie=f(S,O+=4);O+=4;var W=ie+(1&ie);switch(V){case"VP8 ":case"VP8L":M.frames[T]===void 0&&(M.frames[T]={}),(b=M.frames[T]).src_off=R?N:O-8,b.src_size=L+ie+8,T++,R&&(R=!1,L=0,N=0);break;case"VP8X":(b=M.header={}).feature_flags=S[O];var z=O+4;b.canvas_width=1+d(S,z),z+=3,b.canvas_height=1+d(S,z),z+=3;break;case"ALPH":R=!0,L=W+8,N=O-8;break;case"ANIM":(b=M.header).bgcolor=f(S,O),z=O+4,b.loop_count=(P=S)[(U=z)+0]<<0|P[U+1]<<8,z+=2;break;case"ANMF":var G,b;(b=M.frames[T]={}).offset_x=2*d(S,O),O+=3,b.offset_y=2*d(S,O),O+=3,b.width=1+d(S,O),O+=3,b.height=1+d(S,O),O+=3,b.duration=d(S,O),O+=3,G=S[O++],b.dispose=1&G,b.blend=G>>1&1}V!="ANMF"&&(O+=W)}return M}}(y,0);x.response=y,x.rgbaoutput=!0,x.dataurl=!1;var v=x.header?x.header:null,E=x.frames?x.frames:null;if(v){v.loop_counter=v.loop_count,p=[v.canvas_height],u=[v.canvas_width];for(var D=0;D<E.length&&E[D].blend!=0;D++);}var B=E[0],I=h.WebPDecodeRGBA(y,B.src_off,B.src_size,u,p);B.rgba=I,B.imgwidth=u[0],B.imgheight=p[0];for(var _=0;_<u[0]*p[0]*4;_++)g[_]=I[_];return this.width=u,this.height=p,this.data=g,this}(function(e){var t=function(){return typeof Ox=="function"},r=function(p,u,g,h){var y=4,x=o;switch(h){case e.image_compression.FAST:y=1,x=s;break;case e.image_compression.MEDIUM:y=6,x=A;break;case e.image_compression.SLOW:y=9,x=c}p=a(p,u,g,x);var v=Ox(p,{level:y});return e.__addimage__.arrayBufferToBinaryString(v)},a=function(p,u,g,h){for(var y,x,v,E=p.length/u,D=new Uint8Array(p.length+E),B=d(),I=0;I<E;I+=1){if(v=I*u,y=p.subarray(v,v+u),h)D.set(h(y,g,x),v+I);else{for(var _,S=B.length,O=[];_<S;_+=1)O[_]=B[_](y,g,x);var M=f(O.concat());D.set(O[M],v+I)}x=y}return D},n=function(p){var u=Array.apply([],p);return u.unshift(0),u},s=function(p,u){var g,h=[],y=p.length;h[0]=1;for(var x=0;x<y;x+=1)g=p[x-u]||0,h[x+1]=p[x]-g+256&255;return h},o=function(p,u,g){var h,y=[],x=p.length;y[0]=2;for(var v=0;v<x;v+=1)h=g&&g[v]||0,y[v+1]=p[v]-h+256&255;return y},A=function(p,u,g){var h,y,x=[],v=p.length;x[0]=3;for(var E=0;E<v;E+=1)h=p[E-u]||0,y=g&&g[E]||0,x[E+1]=p[E]+256-(h+y>>>1)&255;return x},c=function(p,u,g){var h,y,x,v,E=[],D=p.length;E[0]=4;for(var B=0;B<D;B+=1)h=p[B-u]||0,y=g&&g[B]||0,x=g&&g[B-u]||0,v=l(h,y,x),E[B+1]=p[B]-v+256&255;return E},l=function(p,u,g){if(p===u&&u===g)return p;var h=Math.abs(u-g),y=Math.abs(p-g),x=Math.abs(p+u-g-g);return h<=y&&h<=x?p:y<=x?u:g},d=function(){return[n,s,o,A,c]},f=function(p){var u=p.map(function(g){return g.reduce(function(h,y){return h+Math.abs(y)},0)});return u.indexOf(Math.min.apply(null,u))};e.processPNG=function(p,u,g,h){var y,x,v,E,D,B,I,_,S,O,M,T,R,L,N,P=this.decode.FLATE_DECODE,U="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(v=new n9(p)).imgData,x=v.bits,y=v.colorSpace,D=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){S=(_=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,M=new Uint8Array(S*v.colors),O=new Uint8Array(S);var V,ie=v.pixelBitlength-v.bits;for(L=0,N=0;L<S;L++){for(R=_[L],V=0;V<ie;)M[N++]=R>>>V&255,V+=v.bits;O[L]=R>>>V&255}}if(v.bits===16){S=(_=new Uint32Array(v.decodePixels().buffer)).length,M=new Uint8Array(S*(32/v.pixelBitlength)*v.colors),O=new Uint8Array(S*(32/v.pixelBitlength)),T=v.colors>1,L=0,N=0;for(var W=0;L<S;)R=_[L++],M[N++]=R>>>0&255,T&&(M[N++]=R>>>16&255,R=_[L++],M[N++]=R>>>0&255),O[W++]=R>>>16&255;x=8}h!==e.image_compression.NONE&&t()?(p=r(M,v.width*v.colors,v.colors,h),I=r(O,v.width,1,h)):(p=M,I=O,P=void 0)}if(v.colorType===3&&(y=this.color_spaces.INDEXED,B=v.palette,v.transparency.indexed)){var z=v.transparency.indexed,G=0;for(L=0,S=z.length;L<S;++L)G+=z[L];if((G/=255)===S-1&&z.indexOf(0)!==-1)E=[z.indexOf(0)];else if(G!==S){for(_=v.decodePixels(),O=new Uint8Array(_.length),L=0,S=_.length;L<S;L++)O[L]=z[_[L]];I=r(O,v.width,1)}}var b=function(k){var j;switch(k){case e.image_compression.FAST:j=11;break;case e.image_compression.MEDIUM:j=13;break;case e.image_compression.SLOW:j=14;break;default:j=12}return j}(h);return P===this.decode.FLATE_DECODE&&(U="/Predictor "+b+" "),U+="/Colors "+D+" /BitsPerComponent "+x+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(I&&this.__addimage__.isArrayBuffer(I)||this.__addimage__.isArrayBufferView(I))&&(I=this.__addimage__.arrayBufferToBinaryString(I)),{alias:g,data:p,index:u,filter:P,decodeParameters:U,transparency:E,palette:B,sMask:I,predictor:b,width:v.width,height:v.height,bitsPerComponent:x,colorSpace:y}}}})(Ht.API),function(e){e.processGIF89A=function(t,r,a,n){var s=new i9(t),o=s.width,A=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var l={data:c,width:o,height:A},d=new Jg(100).encode(l,100);return e.processJPEG.call(this,d,r,a,n)},e.processGIF87A=e.processGIF89A}(Ht.API),Ms.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ms.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){$r.log("bit decode error:"+r)}},Ms.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,A=0;A<8&&8*n+A<this.width;A++){var c=this.palette[s>>7-A&1];this.data[o+4*A]=c.blue,this.data[o+4*A+1]=c.green,this.data[o+4*A+2]=c.red,this.data[o+4*A+3]=255}r!==0&&(this.pos+=4-r)}},Ms.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,A=s>>4,c=15&s,l=this.palette[A];if(this.data[o]=l.blue,this.data[o+1]=l.green,this.data[o+2]=l.red,this.data[o+3]=255,2*n+1>=this.width)break;l=this.palette[c],this.data[o+4]=l.blue,this.data[o+4+1]=l.green,this.data[o+4+2]=l.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Ms.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Ms.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,A=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,l=s>>15?255:0,d=a*this.width*4+4*n;this.data[d]=c,this.data[d+1]=A,this.data[d+2]=o,this.data[d+3]=l}this.pos+=e}},Ms.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var A=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,l=(o>>11)/t*255|0,d=n*this.width*4+4*s;this.data[d]=l,this.data[d+1]=c,this.data[d+2]=A,this.data[d+3]=255}this.pos+=e}},Ms.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Ms.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),A=t*this.width*4+4*r;this.data[A]=s,this.data[A+1]=n,this.data[A+2]=a,this.data[A+3]=o}},Ms.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var s=new Ms(t,!1),o=s.width,A=s.height,c={data:s.getData(),width:o,height:A},l=new Jg(100).encode(c,100);return e.processJPEG.call(this,l,r,a,n)}}(Ht.API),_w.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var s=new _w(t),o=s.width,A=s.height,c={data:s.getData(),width:o,height:A},l=new Jg(100).encode(c,100);return e.processJPEG.call(this,l,r,a,n)}}(Ht.API),Ht.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),o=new Uint8Array(n/4),A=0,c=0,l=0;l<n;l+=4){var d=a[l],f=a[l+1],p=a[l+2],u=a[l+3];s[A++]=d,s[A++]=f,s[A++]=p,o[c++]=u}var g=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ht.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wl=Ht.API,yp=Wl.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),A=t.widths?t.widths:n.metadata.Unicode.widths,c=A.fof?A.fof:1,l=t.kerning?t.kerning:n.metadata.Unicode.kerning,d=l.fof?l.fof:1,f=t.doKerning!==!1,p=0,u=e.length,g=0,h=A[0]||c,y=[];for(r=0;r<u;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?y.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/s)||0)/1e3):(p=f&&Jr(l[a])==="object"&&!isNaN(parseInt(l[a][g],10))?l[a][g]/d:0,y.push((A[a]||h)/c+p)),g=a;return y},yw=Wl.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Wl.processArabic&&(e=Wl.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:yp.apply(this,arguments).reduce(function(s,o){return s+o},0)},vw=function(e,t,r,a){for(var n=[],s=0,o=e.length,A=0;s!==o&&A+t[s]<r;)A+=t[s],s++;n.push(e.slice(0,s));var c=s;for(A=0;s!==o;)A+t[s]>a&&(n.push(e.slice(c,s)),A=0,c=s),A+=t[s],s++;return c!==s&&n.push(e.slice(c,s)),n},ww=function(e,t,r){r||(r={});var a,n,s,o,A,c,l,d=[],f=[d],p=r.textIndent||0,u=0,g=0,h=e.split(" "),y=yp.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?h[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),v=[];h.map(function(D){(D=D.split(/\s*\n/)).length>1?v=v.concat(D.map(function(B,I){return(I&&B.length?`
`:"")+B})):v.push(D[0])}),h=v,c=yw.apply(this,[x,r])}for(s=0,o=h.length;s<o;s++){var E=0;if(a=h[s],c&&a[0]==`
`&&(a=a.substr(1),E=1),p+u+(g=(n=yp.apply(this,[a,r])).reduce(function(D,B){return D+B},0))>t||E){if(g>t){for(A=vw.apply(this,[a,n,t-(p+u),t]),d.push(A.shift()),d=[A.pop()];A.length;)f.push([A.shift()]);g=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(D,B){return D+B},0)}else d=[a];f.push(d),p=g+c,u=y}else d.push(a),p+=u+g,u=y}return l=c?function(D,B){return(B?x:"")+D.join(" ")}:function(D){return D.join(" ")},f.map(l)},Wl.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var A,c,l=[];for(A=0,c=a.length;A<c;A++)l=l.concat(ww.apply(this,[a[A],o,s]));return l},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},a={},n=0;n<t.length;n++)r[t[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=t[n];var s=function(f){return"0x"+parseInt(f,10).toString(16)},o=e.__fontmetrics__.compress=function(f){var p,u,g,h,y=["{"];for(var x in f){if(p=f[x],isNaN(parseInt(x,10))?u="'"+x+"'":(x=parseInt(x,10),u=(u=s(x).slice(2)).slice(0,-1)+a[u.slice(-1)]),typeof p=="number")p<0?(g=s(p).slice(3),h="-"):(g=s(p).slice(2),h=""),g=h+g.slice(0,-1)+a[g.slice(-1)];else{if(Jr(p)!=="object")throw new Error("Don't know what to do with value type "+Jr(p)+".");g=o(p)}y.push(u+g)}return y.push("}"),y.join("")},A=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,u,g,h,y={},x=1,v=y,E=[],D="",B="",I=f.length-1,_=1;_<I;_+=1)(h=f[_])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(h):h=="{"?(E.push([v,g]),v={},g=void 0):h=="}"?((u=E.pop())[0][u[1]]=v,g=void 0,v=u[0]):h=="-"?x=-1:g===void 0?r.hasOwnProperty(h)?(D+=r[h],g=parseInt(D,16)*x,x=1,D=""):D+=h:r.hasOwnProperty(h)?(B+=r[h],v[g]=parseInt(B,16)*x,x=1,g=void 0,B=""):B+=h;return y},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:A("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},l={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":A("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":A("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":A("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:A("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":A("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":A("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:A("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:A("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":A("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:A("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":A("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":A("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":A("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":A("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var p=f.font,u=d.Unicode[p.postScriptName];u&&(p.metadata.Unicode={},p.metadata.Unicode.widths=u.widths,p.metadata.Unicode.kerning=u.kerning);var g=l.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(Ht.API),function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,A){A=/^\x00\x01\x00\x00/.test(A)?t(A):t(mf(A)),o.metadata=e.API.TTFFont.open(A),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])}(Ht),function(e){function t(){return(Vt.canvg?Promise.resolve(Vt.canvg):pi(()=>import("./index.es-BV8IozGy.js"),__vite__mapDeps([2,1,3]),import.meta.url)).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Ht.API.addSvgAsImage=function(r,a,n,s,o,A,c,l){if(isNaN(a)||isNaN(n))throw $r.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw $r.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=s,d.height=o;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},u=this;return t().then(function(g){return g.fromString(f,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(p)}).then(function(){u.addImage(d.toDataURL("image/jpeg",1),a,n,s,o,c,l)})}}(),Ht.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},Ht.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},A=Object.keys(o),c=[],l=0,d=0,f=0;function p(g,h){var y,x=!1;for(y=0;y<g.length;y+=1)g[y]===h&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var u=A.length;for(f=0;f<u;f+=1)r[A[f]].value=r[A[f]].defaultValue,r[A[f]].explicitSet=!1}if(Jr(e)==="object"){for(n in e)if(s=e[n],p(A,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&p(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(l=0;l<s.length;l+=1)if(a=!0,s[l].length===1&&typeof s[l][0]=="number")c.push(String(s[l]-1));else if(s[l].length>1){for(d=0;d<s[l].length;d+=1)typeof s[l][d]!="number"&&(a=!1);a===!0&&c.push([s[l][0]-1,s[l][1]-1].join(" "))}r[n].value="["+c.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,h=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?h.push("/"+g+" /"+r[g].value):h.push("/"+g+" "+r[g].value));h.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+h.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),A=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),l=s.length+o.length+A.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(n+s+o+A+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ht.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var A,c=o.metadata.Unicode.widths,l=["","0","00","000","0000"],d=[""],f=0,p=s.length;f<p;++f){if(A=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(A),o.metadata.toUnicode[A]=s.charCodeAt(f),c.indexOf(A)==-1&&(c.push(A),c.push([parseInt(o.metadata.widthOfGlyph(A),10)])),A=="0")return d.join("");A=A.toString(16),d.push(l[4-A.length],A)}return d.join("")},a=function(s){var o,A,c,l,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,p=(A=Object.keys(s).sort(function(u,g){return u-g})).length;f<p;f++)o=A[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(l=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+l+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var A=o.font,c=o.out,l=o.newObject,d=o.putStream;if(A.metadata instanceof e.API.TTFFont&&A.encoding==="Identity-H"){for(var f=A.metadata.Unicode.widths,p=A.metadata.subset.encode(A.metadata.glyIdsUsed,1),u="",g=0;g<p.length;g++)u+=String.fromCharCode(p[g]);var h=l();d({data:u,addLength1:!0,objectId:h}),c("endobj");var y=l();d({data:a(A.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var x=l();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+hd(A.fontName)),c("/FontFile2 "+h+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(A.metadata.bbox)),c("/Flags "+A.metadata.flags),c("/StemV "+A.metadata.stemV),c("/ItalicAngle "+A.metadata.italicAngle),c("/Ascent "+A.metadata.ascender),c("/Descent "+A.metadata.decender),c("/CapHeight "+A.metadata.capHeight),c(">>"),c("endobj");var v=l();c("<<"),c("/Type /Font"),c("/BaseFont /"+hd(A.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+A.encoding+")"),c(">>"),c(">>"),c("endobj"),A.objectNumber=l(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+hd(A.fontName)),c("/Encoding /"+A.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),A.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var A=o.font,c=o.out,l=o.newObject,d=o.putStream;if(A.metadata instanceof e.API.TTFFont&&A.encoding==="WinAnsiEncoding"){for(var f=A.metadata.rawData,p="",u=0;u<f.length;u++)p+=String.fromCharCode(f[u]);var g=l();d({data:p,addLength1:!0,objectId:g}),c("endobj");var h=l();d({data:a(A.metadata.toUnicode),addLength1:!0,objectId:h}),c("endobj");var y=l();c("<<"),c("/Descent "+A.metadata.decender),c("/CapHeight "+A.metadata.capHeight),c("/StemV "+A.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(A.metadata.bbox)),c("/FontName /"+hd(A.fontName)),c("/ItalicAngle "+A.metadata.italicAngle),c("/Ascent "+A.metadata.ascender),c(">>"),c("endobj"),A.objectNumber=l();for(var x=0;x<A.metadata.hmtx.widths.length;x++)A.metadata.hmtx.widths[x]=parseInt(A.metadata.hmtx.widths[x]*(1e3/A.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+hd(A.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+A.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(A.metadata.hmtx.widths)+">>"),c("endobj"),A.isAlreadyPutted=!0}})(s)}]);var n=function(s){var o,A=s.text||"",c=s.x,l=s.y,d=s.options||{},f=s.mutex||{},p=f.pdfEscape,u=f.activeFontKey,g=f.fonts,h=u,y="",x=0,v="",E=g[h].encoding;if(g[h].encoding!=="Identity-H")return{text:A,x:c,y:l,options:d,mutex:f};for(v=A,h=u,Array.isArray(A)&&(v=A[0]),x=0;x<v.length;x+=1)g[h].metadata.hasOwnProperty("cmap")&&(o=g[h].metadata.cmap.unicode.codeMap[v[x].charCodeAt(0)]),o||v[x].charCodeAt(0)<256&&g[h].metadata.hasOwnProperty("Unicode")?y+=v[x]:y+="";var D="";return parseInt(h.slice(1))<14||E==="WinAnsiEncoding"?D=p(y,h).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(D=r(y,g[h])),f.isHex=!0,{text:D,x:c,y:l,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",A=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var l=0;for(l=0;l<o.length;l+=1)Array.isArray(o[l])&&o[l].length===3?A.push([n(Object.assign({},c,{text:o[l][0]})).text,o[l][1],o[l][2]]):A.push(n(Object.assign({},c,{text:o[l]})).text);s.text=A}else s.text=n(Object.assign({},c,{text:o})).text}])}(Ht),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ht.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,s,o,A,c,l,d,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},h={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,E=0;this.__bidiEngine__={};var D=function(T){var R=T.charCodeAt(),L=R>>8,N=h[L];return N!==void 0?f[256*N+(255&R)]:L===252||L===253?"AL":x.test(L)?"L":L===8?"R":"N"},B=function(T){for(var R,L=0;L<T.length;L++){if((R=D(T.charAt(L)))==="L")return!1;if(R==="R")return!0}return!1},I=function(T,R,L,N){var P,U,V,ie,W=R[N];switch(W){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(W="AN");break;case"AL":v=!0,W="R";break;case"WS":W="N";break;case"CS":N<1||N+1>=R.length||(P=L[N-1])!=="EN"&&P!=="AN"||(U=R[N+1])!=="EN"&&U!=="AN"?W="N":v&&(U="AN"),W=U===P?U:"N";break;case"ES":W=(P=N>0?L[N-1]:"B")==="EN"&&N+1<R.length&&R[N+1]==="EN"?"EN":"N";break;case"ET":if(N>0&&L[N-1]==="EN"){W="EN";break}if(v){W="N";break}for(V=N+1,ie=R.length;V<ie&&R[V]==="ET";)V++;W=V<ie&&R[V]==="EN"?"EN":"N";break;case"NSM":if(o&&!A){for(ie=R.length,V=N+1;V<ie&&R[V]==="NSM";)V++;if(V<ie){var z=T[N],G=z>=1425&&z<=2303||z===64286;if(P=R[V],G&&(P==="R"||P==="AL")){W="R";break}}}W=N<1||(P=R[N-1])==="B"?"N":L[N-1];break;case"B":v=!1,n=!0,W=E;break;case"S":s=!0,W="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":W="N"}return W},_=function(T,R,L){var N=T.split("");return L&&S(N,L,{hiLevel:E}),N.reverse(),R&&R.reverse(),N.join("")},S=function(T,R,L){var N,P,U,V,ie,W=-1,z=T.length,G=0,b=[],k=E?u:p,j=[];for(v=!1,n=!1,s=!1,P=0;P<z;P++)j[P]=D(T[P]);for(U=0;U<z;U++){if(ie=G,b[U]=I(T,j,b,U),N=240&(G=k[ie][g[b[U]]]),G&=15,R[U]=V=k[G][5],N>0)if(N===16){for(P=W;P<U;P++)R[P]=1;W=-1}else W=-1;if(k[G][6])W===-1&&(W=U);else if(W>-1){for(P=W;P<U;P++)R[P]=V;W=-1}j[U]==="B"&&(R[U]=0),L.hiLevel|=V}s&&function(q,Y,de){for(var ue=0;ue<de;ue++)if(q[ue]==="S"){Y[ue]=E;for(var pe=ue-1;pe>=0&&q[pe]==="WS";pe--)Y[pe]=E}}(j,R,z)},O=function(T,R,L,N,P){if(!(P.hiLevel<T)){if(T===1&&E===1&&!n)return R.reverse(),void(L&&L.reverse());for(var U,V,ie,W,z=R.length,G=0;G<z;){if(N[G]>=T){for(ie=G+1;ie<z&&N[ie]>=T;)ie++;for(W=G,V=ie-1;W<V;W++,V--)U=R[W],R[W]=R[V],R[V]=U,L&&(U=L[W],L[W]=L[V],L[V]=U);G=ie}G++}}},M=function(T,R,L){var N=T.split(""),P={hiLevel:E};return L||(L=[]),S(N,L,P),function(U,V,ie){if(ie.hiLevel!==0&&d)for(var W,z=0;z<U.length;z++)V[z]===1&&(W=y.indexOf(U[z]))>=0&&(U[z]=y[W+1])}(N,L,P),O(2,N,R,L,P),O(1,N,R,L,P),N.join("")};return this.__bidiEngine__.doBidiReorder=function(T,R,L){if(function(P,U){if(U)for(var V=0;V<P.length;V++)U[V]=V;A===void 0&&(A=B(P)),l===void 0&&(l=B(P))}(T,R),o||!c||l)if(o&&c&&A^l)E=A?1:0,T=_(T,R,L);else if(!o&&c&&l)E=A?1:0,T=M(T,R,L),T=_(T,R);else if(!o||A||c||l){if(o&&!c&&A^l)T=_(T,R),A?(E=0,T=M(T,R,L)):(E=1,T=M(T,R,L),T=_(T,R));else if(o&&A&&!c&&l)E=1,T=M(T,R,L),T=_(T,R);else if(!o&&!c&&A^l){var N=d;A?(E=1,T=M(T,R,L),E=0,d=!1,T=M(T,R,L),d=N):(E=0,T=M(T,R,L),T=_(T,R),E=1,d=!1,T=M(T,R,L),d=N,T=_(T,R))}}else E=0,T=M(T,R,L);else E=A?1:0,T=M(T,R,L);return T},this.__bidiEngine__.setOptions=function(T){T&&(o=T.isInputVisual,c=T.isOutputVisual,A=T.isInputRtl,l=T.isOutputRtl,d=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text,s=(a.x,a.y,a.options||{}),o=(a.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var A=0;for(o=[],A=0;A<n.length;A+=1)Object.prototype.toString.call(n[A])==="[object Array]"?o.push([r.doBidiReorder(n[A][0]),n[A][1],n[A][2]]):o.push([r.doBidiReorder(n[A])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(Ht),Ht.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new lc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new v9(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new s9(this.contents),this.head=new A9(this),this.name=new f9(this),this.cmap=new HC(this),this.toUnicode={},this.hhea=new c9(this),this.maxp=new p9(this),this.hmtx=new h9(this),this.post=new d9(this),this.os2=new l9(this),this.loca=new y9(this),this.glyf=new m9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,A,c,l;for(l=[],o=0,A=(c=this.bbox).length;o<A;o++)t=c[o],l.push(Math.round(t*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,s,o,A;for(o=0,s=0,A=(t=""+t).length;0<=A?s<A:s>A;s=0<=A?++s:--s)n=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var Ws,lc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,s,o,A,c;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),A=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^o)+256*(255^A)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*o+256*A+c},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,s;for(s=[],a=0,n=t.length;a<n;a++)r=t[a],s.push(this.writeByte(r));return s},e}(),s9=function(){var e;function t(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,s,o,A,c,l,d,f,p,u,g,h;for(h in u=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(u)/c),o=Math.floor(f/c),d=16*u-f,(n=new lc).writeInt(this.scalarType),n.writeShort(u),n.writeShort(f),n.writeShort(o),n.writeShort(d),s=16*u,l=n.pos+s,A=null,g=[],r)for(p=r[h],n.writeString(h),n.writeInt(e(p)),n.writeInt(l),n.writeInt(p.length),g=g.concat(p),h==="head"&&(A=l),l+=p.length;l%4;)g.push(0),l++;return n.write(g),a=2981146554-e(n.data),n.pos=A+8,n.writeUInt32(a),n.data},e=function(r){var a,n,s,o;for(r=GC.call(r);r.length%4;)r.push(0);for(s=new lc(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=s.readUInt32();return 4294967295&n},t}(),o9={}.hasOwnProperty,vo=function(e,t){for(var r in t)o9.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};Ws=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var A9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var a;return(a=new lc).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},t}(),bw=function(){function e(t,r){var a,n,s,o,A,c,l,d,f,p,u,g,h,y,x,v,E;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(u=t.readUInt16(),p=u/2,t.pos+=6,s=function(){var D,B;for(B=[],c=D=0;0<=p?D<p:D>p;c=0<=p?++D:--D)B.push(t.readUInt16());return B}(),t.pos+=2,h=function(){var D,B;for(B=[],c=D=0;0<=p?D<p:D>p;c=0<=p?++D:--D)B.push(t.readUInt16());return B}(),l=function(){var D,B;for(B=[],c=D=0;0<=p?D<p:D>p;c=0<=p?++D:--D)B.push(t.readUInt16());return B}(),d=function(){var D,B;for(B=[],c=D=0;0<=p?D<p:D>p;c=0<=p?++D:--D)B.push(t.readUInt16());return B}(),n=(this.length-t.pos+this.offset)/2,A=function(){var D,B;for(B=[],c=D=0;0<=n?D<n:D>n;c=0<=n?++D:--D)B.push(t.readUInt16());return B}(),c=x=0,E=s.length;x<E;c=++x)for(y=s[c],a=v=g=h[c];g<=y?v<=y:v>=y;a=g<=y?++v:--v)d[c]===0?o=a+l[c]:(o=A[d[c]/2+(a-g)-(p-c)]||0)!==0&&(o+=l[c]),this.codeMap[a]=65535&o}t.pos=f}return e.encode=function(t,r){var a,n,s,o,A,c,l,d,f,p,u,g,h,y,x,v,E,D,B,I,_,S,O,M,T,R,L,N,P,U,V,ie,W,z,G,b,k,j,q,Y,de,ue,pe,ye,ve,ae;switch(N=new lc,o=Object.keys(t).sort(function(Ke,Ee){return Ke-Ee}),r){case"macroman":for(h=0,y=function(){var Ke=[];for(g=0;g<256;++g)Ke.push(0);return Ke}(),v={0:0},s={},P=0,W=o.length;P<W;P++)v[pe=t[n=o[P]]]==null&&(v[pe]=++h),s[n]={old:t[n],new:v[t[n]]},y[n]=v[t[n]];return N.writeUInt16(1),N.writeUInt16(0),N.writeUInt32(12),N.writeUInt16(0),N.writeUInt16(262),N.writeUInt16(0),N.write(y),{charMap:s,subtable:N.data,maxGlyphID:h+1};case"unicode":for(R=[],f=[],E=0,v={},a={},x=l=null,U=0,z=o.length;U<z;U++)v[B=t[n=o[U]]]==null&&(v[B]=++E),a[n]={old:B,new:v[B]},A=v[B]-n,x!=null&&A===l||(x&&f.push(x),R.push(n),l=A),x=n;for(x&&f.push(x),f.push(65535),R.push(65535),M=2*(O=R.length),S=2*Math.pow(Math.log(O)/Math.LN2,2),p=Math.log(S/2)/Math.LN2,_=2*O-S,c=[],I=[],u=[],g=V=0,G=R.length;V<G;g=++V){if(T=R[g],d=f[g],T===65535){c.push(0),I.push(0);break}if(T-(L=a[T].new)>=32768)for(c.push(0),I.push(2*(u.length+O-g)),n=ie=T;T<=d?ie<=d:ie>=d;n=T<=d?++ie:--ie)u.push(a[n].new);else c.push(L-T),I.push(0)}for(N.writeUInt16(3),N.writeUInt16(1),N.writeUInt32(12),N.writeUInt16(4),N.writeUInt16(16+8*O+2*u.length),N.writeUInt16(0),N.writeUInt16(M),N.writeUInt16(S),N.writeUInt16(p),N.writeUInt16(_),de=0,b=f.length;de<b;de++)n=f[de],N.writeUInt16(n);for(N.writeUInt16(0),ue=0,k=R.length;ue<k;ue++)n=R[ue],N.writeUInt16(n);for(ye=0,j=c.length;ye<j;ye++)A=c[ye],N.writeUInt16(A);for(ve=0,q=I.length;ve<q;ve++)D=I[ve],N.writeUInt16(D);for(ae=0,Y=u.length;ae<Y;ae++)h=u[ae],N.writeUInt16(h);return{charMap:a,subtable:N.data,maxGlyphID:E+1}}},e}(),HC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="cmap",t.prototype.parse=function(r){var a,n,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)a=new bw(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(r,a){var n,s;return a==null&&(a="macroman"),n=bw.encode(r,a),(s=new lc).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),c9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),l9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n}(),this.charRange=function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),d9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="post",t.prototype.parse=function(r){var a,n,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(n=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)a=r.readByte(),s.push(this.names.push(r.readString(a)));return s;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var A,c,l;for(l=[],o=A=0,c=this.file.maxp.numGlyphs;0<=c?A<c:A>c;o=0<=c?++A:--A)l.push(r.readUInt32());return l}).call(this)}},t}(),u9=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},f9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="name",t.prototype.parse=function(r){var a,n,s,o,A,c,l,d,f,p,u;for(r.pos=this.offset,r.readShort(),a=r.readShort(),c=r.readShort(),n=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(l={},o=f=0,p=n.length;f<p;o=++f)s=n[o],r.pos=s.offset,d=r.readString(s.length),A=new u9(d,s),l[u=s.nameID]==null&&(l[u]=[]),l[s.nameID].push(A);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},t}(),p9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),h9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="hmtx",t.prototype.parse=function(r){var a,n,s,o,A,c,l;for(r.pos=this.offset,this.metrics=[],a=0,c=this.file.hhea.numberOfMetrics;0<=c?a<c:a>c;a=0<=c?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,f;for(f=[],a=d=0;0<=s?d<s:d>s;a=0<=s?++d:--d)f.push(r.readInt16());return f}(),this.widths=(function(){var d,f,p,u;for(u=[],d=0,f=(p=this.metrics).length;d<f;d++)o=p[d],u.push(o.advance);return u}).call(this),n=this.widths[this.widths.length-1],l=[],a=A=0;0<=s?A<s:A>s;a=0<=s?++A:--A)l.push(this.widths.push(n));return l},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),GC=[].slice,m9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var a,n,s,o,A,c,l,d,f,p;return r in this.cache?this.cache[r]:(o=this.file.loca,a=this.file.contents,n=o.indexOf(r),(s=o.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,A=(c=new lc(a.read(s))).readShort(),d=c.readShort(),p=c.readShort(),l=c.readShort(),f=c.readShort(),this.cache[r]=A===-1?new x9(c,d,p,l,f):new g9(c,A,d,p,l,f),this.cache[r]))},t.prototype.encode=function(r,a,n){var s,o,A,c,l;for(A=[],o=[],c=0,l=a.length;c<l;c++)s=r[a[c]],o.push(A.length),s&&(A=A.concat(s.encode(n)));return o.push(A.length),{table:A,offsets:o}},t}(),g9=function(){function e(t,r,a,n,s,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),x9=function(){function e(t,r,a,n,s){var o,A;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;A=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&A;)o.pos+=1&A?4:2,128&A?o.pos+=8:64&A?o.pos+=4:8&A&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new lc(GC.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),y9=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vo(t,Ws),t.prototype.tag="loca",t.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,A=0;A<n.length;++A)if(n[A]=s,o<a.length&&a[o]==A){++o,n[A]=s;var c=this.offsets[A],l=this.offsets[A+1]-c;l>0&&(s+=l)}for(var d=new Array(4*n.length),f=0;f<n.length;++f)d[4*f+3]=255&n[f],d[4*f+2]=(65280&n[f])>>8,d[4*f+1]=(16711680&n[f])>>16,d[4*f]=(4278190080&n[f])>>24;return d},t}(),v9=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)a=s[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,s,o,A,c;for(n={},o=0,A=t.length;o<A;o++)n[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))a=c[s],n[s]=a;return n},e.prototype.encode=function(t,r){var a,n,s,o,A,c,l,d,f,p,u,g,h,y,x;for(n in a=HC.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),u={0:0},x=a.charMap)u[(c=x[n]).old]=c.new;for(g in p=a.maxGlyphID,o)g in u||(u[g]=p++);return d=function(v){var E,D;for(E in D={},v)D[v[E]]=E;return D}(u),f=Object.keys(d).sort(function(v,E){return v-E}),h=function(){var v,E,D;for(D=[],v=0,E=f.length;v<E;v++)A=f[v],D.push(d[A]);return D}(),s=this.font.glyf.encode(o,h,u),l=this.font.loca.encode(s.offsets,h),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Ht.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,s,o;if(Array.isArray(r))return"["+function(){var A,c,l;for(l=[],A=0,c=r.length;A<c;A++)a=r[A],l.push(t.convert(a));return l}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)o=r[n],s.push("/"+n+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jx=function(e,t){return jx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},jx(e,t)};function Xs(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");jx(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Lx=function(){return Lx=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Lx.apply(this,arguments)};function ci(e,t,r,a){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function A(d){try{l(a.next(d))}catch(f){o(f)}}function c(d){try{l(a.throw(d))}catch(f){o(f)}}function l(d){d.done?s(d.value):n(d.value).then(A,c)}l((a=a.apply(e,[])).next())})}function Pn(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,o;return o={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function A(l){return function(d){return c([l,d])}}function c(l){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(d){l=[6,d],n=0}finally{a=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function vp(e,t,r){if(arguments.length===2)for(var a=0,n=t.length,s;a<n;a++)(s||!(a in t))&&(s||(s=Array.prototype.slice.call(t,0,a)),s[a]=t[a]);return e.concat(s||t)}var aA=function(){function e(t,r,a,n){this.left=t,this.top=r,this.width=a,this.height=n}return e.prototype.add=function(t,r,a,n){return new e(this.left+t,this.top+r,this.width+a,this.height+n)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var a=Array.from(r).find(function(n){return n.width!==0});return a?new e(a.left+t.windowBounds.left,a.top+t.windowBounds.top,a.width,a.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),Om=function(e,t){return aA.fromClientRect(e,t.getBoundingClientRect())},w9=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),n=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new aA(0,0,a,n)},Im=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((n&1023)<<10)+(s&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},ka=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,s="";++n<r;){var o=e[n];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(n+1===r||a.length>16384)&&(s+=String.fromCharCode.apply(String,a),a.length=0)}return s},Cw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var wp=0;wp<Cw.length;wp++)E9[Cw.charCodeAt(wp)]=wp;var Bw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Ep=0;Ep<Bw.length;Ep++)zu[Bw.charCodeAt(Ep)]=Ep;var _9=function(e){var t=e.length*.75,r=e.length,a,n=0,s,o,A,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(l)?l:new Uint8Array(l);for(a=0;a<r;a+=4)s=zu[e.charCodeAt(a)],o=zu[e.charCodeAt(a+1)],A=zu[e.charCodeAt(a+2)],c=zu[e.charCodeAt(a+3)],d[n++]=s<<2|o>>4,d[n++]=(o&15)<<4|A>>2,d[n++]=(A&3)<<6|c&63;return l},b9=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},C9=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},el=5,Sy=11,Zg=2,B9=Sy-el,zC=65536>>el,S9=1<<el,e1=S9-1,T9=1024>>el,O9=zC+T9,I9=O9,N9=32,F9=I9+N9,R9=65536>>Sy,k9=1<<B9,D9=k9-1,Sw=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},j9=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},L9=function(e,t){var r=_9(e),a=Array.isArray(r)?C9(r):new Uint32Array(r),n=Array.isArray(r)?b9(r):new Uint16Array(r),s=24,o=Sw(n,s/2,a[4]/2),A=a[5]===2?Sw(n,(s+a[4])/2):j9(a,Math.ceil((s+a[4])/4));return new U9(a[0],a[1],a[2],a[3],o,A)},U9=function(){function e(t,r,a,n,s,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=s,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>el],r=(r<<Zg)+(t&e1),this.data[r];if(t<=65535)return r=this.index[zC+(t-55296>>el)],r=(r<<Zg)+(t&e1),this.data[r];if(t<this.highStart)return r=F9-R9+(t>>Sy),r=this.index[r],r+=t>>el&D9,r=this.index[r],r=(r<<Zg)+(t&e1),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),Tw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _p=0;_p<Tw.length;_p++)M9[Tw.charCodeAt(_p)]=_p;var P9="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Ow=50,Q9=1,VC=2,$C=3,q9=4,K9=5,Iw=7,YC=8,Nw=9,zA=10,Ux=11,Fw=12,Mx=13,H9=14,Vu=15,Px=16,bp=17,Iu=18,G9=19,Rw=20,Qx=21,Nu=22,t1=23,Xl=24,Gi=25,$u=26,Yu=27,Jl=28,z9=29,Uc=30,V9=31,Cp=32,Bp=33,qx=34,Kx=35,Hx=36,Yf=37,Gx=38,Ah=39,ch=40,r1=41,WC=42,$9=43,Y9=[9001,65288],XC="!",mr="×",Sp="÷",zx=L9(P9),Mo=[Uc,Hx],Vx=[Q9,VC,$C,K9],JC=[zA,YC],kw=[Yu,$u],W9=Vx.concat(JC),Dw=[Gx,Ah,ch,qx,Kx],X9=[Vu,Mx],J9=function(e,t){t===void 0&&(t="strict");var r=[],a=[],n=[];return e.forEach(function(s,o){var A=zx.get(s);if(A>Ow?(n.push(!0),A-=Ow):n.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return a.push(o),r.push(Px);if(A===q9||A===Ux){if(o===0)return a.push(o),r.push(Uc);var c=r[o-1];return W9.indexOf(c)===-1?(a.push(a[o-1]),r.push(c)):(a.push(o),r.push(Uc))}if(a.push(o),A===V9)return r.push(t==="strict"?Qx:Yf);if(A===WC||A===z9)return r.push(Uc);if(A===$9)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(Yf):r.push(Uc);r.push(A)}),[a,r,n]},a1=function(e,t,r,a){var n=a[r];if(Array.isArray(e)?e.indexOf(n)!==-1:e===n)for(var s=r;s<=a.length;){s++;var o=a[s];if(o===t)return!0;if(o!==zA)break}if(n===zA)for(var s=r;s>0;){s--;var A=a[s];if(Array.isArray(e)?e.indexOf(A)!==-1:e===A)for(var c=r;c<=a.length;){c++;var o=a[c];if(o===t)return!0;if(o!==zA)break}if(A!==zA)break}return!1},jw=function(e,t){for(var r=e;r>=0;){var a=t[r];if(a===zA)r--;else return a}return 0},Z9=function(e,t,r,a,n){if(r[a]===0)return mr;var s=a-1;if(Array.isArray(n)&&n[s]===!0)return mr;var o=s-1,A=s+1,c=t[s],l=o>=0?t[o]:0,d=t[A];if(c===VC&&d===$C)return mr;if(Vx.indexOf(c)!==-1)return XC;if(Vx.indexOf(d)!==-1||JC.indexOf(d)!==-1)return mr;if(jw(s,t)===YC)return Sp;if(zx.get(e[s])===Ux||(c===Cp||c===Bp)&&zx.get(e[A])===Ux||c===Iw||d===Iw||c===Nw||[zA,Mx,Vu].indexOf(c)===-1&&d===Nw||[bp,Iu,G9,Xl,Jl].indexOf(d)!==-1||jw(s,t)===Nu||a1(t1,Nu,s,t)||a1([bp,Iu],Qx,s,t)||a1(Fw,Fw,s,t))return mr;if(c===zA)return Sp;if(c===t1||d===t1)return mr;if(d===Px||c===Px)return Sp;if([Mx,Vu,Qx].indexOf(d)!==-1||c===H9||l===Hx&&X9.indexOf(c)!==-1||c===Jl&&d===Hx||d===Rw||Mo.indexOf(d)!==-1&&c===Gi||Mo.indexOf(c)!==-1&&d===Gi||c===Yu&&[Yf,Cp,Bp].indexOf(d)!==-1||[Yf,Cp,Bp].indexOf(c)!==-1&&d===$u||Mo.indexOf(c)!==-1&&kw.indexOf(d)!==-1||kw.indexOf(c)!==-1&&Mo.indexOf(d)!==-1||[Yu,$u].indexOf(c)!==-1&&(d===Gi||[Nu,Vu].indexOf(d)!==-1&&t[A+1]===Gi)||[Nu,Vu].indexOf(c)!==-1&&d===Gi||c===Gi&&[Gi,Jl,Xl].indexOf(d)!==-1)return mr;if([Gi,Jl,Xl,bp,Iu].indexOf(d)!==-1)for(var f=s;f>=0;){var p=t[f];if(p===Gi)return mr;if([Jl,Xl].indexOf(p)!==-1)f--;else break}if([Yu,$u].indexOf(d)!==-1)for(var f=[bp,Iu].indexOf(c)!==-1?o:s;f>=0;){var p=t[f];if(p===Gi)return mr;if([Jl,Xl].indexOf(p)!==-1)f--;else break}if(Gx===c&&[Gx,Ah,qx,Kx].indexOf(d)!==-1||[Ah,qx].indexOf(c)!==-1&&[Ah,ch].indexOf(d)!==-1||[ch,Kx].indexOf(c)!==-1&&d===ch||Dw.indexOf(c)!==-1&&[Rw,$u].indexOf(d)!==-1||Dw.indexOf(d)!==-1&&c===Yu||Mo.indexOf(c)!==-1&&Mo.indexOf(d)!==-1||c===Xl&&Mo.indexOf(d)!==-1||Mo.concat(Gi).indexOf(c)!==-1&&d===Nu&&Y9.indexOf(e[A])===-1||Mo.concat(Gi).indexOf(d)!==-1&&c===Iu)return mr;if(c===r1&&d===r1){for(var u=r[s],g=1;u>0&&(u--,t[u]===r1);)g++;if(g%2!==0)return mr}return c===Cp&&d===Bp?mr:Sp},eQ=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=J9(e,t.lineBreak),a=r[0],n=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(n=n.map(function(A){return[Gi,Uc,WC].indexOf(A)!==-1?Yf:A}));var o=t.wordBreak==="keep-all"?s.map(function(A,c){return A&&e[c]>=19968&&e[c]<=40959}):void 0;return[a,n,o]},tQ=function(){function e(t,r,a,n){this.codePoints=t,this.required=r===XC,this.start=a,this.end=n}return e.prototype.slice=function(){return ka.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),rQ=function(e,t){var r=Im(e),a=eQ(r,t),n=a[0],s=a[1],o=a[2],A=r.length,c=0,l=0;return{next:function(){if(l>=A)return{done:!0,value:null};for(var d=mr;l<A&&(d=Z9(r,s,n,++l,o))===mr;);if(d!==mr||l===A){var f=new tQ(r,d,c,l);return c=l,{value:f,done:!1}}return{done:!0,value:null}}}},aQ=1,nQ=2,f0=4,Lw=8,Kh=10,Uw=47,gf=92,iQ=9,sQ=32,Tp=34,Fu=61,oQ=35,AQ=36,cQ=37,Op=39,Ip=40,Ru=41,lQ=95,Oi=45,dQ=33,uQ=60,fQ=62,pQ=64,hQ=91,mQ=93,gQ=61,xQ=123,Np=63,yQ=125,Mw=124,vQ=126,wQ=128,Pw=65533,n1=42,Pc=43,EQ=44,_Q=58,bQ=59,Wf=46,CQ=0,BQ=8,SQ=11,TQ=14,OQ=31,IQ=127,ao=-1,ZC=48,eB=97,tB=101,NQ=102,FQ=117,RQ=122,rB=65,aB=69,nB=70,kQ=85,DQ=90,Hn=function(e){return e>=ZC&&e<=57},jQ=function(e){return e>=55296&&e<=57343},Zl=function(e){return Hn(e)||e>=rB&&e<=nB||e>=eB&&e<=NQ},LQ=function(e){return e>=eB&&e<=RQ},UQ=function(e){return e>=rB&&e<=DQ},MQ=function(e){return LQ(e)||UQ(e)},PQ=function(e){return e>=wQ},Fp=function(e){return e===Kh||e===iQ||e===sQ},Hh=function(e){return MQ(e)||PQ(e)||e===lQ},Qw=function(e){return Hh(e)||Hn(e)||e===Oi},QQ=function(e){return e>=CQ&&e<=BQ||e===SQ||e>=TQ&&e<=OQ||e===IQ},jA=function(e,t){return e!==gf?!1:t!==Kh},Rp=function(e,t,r){return e===Oi?Hh(t)||jA(t,r):Hh(e)?!0:!!(e===gf&&jA(e,t))},i1=function(e,t,r){return e===Pc||e===Oi?Hn(t)?!0:t===Wf&&Hn(r):Hn(e===Wf?t:e)},qQ=function(e){var t=0,r=1;(e[t]===Pc||e[t]===Oi)&&(e[t]===Oi&&(r=-1),t++);for(var a=[];Hn(e[t]);)a.push(e[t++]);var n=a.length?parseInt(ka.apply(void 0,a),10):0;e[t]===Wf&&t++;for(var s=[];Hn(e[t]);)s.push(e[t++]);var o=s.length,A=o?parseInt(ka.apply(void 0,s),10):0;(e[t]===aB||e[t]===tB)&&t++;var c=1;(e[t]===Pc||e[t]===Oi)&&(e[t]===Oi&&(c=-1),t++);for(var l=[];Hn(e[t]);)l.push(e[t++]);var d=l.length?parseInt(ka.apply(void 0,l),10):0;return r*(n+A*Math.pow(10,-o))*Math.pow(10,c*d)},KQ={type:2},HQ={type:3},GQ={type:4},zQ={type:13},VQ={type:8},$Q={type:21},YQ={type:9},WQ={type:10},XQ={type:11},JQ={type:12},ZQ={type:14},kp={type:23},eq={type:1},tq={type:25},rq={type:24},aq={type:26},nq={type:27},iq={type:28},sq={type:29},oq={type:31},$x={type:32},iB=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Im(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==$x;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Tp:return this.consumeStringToken(Tp);case oQ:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),n=this.peekCodePoint(2);if(Qw(r)||jA(a,n)){var s=Rp(r,a,n)?nQ:aQ,o=this.consumeName();return{type:5,value:o,flags:s}}break;case AQ:if(this.peekCodePoint(0)===Fu)return this.consumeCodePoint(),zQ;break;case Op:return this.consumeStringToken(Op);case Ip:return KQ;case Ru:return HQ;case n1:if(this.peekCodePoint(0)===Fu)return this.consumeCodePoint(),ZQ;break;case Pc:if(i1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case EQ:return GQ;case Oi:var A=t,c=this.peekCodePoint(0),l=this.peekCodePoint(1);if(i1(A,c,l))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Rp(A,c,l))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===Oi&&l===fQ)return this.consumeCodePoint(),this.consumeCodePoint(),rq;break;case Wf:if(i1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Uw:if(this.peekCodePoint(0)===n1)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===n1&&(d=this.consumeCodePoint(),d===Uw))return this.consumeToken();if(d===ao)return this.consumeToken()}break;case _Q:return aq;case bQ:return nq;case uQ:if(this.peekCodePoint(0)===dQ&&this.peekCodePoint(1)===Oi&&this.peekCodePoint(2)===Oi)return this.consumeCodePoint(),this.consumeCodePoint(),tq;break;case pQ:var f=this.peekCodePoint(0),p=this.peekCodePoint(1),u=this.peekCodePoint(2);if(Rp(f,p,u)){var o=this.consumeName();return{type:7,value:o}}break;case hQ:return iq;case gf:if(jA(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case mQ:return sq;case gQ:if(this.peekCodePoint(0)===Fu)return this.consumeCodePoint(),VQ;break;case xQ:return XQ;case yQ:return JQ;case FQ:case kQ:var g=this.peekCodePoint(0),h=this.peekCodePoint(1);return g===Pc&&(Zl(h)||h===Np)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case Mw:if(this.peekCodePoint(0)===Fu)return this.consumeCodePoint(),YQ;if(this.peekCodePoint(0)===Mw)return this.consumeCodePoint(),$Q;break;case vQ:if(this.peekCodePoint(0)===Fu)return this.consumeCodePoint(),WQ;break;case ao:return $x}return Fp(t)?(this.consumeWhiteSpace(),oq):Hn(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Hh(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:ka(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Zl(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var a=!1;r===Np&&t.length<6;)t.push(r),r=this.consumeCodePoint(),a=!0;if(a){var n=parseInt(ka.apply(void 0,t.map(function(c){return c===Np?ZC:c})),16),s=parseInt(ka.apply(void 0,t.map(function(c){return c===Np?nB:c})),16);return{type:30,start:n,end:s}}var o=parseInt(ka.apply(void 0,t),16);if(this.peekCodePoint(0)===Oi&&Zl(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var A=[];Zl(r)&&A.length<6;)A.push(r),r=this.consumeCodePoint();var s=parseInt(ka.apply(void 0,A),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Ip?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ip?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ao)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Op||r===Tp){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ao||this.peekCodePoint(0)===Ru)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),kp)}for(;;){var n=this.consumeCodePoint();if(n===ao||n===Ru)return{type:22,value:ka.apply(void 0,t)};if(Fp(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ao||this.peekCodePoint(0)===Ru?(this.consumeCodePoint(),{type:22,value:ka.apply(void 0,t)}):(this.consumeBadUrlRemnants(),kp);if(n===Tp||n===Op||n===Ip||QQ(n))return this.consumeBadUrlRemnants(),kp;if(n===gf)if(jA(n,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),kp;else t.push(n)}},e.prototype.consumeWhiteSpace=function(){for(;Fp(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Ru||t===ao)return;jA(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,a="";t>0;){var n=Math.min(r,t);a+=ka.apply(void 0,this._value.splice(0,n)),t-=n}return this._value.shift(),a},e.prototype.consumeStringToken=function(t){var r="",a=0;do{var n=this._value[a];if(n===ao||n===void 0||n===t)return r+=this.consumeStringSlice(a),{type:0,value:r};if(n===Kh)return this._value.splice(0,a),eq;if(n===gf){var s=this._value[a+1];s!==ao&&s!==void 0&&(s===Kh?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):jA(n,s)&&(r+=this.consumeStringSlice(a),r+=ka(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=f0,a=this.peekCodePoint(0);for((a===Pc||a===Oi)&&t.push(this.consumeCodePoint());Hn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(a===Wf&&Hn(n))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Lw;Hn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0),n=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((a===aB||a===tB)&&((n===Pc||n===Oi)&&Hn(s)||Hn(n)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Lw;Hn(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[qQ(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],a=t[1],n=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Rp(n,s,o)){var A=this.consumeName();return{type:15,number:r,flags:a,unit:A}}return n===cQ?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Zl(t)){for(var r=ka(t);Zl(this.peekCodePoint(0))&&r.length<6;)r+=ka(this.consumeCodePoint());Fp(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||jQ(a)||a>1114111?Pw:a}return t===ao?Pw:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(Qw(r))t+=ka(r);else if(jA(r,this.peekCodePoint(0)))t+=ka(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),sB=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new iB;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},a=this.consumeToken();;){if(a.type===32||cq(a,t))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?$x:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),p0=function(e){return e.type===15},Xd=function(e){return e.type===17},Kr=function(e){return e.type===20},Aq=function(e){return e.type===0},Yx=function(e,t){return Kr(e)&&e.value===t},oB=function(e){return e.type!==31},Kd=function(e){return e.type!==31&&e.type!==4},wo=function(e){var t=[],r=[];return e.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&t.push(r),t},cq=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},dc=function(e){return e.type===17||e.type===15},Wa=function(e){return e.type===16||dc(e)},AB=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Nn={type:17,number:0,flags:f0},Ty={type:16,number:50,flags:f0},VA={type:16,number:100,flags:f0},Wu=function(e,t,r){var a=e[0],n=e[1];return[aa(a,t),aa(typeof n<"u"?n:a,r)]},aa=function(e,t){if(e.type===16)return e.number/100*t;if(p0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},cB="deg",lB="grad",dB="rad",uB="turn",Nm={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case cB:return Math.PI*t.number/180;case lB:return Math.PI/200*t.number;case dB:return t.number;case uB:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},fB=function(e){return e.type===15&&(e.unit===cB||e.unit===lB||e.unit===dB||e.unit===uB)},pB=function(e){var t=e.filter(Kr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Nn,Nn];case"to top":case"bottom":return _s(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Nn,VA];case"to right":case"left":return _s(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[VA,VA];case"to bottom":case"top":return _s(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[VA,Nn];case"to left":case"right":return _s(270)}return 0},_s=function(e){return Math.PI*e/180},YA={name:"color",parse:function(e,t){if(t.type===18){var r=lq[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var a=t.value.substring(0,1),n=t.value.substring(1,2),s=t.value.substring(2,3);return $A(parseInt(a+a,16),parseInt(n+n,16),parseInt(s+s,16),1)}if(t.value.length===4){var a=t.value.substring(0,1),n=t.value.substring(1,2),s=t.value.substring(2,3),o=t.value.substring(3,4);return $A(parseInt(a+a,16),parseInt(n+n,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(t.value.length===6){var a=t.value.substring(0,2),n=t.value.substring(2,4),s=t.value.substring(4,6);return $A(parseInt(a,16),parseInt(n,16),parseInt(s,16),1)}if(t.value.length===8){var a=t.value.substring(0,2),n=t.value.substring(2,4),s=t.value.substring(4,6),o=t.value.substring(6,8);return $A(parseInt(a,16),parseInt(n,16),parseInt(s,16),parseInt(o,16)/255)}}if(t.type===20){var A=Jo[t.value.toUpperCase()];if(typeof A<"u")return A}return Jo.TRANSPARENT}},WA=function(e){return(255&e)===0},pn=function(e){var t=255&e,r=255&e>>8,a=255&e>>16,n=255&e>>24;return t<255?"rgba("+n+","+a+","+r+","+t/255+")":"rgb("+n+","+a+","+r+")"},$A=function(e,t,r,a){return(e<<24|t<<16|r<<8|Math.round(a*255)<<0)>>>0},qw=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},Kw=function(e,t){var r=t.filter(Kd);if(r.length===3){var a=r.map(qw),n=a[0],s=a[1],o=a[2];return $A(n,s,o,1)}if(r.length===4){var A=r.map(qw),n=A[0],s=A[1],o=A[2],c=A[3];return $A(n,s,o,c)}return 0};function s1(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var Hw=function(e,t){var r=t.filter(Kd),a=r[0],n=r[1],s=r[2],o=r[3],A=(a.type===17?_s(a.number):Nm.parse(e,a))/(Math.PI*2),c=Wa(n)?n.number/100:0,l=Wa(s)?s.number/100:0,d=typeof o<"u"&&Wa(o)?aa(o,1):1;if(c===0)return $A(l*255,l*255,l*255,1);var f=l<=.5?l*(c+1):l+c-l*c,p=l*2-f,u=s1(p,f,A+1/3),g=s1(p,f,A),h=s1(p,f,A-1/3);return $A(u*255,g*255,h*255,d)},lq={hsl:Hw,hsla:Hw,rgb:Kw,rgba:Kw},xf=function(e,t){return YA.parse(e,sB.create(t).parseComponentValue())},Jo={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},dq={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Kr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},uq={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Fm=function(e,t){var r=YA.parse(e,t[0]),a=t[1];return a&&Wa(a)?{color:r,stop:a}:{color:r,stop:null}},Gw=function(e,t){var r=e[0],a=e[e.length-1];r.stop===null&&(r.stop=Nn),a.stop===null&&(a.stop=VA);for(var n=[],s=0,o=0;o<e.length;o++){var A=e[o].stop;if(A!==null){var c=aa(A,t);c>s?n.push(c):n.push(s),s=c}else n.push(null)}for(var l=null,o=0;o<n.length;o++){var d=n[o];if(d===null)l===null&&(l=o);else if(l!==null){for(var f=o-l,p=n[l-1],u=(d-p)/(f+1),g=1;g<=f;g++)n[l+g-1]=u*g;l=null}}return e.map(function(h,y){var x=h.color;return{color:x,stop:Math.max(Math.min(1,n[y]/t),0)}})},fq=function(e,t,r){var a=t/2,n=r/2,s=aa(e[0],t)-a,o=n-aa(e[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},pq=function(e,t,r){var a=typeof e=="number"?e:fq(e,t,r),n=Math.abs(t*Math.sin(a))+Math.abs(r*Math.cos(a)),s=t/2,o=r/2,A=n/2,c=Math.sin(a-Math.PI/2)*A,l=Math.cos(a-Math.PI/2)*A;return[n,s-l,s+l,o-c,o+c]},Qs=function(e,t){return Math.sqrt(e*e+t*t)},zw=function(e,t,r,a,n){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(o,A){var c=A[0],l=A[1],d=Qs(r-c,a-l);return(n?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:A,optimumDistance:d}:o},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},hq=function(e,t,r,a,n){var s=0,o=0;switch(e.size){case 0:e.shape===0?s=o=Math.min(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-a)),o=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(e.shape===0)s=o=Math.min(Qs(t,r),Qs(t,r-n),Qs(t-a,r),Qs(t-a,r-n));else if(e.shape===1){var A=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(t),Math.abs(t-a)),c=zw(a,n,t,r,!0),l=c[0],d=c[1];s=Qs(l-t,(d-r)/A),o=A*s}break;case 1:e.shape===0?s=o=Math.max(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-a)),o=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(e.shape===0)s=o=Math.max(Qs(t,r),Qs(t,r-n),Qs(t-a,r),Qs(t-a,r-n));else if(e.shape===1){var A=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(t),Math.abs(t-a)),f=zw(a,n,t,r,!1),l=f[0],d=f[1];s=Qs(l-t,(d-r)/A),o=A*s}break}return Array.isArray(e.size)&&(s=aa(e.size[0],a),o=e.size.length===2?aa(e.size[1],n):s),[s,o]},mq=function(e,t){var r=_s(180),a=[];return wo(t).forEach(function(n,s){if(s===0){var o=n[0];if(o.type===20&&o.value==="to"){r=pB(n);return}else if(fB(o)){r=Nm.parse(e,o);return}}var A=Fm(e,n);a.push(A)}),{angle:r,stops:a,type:1}},Dp=function(e,t){var r=_s(180),a=[];return wo(t).forEach(function(n,s){if(s===0){var o=n[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=pB(n);return}else if(fB(o)){r=(Nm.parse(e,o)+_s(270))%_s(360);return}}var A=Fm(e,n);a.push(A)}),{angle:r,stops:a,type:1}},gq=function(e,t){var r=_s(180),a=[],n=1,s=0,o=3,A=[];return wo(t).forEach(function(c,l){var d=c[0];if(l===0){if(Kr(d)&&d.value==="linear"){n=1;return}else if(Kr(d)&&d.value==="radial"){n=2;return}}if(d.type===18){if(d.name==="from"){var f=YA.parse(e,d.values[0]);a.push({stop:Nn,color:f})}else if(d.name==="to"){var f=YA.parse(e,d.values[0]);a.push({stop:VA,color:f})}else if(d.name==="color-stop"){var p=d.values.filter(Kd);if(p.length===2){var f=YA.parse(e,p[1]),u=p[0];Xd(u)&&a.push({stop:{type:16,number:u.number*100,flags:u.flags},color:f})}}}}),n===1?{angle:(r+_s(180))%_s(360),stops:a,type:n}:{size:o,shape:s,stops:a,position:A,type:n}},hB="closest-side",mB="farthest-side",gB="closest-corner",xB="farthest-corner",yB="circle",vB="ellipse",wB="cover",EB="contain",xq=function(e,t){var r=0,a=3,n=[],s=[];return wo(t).forEach(function(o,A){var c=!0;if(A===0){var l=!1;c=o.reduce(function(f,p){if(l)if(Kr(p))switch(p.value){case"center":return s.push(Ty),f;case"top":case"left":return s.push(Nn),f;case"right":case"bottom":return s.push(VA),f}else(Wa(p)||dc(p))&&s.push(p);else if(Kr(p))switch(p.value){case yB:return r=0,!1;case vB:return r=1,!1;case"at":return l=!0,!1;case hB:return a=0,!1;case wB:case mB:return a=1,!1;case EB:case gB:return a=2,!1;case xB:return a=3,!1}else if(dc(p)||Wa(p))return Array.isArray(a)||(a=[]),a.push(p),!1;return f},c)}if(c){var d=Fm(e,o);n.push(d)}}),{size:a,shape:r,stops:n,position:s,type:2}},jp=function(e,t){var r=0,a=3,n=[],s=[];return wo(t).forEach(function(o,A){var c=!0;if(A===0?c=o.reduce(function(d,f){if(Kr(f))switch(f.value){case"center":return s.push(Ty),!1;case"top":case"left":return s.push(Nn),!1;case"right":case"bottom":return s.push(VA),!1}else if(Wa(f)||dc(f))return s.push(f),!1;return d},c):A===1&&(c=o.reduce(function(d,f){if(Kr(f))switch(f.value){case yB:return r=0,!1;case vB:return r=1,!1;case EB:case hB:return a=0,!1;case mB:return a=1,!1;case gB:return a=2,!1;case wB:case xB:return a=3,!1}else if(dc(f)||Wa(f))return Array.isArray(a)||(a=[]),a.push(f),!1;return d},c)),c){var l=Fm(e,o);n.push(l)}}),{size:a,shape:r,stops:n,position:s,type:2}},yq=function(e){return e.type===1},vq=function(e){return e.type===2},Oy={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var a=_B[t.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return a(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function wq(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!_B[e.name])}var _B={"linear-gradient":mq,"-moz-linear-gradient":Dp,"-ms-linear-gradient":Dp,"-o-linear-gradient":Dp,"-webkit-linear-gradient":Dp,"radial-gradient":xq,"-moz-radial-gradient":jp,"-ms-radial-gradient":jp,"-o-radial-gradient":jp,"-webkit-radial-gradient":jp,"-webkit-gradient":gq},Eq={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(a){return Kd(a)&&wq(a)}).map(function(a){return Oy.parse(e,a)})}},_q={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Kr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},bq={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return wo(t).map(function(r){return r.filter(Wa)}).map(AB)}},Cq={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return wo(t).map(function(r){return r.filter(Kr).map(function(a){return a.value}).join(" ")}).map(Bq)}},Bq=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},kd;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(kd||(kd={}));var Sq={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return wo(t).map(function(r){return r.filter(Tq)})}},Tq=function(e){return Kr(e)||Wa(e)},Rm=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Oq=Rm("top"),Iq=Rm("right"),Nq=Rm("bottom"),Fq=Rm("left"),km=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return AB(r.filter(Wa))}}},Rq=km("top-left"),kq=km("top-right"),Dq=km("bottom-right"),jq=km("bottom-left"),Dm=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Lq=Dm("top"),Uq=Dm("right"),Mq=Dm("bottom"),Pq=Dm("left"),jm=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return p0(r)?r.number:0}}},Qq=jm("top"),qq=jm("right"),Kq=jm("bottom"),Hq=jm("left"),Gq={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},zq={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Vq={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Kr).reduce(function(r,a){return r|$q(a.value)},0)}},$q=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Yq={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Wq={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Gh;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Gh||(Gh={}));var Xq={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return Gh.STRICT;case"normal":default:return Gh.NORMAL}}},Jq={name:"line-height",initialValue:"normal",prefix:!1,type:4},Vw=function(e,t){return Kr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Wa(e)?aa(e,t):t},Zq={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:Oy.parse(e,t)}},eK={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},Wx={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Lm=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},tK=Lm("top"),rK=Lm("right"),aK=Lm("bottom"),nK=Lm("left"),iK={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Kr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},sK={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Um=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},oK=Um("top"),AK=Um("right"),cK=Um("bottom"),lK=Um("left"),dK={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},uK={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},fK={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Yx(t[0],"none")?[]:wo(t).map(function(r){for(var a={color:Jo.TRANSPARENT,offsetX:Nn,offsetY:Nn,blur:Nn},n=0,s=0;s<r.length;s++){var o=r[s];dc(o)?(n===0?a.offsetX=o:n===1?a.offsetY=o:a.blur=o,n++):a.color=YA.parse(e,o)}return a})}},pK={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},hK={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=xK[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},mK=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},gK=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],a=t[1];t[2],t[3];var n=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],A=t[13];return t[14],t[15],t.length===16?[r,a,n,s,o,A]:null},xK={matrix:mK,matrix3d:gK},$w={type:16,number:50,flags:f0},yK=[$w,$w],vK={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Wa);return r.length!==2?yK:[r[0],r[1]]}},wK={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},yf;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(yf||(yf={}));var EK={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return yf.BREAK_ALL;case"keep-all":return yf.KEEP_ALL;case"normal":default:return yf.NORMAL}}},_K={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Xd(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},bB={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},bK={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Xd(t)?t.number:1}},CK={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},BK={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Kr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},SK={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],a=[];return t.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},TK={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},OK={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(Xd(t))return t.number;if(Kr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},IK={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Kr).map(function(r){return r.value})}},NK={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},sn=function(e,t){return(e&t)!==0},FK={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},RK={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var a=[],n=t.filter(oB),s=0;s<n.length;s++){var o=n[s],A=n[s+1];if(o.type===20){var c=A&&Xd(A)?A.number:1;a.push({counter:o.value,increment:c})}}return a}},kK={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],a=t.filter(oB),n=0;n<a.length;n++){var s=a[n],o=a[n+1];if(Kr(s)&&s.value!=="none"){var A=o&&Xd(o)?o.number:0;r.push({counter:s.value,reset:A})}}return r}},DK={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(p0).map(function(r){return bB.parse(e,r)})}},jK={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var a=[],n=t.filter(Aq);if(n.length%2!==0)return null;for(var s=0;s<n.length;s+=2){var o=n[s].value,A=n[s+1].value;a.push({open:o,close:A})}return a}},Yw=function(e,t,r){if(!e)return"";var a=e[Math.min(t,e.length-1)];return a?r?a.open:a.close:""},LK={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Yx(t[0],"none")?[]:wo(t).map(function(r){for(var a={color:255,offsetX:Nn,offsetY:Nn,blur:Nn,spread:Nn,inset:!1},n=0,s=0;s<r.length;s++){var o=r[s];Yx(o,"inset")?a.inset=!0:dc(o)?(n===0?a.offsetX=o:n===1?a.offsetY=o:n===2?a.blur=o:a.spread=o,n++):a.color=YA.parse(e,o)}return a})}},UK={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],a=[];return t.filter(Kr).forEach(function(n){switch(n.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(n){a.indexOf(n)===-1&&a.push(n)}),a}},MK={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},PK={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return p0(t)?t.number:0}},QK=function(){function e(t,r){var a,n;this.animationDuration=It(t,DK,r.animationDuration),this.backgroundClip=It(t,dq,r.backgroundClip),this.backgroundColor=It(t,uq,r.backgroundColor),this.backgroundImage=It(t,Eq,r.backgroundImage),this.backgroundOrigin=It(t,_q,r.backgroundOrigin),this.backgroundPosition=It(t,bq,r.backgroundPosition),this.backgroundRepeat=It(t,Cq,r.backgroundRepeat),this.backgroundSize=It(t,Sq,r.backgroundSize),this.borderTopColor=It(t,Oq,r.borderTopColor),this.borderRightColor=It(t,Iq,r.borderRightColor),this.borderBottomColor=It(t,Nq,r.borderBottomColor),this.borderLeftColor=It(t,Fq,r.borderLeftColor),this.borderTopLeftRadius=It(t,Rq,r.borderTopLeftRadius),this.borderTopRightRadius=It(t,kq,r.borderTopRightRadius),this.borderBottomRightRadius=It(t,Dq,r.borderBottomRightRadius),this.borderBottomLeftRadius=It(t,jq,r.borderBottomLeftRadius),this.borderTopStyle=It(t,Lq,r.borderTopStyle),this.borderRightStyle=It(t,Uq,r.borderRightStyle),this.borderBottomStyle=It(t,Mq,r.borderBottomStyle),this.borderLeftStyle=It(t,Pq,r.borderLeftStyle),this.borderTopWidth=It(t,Qq,r.borderTopWidth),this.borderRightWidth=It(t,qq,r.borderRightWidth),this.borderBottomWidth=It(t,Kq,r.borderBottomWidth),this.borderLeftWidth=It(t,Hq,r.borderLeftWidth),this.boxShadow=It(t,LK,r.boxShadow),this.color=It(t,Gq,r.color),this.direction=It(t,zq,r.direction),this.display=It(t,Vq,r.display),this.float=It(t,Yq,r.cssFloat),this.fontFamily=It(t,SK,r.fontFamily),this.fontSize=It(t,TK,r.fontSize),this.fontStyle=It(t,NK,r.fontStyle),this.fontVariant=It(t,IK,r.fontVariant),this.fontWeight=It(t,OK,r.fontWeight),this.letterSpacing=It(t,Wq,r.letterSpacing),this.lineBreak=It(t,Xq,r.lineBreak),this.lineHeight=It(t,Jq,r.lineHeight),this.listStyleImage=It(t,Zq,r.listStyleImage),this.listStylePosition=It(t,eK,r.listStylePosition),this.listStyleType=It(t,Wx,r.listStyleType),this.marginTop=It(t,tK,r.marginTop),this.marginRight=It(t,rK,r.marginRight),this.marginBottom=It(t,aK,r.marginBottom),this.marginLeft=It(t,nK,r.marginLeft),this.opacity=It(t,bK,r.opacity);var s=It(t,iK,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=It(t,sK,r.overflowWrap),this.paddingTop=It(t,oK,r.paddingTop),this.paddingRight=It(t,AK,r.paddingRight),this.paddingBottom=It(t,cK,r.paddingBottom),this.paddingLeft=It(t,lK,r.paddingLeft),this.paintOrder=It(t,UK,r.paintOrder),this.position=It(t,uK,r.position),this.textAlign=It(t,dK,r.textAlign),this.textDecorationColor=It(t,CK,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=It(t,BK,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=It(t,fK,r.textShadow),this.textTransform=It(t,pK,r.textTransform),this.transform=It(t,hK,r.transform),this.transformOrigin=It(t,vK,r.transformOrigin),this.visibility=It(t,wK,r.visibility),this.webkitTextStrokeColor=It(t,MK,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=It(t,PK,r.webkitTextStrokeWidth),this.wordBreak=It(t,EK,r.wordBreak),this.zIndex=It(t,_K,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return WA(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return sn(this.display,4)||sn(this.display,33554432)||sn(this.display,268435456)||sn(this.display,536870912)||sn(this.display,67108864)||sn(this.display,134217728)},e}(),qK=function(){function e(t,r){this.content=It(t,FK,r.content),this.quotes=It(t,jK,r.quotes)}return e}(),Ww=function(){function e(t,r){this.counterIncrement=It(t,RK,r.counterIncrement),this.counterReset=It(t,kK,r.counterReset)}return e}(),It=function(e,t,r){var a=new iB,n=r!==null&&typeof r<"u"?r.toString():t.initialValue;a.write(n);var s=new sB(a.read());switch(t.type){case 2:var o=s.parseComponentValue();return t.parse(e,Kr(o)?o.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return Nm.parse(e,s.parseComponentValue());case"color":return YA.parse(e,s.parseComponentValue());case"image":return Oy.parse(e,s.parseComponentValue());case"length":var A=s.parseComponentValue();return dc(A)?A:Nn;case"length-percentage":var c=s.parseComponentValue();return Wa(c)?c:Nn;case"time":return bB.parse(e,s.parseComponentValue())}break}},KK="data-html2canvas-debug",HK=function(e){var t=e.getAttribute(KK);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Xx=function(e,t){var r=HK(e);return r===1||t===r},Eo=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Xx(r,3))debugger;this.styles=new QK(t,window.getComputedStyle(r,null)),e2(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Om(this.context,r),Xx(r,4)&&(this.flags|=16)}return e}(),GK="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Xw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Lp=0;Lp<Xw.length;Lp++)Xu[Xw.charCodeAt(Lp)]=Lp;var zK=function(e){var t=e.length*.75,r=e.length,a,n=0,s,o,A,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(l)?l:new Uint8Array(l);for(a=0;a<r;a+=4)s=Xu[e.charCodeAt(a)],o=Xu[e.charCodeAt(a+1)],A=Xu[e.charCodeAt(a+2)],c=Xu[e.charCodeAt(a+3)],d[n++]=s<<2|o>>4,d[n++]=(o&15)<<4|A>>2,d[n++]=(A&3)<<6|c&63;return l},VK=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},$K=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},tl=5,Iy=11,o1=2,YK=Iy-tl,CB=65536>>tl,WK=1<<tl,A1=WK-1,XK=1024>>tl,JK=CB+XK,ZK=JK,eH=32,tH=ZK+eH,rH=65536>>Iy,aH=1<<YK,nH=aH-1,Jw=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},iH=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},sH=function(e,t){var r=zK(e),a=Array.isArray(r)?$K(r):new Uint32Array(r),n=Array.isArray(r)?VK(r):new Uint16Array(r),s=24,o=Jw(n,s/2,a[4]/2),A=a[5]===2?Jw(n,(s+a[4])/2):iH(a,Math.ceil((s+a[4])/4));return new oH(a[0],a[1],a[2],a[3],o,A)},oH=function(){function e(t,r,a,n,s,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=s,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>tl],r=(r<<o1)+(t&A1),this.data[r];if(t<=65535)return r=this.index[CB+(t-55296>>tl)],r=(r<<o1)+(t&A1),this.data[r];if(t<this.highStart)return r=tH-rH+(t>>Iy),r=this.index[r],r+=t>>tl&nH,r=this.index[r],r=(r<<o1)+(t&A1),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),Zw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",AH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Up=0;Up<Zw.length;Up++)AH[Zw.charCodeAt(Up)]=Up;var cH=1,c1=2,l1=3,eE=4,tE=5,lH=7,rE=8,d1=9,u1=10,aE=11,nE=12,iE=13,sE=14,f1=15,dH=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((n&1023)<<10)+(s&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},uH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,s="";++n<r;){var o=e[n];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(n+1===r||a.length>16384)&&(s+=String.fromCharCode.apply(String,a),a.length=0)}return s},fH=sH(GK),ys="×",p1="÷",pH=function(e){return fH.get(e)},hH=function(e,t,r){var a=r-2,n=t[a],s=t[r-1],o=t[r];if(s===c1&&o===l1)return ys;if(s===c1||s===l1||s===eE||o===c1||o===l1||o===eE)return p1;if(s===rE&&[rE,d1,aE,nE].indexOf(o)!==-1||(s===aE||s===d1)&&(o===d1||o===u1)||(s===nE||s===u1)&&o===u1||o===iE||o===tE||o===lH||s===cH)return ys;if(s===iE&&o===sE){for(;n===tE;)n=t[--a];if(n===sE)return ys}if(s===f1&&o===f1){for(var A=0;n===f1;)A++,n=t[--a];if(A%2===0)return ys}return p1},mH=function(e){var t=dH(e),r=t.length,a=0,n=0,s=t.map(pH);return{next:function(){if(a>=r)return{done:!0,value:null};for(var o=ys;a<r&&(o=hH(t,s,++a))===ys;);if(o!==ys||a===r){var A=uH.apply(null,t.slice(n,a));return n=a,{value:A,done:!1}}return{done:!0,value:null}}}},gH=function(e){for(var t=mH(e),r=[],a;!(a=t.next()).done;)a.value&&r.push(a.value.slice());return r},xH=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var a=e.createElement("boundtest");a.style.height=t+"px",a.style.display="block",e.body.appendChild(a),r.selectNode(a);var n=r.getBoundingClientRect(),s=Math.round(n.height);if(e.body.removeChild(a),s===t)return!0}}return!1},yH=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=t.firstChild,n=Im(a.data).map(function(c){return ka(c)}),s=0,o={},A=n.every(function(c,l){r.setStart(a,s),r.setEnd(a,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,l===0?!0:f});return e.body.removeChild(t),A},vH=function(){return typeof new Image().crossOrigin<"u"},wH=function(){return typeof new XMLHttpRequest().responseType=="string"},EH=function(e){var t=new Image,r=e.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},oE=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},_H=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var a=t.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var n=new Image,s=t.toDataURL();n.src=s;var o=Jx(r,r,0,0,n);return a.fillStyle="red",a.fillRect(0,0,r,r),AE(o).then(function(A){a.drawImage(A,0,0);var c=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var l=e.createElement("div");return l.style.backgroundImage="url("+s+")",l.style.height=r+"px",oE(c)?AE(Jx(r,r,0,0,l)):Promise.reject(!1)}).then(function(A){return a.drawImage(A,0,0),oE(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Jx=function(e,t,r,a,n){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),A=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),A.setAttributeNS(null,"width","100%"),A.setAttributeNS(null,"height","100%"),A.setAttributeNS(null,"x",r.toString()),A.setAttributeNS(null,"y",a.toString()),A.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(A),A.appendChild(n),o},AE=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){return t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Cn={get SUPPORT_RANGE_BOUNDS(){var e=xH(document);return Object.defineProperty(Cn,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Cn.SUPPORT_RANGE_BOUNDS&&yH(document);return Object.defineProperty(Cn,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=EH(document);return Object.defineProperty(Cn,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?_H(document):Promise.resolve(!1);return Object.defineProperty(Cn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=vH();return Object.defineProperty(Cn,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=wH();return Object.defineProperty(Cn,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Cn,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Cn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},vf=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),bH=function(e,t,r,a){var n=SH(t,r),s=[],o=0;return n.forEach(function(A){if(r.textDecorationLine.length||A.trim().length>0)if(Cn.SUPPORT_RANGE_BOUNDS){var c=cE(a,o,A.length).getClientRects();if(c.length>1){var l=Ny(A),d=0;l.forEach(function(p){s.push(new vf(p,aA.fromDOMRectList(e,cE(a,d+o,p.length).getClientRects()))),d+=p.length})}else s.push(new vf(A,aA.fromDOMRectList(e,c)))}else{var f=a.splitText(A.length);s.push(new vf(A,CH(e,a))),a=f}else Cn.SUPPORT_RANGE_BOUNDS||(a=a.splitText(A.length));o+=A.length}),s},CH=function(e,t){var r=t.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(t.cloneNode(!0));var n=t.parentNode;if(n){n.replaceChild(a,t);var s=Om(e,a);return a.firstChild&&n.replaceChild(a.firstChild,a),s}}return aA.EMPTY},cE=function(e,t,r){var a=e.ownerDocument;if(!a)throw new Error("Node has no owner document");var n=a.createRange();return n.setStart(e,t),n.setEnd(e,t+r),n},Ny=function(e){if(Cn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return gH(e)},BH=function(e,t){if(Cn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(a){return a.segment})}return OH(e,t)},SH=function(e,t){return t.letterSpacing!==0?Ny(e):BH(e,t)},TH=[32,160,4961,65792,65793,4153,4241],OH=function(e,t){for(var r=rQ(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),a=[],n,s=function(){if(n.value){var o=n.value.slice(),A=Im(o),c="";A.forEach(function(l){TH.indexOf(l)===-1?c+=ka(l):(c.length&&a.push(c),a.push(ka(l)),c="")}),c.length&&a.push(c)}};!(n=r.next()).done;)s();return a},IH=function(){function e(t,r,a){this.text=NH(r.data,a.textTransform),this.textBounds=bH(t,this.text,a,r)}return e}(),NH=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(FH,RH);case 2:return e.toUpperCase();default:return e}},FH=/(^|\s|:|-|\(|\))([a-z])/g,RH=function(e,t,r){return e.length>0?t+r.toUpperCase():e},BB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.src=a.currentSrc||a.src,n.intrinsicWidth=a.naturalWidth,n.intrinsicHeight=a.naturalHeight,n.context.cache.addImage(n.src),n}return t}(Eo),SB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a,n.intrinsicWidth=a.width,n.intrinsicHeight=a.height,n}return t}(Eo),TB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this,s=new XMLSerializer,o=Om(r,a);return a.setAttribute("width",o.width+"px"),a.setAttribute("height",o.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(a)),n.intrinsicWidth=a.width.baseVal.value,n.intrinsicHeight=a.height.baseVal.value,n.context.cache.addImage(n.svg),n}return t}(Eo),OB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t}(Eo),Zx=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.start=a.start,n.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,n}return t}(Eo),kH=[{type:15,flags:0,unit:"px",number:3}],DH=[{type:16,flags:0,number:50}],jH=function(e){return e.width>e.height?new aA(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new aA(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},LH=function(e){var t=e.type===UH?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},zh="checkbox",Vh="radio",UH="password",lE=707406591,Fy=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;switch(n.type=a.type.toLowerCase(),n.checked=a.checked,n.value=LH(a),(n.type===zh||n.type===Vh)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=jH(n.bounds)),n.type){case zh:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=kH;break;case Vh:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=DH;break}return n}return t}(Eo),IB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this,s=a.options[a.selectedIndex||0];return n.value=s&&s.text||"",n}return t}(Eo),NB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t}(Eo),FB=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;n.src=a.src,n.width=parseInt(a.width,10)||0,n.height=parseInt(a.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){n.tree=kB(r,a.contentWindow.document.documentElement);var s=a.contentWindow.document.documentElement?xf(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):Jo.TRANSPARENT,o=a.contentWindow.document.body?xf(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):Jo.TRANSPARENT;n.backgroundColor=WA(s)?WA(o)?n.styles.backgroundColor:o:s}}catch{}return n}return t}(Eo),MH=["OL","UL","MENU"],lh=function(e,t,r,a){for(var n=t.firstChild,s=void 0;n;n=s)if(s=n.nextSibling,DB(n)&&n.data.trim().length>0)r.textNodes.push(new IH(e,n,r.styles));else if(Ed(n))if(MB(n)&&n.assignedNodes)n.assignedNodes().forEach(function(A){return lh(e,A,r,a)});else{var o=RB(e,n);o.styles.isVisible()&&(PH(n,o,a)?o.flags|=4:QH(o.styles)&&(o.flags|=2),MH.indexOf(n.tagName)!==-1&&(o.flags|=8),r.elements.push(o),n.slot,n.shadowRoot?lh(e,n.shadowRoot,o,a):!$h(n)&&!jB(n)&&!Yh(n)&&lh(e,n,o,a))}},RB=function(e,t){return t2(t)?new BB(e,t):LB(t)?new SB(e,t):jB(t)?new TB(e,t):qH(t)?new OB(e,t):KH(t)?new Zx(e,t):HH(t)?new Fy(e,t):Yh(t)?new IB(e,t):$h(t)?new NB(e,t):UB(t)?new FB(e,t):new Eo(e,t)},kB=function(e,t){var r=RB(e,t);return r.flags|=4,lh(e,t,r,r),r},PH=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||Ry(e)&&r.styles.isTransparent()},QH=function(e){return e.isPositioned()||e.isFloating()},DB=function(e){return e.nodeType===Node.TEXT_NODE},Ed=function(e){return e.nodeType===Node.ELEMENT_NODE},e2=function(e){return Ed(e)&&typeof e.style<"u"&&!dh(e)},dh=function(e){return typeof e.className=="object"},qH=function(e){return e.tagName==="LI"},KH=function(e){return e.tagName==="OL"},HH=function(e){return e.tagName==="INPUT"},GH=function(e){return e.tagName==="HTML"},jB=function(e){return e.tagName==="svg"},Ry=function(e){return e.tagName==="BODY"},LB=function(e){return e.tagName==="CANVAS"},dE=function(e){return e.tagName==="VIDEO"},t2=function(e){return e.tagName==="IMG"},UB=function(e){return e.tagName==="IFRAME"},uE=function(e){return e.tagName==="STYLE"},zH=function(e){return e.tagName==="SCRIPT"},$h=function(e){return e.tagName==="TEXTAREA"},Yh=function(e){return e.tagName==="SELECT"},MB=function(e){return e.tagName==="SLOT"},fE=function(e){return e.tagName.indexOf("-")>0},VH=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(a){return r.counters[a].pop()})},e.prototype.parse=function(t){var r=this,a=t.counterIncrement,n=t.counterReset,s=!0;a!==null&&a.forEach(function(A){var c=r.counters[A.counter];c&&A.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=A.increment)});var o=[];return s&&n.forEach(function(A){var c=r.counters[A.counter];o.push(A.counter),c||(c=r.counters[A.counter]=[]),c.push(A.reset)}),o},e}(),pE={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},hE={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},$H={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},YH={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},ed=function(e,t,r,a,n,s){return e<t||e>r?Xf(e,n,s.length>0):a.integers.reduce(function(o,A,c){for(;e>=A;)e-=A,o+=a.values[c];return o},"")+s},PB=function(e,t,r,a){var n="";do r||e--,n=a(e)+n,e/=t;while(e*t>=t);return n},Fa=function(e,t,r,a,n){var s=r-t+1;return(e<0?"-":"")+(PB(Math.abs(e),s,a,function(o){return ka(Math.floor(o%s)+t)})+n)},Tc=function(e,t,r){r===void 0&&(r=". ");var a=t.length;return PB(Math.abs(e),a,!1,function(n){return t[Math.floor(n%a)]})+r},md=1,NA=2,FA=4,Ju=8,Po=function(e,t,r,a,n,s){if(e<-9999||e>9999)return Xf(e,4,n.length>0);var o=Math.abs(e),A=n;if(o===0)return t[0]+A;for(var c=0;o>0&&c<=4;c++){var l=o%10;l===0&&sn(s,md)&&A!==""?A=t[l]+A:l>1||l===1&&c===0||l===1&&c===1&&sn(s,NA)||l===1&&c===1&&sn(s,FA)&&e>100||l===1&&c>1&&sn(s,Ju)?A=t[l]+(c>0?r[c-1]:"")+A:l===1&&c>0&&(A=r[c-1]+A),o=Math.floor(o/10)}return(e<0?a:"")+A},mE="十百千萬",gE="拾佰仟萬",xE="マイナス",h1="마이너스",Xf=function(e,t,r){var a=r?". ":"",n=r?"、":"",s=r?", ":"",o=r?" ":"";switch(t){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var A=Fa(e,48,57,!0,a);return A.length<4?"0"+A:A;case 4:return Tc(e,"〇一二三四五六七八九",n);case 6:return ed(e,1,3999,pE,3,a).toLowerCase();case 7:return ed(e,1,3999,pE,3,a);case 8:return Fa(e,945,969,!1,a);case 9:return Fa(e,97,122,!1,a);case 10:return Fa(e,65,90,!1,a);case 11:return Fa(e,1632,1641,!0,a);case 12:case 49:return ed(e,1,9999,hE,3,a);case 35:return ed(e,1,9999,hE,3,a).toLowerCase();case 13:return Fa(e,2534,2543,!0,a);case 14:case 30:return Fa(e,6112,6121,!0,a);case 15:return Tc(e,"子丑寅卯辰巳午未申酉戌亥",n);case 16:return Tc(e,"甲乙丙丁戊己庚辛壬癸",n);case 17:case 48:return Po(e,"零一二三四五六七八九",mE,"負",n,NA|FA|Ju);case 47:return Po(e,"零壹貳參肆伍陸柒捌玖",gE,"負",n,md|NA|FA|Ju);case 42:return Po(e,"零一二三四五六七八九",mE,"负",n,NA|FA|Ju);case 41:return Po(e,"零壹贰叁肆伍陆柒捌玖",gE,"负",n,md|NA|FA|Ju);case 26:return Po(e,"〇一二三四五六七八九","十百千万",xE,n,0);case 25:return Po(e,"零壱弐参四伍六七八九","拾百千万",xE,n,md|NA|FA);case 31:return Po(e,"영일이삼사오육칠팔구","십백천만",h1,s,md|NA|FA);case 33:return Po(e,"零一二三四五六七八九","十百千萬",h1,s,0);case 32:return Po(e,"零壹貳參四五六七八九","拾百千",h1,s,md|NA|FA);case 18:return Fa(e,2406,2415,!0,a);case 20:return ed(e,1,19999,YH,3,a);case 21:return Fa(e,2790,2799,!0,a);case 22:return Fa(e,2662,2671,!0,a);case 22:return ed(e,1,10999,$H,3,a);case 23:return Tc(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return Tc(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Fa(e,3302,3311,!0,a);case 28:return Tc(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",n);case 29:return Tc(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",n);case 34:return Fa(e,3792,3801,!0,a);case 37:return Fa(e,6160,6169,!0,a);case 38:return Fa(e,4160,4169,!0,a);case 39:return Fa(e,2918,2927,!0,a);case 40:return Fa(e,1776,1785,!0,a);case 43:return Fa(e,3046,3055,!0,a);case 44:return Fa(e,3174,3183,!0,a);case 45:return Fa(e,3664,3673,!0,a);case 46:return Fa(e,3872,3881,!0,a);case 3:default:return Fa(e,48,57,!0,a)}},QB="data-html2canvas-ignore",yE=function(){function e(t,r,a){if(this.context=t,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new VH,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var a=this,n=WH(t,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,A=n.contentWindow,c=A.document,l=ZH(n).then(function(){return ci(a,void 0,void 0,function(){var d,f;return Pn(this,function(p){switch(p.label){case 0:return this.scrolledElements.forEach(aG),A&&(A.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(A.scrollY!==r.top||A.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(A.scrollX-r.left,A.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:p.sent(),p.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,JH(c)]:[3,4];case 3:p.sent(),p.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return n})]:[2,n]}})})});return c.open(),c.write(tG(document.doctype)+"<html></html>"),rG(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),l},e.prototype.createElementClone=function(t){if(Xx(t,2))debugger;if(LB(t))return this.createCanvasClone(t);if(dE(t))return this.createVideoClone(t);if(uE(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return t2(r)&&(t2(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),fE(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return m1(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),n=t.cloneNode(!1);return n.textContent=a,n}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;var s=t.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var A=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(A){var c=A.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var n=t.ownerDocument.createElement("canvas");return n.width=t.offsetWidth,n.height=t.offsetHeight,n},e.prototype.appendChildNode=function(t,r,a){(!Ed(r)||!zH(r)&&!r.hasAttribute(QB)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Ed(r)||!uE(r))&&t.appendChild(this.cloneNode(r,a))},e.prototype.cloneChildNodes=function(t,r,a){for(var n=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(Ed(s)&&MB(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(A){return n.appendChildNode(r,A,a)})}else this.appendChildNode(r,s,a)},e.prototype.cloneNode=function(t,r){if(DB(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var a=t.ownerDocument.defaultView;if(a&&Ed(t)&&(e2(t)||dh(t))){var n=this.createElementClone(t);n.style.transitionProperty="none";var s=a.getComputedStyle(t),o=a.getComputedStyle(t,":before"),A=a.getComputedStyle(t,":after");this.referenceElement===t&&e2(n)&&(this.clonedReferenceElement=n),Ry(n)&&sG(n);var c=this.counters.parse(new Ww(this.context,s)),l=this.resolvePseudoContent(t,n,o,wf.BEFORE);fE(t)&&(r=!0),dE(t)||this.cloneChildNodes(t,n,r),l&&n.insertBefore(l,n.firstChild);var d=this.resolvePseudoContent(t,n,A,wf.AFTER);return d&&n.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||dh(t))&&!UB(t)||r)&&m1(s,n),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([n,t.scrollLeft,t.scrollTop]),($h(t)||Yh(t))&&($h(n)||Yh(n))&&(n.value=t.value),n}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,a,n){var s=this;if(a){var o=a.content,A=r.ownerDocument;if(!(!A||!o||o==="none"||o==="-moz-alt-content"||a.display==="none")){this.counters.parse(new Ww(this.context,a));var c=new qK(this.context,a),l=A.createElement("html2canvaspseudoelement");m1(a,l),c.content.forEach(function(f){if(f.type===0)l.appendChild(A.createTextNode(f.value));else if(f.type===22){var p=A.createElement("img");p.src=f.value,p.style.opacity="1",l.appendChild(p)}else if(f.type===18){if(f.name==="attr"){var u=f.values.filter(Kr);u.length&&l.appendChild(A.createTextNode(t.getAttribute(u[0].value)||""))}else if(f.name==="counter"){var g=f.values.filter(Kd),h=g[0],y=g[1];if(h&&Kr(h)){var x=s.counters.getCounterValue(h.value),v=y&&Kr(y)?Wx.parse(s.context,y.value):3;l.appendChild(A.createTextNode(Xf(x,v,!1)))}}else if(f.name==="counters"){var E=f.values.filter(Kd),h=E[0],D=E[1],y=E[2];if(h&&Kr(h)){var B=s.counters.getCounterValues(h.value),I=y&&Kr(y)?Wx.parse(s.context,y.value):3,_=D&&D.type===0?D.value:"",S=B.map(function(T){return Xf(T,I,!1)}).join(_);l.appendChild(A.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":l.appendChild(A.createTextNode(Yw(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":l.appendChild(A.createTextNode(Yw(c.quotes,--s.quoteDepth,!1)));break;default:l.appendChild(A.createTextNode(f.value))}}),l.className=r2+" "+a2;var d=n===wf.BEFORE?" "+r2:" "+a2;return dh(r)?r.className.baseValue+=d:r.className+=d,l}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),wf;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(wf||(wf={}));var WH=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(QB,"true"),e.body.appendChild(r),r},XH=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},JH=function(e){return Promise.all([].slice.call(e.images,0).map(XH))},ZH=function(e){return new Promise(function(t,r){var a=e.contentWindow;if(!a)return r("No window assigned for iframe");var n=a.document;a.onload=e.onload=function(){a.onload=e.onload=null;var s=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},eG=["all","d","content"],m1=function(e,t){for(var r=e.length-1;r>=0;r--){var a=e.item(r);eG.indexOf(a)===-1&&t.style.setProperty(a,e.getPropertyValue(a))}return t},tG=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},rG=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},aG=function(e){var t=e[0],r=e[1],a=e[2];t.scrollLeft=r,t.scrollTop=a},nG=":before",iG=":after",r2="___html2canvas___pseudoelement_before",a2="___html2canvas___pseudoelement_after",vE=`{
    content: "" !important;
    display: none !important;
}`,sG=function(e){oG(e,"."+r2+nG+vE+`
         .`+a2+iG+vE)},oG=function(e,t){var r=e.ownerDocument;if(r){var a=r.createElement("style");a.textContent=t,e.appendChild(a)}},qB=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),AG=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(x1(t)||uG(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ci(this,void 0,void 0,function(){var r,a,n,s,o=this;return Pn(this,function(A){switch(A.label){case 0:return r=qB.isSameOrigin(t),a=!g1(t)&&this._options.useCORS===!0&&Cn.SUPPORT_CORS_IMAGES&&!r,n=!g1(t)&&!r&&!x1(t)&&typeof this._options.proxy=="string"&&Cn.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!g1(t)&&!x1(t)&&!n&&!a?[2]:(s=t,n?[4,this.proxy(s)]:[3,2]);case 1:s=A.sent(),A.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,l){var d=new Image;d.onload=function(){return c(d)},d.onerror=l,(fG(s)||a)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return l("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,A.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var n=t.substring(0,256);return new Promise(function(s,o){var A=Cn.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(A==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(p){return o(p)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+n+" with status code "+c.status)},c.onerror=o;var l=a.indexOf("?")>-1?"&":"?";if(c.open("GET",""+a+l+"url="+encodeURIComponent(t)+"&responseType="+A),A!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=A),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+n)}}c.send()})},e}(),cG=/^data:image\/svg\+xml/i,lG=/^data:image\/.*;base64,/i,dG=/^data:image\/.*/i,uG=function(e){return Cn.SUPPORT_SVG_DRAWING||!pG(e)},g1=function(e){return dG.test(e)},fG=function(e){return lG.test(e)},x1=function(e){return e.substr(0,4)==="blob"},pG=function(e){return e.substr(-3).toLowerCase()==="svg"||cG.test(e)},St=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),td=function(e,t,r){return new St(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Mp=function(){function e(t,r,a,n){this.type=1,this.start=t,this.startControl=r,this.endControl=a,this.end=n}return e.prototype.subdivide=function(t,r){var a=td(this.start,this.startControl,t),n=td(this.startControl,this.endControl,t),s=td(this.endControl,this.end,t),o=td(a,n,t),A=td(n,s,t),c=td(o,A,t);return r?new e(this.start,a,o,c):new e(c,A,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),ws=function(e){return e.type===1},hG=function(){function e(t){var r=t.styles,a=t.bounds,n=Wu(r.borderTopLeftRadius,a.width,a.height),s=n[0],o=n[1],A=Wu(r.borderTopRightRadius,a.width,a.height),c=A[0],l=A[1],d=Wu(r.borderBottomRightRadius,a.width,a.height),f=d[0],p=d[1],u=Wu(r.borderBottomLeftRadius,a.width,a.height),g=u[0],h=u[1],y=[];y.push((s+c)/a.width),y.push((g+f)/a.width),y.push((o+h)/a.height),y.push((l+p)/a.height);var x=Math.max.apply(Math,y);x>1&&(s/=x,o/=x,c/=x,l/=x,f/=x,p/=x,g/=x,h/=x);var v=a.width-c,E=a.height-p,D=a.width-f,B=a.height-h,I=r.borderTopWidth,_=r.borderRightWidth,S=r.borderBottomWidth,O=r.borderLeftWidth,M=aa(r.paddingTop,t.bounds.width),T=aa(r.paddingRight,t.bounds.width),R=aa(r.paddingBottom,t.bounds.width),L=aa(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?la(a.left+O/3,a.top+I/3,s-O/3,o-I/3,Fr.TOP_LEFT):new St(a.left+O/3,a.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?la(a.left+v,a.top+I/3,c-_/3,l-I/3,Fr.TOP_RIGHT):new St(a.left+a.width-_/3,a.top+I/3),this.bottomRightBorderDoubleOuterBox=f>0||p>0?la(a.left+D,a.top+E,f-_/3,p-S/3,Fr.BOTTOM_RIGHT):new St(a.left+a.width-_/3,a.top+a.height-S/3),this.bottomLeftBorderDoubleOuterBox=g>0||h>0?la(a.left+O/3,a.top+B,g-O/3,h-S/3,Fr.BOTTOM_LEFT):new St(a.left+O/3,a.top+a.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?la(a.left+O*2/3,a.top+I*2/3,s-O*2/3,o-I*2/3,Fr.TOP_LEFT):new St(a.left+O*2/3,a.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?la(a.left+v,a.top+I*2/3,c-_*2/3,l-I*2/3,Fr.TOP_RIGHT):new St(a.left+a.width-_*2/3,a.top+I*2/3),this.bottomRightBorderDoubleInnerBox=f>0||p>0?la(a.left+D,a.top+E,f-_*2/3,p-S*2/3,Fr.BOTTOM_RIGHT):new St(a.left+a.width-_*2/3,a.top+a.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=g>0||h>0?la(a.left+O*2/3,a.top+B,g-O*2/3,h-S*2/3,Fr.BOTTOM_LEFT):new St(a.left+O*2/3,a.top+a.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?la(a.left+O/2,a.top+I/2,s-O/2,o-I/2,Fr.TOP_LEFT):new St(a.left+O/2,a.top+I/2),this.topRightBorderStroke=s>0||o>0?la(a.left+v,a.top+I/2,c-_/2,l-I/2,Fr.TOP_RIGHT):new St(a.left+a.width-_/2,a.top+I/2),this.bottomRightBorderStroke=f>0||p>0?la(a.left+D,a.top+E,f-_/2,p-S/2,Fr.BOTTOM_RIGHT):new St(a.left+a.width-_/2,a.top+a.height-S/2),this.bottomLeftBorderStroke=g>0||h>0?la(a.left+O/2,a.top+B,g-O/2,h-S/2,Fr.BOTTOM_LEFT):new St(a.left+O/2,a.top+a.height-S/2),this.topLeftBorderBox=s>0||o>0?la(a.left,a.top,s,o,Fr.TOP_LEFT):new St(a.left,a.top),this.topRightBorderBox=c>0||l>0?la(a.left+v,a.top,c,l,Fr.TOP_RIGHT):new St(a.left+a.width,a.top),this.bottomRightBorderBox=f>0||p>0?la(a.left+D,a.top+E,f,p,Fr.BOTTOM_RIGHT):new St(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=g>0||h>0?la(a.left,a.top+B,g,h,Fr.BOTTOM_LEFT):new St(a.left,a.top+a.height),this.topLeftPaddingBox=s>0||o>0?la(a.left+O,a.top+I,Math.max(0,s-O),Math.max(0,o-I),Fr.TOP_LEFT):new St(a.left+O,a.top+I),this.topRightPaddingBox=c>0||l>0?la(a.left+Math.min(v,a.width-_),a.top+I,v>a.width+_?0:Math.max(0,c-_),Math.max(0,l-I),Fr.TOP_RIGHT):new St(a.left+a.width-_,a.top+I),this.bottomRightPaddingBox=f>0||p>0?la(a.left+Math.min(D,a.width-O),a.top+Math.min(E,a.height-S),Math.max(0,f-_),Math.max(0,p-S),Fr.BOTTOM_RIGHT):new St(a.left+a.width-_,a.top+a.height-S),this.bottomLeftPaddingBox=g>0||h>0?la(a.left+O,a.top+Math.min(B,a.height-S),Math.max(0,g-O),Math.max(0,h-S),Fr.BOTTOM_LEFT):new St(a.left+O,a.top+a.height-S),this.topLeftContentBox=s>0||o>0?la(a.left+O+L,a.top+I+M,Math.max(0,s-(O+L)),Math.max(0,o-(I+M)),Fr.TOP_LEFT):new St(a.left+O+L,a.top+I+M),this.topRightContentBox=c>0||l>0?la(a.left+Math.min(v,a.width+O+L),a.top+I+M,v>a.width+O+L?0:c-O+L,l-(I+M),Fr.TOP_RIGHT):new St(a.left+a.width-(_+T),a.top+I+M),this.bottomRightContentBox=f>0||p>0?la(a.left+Math.min(D,a.width-(O+L)),a.top+Math.min(E,a.height+I+M),Math.max(0,f-(_+T)),p-(S+R),Fr.BOTTOM_RIGHT):new St(a.left+a.width-(_+T),a.top+a.height-(S+R)),this.bottomLeftContentBox=g>0||h>0?la(a.left+O+L,a.top+B,Math.max(0,g-(O+L)),h-(S+R),Fr.BOTTOM_LEFT):new St(a.left+O+L,a.top+a.height-(S+R))}return e}(),Fr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Fr||(Fr={}));var la=function(e,t,r,a,n){var s=4*((Math.sqrt(2)-1)/3),o=r*s,A=a*s,c=e+r,l=t+a;switch(n){case Fr.TOP_LEFT:return new Mp(new St(e,l),new St(e,l-A),new St(c-o,t),new St(c,t));case Fr.TOP_RIGHT:return new Mp(new St(e,t),new St(e+o,t),new St(c,l-A),new St(c,l));case Fr.BOTTOM_RIGHT:return new Mp(new St(c,t),new St(c,t+A),new St(e+o,l),new St(e,l));case Fr.BOTTOM_LEFT:default:return new Mp(new St(c,l),new St(c-o,l),new St(e,t+A),new St(e,t))}},Wh=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},mG=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Xh=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},gG=function(){function e(t,r,a){this.offsetX=t,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return e}(),Pp=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),xG=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),yG=function(e){return e.type===0},KB=function(e){return e.type===1},vG=function(e){return e.type===2},wE=function(e,t){return e.length===t.length?e.some(function(r,a){return r===t[a]}):!1},wG=function(e,t,r,a,n){return e.map(function(s,o){switch(o){case 0:return s.add(t,r);case 1:return s.add(t+a,r);case 2:return s.add(t+a,r+n);case 3:return s.add(t,r+n)}return s})},HB=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),GB=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new hG(this.container),this.container.styles.opacity<1&&this.effects.push(new xG(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new gG(a,n,s))}if(this.container.styles.overflowX!==0){var o=Wh(this.curves),A=Xh(this.curves);wE(o,A)?this.effects.push(new Pp(o,6)):(this.effects.push(new Pp(o,2)),this.effects.push(new Pp(A,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,n=this.effects.slice(0);a;){var s=a.effects.filter(function(c){return!KB(c)});if(r||a.container.styles.position!==0||!a.parent){if(n.unshift.apply(n,s),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var o=Wh(a.curves),A=Xh(a.curves);wE(o,A)||n.unshift(new Pp(A,6))}}else n.unshift.apply(n,s);a=a.parent}return n.filter(function(c){return sn(c.target,t)})},e}(),n2=function(e,t,r,a){e.container.elements.forEach(function(n){var s=sn(n.flags,4),o=sn(n.flags,2),A=new GB(n,e);sn(n.styles.display,2048)&&a.push(A);var c=sn(n.flags,8)?[]:a;if(s||o){var l=s||n.styles.isPositioned()?r:t,d=new HB(A);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var f=n.styles.zIndex.order;if(f<0){var p=0;l.negativeZIndex.some(function(g,h){return f>g.element.container.styles.zIndex.order?(p=h,!1):p>0}),l.negativeZIndex.splice(p,0,d)}else if(f>0){var u=0;l.positiveZIndex.some(function(g,h){return f>=g.element.container.styles.zIndex.order?(u=h+1,!1):u>0}),l.positiveZIndex.splice(u,0,d)}else l.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else n.styles.isFloating()?l.nonPositionedFloats.push(d):l.nonPositionedInlineLevel.push(d);n2(A,d,s?d:r,c)}else n.styles.isInlineLevel()?t.inlineLevel.push(A):t.nonInlineLevel.push(A),n2(A,t,r,c);sn(n.flags,8)&&zB(n,c)})},zB=function(e,t){for(var r=e instanceof Zx?e.start:1,a=e instanceof Zx?e.reversed:!1,n=0;n<t.length;n++){var s=t[n];s.container instanceof OB&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=Xf(r,s.container.styles.listStyleType,!0),r+=a?-1:1}},EG=function(e){var t=new GB(e,null),r=new HB(t),a=[];return n2(t,r,r,a),zB(t.container,a),r},EE=function(e,t){switch(t){case 0:return bs(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return bs(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return bs(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return bs(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},_G=function(e,t){switch(t){case 0:return bs(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return bs(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return bs(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return bs(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},bG=function(e,t){switch(t){case 0:return bs(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return bs(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return bs(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return bs(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},CG=function(e,t){switch(t){case 0:return Qp(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Qp(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Qp(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Qp(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Qp=function(e,t){var r=[];return ws(e)?r.push(e.subdivide(.5,!1)):r.push(e),ws(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},bs=function(e,t,r,a){var n=[];return ws(e)?n.push(e.subdivide(.5,!1)):n.push(e),ws(r)?n.push(r.subdivide(.5,!0)):n.push(r),ws(a)?n.push(a.subdivide(.5,!0).reverse()):n.push(a),ws(t)?n.push(t.subdivide(.5,!1).reverse()):n.push(t),n},VB=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Jh=function(e){var t=e.styles,r=e.bounds,a=aa(t.paddingLeft,r.width),n=aa(t.paddingRight,r.width),s=aa(t.paddingTop,r.width),o=aa(t.paddingBottom,r.width);return r.add(a+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+a+n),-(t.borderTopWidth+t.borderBottomWidth+s+o))},BG=function(e,t){return e===0?t.bounds:e===2?Jh(t):VB(t)},SG=function(e,t){return e===0?t.bounds:e===2?Jh(t):VB(t)},y1=function(e,t,r){var a=BG(gd(e.styles.backgroundOrigin,t),e),n=SG(gd(e.styles.backgroundClip,t),e),s=TG(gd(e.styles.backgroundSize,t),r,a),o=s[0],A=s[1],c=Wu(gd(e.styles.backgroundPosition,t),a.width-o,a.height-A),l=OG(gd(e.styles.backgroundRepeat,t),c,s,a,n),d=Math.round(a.left+c[0]),f=Math.round(a.top+c[1]);return[l,d,f,o,A]},rd=function(e){return Kr(e)&&e.value===kd.AUTO},qp=function(e){return typeof e=="number"},TG=function(e,t,r){var a=t[0],n=t[1],s=t[2],o=e[0],A=e[1];if(!o)return[0,0];if(Wa(o)&&A&&Wa(A))return[aa(o,r.width),aa(A,r.height)];var c=qp(s);if(Kr(o)&&(o.value===kd.CONTAIN||o.value===kd.COVER)){if(qp(s)){var l=r.width/r.height;return l<s!=(o.value===kd.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=qp(a),f=qp(n),p=d||f;if(rd(o)&&(!A||rd(A))){if(d&&f)return[a,n];if(!c&&!p)return[r.width,r.height];if(p&&c){var u=d?a:n*s,g=f?n:a/s;return[u,g]}var h=d?a:r.width,y=f?n:r.height;return[h,y]}if(c){var x=0,v=0;return Wa(o)?x=aa(o,r.width):Wa(A)&&(v=aa(A,r.height)),rd(o)?x=v*s:(!A||rd(A))&&(v=x/s),[x,v]}var E=null,D=null;if(Wa(o)?E=aa(o,r.width):A&&Wa(A)&&(D=aa(A,r.height)),E!==null&&(!A||rd(A))&&(D=d&&f?E/a*n:r.height),D!==null&&rd(o)&&(E=d&&f?D/n*a:r.width),E!==null&&D!==null)return[E,D];throw new Error("Unable to calculate background-size for element")},gd=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},OG=function(e,t,r,a,n){var s=t[0],o=t[1],A=r[0],c=r[1];switch(e){case 2:return[new St(Math.round(a.left),Math.round(a.top+o)),new St(Math.round(a.left+a.width),Math.round(a.top+o)),new St(Math.round(a.left+a.width),Math.round(c+a.top+o)),new St(Math.round(a.left),Math.round(c+a.top+o))];case 3:return[new St(Math.round(a.left+s),Math.round(a.top)),new St(Math.round(a.left+s+A),Math.round(a.top)),new St(Math.round(a.left+s+A),Math.round(a.height+a.top)),new St(Math.round(a.left+s),Math.round(a.height+a.top))];case 1:return[new St(Math.round(a.left+s),Math.round(a.top+o)),new St(Math.round(a.left+s+A),Math.round(a.top+o)),new St(Math.round(a.left+s+A),Math.round(a.top+o+c)),new St(Math.round(a.left+s),Math.round(a.top+o+c))];default:return[new St(Math.round(n.left),Math.round(n.top)),new St(Math.round(n.left+n.width),Math.round(n.top)),new St(Math.round(n.left+n.width),Math.round(n.height+n.top)),new St(Math.round(n.left),Math.round(n.height+n.top))]}},IG="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",_E="Hidden Text",NG=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var a=this._document.createElement("div"),n=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",o.appendChild(a),n.src=IG,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(_E)),a.appendChild(s),a.appendChild(n);var A=n.offsetTop-s.offsetTop+2;a.removeChild(s),a.appendChild(this._document.createTextNode(_E)),a.style.lineHeight="normal",n.style.verticalAlign="super";var c=n.offsetTop-a.offsetTop+2;return o.removeChild(a),{baseline:A,middle:c}},e.prototype.getMetrics=function(t,r){var a=t+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(t,r)),this._data[a]},e}(),$B=function(){function e(t,r){this.context=t,this.options=r}return e}(),FG=1e4,RG=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n._activeEffects=[],n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),a.canvas||(n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px"),n.fontMetrics=new NG(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),n}return t.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return a.applyEffect(n)})},t.prototype.applyEffect=function(r){this.ctx.save(),vG(r)&&(this.ctx.globalAlpha=r.opacity),yG(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),KB(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ci(this,void 0,void 0,function(){var a;return Pn(this,function(n){switch(n.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ci(this,void 0,void 0,function(){return Pn(this,function(a){switch(a.label){case 0:if(sn(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,a,n){var s=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var o=Ny(r.text);o.reduce(function(A,c){return s.ctx.fillText(c,A,r.bounds.top+n),A+s.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),n=UG(r.fontFamily).join(", "),s=p0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,s,n].join(" "),n,s]},t.prototype.renderTextNode=function(r,a){return ci(this,void 0,void 0,function(){var n,s,o,A,c,l,d,f,p=this;return Pn(this,function(u){return n=this.createFontStyle(a),s=n[0],o=n[1],A=n[2],this.ctx.font=s,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,A),l=c.baseline,d=c.middle,f=a.paintOrder,r.textBounds.forEach(function(g){f.forEach(function(h){switch(h){case 0:p.ctx.fillStyle=pn(a.color),p.renderTextWithLetterSpacing(g,a.letterSpacing,l);var y=a.textShadow;y.length&&g.text.trim().length&&(y.slice(0).reverse().forEach(function(x){p.ctx.shadowColor=pn(x.color),p.ctx.shadowOffsetX=x.offsetX.number*p.options.scale,p.ctx.shadowOffsetY=x.offsetY.number*p.options.scale,p.ctx.shadowBlur=x.blur.number,p.renderTextWithLetterSpacing(g,a.letterSpacing,l)}),p.ctx.shadowColor="",p.ctx.shadowOffsetX=0,p.ctx.shadowOffsetY=0,p.ctx.shadowBlur=0),a.textDecorationLine.length&&(p.ctx.fillStyle=pn(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(x){switch(x){case 1:p.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top+l),g.bounds.width,1);break;case 2:p.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top),g.bounds.width,1);break;case 3:p.ctx.fillRect(g.bounds.left,Math.ceil(g.bounds.top+d),g.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&g.text.trim().length&&(p.ctx.strokeStyle=pn(a.webkitTextStrokeColor),p.ctx.lineWidth=a.webkitTextStrokeWidth,p.ctx.lineJoin=window.chrome?"miter":"round",p.ctx.strokeText(g.text,g.bounds.left,g.bounds.top+l)),p.ctx.strokeStyle="",p.ctx.lineWidth=0,p.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,a,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=Jh(r),o=Xh(a);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ci(this,void 0,void 0,function(){var a,n,s,o,A,c,v,v,l,d,f,p,D,u,g,B,h,y,x,v,E,D,B;return Pn(this,function(I){switch(I.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,n=r.curves,s=a.styles,o=0,A=a.textNodes,I.label=1;case 1:return o<A.length?(c=A[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(a instanceof BB))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return v=I.sent(),this.renderReplacedElement(a,n,v),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof SB&&this.renderReplacedElement(a,n,a.canvas),!(a instanceof TB))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return v=I.sent(),this.renderReplacedElement(a,n,v),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof FB&&a.tree?(l=new t(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,l.render(a.tree)]):[3,14];case 13:d=I.sent(),a.width&&a.height&&this.ctx.drawImage(d,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),I.label=14;case 14:if(a instanceof Fy&&(f=Math.min(a.bounds.width,a.bounds.height),a.type===zh?a.checked&&(this.ctx.save(),this.path([new St(a.bounds.left+f*.39363,a.bounds.top+f*.79),new St(a.bounds.left+f*.16,a.bounds.top+f*.5549),new St(a.bounds.left+f*.27347,a.bounds.top+f*.44071),new St(a.bounds.left+f*.39694,a.bounds.top+f*.5649),new St(a.bounds.left+f*.72983,a.bounds.top+f*.23),new St(a.bounds.left+f*.84,a.bounds.top+f*.34085),new St(a.bounds.left+f*.39363,a.bounds.top+f*.79)]),this.ctx.fillStyle=pn(lE),this.ctx.fill(),this.ctx.restore()):a.type===Vh&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+f/2,a.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=pn(lE),this.ctx.fill(),this.ctx.restore())),kG(a)&&a.value.length){switch(p=this.createFontStyle(s),D=p[0],u=p[1],g=this.fontMetrics.getMetrics(D,u).baseline,this.ctx.font=D,this.ctx.fillStyle=pn(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=jG(a.styles.textAlign),B=Jh(a),h=0,a.styles.textAlign){case 1:h+=B.width/2;break;case 2:h+=B.width;break}y=B.add(h,0,0,-B.height/2+1),this.ctx.save(),this.path([new St(B.left,B.top),new St(B.left+B.width,B.top),new St(B.left+B.width,B.top+B.height),new St(B.left,B.top+B.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new vf(a.value,y),s.letterSpacing,g),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!sn(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(x=a.styles.listStyleImage,x.type!==0)return[3,18];v=void 0,E=x.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(E)];case 16:return v=I.sent(),this.ctx.drawImage(v,a.bounds.left-(v.width+10),a.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+E),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(D=this.createFontStyle(s)[0],this.ctx.font=D,this.ctx.fillStyle=pn(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",B=new aA(a.bounds.left,a.bounds.top+aa(a.styles.paddingTop,a.bounds.width),a.bounds.width,Vw(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new vf(r.listValue,B),s.letterSpacing,Vw(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ci(this,void 0,void 0,function(){var a,n,x,s,o,x,A,c,x,l,d,x,f,p,x,u,g,x,h,y,x;return Pn(this,function(v){switch(v.label){case 0:if(sn(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:v.sent(),a=0,n=r.negativeZIndex,v.label=2;case 2:return a<n.length?(x=n[a],[4,this.renderStack(x)]):[3,5];case 3:v.sent(),v.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:v.sent(),s=0,o=r.nonInlineLevel,v.label=7;case 7:return s<o.length?(x=o[s],[4,this.renderNode(x)]):[3,10];case 8:v.sent(),v.label=9;case 9:return s++,[3,7];case 10:A=0,c=r.nonPositionedFloats,v.label=11;case 11:return A<c.length?(x=c[A],[4,this.renderStack(x)]):[3,14];case 12:v.sent(),v.label=13;case 13:return A++,[3,11];case 14:l=0,d=r.nonPositionedInlineLevel,v.label=15;case 15:return l<d.length?(x=d[l],[4,this.renderStack(x)]):[3,18];case 16:v.sent(),v.label=17;case 17:return l++,[3,15];case 18:f=0,p=r.inlineLevel,v.label=19;case 19:return f<p.length?(x=p[f],[4,this.renderNode(x)]):[3,22];case 20:v.sent(),v.label=21;case 21:return f++,[3,19];case 22:u=0,g=r.zeroOrAutoZIndexOrTransformedOrOpacity,v.label=23;case 23:return u<g.length?(x=g[u],[4,this.renderStack(x)]):[3,26];case 24:v.sent(),v.label=25;case 25:return u++,[3,23];case 26:h=0,y=r.positiveZIndex,v.label=27;case 27:return h<y.length?(x=y[h],[4,this.renderStack(x)]):[3,30];case 28:v.sent(),v.label=29;case 29:return h++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var a=this;r.forEach(function(n,s){var o=ws(n)?n.start:n;s===0?a.ctx.moveTo(o.x,o.y):a.ctx.lineTo(o.x,o.y),ws(n)&&a.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},t.prototype.renderRepeat=function(r,a,n,s){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(n,s),this.ctx.fill(),this.ctx.translate(-n,-s)},t.prototype.resizeImage=function(r,a,n){var s;if(r.width===a&&r.height===n)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,A=o.createElement("canvas");A.width=Math.max(1,a),A.height=Math.max(1,n);var c=A.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,a,n),A},t.prototype.renderBackgroundImage=function(r){return ci(this,void 0,void 0,function(){var a,n,s,o,A,c;return Pn(this,function(l){switch(l.label){case 0:a=r.styles.backgroundImage.length-1,n=function(d){var f,p,u,M,U,V,L,N,S,g,M,U,V,L,N,h,y,x,v,E,D,B,I,_,S,O,M,T,R,L,N,P,U,V,ie,W,z,G,b,k,j,q;return Pn(this,function(Y){switch(Y.label){case 0:if(d.type!==0)return[3,5];f=void 0,p=d.url,Y.label=1;case 1:return Y.trys.push([1,3,,4]),[4,s.context.cache.match(p)];case 2:return f=Y.sent(),[3,4];case 3:return Y.sent(),s.context.logger.error("Error loading background-image "+p),[3,4];case 4:return f&&(u=y1(r,a,[f.width,f.height,f.width/f.height]),M=u[0],U=u[1],V=u[2],L=u[3],N=u[4],S=s.ctx.createPattern(s.resizeImage(f,L,N),"repeat"),s.renderRepeat(M,S,U,V)),[3,6];case 5:yq(d)?(g=y1(r,a,[null,null,null]),M=g[0],U=g[1],V=g[2],L=g[3],N=g[4],h=pq(d.angle,L,N),y=h[0],x=h[1],v=h[2],E=h[3],D=h[4],B=document.createElement("canvas"),B.width=L,B.height=N,I=B.getContext("2d"),_=I.createLinearGradient(x,E,v,D),Gw(d.stops,y).forEach(function(de){return _.addColorStop(de.stop,pn(de.color))}),I.fillStyle=_,I.fillRect(0,0,L,N),L>0&&N>0&&(S=s.ctx.createPattern(B,"repeat"),s.renderRepeat(M,S,U,V))):vq(d)&&(O=y1(r,a,[null,null,null]),M=O[0],T=O[1],R=O[2],L=O[3],N=O[4],P=d.position.length===0?[Ty]:d.position,U=aa(P[0],L),V=aa(P[P.length-1],N),ie=hq(d,U,V,L,N),W=ie[0],z=ie[1],W>0&&z>0&&(G=s.ctx.createRadialGradient(T+U,R+V,0,T+U,R+V,W),Gw(d.stops,W*2).forEach(function(de){return G.addColorStop(de.stop,pn(de.color))}),s.path(M),s.ctx.fillStyle=G,W!==z?(b=r.bounds.left+.5*r.bounds.width,k=r.bounds.top+.5*r.bounds.height,j=z/W,q=1/j,s.ctx.save(),s.ctx.translate(b,k),s.ctx.transform(1,0,0,j,0,0),s.ctx.translate(-b,-k),s.ctx.fillRect(T,q*(R-k)+k,L,N*q),s.ctx.restore()):s.ctx.fill())),Y.label=6;case 6:return a--,[2]}})},s=this,o=0,A=r.styles.backgroundImage.slice(0).reverse(),l.label=1;case 1:return o<A.length?(c=A[o],[5,n(c)]):[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,a,n){return ci(this,void 0,void 0,function(){return Pn(this,function(s){return this.path(EE(n,a)),this.ctx.fillStyle=pn(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,a,n,s){return ci(this,void 0,void 0,function(){var o,A;return Pn(this,function(c){switch(c.label){case 0:return a<3?[4,this.renderSolidBorder(r,n,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=_G(s,n),this.path(o),this.ctx.fillStyle=pn(r),this.ctx.fill(),A=bG(s,n),this.path(A),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ci(this,void 0,void 0,function(){var a,n,s,o,A,c,l,d,f=this;return Pn(this,function(p){switch(p.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,n=!WA(a.backgroundColor)||a.backgroundImage.length,s=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],o=DG(gd(a.backgroundClip,0),r.curves),n||a.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),WA(a.backgroundColor)||(this.ctx.fillStyle=pn(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:p.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(u){f.ctx.save();var g=Wh(r.curves),h=u.inset?0:FG,y=wG(g,-h+(u.inset?1:-1)*u.spread.number,(u.inset?1:-1)*u.spread.number,u.spread.number*(u.inset?-2:2),u.spread.number*(u.inset?-2:2));u.inset?(f.path(g),f.ctx.clip(),f.mask(y)):(f.mask(g),f.ctx.clip(),f.path(y)),f.ctx.shadowOffsetX=u.offsetX.number+h,f.ctx.shadowOffsetY=u.offsetY.number,f.ctx.shadowColor=pn(u.color),f.ctx.shadowBlur=u.blur.number,f.ctx.fillStyle=u.inset?pn(u.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),p.label=2;case 2:A=0,c=0,l=s,p.label=3;case 3:return c<l.length?(d=l[c],d.style!==0&&!WA(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,A,r.curves,2)]:[3,11]):[3,13];case 4:return p.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,A,r.curves,3)];case 6:return p.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,A,r.curves)];case 8:return p.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,A,r.curves)];case 10:p.sent(),p.label=11;case 11:A++,p.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,a,n,s,o){return ci(this,void 0,void 0,function(){var A,c,l,d,f,p,u,g,h,y,x,v,E,D,B,I,B,I;return Pn(this,function(_){return this.ctx.save(),A=CG(s,n),c=EE(s,n),o===2&&(this.path(c),this.ctx.clip()),ws(c[0])?(l=c[0].start.x,d=c[0].start.y):(l=c[0].x,d=c[0].y),ws(c[1])?(f=c[1].end.x,p=c[1].end.y):(f=c[1].x,p=c[1].y),n===0||n===2?u=Math.abs(l-f):u=Math.abs(d-p),this.ctx.beginPath(),o===3?this.formatPath(A):this.formatPath(c.slice(0,2)),g=a<3?a*3:a*2,h=a<3?a*2:a,o===3&&(g=a,h=a),y=!0,u<=g*2?y=!1:u<=g*2+h?(x=u/(2*g+h),g*=x,h*=x):(v=Math.floor((u+h)/(g+h)),E=(u-v*g)/(v-1),D=(u-(v+1)*g)/v,h=D<=0||Math.abs(h-E)<Math.abs(h-D)?E:D),y&&(o===3?this.ctx.setLineDash([0,g+h]):this.ctx.setLineDash([g,h])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=pn(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(ws(c[0])&&(B=c[3],I=c[0],this.ctx.beginPath(),this.formatPath([new St(B.end.x,B.end.y),new St(I.start.x,I.start.y)]),this.ctx.stroke()),ws(c[1])&&(B=c[1],I=c[2],this.ctx.beginPath(),this.formatPath([new St(B.end.x,B.end.y),new St(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ci(this,void 0,void 0,function(){var a;return Pn(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=pn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=EG(r),[4,this.renderStack(a)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}($B),kG=function(e){return e instanceof NB||e instanceof IB?!0:e instanceof Fy&&e.type!==Vh&&e.type!==zh},DG=function(e,t){switch(e){case 0:return Wh(t);case 2:return mG(t);case 1:default:return Xh(t)}},jG=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},LG=["-apple-system","system-ui"],UG=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return LG.indexOf(t)===-1}):e},MG=function(e){Xs(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=a,n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),n}return t.prototype.render=function(r){return ci(this,void 0,void 0,function(){var a,n;return Pn(this,function(s){switch(s.label){case 0:return a=Jx(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,PG(a)];case 1:return n=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=pn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}($B),PG=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},QG=function(){function e(t){var r=t.id,a=t.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,vp([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),qG=function(){function e(t,r){var a;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new QG({id:this.instanceName,enabled:t.logging}),this.cache=(a=t.cache)!==null&&a!==void 0?a:new AG(this,t)}return e.instanceCount=1,e}(),ky=function(e,t){return t===void 0&&(t={}),KG(e,t)};typeof window<"u"&&qB.setContext(window);var KG=function(e,t){return ci(void 0,void 0,void 0,function(){var r,a,n,s,o,A,c,l,d,f,p,u,g,h,y,x,v,E,D,B,_,I,_,S,O,M,T,R,L,N,P,U,V,ie,W,z,G,b,k,j;return Pn(this,function(q){switch(q.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return n={allowTaint:(S=t.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(O=t.imageTimeout)!==null&&O!==void 0?O:15e3,proxy:t.proxy,useCORS:(M=t.useCORS)!==null&&M!==void 0?M:!1},s=Lx({logging:(T=t.logging)!==null&&T!==void 0?T:!0,cache:t.cache},n),o={windowWidth:(R=t.windowWidth)!==null&&R!==void 0?R:a.innerWidth,windowHeight:(L=t.windowHeight)!==null&&L!==void 0?L:a.innerHeight,scrollX:(N=t.scrollX)!==null&&N!==void 0?N:a.pageXOffset,scrollY:(P=t.scrollY)!==null&&P!==void 0?P:a.pageYOffset},A=new aA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new qG(s,A),l=(U=t.foreignObjectRendering)!==null&&U!==void 0?U:!1,d={allowTaint:(V=t.allowTaint)!==null&&V!==void 0?V:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:l,copyStyles:l},c.logger.debug("Starting document clone with size "+A.width+"x"+A.height+" scrolled to "+-A.left+","+-A.top),f=new yE(c,e,d),p=f.clonedReferenceElement,p?[4,f.toIFrame(r,A)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return u=q.sent(),g=Ry(p)||GH(p)?w9(p.ownerDocument):Om(c,p),h=g.width,y=g.height,x=g.left,v=g.top,E=HG(c,p,t.backgroundColor),D={canvas:t.canvas,backgroundColor:E,scale:(W=(ie=t.scale)!==null&&ie!==void 0?ie:a.devicePixelRatio)!==null&&W!==void 0?W:1,x:((z=t.x)!==null&&z!==void 0?z:0)+x,y:((G=t.y)!==null&&G!==void 0?G:0)+v,width:(b=t.width)!==null&&b!==void 0?b:Math.ceil(h),height:(k=t.height)!==null&&k!==void 0?k:Math.ceil(y)},l?(c.logger.debug("Document cloned, using foreign object rendering"),_=new MG(c,D),[4,_.render(p)]):[3,3];case 2:return B=q.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+x+","+v+" with size "+h+"x"+y+" using computed rendering"),c.logger.debug("Starting DOM parsing"),I=kB(c,p),E===I.styles.backgroundColor&&(I.styles.backgroundColor=Jo.TRANSPARENT),c.logger.debug("Starting renderer for element at "+D.x+","+D.y+" with size "+D.width+"x"+D.height),_=new RG(c,D),[4,_.render(I)];case 4:B=q.sent(),q.label=5;case 5:return(!((j=t.removeContainer)!==null&&j!==void 0)||j)&&(yE.destroy(u)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,B]}})})},HG=function(e,t,r){var a=t.ownerDocument,n=a.documentElement?xf(e,getComputedStyle(a.documentElement).backgroundColor):Jo.TRANSPARENT,s=a.body?xf(e,getComputedStyle(a.body).backgroundColor):Jo.TRANSPARENT,o=typeof r=="string"?xf(e,r):r===null?Jo.TRANSPARENT:4294967295;return t===a.documentElement?WA(n)?WA(s)?o:s:n:o};const GG=Object.freeze(Object.defineProperty({__proto__:null,default:ky},Symbol.toStringTag,{value:"Module"})),zG=({title:e,subtitle:t})=>{const r=$s(),a=uc(),[n,s]=K.useState(!1),o=a.pathname==="/settings"||a.pathname==="#/settings"||a.hash==="#/settings",A=()=>`# ОПИСАНИЕ ФУНКЦИОНАЛА CMS - СИСТЕМА УПРАВЛЕНИЯ ЗАЛОГОВЫМ ИМУЩЕСТВОМ

**Версия:** 2.0.0  
**Дата:** Декабрь 2024  
**Технологии:** React 18, TypeScript, Ant Design 5, Redux Toolkit, IndexedDB

---

## 📋 ОГЛАВЛЕНИЕ

1. Реестр объектов
2. Залоговый портфель
3. Задачи
4. KPI
5. Отчеты
6. Залоговое досье
7. Залоговые заключения
8. Страхование
9. ФНП
10. Аналитика
11. Модуль мониторинга
12. Модуль оценки
13. CMS Check
14. ЕГРН
15. Загрузка
16. Мониторинг
17. Справочная с ИИ
18. Настройки

---

## 1. РЕЕСТР ОБЪЕКТОВ

**Путь:** /registry

### Основной функционал:
- **Управление карточками залогового имущества** - полный CRUD (создание, чтение, обновление, удаление)
- **Расширенная классификация объектов** - 60+ типов объектов с 3-уровневой иерархией
- **Динамические формы** - 150+ полей характеристик, автоматически подстраивающихся под тип объекта
- **Многостраничная форма карточки** (5 вкладок): Основная информация, Адрес, Характеристики, Партнеры, Документы
- **Фильтрация и поиск** - по всем полям карточки
- **Сортировка** - по любому столбцу таблицы
- **Экспорт/импорт** - Excel формат для массовых операций
- **Резервное копирование** - экспорт/импорт всей базы данных

---

## 2. ЗАЛОГОВЫЙ ПОРТФЕЛЬ

**Путь:** /portfolio

### Основной функционал:
- **Агрегированное представление залогового портфеля**
- **Аналитика портфеля** - статистика по категориям, статусам, стоимости
- **Фильтрация и группировка** объектов залога
- **Визуализация данных** - графики и диаграммы портфеля
- **Оценка рисков** портфеля

---

## 3. ЗАДАЧИ

**Путь:** /tasks

### Основной функционал:
- **Управление задачами** (Zadachnik) - система задач для сотрудников
- **Создание задач** - назначение задач сотрудникам с приоритетами и сроками
- **Статусы задач** - планируется, в работе, выполнено, отменено
- **Приоритеты** - низкий, средний, высокий, критический
- **Назначение исполнителей** - привязка задач к сотрудникам
- **Фильтрация задач** - по статусу, приоритету, исполнителю, региону
- **Автогенерация задач** - автоматическое создание задач для активных сотрудников

---

## 4. KPI

**Путь:** /kpi

### Основной функционал:
- **KPI и аналитика** - ключевые показатели эффективности
- **Метрики производительности** - отслеживание показателей работы
- **Дашборд KPI** - визуализация ключевых метрик
- **Сравнительная аналитика** - сравнение показателей по периодам

---

## 5. ОТЧЕТЫ

**Путь:** /reports

### Основной функционал:
- **Агрегирование отчетности** - формирование различных отчетов
- **Типы отчетов**: Отчеты по реестру объектов, портфелю, задачам, оценкам
- **Экспорт отчетов** - в Excel, PDF форматы
- **Настраиваемые параметры** - выбор периодов, фильтров, группировок

---

## 6. ЗАЛОГОВОЕ ДОСЬЕ

**Путь:** /collateral-dossier

### Основной функционал:
- **Формирование залогового досье** - комплексная информация об объекте залога
- **Сбор документов** - все документы по объекту в одном месте
- **История изменений** - отслеживание всех изменений карточки
- **Связанные объекты** - связи между объектами залога
- **Экспорт досье** - формирование PDF досье для печати

---

## 7. ЗАЛОГОВЫЕ ЗАКЛЮЧЕНИЯ

**Путь:** /collateral-conclusions

### Основной функционал:
- **Создание залоговых заключений** - формирование экспертных заключений
- **Шаблоны заключений** - использование готовых шаблонов
- **Редактирование заключений** - создание и редактирование текста заключений
- **Привязка к объектам** - связь заключений с карточками залога
- **Экспорт заключений** - сохранение в PDF, Word форматах

---

## 8. СТРАХОВАНИЕ

**Путь:** /insurance

### Основной функционал:
- **Управление страховыми полисами** - учет страховых полисов по объектам залога
- **Сроки действия полисов** - отслеживание сроков страхования
- **Уведомления о продлении** - напоминания о необходимости продления
- **Страховые компании** - справочник страховщиков
- **Суммы страхования** - учет страховых сумм и премий

---

## 9. ФНП

**Путь:** /fnp

### Основной функционал:
- **Регистрация залога движимого имущества ФНП** - работа с Федеральной нотариальной палатой
- **Подача заявлений** - формирование заявлений на регистрацию залога
- **Отслеживание статусов** - мониторинг статусов регистрации
- **Документооборот** - управление документами для ФНП

---

## 10. АНАЛИТИКА

**Путь:** /analytics

### Основной функционал:
- **Расширенная аналитика** - углубленный анализ данных
- **Визуализация данных** - графики, диаграммы, дашборды
- **Анализ трендов** - выявление тенденций в портфеле
- **Прогнозирование** - прогнозные модели на основе исторических данных
- **Сравнительный анализ** - сравнение показателей по различным параметрам

---

## 11. МОДУЛЬ МОНИТОРИНГА

**Путь:** /credit-risk

### Основной функционал:
- **Мониторинг кредитных рисков** - отслеживание рисков по залоговому имуществу
- **Оценка рисков** - автоматическая и ручная оценка рисков
- **Алерты и уведомления** - оповещения о критических ситуациях
- **Рейтинг рисков** - классификация объектов по уровню риска
- **Отчеты по рискам** - формирование отчетов о рисках портфеля

---

## 12. МОДУЛЬ ОЦЕНКИ

**Путь:** /appraisal

### Основной функционал:
- **Автоматическая оценка объектов залога** - расчет стоимости объектов
- **Методы оценки**: Доходный подход (DCF, прямая капитализация, множитель валового дохода), Сравнительный подход (сравнение продаж, извлечение из рынка), Затратный подход (стоимость замещения, воспроизводства, износ)
- **Расчет LTV** - соотношение суммы займа к стоимости залога
- **Залоговая стоимость** - расчет залоговой стоимости с учетом дисконтов
- **История оценок** - сохранение истории всех оценок объекта
- **Экспорт отчетов об оценке** - формирование PDF отчетов

---

## 13. CMS CHECK

**Путь:** /cms-check

### Основной функционал:
- **Система дистанционных осмотров** - проведение осмотров объектов залога
- **Мобильный интерфейс** - доступ к осмотрам через мобильные устройства
- **Фотофиксация** - загрузка фотографий объекта
- **Чек-листы осмотра** - структурированные формы для осмотра
- **Геолокация** - привязка осмотра к координатам
- **Подпись инспектора** - электронная подпись результатов осмотра
- **Отчеты об осмотре** - автоматическое формирование отчетов

---

## 14. ЕГРН

**Путь:** /egrn

### Основной функционал:
- **Регистрация ипотеки** - работа с Единым государственным реестром недвижимости
- **Снятие обременений** - оформление снятия обременений с недвижимости
- **Выписки ЕГРН** - запрос и получение выписок из ЕГРН
- **Отслеживание статусов** - мониторинг статусов регистрационных действий
- **Документооборот** - управление документами для регистрации

---

## 15. ЗАГРУЗКА

**Путь:** /upload

### Основной функционал:
- **Миграция данных** - перенос данных из других систем
- **Экспорт данных** - выгрузка данных в Excel для миграции
- **Импорт данных** - загрузка данных из Excel файлов
- **Массовые изменения** - массовое редактирование записей через Excel
- **Валидация данных** - проверка корректности импортируемых данных
- **Отчеты об импорте** - статистика по результатам импорта

---

## 16. МОНИТОРИНГ

**Путь:** /monitoring

### Основной функционал:
- **Мониторинг системы** - отслеживание состояния системы
- **Мониторинг объектов** - контроль состояния объектов залога
- **Настройки мониторинга** - конфигурация параметров мониторинга
- **Уведомления** - система оповещений о событиях
- **Логирование** - журнал событий и действий в системе

---

## 17. СПРАВОЧНАЯ С ИИ

**Путь:** /reference

### Основной функционал:
- **AI-помощник** - интеллектуальный помощник на базе DeepSeek AI
- **База знаний** - справочная литература по банковским залогам ("Залоговik")
- **Поиск по базе знаний** - семантический поиск по документам
- **Чат с ИИ** - диалоговый интерфейс для получения консультаций
- **Режим оценки** - AI-оценка объектов залога с использованием профессиональных методов
- **Эквалайзер скилов** - настройка приоритетов методов оценки
- **Режим экспертизы** - настройка уровня экспертизы, анализа, краткости ответов
- **Самообучение ИИ** - система обратной связи (лайк/дизлайк) для улучшения ответов
- **Режим обучения** - интенсивное самообучение системы на базе документов
- **Эволюция ИИ** - система уровней и опыта ИИ-помощника
- **Экспорт PDF отчетов** - генерация подробных отчетов об оценке с расчетами
- **История чатов** - сохранение истории диалогов с ИИ

---

## 18. НАСТРОЙКИ

**Путь:** /settings

### Подразделы:

#### 18.1. Сотрудники
- **Управление сотрудниками** - добавление, редактирование, деактивация сотрудников
- **Роли и права доступа** - назначение ролей и прав сотрудникам
- **Синхронизация с задачами** - автоматическая синхронизация с системой задач

#### 18.2. Справочные данные
- **Управление справочниками** - редактирование классификаторов и справочников
- **Категории объектов** - управление категориями залогового имущества
- **Типы объектов** - настройка типов объектов и их характеристик

#### 18.3. Норма-часы
- **Нормативы времени** - установка нормативов времени на выполнение задач
- **Расчет трудозатрат** - автоматический расчет трудозатрат на основе нормативов

#### 18.4. Метрики
- **Настройка метрик** - конфигурация метрик для KPI и аналитики
- **Пороговые значения** - установка пороговых значений для метрик

---

## 🔧 ТЕХНИЧЕСКИЕ ОСОБЕННОСТИ

### Хранение данных:
- **IndexedDB** - основное хранилище данных в браузере
- **LocalStorage** - хранение настроек и кэша
- **Автоматическое резервное копирование** - экспорт/импорт базы данных

### Производительность:
- **Оптимизация рендеринга** - мемоизация компонентов, виртуализация списков
- **Ленивая загрузка** - загрузка данных по требованию
- **Кэширование** - кэширование результатов поиска и запросов

### Безопасность:
- **Валидация данных** - проверка всех входящих данных
- **Обработка ошибок** - graceful error handling
- **Логирование** - журналирование критических операций

### Интерфейс:
- **Адаптивный дизайн** - поддержка различных размеров экранов
- **Темная/светлая тема** - переключение тем оформления
- **Локализация** - русский язык интерфейса

---

## 📊 СТАТИСТИКА СИСТЕМЫ

- **Модулей:** 18 основных разделов
- **Типов объектов:** 60+
- **Полей характеристик:** 150+
- **Уровней классификации:** 3
- **Методов оценки:** 8 (доходный, сравнительный, затратный подходы)
- **Форматов экспорта:** Excel, PDF, JSON

---

**Дата создания документа:** Декабрь 2024  
**Версия CMS:** 2.0.0`,c=async()=>{try{s(!0),Ne.info("Генерация PDF описания системы...");let d="";try{const T=await fetch("/INSTRUCTION/CMS_FUNCTIONALITY.md");if(T.ok)d=await T.text();else throw new Error("Файл не найден, используем встроенное содержимое")}catch{d=A()}const f=l(d),p=document.createElement("div");p.style.position="fixed",p.style.left="-10000px",p.style.top="0",p.style.width="800px",p.style.minHeight="100px",p.style.padding="20px",p.style.backgroundColor="#ffffff",p.style.color="#000000",p.style.fontFamily='system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',p.style.fontSize="12px",p.style.lineHeight="1.6",p.style.boxSizing="border-box",p.style.visibility="visible",p.style.opacity="1",p.style.pointerEvents="none",p.style.zIndex="999999",p.style.overflow="visible",p.innerHTML=f,document.body.appendChild(p),await new Promise(T=>requestAnimationFrame(T)),await new Promise(T=>requestAnimationFrame(T)),await new Promise(T=>setTimeout(T,500)),p.offsetHeight;const u=p.scrollHeight||1e3;if(u<50)throw document.body.removeChild(p),new Error("Контейнер PDF пуст или не отрендерился");const g=await ky(p,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:800,height:u,windowWidth:800,windowHeight:u});if(document.body.removeChild(p),!g||g.width===0||g.height===0)throw new Error("Canvas пуст");const h=g.toDataURL("image/png"),y=new Ht({orientation:"p",unit:"mm",format:"a4"}),x=y.internal.pageSize.getWidth(),v=y.internal.pageSize.getHeight(),E=10,D=x-E*2,B=E,I=D,_=g.height*I/g.width;let S=_,O=0;for(y.addImage(h,"PNG",E,B,I,_),S-=v-E*2;S>0;)O=S-_,y.addPage(),y.addImage(h,"PNG",E,O,I,_),S-=v-E*2;const M=new Date().toISOString().slice(0,10);y.save(`Описание_системы_CMS_${M}.pdf`),Ne.success("PDF описание системы успешно выгружено")}catch(d){console.error("Ошибка генерации PDF:",d),Ne.error(`Ошибка генерации PDF: ${d.message||"Неизвестная ошибка"}`)}finally{s(!1)}},l=d=>{let f=d;return f=f.replace(/^### (.*$)/gim,'<h3 style="margin: 16px 0 8px 0; font-size: 16px; font-weight: 600; color: #1890ff;">$1</h3>'),f=f.replace(/^## (.*$)/gim,'<h2 style="margin: 20px 0 12px 0; font-size: 20px; font-weight: 700; color: #1890ff; border-bottom: 2px solid #1890ff; padding-bottom: 4px;">$1</h2>'),f=f.replace(/^# (.*$)/gim,'<h1 style="margin: 24px 0 16px 0; font-size: 24px; font-weight: 700; color: #1890ff;">$1</h1>'),f=f.replace(/\*\*(.*?)\*\*/gim,'<strong style="font-weight: 600;">$1</strong>'),f=f.replace(/^- (.*$)/gim,'<li style="margin: 4px 0; padding-left: 8px;">$1</li>'),f=f.replace(/(<li.*<\/li>)/s,'<ul style="margin: 8px 0; padding-left: 24px;">$1</ul>'),f=f.replace(/^---$/gim,'<hr style="margin: 16px 0; border: none; border-top: 1px solid #e8e8e8;" />'),f=f.split(`

`).map(p=>p.trim()&&!p.match(/^<[h|u|o|l|d]/)?`<p style="margin: 8px 0; text-align: justify;">${p.trim()}</p>`:p).join(`
`),f=f.replace(/`(.*?)`/gim,'<code style="background: #f5f5f5; padding: 2px 6px; border-radius: 3px; font-family: monospace;">$1</code>'),f=f.replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" style="color: #1890ff; text-decoration: none;">$1</a>'),`<div style="max-width: 800px; margin: 0 auto;">${f}</div>`};return o?i.jsxs("div",{style:{padding:"24px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsx("h1",{style:{margin:0},children:"Настройки"}),i.jsx(Be,{type:"primary",icon:i.jsx(OT,{}),loading:n,onClick:c,size:"large",children:"Выгрузить Описание системы"})]}),i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(Ge,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/employees"),children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(es,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),i.jsx("h3",{children:"Управление сотрудниками"}),i.jsx("p",{style:{color:"#8c8c8c"},children:"Добавление и редактирование сотрудников, их ролей и прав доступа"})]})})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(Ge,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/reference-data"),children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(JA,{style:{fontSize:"48px",color:"#52c41a",marginBottom:"16px"}}),i.jsx("h3",{children:"Справочники"}),i.jsx("p",{style:{color:"#8c8c8c"},children:"Управление всеми справочниками системы"})]})})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(Ge,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/norm-hours"),children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(zn,{style:{fontSize:"48px",color:"#fa8c16",marginBottom:"16px"}}),i.jsx("h3",{children:"Нормочасы по функциям"}),i.jsx("p",{style:{color:"#8c8c8c"},children:"Управление нормочасами для расчета загрузки сотрудников"})]})})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(Ge,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/metrics"),children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(rl,{style:{fontSize:"48px",color:"#722ed1",marginBottom:"16px"}}),i.jsx("h3",{children:"Метрики KPI и MBO"}),i.jsx("p",{style:{color:"#8c8c8c"},children:"Корректировка ключевых показателей и целевых значений MBO"})]})})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(Ge,{hoverable:!0,style:{height:"100%"},onClick:()=>r("/settings/appraisal-companies"),children:i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(i_,{style:{fontSize:"48px",color:"#13c2c2",marginBottom:"16px"}}),i.jsx("h3",{children:"Аккредитация оценочных компаний"}),i.jsx("p",{style:{color:"#8c8c8c"},children:"Реестр оценочных компаний и управление их аккредитацией"})]})})})]})]}):i.jsx(s_,{status:"info",title:e,subTitle:t||"Этот раздел находится в разработке",extra:i.jsx(Be,{onClick:()=>r("/registry"),children:"Вернуться к реестру"})})},ad=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),VG=()=>{const[e,t]=K.useState([]),[r,a]=K.useState(!0),[n,s]=K.useState(null),[o,A]=K.useState(""),[c,l]=K.useState(null),[d,f]=K.useState(null),[p,u]=K.useState(null),[g,h]=K.useState(null),[y,x]=K.useState(!1),[v,E]=K.useState(null),[D,B]=K.useState(null);K.useEffect(()=>{try{const M=new URLSearchParams(window.location.search),T=M.get("q")||M.get("ref")||"",R=M.get("ref"),L=M.get("policy");R&&E(R),L&&B(L),T&&A(T)}catch{}},[]),K.useEffect(()=>{if(e.length!==0){if(D){const M=e.find(T=>T.policyNumber===D);if(M){h(M),x(!0);return}}if(v){const M=e.filter(T=>String(T.reference)===String(v));M.length>=1&&(h(M[0]),x(!0))}}},[e,v,D]),K.useEffect(()=>{let M=!0;return(async()=>{a(!0),s(null);try{const R="./",L=new URL(R,window.location.origin),N=L.pathname.endsWith("/")?L.pathname:`${L.pathname}/`,P=`${L.origin}${N}insuranceData.json?v=${Date.now()}`,U=await fetch(P,{cache:"no-store"});if(!U.ok)throw new Error(`Не удалось загрузить страхование (${U.status})`);const V=await U.json();if(!M)return;t(V.map((ie,W)=>({...ie,key:`ins-${W}`,reference:ie.reference!=null?String(ie.reference):null})))}catch(R){s(R instanceof Error?R.message:"Неизвестная ошибка"),t([])}finally{M&&a(!1)}})(),()=>{M=!1}},[]);const I=K.useMemo(()=>{const M=T=>Array.from(new Set(e.map(R=>R[T]).filter(R=>typeof R=="string"&&R.trim().length>0))).sort();return{types:M("insuranceType"),statuses:M("status"),insurers:M("insurer")}},[e]),_=K.useMemo(()=>{const M=o.trim().toLowerCase();return e.filter(T=>{const R=!M||[T.policyNumber,T.insured,T.contractNumber,T.reference,T.insurer,T.insuranceType].filter(Boolean).some(U=>String(U).toLowerCase().includes(M)),L=!c||T.insuranceType===c,N=!d||T.status===d,P=!p||T.insurer===p;return R&&L&&N&&P})},[e,o,c,d,p]),S=K.useMemo(()=>{const M=_.length,T=_.reduce((L,N)=>{const P=typeof N.insuredAmount=="number"?N.insuredAmount:Number(String(N.insuredAmount??"").replace(/\s/g,"").replace(",","."));return L+(Number.isFinite(P)?P:0)},0),R=_.reduce((L,N)=>{const P=typeof N.premium=="number"?N.premium:Number(String(N.premium??"").replace(/\s/g,"").replace(",","."));return L+(Number.isFinite(P)?P:0)},0);return{totalPolicies:M,totalInsured:T,totalPremium:R}},[_]),O=K.useMemo(()=>[{title:"Полис",dataIndex:"policyNumber",key:"policy",width:200,render:(M,T)=>i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600},children:T.policyNumber}),i.jsx("div",{className:"insurance-muted",children:T.insuranceType})]})},{title:"Объект",key:"property",width:260,render:(M,T)=>i.jsxs("div",{children:[i.jsx("div",{className:"insurance-muted",children:T.propertyType??"—"}),i.jsx("div",{className:"insurance-muted",children:T.propertyAddress??"—"})]})},{title:"Сделка",key:"deal",width:220,render:(M,T)=>i.jsxs("div",{children:[i.jsxs("div",{className:"insurance-muted",children:["REFERENCE: ",T.reference??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Договор: ",T.contractNumber??"—"]})]})},{title:"Страхователь",key:"insured",width:260,render:(M,T)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:T.insured??"—"}),i.jsx("div",{className:"insurance-muted",children:T.insurer})]})},{title:"Суммы",key:"amounts",width:260,render:(M,T)=>i.jsxs("div",{className:"insurance-metrics",children:[i.jsxs("div",{className:"insurance-metrics-row",children:[i.jsx("span",{children:"Страховая сумма"}),i.jsx("strong",{children:T.insuredAmount?ad.format(Number(String(T.insuredAmount).replace(/\s/g,"").replace(",","."))):"—"})]}),i.jsxs("div",{className:"insurance-metrics-row",children:[i.jsx("span",{children:"Премия"}),i.jsx("strong",{children:T.premium?ad.format(Number(String(T.premium).replace(/\s/g,"").replace(",","."))):"—"})]})]})},{title:"Срок",key:"term",width:220,render:(M,T)=>i.jsxs("div",{children:[i.jsxs("div",{className:"insurance-muted",children:["Начало: ",T.startDate??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Окончание: ",T.endDate??"—"]})]})},{title:"Статус",dataIndex:"status",key:"status",width:160,render:M=>{const T=M==="Активен"?"green":M==="Требует продления"?"orange":M==="Истек"?"volcano":"default";return i.jsx(at,{color:T,children:M})}}],[]);return i.jsxs("div",{className:"insurance-page",children:[i.jsxs("div",{className:"insurance-header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"insurance-title",children:"Страхование"}),i.jsx(mt.Paragraph,{className:"insurance-subtitle",children:"Полисы страхования, связанные с договорами залогового портфеля"})]}),i.jsx(Fe,{size:"middle",direction:"vertical",children:i.jsx(Xr,{title:"Поиск по полисам, клиентам, договорам",children:i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по полисам, клиентам, REFERENCE",prefix:i.jsx(Pa,{}),value:o,onChange:M=>A(M.target.value),style:{width:360}})})})]}),i.jsx(Ge,{children:i.jsxs("div",{className:"insurance-filters",children:[i.jsx(Ye,{allowClear:!0,placeholder:"Вид страхования",style:{width:200},options:I.types.map(M=>({label:M,value:M})),value:c??void 0,onChange:M=>l(M??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Статус",style:{width:200},options:I.statuses.map(M=>({label:M,value:M})),value:d??void 0,onChange:M=>f(M??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Страховщик",style:{width:200},options:I.insurers.map(M=>({label:M,value:M})),value:p??void 0,onChange:M=>u(M??null)})]})}),i.jsxs(ft,{gutter:[16,16],className:"insurance-stats",children:[i.jsx(Te,{xs:24,sm:12,md:8,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Количество полисов",value:S.totalPolicies,prefix:i.jsx(i_,{})})})}),i.jsx(Te,{xs:24,sm:12,md:8,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Совокупная страховая сумма",value:ad.format(S.totalInsured)})})}),i.jsx(Te,{xs:24,sm:12,md:8,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Совокупная премия",value:ad.format(S.totalPremium),prefix:i.jsx(IT,{})})})})]}),i.jsx(Ge,{className:"insurance-table-card",bodyStyle:{padding:0},children:i.jsx(nr,{columns:O,dataSource:_,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:r,onRow:M=>({onDoubleClick:()=>{h(M),x(!0)}}),locale:{emptyText:i.jsx(Br,{description:"Нет записей, удовлетворяющих фильтрам",className:"insurance-empty"})}})}),n&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить страховые данные",description:n,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),r&&i.jsx("div",{style:{textAlign:"center"},children:i.jsx(Zn,{tip:"Загружаем страховые данные..."})}),i.jsx(dr,{title:"Карточка полиса",open:y,onCancel:()=>x(!1),footer:null,width:720,children:g&&i.jsxs(Fe,{direction:"vertical",size:"small",style:{width:"100%"},children:[i.jsx(mt.Text,{strong:!0,children:"Полис:"})," ",g.policyNumber,i.jsxs("div",{className:"insurance-muted",children:["Тип: ",g.insuranceType]}),i.jsxs("div",{className:"insurance-muted",children:["Тип имущества: ",g.propertyType??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Адрес имущества: ",g.propertyAddress??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Страхователь: ",g.insured??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["REFERENCE сделки: ",g.reference??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Договор: ",g.contractNumber??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Страховая сумма:"," ",typeof g.insuredAmount=="number"?ad.format(g.insuredAmount):"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Премия:"," ",typeof g.premium=="number"?ad.format(g.premium):"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Срок: ",g.startDate??"—"," — ",g.endDate??"—"]}),i.jsxs("div",{className:"insurance-muted",children:["Страховщик: ",g.insurer]}),i.jsx("div",{children:i.jsx(at,{children:g.status})})]})})]})},{TextArea:$G}=Re,{Option:Kp}=Ye,YG=[{value:"Оценка",label:"Оценка"},{value:"Экспертиза",label:"Экспертиза"},{value:"Рецензия",label:"Рецензия"},{value:"ПРКК",label:"ПРКК"},{value:"Прочее",label:"Прочее"},{value:"Отчетность",label:"Отчетность"},{value:"Подготовка СЗ",label:"Подготовка СЗ"}],WG=[{value:"low",label:"Низкий"},{value:"medium",label:"Средний"},{value:"high",label:"Высокий"},{value:"critical",label:"Критический"}],XG=["Москва","Санкт-Петербург","Новосибирск","Екатеринбург"],JG=({visible:e,deal:t,onCancel:r,onSuccess:a})=>{const[n]=ne.useForm(),[s,o]=K.useState(!1),[A,c]=K.useState([]);K.useEffect(()=>{var f,p,u,g;e&&t&&(n.setFieldsValue({region:(f=t.collateralLocation)!=null&&f.includes("Москва")?"Москва":(p=t.collateralLocation)!=null&&p.includes("Санкт-Петербург")?"Санкт-Петербург":(u=t.collateralLocation)!=null&&u.includes("Новосибирск")?"Новосибирск":(g=t.collateralLocation)!=null&&g.includes("Екатеринбург")?"Екатеринбург":"Москва",title:`Сделка ${t.reference||t.contractNumber||""} - ${t.borrower||t.pledger||""}`,description:`Задача по сделке REFERENCE: ${t.reference||t.contractNumber||""}
Заемщик: ${t.borrower||"Не указан"}
Залогодатель: ${t.pledger||"Не указан"}
Тип обеспечения: ${t.collateralType||"Не указан"}
Местоположение: ${t.collateralLocation||"Не указано"}`,priority:"medium",dueDate:We().add(7,"day")}),l())},[e,t,n]);const l=()=>{try{const f=localStorage.getItem("zadachnik_users");if(f){const p=JSON.parse(f),u=(p==null?void 0:p.employee)||[];c(u)}}catch(f){console.error("Ошибка загрузки сотрудников:",f)}},d=async()=>{var f,p,u,g,h;try{const y=await n.validateFields();o(!0);const x=(await pi(async()=>{const{default:D}=await Promise.resolve().then(()=>T7);return{default:D}},void 0,import.meta.url)).default;let v=[];try{v=await x.getTasks()}catch{try{const B=localStorage.getItem("zadachnik_tasks");B&&(v=JSON.parse(B))}catch(B){console.warn("Не удалось загрузить задачи:",B)}}const E={id:`T-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,region:y.region,type:y.type,category:y.type,title:y.title,description:y.description||"",priority:y.priority,dueDate:y.dueDate.format("YYYY-MM-DD"),status:"created",businessUser:"system@cms.ru",businessUserName:"Система CMS",assignedTo:y.assignedTo||[],currentAssignee:((f=y.assignedTo)==null?void 0:f[0])||null,currentAssigneeName:(p=y.assignedTo)!=null&&p[0]?(u=A.find(D=>D.email===y.assignedTo[0]))==null?void 0:u.name:null,employeeId:(g=y.assignedTo)!=null&&g[0]?(h=A.find(D=>D.email===y.assignedTo[0]))==null?void 0:h.id:void 0,documents:[],comments:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),history:[{date:new Date().toISOString(),user:"Система CMS",userRole:"system",action:"Создана",comment:`Задача создана из карточки сделки ${(t==null?void 0:t.reference)||(t==null?void 0:t.contractNumber)||""}`,status:"created"}]};v.push(E);try{await x.saveTasks(v)}catch(D){console.error("Ошибка сохранения задачи в IndexedDB:",D),Ne.error("Не удалось сохранить задачу. Попробуйте еще раз."),o(!1);return}Ne.success("Задача успешно создана в Задачнике"),n.resetFields(),o(!1),a==null||a(),r()}catch(y){console.error("Ошибка создания задачи:",y),Ne.error("Ошибка при создании задачи"),o(!1)}};return i.jsx(dr,{title:"Создать задачу в Задачнике",open:e,onCancel:r,footer:[i.jsx(Be,{onClick:r,children:"Отмена"},"cancel"),i.jsx(Be,{type:"primary",loading:s,onClick:d,children:"Создать задачу"},"submit")],width:600,children:i.jsxs(ne,{form:n,layout:"vertical",children:[i.jsx(ne.Item,{name:"region",label:"Регион",rules:[{required:!0,message:"Выберите регион"}],children:i.jsx(Ye,{placeholder:"Выберите регион",children:XG.map(f=>i.jsx(Kp,{value:f,children:f},f))})}),i.jsx(ne.Item,{name:"type",label:"Тип задачи",rules:[{required:!0,message:"Выберите тип задачи"}],children:i.jsx(Ye,{placeholder:"Выберите тип задачи",children:YG.map(f=>i.jsx(Kp,{value:f.value,children:f.label},f.value))})}),i.jsx(ne.Item,{name:"title",label:"Название задачи",rules:[{required:!0,message:"Введите название задачи"}],children:i.jsx(Re,{placeholder:"Название задачи"})}),i.jsx(ne.Item,{name:"description",label:"Описание",children:i.jsx($G,{rows:4,placeholder:"Описание задачи"})}),i.jsx(ne.Item,{name:"priority",label:"Приоритет",rules:[{required:!0,message:"Выберите приоритет"}],children:i.jsx(Ye,{placeholder:"Выберите приоритет",children:WG.map(f=>i.jsx(Kp,{value:f.value,children:f.label},f.value))})}),i.jsx(ne.Item,{name:"dueDate",label:"Срок выполнения",rules:[{required:!0,message:"Выберите срок выполнения"}],children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),i.jsx(ne.Item,{name:"assignedTo",label:"Исполнитель (необязательно)",children:i.jsx(Ye,{mode:"multiple",placeholder:"Выберите исполнителя",showSearch:!0,filterOption:(f,p)=>(typeof(p==null?void 0:p.label)=="string"?p.label:String((p==null?void 0:p.children)||"")).toLowerCase().includes(f.toLowerCase()),children:A.map(f=>i.jsxs(Kp,{value:f.email,children:[f.name," (",f.email,")"]},f.email))})}),t&&i.jsx(ne.Item,{label:"Связанная сделка",children:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"REFERENCE:"})," ",t.reference||t.contractNumber||"Не указан"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Заемщик:"})," ",t.borrower||"Не указан"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Залогодатель:"})," ",t.pledger||"Не указан"]})]})})]})})},v1={Здание:"жилые пом _Здания",Сооружение:"жилые пом _Здания",Помещение:"жилые пом _Здания","Земельный участок":"Земельные участки","Нежилое здание":"Нежилые здания_Помещения","Нежилое помещение":"Нежилые здания_Помещения","Транспортное средство":"ТС и СМ","Самоходная машина":"ТС и СМ","Товарно-материальные ценности":"ТМЦ",Оборудование:"Оборудование","Воздушное судно":"Воздушные суда","Морское судно":"Морские и речные суда","Речное судно":"Морские и речные суда","Железнодорожный подвижной состав":"Подвижной ж_д состав","Имущественные права":"Имущественные права","Уступка прав требования":"Уступка прав требования","Права на строительство":"Имущ.права  стр-во_инвест.","Права на инвестиции":"Имущ.права  стр-во_инвест.","Ценные бумаги":"ценные бумаги_акции",Акции:"ценные бумаги_акции","Доли в уставном капитале":"Доли в УК","Залоговый счет":"Залоговый счет",ГУП:"ГУП МУП",МУП:"ГУП МУП","214-ФЗ":"214-ФЗ"};function ZG(e){if(v1[e])return v1[e];const t=e.toLowerCase();for(const[r,a]of Object.entries(v1))if(t.includes(r.toLowerCase())||r.toLowerCase().includes(t))return a;return"ТС и СМ"}async function ez(){try{const e="./",t=new URL(e,window.location.origin),r=t.pathname.endsWith("/")?t.pathname:`${t.pathname}/`,a=`${t.origin}${r}Documents.xlsx`,n=await fetch(a,{cache:"no-store",signal:AbortSignal.timeout(5e3)}).catch(()=>null);if(!n||!n.ok)return new Map;const s=await n.arrayBuffer(),o=ul(s,{type:"array"}),A=new Map;return o.SheetNames.forEach(c=>{const l=o.Sheets[c],f=ui.sheet_to_json(l,{header:1,defval:""}).filter(p=>p[1]&&typeof p[1]=="number"&&p[2]).map(p=>({num:p[1],name:String(p[2]||"").trim(),format:String(p[3]||"").trim(),legal:String(p[4]||"").trim()})).filter(p=>p.name.length>0);f.length>0&&A.set(c,f)}),A}catch{return new Map}}function tz(e,t,r){var A;const a=[],n=((A=t==null?void 0:t.classification)==null?void 0:A.propertyType)||(t==null?void 0:t.mainCategory)||"Транспортное средство",s=ZG(n),o=r.get(s)||[];return o.length===0?(["Договор залога","Отчет об оценке","Заключение юридической службы","Акт осмотра","Страховой полис"].forEach((l,d)=>{a.push({id:`doc-${e.reference}-${d}`,reference:String(e.reference),borrower:e.borrower||null,pledger:e.pledger||null,inn:e.inn||null,docType:l,folderId:`folder-${e.reference}`,folderPath:[e.borrower||"Не указан",e.pledger||"Не указан",`Договор ${e.contractNumber||e.reference}`],description:`Документ по сделке ${e.reference}`,status:d<3?"Загружен":d===3?"На согласовании":"Требует обновления",statusColor:d<3?"green":d===3?"orange":"red",fileName:`${l}_${e.reference}.pdf`,lastUpdated:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toLocaleDateString("ru-RU"),responsible:"Иванов И.И.",size:`${Math.floor(Math.random()*5e3+100)} КБ`})}),a):(o.slice(0,Math.min(10,o.length)).forEach(c=>{const l=["Загружен","На согласовании","Требует обновления"],d=["green","orange","red"],f=Math.floor(Math.random()*l.length);a.push({id:`doc-${e.reference}-${c.num}`,reference:String(e.reference),borrower:e.borrower||null,pledger:e.pledger||null,inn:e.inn||null,docType:c.name,folderId:`folder-${e.reference}`,folderPath:[e.borrower||"Не указан",e.pledger||"Не указан",`Договор ${e.contractNumber||e.reference}`],description:c.format||void 0,status:l[f],statusColor:d[f],fileName:`${c.name.replace(/[^a-zA-Zа-яА-Я0-9]/g,"_")}_${e.reference}.pdf`,lastUpdated:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toLocaleDateString("ru-RU"),responsible:["Иванов И.И.","Петров П.П.","Сидоров С.С."][Math.floor(Math.random()*3)],size:`${Math.floor(Math.random()*5e3+100)} КБ`})}),a)}function rz(e){const t=new Map;return e.forEach(r=>{const a=r.borrower||"Не указан",n=r.pledger||"Не указан",s=`Договор ${r.contractNumber||r.reference}`,o=`client-${a}`;t.has(o)||t.set(o,{id:o,path:[a],description:`Документы клиента: ${a}`});const A=`pledger-${a}-${n}`;t.has(A)||t.set(A,{id:A,path:[a,n],description:`Документы залогодателя: ${n}`});const c=`contract-${r.reference}`;t.has(c)||t.set(c,{id:c,path:[a,n,s],description:`Документы по договору: ${s}`})}),Array.from(t.values())}async function YB(e,t){const r=await ez(),a=new Map;t.forEach(o=>{var A;(A=o.characteristics)!=null&&A.reference&&a.set(String(o.characteristics.reference),o)});const n=[];return e.forEach(o=>{const A=a.get(String(o.reference)),c=tz(o,A||null,r);n.push(...c)}),{folders:rz(e),documents:n}}const{Text:w1}=mt,az=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),bE=e=>e==null?"—":az.format(e),nz=({visible:e,onCancel:t,onSelect:r,excludeIds:a=[]})=>{const[n,s]=K.useState(""),[o,A]=K.useState([]),[c,l]=K.useState(!1),[d,f]=K.useState([]),p=K.useCallback(()=>{if(n.trim()){const h=n.toLowerCase(),y=o.filter(x=>{var v,E,D,B,I;return a.includes(x.id)?!1:((v=x.name)==null?void 0:v.toLowerCase().includes(h))||((E=x.number)==null?void 0:E.toLowerCase().includes(h))||((B=(D=x.address)==null?void 0:D.fullAddress)==null?void 0:B.toLowerCase().includes(h))||((I=x.propertyType)==null?void 0:I.toLowerCase().includes(h))});f(y)}else f(o.filter(h=>!a.includes(h.id)))},[n,o,a]),u=K.useCallback(async()=>{l(!0);try{const h=await Yt.getExtendedCards();A(h),f(h.filter(y=>!a.includes(y.id)))}catch(h){console.error("Ошибка загрузки объектов:",h)}finally{l(!1)}},[a]);K.useEffect(()=>{e&&u()},[e,u]),K.useEffect(()=>{p()},[p]);const g=[{title:"Наименование",dataIndex:"name",key:"name",render:(h,y)=>i.jsxs(Fe,{direction:"vertical",size:0,children:[i.jsx(w1,{strong:!0,children:y.name}),i.jsx(w1,{type:"secondary",style:{fontSize:"12px"},children:y.number})]})},{title:"Тип имущества",key:"propertyType",render:(h,y)=>i.jsx(at,{children:y.propertyType||"—"})},{title:"Адрес",key:"address",render:(h,y)=>{var x;return i.jsx(w1,{children:((x=y.address)==null?void 0:x.fullAddress)||"—"})}},{title:"Рыночная стоимость",key:"marketValue",align:"right",render:(h,y)=>bE(y.marketValue)},{title:"Залоговая стоимость",key:"pledgeValue",align:"right",render:(h,y)=>bE(y.pledgeValue)},{title:"Действие",key:"action",width:120,render:(h,y)=>i.jsx("a",{onClick:()=>r(y),children:"Выбрать"})}];return i.jsx(dr,{title:"Выбор объекта обеспечения",open:e,onCancel:t,footer:null,width:900,children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsx(Re,{placeholder:"Поиск по наименованию, номеру, адресу...",prefix:i.jsx(Pa,{}),value:n,onChange:h=>s(h.target.value),allowClear:!0}),c?i.jsx(Zn,{tip:"Загрузка объектов..."}):d.length>0?i.jsx(nr,{columns:g,dataSource:d,rowKey:"id",pagination:{pageSize:10},size:"small",onRow:h=>({onDoubleClick:()=>r(h)})}):i.jsx(Br,{description:"Объекты не найдены"})]})})},iz=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),sz=new Intl.NumberFormat("ru-RU",{style:"percent",maximumFractionDigits:1}),Ki=e=>{const t=typeof e=="number"?e:e?parseFloat(String(e)):null;return t==null?"—":iz.format(t)},an=e=>{if(e==null)return"—";const t=String(e).trim();return t.length>0?t:"—"},oz=({contract:e,visible:t,onClose:r,onUpdate:a})=>{const n=$s(),[s,o]=K.useState("general"),[A,c]=K.useState([]),[l,d]=K.useState(!1),[f,p]=K.useState(!1),[u,g]=K.useState([]),[h,y]=K.useState([]),[x,v]=K.useState(!1),E=K.useCallback(async()=>{d(!0);try{const N=String(e.reference??e.contractNumber??""),U=(await Yt.getExtendedCards()).filter(V=>V.reference&&String(V.reference)===N||V.contractNumber&&V.contractNumber===e.contractNumber);c(U)}catch(N){console.error("Ошибка загрузки объектов:",N),Ne.error("Ошибка загрузки объектов")}finally{d(!1)}},[e]),D=K.useCallback(async()=>{if(e){v(!0);try{const N=localStorage.getItem("collateralDossierData");let P=[];if(N)P=JSON.parse(N).documents;else{const G=(()=>{const Y="./",de=new URL(Y,window.location.origin),ue=de.pathname.endsWith("/")?de.pathname:`${de.pathname}/`;return`${de.origin}${ue}portfolioData.json`})(),b=await fetch(`${G}?v=${Date.now()}`,{cache:"no-store"});let k=[];b.ok&&(k=await b.json());const j=await Yt.getExtendedCards();P=(await YB(k,j)).documents}const U=e.collateralContractNumber,V=String(e.reference||""),ie=P.filter(G=>G.reference===V||U&&G.folderPath.some(b=>b.includes(U)));g(ie);const z=(await Ca.getInspections()).filter(G=>A.some(b=>G.collateralCardId===b.id||G.collateralNumber===b.number));y(z)}catch(N){console.error("Ошибка загрузки документов:",N),Ne.error("Ошибка загрузки документов")}finally{v(!1)}}},[e,A]);K.useEffect(()=>{t&&e&&E()},[t,e,E]),K.useEffect(()=>{t&&e&&A.length>0&&s==="documents"&&D()},[t,e,A,s,D]);const B=.75,I=K.useMemo(()=>A.reduce((N,P)=>N+(P.marketValue||0),0),[A]),_=K.useMemo(()=>Math.floor(I*B),[I]),S=K.useMemo(()=>{const N=typeof e.debtRub=="number"?e.debtRub:parseFloat(String(e.debtRub||0)),P=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0));return P>0?Math.min(N/P,2):null},[e.debtRub,e.marketValue]),O=async N=>{try{const P=A.find(G=>G.id===N);if(!P)return;const U={...P,reference:void 0,contractNumber:void 0,contractId:void 0};await Yt.saveExtendedCard(U);const V=P.marketValue||0,ie=typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0)),W=Math.max(0,ie-V),z=Math.floor(W*B);a&&a({...e,collateralValue:z,marketValue:W,currentMarketValue:W}),Ne.success("Объект отвязан от договора"),await E()}catch(P){console.error("Ошибка отвязки объекта:",P),Ne.error("Ошибка при отвязке объекта")}},M=async N=>{try{const P=String(e.reference??e.contractNumber??""),U={...N,reference:P,contractNumber:e.contractNumber||void 0,contractId:e.contractNumber||void 0};await Yt.saveExtendedCard(U);const V=N.marketValue||0,W=(typeof e.marketValue=="number"?e.marketValue:parseFloat(String(e.marketValue||0)))+V,z=Math.floor(W*B);a&&a({...e,collateralValue:z,marketValue:W,currentMarketValue:W}),Ne.success("Объект привязан к договору"),await E(),p(!1)}catch(P){console.error("Ошибка привязки объекта:",P),Ne.error("Ошибка при привязке объекта")}},T=N=>{n(`/registry?objectId=${N}`),r()},R=[{title:"Наименование",dataIndex:"name",key:"name",render:(N,P)=>i.jsxs(Fe,{direction:"vertical",size:0,children:[i.jsx(mt.Text,{strong:!0,children:P.name}),i.jsxs(mt.Text,{type:"secondary",style:{fontSize:"12px"},children:["ID: ",P.id]})]})},{title:"Адрес",key:"address",render:(N,P)=>{var U;return i.jsx(mt.Text,{children:((U=P.address)==null?void 0:U.fullAddress)||"—"})}},{title:"Рыночная стоимость",key:"marketValue",align:"right",render:(N,P)=>Ki(P.marketValue)},{title:"Залоговая стоимость",key:"pledgeValue",align:"right",render:(N,P)=>Ki(P.pledgeValue)},{title:"Характеристики",key:"characteristics",render:(N,P)=>{var V;const U=[];return P.propertyType&&U.push(P.propertyType),(V=P.classification)!=null&&V.level1&&U.push(P.classification.level1),i.jsx(Fe,{wrap:!0,children:U.map((ie,W)=>i.jsx(at,{children:ie},W))})}},{title:"Действия",key:"actions",width:200,render:(N,P)=>i.jsxs(Fe,{children:[i.jsx(Be,{type:"link",size:"small",icon:i.jsx(eA,{}),onClick:()=>T(P.id),children:"Открыть"}),i.jsx(fo,{title:"Отвязать объект от договора?",description:"Стоимость договора будет уменьшена на стоимость объекта",onConfirm:()=>O(P.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,size:"small",icon:i.jsx(Bs,{}),children:"Отвязать"})})]})}],L=[{key:"general",label:i.jsxs("span",{children:[i.jsx(Qr,{}),"Общие сведения"]}),children:i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs(we,{title:"Общие сведения",bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"Сегмент",children:an(e.segment)}),i.jsx(we.Item,{label:"Группа",children:an(e.group)}),i.jsx(we.Item,{label:"REFERENCE",children:an(e.reference)}),i.jsx(we.Item,{label:"Залогодатель",children:an(e.pledger)}),i.jsx(we.Item,{label:"ИНН",children:an(e.inn)}),i.jsx(we.Item,{label:"Заемщик",children:an(e.borrower)}),i.jsx(we.Item,{label:"№ договора",children:an(e.contractNumber)}),i.jsx(we.Item,{label:"Дата договора",children:an(e.contractDate)}),i.jsx(we.Item,{label:"Тип",children:an(e.type)}),i.jsx(we.Item,{label:"Дата открытия",children:an(e.openDate)}),i.jsx(we.Item,{label:"Дата закрытия",children:an(e.closeDate)})]}),i.jsxs(we,{title:"Финансовые показатели",bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"Задолженность, руб.",children:Ki(e.debtRub)}),i.jsx(we.Item,{label:"Лимит, руб.",children:Ki(e.limitRub)}),i.jsx(we.Item,{label:"LTV",children:S!==null?i.jsx(at,{color:S>.8?"red":S>.6?"orange":"green",children:sz.format(S)}):"—"}),i.jsx(we.Item,{label:"Проср. ОД, руб.",children:Ki(e.overduePrincipal)}),i.jsx(we.Item,{label:"Проср. %, руб.",children:Ki(e.overdueInterest)})]}),i.jsxs(we,{title:"Оценка обеспечения",bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"Залоговая стоимость, руб.",children:Ki(e.collateralValue)}),i.jsx(we.Item,{label:"Рыночная стоимость, руб.",children:Ki(e.marketValue)}),i.jsx(we.Item,{label:"Совокупная рыночная стоимость объектов",children:Ki(I)}),i.jsx(we.Item,{label:"Совокупная залоговая стоимость объектов",children:Ki(_)}),i.jsx(we.Item,{label:"Дата первоначального определения стоимости",children:an(e.initialValuationDate)}),i.jsx(we.Item,{label:"Актуальная рыночная стоимость, руб.",children:Ki(e.currentMarketValue)}),i.jsx(we.Item,{label:"Дата определения текущей стоимости",children:an(e.currentValuationDate)})]}),i.jsxs(we,{title:"Обеспечение",bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"Тип обеспечения",children:an(e.collateralType)}),i.jsx(we.Item,{label:"Назначение обеспечения",span:2,children:an(e.collateralPurpose)}),i.jsx(we.Item,{label:"Информация о залоге",span:3,children:an(e.collateralInfo)}),i.jsx(we.Item,{label:"Местоположение предмета залога",span:2,children:an(e.collateralLocation)}),i.jsx(we.Item,{label:"Ликвидность",children:an(e.liquidity)})]})]})},{key:"objects",label:i.jsxs("span",{children:[i.jsx(ph,{}),"Объекты в договоре (",A.length,")"]}),children:i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{children:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:"Рыночная стоимость: "}),i.jsx(mt.Text,{strong:!0,style:{color:"#52c41a",fontSize:"16px"},children:Ki(I)})]}),i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:"Залоговая стоимость (с дисконтом 75%): "}),i.jsx(mt.Text,{strong:!0,style:{color:"#1890ff",fontSize:"16px"},children:Ki(_)})]})]})}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:()=>p(!0),children:"Привязать объект"})]}),l?i.jsx(Zn,{tip:"Загрузка объектов..."}):A.length>0?i.jsx(nr,{columns:R,dataSource:A,rowKey:"id",pagination:!1,size:"small"}):i.jsx(Br,{description:"Объекты по данному договору не найдены"})]})},{key:"documents",label:i.jsxs("span",{children:[i.jsx(Ao,{}),"Документы"]}),children:i.jsx("div",{children:x?i.jsx(Zn,{tip:"Загрузка документов..."}):i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:5,children:"Документы из залогового досье"}),u.length>0?i.jsx(nr,{columns:[{title:"Тип документа",dataIndex:"docType",key:"docType",render:N=>i.jsxs(Fe,{children:[i.jsx(Qr,{style:{color:"#1890ff"}}),i.jsx("span",{children:N.length>50?N.substring(0,47)+"...":N})]})},{title:"Имя файла",dataIndex:"fileName",key:"fileName",ellipsis:!0},{title:"Статус",dataIndex:"status",key:"status",render:(N,P)=>i.jsx(at,{color:P.statusColor||"default",children:N})},{title:"Размер",dataIndex:"size",key:"size"},{title:"Обновлен",dataIndex:"lastUpdated",key:"lastUpdated"},{title:"Действия",key:"actions",render:()=>i.jsx(Be,{type:"link",size:"small",icon:i.jsx(In,{}),children:"Скачать"})}],dataSource:u,rowKey:"id",pagination:{pageSize:10},size:"small"}):i.jsx(Br,{description:"Документы из залогового досье не найдены"})]}),i.jsx(jt,{}),i.jsxs("div",{children:[i.jsx(mt.Title,{level:5,children:"Залоговое заключение"}),i.jsx(Br,{description:"Залоговое заключение не найдено"})]}),i.jsx(jt,{}),i.jsxs("div",{children:[i.jsx(mt.Title,{level:5,children:"Акты осмотра"}),h.length>0?i.jsx(nr,{columns:[{title:"Дата осмотра",dataIndex:"inspectionDate",key:"inspectionDate",render:N=>new Date(N).toLocaleDateString("ru-RU")},{title:"Тип осмотра",dataIndex:"inspectionTypeLabel",key:"inspectionTypeLabel"},{title:"Инспектор",dataIndex:"inspectorName",key:"inspectorName"},{title:"Объект",dataIndex:"collateralCardName",key:"collateralCardName",ellipsis:!0},{title:"Действия",key:"actions",render:(N,P)=>i.jsxs(Fe,{children:[i.jsx(Be,{type:"link",size:"small",icon:i.jsx(Ss,{}),onClick:()=>{n(`/cms-check/inspections?inspectionId=${P.id}`),r()},children:"Просмотр"}),i.jsx(Be,{type:"link",size:"small",icon:i.jsx(In,{}),children:"Скачать PDF"})]})}],dataSource:h,rowKey:"id",pagination:{pageSize:5},size:"small"}):i.jsx(Br,{description:"Акты осмотра не найдены"})]}),i.jsx(jt,{}),A.some(N=>N.mainCategory==="real_estate")&&i.jsxs("div",{children:[i.jsx(mt.Title,{level:5,children:"Выписки ЕГРН"}),i.jsx(Br,{description:"Выписки ЕГРН не найдены"})]})]})})}];return i.jsxs(i.Fragment,{children:[i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Qr,{}),i.jsx("span",{children:"Карточка договора залога"}),i.jsx(at,{children:an(e.reference)})]}),open:t,onCancel:r,footer:[i.jsx(Be,{onClick:r,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:i.jsx(Ts,{activeKey:s,onChange:o,items:L})}),i.jsx(nz,{visible:f,onCancel:()=>p(!1),onSelect:M,excludeIds:A.map(N=>N.id)})]})},Az=.75,cz=e=>Math.floor(e*Az),lz=async e=>{try{const t=await Yt.getExtendedCards(),r=new Map;return t.forEach(n=>{const s=n.reference||n.contractNumber;if(s){const o=String(s);r.has(o)||r.set(o,[]),r.get(o).push(n)}}),e.map(n=>{const s=String(n.reference||n.contractNumber||""),o=r.get(s)||[];if(o.length===0)return n;const A=o.reduce((l,d)=>l+(d.marketValue||0),0),c=cz(A);return{...n,marketValue:A,collateralValue:c,currentMarketValue:A}})}catch(t){return console.error("Ошибка обновления портфеля:",t),e}},nd=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),E1=new Intl.NumberFormat("ru-RU",{style:"percent",maximumFractionDigits:1}),ps=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.replace(/\s/g,"").replace(",","."),r=Number(t);return Number.isFinite(r)?r:null}return null},dz={Высокая:"green",Средняя:"blue",Низкая:"orange",Малоудовлетворительная:"volcano"},uz=()=>{const e=uc(),[t,r]=K.useState(""),[a,n]=K.useState("all"),[s,o]=K.useState(null),[A,c]=K.useState(null),[l,d]=K.useState(null),[f,p]=K.useState(null),[u,g]=K.useState([]),[h,y]=K.useState(!0),[x,v]=K.useState(null),[E,D]=K.useState(null),[B,I]=K.useState(!1),[_,S]=K.useState(!1);K.useEffect(()=>{let P=!0;return(async()=>{y(!0),v(null);try{const V=(()=>{const k="./",j=new URL(k,window.location.origin),q=j.pathname.endsWith("/")?j.pathname:`${j.pathname}/`;return`${j.origin}${q}portfolioData.json`})(),ie=await fetch(`${V}?v=${Date.now()}`,{cache:"no-store"});if(!ie.ok)throw new Error(`Не удалось загрузить данные (${ie.status})`);const W=await ie.json();if(!P)return;const z=EP(W),b=(await lz(z)).map((k,j)=>({...k,key:`portfolio-${j}`,reference:k.reference!=null?String(k.reference):null,inn:k.inn!=null?String(k.inn):null,account9131:k.account9131!=null?String(k.account9131):null}));g(b)}catch(V){v(V instanceof Error?V.message:"Неизвестная ошибка"),g([])}finally{P&&y(!1)}})(),()=>{P=!1}},[]);const O=Ma.useCallback(P=>{D(P),I(!0)},[]);K.useEffect(()=>{if(u.length>0){const U=new URLSearchParams(e.search).get("q");if(U){r(U);const V=u.find(ie=>{var W,z;return String(ie.reference)===U||String(ie.contractNumber)===U||((W=String(ie.borrower))==null?void 0:W.toLowerCase().includes(U.toLowerCase()))||((z=String(ie.pledger))==null?void 0:z.toLowerCase().includes(U.toLowerCase()))});V&&setTimeout(()=>{O(V)},500)}}},[u,e.search,O]);const M=K.useMemo(()=>{const P=U=>{const V=u.map(ie=>ie[U]).filter(ie=>typeof ie=="string"&&ie.trim().length>0);return Array.from(new Set(V)).sort()};return{segments:P("segment"),groups:P("group"),liquidity:P("liquidity"),monitoring:P("monitoringType")}},[u]),T=K.useMemo(()=>{const P=t.trim().toLowerCase();return u.filter(U=>{const V=!P||[U.reference,U.pledger,U.borrower,U.collateralInfo,U.collateralLocation,U.contractNumber,U.account9131].filter(Boolean).some(b=>String(b).toLowerCase().includes(P)),ie=!s||U.segment===s,W=!A||U.group===A,z=!l||U.liquidity===l,G=!f||U.monitoringType===f;return V&&ie&&W&&z&&G})},[u,t,s,A,l,f]),R=()=>{D(null),I(!1)},L=K.useMemo(()=>{const P=T.reduce((ie,W)=>{const z=ps(W.debtRub)??0,G=ps(W.marketValue)??0,b=ps(W.collateralValue)??0,k=(ps(W.overduePrincipal)??0)+(ps(W.overdueInterest)??0);return ie.debt+=z,ie.market+=G,ie.collateral+=b,ie.overdue+=k,G>0&&(ie.ltvSamples+=1,ie.ltvSum+=Math.min(z/G,2)),ie},{debt:0,market:0,collateral:0,overdue:0,ltvSum:0,ltvSamples:0}),U=P.ltvSamples>0?P.ltvSum/P.ltvSamples:0,V=P.debt>0?P.overdue/P.debt:0;return{totalRows:T.length,totalDebt:P.debt,totalMarket:P.market,averageLtv:U,overdueShare:V}},[T]),N=K.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(P,U)=>i.jsxs("div",{children:[i.jsx("div",{className:"portfolio-page__ref",children:U.reference??"—"}),i.jsx("div",{className:"portfolio-page__muted",children:U.contractNumber??"—"}),i.jsxs("div",{className:"portfolio-page__tags",children:[U.segment&&i.jsx(at,{children:U.segment}),U.group&&i.jsx(at,{color:"geekblue",bordered:!1,children:U.group})]})]})},{title:"Компании",key:"company",width:260,render:(P,U)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:U.pledger??"—"}),i.jsxs("div",{className:"portfolio-page__muted",children:["Заемщик: ",U.borrower??"—"]}),U.inn&&i.jsxs("div",{className:"portfolio-page__muted",children:["ИНН: ",i.jsx(mt.Text,{code:!0,children:U.inn})]})]})},{title:"Показатели",key:"metrics",width:240,render:(P,U)=>{const V=ps(U.debtRub),ie=ps(U.limitRub),W=ps(U.marketValue),z=V&&W?Math.min(V/W,2):null;return i.jsxs("div",{className:"portfolio-page__metrics",children:[i.jsxs("div",{className:"portfolio-page__metrics-row",children:[i.jsx("span",{children:"Задолженность"}),i.jsx("strong",{children:V?nd.format(V):"—"})]}),i.jsxs("div",{className:"portfolio-page__metrics-row",children:[i.jsx("span",{children:"Лимит"}),i.jsx("strong",{children:ie?nd.format(ie):"—"})]}),i.jsxs("div",{className:"portfolio-page__metrics-row",children:[i.jsx("span",{children:"LTV"}),i.jsx("strong",{children:z!==null?i.jsx(at,{color:z>.8?"red":z>.7?"orange":"green",children:E1.format(z)}):"—"})]})]})}},{title:"Обеспечение",key:"collateral",width:300,render:(P,U)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:U.collateralType??U.collateralCategory??"—"}),U.collateralPurpose&&i.jsx("div",{className:"portfolio-page__muted",children:U.collateralPurpose}),i.jsx("div",{className:"portfolio-page__divider"}),i.jsxs("div",{className:"portfolio-page__metrics",children:[i.jsxs("div",{className:"portfolio-page__metrics-row",children:[i.jsx("span",{children:"Рыночная стоимость"}),i.jsx("strong",{children:ps(U.marketValue)?nd.format(ps(U.marketValue)):"—"})]}),i.jsxs("div",{className:"portfolio-page__metrics-row",children:[i.jsx("span",{children:"Залоговая стоимость"}),i.jsx("strong",{children:ps(U.collateralValue)?nd.format(ps(U.collateralValue)):"—"})]})]}),U.collateralLocation&&i.jsxs("div",{style:{marginTop:6},children:[i.jsx(tA,{style:{color:"#8c8c8c",marginRight:4}}),i.jsx(mt.Text,{children:U.collateralLocation})]})]})},{title:"Мониторинг",key:"monitoring",width:220,render:(P,U)=>i.jsxs(Fe,{direction:"vertical",size:6,style:{width:"100%"},children:[i.jsxs("div",{children:[U.liquidity&&i.jsx(at,{color:dz[U.liquidity]||"default",children:U.liquidity}),U.qualityCategory&&i.jsx(at,{children:U.qualityCategory})]}),i.jsxs("div",{className:"portfolio-page__muted",children:["Вид мониторинга: ",i.jsx("strong",{children:U.monitoringType??"—"})]}),i.jsxs("div",{className:"portfolio-page__muted",children:["Последний: ",U.lastMonitoringDate??"—"]}),i.jsxs("div",{className:"portfolio-page__muted",children:["План: ",U.nextMonitoringDate??"—"]})]})},{title:"Ответственный",key:"owner",width:180,render:(P,U)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:U.owner??"Не назначен"}),U.account9131&&i.jsxs("div",{className:"portfolio-page__muted",children:["9131: ",i.jsx(mt.Text,{code:!0,children:U.account9131})]})]})}],[]);return i.jsxs("div",{className:"portfolio-page",children:[i.jsxs("div",{className:"portfolio-page__header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"portfolio-page__title",children:"Залоговый портфель"}),i.jsx(mt.Paragraph,{className:"portfolio-page__subtitle",children:"Актуальные данные из реестра и дополнительно 100 демо-записей для моделирования сценариев"})]}),i.jsxs(Fe,{size:"middle",children:[i.jsxs(Fe.Compact,{style:{width:500},children:[i.jsx(Ye,{value:a,onChange:n,style:{width:200},options:[{label:"Все поля",value:"all"},{label:"ИНН",value:"inn"},{label:"Залогодатель",value:"pledger"},{label:"Заемщик",value:"borrower"},{label:"REFERENCE залога",value:"reference"},{label:"Номер договора залога (ипотеки)",value:"contractNumber"},{label:"№ договора (9131)",value:"account9131"}]}),i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Введите значение для поиска",prefix:i.jsx(Pa,{}),value:t,onChange:P=>r(P.target.value),style:{flex:1}})]}),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),onClick:()=>{const P=["REFERENCE","Номер договора","Залогодатель","Заемщик","ИНН","Тип залога","Стоимость залога","Задолженность","Сегмент","Группа"],U=T.map(G=>[G.reference||"",G.contractNumber||"",G.pledger||"",G.borrower||"",G.inn||"",G.collateralType||"",G.collateralValue||"",G.debtRub||"",G.segment||"",G.group||""]),V=[P.join("	"),...U.map(G=>G.join("	"))].join(`
`),ie=new Blob(["\uFEFF"+V],{type:"text/csv;charset=utf-8;"}),W=document.createElement("a"),z=URL.createObjectURL(ie);W.setAttribute("href",z),W.setAttribute("download",`Залоговый_портфель_${new Date().toISOString().split("T")[0]}.xls`),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W)},children:"Выгрузить в EXCEL"})]})]}),i.jsx(Ge,{children:i.jsxs("div",{className:"portfolio-page__filters",children:[i.jsx(Ye,{allowClear:!0,placeholder:"Сегмент",style:{width:180},options:M.segments.map(P=>({label:P,value:P})),value:s??void 0,onChange:P=>o(P??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Группа",style:{width:180},options:M.groups.map(P=>({label:P,value:P})),value:A??void 0,onChange:P=>c(P??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Ликвидность",style:{width:180},options:M.liquidity.map(P=>({label:P,value:P})),value:l??void 0,onChange:P=>d(P??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Вид мониторинга",style:{width:220},options:M.monitoring.map(P=>({label:P,value:P})),value:f??void 0,onChange:P=>p(P??null)})]})}),i.jsxs(ft,{gutter:[16,16],className:"portfolio-page__stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{className:"portfolio-page__card",children:i.jsx(yt,{title:"Количество договоров",value:L.totalRows,prefix:i.jsx(rl,{}),valueStyle:{color:"#1d39c4"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{className:"portfolio-page__card",children:i.jsx(yt,{title:"Совокупная задолженность",value:nd.format(L.totalDebt)})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{className:"portfolio-page__card",children:i.jsx(yt,{title:"Рыночная стоимость",value:nd.format(L.totalMarket),valueStyle:{color:"#52c41a"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{className:"portfolio-page__card",children:i.jsx(yt,{title:"Средний LTV / Просрочка",valueRender:()=>i.jsxs("div",{children:[i.jsx("div",{children:E1.format(L.averageLtv||0)}),i.jsxs("div",{className:"portfolio-page__muted",children:["просрочка ",E1.format(L.overdueShare||0)]})]})})})})]}),i.jsx(Ge,{className:"portfolio-page__table-card",bodyStyle:{padding:0},children:i.jsx(nr,{columns:N,dataSource:T,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:h,onRow:P=>({onDoubleClick:()=>O(P)}),locale:{emptyText:i.jsx(Br,{description:"Нет записей, удовлетворяющих фильтрам",className:"portfolio-page__empty"})}})}),x&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные залогов",description:x,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),h&&i.jsx("div",{style:{textAlign:"center"},children:i.jsx(Zn,{tip:"Загружаем данные залогов..."})}),E&&i.jsx(oz,{contract:E,visible:B,onClose:R,onUpdate:P=>{g(U=>U.map(V=>V.reference===P.reference||V.contractNumber===P.contractNumber?{...V,...P,key:V.key}:V)),D({...P,key:(E==null?void 0:E.key)||`portfolio-${Date.now()}`})}}),i.jsx(JG,{visible:_,deal:E,onCancel:()=>S(!1),onSuccess:()=>{}})]})},fz=()=>{const[e,t]=K.useState([]),[r,a]=K.useState([]),[n,s]=K.useState(""),[o,A]=K.useState(null),[c,l]=K.useState(null),[d,f]=K.useState(null),[p,u]=K.useState(null),[g,h]=K.useState([]),[y,x]=K.useState(!0),[v,E]=K.useState(null),[D,B]=K.useState(!1),[I,_]=K.useState([]),[S,O]=K.useState(""),M=K.useMemo(()=>{const k=new Map,j=new Map;return e.forEach(q=>{const Y=String(q.reference||"");j.has(Y)||j.set(Y,[]),j.get(Y).push(q)}),r.forEach(q=>{const Y=q.borrower||"Не указан",de=q.contractNumber||`Договор ${q.reference||"без номера"}`,ue=q.pledger||"Не указан",pe=q.collateralContractNumber||`Договор залога ${q.reference||"без номера"}`,ye=String(q.reference||""),ve=j.get(ye)||[];if(ve.length>0){const ae=`client-${Y}-loan-${de}-pledger-${ue}-pledge-${pe}`;k.set(ae,{docs:ve,title:`Документы по договору залога: ${pe}`})}}),k},[r,e]);K.useEffect(()=>{let k=!0;return(async()=>{x(!0),E(null);try{const q=(()=>{const pe="./",ye=new URL(pe,window.location.origin),ve=ye.pathname.endsWith("/")?ye.pathname:`${ye.pathname}/`;return`${ye.origin}${ve}portfolioData.json`})(),Y=await fetch(`${q}?v=${Date.now()}`,{cache:"no-store"});let de=[];Y.ok&&(de=await Y.json());const ue=await Yt.getExtendedCards();try{const pe=await YB(de,ue);if(!k)return;a(de),t(pe.documents),localStorage.setItem("collateralDossierData",JSON.stringify(pe))}catch(pe){console.warn("Ошибка генерации демо-данных, используем сохраненные:",pe);const ye=localStorage.getItem("collateralDossierData");if(ye){const ve=JSON.parse(ye);a(de),t(ve.documents)}else a(de),t([])}}catch(q){try{const Y=localStorage.getItem("collateralDossierData");if(Y){const de=JSON.parse(Y);t(de.documents)}else throw q}catch{E(q instanceof Error?q.message:"Неизвестная ошибка")}}finally{k&&x(!1)}})(),()=>{k=!1}},[]);const T=K.useMemo(()=>{const k=new Map;return e.forEach(j=>{const q=String(j.reference||"");k.has(q)||k.set(q,[]),k.get(q).push(j)}),k},[e]),R=K.useMemo(()=>{const k=new Set,j=new Set,q=new Set,Y=new Set,de=new Set;for(const ue of r)ue.borrower&&k.add(ue.borrower),ue.contractNumber&&j.add(ue.contractNumber),ue.pledger&&q.add(ue.pledger),ue.collateralContractNumber&&Y.add(ue.collateralContractNumber);for(const ue of e)ue.status&&de.add(ue.status);return{clients:Array.from(k).sort(),loanContracts:Array.from(j).sort(),pledgers:Array.from(q).sort(),pledgeContracts:Array.from(Y).sort(),statuses:Array.from(de).sort()}},[r,e]),L=K.useCallback(k=>k.length>30?k.substring(0,27)+"...":k,[]),N=K.useCallback(k=>({key:k.id||`${k.folderId}-${k.fileName}`,title:i.jsx(Xr,{title:k.docType,children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 0"},children:[i.jsx(Qr,{style:{color:"#1890ff"}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontWeight:500},children:L(k.docType)}),i.jsx("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:k.fileName}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:4},children:[i.jsx(at,{color:k.statusColor||"default",style:{margin:0},children:k.status}),i.jsxs("span",{style:{fontSize:"12px",color:"#8c8c8c"},children:[k.size," • ",k.lastUpdated]})]})]})]})}),isLeaf:!0,icon:i.jsx(Qr,{})}),[L]),P=K.useMemo(()=>{const k=n.trim().toLowerCase(),j=k.length>0,q=new Map;for(const de of r){const ue=de.borrower||"Не указан",pe=de.contractNumber||`Договор ${de.reference||"без номера"}`,ye=de.pledger||"Не указан",ve=de.collateralContractNumber||`Договор залога ${de.reference||"без номера"}`,ae=String(de.reference||""),Ke=T.get(ae)||[];if(o&&ue!==o||c&&pe!==c||d&&ye!==d||p&&ve!==p)continue;if(j){const He=ue.toLowerCase(),Ze=pe.toLowerCase(),$e=ye.toLowerCase(),et=ve.toLowerCase();let je=He.includes(k)||Ze.includes(k)||$e.includes(k)||et.includes(k);if(je||(je=Ke.some(_e=>_e.docType.toLowerCase().includes(k)||_e.fileName.toLowerCase().includes(k))),!je)continue}q.has(ue)||q.set(ue,new Map);const Ee=q.get(ue);Ee.has(pe)||Ee.set(pe,new Map);const me=Ee.get(pe);me.has(ye)||me.set(ye,new Map);const le=me.get(ye);if(!le.has(ve))le.set(ve,Ke);else{const He=le.get(ve);le.set(ve,[...He,...Ke])}}return Array.from(q.entries()).map(([de,ue])=>{const pe=`client-${de}`,ye=Array.from(ue.entries()).map(([ve,ae])=>{const Ke=`${pe}-loan-${ve}`,Ee=Array.from(ae.entries()).map(([me,le])=>{const He=`${Ke}-pledger-${me}`,Ze=Array.from(le.entries()).map(([$e,et])=>{const je=`${He}-pledge-${$e}`,_e=et.map(lt=>N(lt));return{key:je,title:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Ao,{style:{color:"#faad14"}}),i.jsxs("span",{style:{fontWeight:500},children:["Договор залога: ",$e]}),i.jsxs(at,{color:"blue",style:{margin:0},children:[et.length," документов"]})]}),children:_e.length>0?_e:void 0,icon:i.jsx(Ao,{})}});return{key:He,title:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Ao,{style:{color:"#52c41a"}}),i.jsxs("span",{style:{fontWeight:500},children:["Залогодатель: ",me]})]}),children:Ze,icon:i.jsx(Ao,{})}});return{key:Ke,title:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Ao,{style:{color:"#722ed1"}}),i.jsxs("span",{style:{fontWeight:500},children:["Кредитный договор: ",ve]})]}),children:Ee,icon:i.jsx(Ao,{})}});return{key:pe,title:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Ao,{style:{color:"#eb2f96"}}),i.jsxs("span",{style:{fontWeight:600,fontSize:"15px"},children:["Клиент: ",de]})]}),children:ye,icon:i.jsx(Ao,{})}})},[r,T,n,o,c,d,p,N]);K.useEffect(()=>{if(P.length>0&&g.length===0){const k=P.map(j=>j.key);h(k)}},[P,g.length]);const U=K.useCallback(k=>{h(k)},[]),V=K.useCallback(k=>{const j=k[0];if(!(!j||typeof j!="string")&&j.includes("-pledge-")&&!j.includes("-doc-")){const q=M.get(j);q&&q.docs.length>0&&(O(q.title),_(q.docs),B(!0))}},[M]),ie=K.useMemo(()=>{const k=new Set;for(const j of r)(!o||j.borrower===o)&&j.contractNumber&&k.add(j.contractNumber);return Array.from(k).sort().map(j=>i.jsx(Ye.Option,{value:j,label:j,children:j},j))},[r,o]),W=K.useMemo(()=>{const k=new Set;for(const j of r)o&&j.borrower!==o||c&&j.contractNumber!==c||j.pledger&&k.add(j.pledger);return Array.from(k).sort().map(j=>i.jsx(Ye.Option,{value:j,label:j,children:j},j))},[r,o,c]),z=K.useMemo(()=>{const k=new Set;for(const j of r)o&&j.borrower!==o||c&&j.contractNumber!==c||d&&j.pledger!==d||j.collateralContractNumber&&k.add(j.collateralContractNumber);return Array.from(k).sort().map(j=>i.jsx(Ye.Option,{value:j,label:j,children:j},j))},[r,o,c,d]),G=K.useMemo(()=>[{title:"Тип документа",dataIndex:"docType",key:"docType",width:200,render:(k,j)=>i.jsx(Xr,{title:j.docType,children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Qr,{style:{color:"#1890ff"}}),i.jsx("span",{children:L(k)})]})})},{title:"Имя файла",dataIndex:"fileName",key:"fileName",ellipsis:!0},{title:"Статус",dataIndex:"status",key:"status",width:150,render:(k,j)=>i.jsx(at,{color:j.statusColor||"default",children:k})},{title:"Размер",dataIndex:"size",key:"size",width:100},{title:"Обновлен",dataIndex:"lastUpdated",key:"lastUpdated",width:120},{title:"Действия",key:"actions",width:100,render:(k,j)=>i.jsx(Xr,{title:"Скачать документ",children:i.jsx(In,{style:{fontSize:16,color:"#1890ff",cursor:"pointer"},onClick:()=>{console.log("Download:",j)}})})}],[L]),b=K.useMemo(()=>{let k=0,j=0;for(const Y of e)Y.status==="Загружен"?k++:Y.status==="На согласовании"&&j++;const q=e.length;return{totalDocs:q,completed:k,pending:j,completionRate:q?Math.round(k/q*100):0}},[e]);return i.jsxs("div",{className:"collateral-dossier",children:[i.jsx("div",{className:"collateral-dossier__header",children:i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"collateral-dossier__title",children:"Залоговое досье"}),i.jsx(mt.Paragraph,{className:"collateral-dossier__subtitle",children:"Документооборот по сделкам залогового портфеля: заключения, отчеты об оценке, мониторинги, фотофиксация и регистраторы."})]})}),i.jsx(Ge,{style:{marginBottom:16},children:i.jsxs(Fe,{size:"middle",wrap:!0,style:{width:"100%"},children:[i.jsx(Xr,{title:"Поиск по клиенту, договору, залогодателю или документу",children:i.jsx(Re,{allowClear:!0,placeholder:"Поиск...",prefix:i.jsx(Pa,{}),value:n,onChange:k=>s(k.target.value),style:{minWidth:250}})}),i.jsx(Ye,{allowClear:!0,placeholder:"Клиент",style:{minWidth:200},value:o,onChange:k=>{A(k),k||(l(null),f(null),u(null))},showSearch:!0,filterOption:(k,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(k.toLowerCase()),children:R.clients.map(k=>i.jsx(Ye.Option,{value:k,label:k,children:k},k))}),i.jsx(Ye,{allowClear:!0,placeholder:"Кредитный договор",style:{minWidth:200},value:c,onChange:k=>{l(k),k||(f(null),u(null))},showSearch:!0,filterOption:(k,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(k.toLowerCase()),disabled:!o,loading:y,children:ie}),i.jsx(Ye,{allowClear:!0,placeholder:"Залогодатель",style:{minWidth:200},value:d,onChange:k=>{f(k),k||u(null)},showSearch:!0,filterOption:(k,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(k.toLowerCase()),disabled:!c,loading:y,children:W}),i.jsx(Ye,{allowClear:!0,placeholder:"Договор залога",style:{minWidth:200},value:p,onChange:u,showSearch:!0,filterOption:(k,j)=>String((j==null?void 0:j.label)??"").toLowerCase().includes(k.toLowerCase()),disabled:!d,loading:y,children:z})]})}),i.jsxs(ft,{gutter:[16,16],style:{marginBottom:16},children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего документов",value:b.totalDocs})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Загружено",value:b.completed,valueStyle:{color:"#52c41a"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"На согласовании",value:b.pending,valueStyle:{color:"#fa8c16"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Готовность досье",value:`${b.completionRate}%`,valueStyle:{color:"#1677ff"}})})})]}),i.jsx(Ge,{children:v?i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить досье",description:v,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}):y?i.jsx(Br,{description:"Загрузка..."}):P.length===0?i.jsx(Br,{description:"Нет документов"}):i.jsx(NT,{showLine:{showLeafIcon:!1},showIcon:!0,expandedKeys:g,onExpand:U,onSelect:V,treeData:P,style:{fontSize:"14px"},virtual:!1,blockNode:!0})}),i.jsx(dr,{title:S,open:D,onCancel:()=>B(!1),footer:null,width:1e3,destroyOnClose:!0,children:i.jsx(nr,{columns:G,dataSource:I,rowKey:k=>k.id||`${k.folderId}-${k.fileName}`,pagination:{pageSize:10,showSizeChanger:!0,showTotal:k=>`Всего документов: ${k}`},size:"middle"})})]})};var WB={exports:{}};(function(e,t){(function(r,a){e.exports=a()})(iT,function(){return function(r,a,n){r=r||{};var s=a.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function A(l,d,f,p){return s.fromToBase(l,d,f,p)}n.en.relativeTime=o,s.fromToBase=function(l,d,f,p,u){for(var g,h,y,x=f.$locale().relativeTime||o,v=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],E=v.length,D=0;D<E;D+=1){var B=v[D];B.d&&(g=p?n(l).diff(f,B.d,!0):f.diff(l,B.d,!0));var I=(r.rounding||Math.round)(Math.abs(g));if(y=g>0,I<=B.r||!B.r){I<=1&&D>0&&(B=v[D-1]);var _=x[B.l];u&&(I=u(""+I)),h=typeof _=="string"?_.replace("%d",I):_(I,d,B.l,y);break}}if(d)return h;var S=y?x.future:x.past;return typeof S=="function"?S(h):S.replace("%s",h)},s.to=function(l,d){return A(l,d,this,!0)},s.from=function(l,d){return A(l,d,this)};var c=function(l){return l.$u?n.utc():n()};s.toNow=function(l){return this.to(c(this),l)},s.fromNow=function(l){return this.from(c(this),l)}}})})(WB);var pz=WB.exports;const hz=XE(pz),Vo=[{key:"collateralName",label:"Наименование, назначение",type:"text",required:!0,placeholder:"Наименование имущества",group:"Основная информация"},{key:"collateralLocation",label:"Адрес местоположения",type:"text",required:!0,placeholder:"Адрес местоположения",group:"Основная информация"},{key:"ownershipShare",label:"Оцениваемые права, доля в праве %",type:"number",min:0,max:100,unit:"%",group:"Основная информация"},{key:"marketValue",label:"Рыночная стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"collateralValue",label:"Залоговая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"fairValue",label:"Справедливая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"category",label:"Категория обеспечения",type:"select",options:["Основной","Формальный"],group:"Характеристики"},{key:"liquidity",label:"Ликвидность",type:"select",options:["высокая (срок реализации до 90 дней)","удовлетворительная (срок реализации до 365 дней)","низкая (срок реализации свыше 365 дней)","малоудовлетворительная"],group:"Характеристики"},{key:"collateralCondition",label:"Состояние имущества",type:"select",options:["хорошее","удовлетворительное","неудовлетворительное"],group:"Характеристики"}],Mm=[...Vo,{key:"totalAreaSqm",label:"Общая площадь объекта, кв. м. (или протяженность и т.п. в соответствующих единицах измерения) Только цифры",type:"number",required:!0,min:0,unit:"кв.м",group:"Параметры объекта"},{key:"objectCadastralNumber",label:"Кадастровый номер объекта",type:"text",placeholder:"23:49:0303008:1915",group:"Параметры объекта"},{key:"landCadastralNumber",label:"Кадастровый номер земельного участка",type:"text",placeholder:"23:49:0303008:1915",group:"Земельный участок"},{key:"landCategory",label:"Категория земель",type:"select",options:["Земли водного фонда","Земли запаса","Земли лесного фонда","Земли населенных пунктов","Земли особоохраняемых территорий и","Земли промышленности, энергетики, тр","Земли сельскохозяйственного назначен","Категория не установлена","-"],group:"Земельный участок"},{key:"landPermittedUse",label:"Вид разрешенного использования земельного участка (только по земельным участкам)",type:"text",placeholder:"Вид разрешенного использования земельного участка",group:"Земельный участок"},{key:"structureType",label:"Тип строения/Категория участка",type:"text",placeholder:"Тип строения или категория участка",group:"Параметры объекта"},{key:"landAreaSqm",label:"Площадь земельного участка",type:"number",min:0,unit:"кв.м",group:"Земельный участок"},{key:"cadastralValue",label:"Кадастровая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"bookValue",label:"Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"marketValuePerSqm",label:"Рыночная стоимость за кв.м",type:"number",min:0,unit:"руб./кв.м",group:"Оценка"},{key:"buildYear",label:"Год строительства",type:"number",min:1800,max:new Date().getFullYear(),group:"Параметры объекта"},{key:"hasReplanning",label:"Наличие перепланировок",type:"boolean",group:"Состояние"},{key:"hasEncumbrances",label:"Наличие обременений",type:"boolean",group:"Состояние"},{key:"encumbrancesDescription",label:"Описание обременений",type:"textarea",placeholder:"Описание зарегистрированных обременений",group:"Состояние"}],Hp=[...Mm,{key:"livingArea",label:"Жилая площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"kitchenArea",label:"Площадь кухни",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"roomsCount",label:"Количество комнат",type:"number",min:1,group:"Параметры объекта"},{key:"floor",label:"Этаж",type:"number",min:1,group:"Параметры объекта"},{key:"totalFloors",label:"Этажность дома",type:"number",min:1,group:"Параметры объекта"},{key:"ceilingHeight",label:"Высота потолков",type:"number",min:2,max:6,unit:"м",group:"Параметры объекта"},{key:"wallMaterial",label:"Материал стен",type:"select",options:["Кирпич","Панель","Монолит","Блочный","Дерево","Кирпичный/Сталинский","Пенобетонные/Газобетонное блоки"],group:"Параметры объекта"},{key:"separateBathrooms",label:"Количество санузлов",type:"number",min:0,group:"Параметры объекта"},{key:"balcony",label:"Наличие балкона/лоджии",type:"boolean",group:"Параметры объекта"}],RA=[...Mm,{key:"floor",label:"Этаж",type:"number",min:-2,group:"Параметры объекта"},{key:"totalFloors",label:"Этажность здания",type:"number",min:1,group:"Параметры объекта"},{key:"ceilingHeight",label:"Высота потолков",type:"number",min:2.5,max:20,unit:"м",group:"Параметры объекта"},{key:"buildingClass",label:"Класс здания",type:"select",options:["A+","A","B+","B","C"],group:"Параметры объекта"},{key:"structureClass",label:"Класс сооружения",type:"select",options:["A+","A","B+","B","C","D"],group:"Параметры объекта"},{key:"wallMaterial",label:"Материал стен",type:"select",options:["Деревянные","Кирпич","Кирпичный/Сталинский","Металлические без утепления","Монолит/Монолит-кирпич","Панельный/блочный","Пенобетонные/Газобетонное блоки","Сэндвич панели","-"],group:"Параметры объекта"},{key:"ceilingMaterial",label:"Материал перекрытий",type:"select",options:["Деревянные балки","Металлические балки","ж/б","-"],group:"Параметры объекта"},{key:"structuralCondition",label:"Состояние конструктивных элементов здания (Общ. тех. сост. здания)",type:"select",options:["Хорошее","Удовлетворительное","Неудовлетворительное","Требует ремонта"],group:"Состояние"},{key:"finishLevel",label:"Тип отделки",type:"select",options:["Евроремонт","Неизвестно","Простая","Среднее","Требуется кап. ремонт/Без отделки","Улучшенная","-"],group:"Состояние"},{key:"finishCondition",label:"Состояние отделки",type:"select",options:["Без отделки","Требуется кап.ремонт","Требуется косметический ремонт","Удовлетворительное","Хорошее","-"],group:"Состояние"},{key:"hasElectricity",label:"Электричество",type:"boolean",group:"Коммуникации"},{key:"hasWaterSupply",label:"Водоснабжение",type:"boolean",group:"Коммуникации"},{key:"hasSewerage",label:"Канализация",type:"boolean",group:"Коммуникации"},{key:"hasGasSupply",label:"Газоснабжение",type:"boolean",group:"Коммуникации"},{key:"hasSecurityAlarm",label:"Охранная сигнализация",type:"boolean",group:"Безопасность"},{key:"hasFireAlarm",label:"Пожарная сигнализация",type:"boolean",group:"Безопасность"},{key:"hasVideoSurveillance",label:"Видеонаблюдение",type:"boolean",group:"Безопасность"},{key:"replanning",label:"Тип перепланировки",type:"select",options:["Несущественные","Перепланировки отсутствуют","Существенные","-"],group:"Состояние"},{key:"landPermittedUse",label:"Вид разрешенного использования земельного участка",type:"text",placeholder:"Вид разрешенного использования",group:"Земельный участок"},{key:"ownershipRight",label:"Вид права",type:"select",options:["Иное","Право аренды","Право собственности"],group:"Права"},{key:"leaseExpirationDate",label:"Дата окончания срока аренды объекта недвижимости",type:"date",group:"Права"},{key:"ownershipShare",label:"Размер доли в праве",type:"text",placeholder:"Например: 1/1, 1/2, 1/3",group:"Права",description:"Указывается в виде дроби, например: 1/1, 1/2, 1/3"},{key:"isUnfinishedConstruction",label:"Объект незавершенного строительства",type:"boolean",group:"Права"},{key:"ownershipBasis",label:"Право, на основании которого объект принадлежит Залогодателю/документы-основания возникновения права",type:"textarea",placeholder:"Например: Право собственности, на основании следующих документов: Договор купли-продажи",group:"Права"},{key:"technicalDocument",label:"Документ, отражающий технические характеристики объекта",type:"select",options:["Выписка из Единого государственного реестра недвижимости об объекте","Технический паспорт","Техническое заключение","Проектная документация","Иной документ"],group:"Документы"},{key:"hasEncumbrances",label:"Наличие обременений (аренда и т.п.)",type:"boolean",group:"Права"},{key:"encumbrancesDescription",label:"Описание обременений",type:"textarea",placeholder:"Описание зарегистрированных обременений",group:"Права"},{key:"bookValue",label:"Балансовая стоимость на последнюю отчетную дату, руб. без учета НДС",type:"number",min:0,unit:"руб.",group:"Оценка"},{key:"comment",label:"Комментарий",type:"textarea",placeholder:"Дополнительные комментарии",group:"Дополнительно"},{key:"parking",label:"Наличие парковки",type:"boolean",group:"Инфраструктура"},{key:"parkingSpaces",label:"Количество машиномест",type:"number",min:0,group:"Инфраструктура"}],mz=[...RA,{key:"storageArea",label:"Площадь хранения",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"warehouseClass",label:"Класс склада",type:"select",options:["A","A+","B","B+","C","D"],group:"Параметры объекта"},{key:"gates",label:"Тип ворот",type:"select",options:["Докового типа","На нулевой отметке","Смешанные"],group:"Параметры объекта"},{key:"gatesCount",label:"Количество ворот",type:"number",min:0,group:"Параметры объекта"},{key:"flooring",label:"Покрытие пола",type:"select",options:["Бетон","Асфальт","Полимер","Плитка"],group:"Параметры объекта"},{key:"loadCapacity",label:"Нагрузка на пол",type:"number",min:0,unit:"тонн/кв.м",group:"Параметры объекта"},{key:"heating",label:"Отопление",type:"boolean",group:"Инфраструктура"},{key:"ramp",label:"Наличие рампы",type:"boolean",group:"Инфраструктура"}],gz=[...Mm,{key:"landArea",label:"Площадь участка",type:"number",required:!0,min:0,unit:"кв.м",group:"Параметры объекта"},{key:"buildingArea",label:"Площадь здания",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"dispensersCount",label:"Количество ТРК",type:"number",required:!0,min:1,group:"Параметры объекта"},{key:"tanksVolume",label:"Объем резервуаров",type:"number",min:0,unit:"куб.м",group:"Параметры объекта"},{key:"fuelTypes",label:"Количество видов топлива",type:"number",min:1,group:"Параметры объекта"},{key:"carWash",label:"Наличие автомойки",type:"boolean",group:"Инфраструктура"},{key:"shop",label:"Наличие магазина",type:"boolean",group:"Инфраструктура"},{key:"cafe",label:"Наличие кафе",type:"boolean",group:"Инфраструктура"}],i2=[...Vo,{key:"brand",label:"Марка ТС",type:"text",required:!0,placeholder:"Марка транспортного средства",group:"Основная информация"},{key:"model",label:"Модель",type:"text",required:!0,placeholder:"Модель транспортного средства",group:"Основная информация"},{key:"year",label:"Год выпуска",type:"number",required:!0,min:1900,max:new Date().getFullYear(),group:"Основная информация"},{key:"vin",label:"Идентификационный номер (VIN)",type:"text",placeholder:"VIN номер",group:"Основная информация"},{key:"registrationNumber",label:"Государственный регистрационный номер",type:"text",placeholder:"A777AA92",group:"Основная информация"},{key:"engineVolume",label:"Объем двигателя",type:"number",min:0,unit:"куб.см",group:"Технические характеристики"},{key:"enginePower",label:"Мощность двигателя",type:"number",min:0,unit:"л.с.",group:"Технические характеристики"},{key:"enginePowerKw",label:"Мощность двигателя",type:"number",min:0,unit:"кВт",group:"Технические характеристики"},{key:"fuelType",label:"Тип топлива",type:"select",options:["Бензин","Дизель","Гибрид","Электро","Газ"],group:"Технические характеристики"},{key:"transmission",label:"Коробка передач",type:"select",options:["Механическая","Автоматическая","Робот","Вариатор"],group:"Технические характеристики"},{key:"mileage",label:"Показания одометра",type:"number",min:0,unit:"км",group:"Технические характеристики"},{key:"color",label:"Цвет",type:"text",group:"Технические характеристики"},{key:"bodyNumber",label:"Номер кузова",type:"text",group:"Технические характеристики"},{key:"chassisNumber",label:"Номер шасси",type:"text",group:"Технические характеристики"},{key:"frameNumber",label:"Заводской номер машины (рамы)",type:"text",group:"Технические характеристики"}],xz=[...i2,{key:"loadCapacity",label:"Грузоподъемность",type:"number",required:!0,min:0,unit:"т",group:"Технические характеристики"},{key:"bodyType",label:"Тип кузова",type:"select",options:["Бортовой","Тентованный","Рефрижератор","Самосвал","Фургон","Прицепы/полуприцепы"],group:"Технические характеристики"}],_1=[...Vo,{key:"name",label:"Наименование",type:"text",required:!0,placeholder:"Наименование оборудования",group:"Основная информация"},{key:"manufacturer",label:"Предприятие - изготовитель",type:"text",placeholder:"Производитель",group:"Основная информация"},{key:"model",label:"Модель",type:"text",placeholder:"Модель оборудования",group:"Основная информация"},{key:"year",label:"Год выпуска",type:"number",min:1900,max:new Date().getFullYear(),group:"Основная информация"},{key:"serialNumber",label:"Заводской номер",type:"text",placeholder:"Серийный номер",group:"Основная информация"},{key:"inventoryNumber",label:"Инвентарный номер",type:"text",group:"Основная информация"},{key:"type",label:"Тип техники",type:"text",placeholder:"Тип техники",group:"Основная информация"},{key:"power",label:"Мощность",type:"number",min:0,unit:"кВт",group:"Технические характеристики"},{key:"operatingHours",label:"Наработка (при наличии)",type:"number",min:0,unit:"моточасов",group:"Технические характеристики"},{key:"country",label:"Страна - изготовитель",type:"text",group:"Основная информация"},{key:"balanceValue",label:"Остаточная балансовая стоимость",type:"number",min:0,unit:"руб.",group:"Оценка"}],yz={apartment:Hp,room:Hp,house:Hp,townhouse:Hp,land_residential:[...Vo,{key:"totalAreaHectares",label:"Общая площадь",type:"number",required:!0,min:0,unit:"сот.",group:"Параметры объекта"},{key:"landCadastralNumber",label:"Кадастровый номер",type:"text",required:!0,placeholder:"23:49:0303008:1915",group:"Основная информация"},{key:"landCategory",label:"Категория земель",type:"select",required:!0,options:["земли населенных пунктов","земли сельскохозяйственного назначения","земли промышленности","земли особо охраняемых территорий"],group:"Основная информация"},{key:"landPermittedUse",label:"Разрешенный вид использования",type:"text",required:!0,placeholder:"Вид разрешенного использования",group:"Основная информация"},{key:"utilities",label:"Коммуникации",type:"select",options:["Все","Частично","Отсутствуют"],group:"Инфраструктура"}],office:RA,retail:[...RA,{key:"tradingArea",label:"Торговая площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"showcaseLength",label:"Длина витрины",type:"number",min:0,unit:"м",group:"Параметры объекта"},{key:"entrance",label:"Вход",type:"select",options:["Отдельный","Общий"],group:"Параметры объекта"}],warehouse:mz,hotel:[...RA,{key:"roomsCount",label:"Количество номеров",type:"number",required:!0,min:1,group:"Параметры объекта"},{key:"category",label:"Категория",type:"select",options:["Без категории","1 звезда","2 звезды","3 звезды","4 звезды","5 звезд"],group:"Параметры объекта"},{key:"restaurant",label:"Наличие ресторана",type:"boolean",group:"Инфраструктура"}],catering:[...RA,{key:"hallArea",label:"Площадь зала",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"seatingCapacity",label:"Количество посадочных мест",type:"number",min:0,group:"Параметры объекта"},{key:"kitchen",label:"Наличие кухни",type:"boolean",group:"Параметры объекта"}],gas_station:gz,car_dealership:[...RA,{key:"showroomArea",label:"Площадь шоурума",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"serviceArea",label:"Площадь СТО",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"liftCapacity",label:"Количество подъемников",type:"number",min:0,group:"Параметры объекта"}],industrial_building:[...RA,{key:"productionArea",label:"Производственная площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"craneway",label:"Наличие кран-балки",type:"boolean",group:"Параметры объекта"},{key:"craneCapacity",label:"Грузоподъемность кран-балки",type:"number",min:0,unit:"т",group:"Параметры объекта"},{key:"power",label:"Электрическая мощность",type:"number",min:0,unit:"кВт",group:"Инфраструктура"}],workshop:[...RA,{key:"productionArea",label:"Производственная площадь",type:"number",min:0,unit:"кв.м",group:"Параметры объекта"},{key:"specialization",label:"Специализация цеха",type:"text",group:"Параметры объекта"}],car_passenger:i2,car_truck:xz,equipment:_1,machinery:_1,Недвижимость:Mm,"Транспортные средства":i2,Оборудование:_1,"Товары в обороте":[...Vo,{key:"quantity",label:"Количество",type:"number",min:0,group:"Параметры объекта"},{key:"unit",label:"Единица измерения",type:"text",group:"Параметры объекта"}],"Ценные бумаги":[...Vo,{key:"securityType",label:"Тип ценных бумаг",type:"select",options:["Акции","Облигации","Векселя","Депозитарные расписки"],group:"Основная информация"},{key:"issuer",label:"Эмитент",type:"text",group:"Основная информация"},{key:"quantity",label:"Количество",type:"number",min:0,group:"Параметры объекта"}],"Права требования":[...Vo,{key:"debtor",label:"Должник",type:"text",group:"Основная информация"},{key:"debtAmount",label:"Сумма долга",type:"number",min:0,unit:"руб.",group:"Параметры объекта"}]},XB=e=>e&&yz[e]||Vo,Dy=e=>{const t=XB(e),r={};return t.forEach(a=>{const n=a.group||"Прочее";r[n]||(r[n]=[]),r[n].push(a)}),r},vz=(e,t)=>(e==null?void 0:e[t])??null,{TextArea:CE}=Re,{Title:Gp,Paragraph:wz,Text:id}=mt,Ez=({visible:e,entry:t,onClose:r})=>{const[a,n]=K.useState(null),[s,o]=K.useState(!1),[A,c]=K.useState({inspectionDate:We().format("YYYY-MM-DD")});K.useEffect(()=>{if(!e||!(t!=null&&t.reference)){n(null);return}(async()=>{o(!0);try{const y="./",x=new URL(y,window.location.origin),v=x.pathname.endsWith("/")?x.pathname:`${x.pathname}/`,E=`${x.origin}${v}portfolioData.json?v=${Date.now()}`,D=await fetch(E,{cache:"no-store"});if(D.ok){const I=(await D.json()).find(_=>String(_.reference)===String(t.reference));I&&(n(I),c(_=>({..._,address:I.collateralLocation||void 0,inspectionDate:We().format("YYYY-MM-DD")})))}}catch(y){console.error("Ошибка загрузки данных портфеля:",y)}finally{o(!1)}})()},[e,t]);const l=K.useMemo(()=>a!=null&&a.collateralType?XB(a.collateralType):[],[a==null?void 0:a.collateralType]),d=K.useMemo(()=>a!=null&&a.collateralType?Dy(a.collateralType):{},[a==null?void 0:a.collateralType]),f=Ma.useCallback((h,y)=>{if(y==null||y==="")return"—";const x=l.find(v=>v.key===h);return(x==null?void 0:x.type)==="number"&&typeof y=="number"?`${y.toLocaleString("ru-RU")}${x.unit?` ${x.unit}`:""}`:(x==null?void 0:x.type)==="boolean"?y?"Да":"Нет":(x==null?void 0:x.type)==="date"&&y?We(y).format("DD.MM.YYYY"):String(y)},[l]),p=Ma.useCallback(h=>a?a[h]??null:null,[a]),u=Ma.useMemo(()=>"./cms-check/index.html#/inspections",[]),g=K.useMemo(()=>{const h=[];if(h.push({key:"main",label:"Основная информация",icon:i.jsx(Qr,{}),children:i.jsx("div",{className:"monitoring-card-content",children:i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"REFERENCE",span:2,children:i.jsx(id,{strong:!0,children:(t==null?void 0:t.reference)??"—"})}),i.jsx(we.Item,{label:"Заемщик",children:(t==null?void 0:t.borrower)??"—"}),i.jsx(we.Item,{label:"Залогодатель",children:(t==null?void 0:t.pledger)??"—"}),i.jsx(we.Item,{label:"Сегмент",children:(t==null?void 0:t.segment)??"—"}),i.jsx(we.Item,{label:"Группа",children:(t==null?void 0:t.group)??"—"}),i.jsx(we.Item,{label:"Тип обеспечения",children:(t==null?void 0:t.baseType)??"—"}),i.jsx(we.Item,{label:"Детальный тип",children:(t==null?void 0:t.collateralType)??"—"}),i.jsx(we.Item,{label:"Вид мониторинга",children:(t==null?void 0:t.monitoringType)??"—"}),i.jsx(we.Item,{label:"Метод мониторинга",children:(t==null?void 0:t.monitoringMethod)??"—"}),i.jsx(we.Item,{label:"Периодичность",children:t!=null&&t.frequencyMonths?`Каждые ${t.frequencyMonths} мес.`:"—"}),i.jsx(we.Item,{label:"Последний мониторинг",children:(t==null?void 0:t.lastMonitoringDate)??"—"}),i.jsx(we.Item,{label:"Планируемая дата",children:(t==null?void 0:t.plannedDate)??"—"}),i.jsx(we.Item,{label:"Ответственный",children:(t==null?void 0:t.owner)??"—"}),i.jsx(we.Item,{label:"Приоритет",children:(t==null?void 0:t.priority)??"—"}),(a==null?void 0:a.collateralValue)&&i.jsxs(we.Item,{label:"Залоговая стоимость",children:[Number(a.collateralValue).toLocaleString("ru-RU")," руб."]}),(a==null?void 0:a.liquidity)&&i.jsx(we.Item,{label:"Ликвидность",children:i.jsx(at,{children:a.liquidity})})]})})}),l.length>0){const y=Object.keys(d).length>0?i.jsx("div",{className:"monitoring-card-content",children:Object.entries(d).map(([x,v])=>i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx(Gp,{level:5,style:{marginBottom:"16px"},children:x}),i.jsx(we,{bordered:!0,column:2,size:"small",children:v.map(E=>{const D=p(E.key);return i.jsx(we.Item,{label:E.label,children:f(E.key,D)},E.key)})})]},x))}):i.jsx("div",{className:"monitoring-card-content",children:i.jsx(we,{bordered:!0,column:2,size:"small",children:l.map(x=>{const v=p(x.key);return i.jsx(we.Item,{label:x.label,children:f(x.key,v)},x.key)})})});h.push({key:"characteristics",label:"Характеристики имущества",icon:i.jsx(Qr,{}),children:s?i.jsx("div",{style:{textAlign:"center",padding:"40px"},children:i.jsx(Zn,{size:"large",tip:"Загрузка характеристик..."})}):y})}return h.push({key:"inspection",label:"Акт осмотра",icon:i.jsx(Ko,{}),children:i.jsx("div",{className:"monitoring-card-content",children:i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(Gp,{level:5,children:"Система дистанционных осмотров"}),i.jsx(wz,{type:"secondary",children:"Используйте CMS Check для проведения осмотра и загрузки фотографий"}),i.jsx(Be,{type:"primary",icon:i.jsx(Ko,{}),onClick:()=>{window.open(u,"_blank")},children:"Открыть CMS Check"})]}),i.jsx(jt,{}),i.jsxs("div",{children:[i.jsx(Gp,{level:5,children:"Данные акта осмотра"}),i.jsxs(ft,{gutter:[16,16],children:[i.jsxs(Te,{xs:24,sm:12,children:[i.jsx(id,{strong:!0,children:"Дата проверки:"}),i.jsx("br",{}),i.jsx(Rr,{style:{width:"100%",marginTop:"8px"},value:A.inspectionDate?We(A.inspectionDate):null,onChange:y=>{c(x=>({...x,inspectionDate:y?y.format("YYYY-MM-DD"):void 0}))},format:"DD.MM.YYYY"})]}),i.jsxs(Te,{xs:24,sm:12,children:[i.jsx(id,{strong:!0,children:"Инспектор:"}),i.jsx("br",{}),i.jsx(Re,{style:{marginTop:"8px"},placeholder:"ФИО инспектора",value:A.inspector,onChange:y=>{c(x=>({...x,inspector:y.target.value}))}})]}),i.jsxs(Te,{xs:24,children:[i.jsxs(id,{strong:!0,children:[i.jsx(tA,{})," Адрес:"]}),i.jsx("br",{}),i.jsx(Re,{style:{marginTop:"8px"},placeholder:"Адрес местоположения имущества",value:A.address,onChange:y=>{c(x=>({...x,address:y.target.value}))}})]}),i.jsxs(Te,{xs:24,children:[i.jsx(id,{strong:!0,children:"Описание состояния имущества:"}),i.jsx("br",{}),i.jsx(CE,{rows:4,style:{marginTop:"8px"},placeholder:"Опишите состояние имущества, выявленные недостатки, повреждения и т.д.",value:A.conditionDescription,onChange:y=>{c(x=>({...x,conditionDescription:y.target.value}))}})]}),i.jsxs(Te,{xs:24,children:[i.jsx(id,{strong:!0,children:"Примечания:"}),i.jsx("br",{}),i.jsx(CE,{rows:3,style:{marginTop:"8px"},placeholder:"Дополнительные примечания по результатам осмотра",value:A.notes,onChange:y=>{c(x=>({...x,notes:y.target.value}))}})]})]})]}),i.jsx(jt,{}),i.jsxs("div",{children:[i.jsxs(Gp,{level:5,children:[i.jsx(Ko,{})," Фотографии имущества"]}),A.photos&&A.photos.length>0?i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px",marginTop:"16px"},children:A.photos.map((y,x)=>i.jsx("div",{style:{position:"relative"},children:i.jsx(am,{src:y,alt:`Фото ${x+1}`,width:"100%",style:{borderRadius:"4px"},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="})},x))}):i.jsx(Br,{description:"Фотографии не загружены",image:Br.PRESENTED_IMAGE_SIMPLE,style:{margin:"20px 0"},children:i.jsx(Be,{type:"dashed",icon:i.jsx(Ko,{}),onClick:()=>{window.open(u,"_blank")},children:"Загрузить фотографии через CMS Check"})})]})]})})}),h},[t,a,l,d,s,A,u,f,p]);return t?i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Qr,{}),i.jsxs("span",{children:["Карточка мониторинга договора ",t.reference]})]}),open:e,onCancel:r,footer:[i.jsx(Be,{onClick:r,children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:s&&!a?i.jsx("div",{style:{textAlign:"center",padding:"40px"},children:i.jsx(Zn,{size:"large",tip:"Загрузка данных..."})}):i.jsx(Ts,{items:g,defaultActiveKey:"main",size:"small",type:"card"})}):null},JB=e=>{var t,r;return(t=e.address)!=null&&t.region?e.address.region:(r=e.address)!=null&&r.city?e.address.city:"Не указан"},_z=e=>{const t=[],r=fr.getMonitoringEmployees(),a=new Map;return e.forEach(n=>{if(!n.nextMonitoringDate)return;const s=JB(n);a.has(s)||a.set(s,[]),a.get(s).push(n)}),a.forEach((n,s)=>{const o=fr.getMonitoringEmployeesByRegion(s);if(o.length===0){const c=r;if(c.length===0)return;n.forEach((l,d)=>{const f=c[d%c.length];t.push({cardId:l.id,employeeId:f.id,employeeName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim(),region:f.region})});return}const A=[...o].sort((c,l)=>{const d=c.monitoringWorkload||0,f=l.monitoringWorkload||0;return d-f});n.forEach((c,l)=>{const d=A[l%A.length];t.push({cardId:c.id,employeeId:d.id,employeeName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim(),region:d.region}),d.monitoringWorkload=(d.monitoringWorkload||0)+1})}),t.forEach(n=>{const s=fr.getEmployeeById(n.employeeId);if(s){const o=s.monitoringWorkload||0;fr.updateWorkload(n.employeeId,o,void 0)}}),t},bz=e=>{const t=[],r=fr.getAppraisalEmployees(),a=new Map;return e.forEach(n=>{if(!n.nextEvaluationDate)return;const s=JB(n);a.has(s)||a.set(s,[]),a.get(s).push(n)}),a.forEach((n,s)=>{const o=fr.getAppraisalEmployeesByRegion(s);if(o.length===0){const c=r;if(c.length===0)return;n.forEach((l,d)=>{const f=c[d%c.length];t.push({cardId:l.id,employeeId:f.id,employeeName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim(),region:f.region})});return}const A=[...o].sort((c,l)=>{const d=c.appraisalWorkload||0,f=l.appraisalWorkload||0;return d-f});n.forEach((c,l)=>{const d=A[l%A.length];t.push({cardId:c.id,employeeId:d.id,employeeName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim(),region:d.region}),d.appraisalWorkload=(d.appraisalWorkload||0)+1})}),t.forEach(n=>{const s=fr.getEmployeeById(n.employeeId);if(s){const o=s.appraisalWorkload||0;fr.updateWorkload(n.employeeId,void 0,o)}}),t},BE=e=>{localStorage.setItem("cms_monitoring_assignments",JSON.stringify(e))},s2=()=>{const e="cms_monitoring_assignments";try{const t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch{return[]}},SE=e=>{localStorage.setItem("cms_appraisal_assignments",JSON.stringify(e))},o2=()=>{const e="cms_appraisal_assignments";try{const t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch{return[]}},Cz=e=>{const r=s2().find(a=>a.cardId===e);return r&&fr.getEmployeeById(r.employeeId)||null},Bz=e=>{const r=o2().find(a=>a.cardId===e);return r&&fr.getEmployeeById(r.employeeId)||null},{Title:Sz,Text:Tz}=mt,{TextArea:Oz}=Re,b1="cms_monitoring_settings",Iz=()=>{const[e]=ne.useForm(),[t,r]=K.useState(!1),[a,n]=K.useState([]),[s,o]=K.useState([]),[A,c]=K.useState([]),[l,d]=K.useState([]),[f,p]=K.useState({}),[u,g]=K.useState(!1);K.useEffect(()=>{try{const B=localStorage.getItem(b1);if(B){const I=JSON.parse(B);e.setFieldsValue(I)}else e.setFieldsValue({notificationsEnabled:!0,notificationFrequency:"weekly",clientNotificationsEnabled:!1,clientNotificationDaysBefore:7,autoReminderEnabled:!0,reminderDaysBefore:3})}catch(B){console.error("Ошибка загрузки настроек:",B)}},[e]),K.useEffect(()=>{(()=>{try{const I=fr.getEmployees();n(I.filter(_=>_.isActive)),o(fr.getMonitoringEmployees()),c(fr.getAppraisalEmployees()),d(fr.getRegions())}catch(I){console.error("Ошибка загрузки сотрудников:",I)}})()},[]),K.useEffect(()=>{const B=async()=>{try{const I=s2(),_=o2(),S=await Yt.getExtendedCards(),O={};l.forEach(M=>{O[M]={};const T=S.filter(L=>{var P,U;return(((P=L.address)==null?void 0:P.region)||((U=L.address)==null?void 0:U.city)||"Не указан")===M&&L.nextMonitoringDate});if(T.length>0){const L=T[0],N=I.find(P=>P.cardId===L.id);N&&(O[M].monitoring=N.employeeId)}const R=S.filter(L=>{var P,U;return(((P=L.address)==null?void 0:P.region)||((U=L.address)==null?void 0:U.city)||"Не указан")===M&&L.nextEvaluationDate});if(R.length>0){const L=R[0],N=_.find(P=>P.cardId===L.id);N&&(O[M].appraisal=N.employeeId)}}),p(O)}catch(I){console.error("Ошибка загрузки назначений:",I)}};l.length>0&&B()},[l]);const h=async()=>{try{const B=await e.validateFields();r(!0),localStorage.setItem(b1,JSON.stringify(B)),Ne.success("Настройки мониторинга сохранены")}catch(B){console.error("Ошибка сохранения настроек:",B),Ne.error("Ошибка при сохранении настроек")}finally{r(!1)}},y=B=>{const I=a.find(_=>_.id===B);I&&e.setFieldsValue({bankEmployeeEmail:I.email||"",bankEmployeeName:`${I.lastName} ${I.firstName} ${I.middleName||""}`.trim(),bankEmployeeId:I.id})},x=async(B,I)=>{try{const S=(await Yt.getExtendedCards()).filter(T=>{var L,N;return(((L=T.address)==null?void 0:L.region)||((N=T.address)==null?void 0:N.city)||"Не указан")===B&&T.nextMonitoringDate}),O=fr.getEmployeeById(I);if(!O)return;const M=s2();S.forEach(T=>{const R=M.findIndex(N=>N.cardId===T.id),L={cardId:T.id,employeeId:O.id,employeeName:`${O.lastName} ${O.firstName} ${O.middleName||""}`.trim(),region:O.region};R>=0?M[R]=L:M.push(L)}),BE(M),p(T=>({...T,[B]:{...T[B],monitoring:I}})),Ne.success(`Ответственный за мониторинг в регионе "${B}" назначен`)}catch(_){console.error("Ошибка назначения ответственного:",_),Ne.error("Ошибка при назначении ответственного")}},v=async(B,I)=>{try{const S=(await Yt.getExtendedCards()).filter(T=>{var L,N;return(((L=T.address)==null?void 0:L.region)||((N=T.address)==null?void 0:N.city)||"Не указан")===B&&T.nextEvaluationDate}),O=fr.getEmployeeById(I);if(!O)return;const M=o2();S.forEach(T=>{const R=M.findIndex(N=>N.cardId===T.id),L={cardId:T.id,employeeId:O.id,employeeName:`${O.lastName} ${O.firstName} ${O.middleName||""}`.trim(),region:O.region};R>=0?M[R]=L:M.push(L)}),SE(M),p(T=>({...T,[B]:{...T[B],appraisal:I}})),Ne.success(`Ответственный за оценку в регионе "${B}" назначен`)}catch(_){console.error("Ошибка назначения ответственного:",_),Ne.error("Ошибка при назначении ответственного")}},E=async()=>{try{g(!0);const B=await Yt.getExtendedCards(),I=_z(B);BE(I);const _={};l.forEach(S=>{const O=I.find(M=>{var L,N;const T=B.find(P=>P.id===M.cardId);return(((L=T==null?void 0:T.address)==null?void 0:L.region)||((N=T==null?void 0:T.address)==null?void 0:N.city)||"Не указан")===S});O&&(_[S]={monitoring:O.employeeId})}),p(S=>({...S,..._})),Ne.success(`Автопилот выполнен: назначено ${I.length} объектов для мониторинга`)}catch(B){console.error("Ошибка автопилота мониторинга:",B),Ne.error("Ошибка при выполнении автопилота")}finally{g(!1)}},D=async()=>{try{g(!0);const B=await Yt.getExtendedCards(),I=bz(B);SE(I);const _={};l.forEach(S=>{const O=I.find(M=>{var L,N;const T=B.find(P=>P.id===M.cardId);return(((L=T==null?void 0:T.address)==null?void 0:L.region)||((N=T==null?void 0:T.address)==null?void 0:N.city)||"Не указан")===S});O&&(_[S]={appraisal:O.employeeId})}),p(S=>({...S,..._})),Ne.success(`Автопилот выполнен: назначено ${I.length} объектов для оценки`)}catch(B){console.error("Ошибка автопилота оценки:",B),Ne.error("Ошибка при выполнении автопилота")}finally{g(!1)}};return i.jsx("div",{style:{padding:"24px"},children:i.jsxs(Ge,{children:[i.jsxs("div",{style:{marginBottom:24},children:[i.jsxs(Sz,{level:3,style:{margin:0,display:"flex",alignItems:"center",gap:12},children:[i.jsx(Hc,{style:{fontSize:"28px",color:"#1890ff"}}),"Настройки мониторинга"]}),i.jsx(Tz,{type:"secondary",style:{display:"block",marginTop:8},children:"Настройка уведомлений, периодичности и интеграции с почтовой рассылкой"})]}),i.jsx(jt,{}),i.jsxs(ne,{form:e,layout:"vertical",onFinish:h,children:[i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(gv,{}),i.jsx("span",{children:"Настройки уведомлений"})]}),style:{marginBottom:24},children:[i.jsx(ne.Item,{name:"notificationsEnabled",label:"Включить уведомления",valuePropName:"checked",children:i.jsx(Ni,{})}),i.jsx(ne.Item,{name:"notificationFrequency",label:"Периодичность уведомлений",rules:[{required:!0,message:"Выберите периодичность"}],children:i.jsxs(Ye,{children:[i.jsx(Ye.Option,{value:"daily",children:"Ежедневно"}),i.jsx(Ye.Option,{value:"weekly",children:"Еженедельно"}),i.jsx(Ye.Option,{value:"monthly",children:"Ежемесячно"}),i.jsx(Ye.Option,{value:"custom",children:"Произвольная (указать дни)"})]})}),i.jsx(ne.Item,{noStyle:!0,shouldUpdate:(B,I)=>B.notificationFrequency!==I.notificationFrequency,children:({getFieldValue:B})=>B("notificationFrequency")==="custom"?i.jsx(ne.Item,{name:"customNotificationDays",label:"Количество дней между уведомлениями",rules:[{required:!0,message:"Укажите количество дней"}],children:i.jsx(fa,{min:1,max:365,style:{width:"100%"}})}):null}),i.jsx(ne.Item,{name:"autoReminderEnabled",label:"Автоматическое напоминание сотруднику",valuePropName:"checked",children:i.jsx(Ni,{})}),i.jsx(ne.Item,{noStyle:!0,shouldUpdate:(B,I)=>B.autoReminderEnabled!==I.autoReminderEnabled,children:({getFieldValue:B})=>B("autoReminderEnabled")?i.jsx(ne.Item,{name:"reminderDaysBefore",label:"Напоминать за (дней до мониторинга)",rules:[{required:!0,message:"Укажите количество дней"}],children:i.jsx(fa,{min:1,max:30,style:{width:"100%"}})}):null})]}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(xv,{}),i.jsx("span",{children:"Интеграция с почтовой рассылкой"})]}),style:{marginBottom:24},children:[i.jsx(Nr,{message:"Настройка email-уведомлений",description:"Укажите сотрудника Банка, ответственного за мониторинг, для автоматической рассылки уведомлений",type:"info",showIcon:!0,style:{marginBottom:16}}),i.jsx(ne.Item,{name:"bankEmployeeId",label:"Ответственный сотрудник Банка",rules:[{required:!0,message:"Выберите сотрудника"}],children:i.jsx(Ye,{placeholder:"Выберите сотрудника",showSearch:!0,filterOption:(B,I)=>((I==null?void 0:I.label)??"").toLowerCase().includes(B.toLowerCase()),onChange:y,options:a.map(B=>({value:B.id,label:`${B.lastName} ${B.firstName} ${B.middleName||""}`.trim()}))})}),i.jsx(ne.Item,{name:"bankEmployeeEmail",label:"Email для уведомлений",rules:[{required:!0,message:"Укажите email"},{type:"email",message:"Неверный формат email"}],children:i.jsx(Re,{prefix:i.jsx(xv,{}),placeholder:"email@example.com"})}),i.jsx(ne.Item,{name:"bankEmployeeName",hidden:!0,children:i.jsx(Re,{})})]}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(gv,{}),i.jsx("span",{children:"Уведомления клиенту Банка"})]}),style:{marginBottom:24},children:[i.jsx(Nr,{message:"Автоматические уведомления клиенту",description:"Настройте автоматическую отправку уведомлений клиенту о предстоящем мониторинге",type:"info",showIcon:!0,style:{marginBottom:16}}),i.jsx(ne.Item,{name:"clientNotificationsEnabled",label:"Включить уведомления клиенту",valuePropName:"checked",children:i.jsx(Ni,{})}),i.jsx(ne.Item,{noStyle:!0,shouldUpdate:(B,I)=>B.clientNotificationsEnabled!==I.clientNotificationsEnabled,children:({getFieldValue:B})=>B("clientNotificationsEnabled")?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"clientNotificationDaysBefore",label:"Уведомлять клиента за (дней до мониторинга)",rules:[{required:!0,message:"Укажите количество дней"}],children:i.jsx(fa,{min:1,max:30,style:{width:"100%"}})}),i.jsx(ne.Item,{name:"clientNotificationTemplate",label:"Шаблон уведомления клиенту",children:i.jsx(Oz,{rows:6,placeholder:"Уважаемый клиент! Напоминаем, что {дата} запланирован мониторинг объекта залога по договору {номер_договора}. Пожалуйста, обеспечьте доступ к объекту."})})]}):null})]}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(es,{}),i.jsx("span",{children:"Назначение ответственных за мониторинг"})]}),style:{marginBottom:24},extra:i.jsx(Be,{type:"primary",icon:i.jsx(yv,{}),onClick:E,loading:u,children:"Автопилот"}),children:[i.jsx(Nr,{message:"Распределение по регионам",description:"Назначьте ответственных сотрудников для мониторинга по каждому региону. Используйте 'Автопилот' для автоматического распределения с учетом загрузки сотрудников.",type:"info",showIcon:!0,style:{marginBottom:16}}),i.jsx(nr,{dataSource:l.map(B=>{var I;return{key:B,region:B,monitoringEmployee:(I=f[B])==null?void 0:I.monitoring}}),columns:[{title:"Регион",dataIndex:"region",key:"region"},{title:"Ответственный за мониторинг",dataIndex:"monitoringEmployee",key:"monitoringEmployee",render:(B,I)=>i.jsx(Ye,{style:{width:"100%"},placeholder:"Выберите сотрудника",value:B,onChange:_=>x(I.region,_),options:s.filter(_=>_.region===I.region).map(_=>({value:_.id,label:`${_.lastName} ${_.firstName} ${_.middleName||""}`.trim()}))})}],pagination:!1})]}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(es,{}),i.jsx("span",{children:"Назначение ответственных за оценку"})]}),style:{marginBottom:24},extra:i.jsx(Be,{type:"primary",icon:i.jsx(yv,{}),onClick:D,loading:u,children:"Автопилот"}),children:[i.jsx(Nr,{message:"Распределение по регионам",description:"Назначьте ответственных сотрудников для оценки по каждому региону. Используйте 'Автопилот' для автоматического распределения с учетом загрузки сотрудников.",type:"info",showIcon:!0,style:{marginBottom:16}}),i.jsx(nr,{dataSource:l.map(B=>{var I;return{key:B,region:B,appraisalEmployee:(I=f[B])==null?void 0:I.appraisal}}),columns:[{title:"Регион",dataIndex:"region",key:"region"},{title:"Ответственный за оценку",dataIndex:"appraisalEmployee",key:"appraisalEmployee",render:(B,I)=>i.jsx(Ye,{style:{width:"100%"},placeholder:"Выберите сотрудника",value:B,onChange:_=>v(I.region,_),options:A.filter(_=>_.region===I.region).map(_=>({value:_.id,label:`${_.lastName} ${_.firstName} ${_.middleName||""}`.trim()}))})}],pagination:!1})]}),i.jsx(jt,{}),i.jsx(ne.Item,{children:i.jsxs(Fe,{children:[i.jsx(Be,{type:"primary",htmlType:"submit",icon:i.jsx(rm,{}),loading:t,size:"large",children:"Сохранить настройки"}),i.jsx(Be,{onClick:()=>{e.resetFields();const B=localStorage.getItem(b1);if(B){const I=JSON.parse(B);e.setFieldsValue(I)}},children:"Отменить изменения"})]})})]})]})})},ZB=e=>e<0?"overdue":e<=7?"week":e<=30?"month":e<=90?"quarter":"later",Zh=e=>{if(!e)return null;const t=e.split(".");if(t.length!==3)return null;const r=parseInt(t[0],10),a=parseInt(t[1],10)-1,n=parseInt(t[2],10);return new Date(n,a,r)},Dd=e=>{const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return`${t}.${r}.${a}`},eS=(e,t)=>{if(e)return e.includes("недвижимость")||e.includes("здание")||e.includes("помещение")?"Недвижимость":e.includes("автомобиль")||e.includes("транспорт")?"Транспорт":e.includes("оборудование")||e.includes("техника")?"Оборудование":e.includes("товар")||e.includes("сырье")?"Товары и сырье":e.includes("право")||e.includes("доля")?"Имущественные права":e;switch(t){case"real_estate":return"Недвижимость";case"movable":return"Движимое имущество";case"property_rights":return"Имущественные права";default:return"Прочее"}},Nz=(e,t)=>t==="real_estate"?"Выездной осмотр":t==="movable"?e!=null&&e.includes("автомобиль")||e!=null&&e.includes("транспорт")?"Документарная проверка + онлайн-проверка":"Выездной осмотр":"Документарная проверка",Fz=(e,t)=>t==="real_estate"?"Оценка недвижимости":t==="movable"?e!=null&&e.includes("автомобиль")||e!=null&&e.includes("транспорт")?"Оценка транспортных средств":"Оценка оборудования":"Оценка имущественных прав",tS=(e,t)=>{if(t==="monitoring"){const a=Cz(e.id);if(a)return`${a.lastName} ${a.firstName} ${a.middleName||""}`.trim()}else{const a=Bz(e.id);if(a)return`${a.lastName} ${a.firstName} ${a.middleName||""}`.trim()}const r=["Иванов И.И.","Петров П.П.","Сидоров С.С.","Смирнов А.А.","Кузнецов Д.Д."];return r[Math.floor(Math.random()*r.length)]},rS=e=>{const t=[],r=We();return e.forEach(a=>{var u,g,h,y,x,v,E;if(a.mainCategory!=="real_estate"&&a.mainCategory!=="movable"||!a.nextMonitoringDate)return;const n=Zh(a.nextMonitoringDate);if(!n)return;const s=Zh(a.monitoringDate||a.nextMonitoringDate),o=We(n).diff(r,"day"),A=ZB(o),c=((u=a.address)==null?void 0:u.city)||((g=a.address)==null?void 0:g.region)||null,l=c?yy(c):null,d=(h=a.partners)==null?void 0:h.find(D=>D.role==="owner"),f=(y=a.partners)==null?void 0:y.find(D=>D.role==="pledgor"),p={reference:a.reference||null,borrower:d?d.type==="legal"?d.organizationName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim():null,pledger:f?f.type==="legal"?f.organizationName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim():null,segment:null,group:null,collateralType:a.propertyType||null,baseType:eS(a.propertyType,a.mainCategory),frequencyMonths:a.monitoringFrequencyMonths||12,monitoringType:((x=a.characteristics)==null?void 0:x.MONITORING_TYPE)||null,monitoringMethod:Nz(a.propertyType,a.mainCategory),lastMonitoringDate:Dd(s||n),plannedDate:Dd(n),timeframe:A,owner:tS(a,"monitoring"),city:c,regionCenterCode:(l==null?void 0:l.code)||null,regionCenterName:(l==null?void 0:l.name)||null,priority:((v=a.characteristics)==null?void 0:v.PRIORITY)||null,liquidity:((E=a.characteristics)==null?void 0:E.LIQUIDITY)||null,collateralValue:a.pledgeValue||null};t.push(p)}),t},aS=e=>{const t=[],r=We();return e.forEach(a=>{var g,h,y,x,v;if(a.mainCategory!=="real_estate"&&a.mainCategory!=="movable"||!a.nextEvaluationDate)return;const n=Zh(a.nextEvaluationDate);if(!n)return;const s=Zh(a.lastEvaluationDate||a.evaluationDate||a.nextEvaluationDate),o=We(n).diff(r,"day"),A=ZB(o),c=((g=a.address)==null?void 0:g.city)||((h=a.address)==null?void 0:h.region)||null,l=c?yy(c):null,d=(y=a.partners)==null?void 0:y.find(E=>E.role==="owner"),f=(x=a.partners)==null?void 0:x.find(E=>E.role==="pledgor"),p=a.mainCategory==="real_estate"?12:6,u={reference:a.reference||null,borrower:d?d.type==="legal"?d.organizationName:`${d.lastName} ${d.firstName} ${d.middleName||""}`.trim():null,pledger:f?f.type==="legal"?f.organizationName:`${f.lastName} ${f.firstName} ${f.middleName||""}`.trim():null,segment:null,group:null,collateralType:a.propertyType||null,baseType:eS(a.propertyType,a.mainCategory),frequencyMonths:p,lastRevaluationDate:Dd(s||n),plannedDate:Dd(n),timeframe:A,owner:tS(a,"appraisal"),city:c,regionCenterCode:(l==null?void 0:l.code)||null,regionCenterName:(l==null?void 0:l.name)||null,priority:((v=a.characteristics)==null?void 0:v.PRIORITY)||null,collateralValue:a.pledgeValue||null,marketValue:a.marketValue||null,revaluationMethod:Fz(a.propertyType,a.mainCategory)};t.push(u)}),t};We.extend(hz);const TE=[{label:"Все",value:"all"},{label:"Просрочено",value:"overdue"},{label:"7 дней",value:"week"},{label:"30 дней",value:"month"},{label:"90 дней",value:"quarter"}],Rz=()=>{var et;const e=uc(),t=((et=e.state)==null?void 0:et.activeTab)||"monitoring",[r,a]=K.useState(t);K.useEffect(()=>{var _e;const je=(_e=e.state)==null?void 0:_e.activeTab;je&&(je==="monitoring"||je==="revaluation"||je==="settings")&&a(je)},[e.state]);const[n,s]=K.useState([]),[o,A]=K.useState(!0),[c,l]=K.useState(null),[d,f]=K.useState("week"),[p,u]=K.useState(""),[g,h]=K.useState(null),[y,x]=K.useState(null),[v,E]=K.useState(null),[D,B]=K.useState(!1),[I,_]=K.useState(null),[S,O]=K.useState(!1),[M,T]=K.useState([]),[R,L]=K.useState(!0),[N,P]=K.useState(null),[U,V]=K.useState("week"),[ie,W]=K.useState(""),[z,G]=K.useState(null),[b,k]=K.useState(null),[j,q]=K.useState(null);K.useEffect(()=>{let je=!0;return(async()=>{A(!0),l(null);try{const lt=await Yt.getExtendedCards();if(!je)return;const bt=rS(lt).map((Et,Mt)=>{const Bt=We(Et.plannedDate,"DD.MM.YYYY").diff(We(),"day");let ut="#1677ff";return Bt<0?ut="#f5222d":Bt<=7?ut="#fa8c16":Bt<=30&&(ut="#52c41a"),{...Et,key:`${Et.reference??"ref"}-${Mt}`,daysUntil:Bt,statusColor:ut}});s(bt)}catch(lt){l(lt instanceof Error?lt.message:"Неизвестная ошибка")}finally{je&&A(!1)}})(),()=>{je=!1}},[]);const Y=K.useMemo(()=>Array.from(new Set(n.map(_e=>_e.baseType))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),de=K.useMemo(()=>Array.from(new Set(n.map(_e=>_e.monitoringMethod))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),ue=K.useMemo(()=>Array.from(new Set(n.map(_e=>_e.owner))).filter(Boolean).map(_e=>({value:_e,label:_e})),[n]),pe=K.useMemo(()=>{const je=p.trim().toLowerCase();return n.filter(_e=>{const lt=!je||[_e.reference,_e.borrower,_e.pledger,_e.segment,_e.owner,_e.monitoringType].filter(Boolean).some(Dt=>String(Dt).toLowerCase().includes(je)),Ct=d==="all"||_e.timeframe===d,bt=!g||_e.baseType===g,Et=!y||_e.monitoringMethod===y,Mt=!v||_e.owner===v;return lt&&Ct&&bt&&Et&&Mt})},[n,p,d,g,y,v]),ye=K.useMemo(()=>{const je={overdue:0,week:0,month:0,quarter:0,total:n.length};return n.forEach(_e=>{_e.timeframe in je&&(je[_e.timeframe]+=1)}),je},[n]),ve=K.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:_e.reference??"—"}),i.jsx("div",{className:"monitoring-muted",children:_e.borrower??_e.pledger??"Не указан"}),i.jsxs("div",{className:"monitoring-muted",children:[_e.segment??"—"," · ",_e.group??"—"]})]})},{title:"Обеспечение",dataIndex:"baseType",key:"baseType",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(mt.Text,{children:_e.baseType}),i.jsx("div",{className:"monitoring-muted",children:_e.collateralType}),_e.liquidity&&i.jsx(at,{children:_e.liquidity})]})},{title:"План мониторинга",dataIndex:"plannedDate",key:"plannedDate",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(hh,{color:_e.statusColor}),i.jsx(mt.Text,{style:{marginLeft:8},children:_e.plannedDate}),i.jsxs("div",{className:"monitoring-muted",children:["Последний: ",_e.lastMonitoringDate," · каждые ",_e.frequencyMonths," мес."]}),i.jsxs("div",{className:"monitoring-trend",children:[i.jsx(zn,{}),_e.daysUntil<0?i.jsxs("span",{children:["Просрочен на ",Math.abs(_e.daysUntil)," дн."]}):i.jsxs("span",{children:["Через ",_e.daysUntil," дн."]})]})]})},{title:"Вид/метод мониторинга",dataIndex:"monitoringType",key:"monitoringType",width:240,render:(je,_e)=>i.jsxs("div",{children:[_e.monitoringType&&i.jsx(at,{color:"blue",children:_e.monitoringType}),i.jsx("div",{className:"monitoring-muted",children:_e.monitoringMethod})]})},{title:"Ответственный",dataIndex:"owner",key:"owner",width:180,render:je=>i.jsx(mt.Text,{children:je})},{title:"Приоритет",dataIndex:"priority",key:"priority",width:160,render:je=>i.jsx("span",{children:je??"—"})},{title:"Действия",key:"actions",width:100,fixed:"right",render:(je,_e)=>i.jsx(Xr,{title:"Открыть карточку мониторинга",children:i.jsxs("a",{onClick:()=>{_(_e),O(!0)},children:[i.jsx(Ss,{})," Открыть"]})})}],[_,O]);K.useEffect(()=>{let je=!0;return(async()=>{L(!0),P(null);try{const lt=await Yt.getExtendedCards();if(!je)return;const bt=aS(lt).map((Et,Mt)=>{const Bt=We(Et.plannedDate,"DD.MM.YYYY").diff(We(),"day");let ut="#1677ff";return Bt<0?ut="#f5222d":Bt<=7?ut="#fa8c16":Bt<=30&&(ut="#52c41a"),{...Et,key:`${Et.reference??"ref"}-${Mt}`,daysUntil:Bt,statusColor:ut}});T(bt)}catch(lt){P(lt instanceof Error?lt.message:"Неизвестная ошибка")}finally{je&&L(!1)}})(),()=>{je=!1}},[]);const ae=K.useMemo(()=>Array.from(new Set(M.map(_e=>_e.baseType))).filter(Boolean).map(_e=>({value:_e,label:_e})),[M]),Ke=K.useMemo(()=>Array.from(new Set(M.map(_e=>_e.revaluationMethod))).filter(Boolean).map(_e=>({value:_e,label:_e})),[M]),Ee=K.useMemo(()=>Array.from(new Set(M.map(_e=>_e.owner))).filter(Boolean).map(_e=>({value:_e,label:_e})),[M]),me=K.useMemo(()=>{const je=ie.trim().toLowerCase();return M.filter(_e=>{const lt=!je||[_e.reference,_e.borrower,_e.pledger,_e.segment,_e.owner,_e.revaluationMethod].filter(Boolean).some(Dt=>String(Dt).toLowerCase().includes(je)),Ct=U==="all"||_e.timeframe===U,bt=!z||_e.baseType===z,Et=!b||_e.revaluationMethod===b,Mt=!j||_e.owner===j;return lt&&Ct&&bt&&Et&&Mt})},[M,ie,U,z,b,j]),le=K.useMemo(()=>{const je={overdue:0,week:0,month:0,quarter:0,total:M.length};return M.forEach(_e=>{_e.timeframe in je&&(je[_e.timeframe]+=1)}),je},[M]),He=K.useMemo(()=>[{title:"Сделка",dataIndex:"reference",key:"reference",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(mt.Text,{strong:!0,children:_e.reference??"—"}),i.jsx("div",{className:"monitoring-muted",children:_e.borrower??_e.pledger??"Не указан"}),i.jsxs("div",{className:"monitoring-muted",children:[_e.segment??"—"," · ",_e.group??"—"]})]})},{title:"Обеспечение",dataIndex:"baseType",key:"baseType",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(mt.Text,{children:_e.baseType}),i.jsx("div",{className:"monitoring-muted",children:_e.collateralType})]})},{title:"План переоценки",dataIndex:"plannedDate",key:"plannedDate",width:220,render:(je,_e)=>i.jsxs("div",{children:[i.jsx(hh,{color:_e.statusColor}),i.jsx(mt.Text,{style:{marginLeft:8},children:_e.plannedDate}),i.jsxs("div",{className:"monitoring-muted",children:["Последняя: ",_e.lastRevaluationDate," · каждые ",_e.frequencyMonths," мес."]}),i.jsxs("div",{className:"monitoring-trend",children:[i.jsx(zn,{}),_e.daysUntil<0?i.jsxs("span",{children:["Просрочен на ",Math.abs(_e.daysUntil)," дн."]}):i.jsxs("span",{children:["Через ",_e.daysUntil," дн."]})]})]})},{title:"Стоимость",dataIndex:"collateralValue",key:"collateralValue",width:180,render:(je,_e)=>i.jsxs("div",{children:[_e.collateralValue&&i.jsx("div",{children:i.jsxs(mt.Text,{children:["Залог: ",_e.collateralValue.toLocaleString("ru-RU")," ₽"]})}),_e.marketValue&&i.jsxs("div",{className:"monitoring-muted",children:["Рыночная: ",_e.marketValue.toLocaleString("ru-RU")," ₽"]})]})},{title:"Метод переоценки",dataIndex:"revaluationMethod",key:"revaluationMethod",width:200,render:je=>je?i.jsx(at,{color:"purple",children:je}):i.jsx("span",{children:"—"})},{title:"Ответственный",dataIndex:"owner",key:"owner",width:180,render:je=>i.jsx(mt.Text,{children:je})},{title:"Приоритет",dataIndex:"priority",key:"priority",width:160,render:je=>i.jsx("span",{children:je??"—"})}],[]),Ze=K.useCallback(()=>i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"monitoring-page__header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"monitoring-page__title",children:"План мониторинга Обеспечения"}),i.jsx(mt.Paragraph,{className:"monitoring-page__subtitle",children:"Формирование недельного, месячного и квартального графика выездов и документарных проверок по всем видам залогов."})]}),i.jsx(Xr,{title:"Поиск по сделке, клиенту, ИНН или ответственному",children:i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по сделкам и клиентам",prefix:i.jsx(Pa,{}),value:p,onChange:je=>u(je.target.value),style:{width:360}})})]}),i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Просрочено",value:ye.overdue,valueStyle:{color:"#f5222d"},prefix:i.jsx(Wp,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"7 дней",value:ye.week,valueStyle:{color:"#fa8c16"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"30 дней",value:ye.month,valueStyle:{color:"#52c41a"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"90 дней",value:ye.quarter,valueStyle:{color:"#1677ff"}})})})]}),i.jsx(Ge,{className:"monitoring-page__filters",children:i.jsxs(Fe,{size:"middle",wrap:!0,children:[i.jsx(Ho.Group,{options:TE,value:d,onChange:je=>f(je.target.value),optionType:"button",buttonStyle:"solid"}),i.jsx(Ye,{allowClear:!0,placeholder:"Тип обеспечения",style:{minWidth:200},options:Y,value:g??void 0,onChange:je=>h(je??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Метод мониторинга",style:{minWidth:200},options:de,value:y??void 0,onChange:je=>x(je??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Ответственный",style:{minWidth:200},options:ue,value:v??void 0,onChange:je=>E(je??null)})]})}),i.jsx(ft,{gutter:[16,16],children:i.jsx(Te,{xs:24,children:i.jsxs(Ge,{bodyStyle:{padding:0},className:"monitoring-page__table-card",children:[i.jsx("div",{className:"monitoring-page__table-actions",children:i.jsx(Fe,{children:i.jsx(Xr,{title:"Рекомендации по периодичности мониторинга",children:i.jsx("a",{onClick:()=>B(!0),children:"Рекомендации"})})})}),i.jsx(nr,{columns:ve,dataSource:pe,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:1200},loading:o,onRow:je=>({onDoubleClick:()=>{_(je),O(!0)},style:{cursor:"pointer"}}),locale:{emptyText:o?i.jsx(Br,{description:"Загрузка..."}):i.jsx(Br,{description:"Нет задач"})}})]})})}),c&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить план мониторинга",description:c,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),i.jsxs(dr,{title:"Рекомендации по периодичности мониторинга",open:D,onCancel:()=>B(!1),onOk:()=>B(!1),okText:"Понятно",cancelText:"Закрыть",children:[i.jsxs("ul",{className:"monitoring-guidelines",children:[i.jsx("li",{children:"Недвижимость — не реже 1 раза в 12 месяцев."}),i.jsx("li",{children:"Транспорт/оборудование без страхования — каждые 6 месяцев."}),i.jsx("li",{children:"Транспорт/оборудование со страхованием — каждые 12 месяцев."}),i.jsx("li",{children:"Товары и сырье — каждые 3 месяца (формальное обеспечение документарно)."}),i.jsx("li",{children:"Имущественные права — каждые 6 месяцев."}),i.jsx("li",{children:"Ценные бумаги и доли — ежегодно, документарно."})]}),i.jsx(mt.Paragraph,{className:"monitoring-muted",children:"При наличии решения УО/УЛ используется индивидуальный график. Документарные проверки включают ЕГРН, реестры залогов, выписки счетов депо и онлайн-проверку транспортных средств."})]}),i.jsx(Ez,{visible:S,entry:I,onClose:()=>{O(!1),_(null)}})]}),[p,ye,d,g,y,v,pe,o,c,D,S,I,Y,de,ue,ve]),$e=K.useCallback(()=>i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"monitoring-page__header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"monitoring-page__title",children:"План переоценок Обеспечения"}),i.jsx(mt.Paragraph,{className:"monitoring-page__subtitle",children:"Формирование графика переоценок залогового имущества для актуализации стоимости обеспечения."})]}),i.jsx(Xr,{title:"Поиск по сделке, клиенту, ИНН или ответственному",children:i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по сделкам и клиентам",prefix:i.jsx(Pa,{}),value:ie,onChange:je=>W(je.target.value),style:{width:360}})})]}),i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Просрочено",value:le.overdue,valueStyle:{color:"#f5222d"},prefix:i.jsx(Wp,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"7 дней",value:le.week,valueStyle:{color:"#fa8c16"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"30 дней",value:le.month,valueStyle:{color:"#52c41a"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"90 дней",value:le.quarter,valueStyle:{color:"#1677ff"}})})})]}),i.jsx(Ge,{className:"monitoring-page__filters",children:i.jsxs(Fe,{size:"middle",wrap:!0,children:[i.jsx(Ho.Group,{options:TE,value:U,onChange:je=>V(je.target.value),optionType:"button",buttonStyle:"solid"}),i.jsx(Ye,{allowClear:!0,placeholder:"Тип обеспечения",style:{minWidth:200},options:ae,value:z??void 0,onChange:je=>G(je??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Метод переоценки",style:{minWidth:200},options:Ke,value:b??void 0,onChange:je=>k(je??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Ответственный",style:{minWidth:200},options:Ee,value:j??void 0,onChange:je=>q(je??null)})]})}),i.jsx(ft,{gutter:[16,16],children:i.jsx(Te,{xs:24,children:i.jsx(Ge,{bodyStyle:{padding:0},className:"monitoring-page__table-card",children:i.jsx(nr,{columns:He,dataSource:me,pagination:{pageSize:15,showSizeChanger:!1},scroll:{x:1200},loading:R,locale:{emptyText:R?i.jsx(Br,{description:"Загрузка..."}):i.jsx(Br,{description:"Нет задач"})}})})})}),N&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить план переоценок",description:N,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})})]}),[ie,le,U,z,b,j,me,R,N,ae,Ke,Ee,He]);return i.jsxs("div",{className:"monitoring-page",children:[i.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx(Be,{type:r==="monitoring"?"primary":"default",icon:i.jsx(Ss,{}),size:"large",onClick:()=>a("monitoring"),style:r==="monitoring"?{}:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"#fff"},children:"План мониторинга Обеспечения"}),i.jsx(Be,{type:r==="revaluation"?"primary":"default",icon:i.jsx(ec,{}),size:"large",onClick:()=>a("revaluation"),style:r==="revaluation"?{}:{backgroundColor:"#52c41a",borderColor:"#52c41a",color:"#fff"},children:"План переоценки Обеспечения"})]}),i.jsx(Ts,{activeKey:r,onChange:a,items:[{key:"monitoring",label:i.jsxs("span",{children:[i.jsx(Wp,{}),"План мониторинга обеспечения"]}),children:Ze()},{key:"revaluation",label:i.jsxs("span",{children:[i.jsx(Jf,{}),"План переоценок Обеспечения"]}),children:$e()},{key:"settings",label:i.jsxs("span",{children:[i.jsx(Hc,{}),"Настройка"]}),children:i.jsx(Iz,{})}]})]})};function kz(e){const{portfolioData:t,creditOrgCode:r="000000000",creditOrgName:a="Кредитная организация",reportDate:n=new Date().toISOString().split("T")[0]}=e,s=Dz(),o="urn:cbr-ru:rep0409310:v4.0.4.5";let A=`<?xml version="1.0" encoding="windows-1251"?>
`;A+=`<Ф0409310 xmlns="${o}"
`,A+=`	Идентификатор="${s}"
`,A+=`	ВерсияФормата="4.0.4.5"
`,A+=`	ДатаВерсииФормата="2025-04-24"
`,A+=`	Версия="4.0.4.5"
`,A+=`	Дата="${n}"
`,A+=`	Номер="1"
`,A+=`	ДатаВерсии="2025-04-24"
`,A+=`	ДатаВерсииФормата="2025-04-24T00:00:00">
`,A+=`	<КредитнаяОрганизация Наименование="${za(a)}" Код="${r}"/>
`,A+=`	<Раздел310 НП="1">
`;const c=t.slice(0,100);for(const l of c){const d=String(l.reference||l.contractNumber||"");if(!d)continue;A+=`		<Раздел1 Раздел1_1="${d}">
`,A+=`			<Подраздел1>
`,A+=`				<Раздел1_1 Раздел1.1_2="${d}"/>
`;const f=TA(l.registrationDate||l.collateralContractDate);A+=`				<Раздел1.1 Раздел1.1_3="${f}" Раздел1.1_4="${za(String(l.collateralType||"-"))}"/>
`,l.collateralReference&&(A+=`				<Раздел1.2 Раздел1.2_2="${l.collateralReference}"/>
`),l.lastMonitoringDate&&l.lastMonitoringDate!=="-"&&(A+=`				<Раздел1.3 Раздел1.3_2="${TA(l.lastMonitoringDate)}"/>
`),A+=`			</Подраздел1>
`,l.closeDate&&l.closeDate!=="-"&&(A+=`			<Раздел1.4 Раздел1.4_2="${TA(l.closeDate)}"/>
`),A+=`		</Раздел1>
`;const p=TA(l.contractDate);A+=`		<Раздел2
`,A+=`			Раздел2_1="${d}"
`,A+=`			Раздел2_2="${za(String(l.contractNumber||""))}"
`,A+=`			Раздел2_3="${sd(l.debtRub||0)}"
`,A+=`			Раздел2_4="${p}"
`,A+=`			Раздел2_5="${sd(l.overdueInterest||0)}"
`,A+=`			Раздел2_6="${p}"
`,A+=`			Раздел2_7="${sd(l.overduePrincipal||0)}"
`,A+=`			Раздел2_8="${p}"
`,A+=`			Раздел2_9="${sd(l.overdueInterest||0)}"
`,A+=`			Раздел2_10="${p}"
`,A+=`			Раздел2_11="${sd(l.limitRub||0)}"
`,A+=`			Раздел2_12="${p}"
`,A+=`			Раздел2_13="0.00"
`,A+=`			Раздел2_14="${p}"/>
`,A+=`		<Раздел3
`,A+=`			Раздел3_1="${d}"
`,A+=`			Раздел3_2="${za(String(l.collateralLocation||""))}"
`,A+=`			Раздел3_3="${za(String(l.collateralType||""))}"
`,A+=`			Раздел3_4="${za(String(l.collateralCategory||""))}"
`,A+=`			Раздел3_5="310310"
`,A+=`			Раздел3_6="${za(String(l.collateralInfo||""))}"
`,A+=`			Раздел3_7="${za(String(l.collateralPurpose||""))}"
`,A+=`			Раздел3_8="${za(String(l.qualityCategory||""))}"
`,A+=`			Раздел3_9="${za(String(l.liquidity||""))}"
`,A+=`			Раздел3_10="${za(String(l.collateralValue||0))}"
`,A+=`			Раздел3_11="${sd(l.marketValue||l.currentMarketValue||0)}"/>
`;const u=String(l.collateralType||"").toLowerCase();A+=`		<Раздел4 Раздел4_1="${d}">
`,u.includes("недвиж")||u.includes("зем")||u.includes("здание")?(A+=`			<Раздел4.1
`,A+=`				Раздел4.1_2="${za(String(l.collateralLocation||""))}"
`,A+=`				Раздел4.1_3="${TA(l.registrationDate||l.collateralContractDate)}"
`,A+=`				Раздел4.1_4="${TA(l.initialValuationDate)}"
`,A+=`				Раздел4.1_5="${String(l.collateralReference||"")}"
`,A+=`				Раздел4.1_6="${TA(l.currentValuationDate)}"/>
`):(u.includes("транспорт")||u.includes("авто"))&&(A+=`			<Раздел4.3
`,A+=`				Раздел4.3_2="${TA(l.registrationDate||l.collateralContractDate)}"
`,A+=`				Раздел4.3_3="${za(String(l.collateralInfo||""))}"
`,A+=`				Раздел4.3_4="${za(String(l.collateralLocation||""))}"
`,A+=`				Раздел4.3_5="2024"
`,A+=`				Раздел4.3_6="${za(String(l.collateralInfo||""))}"
`,A+=`				Раздел4.3_7="${za(String(l.collateralInfo||""))}"
`,A+=`				Раздел4.3_8="${za(String(l.collateralInfo||""))}"/>
`),A+=`		</Раздел4>
`;const g=l.pledger||l.borrower||"";g&&(A+=`		<Раздел5 Раздел5_1="${d}">
`,A+=`			<Раздел5.1
`,A+=`				Раздел5.1_2="${za(String(l.collateralLocation||""))}"
`,A+=`				Раздел5.1_3="${za(g)}"
`,A+=`				Раздел5.1_4="${za(g)}"
`,A+=`				Раздел5.1_5=""
`,A+=`				Раздел5.1_6=""
`,A+=`				Раздел5.1_7=""
`,A+=`				Раздел5.1_8="${String(l.inn||"")}"
`,A+=`				Раздел5.1_9=""/>
`,A+=`		</Раздел5>
`)}return A+=`	</Раздел310>
`,A+="</Ф0409310>",A}function za(e){return e==null?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function TA(e){if(!e||e==="-")return new Date().toISOString().split("T")[0];try{const t=String(e).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.split(/[./-]/);if(r.length===3){const[a,n,s]=r;return a.length===4?`${a}-${n.padStart(2,"0")}-${s.padStart(2,"0")}`:`${s}-${n.padStart(2,"0")}-${a.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]}catch{return new Date().toISOString().split("T")[0]}}function sd(e,t=2){if(e==null)return"0.00";try{return(typeof e=="string"?parseFloat(e.replace(/\s/g,"").replace(",",".")):Number(e)).toFixed(t)}catch{return"0.00"}}function Dz(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function jz(e,t){const r=new Blob([e],{type:"application/xml;charset=windows-1251"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}const Lz=()=>{const[e,t]=K.useState([]),[r,a]=K.useState(!0),[n,s]=K.useState(null),[o,A]=K.useState(""),[c,l]=K.useState(null),[d,f]=K.useState(null),[p,u]=K.useState(null),[g,h]=K.useState(!1);K.useEffect(()=>{let O=!0;return(async()=>{a(!0),s(null);try{const T="./",R=new URL(T,window.location.origin),L=R.pathname.endsWith("/")?R.pathname:`${R.pathname}/`,N=`${R.origin}${L}reportsData.json?v=${Date.now()}`,P=await fetch(N,{cache:"no-store"});if(!P.ok)throw new Error(`Не удалось загрузить отчеты (${P.status})`);const U=await P.json();if(!O)return;const V=U.reports||[];t(V.map(ie=>({...ie,key:ie.id})))}catch(T){s(T instanceof Error?T.message:"Неизвестная ошибка")}finally{O&&a(!1)}})(),()=>{O=!1}},[]);const y=K.useMemo(()=>Array.from(new Set(e.map(M=>M.status))).map(M=>({value:M,label:M==="draft"?"Черновик":M==="submitted"?"Отправлен":M==="approved"?"Утвержден":"Отклонен"})),[e]),x=K.useMemo(()=>Array.from(new Set(e.map(M=>M.reportDate))).sort().reverse().map(M=>({value:M,label:M})),[e]),v=K.useMemo(()=>{const O=o.trim().toLowerCase();return e.filter(M=>{const T=!O||[M.reportNumber,M.guid,M.reportDate].filter(Boolean).some(N=>String(N).toLowerCase().includes(O)),R=!c||M.status===c,L=!d||M.reportDate===d;return T&&R&&L})},[e,o,c,d]),E=K.useMemo(()=>{const O=v.length,M=v.filter(L=>L.status==="draft").length,T=v.filter(L=>L.status==="submitted").length,R=v.filter(L=>L.status==="approved").length;return{total:O,draft:M,submitted:T,approved:R}},[v]),D=K.useMemo(()=>({draft:"default",submitted:"processing",approved:"success",rejected:"error"}),[]),B=K.useMemo(()=>({draft:"Черновик",submitted:"Отправлен",approved:"Утвержден",rejected:"Отклонен"}),[]),I=K.useMemo(()=>[{title:"Номер отчета",dataIndex:"reportNumber",key:"reportNumber",width:200,render:(O,M)=>i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600},children:O}),i.jsxs("div",{className:"reports-muted",children:["GUID: ",M.guid.substring(0,8),"..."]})]})},{title:"Дата отчета",dataIndex:"reportDate",key:"reportDate",width:150,render:O=>i.jsxs(Fe,{children:[i.jsx(Wp,{}),i.jsx("span",{children:O})]})},{title:"Статус",dataIndex:"status",key:"status",width:150,render:O=>i.jsx(at,{color:D[O]||"default",children:B[O]||O})},{title:"Разделы",key:"sections",width:200,render:(O,M)=>{const T=[];return M.section1&&T.push("1"),M.section2&&T.push("2"),M.section3&&T.push("3"),M.section4&&T.push("4"),M.section5&&T.push("5"),M.section6&&T.push("6"),i.jsx("span",{children:T.join(", ")||"—"})}},{title:"Обновлен",dataIndex:"updatedAt",key:"updatedAt",width:180,render:O=>new Date(O).toLocaleString("ru-RU")}],[D,B]),_=O=>{u(O),h(!0)},S=async()=>{try{Ne.loading({content:"Загрузка данных портфеля...",key:"generate-xml"});const O="./",M=new URL(O,window.location.origin),T=M.pathname.endsWith("/")?M.pathname:`${M.pathname}/`,R=`${M.origin}${T}portfolioData.json?v=${Date.now()}`,L=await fetch(R,{cache:"no-store"});if(!L.ok)throw new Error("Не удалось загрузить данные портфеля");const N=await L.json();Ne.loading({content:"Генерация XML отчета...",key:"generate-xml"});const P=kz({portfolioData:N,creditOrgCode:"000000000",creditOrgName:"Кредитная организация",reportDate:new Date().toISOString().split("T")[0]}),U=`Ф310_${new Date().toISOString().split("T")[0].replace(/-/g,"")}_${Date.now()}.xml`;jz(P,U),Ne.success({content:`XML отчет "${U}" успешно сгенерирован и скачан`,key:"generate-xml",duration:4})}catch(O){Ne.error({content:O instanceof Error?O.message:"Ошибка при генерации XML отчета",key:"generate-xml",duration:4})}};return i.jsxs("div",{className:"reports-page",children:[i.jsxs("div",{className:"reports-header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"reports-title",children:"Отчеты (Форма 310)"}),i.jsx(mt.Paragraph,{className:"reports-subtitle",children:"Отчетность по залоговому имуществу в соответствии с формой 310 ЦБ РФ"})]}),i.jsxs(Fe,{size:"middle",direction:"vertical",children:[i.jsx(Xr,{title:"Поиск по номеру, GUID, дате",children:i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по отчетам",prefix:i.jsx(Pa,{}),value:o,onChange:O=>A(O.target.value),style:{width:360}})}),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),size:"large",onClick:S,children:"Сформировать XML отчет (Ф310)"})]})]}),i.jsx(Ge,{children:i.jsxs("div",{className:"reports-filters",children:[i.jsx(Ye,{allowClear:!0,placeholder:"Статус",style:{width:200},options:y,value:c??void 0,onChange:O=>l(O??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Дата отчета",style:{width:200},options:x,value:d??void 0,onChange:O=>f(O??null)})]})}),i.jsxs(ft,{gutter:[16,16],className:"reports-stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего отчетов",value:E.total,prefix:i.jsx(Qr,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Черновики",value:E.draft,prefix:i.jsx(Qr,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Отправлены",value:E.submitted,prefix:i.jsx(On,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Утверждены",value:E.approved,prefix:i.jsx(On,{})})})})]}),i.jsx(Ge,{className:"reports-table-card",bodyStyle:{padding:0},children:i.jsx(nr,{columns:I,dataSource:v,pagination:{pageSize:20,showSizeChanger:!1},scroll:{x:1200},loading:r,onRow:O=>({onDoubleClick:()=>_(O)}),locale:{emptyText:i.jsx(Br,{description:"Нет отчетов, удовлетворяющих фильтрам",className:"reports-empty"})}})}),n&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить отчеты",description:n,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),i.jsx(dr,{title:`Отчет ${(p==null?void 0:p.reportNumber)||""}`,open:g,onCancel:()=>{h(!1),u(null)},footer:[i.jsx(Be,{type:"primary",onClick:()=>{h(!1),u(null)},children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:p&&i.jsxs("div",{className:"reports-modal",children:[i.jsxs(we,{title:"Общая информация",bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Номер отчета",children:p.reportNumber}),i.jsx(we.Item,{label:"GUID",children:p.guid}),i.jsx(we.Item,{label:"Дата отчета",children:p.reportDate}),i.jsx(we.Item,{label:"Статус",children:i.jsx(at,{color:D[p.status]||"default",children:B[p.status]||p.status})}),i.jsx(we.Item,{label:"Создан",children:new Date(p.createdAt).toLocaleString("ru-RU")}),i.jsx(we.Item,{label:"Обновлен",children:new Date(p.updatedAt).toLocaleString("ru-RU")})]}),p.section1&&p.section1.items.length>0&&i.jsxs("div",{style:{marginTop:24},children:[i.jsx(mt.Title,{level:4,children:"Раздел 1: Общие сведения"}),i.jsxs(mt.Text,{type:"secondary",children:["Записей: ",p.section1.items.length]})]}),p.section2&&p.section2.items.length>0&&i.jsxs("div",{style:{marginTop:24},children:[i.jsx(mt.Title,{level:4,children:"Раздел 2: Финансовые показатели"}),i.jsxs(mt.Text,{type:"secondary",children:["Записей: ",p.section2.items.length]})]}),p.section3&&p.section3.items.length>0&&i.jsxs("div",{style:{marginTop:24},children:[i.jsx(mt.Title,{level:4,children:"Раздел 3: Оценка обеспечения"}),i.jsxs(mt.Text,{type:"secondary",children:["Записей: ",p.section3.items.length]})]}),p.errors&&p.errors.length>0&&i.jsx("div",{style:{marginTop:24},children:i.jsx(Nr,{type:"warning",message:"Ошибки при обработке",description:i.jsx("ul",{children:p.errors.map((O,M)=>i.jsxs("li",{children:[i.jsxs("strong",{children:[O.field,":"]})," ",O.message]},M))})})})]})})]})},Uz=()=>{const e=K.useRef(null),[t,r]=Ma.useState(!0);return K.useEffect(()=>{const a=e.current;if(!a)return;const n=()=>{r(!1)};a.addEventListener("load",n);const o="./zadachnik/index.html";return a.src=o,()=>{a.removeEventListener("load",n)}},[]),i.jsxs("div",{className:"tasks-page",children:[t&&i.jsx("div",{className:"tasks-loading",children:i.jsx(Zn,{size:"large",tip:"Загрузка системы задач..."})}),i.jsx("iframe",{ref:e,className:"tasks-iframe",title:"ЗАДАЧНИК - Система управления задачами",style:{display:t?"none":"block"}})]})},{TextArea:ku}=Re,{RangePicker:Mz}=Rr,zp=[{value:"primary",label:"Первичный осмотр"},{value:"periodic",label:"Периодический осмотр"},{value:"unscheduled",label:"Внеплановый осмотр"},{value:"after_repair",label:"Осмотр после ремонта"},{value:"before_loan",label:"Осмотр перед выдачей кредита"},{value:"revaluation",label:"Осмотр при переоценке"},{value:"monitoring",label:"Осмотр при мониторинге"},{value:"appraisal",label:"Осмотр при оценке"}],C1=[{value:"scheduled",label:"Запланирован",color:"blue"},{value:"in_progress",label:"В процессе",color:"orange"},{value:"completed",label:"Завершен",color:"green"},{value:"cancelled",label:"Отменен",color:"red"}],Pz=[{value:"excellent",label:"Отличное",color:"green"},{value:"good",label:"Хорошее",color:"blue"},{value:"satisfactory",label:"Удовлетворительное",color:"orange"},{value:"poor",label:"Плохое",color:"red"},{value:"critical",label:"Критическое",color:"red"}],Qz=()=>{const[e,t]=K.useState([]),[r,a]=K.useState(!1),[n,s]=K.useState(!1),[o,A]=K.useState(!1),[c,l]=K.useState(null),[d,f]=K.useState(null),[p]=ne.useForm(),[u,g]=K.useState("employee"),[h,y]=K.useState([]),[x,v]=K.useState({});K.useEffect(()=>{E()},[]);const E=async()=>{try{const N=await Yt.getExtendedCards();y(N)}catch(N){console.error("Ошибка загрузки карточек:",N)}};K.useEffect(()=>{D(),Ca.initDatabase()},[]);const D=async()=>{a(!0);try{const N=await Ca.getInspections();t(N)}catch(N){console.error("Ошибка загрузки осмотров:",N),Ne.error("Не удалось загрузить осмотры")}finally{a(!1)}},B=()=>{f(null),g("employee"),p.resetFields(),p.setFieldsValue({inspectorType:"employee"}),s(!0)},I=N=>{console.log("Opening inspection modal for:",N.id),console.log("Current viewModalVisible before:",o),l(N.id),A(!0),console.log("Set viewModalVisible to true, viewingInspectionId:",N.id),setTimeout(()=>{console.log("After timeout - viewModalVisible should be true")},0)},_=N=>{f(N),p.setFieldsValue({...N,inspectionDate:N.inspectionDate?We(N.inspectionDate):void 0,inspectionMethod:N.inspectionMethod||"Визуальный осмотр",propertyPresence:N.propertyPresence||"Наличие имущества подтверждается",propertyCondition:N.propertyCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",storageConditions:N.storageConditions||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",conclusions:N.conclusions||void 0,proposals:N.proposals||"-"}),s(!0)},S=async N=>{try{await Ca.deleteInspection(N),Ne.success("Осмотр удален"),D()}catch(P){console.error("Ошибка удаления осмотра:",P),Ne.error("Не удалось удалить осмотр")}},O=async()=>{try{const N=await p.validateFields(),P=new Date,U="Система",V={...N,inspectionType:N.inspectionType,status:N.status||"scheduled",inspectionDate:N.inspectionDate?N.inspectionDate.toDate():P,inspectorType:N.inspectorType||"employee",inspectorName:N.inspectorName||"",inspectorId:N.inspectorId||void 0,inspectorPhone:N.inspectorPhone||void 0,inspectorEmail:N.inspectorEmail||void 0,clientPhone:N.clientPhone||void 0,clientEmail:N.clientEmail||void 0,collateralCardId:N.collateralCardId||"",collateralName:N.collateralName||"",address:N.address||void 0,condition:N.condition,inspectionMethod:N.inspectionMethod||"Визуальный осмотр",propertyPresence:N.propertyPresence||"Наличие имущества подтверждается",propertyCondition:N.propertyCondition||"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",storageConditions:N.storageConditions||"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",conclusions:N.conclusions||void 0,proposals:N.proposals||"-",photos:(d==null?void 0:d.photos)||[],defects:(d==null?void 0:d.defects)||[],recommendations:(d==null?void 0:d.recommendations)||[],history:(d==null?void 0:d.history)||[{id:`hist-${Date.now()}`,date:P,action:"created",user:U,userRole:"creator",comment:"Осмотр создан",status:N.status||"scheduled"}],createdByUser:(d==null?void 0:d.createdByUser)||U};if(d)await Ca.updateInspection(d.id,V),Ne.success("Осмотр обновлен");else{const ie=await Ca.createInspection(V);if(N.inspectorType==="client"&&N.clientEmail){const W=await Ca.generateClientLink(ie);Ne.success(`Осмотр создан. Ссылка для клиента: ${W}`)}else Ne.success("Осмотр создан")}s(!1),p.resetFields(),g("employee"),D()}catch(N){console.error("Ошибка сохранения осмотра:",N),Ne.error("Не удалось сохранить осмотр")}},T=(()=>{let N=[...e];if(x.status&&(N=N.filter(P=>P.status===x.status)),x.type&&(N=N.filter(P=>P.inspectionType===x.type)),x.dateRange){const[P,U]=x.dateRange;N=N.filter(V=>{const ie=We(V.inspectionDate);return ie.isAfter(P.subtract(1,"day"))&&ie.isBefore(U.add(1,"day"))})}return N})(),R=Ma.useMemo(()=>{const N=e.length,P=e.reduce((V,ie)=>(V[ie.status]=(V[ie.status]||0)+1,V),{}),U=e.reduce((V,ie)=>(V[ie.inspectionType]=(V[ie.inspectionType]||0)+1,V),{});return{total:N,byStatus:P,byType:U}},[e]),L=[{title:"Дата осмотра",dataIndex:"inspectionDate",key:"inspectionDate",render:N=>We(N).format("DD.MM.YYYY HH:mm"),sorter:(N,P)=>We(N.inspectionDate).unix()-We(P.inspectionDate).unix()},{title:"Тип",dataIndex:"inspectionType",key:"inspectionType",render:N=>{const P=zp.find(U=>U.value===N);return(P==null?void 0:P.label)||N}},{title:"Инспектор",dataIndex:"inspectorName",key:"inspectorName"},{title:"Объект",dataIndex:"collateralName",key:"collateralName"},{title:"Статус",dataIndex:"status",key:"status",render:N=>{const P=C1.find(U=>U.value===N);return P?i.jsx(at,{color:P.color,children:P.label}):i.jsx(at,{children:N})}},{title:"Состояние",dataIndex:"condition",key:"condition",render:N=>{const P=Pz.find(U=>U.value===N);return P?i.jsx(at,{color:P.color,children:P.label}):i.jsx(at,{children:N})}},{title:"Действия",key:"actions",render:(N,P)=>i.jsxs(Fe,{children:[i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>I(P),size:"small",children:"Просмотр"}),i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),onClick:()=>_(P),size:"small",children:"Редактировать"}),i.jsx(fo,{title:"Удалить осмотр?",onConfirm:()=>S(P.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),size:"small",children:"Удалить"})})]})}];return i.jsxs("div",{style:{padding:"24px"},children:[i.jsxs(Ge,{children:[i.jsxs(ft,{gutter:16,style:{marginBottom:24},children:[i.jsx(Te,{span:6,children:i.jsx(yt,{title:"Всего осмотров",value:R.total})}),i.jsx(Te,{span:6,children:i.jsx(yt,{title:"Завершено",value:R.byStatus.completed||0,valueStyle:{color:"#3f8600"}})}),i.jsx(Te,{span:6,children:i.jsx(yt,{title:"В процессе",value:R.byStatus.in_progress||0,valueStyle:{color:"#cf1322"}})}),i.jsx(Te,{span:6,children:i.jsx(yt,{title:"Запланировано",value:R.byStatus.scheduled||0})})]}),i.jsxs(Fe,{style:{marginBottom:16,width:"100%",justifyContent:"space-between"},children:[i.jsxs(Fe,{children:[i.jsx(Ye,{placeholder:"Фильтр по статусу",allowClear:!0,style:{width:200},onChange:N=>v({...x,status:N}),children:C1.map(N=>i.jsx(Ye.Option,{value:N.value,children:N.label},N.value))}),i.jsx(Ye,{placeholder:"Фильтр по типу",allowClear:!0,style:{width:200},onChange:N=>v({...x,type:N}),children:zp.map(N=>i.jsx(Ye.Option,{value:N.value,children:N.label},N.value))}),i.jsx(Mz,{placeholder:["Дата начала","Дата окончания"],onChange:N=>v({...x,dateRange:N})})]}),i.jsxs(Fe,{children:[i.jsx(Be,{icon:i.jsx(ec,{}),onClick:D,children:"Обновить"}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:B,children:"Создать осмотр"})]})]}),i.jsx(nr,{columns:L,dataSource:T,rowKey:"id",loading:r,pagination:{pageSize:20},onRow:N=>({onDoubleClick:()=>{console.log("Double click on inspection:",N.id),I(N)},style:{cursor:"pointer"}})})]}),i.jsx(vC,{visible:o,inspectionId:c,onClose:()=>{console.log("Closing inspection modal"),A(!1),l(null)},onApprove:async N=>{await Ca.approveInspection(N,"Система"),Ne.success("Осмотр согласован"),D()},onRequestRevision:async(N,P)=>{await Ca.requestRevision(N,"Система",P),Ne.success("Запрошена доработка"),D()}}),i.jsx(dr,{title:d?"Редактировать осмотр":"Создать осмотр",open:n,onOk:O,onCancel:()=>{s(!1),p.resetFields()},width:600,children:i.jsxs(ne,{form:p,layout:"vertical",children:[i.jsx(ne.Item,{name:"inspectionType",label:"Тип осмотра",rules:[{required:!0,message:"Выберите тип осмотра"}],children:i.jsx(Ye,{placeholder:"Выберите тип осмотра",onChange:N=>{var U;const P=((U=zp.find(V=>V.value===N))==null?void 0:U.label)||"";p.setFieldsValue({inspectionTypeLabel:P})},children:zp.map(N=>i.jsx(Ye.Option,{value:N.value,children:N.label},N.value))})}),i.jsx(ne.Item,{name:"collateralCardId",label:"Объект залога",rules:[{required:!0,message:"Выберите объект залога"}],children:i.jsx(Ye,{placeholder:"Выберите объект залога",showSearch:!0,filterOption:(N,P)=>String((P==null?void 0:P.label)??"").toLowerCase().includes(N.toLowerCase()),onChange:N=>{var U,V,ie,W,z,G;const P=h.find(b=>b.id===N);if(P){const b=(U=P.partners)==null?void 0:U.find(ye=>ye.role==="pledgor"),k=(V=P.partners)==null?void 0:V.find(ye=>ye.role==="owner"),j=b?b.type==="legal"?b.organizationName||"":`${b.lastName||""} ${b.firstName||""} ${b.middleName||""}`.trim():"",q=k?k.type==="legal"?k.organizationName||"":`${k.lastName||""} ${k.firstName||""} ${k.middleName||""}`.trim():"",Y=P.pledgeContractId||((ie=P.characteristics)==null?void 0:ie.pledgeContractNumber)||"",de=(W=P.characteristics)!=null&&W.pledgeContractDate?We(P.characteristics.pledgeContractDate).format("DD.MM.YYYY"):"",ue=P.loanContractId||((z=P.characteristics)==null?void 0:z.loanContractNumber)||"",pe=(G=P.characteristics)!=null&&G.loanContractDate?We(P.characteristics.loanContractDate).format("DD.MM.YYYY"):"";p.setFieldsValue({collateralName:P.name,address:P.address?`${P.address.city||""} ${P.address.street||""} ${P.address.house||""}`.trim():void 0,pledgorName:j,borrowerName:q,pledgeContractNumber:Y,pledgeContractDate:de,loanContractNumber:ue,loanContractDate:pe})}},children:h.map(N=>i.jsxs(Ye.Option,{value:N.id,label:N.name,children:[N.name," (",N.number,")"]},N.id))})}),i.jsx(ne.Item,{name:"collateralName",label:"Название объекта",rules:[{required:!0,message:"Введите название объекта"}],children:i.jsx(Re,{placeholder:"Название объекта залога"})}),i.jsx(ne.Item,{name:"address",label:"Адрес",children:i.jsx(Re,{placeholder:"Адрес объекта"})}),i.jsx(ne.Item,{name:"inspectionDate",label:"Дата осмотра",rules:[{required:!0,message:"Выберите дату осмотра"}],children:i.jsx(Rr,{showTime:!0,style:{width:"100%"},format:"DD.MM.YYYY HH:mm"})}),i.jsx(ne.Item,{name:"inspectorType",label:"Исполнитель",rules:[{required:!0,message:"Выберите тип исполнителя"}],children:i.jsxs(Ye,{placeholder:"Выберите тип исполнителя",onChange:N=>{g(N),p.setFieldsValue({inspectorId:void 0,inspectorName:void 0,inspectorPhone:void 0,inspectorEmail:void 0,clientPhone:void 0,clientEmail:void 0})},children:[i.jsx(Ye.Option,{value:"employee",children:"Сотрудник банка"}),i.jsx(Ye.Option,{value:"client",children:"Клиент"})]})}),u==="employee"?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"inspectorId",label:"Сотрудник",rules:[{required:!0,message:"Выберите сотрудника"}],children:i.jsx(Ye,{placeholder:"Выберите сотрудника",showSearch:!0,filterOption:(N,P)=>String((P==null?void 0:P.label)??"").toLowerCase().includes(N.toLowerCase()),onChange:N=>{const P=fr.getEmployeeById(N);P&&p.setFieldsValue({inspectorName:`${P.lastName} ${P.firstName} ${P.middleName||""}`.trim(),inspectorPhone:P.phone,inspectorEmail:P.email})},children:fr.getEmployees().filter(N=>N.isActive).map(N=>i.jsxs(Ye.Option,{value:N.id,label:`${N.lastName} ${N.firstName} ${N.middleName||""}`.trim(),children:[`${N.lastName} ${N.firstName} ${N.middleName||""}`.trim()," - ",N.position]},N.id))})}),i.jsx(ne.Item,{name:"inspectorName",label:"ФИО инспектора",hidden:!0,children:i.jsx(Re,{})}),i.jsx(ne.Item,{name:"inspectorPhone",label:"Телефон",hidden:!0,children:i.jsx(Re,{})}),i.jsx(ne.Item,{name:"inspectorEmail",label:"Email",hidden:!0,children:i.jsx(Re,{})})]}):i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"inspectorName",label:"ФИО клиента",rules:[{required:!0,message:"Введите ФИО клиента"}],children:i.jsx(Re,{placeholder:"ФИО клиента"})}),i.jsx(ne.Item,{name:"clientPhone",label:"Телефон клиента",rules:[{required:!0,message:"Введите телефон клиента"}],children:i.jsx(Re,{placeholder:"+7 (___) ___-__-__"})}),i.jsx(ne.Item,{name:"clientEmail",label:"Email клиента",rules:[{required:!0,message:"Введите email клиента"},{type:"email",message:"Введите корректный email"}],children:i.jsx(Re,{placeholder:"email@example.com"})})]}),i.jsx(ne.Item,{name:"status",label:"Статус",initialValue:"scheduled",children:i.jsx(Ye,{placeholder:"Выберите статус",children:C1.map(N=>i.jsx(Ye.Option,{value:N.value,children:N.label},N.value))})}),i.jsx(jt,{orientation:"left",children:"Данные акта проверки наличия и состояния залога"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgorName",label:"Наименование Залогодателя",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"borrowerName",label:"Наименование Заемщика",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgeContractNumber",label:"Номер договора залога",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgeContractDate",label:"Дата договора залога",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"loanContractNumber",label:"Номер кредитного договора",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"loanContractDate",label:"Дата кредитного договора",children:i.jsx(Re,{placeholder:"Автоматически из карточки залога",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"inspectionMethod",label:"Способ проверки",initialValue:"Визуальный осмотр",rules:[{required:!0,message:"Укажите способ проверки"}],children:i.jsxs(Ye,{placeholder:"Выберите способ проверки",children:[i.jsx(Ye.Option,{value:"Визуальный осмотр",children:"Визуальный осмотр"}),i.jsx(Ye.Option,{value:"Инструментальный осмотр",children:"Инструментальный осмотр"}),i.jsx(Ye.Option,{value:"Экспертиза",children:"Экспертиза"})]})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"inspectionTypeLabel",label:"Тип осмотра",children:i.jsx(Re,{placeholder:"Автоматически из типа осмотра",disabled:!0,style:{backgroundColor:"#f5f5f5"}})})})]}),i.jsx(ne.Item,{name:"propertyPresence",label:"Наличие заложенного имущества",initialValue:"Наличие имущества подтверждается",rules:[{required:!0,message:"Укажите наличие имущества"}],children:i.jsxs(Ye,{placeholder:"Выберите вариант",children:[i.jsx(Ye.Option,{value:"Наличие имущества подтверждается",children:"Наличие имущества подтверждается"}),i.jsx(Ye.Option,{value:"Наличие имущества не подтверждается",children:"Наличие имущества не подтверждается"}),i.jsx(Ye.Option,{value:"Имущество частично отсутствует",children:"Имущество частично отсутствует"})]})}),i.jsx(ne.Item,{name:"propertyCondition",label:"Состояние заложенного имущества",initialValue:"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению",rules:[{required:!0,message:"Опишите состояние имущества"}],children:i.jsx(ku,{rows:3,placeholder:"Имущество в сохранности, перепланировок/переоборудований не выявлено, эксплуатируется по назначению"})}),i.jsx(ne.Item,{name:"storageConditions",label:"Соответствие условий хранения/эксплуатации заложенного имущества",initialValue:"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)",rules:[{required:!0,message:"Опишите условия хранения/эксплуатации"}],children:i.jsx(ku,{rows:3,placeholder:"Условия хранения/эксплуатации частично соблюдаются (уточнения в Приложении 1)"})}),i.jsx(ne.Item,{name:"conclusions",label:"Выводы",rules:[{required:!0,message:"Укажите выводы"}],children:i.jsx(ku,{rows:3,placeholder:"Имущество соответствует требованиям для принятия в залог"})}),i.jsx(ne.Item,{name:"proposals",label:"Предложения",initialValue:"-",children:i.jsx(ku,{rows:2,placeholder:"Предложения по улучшению состояния имущества или условий его хранения"})}),i.jsx(ne.Item,{name:"notes",label:"Примечания",children:i.jsx(ku,{rows:4,placeholder:"Дополнительная информация"})})]})})]})},qz=()=>i.jsx(Qz,{}),{Title:OE,Text:IE,Paragraph:Kz}=mt,{Step:Hz}=o_,B1=(e,t)=>e.includes("real_estate")?[{title:"Фасад",description:"Сфотографируйте фасад здания"},{title:"Вход",description:"Сфотографируйте вход в здание"},{title:"Внутри",description:"Сфотографируйте внутренние помещения"},{title:"Документы",description:"Сфотографируйте документы на объект"}]:e.includes("movable")?[{title:"Общий вид",description:"Сфотографируйте объект с разных сторон"},{title:"Серийный номер",description:"Сфотографируйте серийный номер или VIN"},{title:"Состояние",description:"Сфотографируйте повреждения или особенности"},{title:"Документы",description:"Сфотографируйте документы на объект"}]:[{title:"Общий вид",description:"Сфотографируйте объект"},{title:"Детали",description:"Сфотографируйте детали объекта"},{title:"Документы",description:"Сфотографируйте документы"}],Gz=()=>{const{token:e}=sT(),t=$s(),[r,a]=K.useState(null),[n,s]=K.useState(!0),[o,A]=K.useState(0),[c,l]=K.useState(!1),[d,f]=K.useState(null),[p,u]=K.useState({}),[g,h]=K.useState(!1),y=K.useCallback(async()=>{var I;s(!0);try{const _=await Ca.getInspectionByToken(e);if(!_){Ne.error("Осмотр не найден или ссылка истекла"),t("/");return}a(_);const S=B1(_.inspectionType),O={};(I=_.photos)==null||I.forEach(M=>{const T=S.findIndex(R=>R.title===M.step||R.title===M.location);T>=0?(O[T]||(O[T]=[]),O[T].push(M)):(O[0]||(O[0]=[]),O[0].push(M))}),u(O)}catch(_){console.error("Ошибка загрузки осмотра:",_),Ne.error("Не удалось загрузить осмотр")}finally{s(!1)}},[e,t]);K.useEffect(()=>{e&&y()},[e,y]);const x=()=>{if(!navigator.geolocation){Ne.error("Геолокация не поддерживается вашим браузером");return}navigator.geolocation.getCurrentPosition(I=>{f({lat:I.coords.latitude,lon:I.coords.longitude,accuracy:I.coords.accuracy||0}),l(!0),Ne.success("Геолокация получена")},I=>{console.error("Ошибка геолокации:",I),Ne.error("Не удалось получить геолокацию")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},v=(I,_)=>{const S=new FileReader;S.onload=async O=>{var N;const M=(N=O.target)==null?void 0:N.result,R=B1((r==null?void 0:r.inspectionType)||"")[I],L={id:`photo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,url:M,description:R.description,location:R.title,step:R.title,takenAt:new Date,latitude:d==null?void 0:d.lat,longitude:d==null?void 0:d.lon,accuracy:d==null?void 0:d.accuracy};if(u(P=>({...P,[I]:[...P[I]||[],L]})),r)try{await Ca.addPhoto(r.id,L)}catch(P){console.error("Ошибка сохранения фото:",P)}},S.readAsDataURL(_)},E=async()=>{if(r){h(!0);try{await Ca.submitForReview(r.id,r.inspectorName),d&&await Ca.updateInspection(r.id,{latitude:d.lat,longitude:d.lon,geolocationConsent:!0}),Ne.success("Осмотр отправлен на проверку"),setTimeout(()=>{t("/")},2e3)}catch(I){console.error("Ошибка отправки осмотра:",I),Ne.error("Не удалось отправить осмотр")}finally{h(!1)}}};if(n)return i.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[i.jsx(Zn,{size:"large"}),i.jsx("div",{style:{marginTop:16},children:i.jsx(IE,{children:"Загрузка осмотра..."})})]});if(!r)return i.jsx("div",{style:{padding:"40px"},children:i.jsx(Nr,{message:"Осмотр не найден",description:"Ссылка недействительна или истекла",type:"error"})});const D=B1(r.inspectionType),B=p[o]||[];return i.jsx("div",{className:"mobile-inspection-page",children:i.jsx(Ge,{children:i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(OE,{level:4,children:"Осмотр объекта"}),i.jsx(IE,{type:"secondary",children:r.collateralName})]}),i.jsx(Nr,{message:"Согласие на геолокацию",description:"Для проведения осмотра необходимо предоставить доступ к геолокации",type:"info",action:i.jsx(tc,{checked:c,onChange:I=>{l(I.target.checked),I.target.checked&&x()},children:"Разрешить"})}),d&&i.jsx(Nr,{message:"Геолокация получена",description:`Координаты: ${d.lat.toFixed(6)}, ${d.lon.toFixed(6)}`,type:"success",icon:i.jsx(tA,{})}),i.jsx(o_,{current:o,direction:"vertical",size:"small",children:D.map((I,_)=>i.jsx(Hz,{title:I.title,description:I.description,status:o===_?"process":p[_]&&p[_].length>0?"finish":"wait",icon:p[_]&&p[_].length>0?i.jsx(On,{style:{color:"#52c41a"}}):void 0},_))}),i.jsx(Ge,{children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsx(OE,{level:5,children:D[o].title}),i.jsx(Kz,{children:D[o].description}),i.jsx(Xi,{accept:"image/*",capture:"environment",showUploadList:!1,beforeUpload:I=>(v(o,I),!1),children:i.jsx(Be,{type:"primary",icon:i.jsx(Ko,{}),size:"large",block:!0,children:"Сфотографировать"})}),B.length>0&&i.jsx(ft,{gutter:[8,8],children:B.map(I=>i.jsx(Te,{xs:12,sm:8,md:6,children:i.jsx(am,{src:I.url,alt:I.description,style:{width:"100%",borderRadius:4},preview:!0})},I.id))})]})}),i.jsxs(Fe,{style:{width:"100%",justifyContent:"space-between"},children:[i.jsx(Be,{disabled:o===0,onClick:()=>A(o-1),children:"Назад"}),o<D.length-1?i.jsx(Be,{type:"primary",onClick:()=>A(o+1),children:"Далее"}):i.jsx(Be,{type:"primary",icon:i.jsx(A_,{}),onClick:E,loading:g,disabled:!c,children:"Отправить на проверку"})]})]})})})},{TextArea:zz}=Re,{Option:Vz}=Ye,{Title:$z}=mt,Yz=({collateralType:e})=>{const t=Dy(e),r=a=>{var s;const n=a.required?[{required:!0,message:`Поле "${a.label}" обязательно для заполнения`}]:[];switch(a.type){case"text":return i.jsx(ne.Item,{name:a.key,label:a.label,rules:n,children:i.jsx(Re,{placeholder:a.placeholder||a.label})},a.key);case"number":return i.jsx(ne.Item,{name:a.key,label:a.label,rules:n,children:i.jsx(fa,{style:{width:"100%"},placeholder:a.placeholder||a.label,min:a.min,max:a.max,addonAfter:a.unit})},a.key);case"boolean":return i.jsx(ne.Item,{name:a.key,label:a.label,valuePropName:"checked",children:i.jsx(Ni,{})},a.key);case"select":return i.jsx(ne.Item,{name:a.key,label:a.label,rules:n,children:i.jsx(Ye,{placeholder:a.placeholder||`Выберите ${a.label.toLowerCase()}`,allowClear:!0,children:(s=a.options)==null?void 0:s.map(o=>i.jsx(Vz,{value:o,children:o},o))})},a.key);case"date":return i.jsx(ne.Item,{name:a.key,label:a.label,rules:n,children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD",placeholder:a.placeholder||a.label})},a.key);case"textarea":return i.jsx(ne.Item,{name:a.key,label:a.label,rules:n,children:i.jsx(zz,{rows:3,placeholder:a.placeholder||a.label})},a.key);default:return null}};return!e||Object.keys(t).length===0?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Выберите тип имущества для отображения атрибутов"}):i.jsx("div",{children:Object.entries(t).map(([a,n])=>i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx(jt,{orientation:"left",children:i.jsx($z,{level:5,style:{margin:0},children:a})}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:n.map(s=>r(s))})]},a))})},{TextArea:no}=Re,{Option:er}=Ye,Wz=({visible:e,onCancel:t,onSuccess:r})=>{const[a]=ne.useForm(),[n,s]=K.useState(!1),[o,A]=K.useState([]),[c,l]=K.useState(null);K.useEffect(()=>{e&&(a.resetFields(),a.setFieldsValue({conclusionDate:We(),authorDate:We().format("YYYY-MM-DD"),status:"Черновик",conclusionType:"Первичное"}),d())},[e,a]);const d=async()=>{try{const u="./",g=new URL(u,window.location.origin),h=g.pathname.endsWith("/")?g.pathname:`${g.pathname}/`,y=`${g.origin}${h}portfolioData.json?v=${Date.now()}`,x=await fetch(y,{cache:"no-store"});if(x.ok){const v=await x.json();A(v)}}catch(u){console.error("Ошибка загрузки данных портфеля:",u)}},f=async()=>{try{const u=await a.validateFields();s(!0);const g=`ЗК-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,h={id:`conclusion-${Date.now()}`,conclusionNumber:g,conclusionDate:u.conclusionDate.format("YYYY-MM-DD"),reference:u.reference||null,contractNumber:u.contractNumber||null,pledger:u.pledger||null,pledgerInn:u.pledgerInn||null,borrower:u.borrower||null,borrowerInn:u.borrowerInn||null,creditProduct:u.creditProduct||null,creditAmount:u.creditAmount?parseFloat(u.creditAmount):null,creditTermMonths:u.creditTermMonths?parseInt(u.creditTermMonths):null,collateralType:u.collateralType||null,collateralName:u.collateralName||null,collateralPurpose:u.collateralPurpose||null,totalAreaSqm:u.totalAreaSqm?parseFloat(u.totalAreaSqm):null,totalAreaHectares:u.totalAreaHectares?parseFloat(u.totalAreaHectares):null,collateralLocation:u.collateralLocation||null,objectsCount:u.objectsCount?parseInt(u.objectsCount):null,ownershipShare:u.ownershipShare?parseFloat(u.ownershipShare):null,landCategory:u.landCategory||null,landPermittedUse:u.landPermittedUse||null,landCadastralNumber:u.landCadastralNumber||null,landAreaSqm:u.landAreaSqm?parseFloat(u.landAreaSqm):null,marketValue:u.marketValue?parseFloat(u.marketValue):null,collateralValue:u.collateralValue?parseFloat(u.collateralValue):null,fairValue:u.fairValue?parseFloat(u.fairValue):null,category:u.category||null,liquidity:u.liquidity||null,liquidityFairValue:u.liquidityFairValue||null,collateralDescription:u.collateralDescription||null,collateralCondition:u.collateralCondition||null,hasReplanning:u.hasReplanning!==void 0?u.hasReplanning:null,landFunctionalProvision:u.landFunctionalProvision||null,hasEncumbrances:u.hasEncumbrances!==void 0?u.hasEncumbrances:null,encumbrancesDescription:u.encumbrancesDescription||null,encumbrancesDetails:u.encumbrancesDetails||null,ownershipBasis:u.ownershipBasis||null,ownershipDocuments:u.ownershipDocuments||null,registrationRecord:u.registrationRecord||null,registrationDocument:u.registrationDocument||null,replanningDescription:u.replanningDescription||null,inspectionDate:u.inspectionDate?u.inspectionDate.format("YYYY-MM-DD"):null,inspectorName:u.inspectorName||null,bankruptcyCheckDate:u.bankruptcyCheckDate?u.bankruptcyCheckDate.format("YYYY-MM-DD"):null,bankruptcyCheckResult:u.bankruptcyCheckResult||null,specialOpinion:u.specialOpinion||null,creditContractNumber:u.creditContractNumber||null,cadastralValue:u.cadastralValue?parseFloat(u.cadastralValue):null,marketValuePerSqm:u.marketValuePerSqm?parseFloat(u.marketValuePerSqm):null,marketValuePerHectare:u.marketValuePerHectare?parseFloat(u.marketValuePerHectare):null,liquidityMovable:u.liquidityMovable||null,landAreaHectares:u.landAreaHectares?parseFloat(u.landAreaHectares):null,conclusionType:u.conclusionType,status:u.status,statusColor:u.status==="Согласовано"?"green":u.status==="На согласовании"?"blue":u.status==="Отклонено"||u.status==="Аннулировано"?"red":void 0,author:u.author||"Система",authorDate:u.authorDate||We().format("YYYY-MM-DD"),approver:u.approver||null,approvalDate:u.approvalDate?u.approvalDate.format("YYYY-MM-DD"):null,conclusionText:u.conclusionText||"",recommendations:u.recommendations||void 0,riskLevel:u.riskLevel||void 0,notes:u.notes||void 0},y="./",x=new URL(y,window.location.origin),v=x.pathname.endsWith("/")?x.pathname:`${x.pathname}/`,E=`${x.origin}${v}collateralConclusionsData.json?v=${Date.now()}`,D=await fetch(E,{cache:"no-store"});let B=[];D.ok&&(B=await D.json()),B.push(h),Ne.success(`Заключение "${g}" создано (в демо-версии данные не сохраняются)`),a.resetFields(),s(!1),r==null||r(),t()}catch(u){console.error("Ошибка создания заключения:",u),Ne.error("Ошибка при создании заключения"),s(!1)}},p=u=>{const g=o.find(h=>String(h.reference)===String(u));if(g){const h=g.collateralType||null;l(h),a.setFieldsValue({contractNumber:g.contractNumber||null,pledger:g.pledger||null,pledgerInn:g.inn||null,borrower:g.borrower||null,collateralType:h,collateralLocation:g.collateralLocation||null,collateralValue:g.collateralValue||null,marketValue:g.marketValue||g.currentMarketValue||null,fairValue:g.fairValue||null,category:g.qualityCategory||null,liquidity:g.liquidity||null})}};return i.jsx(dr,{title:"Создать залоговое заключение",open:e,onCancel:t,footer:[i.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),i.jsx(Be,{type:"primary",loading:n,onClick:f,children:"Создать"},"submit")],width:900,children:i.jsxs(ne,{form:a,layout:"vertical",children:[i.jsx(ne.Item,{name:"reference",label:"REFERENCE сделки",tooltip:"Выберите сделку из портфеля для автозаполнения данных",children:i.jsx(Ye,{placeholder:"Выберите REFERENCE",showSearch:!0,allowClear:!0,onChange:p,filterOption:(u,g)=>String((g==null?void 0:g.children)||"").toLowerCase().includes(u.toLowerCase()),children:o.map(u=>i.jsxs(er,{value:u.reference,children:[u.reference," - ",u.borrower||u.pledger||"Не указано"]},u.reference))})}),i.jsx(ne.Item,{name:"conclusionType",label:"Тип заключения",rules:[{required:!0}],children:i.jsxs(Ye,{children:[i.jsx(er,{value:"Первичное",children:"Первичное"}),i.jsx(er,{value:"Повторное",children:"Повторное"}),i.jsx(er,{value:"Дополнительное",children:"Дополнительное"}),i.jsx(er,{value:"Переоценка",children:"Переоценка"})]})}),i.jsx(ne.Item,{name:"conclusionDate",label:"Дата заключения",rules:[{required:!0}],children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),i.jsx(ne.Item,{name:"status",label:"Статус",rules:[{required:!0}],children:i.jsxs(Ye,{children:[i.jsx(er,{value:"Черновик",children:"Черновик"}),i.jsx(er,{value:"На согласовании",children:"На согласовании"}),i.jsx(er,{value:"Согласовано",children:"Согласовано"}),i.jsx(er,{value:"Отклонено",children:"Отклонено"}),i.jsx(er,{value:"Аннулировано",children:"Аннулировано"})]})}),i.jsx(ne.Item,{name:"contractNumber",label:"№ договора",children:i.jsx(Re,{placeholder:"Номер договора"})}),i.jsx(ne.Item,{name:"pledger",label:"Залогодатель",children:i.jsx(Re,{placeholder:"Залогодатель"})}),i.jsx(ne.Item,{name:"pledgerInn",label:"ИНН залогодателя",children:i.jsx(Re,{placeholder:"ИНН"})}),i.jsx(ne.Item,{name:"borrower",label:"Заемщик",children:i.jsx(Re,{placeholder:"Заемщик"})}),i.jsx(ne.Item,{name:"collateralType",label:"Тип залога",children:i.jsxs(Ye,{placeholder:"Выберите тип залога",allowClear:!0,onChange:u=>l(u||null),showSearch:!0,filterOption:(u,g)=>String((g==null?void 0:g.children)||"").toLowerCase().includes(u.toLowerCase()),children:[i.jsx(er,{value:"Недвижимость",children:"Недвижимость"}),i.jsx(er,{value:"Транспортные средства",children:"Транспортные средства"}),i.jsx(er,{value:"Оборудование",children:"Оборудование"}),i.jsx(er,{value:"Товары в обороте",children:"Товары в обороте"}),i.jsx(er,{value:"Ценные бумаги",children:"Ценные бумаги"}),i.jsx(er,{value:"Права требования",children:"Права требования"}),i.jsx(er,{value:"apartment",children:"Квартира"}),i.jsx(er,{value:"house",children:"Жилой дом"}),i.jsx(er,{value:"office",children:"Офис"}),i.jsx(er,{value:"retail",children:"Торговое помещение"}),i.jsx(er,{value:"warehouse",children:"Склад"}),i.jsx(er,{value:"gas_station",children:"АЗС"}),i.jsx(er,{value:"car_passenger",children:"Легковой автомобиль"}),i.jsx(er,{value:"car_truck",children:"Грузовой автомобиль"}),i.jsx(er,{value:"equipment",children:"Оборудование"}),i.jsx(er,{value:"machinery",children:"Техника"})]})}),i.jsx(ne.Item,{name:"collateralPurpose",label:"Назначение обеспечения",children:i.jsx(Re,{placeholder:"Назначение обеспечения"})}),i.jsx(Yz,{collateralType:c,form:a}),i.jsx(ne.Item,{name:"landCategory",label:"Категория земель",children:i.jsx(Re,{placeholder:"Категория земель"})}),i.jsx(ne.Item,{name:"landPermittedUse",label:"Разрешенный вид использования",children:i.jsx(Re,{placeholder:"Разрешенный вид использования"})}),i.jsx(ne.Item,{name:"landAreaSqm",label:"Площадь земельного участка, кв.м.",children:i.jsx(Re,{type:"number",placeholder:"Площадь земельного участка"})}),i.jsx(ne.Item,{name:"landAreaHectares",label:"Площадь земельного участка, га",children:i.jsx(Re,{type:"number",step:"0.01",placeholder:"Площадь в гектарах"})}),i.jsx(ne.Item,{name:"collateralDescription",label:"Описание имущества",children:i.jsx(no,{rows:4,placeholder:"Состояние и краткое описание имущества"})}),i.jsx(ne.Item,{name:"collateralCondition",label:"Состояние имущества",children:i.jsxs(Ye,{placeholder:"Выберите состояние",children:[i.jsx(er,{value:"хорошее",children:"Хорошее"}),i.jsx(er,{value:"удовлетворительное",children:"Удовлетворительное"}),i.jsx(er,{value:"неудовлетворительное",children:"Неудовлетворительное"})]})}),i.jsx(ne.Item,{name:"hasReplanning",label:"Наличие перепланировок",children:i.jsxs(Ye,{placeholder:"Выберите",children:[i.jsx(er,{value:!0,children:"Да"}),i.jsx(er,{value:!1,children:"Нет"})]})}),i.jsx(ne.Item,{name:"replanningDescription",label:"Выявленные перепланировки",children:i.jsx(no,{rows:3,placeholder:"Описание перепланировок"})}),i.jsx(ne.Item,{name:"hasEncumbrances",label:"Наличие обременений",children:i.jsxs(Ye,{placeholder:"Выберите",children:[i.jsx(er,{value:!0,children:"Да"}),i.jsx(er,{value:!1,children:"Нет"})]})}),i.jsx(ne.Item,{name:"encumbrancesDescription",label:"Описание обременений",children:i.jsx(no,{rows:3,placeholder:"Описание обременений"})}),i.jsx(ne.Item,{name:"encumbrancesDetails",label:"Выявленные обременения",children:i.jsx(no,{rows:3,placeholder:"Детальное описание выявленных обременений"})}),i.jsx(ne.Item,{name:"ownershipBasis",label:"Право, на основании которого объект принадлежит Залогодателю",children:i.jsx(Re,{placeholder:"Право собственности, аренды и т.д."})}),i.jsx(ne.Item,{name:"ownershipDocuments",label:"Документы-основания возникновения права собственности",children:i.jsx(no,{rows:3,placeholder:"Описание документов"})}),i.jsx(ne.Item,{name:"registrationRecord",label:"Запись регистрации в ЕГРН (дата, №)",children:i.jsx(Re,{placeholder:"Запись регистрации"})}),i.jsx(ne.Item,{name:"registrationDocument",label:"Правоподтверждающий документ",children:i.jsx(no,{rows:2,placeholder:"Выписка из ЕГРН и т.д."})}),i.jsx(ne.Item,{name:"inspectionDate",label:"Дата осмотра / проверки",children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),i.jsx(ne.Item,{name:"inspectorName",label:"Сотрудник ПР, проводивший проверку",children:i.jsx(Re,{placeholder:"ФИО сотрудника"})}),i.jsx(ne.Item,{name:"bankruptcyCheckDate",label:"Дата проверки на банкротство",children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})}),i.jsx(ne.Item,{name:"bankruptcyCheckResult",label:"Результат проверки на банкротство",children:i.jsx(Re,{placeholder:"Результат проверки"})}),i.jsx(ne.Item,{name:"category",label:"Категория обеспечения",children:i.jsxs(Ye,{placeholder:"Выберите категорию",children:[i.jsx(er,{value:"Формальное",children:"Формальное"}),i.jsx(er,{value:"Достаточное",children:"Достаточное"}),i.jsx(er,{value:"Недостаточное",children:"Недостаточное"})]})}),i.jsx(ne.Item,{name:"liquidity",label:"Ликвидность",children:i.jsxs(Ye,{placeholder:"Выберите ликвидность",children:[i.jsx(er,{value:"высокая (срок реализации до 90 дней)",children:"Высокая (срок реализации до 90 дней)"}),i.jsx(er,{value:"удовлетворительная (срок реализации до 365 дней)",children:"Удовлетворительная (срок реализации до 365 дней)"}),i.jsx(er,{value:"низкая (срок реализации свыше 365 дней)",children:"Низкая (срок реализации свыше 365 дней)"}),i.jsx(er,{value:"малоудовлетворительная",children:"Малоудовлетворительная"})]})}),i.jsx(ne.Item,{name:"riskLevel",label:"Уровень риска",children:i.jsxs(Ye,{placeholder:"Выберите уровень риска",children:[i.jsx(er,{value:"Низкий",children:"Низкий"}),i.jsx(er,{value:"Средний",children:"Средний"}),i.jsx(er,{value:"Высокий",children:"Высокий"}),i.jsx(er,{value:"Критический",children:"Критический"})]})}),i.jsx(ne.Item,{name:"collateralValue",label:"Оценочная стоимость, руб.",children:i.jsx(Re,{type:"number",placeholder:"Оценочная стоимость"})}),i.jsx(ne.Item,{name:"marketValue",label:"Рыночная стоимость, руб.",children:i.jsx(Re,{type:"number",placeholder:"Рыночная стоимость"})}),i.jsx(ne.Item,{name:"fairValue",label:"Справедливая стоимость, руб.",children:i.jsx(Re,{type:"number",placeholder:"Справедливая стоимость"})}),i.jsx(ne.Item,{name:"cadastralValue",label:"Кадастровая стоимость, руб.",children:i.jsx(Re,{type:"number",placeholder:"Кадастровая стоимость"})}),i.jsx(ne.Item,{name:"marketValuePerSqm",label:"Рыночная стоимость, руб./кв.м.",children:i.jsx(Re,{type:"number",placeholder:"Стоимость за кв.м."})}),i.jsx(ne.Item,{name:"marketValuePerHectare",label:"Рыночная стоимость, руб./сот.",children:i.jsx(Re,{type:"number",placeholder:"Стоимость за сотку"})}),i.jsx(ne.Item,{name:"conclusionText",label:"Текст заключения",rules:[{required:!0}],children:i.jsx(no,{rows:6,placeholder:"Введите текст заключения"})}),i.jsx(ne.Item,{name:"recommendations",label:"Рекомендации",children:i.jsx(no,{rows:4,placeholder:"Введите рекомендации"})}),i.jsx(ne.Item,{name:"specialOpinion",label:"Особое мнение",children:i.jsx(no,{rows:6,placeholder:"Введите особое мнение"})}),i.jsx(ne.Item,{name:"notes",label:"Примечания",children:i.jsx(no,{rows:3,placeholder:"Введите примечания"})}),i.jsx(ne.Item,{name:"author",label:"Автор",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Автор заключения"})}),i.jsx(ne.Item,{name:"authorDate",label:"Дата создания",children:i.jsx(Re,{disabled:!0})}),i.jsx(ne.Item,{name:"approver",label:"Согласующий",children:i.jsx(Re,{placeholder:"Согласующий"})}),i.jsx(ne.Item,{name:"approvalDate",label:"Дата согласования",children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})})]})})},A2=[{id:"risk_001",code:"001",name:"Внезапное изменение состава, структуры и количества предмета залога",category:"collateral"},{id:"risk_002",code:"002",name:"Нарушение условий хранения, эксплуатации или содержания имущества, угрожающее утратой или повреждением имущества",category:"collateral"},{id:"risk_003",code:"003",name:"Ухудшение качества или повреждение заложенного имущества, а также по другим причинам, повлекшим изменение его ликвидности",category:"collateral"},{id:"risk_004",code:"004",name:"Перемещение залогового обеспечения по адресу (адресам), не указанным в договоре залога, за исключениям имущества, перемещение которого является типичным условием его эксплуатации",category:"collateral"},{id:"risk_005",code:"005",name:"Появление любой существенной негативной информации о Заемщике/Залогодателе",category:"borrower"},{id:"risk_006",code:"006",name:"Отклонение фактических показателей деятельности Залогодателя (либо выручки, либо EBITDA, либо чистой прибыли, либо объема поступивших денежных средств по договорам аренды) в одном квартальном периоде более чем на 20% от запланированных",category:"financial"},{id:"risk_007",code:"007",name:"Выбытие основного(ых) контрагента(ов) Залогодателя, генерирующего(их) более 25% от общего потока арендных платежей",category:"financial"},{id:"risk_008",code:"008",name:"Изменение в составе собственников и / или руководстве Залогодателя, которые могут негативно повлиять на бизнес Залогодателя",category:"borrower"},{id:"risk_009",code:"009",name:"Наличие серьезных разногласий и конфронтации между акционерами / участниками Залогодателя",category:"borrower"},{id:"risk_010",code:"010",name:"Снижение в течение квартала пассажиропотока/ погрузки и/или пассажирооборота/ грузооборота Залогодателя более чем на 20% по сравнению с прошлым сопоставимым периодом",category:"transport"},{id:"risk_011",code:"011",name:"Введение ограничений на эксплуатацию транспортных средств, используемых Залогодателем, которые могут повлечь за собой снижение пассажиропотока / погрузки более чем на 20%",category:"transport"},{id:"risk_012",code:"012",name:"Снижение рейтинга Заемщика более чем на 3 пункта с момента его предыдущего пересмотра, в случае если новый рейтинг Заемщика 20 и ниже",category:"rating"},{id:"risk_013",code:"013",name:"Любое снижение рейтинга Заемщика с момента его предыдущего пересмотра, в случае если новый рейтинг Заемщика 23-26",category:"rating"},{id:"risk_014",code:"014",name:"Наличие негативных тенденций отрасли Заемщика/Залогодателя, отраженных в рейтинговой модели/отраслевых стратегиях Банка",category:"industry"},{id:"risk_015",code:"015",name:"Снижение поступления объемов выручки Заемщика более чем на 20% по сравнению с предшествующим месяцем",category:"financial"},{id:"risk_016",code:"016",name:"Снижение величины основных средств в представленной Залогодателем бухгалтерской (финансовой) отчетности более чем на 20% по сравнению с предшествующим кварталом",category:"financial"},{id:"risk_017",code:"017",name:"Проведение в отношении Заемщика/Залогодателя процедур, предусмотренных законодательством о несостоятельности (банкротстве)",category:"legal"}],{Paragraph:od,Text:S1}=mt,Xz=({conclusion:e,onEdit:t,onPrint:r,onExport:a})=>{const n=$s(),s=Ma.useCallback(l=>{try{const d=localStorage.getItem("creditRiskRecords"),f=d?JSON.parse(d):[],p={id:`risk-${Date.now()}`,reference:e.reference||"",contractNumber:e.contractNumber||void 0,pledger:e.pledger||"",pledgerInn:e.pledgerInn||void 0,borrower:e.borrower||void 0,borrowerInn:e.borrowerInn||void 0,riskEvent:A2[0],suspensiveConditionId:l.id,suspensiveConditionDescription:l.description,insuranceRelated:!1,status:"active",eventDate:We().format("YYYY-MM-DD"),detectionDate:We().format("YYYY-MM-DD"),priority:"medium",documents:[],createdAt:We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")};f.push(p),localStorage.setItem("creditRiskRecords",JSON.stringify(f)),Ne.success("Отлагательное условие добавлено в модуль ФКР"),setTimeout(()=>{n("/credit-risk")},500)}catch(d){console.error("Ошибка добавления в ФКР:",d),Ne.error("Ошибка добавления в модуль ФКР")}},[e,n]),o=Ma.useMemo(()=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),[]),A=Ma.useCallback(l=>l?o.format(l):"—",[o]),c=K.useMemo(()=>{const l=[];l.push({key:"conclusion",label:"Залоговое заключение",children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsxs(we,{bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"№ заключения",span:1,children:i.jsx(S1,{strong:!0,children:e.conclusionNumber})}),i.jsx(we.Item,{label:"Дата",span:1,children:e.conclusionDate}),i.jsx(we.Item,{label:"Тип",span:1,children:e.conclusionType}),i.jsx(we.Item,{label:"Статус",span:1,children:i.jsx(at,{color:e.status==="Согласовано"?"green":e.status==="На согласовании"?"blue":e.status==="Отклонено"||e.status==="Аннулировано"?"red":"default",children:e.status})}),i.jsx(we.Item,{label:"REFERENCE",span:1,children:i.jsx(S1,{copyable:!0,children:e.reference||"—"})}),i.jsx(we.Item,{label:"№ договора",span:1,children:e.contractNumber||"—"}),i.jsx(we.Item,{label:"Заемщик",span:2,children:e.borrower||"—"}),i.jsx(we.Item,{label:"ИНН заемщика",span:1,children:e.borrowerInn||"—"}),i.jsx(we.Item,{label:"Залогодатель",span:2,children:e.pledger||"—"}),i.jsx(we.Item,{label:"ИНН залогодателя",span:1,children:e.pledgerInn||"—"})]}),e.creditProduct&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:"Кредитный продукт"}),i.jsxs(we,{bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"Продукт",children:e.creditProduct}),i.jsx(we.Item,{label:"Сумма, руб.",children:A(e.creditAmount)}),i.jsx(we.Item,{label:"Срок, мес.",children:e.creditTermMonths||"—"}),e.creditContractNumber&&i.jsx(we.Item,{label:"№ Кредитного договора",span:3,children:e.creditContractNumber})]})]}),i.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:"Согласование"}),i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Автор",children:e.author}),i.jsx(we.Item,{label:"Дата создания",children:e.authorDate}),e.approver&&i.jsx(we.Item,{label:"Согласующий",children:e.approver}),e.approvalDate&&i.jsx(we.Item,{label:"Дата согласования",children:e.approvalDate}),e.inspectionDate&&i.jsx(we.Item,{label:"Дата осмотра",children:e.inspectionDate}),e.inspectorName&&i.jsx(we.Item,{label:"Проводивший осмотр",children:e.inspectorName})]})]})});const d=e.collateralType,p=(x=>{if(!x)return;const v=x.toLowerCase();if(v.includes("недвижимость")||v.includes("нежилая")){if(e.collateralName){const E=e.collateralName.toLowerCase();if(E.includes("офис")||E.includes("офисное"))return"office";if(E.includes("торгов")||E.includes("магазин"))return"retail";if(E.includes("склад"))return"warehouse";if(E.includes("гостиниц")||E.includes("отель"))return"hotel";if(E.includes("кафе")||E.includes("ресторан"))return"catering";if(E.includes("азс")||E.includes("заправк"))return"gas_station";if(E.includes("автосалон"))return"car_dealership";if(E.includes("производств")||E.includes("цех"))return"industrial_building"}return"office"}if(v.includes("транспорт")||v.includes("авто"))return"car_passenger";if(v.includes("спецтехник")||v.includes("техник"))return"machinery";if(v.includes("оборудован"))return"equipment"})(d),u=Dy(p||d||void 0),g={collateralName:e.collateralName,collateralLocation:e.collateralLocation,totalAreaSqm:e.totalAreaSqm,totalAreaHectares:e.totalAreaHectares,landCategory:e.landCategory,landPermittedUse:e.landPermittedUse,landCadastralNumber:e.landCadastralNumber,ownershipShare:e.ownershipShare,marketValue:e.marketValue,collateralValue:e.collateralValue,fairValue:e.fairValue,category:e.category,collateralCondition:e.collateralCondition,hasEncumbrances:e.hasEncumbrances,ownershipBasis:e.ownershipBasis,...e.additionalData||{}};Object.keys(g).forEach(x=>{(g[x]===null||g[x]===void 0||g[x]==="")&&delete g[x]});const h=Object.keys(g).length>0,y=(x,v)=>v==null||v===""?"—":x.type==="boolean"?v?"Да":"Нет":x.type==="number"&&x.unit?`${v} ${x.unit}`:(x.type==="number",String(v));if(l.push({key:"characteristics",label:"Характеристики",children:(()=>{const x=Object.keys(u);return x.length===0||!h?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Характеристики не указаны"}):i.jsx(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:x.map(v=>{const E=u[v],D=[];return E.forEach(B=>{const I=vz(g,B.key);I!=null&&I!==""&&D.push({label:B.label,children:y(B,I)})}),D.length===0?null:i.jsxs("div",{children:[i.jsx(jt,{orientation:"left",style:{margin:"8px 0"},children:v}),i.jsx(we,{bordered:!0,column:2,size:"small",items:D})]},v)})})})()}),e.suspensiveConditions&&e.suspensiveConditions.length>0?l.push({key:"suspensive",label:"отлагательные",children:i.jsx(nr,{dataSource:e.suspensiveConditions,rowKey:"id",pagination:!1,size:"small",columns:[{title:"№",dataIndex:"number",width:60,align:"center"},{title:"Перечень отлагательных и дополнительных условий",dataIndex:"description",key:"description"},{title:"Отлагательные условия",dataIndex:"suspensiveCondition",width:150,align:"center",render:x=>x==="+"?i.jsx(at,{color:"green",children:"+"}):i.jsx(at,{color:"red",children:"-"})},{title:"Доп. условия",dataIndex:"additionalCondition",width:150,align:"center",render:x=>x?i.jsx(at,{color:"blue",children:"+"}):i.jsx(at,{color:"default",children:"-"})},{title:"Действия",key:"actions",width:150,align:"center",render:(x,v)=>i.jsx(Be,{type:"link",icon:i.jsx(xi,{}),onClick:()=>s(v),size:"small",children:"Добавить в модуль ФКР"})}]})}):l.push({key:"suspensive",label:"отлагательные",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет отлагательных условий"})}),e.detailedDescriptions&&e.detailedDescriptions.length>0){const x=e.detailedDescriptions[0],v=Object.keys(x).filter(E=>E!=="id"&&x[E]!==null&&x[E]!==void 0).slice(0,10).map(E=>({title:E,dataIndex:E,key:E,width:150,ellipsis:!0,render:D=>D==null?"—":typeof D=="object"?JSON.stringify(D).slice(0,50):String(D).slice(0,50)}));l.push({key:"detailed",label:"Описание",children:i.jsx(nr,{dataSource:e.detailedDescriptions,rowKey:"id",columns:v,pagination:!1,scroll:{x:"max-content"},size:"small"})})}else l.push({key:"detailed",label:"Описание",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет описания объектов"})});if(e.photos&&e.photos.length>0?l.push({key:"photos",label:"Фото",children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:e.photos.map(x=>i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx(am,{src:x.url,alt:x.description||"Фото",width:200,height:150,style:{objectFit:"cover",borderRadius:"4px"},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}),x.description&&i.jsx(S1,{type:"secondary",style:{display:"block",marginTop:"8px"},children:x.description})]},x.id))})}):l.push({key:"photos",label:"Фото",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет фотографий"})}),e.calculations&&e.calculations.length>0){const x=[];e.calculations.forEach(v=>{v.data&&v.data.analogs&&Array.isArray(v.data.analogs)&&v.data.analogs.forEach((E,D)=>{x.push({id:`analog-${v.id}-${D}`,number:E.number||D+1,address:E.address||"—",description:E.description||"—",price:E.price||"—",area:E.area||"—",type:v.type})})}),x.length>0?l.push({key:"analogs",label:"Аналоги",children:i.jsx(nr,{dataSource:x,rowKey:"id",pagination:!1,size:"small",columns:[{title:"№",dataIndex:"number",width:60,align:"center"},{title:"Адрес",dataIndex:"address",key:"address"},{title:"Краткое описание",dataIndex:"description",key:"description"},{title:"Цена предложения, руб.",dataIndex:"price",key:"price",align:"right",render:v=>typeof v=="number"?A(v):v},{title:"Площадь, кв.м.",dataIndex:"area",key:"area",align:"right"},{title:"Тип расчета",dataIndex:"type",key:"type"}]})}):l.push({key:"analogs",label:"Аналоги",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет данных об аналогах"})})}else l.push({key:"analogs",label:"Аналоги",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет данных об аналогах"})});if(e.calculations&&e.calculations.length>0){const x=e.calculations.map(v=>({key:v.id,label:v.type,children:i.jsx(we,{bordered:!0,column:2,size:"small",children:Object.entries(v.data).map(([E,D])=>i.jsx(we.Item,{label:E,children:typeof D=="object"?i.jsx("pre",{style:{margin:0,fontSize:"12px"},children:JSON.stringify(D,null,2)}):String(D)},E))})}));l.push({key:"calculations",label:"расчеты",children:i.jsx(Ts,{items:x,size:"small"})})}else l.push({key:"calculations",label:"расчеты",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Нет расчетов"})});return e.review?l.push({key:"review",label:"Рецензия",children:i.jsxs(we,{bordered:!0,column:1,size:"small",children:[e.review.reviewer&&i.jsx(we.Item,{label:"Рецензент",children:e.review.reviewer}),e.review.reviewerPosition&&i.jsx(we.Item,{label:"Должность",children:e.review.reviewerPosition}),e.review.reviewDate&&i.jsx(we.Item,{label:"Дата рецензии",children:e.review.reviewDate}),e.review.reviewText&&i.jsx(we.Item,{label:"Текст рецензии",children:i.jsx(od,{style:{margin:0},children:e.review.reviewText})}),e.review.conclusion&&i.jsx(we.Item,{label:"Заключение",children:i.jsx(at,{color:"green",children:e.review.conclusion})}),e.review.compliance&&i.jsx(we.Item,{label:"Соответствие требованиям",children:i.jsx(od,{style:{margin:0},children:e.review.compliance})})]})}):l.push({key:"review",label:"Рецензия",children:i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Рецензия не проведена"})}),l.push({key:"contract",label:"для договора",children:i.jsx(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:i.jsxs(we,{bordered:!0,column:1,size:"small",children:[i.jsx(we.Item,{label:"Приложение к договору залога",children:i.jsx(od,{children:"Настоящее заключение является приложением к договору залога и содержит полную информацию о предмете залога, его оценке и условиях принятия в залог."})}),e.conclusionNumber&&i.jsx(we.Item,{label:"Номер заключения",children:e.conclusionNumber}),e.conclusionDate&&i.jsx(we.Item,{label:"Дата заключения",children:e.conclusionDate}),e.contractNumber&&i.jsx(we.Item,{label:"Номер договора залога",children:e.contractNumber}),e.collateralType&&i.jsx(we.Item,{label:"Тип залога",children:e.collateralType}),e.marketValue&&i.jsx(we.Item,{label:"Рыночная стоимость",children:A(e.marketValue)}),e.collateralValue&&i.jsx(we.Item,{label:"Залоговая стоимость",children:A(e.collateralValue)}),e.specialOpinion&&i.jsx(we.Item,{label:"Особое мнение",children:i.jsx(od,{style:{margin:0},children:e.specialOpinion})}),e.recommendations&&i.jsx(we.Item,{label:"Рекомендации",children:i.jsx(od,{style:{margin:0},children:e.recommendations})}),e.conclusionText&&i.jsx(we.Item,{label:"Текст заключения",children:i.jsx(od,{style:{margin:0},children:e.conclusionText})})]})})}),l},[e,A,s]);return i.jsxs("div",{style:{padding:"8px 0"},children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t&&i.jsx(Be,{icon:i.jsx(Ri,{}),onClick:t,children:"Редактировать"}),r&&i.jsx(Be,{icon:i.jsx(FT,{}),onClick:r,children:"Печать"}),a&&i.jsx(Be,{icon:i.jsx(In,{}),onClick:a,children:"Экспорт"}),i.jsx(Be,{icon:i.jsx(Qr,{}),onClick:()=>window.print(),children:"PDF"})]}),i.jsx(Ts,{items:c,defaultActiveKey:"conclusion",size:"small",type:"card",style:{minHeight:"400px"}})]})},NE="cms_appraisal_reviews";class Jz{getReviews(){const t=localStorage.getItem(NE);return t?JSON.parse(t):[]}saveReviews(t){localStorage.setItem(NE,JSON.stringify(t))}getAll(){return this.getReviews()}getById(t){return this.getReviews().find(r=>r.id===t)}create(t){const r=this.getReviews(),a={...t,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveReviews(r),a}update(t,r){const a=this.getReviews(),n=a.findIndex(o=>o.id===t);if(n===-1)return;const s={...a[n],...r,updatedAt:new Date().toISOString()};return a[n]=s,this.saveReviews(a),s}delete(t){const r=this.getReviews().filter(a=>a.id!==t);this.saveReviews(r)}initializeDemoData(){if(this.getReviews().length===0){const t=[{id:crypto.randomUUID(),status:"approved",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),appraiserName:'ООО "Вектор Оценки"',hasRecommendation:!0,reportName:"Отчет об оценке №123/2025",reportNumber:"123/2025",appraisalDate:"2025-11-15",appraisalPurpose:"Залог",valueType:"Рыночная стоимость",marketValueWithVat:15e6,objectDescription:"Нежилое помещение, 150 кв.м., г. Москва, ул. Ленина 1",compliance135FZ:"compliant",complianceNote:"Нарушений не выявлено",comparativeMethodologyValid:"Выбор метода сравнения продаж обоснован",comparativeErrors:"Ошибок нет",comparativeConclusion:"Стоимость определена корректно",costMethodologyValid:"Отказ от использования обоснован",costErrors:"-",costConclusion:"-",incomeMethodologyValid:"Метод прямой капитализации применен верно",incomeErrors:"Ставка капитализации в пределах рынка",incomeConclusion:"Результат достоверен",reconciliationWeightsJustification:"Веса: Сравнительный 60%, Доходный 40%",marketValueCorrectness:"Рыночная стоимость определена корректно",marketCorrespondence:!0,reviewDate:"2025-11-20",reviewerName:"Иванов И.И.",reviewerPosition:"Главный эксперт"}];this.saveReviews(t)}}}const Ad=new Jz,{TextArea:cd}=Re,Zz=({initialValues:e,onSubmit:t,onCancel:r,loading:a})=>{const[n]=ne.useForm(),[s,o]=K.useState([]);K.useEffect(()=>{e?(n.setFieldsValue({...e,appraisalDate:e.appraisalDate?We(e.appraisalDate):null,reviewDate:e.reviewDate?We(e.reviewDate):null}),e.reportDocumentId&&e.reportDocumentName?o([{uid:e.reportDocumentId,name:e.reportDocumentName,status:"done"}]):o([])):(n.resetFields(),o([]),n.setFieldsValue({valueType:"Рыночная стоимость",marketCorrespondence:!0,compliance135FZ:"compliant"}))},[e,n]);const A=async l=>{let d=(e==null?void 0:e.reportDocumentId)||null,f=(e==null?void 0:e.reportDocumentName)||null;if(s.length>0&&s[0].originFileObj){const u=s[0].originFileObj;try{const g=await new Promise((x,v)=>{const E=new FileReader;E.onloadend=()=>{const D=E.result;x(D)},E.onerror=v,E.readAsDataURL(u)}),h=crypto.randomUUID(),y={id:h,name:u.name,type:u.type,size:u.size,data:g,uploadedAt:new Date().toISOString()};localStorage.setItem(`appraisal_report_${h}`,JSON.stringify(y)),d=h,f=u.name}catch{Ne.error("Ошибка при загрузке файла");return}}else s.length===0&&(e!=null&&e.reportDocumentId)&&(d=null,f=null);const p={...l,appraisalDate:l.appraisalDate?l.appraisalDate.toISOString():null,reviewDate:l.reviewDate?l.reviewDate.toISOString():null,reportDocumentId:d,reportDocumentName:f};t(p)},c={beforeUpload:l=>{const d=l.type==="application/pdf"||l.name.endsWith(".pdf"),f=l.type.includes("wordprocessingml")||l.name.endsWith(".doc")||l.name.endsWith(".docx");return!d&&!f?(Ne.error("Можно загружать только PDF или DOC/DOCX файлы!"),Xi.LIST_IGNORE):l.size/1024/1024<10?!1:(Ne.error("Файл должен быть меньше 10MB!"),Xi.LIST_IGNORE)},fileList:s,onChange:({fileList:l})=>{o(l)},onRemove:()=>{o([]),n.setFieldsValue({reportDocumentId:null,reportDocumentName:null})},maxCount:1};return i.jsxs(ne,{form:n,layout:"vertical",onFinish:A,disabled:a,children:[i.jsxs(Ge,{title:"Общие сведения",size:"small",style:{marginBottom:16},children:[(e==null?void 0:e.id)&&i.jsx(ft,{gutter:16,style:{marginBottom:16},children:i.jsx(Te,{span:24,children:i.jsx(ne.Item,{label:"ID рецензии",children:i.jsx(Re,{value:e.id,disabled:!0,style:{fontFamily:"monospace"}})})})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"appraiserName",label:"Наименование оценщика",rules:[{required:!0}],children:i.jsx(Re,{})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"hasRecommendation",label:"Наличие рекомендации",valuePropName:"checked",children:i.jsx(tc,{children:"Рекомендован банком"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"reportName",label:"Наименование отчета",rules:[{required:!0}],children:i.jsx(Re,{})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"reportNumber",label:"Номер отчета",rules:[{required:!0}],children:i.jsx(Re,{})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"appraisalDate",label:"Дата оценки",rules:[{required:!0}],children:i.jsx(Rr,{style:{width:"100%"}})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"appraisalPurpose",label:"Цель оценки",children:i.jsx(Re,{})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"valueType",label:"Вид стоимости",children:i.jsx(Re,{})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"marketValueWithVat",label:"Итоговая рыночная стоимость (с НДС)",children:i.jsx(fa,{style:{width:"100%"},formatter:l=>`${l}`.replace(/\B(?=(\d{3})+(?!\d))/g," "),parser:l=>l.replace(/\s?|(,*)/g,"")})})})]}),i.jsx(ne.Item,{name:"objectDescription",label:"Описание оцениваемого объекта",children:i.jsx(cd,{rows:3})}),i.jsxs(ne.Item,{label:"Отчет об оценке (файл)",children:[i.jsx(Xi,{...c,children:i.jsx(Be,{icon:i.jsx(Ii,{}),children:"Загрузить отчет"})}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#888"},children:"Поддерживаются файлы PDF, DOC, DOCX (макс. 10MB)"}),s.length>0&&s[0].status==="done"&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx(kA,{})," ",s[0].name]})]})]}),i.jsx(Ge,{title:"Требования к оформлению отчета",size:"small",style:{marginBottom:16},children:i.jsx(nr,{size:"small",pagination:!1,dataSource:[{key:"1",requirement:"Отчет об оценке соответствует требованиям Федерального закона от 29.07.98 г. №135-ФЗ «Об оценочной деятельности в Российской Федерации» (со всеми изменениями на дату оценки), Федеральным стандартам оценки",compliance:"compliance135FZ",note:"complianceNote"}],columns:[{title:"Требования к оформлению отчета",dataIndex:"requirement",key:"requirement",width:"50%"},{title:"Соответствие требованиям",dataIndex:"compliance",key:"compliance",width:"25%",render:l=>i.jsx(ne.Item,{name:l,noStyle:!0,children:i.jsxs(Ye,{placeholder:"Выберите",children:[i.jsx(Ye.Option,{value:"compliant",children:"Соответствует"}),i.jsx(Ye.Option,{value:"not_compliant",children:"Не соответствует"}),i.jsx(Ye.Option,{value:"partial",children:"Соответствует частично"})]})})},{title:"Примечание",dataIndex:"note",key:"note",width:"25%",render:l=>i.jsx(ne.Item,{name:l,noStyle:!0,children:i.jsx(Re,{placeholder:"Примечание"})})}]})}),i.jsx(Ge,{title:"Расчет стоимости объекта оценки",size:"small",style:{marginBottom:16},children:i.jsx(nr,{size:"small",pagination:!1,dataSource:[{key:"comparative",approach:"Сравнительный подход",methodology:"comparativeMethodologyValid",errors:"comparativeErrors",conclusion:"comparativeConclusion"},{key:"cost",approach:"Затратный подход",methodology:"costMethodologyValid",errors:"costErrors",conclusion:"costConclusion"},{key:"income",approach:"Доходный подход",methodology:"incomeMethodologyValid",errors:"incomeErrors",conclusion:"incomeConclusion"}],columns:[{title:"Подход",dataIndex:"approach",key:"approach",width:"20%"},{title:"Правильность и обоснованность выбора метода в рамках подхода/Корректность обоснования отказа от использования подхода",dataIndex:"methodology",key:"methodology",width:"30%",render:l=>i.jsx(ne.Item,{name:l,noStyle:!0,children:i.jsx(cd,{rows:2,placeholder:"Комментарии"})})},{title:"Наличие ошибок в расчетах, корректность подобранных аналогов, обоснованность принятых корректировок, прочие нарушения",dataIndex:"errors",key:"errors",width:"30%",render:l=>i.jsx(ne.Item,{name:l,noStyle:!0,children:i.jsx(cd,{rows:2,placeholder:"Комментарии"})})},{title:"Выводы в рамках подхода",dataIndex:"conclusion",key:"conclusion",width:"20%",render:l=>i.jsx(ne.Item,{name:l,noStyle:!0,children:i.jsx(cd,{rows:2,placeholder:"Выводы"})})}]})}),i.jsx(Ge,{title:"Согласование результатов",size:"small",style:{marginBottom:16},children:i.jsx(ne.Item,{name:"reconciliationWeightsJustification",label:"Обоснование выбора использованных весов, присвоенных каждому из подходов",children:i.jsx(cd,{rows:3,placeholder:"Опишите обоснование выбора весов для каждого подхода"})})}),i.jsxs(Ge,{title:"Вывод о корректности определения рыночной стоимости",size:"small",style:{marginBottom:16},children:[i.jsx(ne.Item,{name:"marketValueCorrectness",label:"Вывод о корректности определения рыночной стоимости",children:i.jsx(cd,{rows:3,placeholder:"Сформулируйте вывод о корректности определения рыночной стоимости"})}),i.jsx(ne.Item,{name:"marketCorrespondence",label:"Стоимость соответствует рынку",valuePropName:"checked",children:i.jsx(tc,{children:"Да, стоимость соответствует рынку"})})]}),i.jsx(Ge,{title:"Подпись",size:"small",style:{marginBottom:16},children:i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"reviewDate",label:"Дата рецензии",children:i.jsx(Rr,{style:{width:"100%"}})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"reviewerName",label:"ФИО сотрудника",children:i.jsx(Re,{})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"reviewerPosition",label:"Должность",children:i.jsx(Re,{})})})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx(Be,{onClick:r,children:"Отмена"}),i.jsx(Be,{type:"primary",htmlType:"submit",loading:a,children:"Сохранить"})]})]})},eV=()=>{const[e,t]=K.useState([]),[r,a]=K.useState(!1),[n,s]=K.useState(null),[o,A]=K.useState(!1),[c,l]=K.useState(""),[d,f]=K.useState(null);K.useEffect(()=>{p()},[]);const p=()=>{Ad.initializeDemoData(),t(Ad.getAll())},u=()=>{s(null),a(!0)},g=B=>{s(B),a(!0)},h=B=>{dr.confirm({title:"Удалить рецензию?",content:"Это действие нельзя отменить",onOk:()=>{Ad.delete(B),Ne.success("Рецензия удалена"),p()}})},y=(B,I)=>{Ad.update(B,{status:I});const _={draft:"Черновик",pending:"На согласовании",approved:"Согласовано",rejected:"Отклонено"};Ne.success(`Статус изменен на "${_[I]}"`),p()},x=K.useMemo(()=>{const B=c.trim().toLowerCase();return e.filter(I=>{const _=!B||[I.appraiserName,I.reportName,I.reportNumber,I.objectDescription].filter(Boolean).some(O=>String(O).toLowerCase().includes(B)),S=!d||I.status===d;return _&&S})},[e,c,d]),v=K.useMemo(()=>{const B=x.length,I=x.filter(M=>M.status==="draft").length,_=x.filter(M=>M.status==="approved").length,S=x.filter(M=>M.status==="pending").length,O=x.filter(M=>M.status==="rejected").length;return{total:B,draft:I,approved:_,pending:S,rejected:O}},[x]),E=B=>{A(!0);try{n?(Ad.update(n.id,B),Ne.success("Рецензия обновлена")):(Ad.create({...B,status:"draft"}),Ne.success("Рецензия создана")),a(!1),p()}catch{Ne.error("Ошибка при сохранении")}finally{A(!1)}},D=[{title:"ID",dataIndex:"id",key:"id",width:100,render:B=>i.jsxs("span",{style:{fontFamily:"monospace",fontSize:"12px"},children:[B.substring(0,8),"..."]})},{title:"Дата оценки",dataIndex:"appraisalDate",key:"appraisalDate",render:B=>B?We(B).format("DD.MM.YYYY"):"-"},{title:"Оценщик",dataIndex:"appraiserName",key:"appraiserName"},{title:"Отчет",key:"report",render:(B,I)=>i.jsxs("div",{children:[i.jsx("div",{children:I.reportName}),i.jsx("small",{style:{color:"#888"},children:I.reportNumber}),I.reportDocumentName&&i.jsxs("div",{style:{marginTop:4},children:[i.jsx(kA,{style:{color:"#1890ff"}})," ",i.jsx("span",{style:{fontSize:"12px",color:"#1890ff"},children:I.reportDocumentName})]})]})},{title:"Объект",dataIndex:"objectDescription",key:"objectDescription",ellipsis:!0},{title:"Стоимость",dataIndex:"marketValueWithVat",key:"marketValueWithVat",render:B=>B?`${B.toLocaleString("ru-RU")} ₽`:"-"},{title:"Статус",dataIndex:"status",key:"status",render:B=>{const I={draft:"default",pending:"processing",approved:"success",rejected:"error"},_={draft:"Черновик",pending:"На согласовании",approved:"Согласовано",rejected:"Отклонено"};return i.jsx(at,{color:I[B],children:_[B]})}},{title:"Действия",key:"actions",width:200,render:(B,I)=>i.jsxs(Fe,{children:[i.jsx(Be,{icon:i.jsx(Ss,{}),size:"small",onClick:()=>g(I),title:"Просмотр"}),I.status==="draft"&&i.jsx(Be,{icon:i.jsx(Ri,{}),size:"small",onClick:()=>g(I),title:"Редактировать"}),I.status==="draft"&&i.jsx(Be,{icon:i.jsx(vv,{}),size:"small",type:"primary",ghost:!0,title:"Отправить на согласование",onClick:()=>y(I.id,"pending")}),I.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(Be,{icon:i.jsx(vv,{}),size:"small",type:"primary",title:"Согласовать",onClick:()=>y(I.id,"approved")}),i.jsx(Be,{icon:i.jsx(n_,{}),size:"small",danger:!0,title:"Отклонить",onClick:()=>y(I.id,"rejected")})]}),I.status!=="approved"&&i.jsx(Be,{icon:i.jsx(Bs,{}),size:"small",danger:!0,onClick:()=>h(I.id),title:"Удалить"})]})}];return i.jsxs("div",{className:"appraisal-reviews-list",children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("h2",{style:{margin:0},children:"Реестр рецензий на отчеты об оценке"}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:u,children:"Создать рецензию"})]}),i.jsxs(Fe,{size:"middle",style:{width:"100%",marginBottom:16},children:[i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по оценщику, отчету, объекту...",prefix:i.jsx(Pa,{}),value:c,onChange:B=>l(B.target.value),style:{width:400}}),i.jsx(Ye,{allowClear:!0,placeholder:"Статус",style:{width:200},value:d??void 0,onChange:B=>f(B??null),options:[{label:"Черновик",value:"draft"},{label:"На согласовании",value:"pending"},{label:"Согласовано",value:"approved"},{label:"Отклонено",value:"rejected"}]})]})]}),i.jsx(Ge,{style:{marginBottom:16},children:i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Всего рецензий",value:v.total})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Черновики",value:v.draft})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"На согласовании",value:v.pending})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Согласовано",value:v.approved})})]})}),i.jsx(Ge,{bodyStyle:{padding:0},children:i.jsx(nr,{columns:D,dataSource:x,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1200}})}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx("span",{children:n?"Редактирование рецензии":"Создание рецензии"}),n&&i.jsx(at,{color:n.status==="approved"?"green":n.status==="pending"?"blue":n.status==="rejected"?"red":"default",children:n.status==="draft"?"Черновик":n.status==="pending"?"На согласовании":n.status==="approved"?"Согласовано":"Отклонено"})]}),open:r,onCancel:()=>a(!1),footer:null,width:"95%",style:{top:10},styles:{body:{maxHeight:"85vh",overflowY:"auto",padding:"16px"}},destroyOnClose:!0,children:i.jsx(Zz,{initialValues:n||{},onSubmit:E,onCancel:()=>a(!1),loading:o})})]})},tV=()=>{const e=$s(),[t,r]=K.useState([]),[a,n]=K.useState(!0),[s,o]=K.useState(null),[A,c]=K.useState(""),[l,d]=K.useState(null),[f,p]=K.useState(null),[u,g]=K.useState(null),[h,y]=K.useState(!1),[x,v]=K.useState(!1);K.useEffect(()=>{let M=!0;return(async()=>{n(!0),o(null);try{const R="./",L=new URL(R,window.location.origin),N=L.pathname.endsWith("/")?L.pathname:`${L.pathname}/`,P=`${L.origin}${N}collateralConclusionsData.json?v=${Date.now()}`,U=await fetch(P,{cache:"no-store"});if(!U.ok)throw new Error(`Не удалось загрузить данные заключений (${U.status})`);const V=await U.json();if(!M)return;r(V.map((ie,W)=>({...ie,key:ie.id||`conclusion-${W}`})))}catch(R){o(R instanceof Error?R.message:"Неизвестная ошибка"),r([])}finally{M&&n(!1)}})(),()=>{M=!1}},[]);const E=K.useMemo(()=>{const M=A.trim().toLowerCase();return t.filter(T=>{const R=!M||[T.conclusionNumber,T.reference,T.contractNumber,T.pledger,T.borrower,T.collateralType].filter(Boolean).some(P=>String(P).toLowerCase().includes(M)),L=!l||T.status===l,N=!f||T.conclusionType===f;return R&&L&&N})},[t,A,l,f]),D=K.useMemo(()=>{const M=E.length,T=E.filter(N=>N.status==="Черновик").length,R=E.filter(N=>N.status==="Согласовано").length,L=E.filter(N=>N.status==="На согласовании").length;return{total:M,draft:T,approved:R,pending:L}},[E]),B=M=>{g(M),y(!0)},I=Ma.useCallback((M,T)=>{M?e(`/collateral-dossier?ref=${M}`):T?e(`/collateral-dossier?q=${encodeURIComponent(T)}`):Ne.warning("Не указан REFERENCE или Залогодатель для перехода к досье")},[e]),_=Ma.useCallback((M,T)=>{T?e(`/portfolio?q=${encodeURIComponent(T)}`):M?e(`/portfolio?q=${encodeURIComponent(M)}`):Ne.warning("Не указан Залогодатель или REFERENCE для перехода к портфелю")},[e]),S=K.useMemo(()=>[{title:"№ заключения",dataIndex:"conclusionNumber",key:"conclusionNumber",width:150,render:(M,T)=>i.jsx(Be,{type:"link",onClick:()=>B(T),children:M})},{title:"Дата",dataIndex:"conclusionDate",key:"conclusionDate",width:120},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:150,render:M=>M?i.jsx(mt.Text,{code:!0,children:M}):"—"},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200,render:(M,T)=>i.jsx(Xr,{title:"Перейти к портфелю",children:i.jsx(Be,{type:"link",icon:i.jsx(es,{}),onClick:()=>_(T.pledger,T.reference),children:M||"—"})})},{title:"Тип залога",dataIndex:"collateralType",key:"collateralType",width:180},{title:"Тип заключения",dataIndex:"conclusionType",key:"conclusionType",width:150},{title:"Статус",dataIndex:"status",key:"status",width:150,render:M=>{const T=M==="Согласовано"?"green":M==="На согласовании"?"blue":M==="Отклонено"||M==="Аннулировано"?"red":"default";return i.jsx(at,{color:T,children:M})}},{title:"Автор",dataIndex:"author",key:"author",width:150},{title:"Действия",key:"actions",width:120,render:(M,T)=>i.jsxs(Fe,{children:[i.jsx(Xr,{title:"Просмотр",children:i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>B(T)})}),i.jsx(Xr,{title:"Залоговое досье",children:i.jsx(Be,{type:"link",icon:i.jsx(L1,{}),onClick:()=>I(T.reference,T.pledger)})})]})}],[I,_]),O=()=>{window.location.reload()};return i.jsx("div",{className:"collateral-conclusions-page",children:i.jsx(Ts,{defaultActiveKey:"conclusions",items:[{key:"conclusions",label:"Залоговые заключения",children:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"conclusions-header",children:[i.jsxs("div",{children:[i.jsx(mt.Title,{level:2,className:"conclusions-title",children:"Залоговые заключения"}),i.jsx(mt.Paragraph,{className:"conclusions-subtitle",children:"Реестр залоговых заключений по сделкам"})]}),i.jsxs(Fe,{size:"middle",children:[i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по номеру, REFERENCE, залогодателю...",prefix:i.jsx(Pa,{}),value:A,onChange:M=>c(M.target.value),style:{width:400}}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),size:"large",onClick:()=>v(!0),children:"Создать заключение"})]})]}),i.jsx(Ge,{children:i.jsxs("div",{className:"conclusions-filters",children:[i.jsx(Ye,{allowClear:!0,placeholder:"Статус",style:{width:200},options:[{label:"Черновик",value:"Черновик"},{label:"На согласовании",value:"На согласовании"},{label:"Согласовано",value:"Согласовано"},{label:"Отклонено",value:"Отклонено"},{label:"Аннулировано",value:"Аннулировано"}],value:l??void 0,onChange:M=>d(M??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Тип заключения",style:{width:200},options:[{label:"Первичное",value:"Первичное"},{label:"Повторное",value:"Повторное"},{label:"Дополнительное",value:"Дополнительное"},{label:"Переоценка",value:"Переоценка"}],value:f??void 0,onChange:M=>p(M??null)})]})}),i.jsxs(ft,{gutter:[16,16],className:"conclusions-stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего заключений",value:D.total,prefix:i.jsx(Qr,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Черновики",value:D.draft})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"На согласовании",value:D.pending})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Согласовано",value:D.approved})})})]}),i.jsx(Ge,{className:"conclusions-table-card",bodyStyle:{padding:0},children:i.jsx(nr,{columns:S,dataSource:E,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},loading:a,onRow:M=>({onDoubleClick:()=>B(M)}),locale:{emptyText:i.jsx(Br,{description:"Нет заключений, удовлетворяющих фильтрам",className:"conclusions-empty"})}})}),s&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные заключений",description:s,action:i.jsx("a",{onClick:()=>window.location.reload(),style:{fontWeight:600},children:"Повторить"})}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Qr,{}),i.jsxs("span",{children:["Залоговое заключение ",u==null?void 0:u.conclusionNumber]}),u&&i.jsx(at,{color:u.status==="Согласовано"?"green":u.status==="На согласовании"?"blue":u.status==="Отклонено"||u.status==="Аннулировано"?"red":"default",children:u.status})]}),open:h,onCancel:()=>y(!1),footer:[i.jsx(Be,{icon:i.jsx(L1,{}),onClick:()=>{u&&I(u.reference,u.pledger)},children:"Залоговое досье"},"dossier"),i.jsx(Be,{icon:i.jsx(es,{}),onClick:()=>{u&&_(u.pledger,u.reference)},children:"Залогодатель"},"pledger"),i.jsx(Be,{type:"primary",onClick:()=>y(!1),children:"Закрыть"},"close")],width:"95%",style:{top:10},styles:{body:{maxHeight:"80vh",overflowY:"auto",padding:"16px"}},children:u&&i.jsx(Xz,{conclusion:u,onEdit:()=>{Ne.info("Редактирование в разработке")},onPrint:()=>{window.print()},onExport:()=>{Ne.info("Экспорт в разработке")}})}),i.jsx(Wz,{visible:x,onCancel:()=>v(!1),onSuccess:O})]})},{key:"reviews",label:"Рецензии на отчеты об оценке",children:i.jsx(eV,{})}]})})},{TextArea:Du}=Re,{Option:Ps}=Ye,{Title:rV,Paragraph:T1}=mt,aV=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}),Vp=e=>{const t=typeof e=="string"?parseFloat(e.replace(/\s/g,"").replace(",",".")):Number(e);return Number.isFinite(t)?aV.format(t):"—"},yr=e=>{if(e==null)return"—";const t=String(e).trim();return t.length>0?t:"—"},Oc={draft:{color:"default",text:"Черновик",icon:i.jsx(Qr,{})},submitted:{color:"processing",text:"Подано",icon:i.jsx(zn,{})},registered:{color:"success",text:"Зарегистрировано",icon:i.jsx(On,{})},rejected:{color:"error",text:"Отклонено",icon:i.jsx(ZA,{})},cancelled:{color:"default",text:"Аннулировано",icon:i.jsx(ZA,{})}},nV=()=>{const e=$s(),[t,r]=K.useState([]),[a,n]=K.useState(!0),[s,o]=K.useState(null),[A,c]=K.useState(""),[l,d]=K.useState(null),[f,p]=K.useState(null),[u,g]=K.useState(null),[h,y]=K.useState(!1),[x,v]=K.useState(!1),[E]=ne.useForm(),[D,B]=K.useState([]);K.useEffect(()=>{let z=!0;return(async()=>{n(!0),o(null);try{const b=localStorage.getItem("fnp_registrations");let k=[];if(b?k=JSON.parse(b):(k=_(),localStorage.setItem("fnp_registrations",JSON.stringify(k))),!z)return;r(k.map((j,q)=>({...j,key:j.id||`fnp-${q}`}))),await I()}catch(b){o(b instanceof Error?b.message:"Неизвестная ошибка"),r([])}finally{z&&n(!1)}})(),()=>{z=!1}},[]);const I=async()=>{try{const z="./",G=new URL(z,window.location.origin),b=G.pathname.endsWith("/")?G.pathname:`${G.pathname}/`,k=`${G.origin}${b}portfolioData.json?v=${Date.now()}`,j=await fetch(k,{cache:"no-store"});if(j.ok){const q=await j.json();B(q)}}catch(z){console.error("Ошибка загрузки данных портфеля:",z)}},_=()=>{const z=["Транспортные средства","Оборудование","Товары в обороте"],G=["draft","submitted","registered","rejected"],b=[];for(let k=1;k<=20;k++){const j=z[Math.floor(Math.random()*z.length)],q=G[Math.floor(Math.random()*G.length)],Y=Oc[q];b.push({id:`fnp-${k}`,registrationNumber:q==="registered"?`ФНП-2024-${String(k).padStart(6,"0")}`:void 0,registrationDate:q==="registered"?We().subtract(Math.floor(Math.random()*30),"day").format("YYYY-MM-DD"):void 0,status:q,statusText:Y.text,reference:`REF-${1e3+k}`,contractNumber:`ДЗ-2024-${k}`,pledgerName:`ООО "Компания ${k}"`,pledgerInn:`${Math.floor(1e9+Math.random()*9e9)}`,pledgerType:"legal",borrowerName:`Заемщик ${k}`,collateralType:j,collateralName:j==="Транспортные средства"?`Автомобиль ${["Toyota","BMW","Mercedes","Audi"][Math.floor(Math.random()*4)]}`:j==="Оборудование"?`Оборудование ${k}`:`Товары ${k}`,vehicleBrand:j==="Транспортные средства"?["Toyota","BMW","Mercedes"][Math.floor(Math.random()*3)]:void 0,vehicleModel:j==="Транспортные средства"?"Model X":void 0,vehicleYear:j==="Транспортные средства"?2020+Math.floor(Math.random()*4):void 0,vehicleVin:j==="Транспортные средства"?`VIN${Math.random().toString(36).substring(2,17).toUpperCase()}`:void 0,marketValue:Math.floor(Math.random()*5e6)+5e5,collateralValue:Math.floor(Math.random()*4e6)+4e5,pledgeContractNumber:`ДЗ-2024-${k}`,pledgeContractDate:We().subtract(Math.floor(Math.random()*60),"day").format("YYYY-MM-DD"),pledgeAmount:Math.floor(Math.random()*3e6)+3e5,createdAt:We().subtract(Math.floor(Math.random()*90),"day").toISOString(),updatedAt:We().subtract(Math.floor(Math.random()*10),"day").toISOString()})}return b},S=K.useMemo(()=>{const z=A.trim().toLowerCase();return t.filter(G=>{const b=!z||[G.registrationNumber,G.pledgerName,G.contractNumber,G.reference,G.collateralName,G.collateralType].filter(Boolean).some(q=>String(q).toLowerCase().includes(z)),k=!l||G.status===l,j=!f||G.collateralType===f;return b&&k&&j})},[t,A,l,f]),O=K.useMemo(()=>{const z=S.length,G=S.filter(j=>j.status==="draft").length,b=S.filter(j=>j.status==="submitted").length,k=S.filter(j=>j.status==="registered").length;return{total:z,draft:G,submitted:b,registered:k}},[S]),M=K.useMemo(()=>Array.from(new Set(t.map(z=>z.status))).map(z=>({label:Oc[z].text,value:z})),[t]),T=K.useMemo(()=>Array.from(new Set(t.map(z=>z.collateralType))).map(z=>({label:z,value:z})),[t]),R=z=>{g(z),y(!0)},L=()=>{g(null),E.resetFields(),E.setFieldsValue({status:"draft",pledgerType:"legal",pledgeContractDate:We()}),v(!0)},N=Ma.useCallback(z=>{g(z),E.setFieldsValue({...z,pledgeContractDate:z.pledgeContractDate?We(z.pledgeContractDate):void 0,registrationDate:z.registrationDate?We(z.registrationDate):void 0}),v(!0)},[E]),P=async()=>{var z,G,b,k;try{const j=await E.validateFields(),q=We().toISOString();if(u){const Y={...u,...j,pledgeContractDate:(z=j.pledgeContractDate)==null?void 0:z.format("YYYY-MM-DD"),registrationDate:(G=j.registrationDate)==null?void 0:G.format("YYYY-MM-DD"),updatedAt:q},de=t.map(ue=>ue.id===u.id?{...Y,key:Y.id}:ue);r(de),localStorage.setItem("fnp_registrations",JSON.stringify(de)),Ne.success("Регистрация обновлена")}else{const Y={id:`fnp-${Date.now()}`,status:j.status||"draft",statusText:Oc[j.status||"draft"].text,...j,pledgeContractDate:(b=j.pledgeContractDate)==null?void 0:b.format("YYYY-MM-DD"),registrationDate:(k=j.registrationDate)==null?void 0:k.format("YYYY-MM-DD"),createdAt:q,updatedAt:q},de=[...t,{...Y,key:Y.id}];r(de),localStorage.setItem("fnp_registrations",JSON.stringify(de)),Ne.success("Регистрация создана")}v(!1),E.resetFields()}catch(j){console.error("Ошибка сохранения:",j),Ne.error("Ошибка при сохранении регистрации")}},U=Ma.useCallback(z=>{dr.confirm({title:"Удалить регистрацию?",content:"Это действие нельзя отменить.",okText:"Удалить",okType:"danger",cancelText:"Отмена",onOk:()=>{const G=t.filter(b=>b.id!==z);r(G),localStorage.setItem("fnp_registrations",JSON.stringify(G)),Ne.success("Регистрация удалена")}})},[t]),V=z=>{const G=D.find(b=>String(b.reference)===String(z));G&&E.setFieldsValue({contractNumber:G.contractNumber||null,pledgerName:G.pledger||null,pledgerInn:G.inn||null,borrowerName:G.borrower||null,collateralType:G.collateralType||null,collateralName:G.collateralType||null,marketValue:G.marketValue||G.currentMarketValue||null,collateralValue:G.collateralValue||null,pledgeAmount:G.debtRub||null})},ie=Ma.useCallback(z=>{z&&e(`/portfolio?q=${z}`)},[e]),W=K.useMemo(()=>[{title:"№ регистрации",dataIndex:"registrationNumber",key:"registrationNumber",width:150,render:(z,G)=>i.jsx(Be,{type:"link",onClick:()=>R(G),style:{padding:0},children:z||i.jsx("span",{style:{color:"#999"},children:"—"})})},{title:"Дата регистрации",dataIndex:"registrationDate",key:"registrationDate",width:120,render:z=>yr(z)},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:z=>i.jsx(Xr,{title:z,children:i.jsx(Be,{type:"link",onClick:()=>ie(z),style:{padding:0},children:i.jsx(mt.Text,{copyable:!0,ellipsis:{suffix:String(z).slice(-4)},children:z})})})},{title:"Залогодатель",dataIndex:"pledgerName",key:"pledgerName",width:200,render:z=>yr(z)},{title:"Тип имущества",dataIndex:"collateralType",key:"collateralType",width:150,render:z=>yr(z)},{title:"Предмет залога",dataIndex:"collateralName",key:"collateralName",width:200,render:z=>yr(z)},{title:"Статус",dataIndex:"status",key:"status",width:150,render:(z,G)=>{const b=Oc[z]||Oc.draft;return i.jsx(at,{color:b.color,icon:b.icon,children:G.statusText})}},{title:"Действия",key:"actions",width:120,fixed:"right",render:(z,G)=>i.jsxs(Fe,{size:"small",children:[i.jsx(Xr,{title:"Просмотреть",children:i.jsx(Be,{icon:i.jsx(Ss,{}),onClick:()=>R(G),size:"small"})}),G.status==="draft"&&i.jsx(Xr,{title:"Редактировать",children:i.jsx(Be,{icon:i.jsx(Ri,{}),onClick:()=>N(G),size:"small"})}),G.status==="draft"&&i.jsx(Xr,{title:"Удалить",children:i.jsx(Be,{icon:i.jsx(Bs,{}),onClick:()=>U(G.id),size:"small",danger:!0})})]})}],[ie,N,U]);return i.jsxs("div",{className:"fnp-service-page",children:[i.jsxs("div",{className:"fnp-header",children:[i.jsxs("div",{children:[i.jsx(rV,{level:2,className:"fnp-title",children:"Регистрация залога движимого имущества ФНП"}),i.jsx(T1,{className:"fnp-subtitle",children:"Сервис регистрации залога движимого имущества в реестре Федеральной нотариальной палаты"})]}),i.jsxs(Fe,{size:"middle",children:[i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по №, REFERENCE, залогодателю",prefix:i.jsx(Pa,{}),value:A,onChange:z=>c(z.target.value),style:{width:360}}),i.jsx(Be,{type:"primary",size:"large",icon:i.jsx(xi,{}),onClick:L,children:"Создать регистрацию"})]})]}),i.jsx(Ge,{children:i.jsxs("div",{className:"fnp-filters",children:[i.jsx(Ye,{allowClear:!0,placeholder:"Статус регистрации",style:{width:200},options:M,value:l??void 0,onChange:z=>d(z??null)}),i.jsx(Ye,{allowClear:!0,placeholder:"Тип имущества",style:{width:200},options:T,value:f??void 0,onChange:z=>p(z??null)})]})}),i.jsxs(ft,{gutter:[16,16],className:"fnp-stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего регистраций",value:O.total,prefix:i.jsx(Qr,{})})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Черновики",value:O.draft})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Подано",value:O.submitted})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Зарегистрировано",value:O.registered})})})]}),i.jsx(Ge,{className:"fnp-table-card",bodyStyle:{padding:0},children:i.jsx(nr,{columns:W,dataSource:S,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},loading:a,onRow:z=>({onDoubleClick:()=>R(z)}),locale:{emptyText:i.jsx(Br,{description:"Нет регистраций, удовлетворяющих фильтрам",className:"fnp-empty"})}})}),s&&i.jsx(Nr,{type:"error",showIcon:!0,message:"Не удалось загрузить данные регистраций",description:s,action:i.jsx(Be,{size:"small",icon:i.jsx(ec,{}),onClick:()=>window.location.reload(),children:"Повторить"})}),i.jsx(dr,{title:"Регистрация залога ФНП",open:h,onCancel:()=>y(!1),footer:[(u==null?void 0:u.status)==="draft"&&i.jsx(Be,{icon:i.jsx(Ri,{}),onClick:()=>{y(!1),N(u)},children:"Редактировать"},"edit"),i.jsx(Be,{type:"primary",onClick:()=>y(!1),children:"Закрыть"},"close")],width:"90%",style:{top:20},styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:u&&i.jsx("div",{className:"fnp-registration-details",children:i.jsxs(we,{bordered:!0,column:3,size:"small",children:[i.jsx(we.Item,{label:"№ регистрации",span:1,children:yr(u.registrationNumber)||i.jsx("span",{style:{color:"#999"},children:"Не присвоен"})}),i.jsx(we.Item,{label:"Дата регистрации",span:1,children:yr(u.registrationDate)}),i.jsx(we.Item,{label:"Статус",span:1,children:i.jsx(at,{color:Oc[u.status].color,icon:Oc[u.status].icon,children:u.statusText})}),i.jsx(we.Item,{label:"REFERENCE",span:1,children:i.jsx(Be,{type:"link",onClick:()=>ie(u.reference),style:{padding:0},children:yr(u.reference)})}),i.jsx(we.Item,{label:"№ договора залога",span:2,children:yr(u.pledgeContractNumber)}),i.jsx(jt,{orientation:"left",children:"Залогодатель"}),i.jsx(we.Item,{label:"Наименование",span:2,children:yr(u.pledgerName)}),i.jsx(we.Item,{label:"Тип",span:1,children:u.pledgerType==="legal"?"Юридическое лицо":"Физическое лицо"}),i.jsx(we.Item,{label:"ИНН",children:yr(u.pledgerInn)}),i.jsx(we.Item,{label:"ОГРН",children:yr(u.pledgerOgrn)}),i.jsx(we.Item,{label:"Адрес",span:3,children:yr(u.pledgerAddress)}),u.borrowerName&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Заемщик"}),i.jsx(we.Item,{label:"Наименование",span:2,children:yr(u.borrowerName)}),i.jsx(we.Item,{label:"ИНН",children:yr(u.borrowerInn)})]}),i.jsx(jt,{orientation:"left",children:"Предмет залога"}),i.jsx(we.Item,{label:"Тип имущества",span:1,children:yr(u.collateralType)}),i.jsx(we.Item,{label:"Наименование",span:2,children:yr(u.collateralName)}),u.collateralType==="Транспортные средства"&&i.jsxs(i.Fragment,{children:[i.jsx(we.Item,{label:"Марка",children:yr(u.vehicleBrand)}),i.jsx(we.Item,{label:"Модель",children:yr(u.vehicleModel)}),i.jsx(we.Item,{label:"Год выпуска",children:yr(u.vehicleYear)}),i.jsx(we.Item,{label:"VIN",children:yr(u.vehicleVin)}),i.jsx(we.Item,{label:"Гос. номер",children:yr(u.vehicleRegistrationNumber)}),i.jsx(we.Item,{label:"Номер кузова",children:yr(u.vehicleBodyNumber)}),i.jsx(we.Item,{label:"Номер шасси",children:yr(u.vehicleChassisNumber)}),i.jsx(we.Item,{label:"Номер рамы",children:yr(u.vehicleFrameNumber)})]}),u.collateralType==="Оборудование"&&i.jsxs(i.Fragment,{children:[i.jsx(we.Item,{label:"Наименование",span:2,children:yr(u.equipmentName)}),i.jsx(we.Item,{label:"Производитель",children:yr(u.equipmentManufacturer)}),i.jsx(we.Item,{label:"Модель",children:yr(u.equipmentModel)}),i.jsx(we.Item,{label:"Серийный номер",children:yr(u.equipmentSerialNumber)}),i.jsx(we.Item,{label:"Инвентарный номер",children:yr(u.equipmentInventoryNumber)}),i.jsx(we.Item,{label:"Год выпуска",children:yr(u.equipmentYear)})]}),i.jsx(jt,{orientation:"left",children:"Оценка"}),i.jsx(we.Item,{label:"Рыночная стоимость",children:Vp(u.marketValue)}),i.jsx(we.Item,{label:"Залоговая стоимость",children:Vp(u.collateralValue)}),i.jsx(we.Item,{label:"Сумма обязательства",children:Vp(u.pledgeAmount)}),i.jsx(jt,{orientation:"left",children:"Договор залога"}),i.jsx(we.Item,{label:"№ договора",children:yr(u.pledgeContractNumber)}),i.jsx(we.Item,{label:"Дата договора",children:yr(u.pledgeContractDate)}),i.jsx(we.Item,{label:"Сумма обязательства",children:Vp(u.pledgeAmount)}),u.notaryName&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Нотариус"}),i.jsx(we.Item,{label:"ФИО нотариуса",span:2,children:yr(u.notaryName)}),i.jsx(we.Item,{label:"Регион",children:yr(u.notaryRegion)}),i.jsx(we.Item,{label:"Нотариальная контора",span:3,children:yr(u.notaryOffice)})]}),u.rejectionReason&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Отклонение"}),i.jsx(we.Item,{label:"Причина отклонения",span:3,children:i.jsx(T1,{style:{margin:0,color:"#ff4d4f"},children:u.rejectionReason})})]}),u.comments&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Комментарии"}),i.jsx(we.Item,{label:"Примечания",span:3,children:i.jsx(T1,{style:{margin:0},children:u.comments})})]})]})})}),i.jsx(dr,{title:u?"Редактировать регистрацию":"Создать регистрацию залога ФНП",open:x,onCancel:()=>{v(!1),E.resetFields()},footer:[i.jsx(Be,{onClick:()=>{v(!1),E.resetFields()},children:"Отмена"},"cancel"),i.jsx(Be,{type:"primary",onClick:P,children:u?"Сохранить":"Создать"},"submit")],width:900,children:i.jsxs(ne,{form:E,layout:"vertical",children:[i.jsx(ne.Item,{name:"reference",label:"REFERENCE сделки",tooltip:"Выберите сделку из портфеля для автозаполнения данных",children:i.jsx(Ye,{placeholder:"Выберите REFERENCE",showSearch:!0,allowClear:!0,onChange:V,filterOption:(z,G)=>String((G==null?void 0:G.children)||"").toLowerCase().includes(z.toLowerCase()),children:D.map(z=>i.jsxs(Ps,{value:z.reference,children:[z.reference," - ",z.borrower||z.pledger||"Не указано"]},z.reference))})}),i.jsx(ne.Item,{name:"status",label:"Статус",rules:[{required:!0}],children:i.jsxs(Ye,{children:[i.jsx(Ps,{value:"draft",children:"Черновик"}),i.jsx(Ps,{value:"submitted",children:"Подано"}),i.jsx(Ps,{value:"registered",children:"Зарегистрировано"}),i.jsx(Ps,{value:"rejected",children:"Отклонено"}),i.jsx(Ps,{value:"cancelled",children:"Аннулировано"})]})}),i.jsx(jt,{orientation:"left",children:"Залогодатель"}),i.jsx(ne.Item,{name:"pledgerType",label:"Тип залогодателя",rules:[{required:!0}],children:i.jsxs(Ye,{children:[i.jsx(Ps,{value:"legal",children:"Юридическое лицо"}),i.jsx(Ps,{value:"individual",children:"Физическое лицо"})]})}),i.jsx(ne.Item,{name:"pledgerName",label:"Наименование залогодателя",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Наименование"})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgerInn",label:"ИНН",children:i.jsx(Re,{placeholder:"ИНН"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgerOgrn",label:"ОГРН",children:i.jsx(Re,{placeholder:"ОГРН"})})})]}),i.jsx(ne.Item,{name:"pledgerAddress",label:"Адрес залогодателя",children:i.jsx(Du,{rows:2,placeholder:"Адрес"})}),i.jsx(jt,{orientation:"left",children:"Заемщик"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:16,children:i.jsx(ne.Item,{name:"borrowerName",label:"Наименование заемщика",children:i.jsx(Re,{placeholder:"Наименование"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"borrowerInn",label:"ИНН заемщика",children:i.jsx(Re,{placeholder:"ИНН"})})})]}),i.jsx(jt,{orientation:"left",children:"Предмет залога"}),i.jsx(ne.Item,{name:"collateralType",label:"Тип движимого имущества",rules:[{required:!0}],children:i.jsxs(Ye,{placeholder:"Выберите тип",children:[i.jsx(Ps,{value:"Транспортные средства",children:"Транспортные средства"}),i.jsx(Ps,{value:"Оборудование",children:"Оборудование"}),i.jsx(Ps,{value:"Товары в обороте",children:"Товары в обороте"})]})}),i.jsx(ne.Item,{name:"collateralName",label:"Наименование предмета залога",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Наименование"})}),i.jsx(ne.Item,{name:"collateralDescription",label:"Описание предмета залога",children:i.jsx(Du,{rows:3,placeholder:"Подробное описание"})}),i.jsx(ne.Item,{noStyle:!0,shouldUpdate:(z,G)=>z.collateralType!==G.collateralType,children:({getFieldValue:z})=>{const G=z("collateralType");return G==="Транспортные средства"?i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Данные транспортного средства"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"vehicleBrand",label:"Марка",children:i.jsx(Re,{placeholder:"Марка ТС"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"vehicleModel",label:"Модель",children:i.jsx(Re,{placeholder:"Модель"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"vehicleYear",label:"Год выпуска",children:i.jsx(fa,{style:{width:"100%"},min:1900,max:new Date().getFullYear()})})}),i.jsx(Te,{span:16,children:i.jsx(ne.Item,{name:"vehicleVin",label:"VIN номер",children:i.jsx(Re,{placeholder:"VIN"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"vehicleRegistrationNumber",label:"Гос. номер",children:i.jsx(Re,{placeholder:"A777AA92"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"vehicleBodyNumber",label:"Номер кузова",children:i.jsx(Re,{placeholder:"Номер кузова"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"vehicleChassisNumber",label:"Номер шасси",children:i.jsx(Re,{placeholder:"Номер шасси"})})})]}),i.jsx(ne.Item,{name:"vehicleFrameNumber",label:"Номер рамы",children:i.jsx(Re,{placeholder:"Номер рамы"})})]}):G==="Оборудование"?i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Данные оборудования"}),i.jsx(ne.Item,{name:"equipmentName",label:"Наименование оборудования",children:i.jsx(Re,{placeholder:"Наименование"})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"equipmentManufacturer",label:"Производитель",children:i.jsx(Re,{placeholder:"Производитель"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"equipmentModel",label:"Модель",children:i.jsx(Re,{placeholder:"Модель"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"equipmentSerialNumber",label:"Серийный номер",children:i.jsx(Re,{placeholder:"Серийный номер"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"equipmentInventoryNumber",label:"Инвентарный номер",children:i.jsx(Re,{placeholder:"Инвентарный номер"})})})]}),i.jsx(ne.Item,{name:"equipmentYear",label:"Год выпуска",children:i.jsx(fa,{style:{width:"100%"},min:1900,max:new Date().getFullYear()})})]}):G==="Товары в обороте"?i.jsxs(i.Fragment,{children:[i.jsx(jt,{orientation:"left",children:"Данные товаров"}),i.jsx(ne.Item,{name:"goodsDescription",label:"Описание товаров",children:i.jsx(Du,{rows:3,placeholder:"Подробное описание товаров"})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"goodsQuantity",label:"Количество",children:i.jsx(fa,{style:{width:"100%"},min:0})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"goodsUnit",label:"Единица измерения",children:i.jsx(Re,{placeholder:"шт., кг, м и т.д."})})})]})]}):null}}),i.jsx(jt,{orientation:"left",children:"Оценка"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"marketValue",label:"Рыночная стоимость, руб.",children:i.jsx(fa,{style:{width:"100%"},min:0,addonAfter:"руб."})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"collateralValue",label:"Залоговая стоимость, руб.",children:i.jsx(fa,{style:{width:"100%"},min:0,addonAfter:"руб."})})})]}),i.jsx(jt,{orientation:"left",children:"Договор залога"}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgeContractNumber",label:"№ договора залога",children:i.jsx(Re,{placeholder:"Номер договора"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"pledgeContractDate",label:"Дата договора залога",children:i.jsx(Rr,{style:{width:"100%"},format:"YYYY-MM-DD"})})})]}),i.jsx(ne.Item,{name:"pledgeAmount",label:"Сумма обязательства, обеспеченного залогом, руб.",children:i.jsx(fa,{style:{width:"100%"},min:0,addonAfter:"руб."})}),i.jsx(jt,{orientation:"left",children:"Нотариус"}),i.jsx(ne.Item,{name:"notaryName",label:"ФИО нотариуса",children:i.jsx(Re,{placeholder:"ФИО нотариуса"})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"notaryRegion",label:"Регион",children:i.jsx(Re,{placeholder:"Регион"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"notaryOffice",label:"Нотариальная контора",children:i.jsx(Re,{placeholder:"Название конторы"})})})]}),i.jsx(ne.Item,{name:"comments",label:"Комментарии",children:i.jsx(Du,{rows:3,placeholder:"Дополнительные комментарии"})}),(u==null?void 0:u.status)==="rejected"&&i.jsx(ne.Item,{name:"rejectionReason",label:"Причина отклонения",children:i.jsx(Du,{rows:2,placeholder:"Причина отклонения регистрации"})})]})})]})},{Title:iV,Text:sV}=mt,{Option:wa}=Ye,oV=()=>{const e=$s(),[t]=ne.useForm(),[r,a]=K.useState([]),[n]=K.useState(!1),[s,o]=K.useState(""),[A,c]=K.useState(null),[l,d]=K.useState(null),[f,p]=K.useState(null),[u,g]=K.useState(null),[h,y]=K.useState(!1),[x,v]=K.useState(!1),[E,D]=K.useState(!1);K.useEffect(()=>{(()=>{try{const V=localStorage.getItem("creditRiskRecords");if(V){const ie=JSON.parse(V);a(ie.map((W,z)=>({...W,key:W.id||`risk-${z}`})))}}catch(V){console.error("Ошибка загрузки данных ФКР:",V),a([])}})()},[]);const B=U=>{try{localStorage.setItem("creditRiskRecords",JSON.stringify(U)),a(U.map((V,ie)=>({...V,key:V.id||`risk-${ie}`})))}catch(V){console.error("Ошибка сохранения данных ФКР:",V),Ne.error("Ошибка сохранения данных")}},I=K.useMemo(()=>{const U=s.trim().toLowerCase();return r.filter(V=>{var b,k,j;const ie=!U||String(V.reference).toLowerCase().includes(U)||((b=V.contractNumber)==null?void 0:b.toLowerCase().includes(U))||((k=V.pledger)==null?void 0:k.toLowerCase().includes(U))||((j=V.borrower)==null?void 0:j.toLowerCase().includes(U))||V.riskEvent.name.toLowerCase().includes(U),W=!A||V.status===A,z=!l||V.riskEvent.category===l,G=!f||V.priority===f;return ie&&W&&z&&G})},[r,s,A,l,f]),_=K.useMemo(()=>{const U=r.filter(z=>z.status==="active").length,V=r.filter(z=>z.status==="resolved").length,ie=r.filter(z=>z.priority==="critical"&&z.status==="active").length,W=r.filter(z=>z.priority==="high"&&z.status==="active").length;return{total:r.length,active:U,resolved:V,critical:ie,high:W}},[r]),S=()=>{g(null),t.resetFields(),D(!0)},O=U=>{g(U),y(!0)},M=U=>{g(U),t.setFieldsValue({...U,eventDate:U.eventDate?We(U.eventDate):null,detectionDate:U.detectionDate?We(U.detectionDate):null,resolutionDate:U.resolutionDate?We(U.resolutionDate):null,riskEventCode:U.riskEvent.code}),v(!0)},T=async U=>{try{const V=A2.find(z=>z.code===U.riskEventCode);if(!V){Ne.error("Рисковое событие не найдено");return}const ie={id:(u==null?void 0:u.id)||`risk-${Date.now()}`,reference:U.reference,contractNumber:U.contractNumber,pledger:U.pledger,pledgerInn:U.pledgerInn,borrower:U.borrower,borrowerInn:U.borrowerInn,riskEvent:V,suspensiveConditionId:U.suspensiveConditionId,suspensiveConditionDescription:U.suspensiveConditionDescription,insuranceRelated:U.insuranceRelated||!1,insurancePolicyNumber:U.insurancePolicyNumber,status:U.status||"active",eventDate:U.eventDate?U.eventDate.format("YYYY-MM-DD"):We().format("YYYY-MM-DD"),detectionDate:U.detectionDate?U.detectionDate.format("YYYY-MM-DD"):We().format("YYYY-MM-DD"),resolutionDate:U.resolutionDate?U.resolutionDate.format("YYYY-MM-DD"):void 0,description:U.description,comments:U.comments,resolution:U.resolution,detectedBy:U.detectedBy,responsible:U.responsible,reviewer:U.reviewer,priority:U.priority||"medium",documents:U.documents||[],createdAt:(u==null?void 0:u.createdAt)||We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")},W=u?r.map(z=>z.id===u.id?ie:z):[...r,ie];B(W),Ne.success(u?"Запись обновлена":"Запись создана"),v(!1),D(!1),t.resetFields()}catch(V){console.error("Ошибка сохранения:",V),Ne.error("Ошибка сохранения записи")}},R=U=>{switch(U){case"active":return"red";case"resolved":return"green";case"archived":return"default";default:return"default"}},L=U=>{switch(U){case"critical":return"red";case"high":return"orange";case"medium":return"blue";case"low":return"green";default:return"default"}},N=U=>({collateral:"purple",borrower:"cyan",financial:"gold",transport:"blue",rating:"orange",industry:"volcano",legal:"red"})[U]||"default",P=[{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:(U,V)=>i.jsx(Be,{type:"link",onClick:()=>e(`/portfolio?q=${V.reference}`),icon:i.jsx(eA,{}),children:V.reference})},{title:"Договор залога",dataIndex:"contractNumber",key:"contractNumber",width:150},{title:"Залогодатель",dataIndex:"pledger",key:"pledger",width:200},{title:"Рисковое событие",key:"riskEvent",width:300,render:(U,V)=>i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsx(at,{color:N(V.riskEvent.category),children:V.riskEvent.code}),i.jsx(sV,{style:{fontSize:"12px"},children:V.riskEvent.name})]})},{title:"Статус",dataIndex:"status",key:"status",width:100,render:U=>{const V={active:"Активен",resolved:"Разрешен",archived:"Архив"};return i.jsx(at,{color:R(U),children:V[U]})}},{title:"Приоритет",dataIndex:"priority",key:"priority",width:100,render:U=>{const V={critical:"Критический",high:"Высокий",medium:"Средний",low:"Низкий"};return i.jsx(at,{color:L(U),children:V[U]})}},{title:"Дата события",dataIndex:"eventDate",key:"eventDate",width:120,render:U=>We(U).format("DD.MM.YYYY")},{title:"Действия",key:"actions",width:120,fixed:"right",render:(U,V)=>i.jsxs(Fe,{children:[i.jsx(Xr,{title:"Просмотр",children:i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>O(V)})}),i.jsx(Xr,{title:"Редактировать",children:i.jsx(Be,{type:"link",icon:i.jsx(Qr,{}),onClick:()=>M(V)})})]})}];return i.jsxs("div",{className:"credit-risk-page",children:[i.jsxs("div",{className:"credit-risk-page__header",children:[i.jsxs("div",{children:[i.jsx(iV,{level:2,className:"credit-risk-page__title",children:"Модуль мониторинга"}),i.jsx(mt.Paragraph,{className:"credit-risk-page__subtitle",children:"Отслеживание рисковых событий и отлагательных условий по договорам залога"})]}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:S,children:"Добавить рисковое событие"})]}),i.jsxs(ft,{gutter:[16,16],className:"credit-risk-page__stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего записей",value:_.total})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Активных рисков",value:_.active,valueStyle:{color:"#cf1322"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Критических",value:_.critical,valueStyle:{color:"#ff4d4f"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Разрешенных",value:_.resolved,valueStyle:{color:"#3f8600"}})})})]}),i.jsx(Ge,{children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsx(Re,{allowClear:!0,placeholder:"Поиск по REFERENCE, договору, залогодателю, заемщику",prefix:i.jsx(Pa,{}),value:s,onChange:U=>o(U.target.value),style:{width:"100%"}}),i.jsxs(Fe,{wrap:!0,children:[i.jsxs(Ye,{allowClear:!0,placeholder:"Статус",style:{width:150},value:A??void 0,onChange:U=>c(U??null),children:[i.jsx(wa,{value:"active",children:"Активен"}),i.jsx(wa,{value:"resolved",children:"Разрешен"}),i.jsx(wa,{value:"archived",children:"Архив"})]}),i.jsxs(Ye,{allowClear:!0,placeholder:"Категория",style:{width:200},value:l??void 0,onChange:U=>d(U??null),children:[i.jsx(wa,{value:"collateral",children:"Обеспечение"}),i.jsx(wa,{value:"borrower",children:"Заемщик/Залогодатель"}),i.jsx(wa,{value:"financial",children:"Финансовые"}),i.jsx(wa,{value:"transport",children:"Транспорт"}),i.jsx(wa,{value:"rating",children:"Рейтинг"}),i.jsx(wa,{value:"industry",children:"Отрасль"}),i.jsx(wa,{value:"legal",children:"Юридические"})]}),i.jsxs(Ye,{allowClear:!0,placeholder:"Приоритет",style:{width:150},value:f??void 0,onChange:U=>p(U??null),children:[i.jsx(wa,{value:"critical",children:"Критический"}),i.jsx(wa,{value:"high",children:"Высокий"}),i.jsx(wa,{value:"medium",children:"Средний"}),i.jsx(wa,{value:"low",children:"Низкий"})]})]})]})}),i.jsx(Ge,{bodyStyle:{padding:0},children:i.jsx(nr,{columns:P,dataSource:I,pagination:{pageSize:20,showSizeChanger:!0},scroll:{x:1200},loading:n,locale:{emptyText:i.jsx(Br,{description:"Нет записей"})}})}),i.jsx(dr,{title:"Детали рискового события",open:h,onCancel:()=>y(!1),footer:[i.jsx(Be,{onClick:()=>y(!1),children:"Закрыть"},"close")],width:800,children:u&&i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"REFERENCE",span:2,children:i.jsx(Be,{type:"link",onClick:()=>{e(`/portfolio?q=${u.reference}`),y(!1)},icon:i.jsx(eA,{}),children:u.reference})}),i.jsx(we.Item,{label:"Договор залога",children:u.contractNumber||"—"}),i.jsx(we.Item,{label:"Залогодатель",children:u.pledger}),i.jsx(we.Item,{label:"Заемщик",children:u.borrower||"—"}),i.jsx(we.Item,{label:"Рисковое событие",span:2,children:i.jsxs(Fe,{children:[i.jsx(at,{color:N(u.riskEvent.category),children:u.riskEvent.code}),u.riskEvent.name]})}),u.suspensiveConditionDescription&&i.jsx(we.Item,{label:"Отлагательное условие",span:2,children:u.suspensiveConditionDescription}),u.insuranceRelated&&i.jsx(we.Item,{label:"Страхование",span:2,children:i.jsx(Be,{type:"link",onClick:()=>{e(`/insurance?ref=${u.reference}`),y(!1)},icon:i.jsx(RT,{}),children:u.insurancePolicyNumber||"Перейти к страхованию"})}),i.jsx(we.Item,{label:"Статус",children:i.jsx(at,{color:R(u.status),children:u.status==="active"?"Активен":u.status==="resolved"?"Разрешен":"Архив"})}),i.jsx(we.Item,{label:"Приоритет",children:i.jsx(at,{color:L(u.priority),children:u.priority==="critical"?"Критический":u.priority==="high"?"Высокий":u.priority==="medium"?"Средний":"Низкий"})}),i.jsx(we.Item,{label:"Дата события",children:We(u.eventDate).format("DD.MM.YYYY")}),i.jsx(we.Item,{label:"Дата обнаружения",children:We(u.detectionDate).format("DD.MM.YYYY")}),u.resolutionDate&&i.jsx(we.Item,{label:"Дата разрешения",children:We(u.resolutionDate).format("DD.MM.YYYY")}),u.description&&i.jsx(we.Item,{label:"Описание",span:2,children:u.description}),u.comments&&i.jsx(we.Item,{label:"Комментарии",span:2,children:u.comments}),u.resolution&&i.jsx(we.Item,{label:"Способ разрешения",span:2,children:u.resolution})]})}),i.jsx(f2,{title:u?"Редактировать запись":"Добавить рисковое событие",open:x||E,onClose:()=>{v(!1),D(!1),t.resetFields()},width:600,children:i.jsxs(ne,{form:t,layout:"vertical",onFinish:T,initialValues:{status:"active",priority:"medium",eventDate:We(),detectionDate:We()},children:[i.jsx(ne.Item,{name:"reference",label:"REFERENCE",rules:[{required:!0,message:"Укажите REFERENCE"}],children:i.jsx(Re,{placeholder:"REFERENCE сделки"})}),i.jsx(ne.Item,{name:"contractNumber",label:"Договор залога",children:i.jsx(Re,{placeholder:"Номер договора залога"})}),i.jsx(ne.Item,{name:"pledger",label:"Залогодатель",rules:[{required:!0,message:"Укажите залогодателя"}],children:i.jsx(Re,{placeholder:"Наименование залогодателя"})}),i.jsx(ne.Item,{name:"pledgerInn",label:"ИНН залогодателя",children:i.jsx(Re,{placeholder:"ИНН"})}),i.jsx(ne.Item,{name:"borrower",label:"Заемщик",children:i.jsx(Re,{placeholder:"Наименование заемщика"})}),i.jsx(ne.Item,{name:"borrowerInn",label:"ИНН заемщика",children:i.jsx(Re,{placeholder:"ИНН"})}),i.jsx(ne.Item,{name:"riskEventCode",label:"Рисковое событие",rules:[{required:!0,message:"Выберите рисковое событие"}],children:i.jsx(Ye,{placeholder:"Выберите событие",showSearch:!0,optionFilterProp:"children",children:A2.map(U=>i.jsxs(wa,{value:U.code,children:["[",U.code,"] ",U.name]},U.code))})}),i.jsx(ne.Item,{name:"suspensiveConditionDescription",label:"Отлагательное условие",children:i.jsx(Re.TextArea,{rows:3,placeholder:"Описание отлагательного условия (если добавлено из заключения)"})}),i.jsx(ne.Item,{name:"insuranceRelated",label:"Связано со страхованием",valuePropName:"checked",children:i.jsx(Ni,{})}),i.jsx(ne.Item,{name:"insurancePolicyNumber",label:"Номер полиса страхования",children:i.jsx(Re,{placeholder:"Номер полиса"})}),i.jsx(ne.Item,{name:"status",label:"Статус",children:i.jsxs(Ye,{children:[i.jsx(wa,{value:"active",children:"Активен"}),i.jsx(wa,{value:"resolved",children:"Разрешен"}),i.jsx(wa,{value:"archived",children:"Архив"})]})}),i.jsx(ne.Item,{name:"priority",label:"Приоритет",children:i.jsxs(Ye,{children:[i.jsx(wa,{value:"low",children:"Низкий"}),i.jsx(wa,{value:"medium",children:"Средний"}),i.jsx(wa,{value:"high",children:"Высокий"}),i.jsx(wa,{value:"critical",children:"Критический"})]})}),i.jsx(ne.Item,{name:"eventDate",label:"Дата события",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"detectionDate",label:"Дата обнаружения",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"resolutionDate",label:"Дата разрешения",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"description",label:"Описание",children:i.jsx(Re.TextArea,{rows:4,placeholder:"Дополнительное описание события"})}),i.jsx(ne.Item,{name:"comments",label:"Комментарии",children:i.jsx(Re.TextArea,{rows:3,placeholder:"Комментарии"})}),i.jsx(ne.Item,{name:"resolution",label:"Способ разрешения",children:i.jsx(Re.TextArea,{rows:3,placeholder:"Как был разрешен риск"})}),i.jsx(ne.Item,{name:"detectedBy",label:"Обнаружил",children:i.jsx(Re,{placeholder:"ФИО сотрудника"})}),i.jsx(ne.Item,{name:"responsible",label:"Ответственный",children:i.jsx(Re,{placeholder:"ФИО ответственного"})}),i.jsx(ne.Item,{children:i.jsxs(Fe,{children:[i.jsx(Be,{type:"primary",htmlType:"submit",children:u?"Сохранить":"Создать"}),i.jsx(Be,{onClick:()=>{v(!1),D(!1),t.resetFields()},children:"Отмена"})]})})]})})]})},{Title:FE,Text:ld}=mt,AV=()=>{var W;const[e,t]=K.useState("collateral"),[r,a]=K.useState(null),[n,s]=K.useState([]),[o,A]=K.useState(!1),[c,l]=K.useState(!1),[d,f]=K.useState(!1),[p,u]=K.useState([]),[g,h]=K.useState(""),[y,x]=K.useState(null),[v,E]=K.useState(!1),[D,B]=K.useState(!1);K.useEffect(()=>{(async()=>{A(!0);try{if(e==="collateral"){const b=(await Yt.getExtendedCards()).map(k=>{var j,q,Y,de;return{id:k.id,type:"collateral",name:k.name,reference:k.reference,contractNumber:k.contractNumber,collateralType:(j=k.classification)==null?void 0:j.level1,address:(q=k.address)==null?void 0:q.fullAddress,area:((Y=k.characteristics)==null?void 0:Y.totalAreaSqm)||((de=k.characteristics)==null?void 0:de.totalArea),characteristics:k.characteristics||{}}});s(b)}else if(e==="conclusion")try{const G="./",b=new URL(G,window.location.origin),k=b.pathname.endsWith("/")?b.pathname:`${b.pathname}/`,j=`${b.origin}${k}collateralConclusionsData.json?v=${Date.now()}`,q=await fetch(j,{cache:"no-store"});if(q.ok){const de=(await q.json()).map(ue=>({id:ue.id,type:"conclusion",name:ue.collateralName||ue.collateralType||"Залоговое заключение",reference:ue.reference||void 0,contractNumber:ue.contractNumber||void 0,collateralType:ue.collateralType||void 0,address:ue.collateralLocation||void 0,area:ue.totalAreaSqm||ue.totalAreaHectares||void 0,characteristics:{marketValue:ue.marketValue,collateralValue:ue.collateralValue,fairValue:ue.fairValue}}));s(de)}}catch(G){console.error("Ошибка загрузки заключений:",G),s([])}else if(e==="portfolio")try{const G="./",b=new URL(G,window.location.origin),k=b.pathname.endsWith("/")?b.pathname:`${b.pathname}/`,j=`${b.origin}${k}portfolioData.json?v=${Date.now()}`,q=await fetch(j,{cache:"no-store"});if(q.ok){const de=(await q.json()).map(ue=>({id:String(ue.reference||`portfolio-${ue.contractNumber}`),type:"portfolio",name:`${ue.borrower||ue.pledger||"Договор"} - ${ue.collateralType||"Обеспечение"}`,reference:ue.reference||void 0,contractNumber:ue.contractNumber||void 0,collateralType:ue.collateralType||void 0,address:ue.collateralLocation||void 0,characteristics:{marketValue:ue.marketValue,collateralValue:ue.collateralValue,fairValue:ue.fairValue}}));s(de)}}catch(G){console.error("Ошибка загрузки портфеля:",G),s([])}}catch(G){console.error("Ошибка загрузки объектов:",G),Ne.error("Ошибка загрузки объектов"),s([])}finally{A(!1)}})()},[e]),K.useEffect(()=>{(()=>{try{const G=localStorage.getItem("appraisalResults");if(G){const b=JSON.parse(G);u(b.map((k,j)=>({...k,key:k.id||`result-${j}`})))}}catch(G){console.error("Ошибка загрузки результатов оценки:",G)}})()},[]);const I=K.useMemo(()=>{const z=g.trim().toLowerCase();return n.filter(G=>{var b,k;return!z||G.name.toLowerCase().includes(z)||String(G.reference||"").toLowerCase().includes(z)||((b=G.contractNumber)==null?void 0:b.toLowerCase().includes(z))||((k=G.address)==null?void 0:k.toLowerCase().includes(z))})},[n,g]),_=()=>{B(!0)},S=z=>{a(z),B(!1)},O=async()=>{if(!r){Ne.warning("Выберите объект для оценки");return}l(!0);try{await new Promise(k=>setTimeout(k,2e3));const z=T(r),G=localStorage.getItem("appraisalResults"),b=G?JSON.parse(G):[];b.push(z),localStorage.setItem("appraisalResults",JSON.stringify(b)),u(k=>[...k,{...z,key:z.id}]),Ne.success("Оценка выполнена успешно"),a(null)}catch(z){console.error("Ошибка оценки:",z),Ne.error("Ошибка выполнения оценки")}finally{l(!1)}},M=async()=>{if(!r){Ne.warning("Выберите объект для оценки");return}f(!0);try{const z=R(r),G=r.characteristics?Object.entries(r.characteristics).slice(0,5).map(([Y,de])=>`${Y}: ${de}`).join("; "):void 0,b=await _y.generateEstimate({objectName:r.name,assetGroup:z,assetType:r.collateralType||r.type,location:r.address,area:r.area,purpose:'Экспресс-оценка в модуле "Оценка"',additionalFactors:G,card:null}),k=L(b,r),j=localStorage.getItem("appraisalResults"),q=j?JSON.parse(j):[];q.push(k),localStorage.setItem("appraisalResults",JSON.stringify(q)),u(Y=>[...Y,{...k,key:k.id}]),r.type==="collateral"&&Ph.add({cardId:r.id,objectId:r.id,objectName:r.name,estimate:b,input:{objectName:r.name,assetGroup:z,assetType:r.collateralType||r.type,location:r.address,area:r.area,card:null,purpose:"Экспресс-оценка",additionalFactors:G}}),Ne.success("AI помощник выполнил оценку объекта")}catch(z){console.error("Ошибка AI оценки:",z),Ne.error("Не удалось выполнить AI оценку")}finally{f(!1)}},T=z=>{var de,ue,pe;const G=z.area||100,b=1e5;let k=1;(de=z.collateralType)!=null&&de.includes("Офис")&&(k=1.2),(ue=z.collateralType)!=null&&ue.includes("Склад")&&(k=.8),(pe=z.collateralType)!=null&&pe.includes("Торгов")&&(k=1.5);const j=Math.round(G*b*k),q=Math.round(j*.7),Y=Math.round(j*.85);return{id:`appraisal-${Date.now()}`,requestId:`request-${Date.now()}`,objectId:z.id,objectType:z.type,marketValue:j,collateralValue:q,fairValue:Y,appraisalMethod:"Сравнительный подход (база данных аналогов в разработке)",comparableObjectsCount:0,confidenceLevel:"medium",details:"Автоматическая оценка выполнена на основе характеристик объекта. База данных аналогичных объектов находится в разработке.",notes:"Оценка выполнена автоматически. Требуется проверка оценщиком.",appraisedAt:We().format("YYYY-MM-DD HH:mm:ss"),status:"draft"}},R=z=>{const G=(z.collateralType||"").toLowerCase();if(G.includes("зем"))return"land";if(G.includes("недвиж")||G.includes("офис")||G.includes("склад")||G.includes("торгов"))return"real_estate";if(G.includes("акци")||G.includes("дол"))return"equity";if(G.includes("прав")||G.includes("интеллект"))return"rights";if(G.includes("товар")||G.includes("урож"))return"metals_goods";if(G.includes("транспорт")||G.includes("оборуд")||G.includes("техника"))return"movable";switch(z.type){case"collateral":return"real_estate";case"conclusion":return"real_estate";case"portfolio":return"real_estate";default:return"movable"}},L=(z,G)=>{var b;return{id:`ai-appraisal-${Date.now()}`,requestId:`ai-${Date.now()}`,objectId:G.id,objectType:G.type,marketValue:z.marketValue,collateralValue:z.collateralValue,fairValue:Math.round(z.marketValue*.9),appraisalMethod:z.methodology,comparableObjectsCount:((b=z.comparables)==null?void 0:b.length)||0,confidenceLevel:z.confidence,details:z.summary,notes:`Риски: ${z.riskFactors.join("; ")||"—"}. Рекомендации: ${z.recommendedActions.join("; ")||"—"}`,appraisedAt:We().format("YYYY-MM-DD HH:mm:ss"),status:"draft"}},N=z=>{x(z),E(!0)},P=z=>{switch(z){case"approved":return"green";case"rejected":return"red";case"draft":return"orange";default:return"default"}},U=z=>{switch(z){case"approved":return i.jsx(On,{});case"rejected":return i.jsx(ZA,{});case"draft":return i.jsx(zn,{});default:return null}},V=z=>{switch(z){case"collateral":return"Объект залога";case"conclusion":return"Залоговое заключение";case"portfolio":return"Договор из портфеля";default:return z}},ie=[{title:"Объект",key:"object",width:200,render:(z,G)=>{const b=n.find(k=>k.id===G.objectId);return i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsx(ld,{strong:!0,children:(b==null?void 0:b.name)||"Неизвестный объект"}),i.jsx(at,{children:V(G.objectType)})]})}},{title:"REFERENCE",dataIndex:"objectId",key:"reference",width:120,render:(z,G)=>{const b=n.find(k=>k.id===G.objectId);return b!=null&&b.reference?String(b.reference):"—"}},{title:"Рыночная стоимость",dataIndex:"marketValue",key:"marketValue",width:150,render:z=>z?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(z):"—"},{title:"Залоговая стоимость",dataIndex:"collateralValue",key:"collateralValue",width:150,render:z=>z?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(z):"—"},{title:"Метод",dataIndex:"appraisalMethod",key:"appraisalMethod",width:200,ellipsis:!0},{title:"Уверенность",dataIndex:"confidenceLevel",key:"confidenceLevel",width:120,render:z=>{const G={high:"green",medium:"orange",low:"red"},b={high:"Высокая",medium:"Средняя",low:"Низкая"};return i.jsx(at,{color:G[z],children:b[z]})}},{title:"Статус",dataIndex:"status",key:"status",width:120,render:z=>{const G={draft:"Черновик",approved:"Утверждено",rejected:"Отклонено"};return i.jsx(at,{color:P(z),icon:U(z),children:G[z]})}},{title:"Дата оценки",dataIndex:"appraisedAt",key:"appraisedAt",width:150,render:z=>We(z).format("DD.MM.YYYY HH:mm")},{title:"Действия",key:"actions",width:100,fixed:"right",render:(z,G)=>i.jsx(Xr,{title:"Просмотр",children:i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>N(G)})})}];return i.jsxs("div",{className:"appraisal-page",children:[i.jsx("div",{className:"appraisal-page__header",children:i.jsxs("div",{children:[i.jsx(FE,{level:2,className:"appraisal-page__title",children:"Модуль оценки"}),i.jsx(mt.Paragraph,{className:"appraisal-page__subtitle",children:"Автоматическая оценка объектов залога на основе базы данных аналогичных объектов"})]})}),i.jsx(Ge,{children:i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(ld,{strong:!0,style:{marginRight:16},children:"Выберите тип объекта:"}),i.jsxs(Ho.Group,{value:e,onChange:z=>{t(z.target.value),a(null)},children:[i.jsxs(Ho.Button,{value:"collateral",children:[i.jsx(JA,{})," Объекты залога"]}),i.jsxs(Ho.Button,{value:"conclusion",children:[i.jsx(Qr,{})," Залоговые заключения"]}),i.jsxs(Ho.Button,{value:"portfolio",children:[i.jsx(ZE,{})," Договоры из портфеля"]})]})]}),i.jsxs(Fe,{style:{width:"100%"},direction:"vertical",children:[i.jsx(ld,{strong:!0,children:"Выбранный объект:"}),r?i.jsx(Ge,{size:"small",style:{backgroundColor:"#f0f9ff"},children:i.jsxs(Fe,{direction:"vertical",size:"small",style:{width:"100%"},children:[i.jsx(ld,{strong:!0,children:r.name}),i.jsxs(Fe,{children:[i.jsx(at,{children:V(r.type)}),r.reference&&i.jsxs(at,{children:["REF: ",r.reference]}),r.contractNumber&&i.jsxs(at,{children:["Договор: ",r.contractNumber]})]}),r.address&&i.jsx(ld,{type:"secondary",style:{fontSize:"12px"},children:r.address}),r.area&&i.jsxs(ld,{type:"secondary",style:{fontSize:"12px"},children:["Площадь: ",r.area," ","кв.м"]})]})}):i.jsx(Br,{description:"Объект не выбран",image:Br.PRESENTED_IMAGE_SIMPLE}),i.jsxs(Fe,{children:[i.jsx(Be,{type:"primary",onClick:_,icon:i.jsx(Pa,{}),children:"Выбрать объект"}),i.jsx(Be,{type:"primary",onClick:O,icon:i.jsx(MA,{}),loading:c,disabled:!r,children:"Выполнить оценку"}),i.jsx(Be,{type:"default",onClick:M,icon:i.jsx(bf,{}),loading:d,disabled:!r,children:"Оценка ИИ"})]})]})]})}),i.jsx(Nr,{message:"База данных аналогичных объектов",description:"База данных аналогичных объектов находится в разработке. В настоящее время оценка выполняется на основе базовых алгоритмов. После внедрения базы данных оценка будет выполняться на основе реальных данных об аналогичных объектах.",type:"info",showIcon:!0,style:{marginTop:16,marginBottom:16}}),i.jsxs(Ge,{children:[i.jsx(FE,{level:4,children:"История оценок"}),i.jsx(nr,{columns:ie,dataSource:p,pagination:{pageSize:15,showSizeChanger:!0},scroll:{x:1200},loading:o,locale:{emptyText:i.jsx(Br,{description:"Нет выполненных оценок"})}})]}),i.jsxs(dr,{title:`Выбор объекта: ${V(e)}`,open:D,onCancel:()=>B(!1),footer:null,width:800,children:[i.jsx(Re,{placeholder:"Поиск по названию, REFERENCE, договору, адресу",prefix:i.jsx(Pa,{}),value:g,onChange:z=>h(z.target.value),style:{marginBottom:16}}),i.jsx(nr,{dataSource:I,rowKey:"id",pagination:{pageSize:10},size:"small",onRow:z=>({onClick:()=>S(z),style:{cursor:"pointer"}}),columns:[{title:"Название",dataIndex:"name",key:"name",ellipsis:!0},{title:"REFERENCE",dataIndex:"reference",key:"reference",width:120,render:z=>z||"—"},{title:"Тип",dataIndex:"collateralType",key:"collateralType",width:150,ellipsis:!0},{title:"Адрес",dataIndex:"address",key:"address",ellipsis:!0}]})]}),i.jsx(dr,{title:"Результат оценки",open:v,onCancel:()=>E(!1),footer:[i.jsx(Be,{onClick:()=>E(!1),children:"Закрыть"},"close")],width:700,children:y&&i.jsx(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Объект",span:2,children:((W=n.find(z=>z.id===y.objectId))==null?void 0:W.name)||"Неизвестный объект"}),i.jsx(we.Item,{label:"Тип объекта",children:V(y.objectType)}),i.jsx(we.Item,{label:"Статус",children:i.jsx(at,{color:P(y.status),icon:U(y.status),children:y.status==="draft"?"Черновик":y.status==="approved"?"Утверждено":"Отклонено"})}),i.jsx(we.Item,{label:"Рыночная стоимость",span:1,children:y.marketValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(y.marketValue):"—"}),i.jsx(we.Item,{label:"Залоговая стоимость",span:1,children:y.collateralValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(y.collateralValue):"—"}),i.jsx(we.Item,{label:"Справедливая стоимость",span:1,children:y.fairValue?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(y.fairValue):"—"}),i.jsx(we.Item,{label:"Уверенность",span:1,children:i.jsx(at,{color:y.confidenceLevel==="high"?"green":y.confidenceLevel==="medium"?"orange":"red",children:y.confidenceLevel==="high"?"Высокая":y.confidenceLevel==="medium"?"Средняя":"Низкая"})}),i.jsx(we.Item,{label:"Метод оценки",span:2,children:y.appraisalMethod||"—"}),i.jsx(we.Item,{label:"Количество аналогов",span:1,children:y.comparableObjectsCount??0}),i.jsx(we.Item,{label:"Дата оценки",span:1,children:We(y.appraisedAt).format("DD.MM.YYYY HH:mm")}),y.details&&i.jsx(we.Item,{label:"Детали",span:2,children:y.details}),y.notes&&i.jsx(we.Item,{label:"Примечания",span:2,children:y.notes})]})})})]})},RE=()=>[{id:"egrn-1",serviceType:"encumbrance_removal",objectName:"Квартира",address:"ул. Колпакова, стр. 41А, кв. 73",cadastralNumber:"77:01:0001001:1234",reference:"REF-2021-001",contractNumber:"ДЗ-2021-001",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",encumbranceType:"ипотека",encumbranceNumber:"ИП-2020-001",encumbranceDate:"2020-05-15",removalReason:"Погашение кредита",status:"in_progress",submittedAt:"2021-09-10",employeeName:"Филиппова В. П.",participants:["Филиппова В. П."],createdAt:"2021-09-10",updatedAt:"2021-09-15"},{id:"egrn-2",serviceType:"mortgage_registration",objectName:"Квартира",address:"ул. Шаболовка, д. 4, кв. 10",cadastralNumber:"77:01:0001002:2345",reference:"REF-2021-002",contractNumber:"ДЗ-2021-002",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-002",mortgageContractDate:"2021-08-15",mortgageAmount:5e6,mortgageTerm:"20 лет",status:"in_progress",submittedAt:"2021-09-03",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Фоксин С. Е.","Иванов И. И."],createdAt:"2021-09-03",updatedAt:"2021-09-10"},{id:"egrn-3",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Мамина-Сибиряка, 58, корпус 1, помещение 301",cadastralNumber:"77:01:0001003:3456",reference:"REF-2021-003",contractNumber:"ДЗ-2021-003",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-003",mortgageContractDate:"2021-08-20",mortgageAmount:15e6,mortgageTerm:"15 лет",status:"in_progress",submittedAt:"2021-09-01",employeeName:"Хорошенько И. Г.",participants:["Коваленко С. Е.","Хорошенько И. Г.","Петров П. П."],createdAt:"2021-09-01",updatedAt:"2021-09-05"},{id:"egrn-4",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Сибиряков-Гвардейцев дом 61, здание 1, строение 8, комната 512/5",cadastralNumber:"77:01:0001004:4567",reference:"REF-2021-004",contractNumber:"ДЗ-2021-004",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-004",mortgageContractDate:"2021-08-10",mortgageAmount:8e6,mortgageTerm:"10 лет",status:"in_progress",submittedAt:"2021-08-22",employeeName:"Хорошенько И. Г.",participants:["Коваленко С. Е.","Хорошенько И. Г.","Сидоров С. С."],createdAt:"2021-08-22",updatedAt:"2021-08-25"},{id:"egrn-5",serviceType:"mortgage_registration",objectName:"Нежилое помещение",address:"ул. Цирковая, здание 12, корпус 7, помещение 81",cadastralNumber:"77:01:0001005:5678",reference:"REF-2021-005",contractNumber:"ДЗ-2021-005",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-005",mortgageContractDate:"2021-07-15",mortgageAmount:12e6,mortgageTerm:"12 лет",status:"completed",submittedAt:"2021-08-22",completedAt:"2021-09-15",resultNumber:"77-77/2021-123456",resultDate:"2021-09-15",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Фоксин С. Е.","Кузнецов К. К."],createdAt:"2021-08-22",updatedAt:"2021-09-15"},{id:"egrn-6",serviceType:"mortgage_registration",objectName:"Квартира",address:"ул. Карла Либкнехта, 133, кв. 5",cadastralNumber:"77:01:0001006:6789",reference:"REF-2021-006",contractNumber:"ДЗ-2021-006",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",mortgageContractNumber:"ИП-2021-006",mortgageContractDate:"2021-07-20",mortgageAmount:6e6,mortgageTerm:"25 лет",status:"submitted",submittedAt:"2021-08-13",employeeName:"Фокина С. А.",participants:["Коваленко С. Е.","Смирнов С. С."],createdAt:"2021-08-13",updatedAt:"2021-08-13"},{id:"egrn-extract-1",serviceType:"extract",objectName:"Квартира",address:"ул. Ленина, д. 10, кв. 25",cadastralNumber:"77:01:0002001:1001",reference:"REF-2021-101",contractNumber:"ДЗ-2021-101",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Для оценки залоговой стоимости",status:"completed",submittedAt:"2021-10-05",completedAt:"2021-10-12",resultNumber:"ВП-2021-001234",resultDate:"2021-10-12",cost:400,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Иванов И. И."],createdAt:"2021-10-05",updatedAt:"2021-10-12"},{id:"egrn-extract-2",serviceType:"extract",objectName:"Жилой дом",address:"ул. Пушкина, д. 5, стр. 1",cadastralNumber:"77:01:0002002:2002",reference:"REF-2021-102",contractNumber:"ДЗ-2021-102",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка кадастровых данных",status:"in_progress",submittedAt:"2021-10-08",cost:250,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Петров П. П."],createdAt:"2021-10-08",updatedAt:"2021-10-10"},{id:"egrn-extract-3",serviceType:"extract",objectName:"Офисное помещение",address:"ул. Тверская, д. 15, офис 301",cadastralNumber:"77:01:0002003:3003",reference:"REF-2021-103",contractNumber:"ДЗ-2021-103",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_rights",extractPurpose:"Проверка прав собственности",status:"completed",submittedAt:"2021-10-01",completedAt:"2021-10-08",resultNumber:"ВП-2021-001567",resultDate:"2021-10-08",cost:400,employeeName:"Филиппова В. П.",participants:["Филиппова В. П."],createdAt:"2021-10-01",updatedAt:"2021-10-08"},{id:"egrn-extract-4",serviceType:"extract",objectName:"Квартира",address:"пр-т Мира, д. 20, кв. 45",cadastralNumber:"77:01:0002004:4004",reference:"REF-2021-104",contractNumber:"ДЗ-2021-104",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"short",extractPurpose:"Краткая информация об объекте",status:"submitted",submittedAt:"2021-10-12",cost:200,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Сидоров С. С."],createdAt:"2021-10-12",updatedAt:"2021-10-12"},{id:"egrn-extract-5",serviceType:"extract",objectName:"Торговое помещение",address:"ул. Арбат, д. 30, помещение 15",cadastralNumber:"77:01:0002005:5005",reference:"REF-2021-105",contractNumber:"ДЗ-2021-105",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Полная выписка для сделки",status:"in_progress",submittedAt:"2021-10-10",cost:400,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Коваленко С. Е."],createdAt:"2021-10-10",updatedAt:"2021-10-11"},{id:"egrn-extract-6",serviceType:"extract",objectName:"Квартира",address:"ул. Садовая, д. 8, кв. 12",cadastralNumber:"77:01:0002006:6006",reference:"REF-2021-106",contractNumber:"ДЗ-2021-106",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка характеристик объекта",status:"completed",submittedAt:"2021-09-28",completedAt:"2021-10-05",resultNumber:"ВП-2021-001890",resultDate:"2021-10-05",cost:250,employeeName:"Филиппова В. П.",participants:["Филиппова В. П.","Кузнецов К. К."],createdAt:"2021-09-28",updatedAt:"2021-10-05"},{id:"egrn-extract-7",serviceType:"extract",objectName:"Складское помещение",address:"ул. Промышленная, д. 25, склад 3",cadastralNumber:"77:01:0002007:7007",reference:"REF-2021-107",contractNumber:"ДЗ-2021-107",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_rights",extractPurpose:"Проверка обременений",status:"draft",cost:400,employeeName:"Фокина С. А.",participants:["Фокина С. А."],createdAt:"2021-10-13",updatedAt:"2021-10-13"},{id:"egrn-extract-8",serviceType:"extract",objectName:"Квартира",address:"ул. Невский проспект, д. 50, кв. 78",cadastralNumber:"77:01:0002008:8008",reference:"REF-2021-108",contractNumber:"ДЗ-2021-108",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"full",extractPurpose:"Для оформления ипотеки",status:"completed",submittedAt:"2021-09-25",completedAt:"2021-10-02",resultNumber:"ВП-2021-002123",resultDate:"2021-10-02",cost:400,employeeName:"Хорошенько И. Г.",participants:["Хорошенько И. Г.","Смирнов С. С.","Иванов И. И."],createdAt:"2021-09-25",updatedAt:"2021-10-02"},{id:"egrn-extract-9",serviceType:"extract",objectName:"Офисное помещение",address:"ул. Красная площадь, д. 1, офис 100",cadastralNumber:"77:01:0002009:9009",reference:"REF-2021-109",contractNumber:"ДЗ-2021-109",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"short",extractPurpose:"Быстрая проверка объекта",status:"in_progress",submittedAt:"2021-10-11",cost:200,employeeName:"Филиппова В. П.",participants:["Филиппова В. П.","Петров П. П."],createdAt:"2021-10-11",updatedAt:"2021-10-12"},{id:"egrn-extract-10",serviceType:"extract",objectName:"Квартира",address:"ул. Гагарина, д. 12, кв. 33",cadastralNumber:"77:01:0002010:1010",reference:"REF-2021-110",contractNumber:"ДЗ-2021-110",applicantName:'ООО "Банк"',applicantInn:"7701234567",applicantType:"legal",extractType:"about_object",extractPurpose:"Проверка кадастровой стоимости",status:"submitted",submittedAt:"2021-10-13",cost:250,employeeName:"Фокина С. А.",participants:["Фокина С. А.","Коваленко С. Е."],createdAt:"2021-10-13",updatedAt:"2021-10-13"}],cV=()=>{try{const e=localStorage.getItem("egrnRequests");if(!e||JSON.parse(e).length===0){const t=RE();localStorage.setItem("egrnRequests",JSON.stringify(t)),console.log("✅ Демо-данные ЕГРН загружены")}else{const t=JSON.parse(e);if(!t.some(a=>a.serviceType==="extract")){const n=RE().filter(o=>o.serviceType==="extract"),s=[...t,...n];localStorage.setItem("egrnRequests",JSON.stringify(s)),console.log("✅ Демо-данные выписок ЕГРН добавлены")}}}catch(e){console.error("Ошибка загрузки демо-данных ЕГРН:",e)}},{Title:lV,Text:Ic}=mt,{Option:nn}=Ye,{TextArea:O1}=Re,dV=()=>{const e=uc(),[t]=ne.useForm(),[r,a]=K.useState("mortgage_registration"),[n,s]=K.useState([]),[o]=K.useState(!1),[A,c]=K.useState(""),[l,d]=K.useState(null),[f,p]=K.useState(null),[u,g]=K.useState(!1),[h,y]=K.useState(!1),x=K.useCallback((G,b,k)=>{p(null),t.resetFields(),t.setFieldsValue({serviceType:"extract",objectId:G,cadastralNumber:b,objectName:k,extractType:"about_object",applicantType:"legal",status:"draft"}),a("extract"),y(!0)},[t]);K.useEffect(()=>{(()=>{try{cV();const b=localStorage.getItem("egrnRequests");if(b){const k=JSON.parse(b);s(k.map((j,q)=>({...j,key:j.id||`egrn-${q}`})))}}catch(b){console.error("Ошибка загрузки данных ЕГРН:",b)}})()},[]),K.useEffect(()=>{const G=new URLSearchParams(e.search),b=G.get("objectId"),k=G.get("cadastralNumber"),j=G.get("objectName");b&&k&&(x(b,k,j||""),window.history.replaceState({},"",e.pathname))},[e.search,e.pathname,x]);const v=G=>{try{localStorage.setItem("egrnRequests",JSON.stringify(G)),s(G.map((b,k)=>({...b,key:b.id||`egrn-${k}`})))}catch(b){console.error("Ошибка сохранения данных ЕГРН:",b),Ne.error("Ошибка сохранения данных")}},E=K.useMemo(()=>{const G=A.trim().toLowerCase();return n.filter(b=>{var Y,de,ue;const k=b.serviceType===r,j=!G||((Y=b.objectName)==null?void 0:Y.toLowerCase().includes(G))||String(b.reference||"").toLowerCase().includes(G)||((de=b.contractNumber)==null?void 0:de.toLowerCase().includes(G))||((ue=b.cadastralNumber)==null?void 0:ue.toLowerCase().includes(G)),q=!l||b.status===l;return k&&j&&q})},[n,r,A,l]),D=K.useMemo(()=>{const G=n.filter(q=>q.serviceType===r),b=G.filter(q=>q.status==="completed").length,k=G.filter(q=>q.status==="in_progress").length,j=G.filter(q=>q.status==="submitted").length;return{total:G.length,completed:b,inProgress:k,submitted:j}},[n,r]),B=()=>{p(null),t.resetFields(),t.setFieldsValue({serviceType:r,applicantType:"legal",status:"draft"}),y(!0)},I=G=>{p(G),t.setFieldsValue({...G,mortgageContractDate:G.mortgageContractDate?We(G.mortgageContractDate):null,encumbranceDate:G.encumbranceDate?We(G.encumbranceDate):null,submittedAt:G.submittedAt?We(G.submittedAt):null,completedAt:G.completedAt?We(G.completedAt):null,resultDate:G.resultDate?We(G.resultDate):null}),y(!0)},_=G=>{p(G),g(!0)},S=async G=>{try{const b={id:(f==null?void 0:f.id)||`egrn-${Date.now()}`,serviceType:r,objectId:G.objectId,reference:G.reference,contractNumber:G.contractNumber,objectName:G.objectName,cadastralNumber:G.cadastralNumber,address:G.address,applicantName:G.applicantName,applicantInn:G.applicantInn,applicantType:G.applicantType,mortgageContractNumber:G.mortgageContractNumber,mortgageContractDate:G.mortgageContractDate?G.mortgageContractDate.format("YYYY-MM-DD"):void 0,mortgageAmount:G.mortgageAmount,mortgageTerm:G.mortgageTerm,encumbranceType:G.encumbranceType,encumbranceNumber:G.encumbranceNumber,encumbranceDate:G.encumbranceDate?G.encumbranceDate.format("YYYY-MM-DD"):void 0,removalReason:G.removalReason,extractType:G.extractType,extractPurpose:G.extractPurpose,status:G.status||"draft",submittedAt:G.submittedAt?G.submittedAt.format("YYYY-MM-DD"):void 0,completedAt:G.completedAt?G.completedAt.format("YYYY-MM-DD"):void 0,resultDocument:G.resultDocument,resultNumber:G.resultNumber,resultDate:G.resultDate?G.resultDate.format("YYYY-MM-DD"):void 0,comments:G.comments,rejectionReason:G.rejectionReason,createdAt:(f==null?void 0:f.createdAt)||We().format("YYYY-MM-DD"),updatedAt:We().format("YYYY-MM-DD")},k=f?n.map(j=>j.id===f.id?b:j):[...n,b];v(k),Ne.success(f?"Запрос обновлен":"Запрос создан"),y(!1),t.resetFields()}catch(b){console.error("Ошибка сохранения:",b),Ne.error("Ошибка сохранения запроса")}},O=G=>{switch(G){case"completed":return"green";case"in_progress":return"blue";case"submitted":return"orange";case"rejected":return"red";case"draft":return"default";default:return"default"}},M=G=>{switch(G){case"completed":return i.jsx(On,{});case"rejected":return i.jsx(ZA,{});default:return i.jsx(zn,{})}},T=G=>({draft:"Черновик",submitted:"Подано",in_progress:"В работе",completed:"Завершено",rejected:"Отклонено"})[G],R=G=>{switch(G){case"mortgage_registration":return"Регистрация ДДУ";case"encumbrance_removal":return"Прекращение обременения";case"extract":return"Выписки ЕГРН";default:return G}},L=(G,b)=>G==="in_progress"?b==="mortgage_registration"?"В Росреестре":b==="encumbrance_removal"?"Подписание заявлений":b==="extract"?"В обработке":"Обрабатывается":G==="submitted"?b==="extract"?"Запрос отправлен":"Отправляем в Росреестр":G==="completed"?b==="extract"?"Выписка получена":"Сделка зарегистрирована":G==="rejected"?"Регистрация приостановлена":G==="draft"?"Черновик":"",N=(G,b)=>G==="in_progress"?b==="extract"?"Ожидание ответа":"Обрабатывается":G==="submitted"?b==="extract"?"Ожидание обработки":"":G==="rejected"?"Регистрация приостановлена":"",[P,U]=K.useState({}),V=G=>{U(b=>({...b,[G]:!b[G]}))},ie=[{title:"Отправлено",dataIndex:"submittedAt",key:"submittedAt",width:120,render:G=>G?We(G).format("DD.MM.YYYY"):"—"},{title:"Адрес объекта",key:"address",width:300,render:(G,b)=>i.jsxs(Fe,{direction:"vertical",size:0,children:[i.jsx(Ic,{children:b.address||"—"}),i.jsx(Ic,{type:"secondary",style:{fontSize:"12px"},children:R(b.serviceType)})]})},{title:"Статус",dataIndex:"status",key:"status",width:250,render:(G,b)=>{const k=L(G,b.serviceType),j=N(G),q=O(G);return i.jsxs(Fe,{direction:"vertical",size:0,children:[i.jsxs(Fe,{children:[i.jsx("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:q==="green"?"#52c41a":q==="orange"?"#fa8c16":q==="blue"?"#1890ff":q==="red"?"#ff4d4f":"#d9d9d9",display:"inline-block"}}),i.jsx(Ic,{children:k||T(G)})]}),j&&i.jsx(Ic,{type:"secondary",style:{fontSize:"12px",marginLeft:16},children:N(G,b.serviceType)}),G==="in_progress"&&b.serviceType==="encumbrance_removal"&&i.jsx(Ic,{type:"secondary",style:{fontSize:"12px",marginLeft:16},children:"Требуется подпись"})]})}},{title:"Сотрудник",dataIndex:"employeeName",key:"employeeName",width:180,render:G=>G||"—"},{title:"Участники",key:"participants",width:250,render:(G,b)=>{const k=b.participants||[],q=P[b.id]?k.length:2,Y=k.slice(0,q),de=k.length-q;return k.length===0?i.jsx(Ic,{type:"secondary",children:"—"}):i.jsxs(Fe,{direction:"vertical",size:0,children:[Y.map((ue,pe)=>i.jsx(Ic,{children:ue},pe)),de>0&&i.jsxs(Be,{type:"link",size:"small",style:{padding:0,height:"auto",fontSize:"12px"},onClick:()=>V(b.id),children:["ещё ",de]})]})}},{title:"Действия",key:"actions",width:100,fixed:"right",render:(G,b)=>i.jsx(Xr,{title:"Просмотр",children:i.jsx(Be,{type:"link",icon:i.jsx(Ss,{}),onClick:()=>_(b)})})}],W=[{key:"mortgage_registration",label:i.jsxs(Fe,{children:[i.jsx(ph,{}),"Регистрация ипотеки"]})},{key:"encumbrance_removal",label:i.jsxs(Fe,{children:[i.jsx(wv,{}),"Снятие обременений"]})},{key:"extract",label:i.jsxs(Fe,{children:[i.jsx(Zu,{}),"Выписки ЕГРН"]})}],z=()=>r==="mortgage_registration"?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"mortgageContractNumber",label:"Номер договора ипотеки",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Номер договора"})}),i.jsx(ne.Item,{name:"mortgageContractDate",label:"Дата договора ипотеки",rules:[{required:!0}],children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"mortgageAmount",label:"Сумма ипотеки, руб.",children:i.jsx(Re,{type:"number",placeholder:"Сумма"})}),i.jsx(ne.Item,{name:"mortgageTerm",label:"Срок ипотеки",children:i.jsx(Re,{placeholder:"Срок"})})]}):r==="encumbrance_removal"?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"encumbranceType",label:"Тип обременения",rules:[{required:!0}],children:i.jsxs(Ye,{placeholder:"Выберите тип",children:[i.jsx(nn,{value:"ипотека",children:"Ипотека"}),i.jsx(nn,{value:"аренда",children:"Аренда"}),i.jsx(nn,{value:"залог",children:"Залог"}),i.jsx(nn,{value:"сервитут",children:"Сервитут"}),i.jsx(nn,{value:"другое",children:"Другое"})]})}),i.jsx(ne.Item,{name:"encumbranceNumber",label:"Номер обременения",children:i.jsx(Re,{placeholder:"Номер"})}),i.jsx(ne.Item,{name:"encumbranceDate",label:"Дата регистрации обременения",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"removalReason",label:"Основание для снятия",rules:[{required:!0}],children:i.jsx(O1,{rows:3,placeholder:"Основание для снятия обременения"})})]}):r==="extract"?i.jsxs(i.Fragment,{children:[i.jsx(ne.Item,{name:"extractType",label:"Тип выписки",rules:[{required:!0}],children:i.jsxs(Ye,{placeholder:"Выберите тип",children:[i.jsx(nn,{value:"full",children:"Полная выписка"}),i.jsx(nn,{value:"short",children:"Краткая выписка"}),i.jsx(nn,{value:"about_object",children:"Выписка об объекте"}),i.jsx(nn,{value:"about_rights",children:"Выписка о правах"})]})}),i.jsx(ne.Item,{name:"extractPurpose",label:"Цель получения выписки",children:i.jsx(O1,{rows:2,placeholder:"Цель получения выписки"})})]}):null;return i.jsxs("div",{className:"egrn-page",children:[i.jsxs("div",{className:"egrn-page__header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[i.jsx(lV,{level:2,style:{margin:0},children:"Сделки"}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:B,style:{backgroundColor:"#722ed1",borderColor:"#722ed1"},children:"+ Создать сделку"})]}),i.jsx(Ge,{children:i.jsx(Ts,{activeKey:r,onChange:G=>{a(G),d(null),c("")},items:W})}),i.jsxs(ft,{gutter:[16,16],className:"egrn-page__stats",children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего запросов",value:D.total})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Подано",value:D.submitted,valueStyle:{color:"#fa8c16"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"В работе",value:D.inProgress,valueStyle:{color:"#1890ff"}})})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Завершено",value:D.completed,valueStyle:{color:"#3f8600"}})})})]}),i.jsx(Ge,{children:i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsx(Re,{allowClear:!0,placeholder:"Поиск по объекту, REFERENCE, договору, кадастровому номеру",prefix:i.jsx(Pa,{}),value:A,onChange:G=>c(G.target.value),style:{width:"100%"}}),i.jsxs(Ye,{allowClear:!0,placeholder:"Статус",style:{width:150},value:l??void 0,onChange:G=>d(G??null),children:[i.jsx(nn,{value:"draft",children:"Черновик"}),i.jsx(nn,{value:"submitted",children:"Подано"}),i.jsx(nn,{value:"in_progress",children:"В работе"}),i.jsx(nn,{value:"completed",children:"Завершено"}),i.jsx(nn,{value:"rejected",children:"Отклонено"})]})]})}),i.jsx(Ge,{bodyStyle:{padding:0},children:i.jsx(nr,{columns:ie,dataSource:E,pagination:{pageSize:15,showSizeChanger:!0},scroll:{x:1200},loading:o,locale:{emptyText:i.jsx(Br,{description:"Нет регистраций"})},rowClassName:()=>"egrn-table-row",onRow:G=>({onClick:()=>_(G)})})}),i.jsx(dr,{title:i.jsxs(Fe,{children:[(f==null?void 0:f.serviceType)==="extract"?i.jsx(Zu,{}):(f==null?void 0:f.serviceType)==="encumbrance_removal"?i.jsx(wv,{}):i.jsx(ph,{}),i.jsx("span",{children:f?R(f.serviceType):"Детали запроса"}),f&&i.jsx(at,{color:O(f.status),children:T(f.status)})]}),open:u,onCancel:()=>g(!1),footer:[i.jsx(Be,{icon:i.jsx(Ri,{}),onClick:()=>{f&&(I(f),g(!1))},children:"Редактировать"},"edit"),i.jsx(Be,{onClick:()=>g(!1),children:"Закрыть"},"close")],width:800,children:f&&i.jsxs(we,{bordered:!0,column:2,size:"small",children:[i.jsx(we.Item,{label:"Тип услуги",span:2,children:R(f.serviceType)}),i.jsx(we.Item,{label:"Объект",span:2,children:f.objectName||"—"}),i.jsx(we.Item,{label:"Адрес",span:2,children:f.address||"—"}),i.jsx(we.Item,{label:"Кадастровый номер",children:f.cadastralNumber||"—"}),i.jsx(we.Item,{label:"REFERENCE",children:f.reference||"—"}),i.jsx(we.Item,{label:"Номер договора залога",children:f.contractNumber||"—"}),i.jsx(we.Item,{label:"Дата отправки",children:f.submittedAt?We(f.submittedAt).format("DD.MM.YYYY"):"—"}),i.jsx(we.Item,{label:"Сотрудник",children:f.employeeName||"—"}),i.jsx(we.Item,{label:"Участники",span:2,children:f.participants&&f.participants.length>0?f.participants.join(", "):"—"}),i.jsx(we.Item,{label:"Заявитель",span:2,children:f.applicantName||"—"}),i.jsx(we.Item,{label:"ИНН заявителя",children:f.applicantInn||"—"}),i.jsx(we.Item,{label:"Статус",children:i.jsx(at,{color:O(f.status),icon:M(f.status),children:T(f.status)})}),f.serviceType==="mortgage_registration"&&i.jsxs(i.Fragment,{children:[i.jsx(we.Item,{label:"Номер договора ипотеки",children:f.mortgageContractNumber||"—"}),i.jsx(we.Item,{label:"Дата договора",children:f.mortgageContractDate?We(f.mortgageContractDate).format("DD.MM.YYYY"):"—"}),i.jsx(we.Item,{label:"Сумма ипотеки",children:f.mortgageAmount?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(f.mortgageAmount):"—"}),i.jsx(we.Item,{label:"Срок ипотеки",children:f.mortgageTerm||"—"})]}),f.serviceType==="encumbrance_removal"&&i.jsxs(i.Fragment,{children:[i.jsx(we.Item,{label:"Тип обременения",children:f.encumbranceType||"—"}),i.jsx(we.Item,{label:"Номер обременения",children:f.encumbranceNumber||"—"}),i.jsx(we.Item,{label:"Дата регистрации",children:f.encumbranceDate?We(f.encumbranceDate).format("DD.MM.YYYY"):"—"}),i.jsx(we.Item,{label:"Основание для снятия",span:2,children:f.removalReason||"—"})]}),f.serviceType==="extract"&&i.jsxs(i.Fragment,{children:[i.jsx(we.Item,{label:"Тип выписки",children:f.extractType==="full"?"Полная выписка":f.extractType==="short"?"Краткая выписка":f.extractType==="about_object"?"Выписка об объекте":f.extractType==="about_rights"?"Выписка о правах":"—"}),i.jsx(we.Item,{label:"Цель получения",children:f.extractPurpose||"—"}),f.cost&&i.jsx(we.Item,{label:"Стоимость",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(f.cost)}),f.completedAt&&i.jsx(we.Item,{label:"Дата получения",children:We(f.completedAt).format("DD.MM.YYYY")})]}),f.resultNumber&&i.jsx(we.Item,{label:f.serviceType==="extract"?"Номер выписки":"Номер результата",children:f.resultNumber}),f.resultDate&&i.jsx(we.Item,{label:f.serviceType==="extract"?"Дата выписки":"Дата результата",children:We(f.resultDate).format("DD.MM.YYYY")}),f.resultDocument&&i.jsx(we.Item,{label:"Документ",span:2,children:i.jsx(Be,{type:"link",icon:i.jsx(Zu,{}),onClick:()=>{Ne.info("Скачивание документа...")},children:"Скачать документ"})}),f.comments&&i.jsx(we.Item,{label:"Комментарии",span:2,children:f.comments})]})}),i.jsx(f2,{title:f?"Редактировать запрос":`Создать запрос: ${R(r)}`,open:h,onClose:()=>{y(!1),t.resetFields()},width:600,children:i.jsxs(ne,{form:t,layout:"vertical",onFinish:S,initialValues:{serviceType:r,applicantType:"legal",status:"draft"},children:[i.jsx(ne.Item,{name:"serviceType",hidden:!0,children:i.jsx(Re,{})}),i.jsx(ne.Item,{name:"objectName",label:"Наименование объекта",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Наименование объекта"})}),i.jsx(ne.Item,{name:"cadastralNumber",label:"Кадастровый номер",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"23:49:0303008:1915"})}),i.jsx(ne.Item,{name:"address",label:"Адрес",children:i.jsx(Re,{placeholder:"Адрес объекта"})}),i.jsx(ne.Item,{name:"reference",label:"REFERENCE",children:i.jsx(Re,{placeholder:"REFERENCE сделки"})}),i.jsx(ne.Item,{name:"contractNumber",label:"Номер договора залога",children:i.jsx(Re,{placeholder:"Номер договора"})}),i.jsx(ne.Item,{name:"applicantType",label:"Тип заявителя",children:i.jsxs(Ho.Group,{children:[i.jsx(Ho,{value:"legal",children:"Юридическое лицо"}),i.jsx(Ho,{value:"individual",children:"Физическое лицо"})]})}),i.jsx(ne.Item,{name:"applicantName",label:"Наименование заявителя",rules:[{required:!0}],children:i.jsx(Re,{placeholder:"Наименование"})}),i.jsx(ne.Item,{name:"applicantInn",label:"ИНН заявителя",children:i.jsx(Re,{placeholder:"ИНН"})}),z(),i.jsx(ne.Item,{name:"status",label:"Статус",children:i.jsxs(Ye,{children:[i.jsx(nn,{value:"draft",children:"Черновик"}),i.jsx(nn,{value:"submitted",children:"Подано"}),i.jsx(nn,{value:"in_progress",children:"В работе"}),i.jsx(nn,{value:"completed",children:"Завершено"}),i.jsx(nn,{value:"rejected",children:"Отклонено"})]})}),i.jsx(ne.Item,{name:"submittedAt",label:"Дата подачи",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"completedAt",label:"Дата завершения",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"resultNumber",label:"Номер результата",children:i.jsx(Re,{placeholder:"Номер выписки/регистрации"})}),i.jsx(ne.Item,{name:"resultDate",label:"Дата результата",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})}),i.jsx(ne.Item,{name:"comments",label:"Комментарии",children:i.jsx(O1,{rows:3,placeholder:"Комментарии"})}),i.jsx(ne.Item,{children:i.jsxs(Fe,{children:[i.jsx(Be,{type:"primary",htmlType:"submit",children:f?"Сохранить":"Создать"}),i.jsx(Be,{onClick:()=>{y(!1),t.resetFields()},children:"Отмена"})]})})]})})]})},Qc={"Подготовка СЗ":6,"Подготовка СЗ (2 объекта)":7,"Подготовка СЗ (АЗС)":24,Оценка:8,Экспертиза:6,Рецензия:4,ПРКК:4,Мониторинг:2,Осмотр:3,"Проверка документов":2,Согласование:2,"Контроль качества":3,Отчетность:4,Прочее:2},c2=8,nS=22,XA=c2*nS;function uV(e){const t=e.type||"Прочее";let r=null;try{const a=localStorage.getItem("normHoursSettings");a&&(r=JSON.parse(a))}catch{}if(t==="Подготовка СЗ"){const a=(e.title||"").toLowerCase(),n=(e.description||"").toLowerCase();return a.includes("азс")||n.includes("азс")?(r==null?void 0:r["Подготовка СЗ (АЗС)"])||Qc["Подготовка СЗ (АЗС)"]:(r==null?void 0:r["Подготовка СЗ"])||Qc["Подготовка СЗ"]}return(r==null?void 0:r[t])||Qc[t]||Qc.Прочее}function jy(e){return e.reduce((t,r)=>t+uV(r),0)}function Ly(e,t=XA){const a=jy(e)/t*100;return Math.min(Math.round(a*10)/10,150)}function I1(e,t,r,a=XA){const n=e.filter(A=>{const c=(A.status||"").toString();if(c==="completed"||c==="Выполнено"||c==="done"||c==="approved"||c==="created"||!["assigned","in_progress","in-progress","review","rework","paused","approval"].includes(c))return!1;const f=We(A.createdAt||A.updatedAt);return f.isAfter(t.subtract(1,"day"))&&f.isBefore(r.add(1,"day"))}),s=jy(n),o=Ly(n,a);return{totalNormHours:s,workloadPercent:o,tasksCount:n.length}}function iS(e,t,r,a){const n=t.filter(u=>u.isActive&&u.status!=="sick_leave"&&u.status!=="vacation"&&u.status!=="business_trip"&&(!u.status||u.status==="working")),s=e.filter(u=>{const g=(u.region||"").toString();return a.includes(g)||g===r}),o=new Set(n.map(u=>u.email).filter(Boolean)),A=s.filter(u=>{const g=(u.status||"").toString();return g==="completed"||g==="Выполнено"||g==="done"||g==="approved"||g==="created"||!(u.currentAssignee&&o.has(u.currentAssignee)||Array.isArray(u.assignedTo)&&u.assignedTo.some(x=>o.has(x))||u.employeeId&&n.some(x=>x.id===u.employeeId))?!1:["assigned","in_progress","in-progress","review","rework","paused","approval"].includes(g)}),c=jy(A),l=n.length;if(l===0)return{totalNormHours:0,workloadPercent:0,tasksCount:0,workingEmployeesCount:0};const f=c/l/XA*100;let p=Math.round(f*10)/10;return A.length===0||p<85?p=85:p>125&&(p=125),{totalNormHours:c,workloadPercent:p,tasksCount:A.length,workingEmployeesCount:l}}const Uy="kpiMetricsOverrides",sS="kpiMetricsLatest",My="kpiCenterMboOverrides",l2={totalPortfolioValue:0,totalContracts:0,activeContracts:0,completedTasks:0,pendingTasks:0,overdueTasks:0,totalConclusions:0,approvedConclusions:0,pendingConclusions:0,totalObjects:0,totalInsurance:0,activeInsurance:0,averageConclusionDays:0,slaCompliance:0,currentWorkload:0,mboCompletionOverall:0,workloadByPeriod:{last7Days:0,last30Days:0,last90Days:0}},em=(e=l2)=>({...e,workloadByPeriod:{...e.workloadByPeriod}}),oS=()=>{try{const e=localStorage.getItem(Uy);return e?JSON.parse(e):null}catch(e){return console.warn("Не удалось загрузить корректировки KPI:",e),null}},fV=e=>{try{localStorage.setItem(Uy,JSON.stringify(e))}catch(t){console.error("Не удалось сохранить корректировки KPI:",t)}},pV=()=>{try{localStorage.removeItem(Uy)}catch(e){console.warn("Не удалось удалить корректировки KPI:",e)}},AS=()=>{try{const e=localStorage.getItem(My);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch(e){return console.warn("Не удалось загрузить корректировки MBO по центрам:",e),{}}},hV=e=>{try{localStorage.setItem(My,JSON.stringify(e))}catch(t){console.error("Не удалось сохранить корректировки MBO по центрам:",t)}},mV=()=>{try{localStorage.removeItem(My)}catch(e){console.warn("Не удалось удалить корректировки MBO по центрам:",e)}},gV=()=>{try{const e=localStorage.getItem(sS);if(!e)return null;const t=JSON.parse(e);return!t||typeof t!="object"?null:{...em(l2),...t,workloadByPeriod:{...l2.workloadByPeriod,...t.workloadByPeriod||{}}}}catch(e){return console.warn("Не удалось загрузить последние метрики KPI:",e),null}},xV=e=>{try{localStorage.setItem(sS,JSON.stringify(e))}catch(t){console.warn("Не удалось сохранить последние метрики KPI:",t)}},cS=(e,t=oS())=>t?{...e,...t,workloadByPeriod:{...e.workloadByPeriod,...t.workloadByPeriod||{}}}:e,{Title:dd,Text:cr}=mt,{RangePicker:yV}=Rr,lS=[{key:"month",label:"Работник месяца",days:30,icon:i.jsx(kT,{style:{color:"#faad14"}}),color:"#faad14"},{key:"quarter",label:"Работник квартала",days:90,icon:i.jsx(ef,{style:{color:"#1677ff"}}),color:"#1677ff"},{key:"year",label:"Работник года",days:365,icon:i.jsx(DT,{style:{color:"#722ed1"}}),color:"#722ed1"}],jd=e=>`${e.lastName} ${e.firstName} ${e.middleName||""}`.trim(),vV=(e,t)=>(e||t||"Москва").trim(),Py=(e,t)=>{if(!e.isValid()||!t.isValid())return 0;let r=0,a=e.clone();for(;a.isBefore(t)||a.isSame(t,"day");){const n=a.day();n!==0&&n!==6&&r++,a=a.add(1,"day")}return r},Zo=e=>{const t=(e||"").toString();return t==="completed"||t==="Выполнено"||t==="done"||t==="approved"},Qy=e=>{const t=(e||"").toString();return["pending","created","assigned","in_progress","in-progress","review","approval","rework","paused"].includes(t)},Ld=e=>{const t=(e.status||"").toString();if(!Qy(t))return!1;if(!e.dueDate)return!0;const r=We(e.dueDate);return r.isAfter(We(),"day")||r.isSame(We(),"day")},Ud=e=>{const t=(e.status||"").toString();return Zo(t)||!e.dueDate?!1:We(e.dueDate).isBefore(We(),"day")},qc=e=>Number.isFinite(e)?Math.max(85,Math.min(125,Math.round(e*10)/10)):85,N1=e=>{const t=Math.random()*10-5;return qc(e+t)},kE=e=>{if(!e)return We();const t=We(e,["DD.MM.YYYY","YYYY-MM-DD"],!0);return t.isValid()?t:We(e)},DE=(e,t,r)=>e.map((a,n)=>{var E;const s=kE(a.plannedDate),o=s.isValid()?s:We().add(7,"day"),A=kE("lastMonitoringDate"in a?a.lastMonitoringDate:a.lastRevaluationDate).subtract(5,"day"),l=a.timeframe==="overdue"?"in_progress":a.timeframe==="week"?"assigned":a.timeframe==="month"?"approval":"assigned",d=a.timeframe==="overdue"||a.timeframe==="week"?"high":a.timeframe==="month"?"medium":"low",f=(E=a.owner)==null?void 0:E.trim(),p=f?r.find(D=>jd(D).toLowerCase()===f.toLowerCase()):void 0,u=p!=null&&p.email?[p.email]:[],g=t==="monitoring"?"monitoring@cmsauto.ru":"revaluation@cmsauto.ru",h=t==="monitoring"?"План мониторинга":"План переоценок",y=t==="monitoring"?"Мониторинг":"Оценка",x=t==="monitoring"?"План мониторинга":"План переоценок",v=vV(a.city,a.regionCenterName||a.regionCenterCode||void 0);return{id:`PLAN-${t}-${a.reference||"ref"}-${n}-${Math.random().toString(36).slice(2,7)}`,region:v,type:y,title:`${t==="monitoring"?"Мониторинг":"Переоценка"} ${a.reference||""}`.trim(),description:t==="monitoring"?`Плановый мониторинг обеспечения (${a.baseType})`:`Плановая переоценка обеспечения (${a.baseType})`,priority:d,dueDate:o.format("YYYY-MM-DD"),status:l,businessUser:g,businessUserName:h,assignedTo:u,currentAssignee:(p==null?void 0:p.email)||null,currentAssigneeName:p?jd(p):a.owner||null,employeeId:p==null?void 0:p.id,documents:[],comments:[],createdAt:A.format("YYYY-MM-DD"),updatedAt:We().toISOString(),history:[{date:A.toISOString(),user:h,userRole:"system",action:"Создана плановая задача",status:"created"},{date:o.toISOString(),user:p?jd(p):a.owner||h,userRole:"employee",action:"Назначена в план работ",status:l}],category:x}}),wV=(e,t,r)=>Wi.map(a=>{const n=e.filter(u=>a.cities.includes(u.region)||u.region===a.code||a.name.includes(u.region)),s=a.cities.map(u=>{const g=n.filter(I=>I.region===u),y=t.filter(I=>I.region===u).map(I=>{const _=g.filter(L=>L.employeeId===I.id||L.currentAssigneeName===jd(I)),S=_.filter(L=>Zo(L.status)).length,O=_.filter(L=>Ld(L)).length,M=_.filter(L=>Ud(L)).length,T=_.length,R=T>0?Math.round(S/T*100):0;return{employeeId:I.id,totalTasks:T,completedTasks:S,inProgressTasks:O,overdueTasks:M,completionRate:R}}),x=g.length,v=g.filter(I=>Zo(I.status)).length,E=g.filter(I=>Ld(I)).length,D=g.filter(I=>Ud(I)).length,B=x>0?Math.round(v/x*100):0;return{city:u,totalTasks:x,completedTasks:v,inProgressTasks:E,overdueTasks:D,completionRate:B,employees:y}}),o=n.length,A=n.filter(u=>Zo(u.status)).length,c=n.filter(u=>Ld(u)).length,l=n.filter(u=>Ud(u)).length,d=o>0?Math.round(A/o*100):0,f=o>0?Math.round(A/o*100):0,p=typeof r[a.code]=="number"?r[a.code]:f;return{code:a.code,name:a.name,totalTasks:o,completedTasks:A,inProgressTasks:c,overdueTasks:l,completionRate:d,mboCompletion:p,cities:s}}),EV=(e,t)=>{const r={month:null,quarter:null,year:null},a=We();return lS.forEach(n=>{const s=a.subtract(n.days,"day"),o=e.filter(l=>We(l.createdAt||l.updatedAt).isAfter(s)),A=t.filter(l=>l.isActive&&(!l.status||l.status==="working")).map(l=>{const d=jd(l),f=o.filter(x=>x.employeeId===l.id||x.currentAssigneeName===d);if(f.length===0)return null;const p=f.filter(x=>Qy(x.status)),u=Ly(p),g=f.filter(x=>Zo(x.status)&&x.completedAt&&x.createdAt);if(g.length===0)return null;const h=g.map(x=>Py(We(x.createdAt),We(x.completedAt))),y=h.length>0?Math.round(h.filter(x=>x<=7).length/h.length*100):0;return{employee:l,name:d,region:l.region,workload:qc(u),slaSuccess:Math.min(y,100),completedCount:g.length}}).filter(Boolean);if(A.length===0){r[n.key]=null;return}A.sort((l,d)=>d.workload!==l.workload?d.workload-l.workload:d.slaSuccess!==l.slaSuccess?d.slaSuccess-l.slaSuccess:d.completedCount-l.completedCount);const c=A[0];r[n.key]={title:n.label,employeeName:c.name,region:c.region,workload:c.workload,slaSuccess:c.slaSuccess}}),r},_V=(e,t)=>!e.length||!t.length?[]:t.filter(a=>a.isActive&&(!a.status||a.status==="working")).map(a=>{const n=jd(a),s=e.filter(g=>g.employeeId===a.id||g.currentAssigneeName===n||a.email&&(g.currentAssignee===a.email||Array.isArray(g.assignedTo)&&g.assignedTo.includes(a.email)));if(s.length===0)return null;const o=s.filter(g=>{const h=(g.status||"").toString();return!(!Qy(h)||h==="created")}),A=qc(Ly(o)),c=s.filter(g=>Zo(g.status)).length,l=s.filter(g=>Ld(g)).length,d=s.filter(g=>Ud(g)).length,p=s.filter(g=>Zo(g.status)&&g.createdAt&&(g.completedAt||g.updatedAt)).map(g=>Py(We(g.createdAt),We(g.completedAt||g.updatedAt))),u=p.length>0?Math.round(p.filter(g=>g<=7).length/p.length*100):100;return{key:a.id,name:n,region:a.region,workload:A,slaSuccess:Math.min(u,100),completed:c,inProgress:l,overdue:d}}).filter(Boolean).sort((a,n)=>n.workload!==a.workload?n.workload-a.workload:n.slaSuccess!==a.slaSuccess?n.slaSuccess-a.slaSuccess:n.completed!==a.completed?n.completed-a.completed:a.overdue-n.overdue).slice(0,10),bV=()=>{var T;const[e,t]=K.useState(!0),[r,a]=K.useState(()=>em()),[n,s]=K.useState([We().subtract(30,"day"),We()]),[o,A]=K.useState("30days"),[c,l]=K.useState([]),[d,f]=K.useState(null),[p,u]=K.useState(null),[g,h]=K.useState(!1),[y,x]=K.useState([]),[v,E]=K.useState([]),[D,B]=K.useState({month:null,quarter:null,year:null});K.useEffect(()=>{(async()=>{t(!0);try{const[L,N,P]=await Promise.all([fetch("/portfolioData.json").then(vt=>vt.json()).catch(()=>[]),fetch("/collateralConclusionsData.json").then(vt=>vt.json()).catch(()=>[]),fetch("/insuranceData.json").then(vt=>vt.json()).catch(()=>[])]),U=await Yt.getExtendedCards(),V=rS(U),ie=aS(U);let W=[];try{W=await Yt.getTasks()}catch{try{const Tr=localStorage.getItem("zadachnik_tasks");Tr&&(W=JSON.parse(Tr))}catch(Tr){console.warn("Не удалось загрузить задачи:",Tr)}}let z=fr.getEmployees();(!z||z.length===0)&&(z=fr.getEmployees()),E(z);const G=z.filter(vt=>vt.isActive),k=G.length*60;if(!W||W.length===0||W.length<k)try{const{generateTasksForEmployees:vt}=await pi(async()=>{const{generateTasksForEmployees:Tr}=await Promise.resolve().then(()=>uS);return{generateTasksForEmployees:Tr}},void 0,import.meta.url);await vt(),W=await Yt.getTasks(),console.log(`✅ Сгенерировано ${W.length} задач для ${G.length} активных сотрудников`)}catch(vt){console.warn("Не удалось сгенерировать задачи:",vt)}const j=DE(V,"monitoring",z),q=DE(ie,"revaluation",z),Y=[...W,...j,...q];x(Y);const de=L.reduce((vt,Tr)=>vt+(parseFloat(Tr.collateralValue)||0),0),ue=L.length,pe=L.filter(vt=>vt.status==="active"||vt.status==="Активный").length,ye=Y.length,ve=Y.filter(vt=>Zo(vt.status)).length,ae=Y.filter(vt=>Ld(vt)).length,Ke=Y.filter(vt=>Ud(vt)).length,Ee=N.length,me=N.filter(vt=>vt.status==="Согласовано").length,le=N.filter(vt=>vt.status==="На согласовании"||vt.status==="Черновик").length,He=U.length,Ze=P.length,$e=P.filter(vt=>vt.status==="active"||vt.status==="Активный").length,et=N.filter(vt=>vt.status==="Согласовано"&&vt.authorDate&&(vt.approvalDate||vt.conclusionDate));let je=0,_e=0;if(et.length>0){const vt=[];if(et.forEach(Tr=>{const rr=We(Tr.authorDate),ln=We(Tr.approvalDate||Tr.conclusionDate);if(rr.isValid()&&ln.isValid()&&ln.isAfter(rr)){const kr=Py(rr,ln);vt.push(kr)}}),vt.length>0){je=Math.round(vt.reduce((rr,ln)=>rr+ln,0)/vt.length*10)/10;const Tr=vt.filter(rr=>rr<=7).length;_e=Math.round(Tr/vt.length*100)}}const lt=Wi.map(vt=>iS(Y,z,vt.code,vt.cities)),Ct=lt.length>0?lt.reduce((vt,Tr)=>vt+Tr.workloadPercent,0)/lt.length:85,bt=qc(Ct||85),Et=We(),Mt=I1(Y,Et.subtract(7,"day"),Et,XA),Dt=I1(Y,Et.subtract(30,"day"),Et,XA),Bt=I1(Y,Et.subtract(90,"day"),Et,XA),ut=Mt.tasksCount===0?N1(bt):qc(Mt.workloadPercent),ct=Dt.tasksCount===0?N1(bt):qc(Dt.workloadPercent),vr=Bt.tasksCount===0?N1(bt):qc(Bt.workloadPercent),Rt=AS();l(wV(Y,z,Rt)),B(EV(Y,z));const Gr={totalPortfolioValue:de,totalContracts:ue,activeContracts:pe,completedTasks:ve,pendingTasks:ae,overdueTasks:Ke,totalConclusions:Ee,approvedConclusions:me,pendingConclusions:le,totalObjects:He,totalInsurance:Ze,activeInsurance:$e,averageConclusionDays:je,slaCompliance:_e,currentWorkload:bt,mboCompletionOverall:ye>0?Math.round(ve/ye*100):0,workloadByPeriod:{last7Days:ut,last30Days:ct,last90Days:vr}};xV(Gr);const pr=cS(Gr);a(pr)}catch(L){console.error("Ошибка загрузки KPI данных:",L)}finally{t(!1)}})()},[n,o]);const I=Ma.useMemo(()=>{if(!y||y.length===0)return[];const R=new Map;return y.forEach(L=>{const N=L.category||"Без категории";R.has(N)||R.set(N,{total:0,completed:0,pending:0,overdue:0});const P=R.get(N);P.total+=1,Zo(L.status)?P.completed+=1:Ld(L)&&(P.pending+=1),Ud(L)&&(P.overdue+=1)}),Array.from(R.entries()).map(([L,N])=>({key:L,category:L,...N,completionRate:N.total>0?Math.round(N.completed/N.total*100):0}))},[y]),_=Ma.useMemo(()=>_V(y,v),[y,v]),S=[{title:"№",key:"rank",width:60,align:"center",render:(R,L,N)=>N+1},{title:"Сотрудник",dataIndex:"name",key:"name",render:(R,L)=>i.jsxs(Fe,{direction:"vertical",size:0,children:[i.jsx(cr,{strong:!0,children:R}),i.jsx(cr,{type:"secondary",style:{fontSize:11},children:L.region})]})},{title:"Загрузка",dataIndex:"workload",key:"workload",align:"center",render:R=>`${R}%`},{title:"SLA ≤ 7 дн.",dataIndex:"slaSuccess",key:"slaSuccess",align:"center",render:R=>`${R}%`},{title:"Выполнено",dataIndex:"completed",key:"completed",align:"center"},{title:"В работе",dataIndex:"inProgress",key:"inProgress",align:"center"},{title:"Просрочено",dataIndex:"overdue",key:"overdue",align:"center",render:R=>i.jsx(cr,{type:R>0?"danger":"success",children:R})}],O=[{title:"Категория",dataIndex:"category",key:"category"},{title:"Всего",dataIndex:"total",key:"total",align:"center"},{title:"Выполнено",dataIndex:"completed",key:"completed",align:"center",render:R=>i.jsx(cr,{type:"success",children:R})},{title:"В работе",dataIndex:"pending",key:"pending",align:"center",render:R=>i.jsx(cr,{type:"warning",children:R})},{title:"Просрочено",dataIndex:"overdue",key:"overdue",align:"center",render:R=>i.jsx(cr,{type:"danger",children:R})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:R=>`${R}%`}],M=R=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(R);return e?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx(Zn,{size:"large",tip:"Загрузка аналитики..."})}):i.jsxs("div",{className:"kpi-page",children:[i.jsxs("div",{className:"kpi-header",children:[i.jsx(dd,{level:2,children:"KPI и Аналитика"}),i.jsxs(Fe,{children:[i.jsx(Ye,{value:o,onChange:A,style:{width:150},options:[{label:"За 7 дней",value:"7days"},{label:"За 30 дней",value:"30days"},{label:"За 90 дней",value:"90days"},{label:"За год",value:"1year"}]}),i.jsx(yV,{value:n,onChange:R=>s(R),format:"DD.MM.YYYY"})]})]}),i.jsxs("div",{className:"kpi-compact-grid",children:[i.jsx(Ge,{size:"small",className:"kpi-card--compact",children:i.jsx(yt,{title:"Общая стоимость портфеля",value:r.totalPortfolioValue,prefix:i.jsx(Jf,{}),formatter:R=>M(Number(R)),valueStyle:{color:"#3f8600"}})}),i.jsx(Ge,{size:"small",className:"kpi-card--compact",children:i.jsx(yt,{title:"Активных договоров",value:r.activeContracts,prefix:i.jsx(Qr,{}),suffix:`/ ${r.totalContracts}`,valueStyle:{color:"#1890ff"}})}),i.jsx(Ge,{size:"small",className:"kpi-card--compact",children:i.jsx(yt,{title:"Выполнено задач",value:r.completedTasks,prefix:i.jsx(On,{}),suffix:`/ ${r.completedTasks+r.pendingTasks}`,valueStyle:{color:"#3f8600"}})}),i.jsx(Ge,{size:"small",className:"kpi-card--compact",children:i.jsx(yt,{title:"Просрочено задач",value:r.overdueTasks,prefix:i.jsx(fh,{}),valueStyle:{color:"#cf1322"}})}),i.jsxs(Ge,{size:"small",className:"kpi-card--compact",children:[i.jsx(yt,{title:"MBO выполнение (департамент)",value:r.mboCompletionOverall,suffix:"%",prefix:i.jsx(ef,{}),valueStyle:{color:r.mboCompletionOverall>=95?"#3f8600":r.mboCompletionOverall>=80?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:r.mboCompletionOverall,size:"small",strokeColor:r.mboCompletionOverall>=95?"#3f8600":r.mboCompletionOverall>=80?"#faad14":"#cf1322",style:{marginTop:8}})]})]}),i.jsxs("div",{className:"kpi-compact-grid kpi-compact-grid--wide",children:[i.jsxs(Ge,{size:"small",className:"kpi-card--compact",children:[i.jsx(yt,{title:"Залоговых заключений",value:r.totalConclusions,prefix:i.jsx(Qr,{}),valueStyle:{color:"#1890ff"}}),i.jsxs("div",{style:{marginTop:8},children:[i.jsxs(cr,{type:"success",children:["Согласовано: ",r.approvedConclusions]}),i.jsx("br",{}),i.jsxs(cr,{type:"warning",children:["На согласовании: ",r.pendingConclusions]})]})]}),i.jsxs(Ge,{size:"small",className:"kpi-card--compact",children:[i.jsx(yt,{title:"Средний срок подготовки СЗ",value:r.averageConclusionDays,suffix:"раб. дней",prefix:i.jsx(zn,{}),valueStyle:{color:r.averageConclusionDays<=7?"#3f8600":"#cf1322"}}),i.jsxs("div",{style:{marginTop:8},children:[i.jsx(cr,{type:"secondary",style:{fontSize:12},children:"SLA: не более 7 рабочих дней"}),i.jsx(Qn,{percent:r.averageConclusionDays>0?Math.min(7/r.averageConclusionDays*100,100):0,strokeColor:r.averageConclusionDays<=7?"#3f8600":"#faad14",size:"small",showInfo:!1,style:{marginTop:8}})]})]}),i.jsxs(Ge,{size:"small",className:"kpi-card--compact",children:[i.jsx(yt,{title:"Выполнение SLA",value:r.slaCompliance,suffix:"%",prefix:i.jsx(On,{}),valueStyle:{color:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:r.slaCompliance,strokeColor:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]}),i.jsxs(Ge,{size:"small",className:"kpi-card--compact",children:[i.jsx(yt,{title:"Текущая загрузка",value:r.currentWorkload,suffix:"%",prefix:i.jsx(es,{}),valueStyle:{color:r.currentWorkload<=100?"#3f8600":r.currentWorkload<=125?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:Math.min(r.currentWorkload,150),strokeColor:r.currentWorkload<=100?"#3f8600":r.currentWorkload<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})]}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(rl,{}),i.jsx("span",{children:"Загрузка сотрудников по периодам"})]}),style:{marginBottom:24},children:i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"За последние 7 дней",value:r.workloadByPeriod.last7Days,suffix:"%",prefix:i.jsx(zn,{}),valueStyle:{color:r.workloadByPeriod.last7Days<=100?"#3f8600":r.workloadByPeriod.last7Days<=125?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:Math.min(r.workloadByPeriod.last7Days,150),strokeColor:r.workloadByPeriod.last7Days<=100?"#3f8600":r.workloadByPeriod.last7Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})}),i.jsx(Te,{xs:24,sm:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"За последние 30 дней",value:r.workloadByPeriod.last30Days,suffix:"%",prefix:i.jsx(zn,{}),valueStyle:{color:r.workloadByPeriod.last30Days<=100?"#3f8600":r.workloadByPeriod.last30Days<=125?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:Math.min(r.workloadByPeriod.last30Days,150),strokeColor:r.workloadByPeriod.last30Days<=100?"#3f8600":r.workloadByPeriod.last30Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})}),i.jsx(Te,{xs:24,sm:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"За последние 90 дней",value:r.workloadByPeriod.last90Days,suffix:"%",prefix:i.jsx(zn,{}),valueStyle:{color:r.workloadByPeriod.last90Days<=100?"#3f8600":r.workloadByPeriod.last90Days<=125?"#faad14":"#cf1322"}}),i.jsx(Qn,{percent:Math.min(r.workloadByPeriod.last90Days,150),strokeColor:r.workloadByPeriod.last90Days<=100?"#3f8600":r.workloadByPeriod.last90Days<=125?"#faad14":"#cf1322",size:"small",style:{marginTop:8}})]})})]})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(ef,{}),i.jsx("span",{children:"Лучшие сотрудники"})]}),style:{marginBottom:24},children:i.jsx(ft,{gutter:[16,16],children:lS.map(R=>{const L=D[R.key];return i.jsx(Te,{xs:24,md:8,children:i.jsx(Ge,{size:"small",bordered:!0,children:L?i.jsxs(Fe,{direction:"vertical",size:6,style:{width:"100%"},children:[i.jsxs(Fe,{size:6,align:"center",children:[R.icon,i.jsx(cr,{strong:!0,children:L.title})]}),i.jsx(dd,{level:5,style:{margin:0},children:L.employeeName}),i.jsx(cr,{type:"secondary",children:L.region}),i.jsxs("div",{style:{fontSize:12},children:[i.jsxs(cr,{children:["Загрузка: ",L.workload,"%"]}),i.jsx("br",{}),i.jsxs(cr,{children:["SLA ≤ 7 дней: ",L.slaSuccess,"%"]})]})]}):i.jsx(cr,{type:"secondary",children:"Данные обновляются..."})})},R.key)})})}),i.jsx(ft,{gutter:[16,16],style:{marginBottom:24},children:i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Объектов в реестре",value:r.totalObjects,prefix:i.jsx(Kc,{}),valueStyle:{color:"#722ed1"}})})})}),i.jsxs(ft,{gutter:[16,16],style:{marginBottom:24},children:[i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Активных страховок",value:r.activeInsurance,prefix:i.jsx(On,{}),suffix:`/ ${r.totalInsurance}`,valueStyle:{color:"#3f8600"}})})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Задач в работе",value:r.pendingTasks,prefix:i.jsx(zn,{}),valueStyle:{color:"#faad14"}})})})]}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(On,{}),i.jsx("span",{children:"Выполнение SLA по залоговым заключениям"})]}),style:{marginBottom:24},children:i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,md:12,children:i.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[i.jsx(dd,{level:3,style:{marginBottom:8},children:"Средний срок подготовки"}),i.jsx("div",{style:{fontSize:48,fontWeight:"bold",marginBottom:8,color:r.averageConclusionDays<=7?"#3f8600":"#cf1322"},children:r.averageConclusionDays.toFixed(1)}),i.jsx(cr,{type:"secondary",style:{fontSize:18},children:"рабочих дней"}),i.jsxs("div",{style:{marginTop:16},children:[i.jsx(cr,{strong:!0,style:{fontSize:16},children:"Требование SLA: не более 7 рабочих дней"}),i.jsx("br",{}),i.jsx(cr,{type:r.averageConclusionDays<=7?"success":"danger",style:{fontSize:14},children:r.averageConclusionDays<=7?"✅ Соответствует SLA":"❌ Превышение на "+(r.averageConclusionDays-7).toFixed(1)+" дней"})]})]})}),i.jsx(Te,{xs:24,md:12,children:i.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[i.jsx(dd,{level:3,style:{marginBottom:8},children:"Процент соответствия SLA"}),i.jsx(Qn,{type:"circle",percent:r.slaCompliance,strokeColor:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322",size:200,format:R=>`${R}%`}),i.jsxs("div",{style:{marginTop:16},children:[i.jsx(cr,{type:"secondary",style:{fontSize:14},children:"Заключений, подготовленных в срок ≤ 7 дней"}),i.jsx("br",{}),i.jsx(cr,{strong:!0,style:{fontSize:16,color:r.slaCompliance>=90?"#3f8600":r.slaCompliance>=70?"#faad14":"#cf1322"},children:r.slaCompliance>=90?"✅ Отличный показатель":r.slaCompliance>=70?"⚠️ Требует улучшения":"❌ Критический уровень"})]})]})})]})}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Kc,{}),i.jsx("span",{children:"Аналитика по региональным центрам"})]}),style:{marginBottom:24},children:[i.jsx(cr,{type:"secondary",style:{display:"block",marginBottom:16},children:"Кликните на региональный центр для детальной статистики по городам и сотрудникам"}),i.jsx(ft,{gutter:[16,16],children:c.map(R=>i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsxs(Ge,{className:"kpi-center-card",hoverable:!0,onClick:()=>{f(R.code),u(null),h(!0)},style:{cursor:"pointer"},children:[i.jsx(mt.Title,{level:4,style:{marginTop:0},children:R.name}),i.jsxs("div",{className:"kpi-center-card__metrics",children:[i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"Выполнение:"}),i.jsxs(cr,{strong:!0,style:{marginLeft:4},children:[R.completionRate,"%"]}),i.jsx(Qn,{percent:R.completionRate,strokeColor:"#3f8600",showInfo:!1,size:"small",style:{marginTop:6}})]}),i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"MBO:"}),i.jsxs(cr,{strong:!0,style:{marginLeft:4},children:[R.mboCompletion,"%"]}),i.jsx(Qn,{percent:R.mboCompletion,strokeColor:"#1890ff",showInfo:!1,size:"small",style:{marginTop:6}})]})]}),i.jsxs(Fe,{direction:"vertical",size:"small",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"Всего задач:"})," ",i.jsx(cr,{strong:!0,children:R.totalTasks})]}),i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"Завершено:"})," ",i.jsx(cr,{strong:!0,type:"success",children:R.completedTasks})]}),i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"В работе:"})," ",i.jsx(cr,{strong:!0,type:"warning",children:R.inProgressTasks})]}),i.jsxs("div",{children:[i.jsx(cr,{type:"secondary",children:"Просрочено:"})," ",i.jsx(cr,{strong:!0,type:"danger",children:R.overdueTasks})]})]})]})},R.code))})]}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(c_,{}),i.jsx("span",{children:"Статистика по задачам по категориям"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:O,dataSource:I,pagination:!1,size:"small"})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(ef,{}),i.jsx("span",{children:"Рейтинг сотрудников"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:S,dataSource:_,pagination:!1,size:"small",rowKey:"key",locale:{emptyText:"Недостаточно данных для формирования рейтинга"}})}),i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,lg:12,children:i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(rl,{}),i.jsx("span",{children:"Динамика выполнения задач"})]}),children:i.jsxs("div",{style:{padding:"40px 0",textAlign:"center",color:"#999"},children:["График динамики выполнения задач",i.jsx("br",{}),i.jsx(cr,{type:"secondary",children:"(Интеграция с графиками в разработке)"})]})})}),i.jsx(Te,{xs:24,lg:12,children:i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Kc,{}),i.jsx("span",{children:"Распределение по статусам"})]}),children:i.jsxs("div",{style:{padding:"40px 0",textAlign:"center",color:"#999"},children:["График распределения по статусам",i.jsx("br",{}),i.jsx(cr,{type:"secondary",children:"(Интеграция с графиками в разработке)"})]})})})]}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(es,{}),i.jsxs("span",{children:["Аналитика по региональному центру:"," ",d?(T=c.find(R=>R.code===d))==null?void 0:T.name:""]})]}),open:g,onCancel:()=>{h(!1),f(null),u(null)},footer:[i.jsx(Be,{onClick:()=>{h(!1),f(null),u(null)},children:"Закрыть"},"close")],width:900,children:d&&(()=>{const R=c.find(W=>W.code===d);if(!R)return null;const L=[{title:"Город",dataIndex:"city",key:"city"},{title:"Всего задач",dataIndex:"totalTasks",key:"totalTasks",align:"center"},{title:"Завершено",dataIndex:"completedTasks",key:"completedTasks",align:"center",render:W=>i.jsx(cr,{type:"success",children:W})},{title:"В работе",dataIndex:"inProgressTasks",key:"inProgressTasks",align:"center",render:W=>i.jsx(cr,{type:"warning",children:W})},{title:"Просрочено",dataIndex:"overdueTasks",key:"overdueTasks",align:"center",render:W=>i.jsx(cr,{type:"danger",children:W})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:W=>`${W}%`}],N=R.cities.map(W=>({key:W.city,...W})),P=fr.getEmployees(),U=p?R.cities.find(W=>W.city===p):void 0,V=[{title:"Сотрудник",dataIndex:"employee",key:"employee",render:(W,z)=>{const G=P.find(b=>b.id===z.employeeId);return G?`${G.lastName} ${G.firstName} ${G.middleName||""}`.trim():"Неизвестно"}},{title:"Должность",dataIndex:"position",key:"position",render:(W,z)=>{const G=P.find(b=>b.id===z.employeeId);return(G==null?void 0:G.position)||"—"}},{title:"Всего задач",dataIndex:"totalTasks",key:"totalTasks",align:"center"},{title:"Завершено",dataIndex:"completedTasks",key:"completedTasks",align:"center",render:W=>i.jsx(cr,{type:"success",children:W})},{title:"В работе",dataIndex:"inProgressTasks",key:"inProgressTasks",align:"center",render:W=>i.jsx(cr,{type:"warning",children:W})},{title:"Просрочено",dataIndex:"overdueTasks",key:"overdueTasks",align:"center",render:W=>i.jsx(cr,{type:"danger",children:W})},{title:"% выполнения",dataIndex:"completionRate",key:"completionRate",align:"center",render:W=>`${W}%`}],ie=(U==null?void 0:U.employees.map(W=>({key:W.employeeId,...W})))??[];return i.jsxs(i.Fragment,{children:[i.jsx(dd,{level:5,style:{marginBottom:12},children:"Города регионального центра"}),i.jsx(nr,{columns:L,dataSource:N,size:"small",pagination:!1,onRow:W=>({onClick:()=>u(W.city),style:{cursor:"pointer",backgroundColor:p===W.city?"rgba(24,144,255,0.06)":void 0}})}),p&&U&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginTop:24,marginBottom:8},children:i.jsxs(dd,{level:5,children:["Сотрудники города: ",p," (",U.totalTasks," задач)"]})}),i.jsx(nr,{columns:V,dataSource:ie,size:"small",pagination:!1})]})]})})()})]})},{Title:CV,Text:Si}=mt,{RangePicker:BV}=Rr,jE=e=>{if(!e)return"Прочее";const t=String(e).toLowerCase();return t.includes("квартир")||t.includes("комнат")||t.includes("жилой дом")||t.includes("таунхаус")||t.includes("жилая")||t==="apartment"||t==="room"||t==="house"||t==="townhouse"||t==="land_residential"?"НЕДВИЖИМОСТЬ ЖИЛАЯ":t.includes("офис")||t.includes("торгов")||t.includes("склад")||t.includes("гостиниц")||t.includes("отель")||t.includes("кафе")||t.includes("ресторан")||t.includes("азс")||t.includes("автосалон")||t.includes("производств")||t.includes("цех")||t.includes("нежилая")||t.includes("коммерческая")||t.includes("промышленная")||t==="office"||t==="retail"||t==="warehouse"||t==="hotel"||t==="catering"||t==="gas_station"||t==="car_dealership"||t==="industrial_building"||t==="workshop"?"НЕДВИЖИМОСТЬ НЕЖИЛАЯ":t.includes("оборудован")||t==="equipment"?"ОБОРУДОВАНИЕ":t.includes("автомобиль")||t.includes("легков")||t.includes("грузов")||t.includes("транспорт")||t==="car_passenger"||t==="car_truck"?"ТРАНСПОРТНЫЕ СРЕДСТВА":t.includes("спецтехник")||t.includes("техник")||t==="machinery"?"СПЕЦТЕХНИКА":t.includes("товар")||t.includes("оборот")?"ТОВАРЫ В ОБОРОТЕ":"Прочее"},SV=()=>{const[e,t]=K.useState(!0),[r,a]=K.useState({portfolioData:[],totalValue:0,totalDebt:0}),[n,s]=K.useState([We().subtract(365,"day"),We()]),[o,A]=K.useState("all"),c=Ma.useCallback(B=>{if(B==null||B==="")return 0;const I=parseFloat(String(B));return isNaN(I)?0:I},[]),l=Ma.useCallback(async()=>{t(!0);try{const B="./",I=new URL(B,window.location.origin),_=I.pathname.endsWith("/")?I.pathname:`${I.pathname}/`,S=`${I.origin}${_}portfolioData.json?v=${Date.now()}`,O=await fetch(S,{cache:"no-store"});if(!O.ok)throw new Error(`HTTP error! status: ${O.status}`);const M=await O.json(),T=await Yt.getExtendedCards(),R=M.map(P=>{const U=T.filter(V=>V.reference&&String(V.reference)===String(P.reference)||V.contractNumber&&V.contractNumber===P.contractNumber);return U.length>0&&U[0].propertyType?{...P,collateralType:U[0].propertyType}:P});let L=0,N=0;for(const P of R)L+=c(P.collateralValue),N+=c(P.debtRub);a({portfolioData:R,totalValue:L,totalDebt:N})}catch(B){console.error("Ошибка загрузки данных для аналитики:",B)}finally{t(!1)}},[c]);K.useEffect(()=>{l()},[l]);const d=K.useMemo(()=>{const B=new Map,I=new Set(["МБ","СРБ","КБ","Малый бизнес","Средний бизнес","Крупный бизнес","Сегмент ВЭД","ВЭД","МСБ","Корпоративный","Розничный"]);for(const S of r.portfolioData){const O=S.collateralCategory||jE(S.collateralType)||"Не указана";if(I.has(O)||S.segment===O)continue;const M=c(S.collateralValue),T=c(S.debtRub),R=B.get(O)||{count:0,value:0,debt:0};R.count++,R.value+=M,R.debt+=T,B.set(O,R)}const _=r.totalValue;return Array.from(B.entries()).map(([S,O])=>({category:S,count:O.count,value:O.value,debt:O.debt,share:_>0?O.value/_*100:0,coverageRatio:O.debt>0?O.value/O.debt*100:0})).sort((S,O)=>O.value-S.value)},[r,c]),f=K.useMemo(()=>{const B=new Map,I=new Set(["Формальный","Основное","Проблемный"]);for(const S of r.portfolioData){const O=S.collateralCategory||"";if(!I.has(O))continue;const M=S.collateralType||"Не указан",T=jE(S.collateralType),R=c(S.collateralValue),L=c(S.debtRub),N=B.get(M)||{count:0,value:0,debt:0,category:T};N.count++,N.value+=R,N.debt+=L,B.set(M,N)}const _=r.totalValue;return Array.from(B.entries()).map(([S,O])=>({type:S,category:O.category,count:O.count,value:O.value,debt:O.debt,share:_>0?O.value/_*100:0})).sort((S,O)=>O.value-S.value)},[r,c]),p=K.useMemo(()=>{if(!n[0]||!n[1])return null;const B=n[0].startOf("day"),I=n[1].endOf("day"),_=r.portfolioData.filter(j=>{const q=j.contractDate||j.createdAt;if(!q)return!1;const Y=We(q);return Y.isAfter(B)&&Y.isBefore(I)}),S=I.diff(B,"day"),O=B.subtract(S+1,"day"),M=B.subtract(1,"day"),T=r.portfolioData.filter(j=>{const q=j.contractDate||j.createdAt;if(!q)return!1;const Y=We(q);return Y.isAfter(O)&&Y.isBefore(M)});let R=0,L=0;for(const j of _)R+=c(j.collateralValue),L+=c(j.debtRub);const N=_.length;let P=0,U=0;for(const j of T)P+=c(j.collateralValue),U+=c(j.debtRub);const V=T.length,ie=N-V,W=V>0?ie/V*100:N>0?100:0,z=R-P,G=P>0?z/P*100:R>0?100:0,b=L-U,k=U>0?b/U*100:L>0?100:0;return{current:{count:N,value:R,debt:L},previous:{count:V,value:P,debt:U},changes:{count:ie,countPercent:W,value:z,valuePercent:G,debt:b,debtPercent:k},periodStart:B.format("DD.MM.YYYY"),periodEnd:I.format("DD.MM.YYYY"),previousPeriodStart:O.format("DD.MM.YYYY"),previousPeriodEnd:M.format("DD.MM.YYYY")}},[r,n,c]),u=K.useMemo(()=>{const B=new Map;for(const _ of r.portfolioData){const S=_.segment||"Не указан",O=c(_.collateralValue),M=c(_.debtRub),T=B.get(S)||{count:0,value:0,debt:0};T.count++,T.value+=O,T.debt+=M,B.set(S,T)}const I=r.totalValue;return Array.from(B.entries()).map(([_,S])=>({segment:_,count:S.count,value:S.value,debt:S.debt,share:I>0?S.value/I*100:0,coverageRatio:S.debt>0?S.value/S.debt*100:0})).sort((_,S)=>S.value-_.value)},[r,c]),g=K.useMemo(()=>{const B=[];let I=0,_=0;for(const M of r.portfolioData){const T=String(M.status||"").toLowerCase();(T.includes("просроч")||T.includes("overdue")||T.includes("проблем"))&&(B.push(M),I+=c(M.collateralValue),_+=c(M.debtRub))}const S=r.totalValue,O=r.totalDebt;return{count:B.length,totalCount:r.portfolioData.length,value:I,debt:_,share:S>0?I/S*100:0,debtShare:O>0?_/O*100:0}},[r,c]),h=K.useMemo(()=>{const B=new Map;for(const _ of r.portfolioData){const S=_.group||"Не указана",O=c(_.collateralValue),M=c(_.debtRub),T=B.get(S)||{count:0,value:0,debt:0};T.count++,T.value+=O,T.debt+=M,B.set(S,T)}const I=r.totalValue;return Array.from(B.entries()).map(([_,S])=>({group:_,count:S.count,value:S.value,debt:S.debt,share:I>0?S.value/I*100:0})).sort((_,S)=>S.value-_.value)},[r,c]),y=B=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(B),x=[{title:"Категория имущества",dataIndex:"category",key:"category"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:B=>y(B)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:B=>y(B)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:B=>i.jsxs("div",{children:[i.jsxs(Si,{strong:!0,children:[B.toFixed(2),"%"]}),i.jsx(Qn,{percent:B,showInfo:!1,size:"small",style:{marginTop:4}})]})},{title:"Коэффициент покрытия",dataIndex:"coverageRatio",key:"coverageRatio",align:"center",render:B=>i.jsxs(at,{color:B>=100?"green":B>=70?"orange":"red",children:[B.toFixed(1),"%"]})}],v=[{title:"Категория",dataIndex:"category",key:"category",filters:Array.from(new Set(f.map(B=>B.category))).map(B=>({text:B,value:B})),onFilter:(B,I)=>I.category===B},{title:"Тип залогового имущества",dataIndex:"type",key:"type"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:B=>y(B)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:B=>y(B)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:B=>i.jsxs("div",{children:[i.jsxs(Si,{strong:!0,children:[B.toFixed(2),"%"]}),i.jsx(Qn,{percent:B,showInfo:!1,size:"small",style:{marginTop:4}})]})}],E=[{title:"Сегмент бизнеса",dataIndex:"segment",key:"segment"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:B=>y(B)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:B=>y(B)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:B=>`${B.toFixed(2)}%`},{title:"Коэффициент покрытия",dataIndex:"coverageRatio",key:"coverageRatio",align:"center",render:B=>i.jsxs(at,{color:B>=100?"green":B>=70?"orange":"red",children:[B.toFixed(1),"%"]})}],D=[{title:"Группа",dataIndex:"group",key:"group"},{title:"Количество",dataIndex:"count",key:"count",align:"center"},{title:"Стоимость залога",dataIndex:"value",key:"value",align:"right",render:B=>y(B)},{title:"Задолженность",dataIndex:"debt",key:"debt",align:"right",render:B=>y(B)},{title:"Доля в портфеле",dataIndex:"share",key:"share",align:"center",render:B=>`${B.toFixed(2)}%`}];return e?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx(Zn,{size:"large",tip:"Загрузка аналитики..."})}):i.jsxs("div",{className:"analytics-page",children:[i.jsxs("div",{className:"analytics-header",children:[i.jsx(CV,{level:2,children:"Аналитика залогового портфеля"}),i.jsxs(Fe,{children:[i.jsx(Ye,{value:o,onChange:A,style:{width:150},options:[{label:"Весь период",value:"all"},{label:"За 7 дней",value:"7days"},{label:"За 30 дней",value:"30days"},{label:"За 90 дней",value:"90days"},{label:"За год",value:"1year"}]}),i.jsx(BV,{value:n,onChange:B=>s(B),format:"DD.MM.YYYY"})]})]}),i.jsxs(ft,{gutter:[16,16],style:{marginBottom:24},children:[i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Общая стоимость портфеля",value:r.totalValue,prefix:i.jsx(Jf,{}),formatter:B=>y(Number(B)),valueStyle:{color:"#3f8600"}})})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Общая задолженность",value:r.totalDebt,prefix:i.jsx(JA,{}),formatter:B=>y(Number(B)),valueStyle:{color:"#1890ff"}})})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Всего договоров",value:r.portfolioData.length,prefix:i.jsx(Qr,{})})})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(Ge,{children:i.jsx(yt,{title:"Просроченных",value:g.count,prefix:i.jsx(fh,{}),suffix:`/ ${g.totalCount}`,valueStyle:{color:"#cf1322"}})})})]}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(fh,{}),i.jsx("span",{children:"Анализ просроченной задолженности"})]}),style:{marginBottom:24},children:[i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(yt,{title:"Количество просроченных договоров",value:g.count,suffix:`из ${g.totalCount}`})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(yt,{title:"Стоимость залога по просроченным",value:g.value,formatter:B=>y(Number(B)),valueStyle:{color:"#cf1322"}})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(yt,{title:"Просроченная задолженность",value:g.debt,formatter:B=>y(Number(B)),valueStyle:{color:"#cf1322"}})}),i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(yt,{title:"Доля просроченной задолженности",value:g.debtShare,suffix:"%",valueStyle:{color:"#cf1322"}})})]}),i.jsx(jt,{}),i.jsxs(ft,{gutter:[16,16],children:[i.jsxs(Te,{xs:24,sm:12,children:[i.jsx(Qn,{type:"dashboard",percent:g.share,format:B=>`${B==null?void 0:B.toFixed(1)}%`,strokeColor:"#cf1322"}),i.jsx(Si,{type:"secondary",style:{display:"block",textAlign:"center",marginTop:8},children:"Доля просроченных в общей стоимости портфеля"})]}),i.jsxs(Te,{xs:24,sm:12,children:[i.jsx(Qn,{type:"dashboard",percent:g.debtShare,format:B=>`${B==null?void 0:B.toFixed(1)}%`,strokeColor:"#ff4d4f"}),i.jsx(Si,{type:"secondary",style:{display:"block",textAlign:"center",marginTop:8},children:"Доля просроченной задолженности в общей задолженности"})]})]})]}),p&&i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(rl,{}),i.jsxs("span",{children:["Динамика портфеля за период ",p.periodStart," - ",p.periodEnd]})]}),style:{marginBottom:24},children:[i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"Количество договоров",value:p.current.count,suffix:i.jsxs("div",{children:[i.jsxs(Si,{type:p.changes.count>=0?"success":"danger",children:[p.changes.count>=0?"+":"",p.changes.count]}),i.jsx("br",{}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["(",p.changes.countPercent>=0?"+":"",p.changes.countPercent.toFixed(2),"%)"]})]})}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",p.previous.count]})]})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"Стоимость залога",value:p.current.value,formatter:B=>y(Number(B)),suffix:i.jsxs("div",{children:[i.jsxs(Si,{type:p.changes.value>=0?"success":"danger",children:[p.changes.value>=0?"+":"",y(p.changes.value)]}),i.jsx("br",{}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["(",p.changes.valuePercent>=0?"+":"",p.changes.valuePercent.toFixed(2),"%)"]})]})}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",y(p.previous.value)]})]})}),i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsxs(Ge,{size:"small",children:[i.jsx(yt,{title:"Задолженность",value:p.current.debt,formatter:B=>y(Number(B)),suffix:i.jsxs("div",{children:[i.jsxs(Si,{type:p.changes.debt>=0?"danger":"success",children:[p.changes.debt>=0?"+":"",y(p.changes.debt)]}),i.jsx("br",{}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["(",p.changes.debtPercent>=0?"+":"",p.changes.debtPercent.toFixed(2),"%)"]})]})}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["Предыдущий период: ",y(p.previous.debt)]})]})})]}),i.jsx(jt,{}),i.jsxs(Si,{type:"secondary",style:{fontSize:12},children:["Сравнение с предыдущим периодом: ",p.previousPeriodStart," - ",p.previousPeriodEnd]})]}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Kc,{}),i.jsx("span",{children:"Структура портфеля по сегментам бизнеса"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:E,dataSource:u.map((B,I)=>({...B,key:I})),pagination:!1,size:"small"})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(c_,{}),i.jsx("span",{children:"Структура портфеля по категориям имущества"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:x,dataSource:d.map((B,I)=>({...B,key:I})),pagination:!1,size:"small"})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Kc,{}),i.jsx("span",{children:"Детальная структура портфеля по типам залогового имущества"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:v,dataSource:f.map((B,I)=>({...B,key:I})),pagination:{pageSize:20},size:"small"})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Kc,{}),i.jsx("span",{children:"Структура портфеля по группам"})]}),style:{marginBottom:24},children:i.jsx(nr,{columns:D,dataSource:h.map((B,I)=>({...B,key:I})),pagination:!1,size:"small"})})]})},TV=e=>{const t=`${e.lastName} ${e.firstName} ${e.middleName||""}`.trim(),r=e.region?yy(e.region):null,a=r?r.name:e.region;let n="employee";return e.isManager&&(n="manager"),{id:e.id,email:e.email,name:t,role:n,region:a,position:e.position,department:e.department}},xd=()=>{try{const t=fr.getEmployees().filter(A=>A.isActive).map(TV),r=Wi.map(A=>({code:A.code,name:A.name,cities:A.cities})),a="zadachnik_users",n=localStorage.getItem(a);let s={};if(n)try{s=JSON.parse(n)}catch{console.warn("Не удалось распарсить существующие данные zadachnik, создаем новые")}s.employee=t,s.regions=r,localStorage.setItem(a,JSON.stringify(s));const o=t.filter(A=>A.role==="manager").length;console.log(`✅ Синхронизировано ${t.length} сотрудников в zadachnik (${o} руководителей)`),console.log(`✅ Синхронизировано ${r.length} региональных центров`)}catch(e){console.error("Ошибка синхронизации сотрудников с zadachnik:",e)}},OV=Object.freeze(Object.defineProperty({__proto__:null,syncEmployeesToZadachnik:xd},Symbol.toStringTag,{value:"Module"})),LE=[{email:"business1@bank.ru",name:"Иванов Иван Иванович"},{email:"business2@bank.ru",name:"Петрова Мария Сергеевна"},{email:"business3@bank.ru",name:"Сидоров Петр Александрович"},{email:"business4@bank.ru",name:"Козлова Анна Дмитриевна"},{email:"business5@bank.ru",name:"Волков Сергей Николаевич"}],UE={Оценка:["Провести оценку объекта недвижимости","Выполнить оценку движимого имущества","Организовать переоценку объекта залога","Подготовить отчет об оценке","Провести независимую оценку","Оценить рыночную стоимость объекта","Выполнить оценку для целей залога","Провести оценку коммерческой недвижимости","Оценить земельный участок","Подготовить экспертное заключение по оценке"],Экспертиза:["Провести экспертизу документов","Выполнить техническую экспертизу объекта","Проверить юридическую чистоту","Провести строительно-техническую экспертизу","Организовать экспертизу оценки","Провести судебную экспертизу","Выполнить экологическую экспертизу","Проверить техническое состояние объекта","Провести экспертизу проектной документации","Выполнить финансовую экспертизу"],Рецензия:["Провести рецензию отчета об оценке","Выполнить рецензирование экспертизы","Проверить качество оценки","Подготовить рецензию на заключение","Провести независимую рецензию","Выполнить рецензирование отчета","Проверить соответствие стандартам оценки","Подготовить экспертное заключение по рецензии"],ПРКК:["Провести проверку рисков","Выполнить анализ кредитных рисков","Проверить залоговое обеспечение","Оценить риски по сделке","Провести комплексную проверку рисков","Выполнить анализ залоговых рисков","Оценить рыночные риски","Проверить ликвидность залога","Выполнить стресс-тестирование","Провести анализ концентрации рисков"],Прочее:["Провести мониторинг объекта залога","Проверить комплектность документов","Связаться с клиентом","Обновить данные в реестре","Проверить срок действия страховки","Провести осмотр объекта","Подготовить справку","Оформить документы","Проверить соответствие требованиям","Выполнить консультацию"],Отчетность:["Подготовить аналитический отчет","Сформировать отчет по портфелю","Подготовить отчет для руководства","Обновить отчетность","Подготовить ежемесячный отчет","Сформировать квартальный отчет","Подготовить отчет по региону","Выполнить сводный отчет","Подготовить отчет по рискам","Сформировать статистический отчет"],"Подготовка СЗ":["Подготовить залоговое заключение","Оформить документы по залогу","Подготовить пакет документов","Согласовать условия залога","Подготовить заключение по залогу","Оформить залоговое обеспечение","Подготовить документы для регистрации","Согласовать залоговое заключение","Подготовить проект залогового договора","Оформить залоговую документацию"],Мониторинг:["Провести плановый мониторинг объекта","Выполнить внеплановый мониторинг","Проверить состояние объекта залога","Провести мониторинг рыночной стоимости","Выполнить мониторинг документов","Проверить использование объекта","Провести мониторинг страховки","Выполнить контрольный мониторинг","Проверить сохранность залога","Провести комплексный мониторинг"],Осмотр:["Провести первичный осмотр объекта","Выполнить повторный осмотр","Провести внеплановый осмотр","Организовать осмотр объекта залога","Проверить техническое состояние","Провести осмотр с фотофиксацией","Выполнить осмотр с оценщиком","Провести осмотр недвижимости","Организовать осмотр движимого имущества","Проверить соответствие описанию"],"Проверка документов":["Проверить комплектность документов","Выполнить проверку подлинности","Проверить соответствие требованиям","Провести правовую проверку","Выполнить проверку регистрации","Проверить срок действия документов","Провести комплексную проверку","Выполнить проверку на обременения","Проверить правоустанавливающие документы","Провести проверку кадастровых документов"],Согласование:["Согласовать условия залога","Провести согласование с клиентом","Согласовать оценку","Выполнить согласование документов","Провести согласование с руководством","Согласовать условия сделки","Выполнить межведомственное согласование","Провести согласование с партнерами","Согласовать залоговое заключение","Провести финальное согласование"],"Контроль качества":["Провести контроль качества оценки","Выполнить проверку качества документов","Проверить качество экспертизы","Провести контроль качества работы","Выполнить аудит качества","Проверить соответствие стандартам","Провести внутренний контроль","Выполнить проверку на ошибки","Проверить полноту информации","Провести финальный контроль"]},IV=(e,t,r)=>({Оценка:`Требуется выполнить оценку объекта в регионе ${r}. ${t}`,Экспертиза:`Необходимо провести экспертизу в регионе ${r}. ${t}`,Рецензия:`Требуется рецензирование в регионе ${r}. ${t}`,ПРКК:`Провести проверку рисков в регионе ${r}. ${t}`,Прочее:`Задача в регионе ${r}. ${t}`,Отчетность:`Подготовить отчетность по региону ${r}. ${t}`,"Подготовка СЗ":`Подготовить залоговое заключение в регионе ${r}. ${t}`,Мониторинг:`Провести мониторинг в регионе ${r}. ${t}`,Осмотр:`Провести осмотр объекта в регионе ${r}. ${t}`,"Проверка документов":`Проверить документы в регионе ${r}. ${t}`,Согласование:`Провести согласование в регионе ${r}. ${t}`,"Контроль качества":`Провести контроль качества в регионе ${r}. ${t}`})[e]||`${t} в регионе ${r}`,dS=async()=>{try{const e=fr.getEmployees().filter(l=>l.isActive),t=[],r=We(),a={};Wi.forEach(l=>{a[l.code]=e.filter(d=>l.cities.includes(d.region)||d.region===l.code)}),Wi.forEach(l=>{const d=a[l.code]||[],f=d.filter(u=>u.isActive&&!u.isManager&&u.status!=="sick_leave"&&u.status!=="vacation"&&u.status!=="business_trip"&&(!u.status||u.status==="working")),p=d.filter(u=>u.isActive&&u.isManager);f.length===0||p.length===0||f.forEach(u=>{const h=(85+Math.random()*40)/100*XA,y=h*(10/19),x=h*(5/19),v=Math.max(2,h-y-x),E=h*3.2,D=Math.max(h*.05,2),B=u.region,I=LE[Math.floor(Math.random()*LE.length)],_=`${u.lastName} ${u.firstName} ${u.middleName||""}`.trim(),S=p[0],O=S?`${S.lastName} ${S.firstName} ${S.middleName||""}`.trim():"",M=(V,ie,W=!1)=>{const z=[];let G=0;const b=Object.entries(Qc).map(([k,j])=>({type:k,hours:j})).sort((k,j)=>j.hours-k.hours);for(;G<V;){const k=V-G,j=b.filter(_e=>_e.hours<=k);if(j.length===0)break;const q=Math.random()>.3?j[0]:j[Math.floor(Math.random()*Math.min(3,j.length))];let Y=q.type,de=q.hours;if(Y==="Подготовка СЗ"&&(Math.random()<.1&&k>=24?(Y="Подготовка СЗ (АЗС)",de=24):de=6),de>k)break;const ue=Math.floor(Math.random()*90),pe=r.subtract(ue+(ie==="completed"?30:0),"day"),ye=ie==="completed"?pe.add(Math.floor(Math.random()*20),"day"):null,ve=W?r.subtract(1+Math.floor(Math.random()*30),"day"):ie==="completed"&&ye?ye.add(Math.floor(Math.random()*10),"day"):r.add(Math.floor(Math.random()*30)+1,"day"),ae=UE[Y]||UE.Прочее||["Задача"],Ke=ae[Math.floor(Math.random()*ae.length)],Ee=IV(Y,Ke,B),me=`T-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,le=pe.toISOString();let He=ie,Ze=[],$e=null,et=null;const je=[{date:le,user:I.name,userRole:"business",action:"Создана",comment:"Задача создана бизнесом",status:"created"}];if(ie==="completed"||ie==="approved"){const _e=pe.add(1,"day"),lt=_e.add(1,"day"),Ct=lt.add(Math.floor(Math.random()*10),"day"),bt=ie==="approved"&&ye?ye:Ct.add(1,"day");Ze=u.email?[u.email]:[],$e=u.email||null,et=_,je.push({date:_e.toISOString(),user:O||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${_}`,status:"assigned",assignedTo:Ze},{date:lt.toISOString(),user:_,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"},{date:Ct.toISOString(),user:_,userRole:"employee",action:"Отправлена на утверждение",comment:"Задача отправлена на согласование руководителю",status:"approval"},{date:bt.toISOString(),user:O||"Руководитель",userRole:"manager",action:ie==="approved"?"Согласовано":"Выполнена",comment:ie==="approved"?"Задача согласована руководителем":"Задача выполнена",status:ie==="approved"?"approved":"completed"}),He=ie==="approved"?"approved":"completed"}else if(ie==="in_progress"){const _e=pe.add(1,"day"),lt=_e.add(1,"day");Ze=u.email?[u.email]:[],$e=u.email||null,et=_,je.push({date:_e.toISOString(),user:O||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${_}`,status:"assigned",assignedTo:Ze},{date:lt.toISOString(),user:_,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"}),He="in_progress"}else if(ie==="assigned"){const _e=pe.add(1,"day");Ze=u.email?[u.email]:[],$e=u.email||null,et=_,je.push({date:_e.toISOString(),user:O||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${_}`,status:"assigned",assignedTo:Ze}),He="assigned"}else if(ie==="approval"){const _e=pe.add(1,"day"),lt=_e.add(1,"day"),Ct=lt.add(Math.floor(Math.random()*10),"day");Ze=u.email?[u.email]:[],$e=(S==null?void 0:S.email)||null,et=O,je.push({date:_e.toISOString(),user:O||"Руководитель",userRole:"manager",action:"Распределена",comment:`Назначена на: ${_}`,status:"assigned",assignedTo:Ze},{date:lt.toISOString(),user:_,userRole:"employee",action:"Принята в работу",comment:"Задача принята в работу",status:"in_progress"},{date:Ct.toISOString(),user:_,userRole:"employee",action:"Отправлена на утверждение",comment:"Задача отправлена на согласование руководителю",status:"approval"}),He="approval"}z.push({id:me,region:B,type:Y,category:Y,title:Ke,description:Ee,priority:Math.random()>.6?"high":Math.random()>.3?"medium":"low",dueDate:ve.format("YYYY-MM-DD"),status:He,businessUser:I.email,businessUserName:I.name,assignedTo:Ze,currentAssignee:$e,currentAssigneeName:et,employeeId:u.id,documents:[],comments:[],createdAt:le,updatedAt:ie==="completed"&&ye?ye.toISOString():r.toISOString(),completedAt:ie==="completed"&&ye?ye.toISOString():void 0,history:je}),G+=de}return z},T=M(E*.8,"completed"),R=M(E*.2,"approved"),L=M(D,"in_progress",!0),N=M(y,"assigned"),P=M(x,"in_progress"),U=M(v,"approval");t.push(...T,...R,...L,...N,...P,...U)})});try{await Yt.saveTasks(t),console.log(`✅ Задачи сохранены в IndexedDB (${t.length} задач)`);try{localStorage.removeItem("zadachnik_tasks")}catch{}}catch(l){throw console.error("Ошибка сохранения задач в IndexedDB:",l),l}const n=t.reduce((l,d)=>(l[d.type]=(l[d.type]||0)+1,l),{}),s=e.filter(l=>l.isActive),o=t.filter(l=>l.status==="completed").length,A=t.filter(l=>l.status==="in_progress"||l.status==="created").length,c=t.filter(l=>We(l.dueDate).isBefore(We(),"day")&&l.status!=="completed").length;console.log(`✅ Сгенерировано ${t.length} задач для ${s.length} активных сотрудников`),console.log(`   - Среднее количество задач на сотрудника: ${(t.length/s.length).toFixed(1)}`),console.log(`   - Выполнено: ${o} (${(o/t.length*100).toFixed(1)}%)`),console.log(`   - В работе: ${A} (${(A/t.length*100).toFixed(1)}%)`),console.log(`   - Просрочено: ${c} (${(c/t.length*100).toFixed(1)}%)`),console.log("   - Распределение по типам задач:",Object.entries(n).map(([l,d])=>`${l}: ${d}`).join(", "))}catch(e){throw console.error("Ошибка генерации задач:",e),e}},uS=Object.freeze(Object.defineProperty({__proto__:null,generateTasksForEmployees:dS},Symbol.toStringTag,{value:"Module"})),{Title:NV}=mt,{Option:F1}=Ye,{TextArea:FV}=Re,{Panel:RV}=p2,R1=[{value:"working",label:"На работе",color:"green"},{value:"sick_leave",label:"Больничный",color:"orange"},{value:"vacation",label:"Отпуск",color:"blue"},{value:"business_trip",label:"Командировка",color:"purple"}],ME={registry_view:"Просмотр реестра",registry_edit:"Редактирование реестра",portfolio_view:"Просмотр портфеля",portfolio_edit:"Редактирование портфеля",conclusions_view:"Просмотр заключений",conclusions_edit:"Редактирование заключений",tasks_view:"Просмотр задач",tasks_edit:"Редактирование задач",reports_view:"Просмотр отчетов",reports_export:"Экспорт отчетов",settings_view:"Просмотр настроек",settings_edit:"Редактирование настроек",admin:"Администратор"},kV=()=>{var R;const[e,t]=K.useState([]),[r,a]=K.useState([]),[n,s]=K.useState(!1),[o,A]=K.useState(!1),[c,l]=K.useState(null),[d]=ne.useForm(),[f,p]=K.useState([]),[u,g]=K.useState("");K.useEffect(()=>{h(),y()},[]);const h=(L=!1)=>{s(!0);try{const N=fr.getEmployees();t(N),xd(),L&&Ne.success(`Загружено ${N.length} сотрудников`)}catch(N){Ne.error("Ошибка загрузки сотрудников"),console.error(N)}finally{s(!1)}},y=async()=>{try{let L=[];try{L=await Yt.getTasks()}catch{try{const P=localStorage.getItem("zadachnik_tasks");P&&(L=JSON.parse(P))}catch(P){console.warn("Не удалось загрузить задачи из localStorage:",P)}}a(L)}catch(L){console.warn("Ошибка загрузки задач для статистики загрузки сотрудников:",L)}},x=K.useMemo(()=>{if(!u.trim())return e;const L=u.toLowerCase();return e.filter(N=>{const P=`${N.lastName} ${N.firstName} ${N.middleName||""}`.toLowerCase(),U=(N.position||"").toLowerCase(),V=(N.region||"").toLowerCase(),ie=(N.email||"").toLowerCase(),W=(N.department||"").toLowerCase();return P.includes(L)||U.includes(L)||V.includes(L)||ie.includes(L)||W.includes(L)})},[e,u]),v=K.useMemo(()=>{const L={};return Wi.forEach(N=>{L[N.code]={},N.cities.forEach(P=>{L[N.code][P]=x.filter(U=>U.region===P)})}),L},[x]),E=K.useMemo(()=>{const L={};return Wi.forEach(N=>{const P=iS(r,e,N.code,N.cities);L[N.code]=P}),L},[r,e]),D=K.useMemo(()=>{const L={};return Wi.forEach(N=>{const P=r.filter(U=>{const V=(U.region||"").toString();return N.cities.includes(V)||V===N.code}).sort((U,V)=>{const ie=We(U.updatedAt||U.createdAt||U.dueDate||We().toISOString()).valueOf();return We(V.updatedAt||V.createdAt||V.dueDate||We().toISOString()).valueOf()-ie}).slice(0,5);L[N.code]=P}),L},[r]),B=()=>{l(null),d.resetFields(),A(!0)},I=L=>{l(L),d.setFieldsValue({...L,permissions:L.permissions||[],birthDate:L.birthDate?We(L.birthDate):void 0,hireDate:L.hireDate?We(L.hireDate):void 0,status:L.status||"working",photo:L.photo?[{uid:"-1",name:"photo.png",status:"done",url:L.photo}]:[]}),A(!0)},_=L=>new Promise((N,P)=>{const U=new FileReader;U.readAsDataURL(L),U.onload=()=>N(U.result),U.onerror=V=>P(V)}),S=async L=>{if(L.file.status!=="uploading"&&(L.file.status==="done"||L.file.originFileObj))try{const N=await _(L.file.originFileObj||L.file);d.setFieldsValue({photo:[{...L.file,thumbUrl:N,url:N}]})}catch(N){Ne.error("Ошибка загрузки фото"),console.error(N)}},O=L=>{try{fr.deleteEmployee(L),xd(),Ne.success("Сотрудник удален"),h()}catch{Ne.error("Ошибка удаления сотрудника")}},M=async()=>{try{const L=await d.validateFields();let N;if(L.photo&&L.photo.length>0){const U=L.photo[0];U.response?N=U.response.url:U.thumbUrl?N=U.thumbUrl:U.url&&(N=U.url)}else c!=null&&c.photo&&(N=c.photo);const P={...L,birthDate:L.birthDate?We(L.birthDate).format("YYYY-MM-DD"):void 0,hireDate:L.hireDate?We(L.hireDate).format("YYYY-MM-DD"):void 0,status:L.status||"working",photo:N};c?(fr.updateEmployee(c.id,P),xd(),Ne.success("Сотрудник обновлен")):(fr.addEmployee(P),xd(),Ne.success("Сотрудник добавлен")),A(!1),h()}catch(L){console.error("Ошибка сохранения:",L)}},T=[{title:"ФИО",key:"name",width:180,fixed:"left",render:(L,N)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:"13px"},children:[i.jsx(tm,{src:N.photo,icon:i.jsx(es,{}),size:40,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsxs("div",{children:[N.lastName," ",N.firstName," ",N.middleName||""]}),N.employeeNumber&&i.jsxs("div",{style:{fontSize:"11px",color:"#999",marginTop:2},children:["№ ",N.employeeNumber]})]})]})},{title:"Должность",dataIndex:"position",key:"position",width:180,ellipsis:!0},{title:"Регион",dataIndex:"region",key:"region",width:120,ellipsis:!0},{title:"Email",dataIndex:"email",key:"email",width:180,ellipsis:!0},{title:"Роли / Загрузка",key:"roles",width:200,render:(L,N)=>{var P,U;return i.jsxs(Fe,{direction:"vertical",size:2,style:{fontSize:"11px"},children:[i.jsxs(Fe,{size:4,wrap:!0,children:[N.isManager&&i.jsx(at,{color:"gold",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:"Руководитель"}),N.canMonitor&&i.jsxs(at,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["М: ",N.monitoringWorkload||0]}),N.canAppraise&&i.jsxs(at,{color:"purple",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["О: ",N.appraisalWorkload||0]}),!N.canMonitor&&!N.canAppraise&&!N.isManager&&i.jsx(at,{color:"default",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:"Общие"})]}),N.status&&i.jsx(at,{color:((P=R1.find(V=>V.value===N.status))==null?void 0:P.color)||"default",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:((U=R1.find(V=>V.value===N.status))==null?void 0:U.label)||N.status}),i.jsx(at,{color:N.isActive?"green":"red",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:N.isActive?"Активен":"Неактивен"})]})}},{title:"Права",key:"permissions",width:150,render:(L,N)=>i.jsxs(Fe,{wrap:!0,size:2,children:[N.permissions.slice(0,2).map(P=>i.jsx(at,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:ME[P].substring(0,15)},P)),N.permissions.length>2&&i.jsxs(at,{style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["+",N.permissions.length-2]})]})},{title:"Действия",key:"actions",width:100,fixed:"right",render:(L,N)=>i.jsxs(Fe,{size:4,children:[i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),onClick:()=>I(N),size:"small",style:{padding:"0 4px"}}),i.jsx(fo,{title:"Удалить сотрудника?",onConfirm:()=>O(N.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),size:"small",style:{padding:"0 4px"}})})]})}];return i.jsxs("div",{className:"employees-page",style:{padding:"8px"},children:[i.jsxs(Ge,{size:"small",style:{marginBottom:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[i.jsxs(NV,{level:4,style:{margin:0,fontSize:"16px"},children:[i.jsx(jT,{style:{marginRight:4}}),"Сотрудники"]}),i.jsxs(Fe,{size:8,split:i.jsx("span",{style:{color:"#d9d9d9"},children:"|"}),children:[i.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:["Всего: ",i.jsx("strong",{children:e.length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#52c41a"},children:["Активных: ",i.jsx("strong",{children:e.filter(L=>L.isActive).length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#1890ff"},children:["Мониторинг: ",i.jsx("strong",{children:e.filter(L=>L.canMonitor).length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#722ed1"},children:["Оценка: ",i.jsx("strong",{children:e.filter(L=>L.canAppraise).length})]})]}),i.jsxs(Fe,{size:8,split:i.jsx("span",{style:{color:"#d9d9d9"},children:"|"}),style:{marginTop:4},children:[i.jsxs("span",{style:{fontSize:"12px",color:"#52c41a"},children:["На работе:"," ",i.jsx("strong",{children:e.filter(L=>L.status==="working"||!L.status).length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#fa8c16"},children:["Больничный:"," ",i.jsx("strong",{children:e.filter(L=>L.status==="sick_leave").length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#1890ff"},children:["Отпуск: ",i.jsx("strong",{children:e.filter(L=>L.status==="vacation").length})]}),i.jsxs("span",{style:{fontSize:"12px",color:"#722ed1"},children:["Командировка:"," ",i.jsx("strong",{children:e.filter(L=>L.status==="business_trip").length})]})]})]}),i.jsxs(Fe,{size:4,children:[i.jsx(fo,{title:"Регенерировать базу сотрудников?",description:"Это создаст 30 сотрудников на каждый региональный центр. Существующие данные будут перезаписаны.",onConfirm:()=>{try{s(!0);const L=fr.regenerateEmployees();t(L),xd(),Ne.success(`Создано ${L.length} сотрудников`),s(!1)}catch(L){Ne.error("Ошибка регенерации сотрудников"),console.error(L),s(!1)}},okText:"Да",cancelText:"Нет",children:i.jsx(Be,{icon:i.jsx(JA,{}),loading:n,size:"small",children:"Регенерация"})}),i.jsx(Be,{icon:i.jsx(ec,{}),onClick:()=>h(!0),loading:n,size:"small",children:"Обновить"}),i.jsx(fo,{title:"Сгенерировать задачи для всех сотрудников?",description:"Это создаст 30-50 задач на каждого активного сотрудника. Большая часть будет выполнена, 1% просрочена.",onConfirm:()=>{try{dS(),Ne.success("Задачи успешно сгенерированы")}catch(L){Ne.error("Ошибка генерации задач"),console.error(L)}},okText:"Да",cancelText:"Нет",children:i.jsx(Be,{icon:i.jsx(ec,{}),size:"small",children:"Генерировать задачи"})}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:B,size:"small",children:"Добавить"})]})]}),i.jsx("div",{style:{marginTop:8},children:i.jsx(Re,{placeholder:"Поиск по ФИО, должности, региону, email...",prefix:i.jsx(Pa,{}),value:u,onChange:L=>g(L.target.value),allowClear:!0,size:"small",style:{maxWidth:400}})})]}),i.jsx(p2,{activeKey:f,onChange:p,size:"small",style:{marginBottom:8},children:Wi.map(L=>{const N=Object.values(v[L.code]||{}).flat(),P=N.filter(G=>G.isActive).length,U=N.filter(G=>G.canMonitor).length,V=N.filter(G=>G.canAppraise).length,W=(E[L.code]||{workloadPercent:0}).workloadPercent,z=D[L.code]||[];return i.jsxs(RV,{header:i.jsxs(Fe,{size:4,wrap:!0,style:{fontSize:"12px"},children:[i.jsxs("span",{style:{fontWeight:600,fontSize:"13px"},children:[L.code," - ",L.name]}),i.jsxs(at,{color:"green",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[P," акт."]}),i.jsxs(at,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[U," мон."]}),i.jsxs(at,{color:"purple",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:[V," оц."]}),i.jsxs(at,{color:"gold",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["Загрузка: ",W,"%"]})]}),children:[i.jsx(Ge,{size:"small",type:"inner",title:"Демо задачи (нагрузка)",style:{marginBottom:8},bodyStyle:{padding:8,maxHeight:220,overflowY:"auto"},children:i.jsx(Ba,{size:"small",dataSource:z,locale:{emptyText:"Демо задачи формируются автоматически"},renderItem:G=>i.jsx(Ba.Item,{style:{padding:"6px 0"},children:i.jsxs(Fe,{direction:"vertical",size:2,style:{width:"100%"},children:[i.jsxs(Fe,{size:4,wrap:!0,children:[i.jsx(at,{color:"geekblue",style:{margin:0},children:G.type||"Задача"}),i.jsx(at,{color:"gold",style:{margin:0},children:(G.status||"").toString()})]}),i.jsx("div",{style:{fontSize:12,fontWeight:500},children:G.title}),i.jsxs(Fe,{size:4,wrap:!0,style:{fontSize:11,color:"rgba(0,0,0,0.65)"},children:[G.currentAssigneeName&&i.jsxs("span",{children:["Исполнитель: ",G.currentAssigneeName]}),G.dueDate&&i.jsxs("span",{children:["Срок: ",We(G.dueDate).format("DD.MM.YYYY")]})]})]})},G.id)})}),L.cities.map(G=>{var k;const b=((k=v[L.code])==null?void 0:k[G])||[];return b.length===0?null:i.jsx(Ge,{size:"small",title:i.jsxs(Fe,{size:4,style:{fontSize:"12px"},children:[i.jsx(es,{}),i.jsx("span",{children:G}),i.jsx(at,{style:{margin:0,fontSize:"11px",padding:"0 4px"},children:b.length})]}),style:{marginBottom:8},bodyStyle:{padding:"8px"},children:i.jsx(nr,{columns:T,dataSource:b,rowKey:"id",pagination:{pageSize:10,size:"small",showSizeChanger:!1},size:"small",scroll:{x:"max-content"}})},G)})]},L.code)})}),i.jsx(Ge,{title:i.jsxs(Fe,{size:4,style:{fontSize:"13px"},children:[i.jsx("span",{children:"Все сотрудники"}),u&&i.jsxs(at,{color:"blue",style:{margin:0,fontSize:"11px",padding:"0 4px"},children:["Найдено: ",x.length," из ",e.length]})]}),size:"small",bodyStyle:{padding:"8px"},children:i.jsx(nr,{columns:T,dataSource:x,rowKey:"id",loading:n,pagination:{pageSize:20,showSizeChanger:!0,showTotal:L=>`Всего ${L} сотрудников`,size:"small",showQuickJumper:!0},size:"small",scroll:{x:"max-content"}})}),i.jsx(dr,{title:c?"Редактировать сотрудника":"Добавить сотрудника",open:o,onOk:M,onCancel:()=>A(!1),width:600,okText:"Сохранить",cancelText:"Отмена",children:i.jsxs(ne,{form:d,layout:"vertical",initialValues:{isActive:!0,permissions:[],canMonitor:!1,canAppraise:!1,isManager:!1,monitoringWorkload:0,appraisalWorkload:0,status:"working"},children:[i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"lastName",label:"Фамилия",rules:[{required:!0,message:"Введите фамилию"}],children:i.jsx(Re,{placeholder:"Иванов"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"firstName",label:"Имя",rules:[{required:!0,message:"Введите имя"}],children:i.jsx(Re,{placeholder:"Иван"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"middleName",label:"Отчество",children:i.jsx(Re,{placeholder:"Иванович"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"position",label:"Должность",rules:[{required:!0,message:"Введите должность"}],children:i.jsx(Re,{placeholder:"Менеджер по работе с залогами"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"region",label:"Регион",rules:[{required:!0,message:"Выберите регион"}],children:i.jsx(Ye,{placeholder:"Выберите регион",showSearch:!0,children:Wi.flatMap(L=>L.cities.map(N=>i.jsxs(F1,{value:N,children:[L.code," - ",N]},N)))})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"department",label:"Отдел",children:i.jsx(Re,{placeholder:"Отдел залогового обеспечения"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"phone",label:"Телефон",children:i.jsx(Re,{placeholder:"+7 (495) 123-45-67"})})})]}),i.jsx(ne.Item,{name:"email",label:"Email",children:i.jsx(Re,{type:"email",placeholder:"ivanov@bank.ru"})}),i.jsx(ne.Item,{name:"photo",label:"Фото сотрудника",children:i.jsx(Xi,{listType:"picture-card",maxCount:1,beforeUpload:()=>!1,onChange:S,accept:"image/*",children:((R=d.getFieldValue("photo"))==null?void 0:R.length)>=1?null:i.jsxs("div",{children:[i.jsx(Ii,{}),i.jsx("div",{style:{marginTop:8},children:"Загрузить"})]})})}),i.jsx(ne.Item,{name:"permissions",label:"Права доступа",rules:[{required:!0,message:"Выберите права доступа"}],children:i.jsx(Ye,{mode:"multiple",placeholder:"Выберите права доступа",style:{width:"100%"},children:Object.entries(ME).map(([L,N])=>i.jsx(F1,{value:L,children:N},L))})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"birthDate",label:"Дата рождения",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"employeeNumber",label:"Табельный номер",children:i.jsx(Re,{placeholder:"000001"})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"hireDate",label:"Дата приема на работу",children:i.jsx(Rr,{style:{width:"100%"},format:"DD.MM.YYYY"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"status",label:"Статус",initialValue:"working",children:i.jsx(Ye,{placeholder:"Выберите статус",children:R1.map(L=>i.jsx(F1,{value:L.value,children:i.jsx(at,{color:L.color,style:{margin:0},children:L.label})},L.value))})})})]}),i.jsx(ft,{gutter:16,children:i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"isActive",label:"Активен",valuePropName:"checked",children:i.jsx(Ni,{})})})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"canMonitor",label:"Может выполнять мониторинг",valuePropName:"checked",children:i.jsx(Ni,{})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"canAppraise",label:"Может выполнять оценку",valuePropName:"checked",children:i.jsx(Ni,{})})})]}),i.jsx(ft,{gutter:16,children:i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"isManager",label:"Руководитель региона",valuePropName:"checked",tooltip:"Назначить сотрудника руководителем региона",children:i.jsx(Ni,{})})})}),i.jsx(ne.Item,{name:"notes",label:"Примечания",children:i.jsx(FV,{rows:3,placeholder:"Дополнительная информация"})})]})})]})},{Title:PE,Text:QE}=mt,{TextArea:DV}=Re,jV=()=>{const e=uc(),[t,r]=K.useState([]),[a,n]=K.useState(null),[s,o]=K.useState(!1),[A,c]=K.useState(null),[l]=ne.useForm(),d=K.useCallback(()=>{try{const x=Sn.getDictionaries();r(x)}catch{Ne.error("Ошибка загрузки справочников")}},[]);K.useEffect(()=>{(async()=>{try{await Promise.all([Sn.syncCollateralAttributesFromUnified(),Sn.syncAttributeLevelsFromPublic()])}catch(v){console.warn("Ошибка синхронизации справочников:",v)}d()})()},[d]),K.useEffect(()=>{if(t.length===0)return;const x=e.search||window.location.search,v=e.hash||window.location.hash;console.log("ReferenceDataPage: location.search =",e.search),console.log("ReferenceDataPage: location.hash =",e.hash),console.log("ReferenceDataPage: window.location.search =",window.location.search),console.log("ReferenceDataPage: window.location.hash =",window.location.hash);let E;if(v.includes("?")){const B=v.split("?")[1];E=new URLSearchParams(B)}else x?E=new URLSearchParams(x):E=new URLSearchParams;const D=E.get("dict");if(console.log("ReferenceDataPage: dictId из URL =",D),console.log("ReferenceDataPage: доступно справочников =",t.length),console.log("ReferenceDataPage: ID справочников =",t.map(B=>B.id)),D){const B=t.find(I=>I.id===D);if(B){console.log("ReferenceDataPage: найден справочник по ID:",B.name),n(B);return}else console.warn(`Справочник с ID "${D}" не найден. Доступные справочники:`,t.map(I=>I.id))}!a&&t.length>0&&(console.log("ReferenceDataPage: параметр dict отсутствует, выбираем первый справочник"),n(t[0]))},[t,e.search,e.hash,a]);const f=K.useCallback(x=>{n(x),c(null),l.resetFields(),l.setFieldsValue({isActive:!0,sortOrder:x.items.length+1}),o(!0)},[l]),p=K.useCallback((x,v)=>{n(x),c(v),l.setFieldsValue({...v}),o(!0)},[l]),u=K.useCallback((x,v)=>{try{Sn.deleteItemFromDictionary(x.id,v),Ne.success("Элемент удален"),d()}catch{Ne.error("Ошибка удаления элемента")}},[d]),g=K.useCallback(async()=>{if(a)try{const x=await l.validateFields();A?(Sn.updateItemInDictionary(a.id,A.id,x),Ne.success("Элемент обновлен")):(Sn.addItemToDictionary(a.id,x),Ne.success("Элемент добавлен")),o(!1),d()}catch(x){console.error("Ошибка сохранения:",x)}},[d,a,A,l]),h=Ma.useCallback(x=>x.code==="attribute_levels"?[{title:"Код атрибута",dataIndex:"code",key:"code",width:200},{title:"Вид обеспечения",key:"level1",render:(v,E)=>{var D;return((D=E.metadata)==null?void 0:D.level1)||""},width:200},{title:"Тип обеспечения",key:"level2",render:(v,E)=>{var D;return((D=E.metadata)==null?void 0:D.level2)||""},width:200},{title:"Подтип обеспечения",key:"level3",render:(v,E)=>{var D;return((D=E.metadata)==null?void 0:D.level3)||""},width:220},{title:"Функциональная группа",key:"level4",render:(v,E)=>{var D;return((D=E.metadata)==null?void 0:D.level4)||""},width:240},{title:"Функциональная подгруппа",key:"level5",render:(v,E)=>{var D;return((D=E.metadata)==null?void 0:D.level5)||""},width:260},{title:"Действия",key:"actions",width:150,fixed:"right",render:(v,E)=>i.jsxs(Fe,{children:[i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),onClick:()=>p(x,E),size:"small",children:"Редактировать"}),i.jsx(fo,{title:"Удалить элемент?",onConfirm:()=>u(x,E.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),size:"small",children:"Удалить"})})]})}]:[{title:"Код",dataIndex:"code",key:"code",width:150},{title:"Наименование",dataIndex:"name",key:"name"},{title:"Описание",dataIndex:"description",key:"description",ellipsis:!0},{title:"Порядок сортировки",dataIndex:"sortOrder",key:"sortOrder",align:"center",width:120},{title:"Статус",dataIndex:"isActive",key:"isActive",align:"center",width:100,render:v=>i.jsx(at,{color:v?"green":"red",icon:v?i.jsx(On,{}):i.jsx(ZA,{}),children:v?"Активен":"Неактивен"})},{title:"Действия",key:"actions",width:150,fixed:"right",render:(v,E)=>i.jsxs(Fe,{children:[i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),onClick:()=>p(x,E),size:"small",children:"Редактировать"}),i.jsx(fo,{title:"Удалить элемент?",onConfirm:()=>u(x,E.id),okText:"Да",cancelText:"Нет",children:i.jsx(Be,{type:"link",danger:!0,icon:i.jsx(Bs,{}),size:"small",children:"Удалить"})})]})}],[p,u]),y=K.useMemo(()=>t.map(x=>({key:x.id,label:x.name,children:i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx(PE,{level:4,style:{margin:0},children:x.name}),x.description&&i.jsx(QE,{type:"secondary",children:x.description})]}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:()=>f(x),children:"Добавить элемент"})]}),i.jsx(nr,{columns:h(x),dataSource:x.items.sort((v,E)=>(v.sortOrder||0)-(E.sortOrder||0)),rowKey:"id",pagination:{pageSize:20},size:"small"})]})})),[t,h,f]);return i.jsxs("div",{className:"reference-data-page",children:[i.jsxs(Ge,{children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs(PE,{level:3,style:{margin:0},children:[i.jsx(JA,{})," Управление справочниками"]}),i.jsx(QE,{type:"secondary",style:{display:"block",marginTop:8},children:"Редактирование справочников, используемых во всех модулях системы"})]}),i.jsx(Ts,{items:y})]}),i.jsx(dr,{title:A?"Редактировать элемент справочника":"Добавить элемент в справочник",open:s,onOk:g,onCancel:()=>o(!1),width:600,okText:"Сохранить",cancelText:"Отмена",children:i.jsxs(ne,{form:l,layout:"vertical",initialValues:{isActive:!0,sortOrder:1},children:[i.jsx(ne.Item,{name:"code",label:"Код (опционально)",children:i.jsx(Re,{placeholder:"Код элемента"})}),i.jsx(ne.Item,{name:"name",label:"Наименование",rules:[{required:!0,message:"Введите наименование"}],children:i.jsx(Re,{placeholder:"Наименование элемента"})}),i.jsx(ne.Item,{name:"description",label:"Описание",children:i.jsx(DV,{rows:3,placeholder:"Описание элемента"})}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"sortOrder",label:"Порядок сортировки",children:i.jsx(fa,{min:0,style:{width:"100%"},placeholder:"Порядок"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"isActive",label:"Активен",valuePropName:"checked",children:i.jsx(Ni,{})})})]})]})})]})},{Title:LV,Text:ju}=mt,UV=()=>{const[e,t]=K.useState(!1),[r,a]=K.useState(null),[n,s]=K.useState([]);K.useEffect(()=>{o()},[]);const o=()=>{try{const u=localStorage.getItem("norm_hours_settings"),g=u?JSON.parse(u):null,h=Object.entries(Qc).map(([y,x])=>{const v={"Подготовка СЗ":"Подготовка одного заключения с одним объектом","Подготовка СЗ (2 объекта)":"Подготовка заключения с двумя объектами","Подготовка СЗ (АЗС)":"Подготовка заключения для АЗС",Оценка:"Проведение оценки объекта",Экспертиза:"Проведение экспертизы",Рецензия:"Рецензирование документов",ПРКК:"Проверка рисков",Мониторинг:"Мониторинг объекта",Осмотр:"Осмотр объекта","Проверка документов":"Проверка комплектности документов",Согласование:"Согласование документов","Контроль качества":"Контроль качества работы",Отчетность:"Подготовка отчетности",Прочее:"Прочие задачи"};return{key:y,functionName:y,normHours:(g==null?void 0:g[y])??x,description:v[y]||"—"}});s(h)}catch(u){console.error("Ошибка загрузки нормочасов:",u),Ne.error("Ошибка загрузки нормочасов")}},A=(u,g)=>{const h=n.map(y=>y.key===u?{...y,normHours:g}:y);s(h),a(null)},c=()=>{try{t(!0);const u={};n.forEach(g=>{u[g.key]=g.normHours}),localStorage.setItem("norm_hours_settings",JSON.stringify(u)),Ne.success("Нормочасы успешно сохранены")}catch(u){console.error("Ошибка сохранения нормочасов:",u),Ne.error("Ошибка сохранения нормочасов")}finally{t(!1)}},l=()=>{const u=n.map(g=>({...g,normHours:Qc[g.key]||2}));s(u),Ne.info("Нормочасы сброшены к значениям по умолчанию")},d=[{title:"Функция",dataIndex:"functionName",key:"functionName",width:250,render:u=>i.jsx(ju,{strong:!0,children:u})},{title:"Описание",dataIndex:"description",key:"description",ellipsis:!0},{title:"Нормочасы",dataIndex:"normHours",key:"normHours",width:200,align:"center",render:(u,g)=>r===g.key?i.jsxs(Fe,{children:[i.jsx(fa,{min:.5,max:100,step:.5,value:u,onChange:y=>{y!==null&&A(g.key,y)},onPressEnter:()=>a(null),autoFocus:!0,style:{width:100}}),i.jsx(ju,{type:"secondary",children:"часов"})]}):i.jsxs(Fe,{children:[i.jsxs(at,{color:"blue",style:{fontSize:"14px",padding:"4px 12px"},children:[u," ч"]}),i.jsx(Be,{type:"link",icon:i.jsx(Ri,{}),size:"small",onClick:()=>a(g.key)})]})},{title:"В рабочих днях",key:"workDays",width:150,align:"center",render:(u,g)=>{const h=(g.normHours/c2).toFixed(1);return i.jsxs(ju,{type:"secondary",children:[h," дн."]})}}],f=n.reduce((u,g)=>u+g.normHours,0),p=n.length>0?(f/n.length).toFixed(1):"0";return i.jsx("div",{className:"norm-hours-page",style:{padding:"24px"},children:i.jsxs(Ge,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsxs("div",{children:[i.jsxs(LV,{level:2,style:{margin:0},children:[i.jsx(zn,{style:{marginRight:8}}),"Нормочасы по функциям"]}),i.jsx(ju,{type:"secondary",style:{marginTop:8,display:"block"},children:"Управление нормочасами для расчета загрузки сотрудников"})]}),i.jsxs(Fe,{children:[i.jsx(Be,{icon:i.jsx(ec,{}),onClick:l,children:"Сбросить"}),i.jsx(Be,{type:"primary",icon:i.jsx(rm,{}),onClick:c,loading:e,children:"Сохранить"})]})]}),i.jsx(jt,{}),i.jsxs(ft,{gutter:16,style:{marginBottom:24},children:[i.jsx(Te,{xs:24,sm:8,children:i.jsx(yt,{title:"Рабочих часов в день",value:c2,suffix:"ч",valueStyle:{color:"#1890ff"}})}),i.jsx(Te,{xs:24,sm:8,children:i.jsx(yt,{title:"Рабочих дней в месяце",value:nS,suffix:"дн",valueStyle:{color:"#52c41a"}})}),i.jsx(Te,{xs:24,sm:8,children:i.jsx(yt,{title:"Рабочих часов в месяц",value:XA,suffix:"ч",valueStyle:{color:"#722ed1"}})})]}),i.jsxs(ft,{gutter:16,style:{marginBottom:24},children:[i.jsx(Te,{xs:24,sm:12,children:i.jsx(yt,{title:"Среднее нормочасов на функцию",value:p,suffix:"ч",valueStyle:{color:"#fa8c16"}})}),i.jsx(Te,{xs:24,sm:12,children:i.jsx(yt,{title:"Всего нормочасов (сумма)",value:f.toFixed(1),suffix:"ч",valueStyle:{color:"#eb2f96"}})})]}),i.jsx(jt,{}),i.jsx(nr,{columns:d,dataSource:n,pagination:!1,size:"middle",rowKey:"key"}),i.jsx("div",{style:{marginTop:24,padding:"16px",background:"#f5f5f5",borderRadius:"4px"},children:i.jsxs(ju,{type:"secondary",style:{fontSize:"12px"},children:[i.jsx("strong",{children:"Примечание:"})," Изменения вступят в силу после сохранения. Нормочасы используются для расчета загрузки сотрудников при генерации задач и в аналитике KPI. Для расчета загрузки используется формула:"," ",i.jsx("code",{children:"Загрузка (%) = (Сумма нормочасов задач в работе / Рабочих часов в месяц) × 100%"})]})})]})})},{Title:MV,Text:PV}=mt,QV=[{name:"totalPortfolioValue",label:"Общая стоимость портфеля, ₽",min:0,step:1e6},{name:"totalContracts",label:"Всего договоров",min:0,step:1},{name:"activeContracts",label:"Активных договоров",min:0,step:1},{name:"completedTasks",label:"Выполнено задач",min:0,step:1},{name:"pendingTasks",label:"В работе задач",min:0,step:1},{name:"overdueTasks",label:"Просрочено задач",min:0,step:1},{name:"totalConclusions",label:"Залоговых заключений",min:0,step:1},{name:"approvedConclusions",label:"Согласовано заключений",min:0,step:1},{name:"pendingConclusions",label:"На согласовании",min:0,step:1},{name:"totalObjects",label:"Объектов в реестре",min:0,step:1},{name:"totalInsurance",label:"Всего страховок",min:0,step:1},{name:"activeInsurance",label:"Активных страховок",min:0,step:1}],qV=[{name:"averageConclusionDays",label:"Средний срок подготовки СЗ, дней",min:0,step:.1},{name:"slaCompliance",label:"Выполнение SLA, %",min:0,max:150,step:1},{name:"currentWorkload",label:"Текущая загрузка, %",min:0,max:200,step:1},{name:"mboCompletionOverall",label:"MBO департамента, %",min:0,max:200,step:1}],KV=()=>{const[e]=ne.useForm(),[t,r]=K.useState(!0),[a,n]=K.useState(!1),[s,o]=K.useState(()=>em()),[A,c]=K.useState({});K.useEffect(()=>{const g=gV()??em(),h=oS(),y=cS(g,h||void 0);o(g),e.setFieldsValue({...y,workloadByPeriod:{...g.workloadByPeriod,...(h==null?void 0:h.workloadByPeriod)||{}}}),c(AS()),r(!1)},[e]);const l=K.useMemo(()=>Wi.map(g=>({key:g.code,code:g.code,name:g.name})),[]),d=(g,h)=>{c(y=>{const x={...y};return h===null||Number.isNaN(h)?delete x[g]:x[g]=h,x})},f=async()=>{try{const g=await e.validateFields();n(!0);const h={...g,workloadByPeriod:{...s.workloadByPeriod,...g.workloadByPeriod||{}}};fV(h),hV(A),Ne.success("Метрики KPI и MBO сохранены")}catch(g){g instanceof Error&&Ne.error(g.message)}finally{n(!1)}},p=()=>{e.setFieldsValue({...s,workloadByPeriod:{...s.workloadByPeriod}}),c({}),pV(),mV(),Ne.success("Корректировки сброшены")},u=[{title:"Региональный центр",dataIndex:"name",key:"name"},{title:"Целевой MBO, %",dataIndex:"code",key:"code",width:200,render:g=>i.jsx(fa,{min:0,max:200,value:A[g],onChange:h=>d(g,h),style:{width:"100%"}})}];return t?i.jsx("div",{className:"metrics-page__loading",children:"Загрузка метрик..."}):i.jsxs("div",{className:"metrics-page",children:[i.jsxs("div",{className:"metrics-page__header",children:[i.jsxs("div",{children:[i.jsx(MV,{level:3,style:{marginBottom:0},children:"Настройка KPI и MBO"}),i.jsx(PV,{type:"secondary",children:"Корректируйте значения, которые отображаются на странице KPI"})]}),i.jsxs(Fe,{children:[i.jsx(Be,{icon:i.jsx(LT,{}),onClick:p,children:"Сбросить"}),i.jsx(Be,{type:"primary",icon:i.jsx(rm,{}),onClick:f,loading:a,children:"Сохранить"})]})]}),i.jsx(Nr,{type:"info",showIcon:!0,style:{marginBottom:16},message:"Внесенные значения применяются как корректировки поверх фактических данных KPI."}),i.jsxs(ne,{layout:"vertical",form:e,children:[i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(rl,{}),i.jsx("span",{children:"Основные метрики"})]}),size:"small",className:"metrics-card",children:i.jsx(ft,{gutter:[16,16],children:QV.map(g=>i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(ne.Item,{name:g.name,label:g.label,rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:g.min??0,step:g.step??1,style:{width:"100%"}})})},g.name))})}),i.jsx(Ge,{title:i.jsxs(Fe,{children:[i.jsx(Hc,{}),i.jsx("span",{children:"Показатели SLA и загрузки"})]}),size:"small",className:"metrics-card",children:i.jsxs(ft,{gutter:[16,16],children:[qV.map(g=>i.jsx(Te,{xs:24,sm:12,lg:6,children:i.jsx(ne.Item,{name:g.name,label:g.label,rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:g.min??0,max:g.max,step:g.step??1,style:{width:"100%"}})})},g.name)),i.jsx(Te,{xs:24,sm:8,children:i.jsx(ne.Item,{name:["workloadByPeriod","last7Days"],label:"Загрузка за 7 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:0,max:200,style:{width:"100%"}})})}),i.jsx(Te,{xs:24,sm:8,children:i.jsx(ne.Item,{name:["workloadByPeriod","last30Days"],label:"Загрузка за 30 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:0,max:200,style:{width:"100%"}})})}),i.jsx(Te,{xs:24,sm:8,children:i.jsx(ne.Item,{name:["workloadByPeriod","last90Days"],label:"Загрузка за 90 дней, %",rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:0,max:200,style:{width:"100%"}})})})]})}),i.jsxs(Ge,{title:i.jsxs(Fe,{children:[i.jsx(ef,{}),i.jsx("span",{children:"Настройка MBO"})]}),size:"small",className:"metrics-card",children:[i.jsx(ft,{gutter:[16,16],children:i.jsx(Te,{xs:24,md:8,children:i.jsx(ne.Item,{name:"mboCompletionOverall",label:"MBO департамента, %",rules:[{required:!0,message:"Укажите значение"}],children:i.jsx(fa,{min:0,max:200,style:{width:"100%"}})})})}),i.jsx(jt,{}),i.jsx(nr,{columns:u,dataSource:l,pagination:!1,size:"small"})]})]})]})},Lu="cms_appraisal_companies";class HV{getCompanies(){const t=localStorage.getItem(Lu);return t?JSON.parse(t):[]}saveCompanies(t){try{localStorage.removeItem(Lu),localStorage.setItem(Lu,JSON.stringify(t))}catch(r){if(r.name==="QuotaExceededError"){console.warn("Очищаем localStorage для освобождения места...");const a=[];for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);s&&(s.includes("appraisal")||s.includes("cms_"))&&a.push(s)}a.forEach(n=>localStorage.removeItem(n)),localStorage.setItem(Lu,JSON.stringify(t))}else throw r}}getAll(){return this.getCompanies()}getById(t){return this.getCompanies().find(r=>r.id===t)}create(t){const r=this.getCompanies(),a={...t,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),this.saveCompanies(r),a}update(t,r){const a=this.getCompanies(),n=a.findIndex(o=>o.id===t);if(n===-1)return;const s={...a[n],...r,updatedAt:new Date().toISOString()};return a[n]=s,this.saveCompanies(a),s}delete(t){const r=this.getCompanies().filter(a=>a.id!==t);this.saveCompanies(r)}async loadFromExcelFile(t,r=20,a=!1){try{console.log("Парсинг Excel файла:",t.name,t.size);const n=await t.arrayBuffer();console.log("Размер данных:",n.byteLength);const s=ul(n,{type:"array"});if(console.log("Листы в файле:",s.SheetNames),s.SheetNames.length===0)return console.error("В файле нет листов"),0;const o=s.Sheets[s.SheetNames[0]];let A=0;const c=ui.decode_range(o["!ref"]||"A1");for(let h=0;h<Math.min(10,c.e.r+1);h++){const y=[];for(let v=0;v<=Math.min(20,c.e.c);v++){const E=ui.encode_cell({r:h,c:v}),D=o[E];D&&D.v&&y.push(String(D.v).toLowerCase())}const x=["наименование","инн","огрн","адрес","руководитель"];if(y.some(v=>x.some(E=>v.includes(E)))){A=h,console.log(`Найдена строка заголовка: ${h+1}`);break}}let l;if(A>0){const h=ui.encode_range({s:{r:A,c:0},e:c.e});o["!ref"]=h,l=ui.sheet_to_json(o,{defval:""}),o["!ref"]=ui.encode_range(c)}else l=ui.sheet_to_json(o,{defval:""});if(console.log("Всего строк в файле:",l.length),l.length===0)return console.warn("Файл не содержит данных"),0;if(l.length>0){const h=l[0];console.log("Ключи первой строки:",Object.keys(h)),console.log("Первая строка (первые 5 полей):",Object.entries(h).slice(0,5))}const d=l.slice(0,r);console.log(`Обрабатываем первые ${d.length} строк из ${l.length}`),a&&(console.log("Очищаем существующие данные перед импортом..."),localStorage.removeItem(Lu));const f=a?[]:this.getCompanies(),p=[];let u=0,g=0;for(const h of d)try{const y=Object.keys(h);let x="";for(const D of y){const B=h[D];if(B&&typeof B=="string"&&B.trim().length>3&&!/^\d+$/.test(B.trim())){x=B.trim();break}}if(x||(x=this.findFieldValue(h,["Наименование","наименование","Название","название","Компания","компания","Организация","организация"],"")),!x||x.trim().length===0){console.warn("Пропущена строка без названия:",y),g++;continue}const v={name:String(x).trim(),inn:this.findFieldValue(h,["ИНН","инн","ИНН/КПП","инн/кпп"],""),ogrn:this.findFieldValue(h,["ОГРН","огрн"],""),address:this.findFieldValue(h,["Адрес","адрес","Адрес регистрации","адрес регистрации"],""),phone:this.findFieldValue(h,["Телефон","телефон","Тел","тел"],""),email:this.findFieldValue(h,["Email","email","E-mail","e-mail"],""),website:this.findFieldValue(h,["Сайт","сайт","Website","website","Веб-сайт","веб-сайт","Адрес сайта","адрес сайта"],""),director:this.findFieldValue(h,["Руководитель","руководитель","Директор","директор","Генеральный директор","генеральный директор"],""),accreditationDate:this.findFieldValue(h,["Дата аккредитации","дата аккредитации"])?this.parseDate(this.findFieldValue(h,["Дата аккредитации","дата аккредитации"])):void 0,certificateExpiryDate:this.findFieldValue(h,["Срок действия сертификатов","срок действия сертификатов","Сертификаты до","сертификаты до"])?this.parseDate(this.findFieldValue(h,["Срок действия сертификатов","срок действия сертификатов","Сертификаты до","сертификаты до"])):void 0,insuranceExpiryDate:this.findFieldValue(h,["Срок действия страхования","срок действия страхования","Страхование до","страхование до"])?this.parseDate(this.findFieldValue(h,["Срок действия страхования","срок действия страхования","Страхование до","страхование до"])):void 0,sroMembership:this.parseBoolean(this.findFieldValue(h,["Членство в СРО","членство в сро","СРО","сро","Член СРО","член сро"],!1)),status:this.parseStatus(this.findFieldValue(h,["Статус","статус","Статус аккредитации","статус аккредитации"],"active")),notes:this.findFieldValue(h,["Примечания","примечания","Комментарий","комментарий"],"")};if(v.inn&&(v.inn=String(v.inn).split("/")[0].trim()),v.ogrn&&(v.ogrn=String(v.ogrn).trim()),v.address&&(v.address=String(v.address).trim()),v.phone&&(v.phone=String(v.phone).trim()),v.email&&(v.email=String(v.email).trim()),v.website&&(v.website=String(v.website).trim()),v.director&&(v.director=String(v.director).trim()),v.notes&&(v.notes=String(v.notes).trim()),f.some(D=>D.inn&&v.inn&&D.inn===v.inn||v.name&&D.name.toLowerCase()===v.name.toLowerCase()))g++;else{const D={...v,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};p.push(D),f.push(D),u++}}catch(y){console.warn("Ошибка обработки строки:",y==null?void 0:y.message),g++}if(p.length>0||a)try{const h=a?p:f,y=JSON.stringify(h),x=new Blob([y]).size;console.log(`Размер данных для сохранения: ${(x/1024).toFixed(2)} KB`),this.saveCompanies(h),console.log(`Сохранено ${h.length} компаний в localStorage`)}catch(h){console.error("Ошибка сохранения в localStorage:",h);try{console.warn("Пробуем очистить localStorage и сохранить только новые компании...");const y=[];for(let x=0;x<localStorage.length;x++){const v=localStorage.key(x);v&&v.includes("appraisal")&&y.push(v)}y.forEach(x=>{console.log(`Удаляем ключ: ${x}`),localStorage.removeItem(x)}),this.saveCompanies(p),console.log("Очищен localStorage, сохранены только новые компании")}catch(y){console.error("Критическая ошибка сохранения:",y);try{console.warn("Пробуем сохранить только первые 10 компаний...");for(let x=localStorage.length-1;x>=0;x--){const v=localStorage.key(x);v&&v.includes("appraisal")&&localStorage.removeItem(v)}this.saveCompanies(p.slice(0,10)),console.log("Сохранены только первые 10 компаний из-за ограничений localStorage")}catch(x){console.error("Невозможно сохранить данные:",x);let v=0;for(let E=0;E<localStorage.length;E++){const D=localStorage.key(E);if(D){const B=localStorage.getItem(D)||"";v+=D.length+B.length}}throw console.error(`Общий размер localStorage: ${(v/1024).toFixed(2)} KB`),x}}}return console.log(`Импорт завершен: импортировано ${u}, пропущено ${g}`),u}catch(n){throw console.error("Ошибка загрузки Excel файла:",n),console.error("Детали ошибки:",n.message,n.stack),n}}parseDate(t){if(t){if(typeof t=="number"){const r=new Date(1899,11,30);return new Date(r.getTime()+t*24*60*60*1e3).toISOString()}if(typeof t=="string"){const r=new Date(t);if(!isNaN(r.getTime()))return r.toISOString()}}}findFieldValue(t,r,a=""){for(const n of r)if(t[n]!==void 0&&t[n]!==null&&t[n]!=="")return t[n];return a}parseStatus(t){if(!t)return"active";const r=t.toLowerCase();return r.includes("актив")||r.includes("действ")?"active":r.includes("приостанов")||r.includes("приост")?"suspended":r.includes("отозван")||r.includes("аннул")?"revoked":"active"}parseBoolean(t){if(typeof t=="boolean")return t;if(typeof t=="string"){const r=t.toLowerCase().trim();return r==="да"||r==="yes"||r==="true"||r==="1"||r==="✓"}return typeof t=="number"?t===1:!1}createDemoCompanies(t=20){const r=this.getCompanies(),s=[{id:crypto.randomUUID(),name:'ООО "Оценка-Профи"',inn:"7701234567",ogrn:"1027701234567",address:"г. Москва, ул. Тверская, д. 10, офис 101",phone:"+7 (495) 123-45-67",email:"info@ocenka-profi.ru",director:"Иванов Иван Иванович",accreditationDate:"2020-01-15T00:00:00.000Z",certificateExpiryDate:"2025-12-31T00:00:00.000Z",insuranceExpiryDate:"2025-12-31T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Эксперт-Оценка"',inn:"7702345678",ogrn:"1027702345678",address:"г. Москва, ул. Ленинградская, д. 25, офис 205",phone:"+7 (495) 234-56-78",email:"contact@expert-ocenka.ru",director:"Петрова Мария Сергеевна",accreditationDate:"2019-03-20T00:00:00.000Z",certificateExpiryDate:"2025-06-30T00:00:00.000Z",insuranceExpiryDate:"2025-06-30T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Независимая оценка"',inn:"7703456789",ogrn:"1027703456789",address:"г. Санкт-Петербург, Невский пр., д. 50, офис 301",phone:"+7 (812) 345-67-89",email:"info@nezavisimaya-ocenka.ru",director:"Сидоров Петр Александрович",accreditationDate:"2021-05-10T00:00:00.000Z",certificateExpiryDate:"2026-05-10T00:00:00.000Z",insuranceExpiryDate:"2026-05-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Центр оценки недвижимости"',inn:"7704567890",ogrn:"1027704567890",address:"г. Москва, ул. Арбат, д. 15, офис 402",phone:"+7 (495) 456-78-90",email:"office@centr-ocenki.ru",director:"Козлова Анна Владимировна",accreditationDate:"2018-07-15T00:00:00.000Z",certificateExpiryDate:"2024-12-31T00:00:00.000Z",insuranceExpiryDate:"2024-12-31T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Альфа"',inn:"7705678901",ogrn:"1027705678901",address:"г. Екатеринбург, ул. Ленина, д. 30, офис 501",phone:"+7 (343) 567-89-01",email:"info@alfa-ocenka.ru",director:"Морозов Дмитрий Николаевич",accreditationDate:"2020-09-01T00:00:00.000Z",certificateExpiryDate:"2025-09-01T00:00:00.000Z",insuranceExpiryDate:"2025-09-01T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Профессиональная оценка"',inn:"7706789012",ogrn:"1027706789012",address:"г. Новосибирск, ул. Красный проспект, д. 20, офис 102",phone:"+7 (383) 678-90-12",email:"contact@prof-ocenka.ru",director:"Волкова Елена Игоревна",accreditationDate:"2019-11-20T00:00:00.000Z",certificateExpiryDate:"2025-11-20T00:00:00.000Z",insuranceExpiryDate:"2025-11-20T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Сервис"',inn:"7707890123",ogrn:"1027707890123",address:"г. Казань, ул. Баумана, д. 40, офис 203",phone:"+7 (843) 789-01-23",email:"info@ocenka-service.ru",director:"Новиков Сергей Викторович",accreditationDate:"2021-02-14T00:00:00.000Z",certificateExpiryDate:"2026-02-14T00:00:00.000Z",insuranceExpiryDate:"2026-02-14T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Экспертиза и оценка"',inn:"7708901234",ogrn:"1027708901234",address:"г. Нижний Новгород, ул. Покровка, д. 12, офис 304",phone:"+7 (831) 890-12-34",email:"office@expertiza-ocenka.ru",director:"Смирнова Ольга Петровна",accreditationDate:"2020-06-25T00:00:00.000Z",certificateExpiryDate:"2025-06-25T00:00:00.000Z",insuranceExpiryDate:"2025-06-25T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное агентство Бета"',inn:"7709012345",ogrn:"1027709012345",address:"г. Челябинск, ул. Кирова, д. 100, офис 405",phone:"+7 (351) 901-23-45",email:"info@beta-ocenka.ru",director:"Лебедев Андрей Михайлович",accreditationDate:"2019-08-10T00:00:00.000Z",certificateExpiryDate:"2025-08-10T00:00:00.000Z",insuranceExpiryDate:"2025-08-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Консалт"',inn:"7710123456",ogrn:"1027710123456",address:"г. Ростов-на-Дону, ул. Большая Садовая, д. 55, офис 506",phone:"+7 (863) 012-34-56",email:"contact@ocenka-konsult.ru",director:"Федорова Татьяна Алексеевна",accreditationDate:"2021-04-05T00:00:00.000Z",certificateExpiryDate:"2026-04-05T00:00:00.000Z",insuranceExpiryDate:"2026-04-05T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Стандарт-Оценка"',inn:"7711234567",ogrn:"1027711234567",address:"г. Уфа, ул. Ленина, д. 70, офис 107",phone:"+7 (347) 123-45-67",email:"info@standart-ocenka.ru",director:"Кузнецов Игорь Сергеевич",accreditationDate:"2020-10-12T00:00:00.000Z",certificateExpiryDate:"2025-10-12T00:00:00.000Z",insuranceExpiryDate:"2025-10-12T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная группа Гамма"',inn:"7712345678",ogrn:"1027712345678",address:"г. Воронеж, пр. Революции, д. 33, офис 208",phone:"+7 (473) 234-56-78",email:"office@gamma-ocenka.ru",director:"Орлова Наталья Дмитриевна",accreditationDate:"2019-12-18T00:00:00.000Z",certificateExpiryDate:"2025-12-18T00:00:00.000Z",insuranceExpiryDate:"2025-12-18T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Трейд"',inn:"7713456789",ogrn:"1027713456789",address:"г. Краснодар, ул. Красная, д. 22, офис 309",phone:"+7 (861) 345-67-89",email:"info@ocenka-trade.ru",director:"Соколов Владимир Анатольевич",accreditationDate:"2021-01-30T00:00:00.000Z",certificateExpiryDate:"2026-01-30T00:00:00.000Z",insuranceExpiryDate:"2026-01-30T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное бюро Дельта"',inn:"7714567890",ogrn:"1027714567890",address:"г. Самара, ул. Московское шоссе, д. 18, офис 410",phone:"+7 (846) 456-78-90",email:"contact@delta-ocenka.ru",director:"Попова Светлана Валерьевна",accreditationDate:"2020-03-22T00:00:00.000Z",certificateExpiryDate:"2025-03-22T00:00:00.000Z",insuranceExpiryDate:"2025-03-22T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Профессиональная экспертиза"',inn:"7715678901",ogrn:"1027715678901",address:"г. Омск, ул. Ленина, д. 45, офис 511",phone:"+7 (381) 567-89-01",email:"info@prof-expertiza.ru",director:"Васильев Роман Олегович",accreditationDate:"2019-07-08T00:00:00.000Z",certificateExpiryDate:"2025-07-08T00:00:00.000Z",insuranceExpiryDate:"2025-07-08T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Инвест"',inn:"7716789012",ogrn:"1027716789012",address:"г. Пермь, ул. Ленина, д. 60, офис 112",phone:"+7 (342) 678-90-12",email:"office@ocenka-invest.ru",director:"Михайлова Екатерина Сергеевна",accreditationDate:"2021-06-15T00:00:00.000Z",certificateExpiryDate:"2026-06-15T00:00:00.000Z",insuranceExpiryDate:"2026-06-15T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Эпсилон"',inn:"7717890123",ogrn:"1027717890123",address:"г. Волгоград, пр. Ленина, д. 28, офис 213",phone:"+7 (844) 789-01-23",email:"info@epsilon-ocenka.ru",director:"Тарасов Алексей Владимирович",accreditationDate:"2020-08-20T00:00:00.000Z",certificateExpiryDate:"2025-08-20T00:00:00.000Z",insuranceExpiryDate:"2025-08-20T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Плюс"',inn:"7718901234",ogrn:"1027718901234",address:"г. Красноярск, ул. Мира, д. 35, офис 314",phone:"+7 (391) 890-12-34",email:"contact@ocenka-plus.ru",director:"Романова Ирина Николаевна",accreditationDate:"2019-09-25T00:00:00.000Z",certificateExpiryDate:"2025-09-25T00:00:00.000Z",insuranceExpiryDate:"2025-09-25T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочное агентство Зета"',inn:"7719012345",ogrn:"1027719012345",address:"г. Саратов, ул. Московская, д. 50, офис 415",phone:"+7 (845) 901-23-45",email:"info@zeta-ocenka.ru",director:"Борисов Денис Игоревич",accreditationDate:"2021-03-10T00:00:00.000Z",certificateExpiryDate:"2026-03-10T00:00:00.000Z",insuranceExpiryDate:"2026-03-10T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценка-Менеджмент"',inn:"7720123456",ogrn:"1027720123456",address:"г. Тюмень, ул. Республики, д. 40, офис 516",phone:"+7 (345) 012-34-56",email:"office@ocenka-management.ru",director:"Григорьева Марина Александровна",accreditationDate:"2020-11-05T00:00:00.000Z",certificateExpiryDate:"2025-11-05T00:00:00.000Z",insuranceExpiryDate:"2025-11-05T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:crypto.randomUUID(),name:'ООО "Оценочная компания Эта"',inn:"7721234567",ogrn:"1027721234567",address:"г. Ижевск, ул. Пушкинская, д. 25, офис 117",phone:"+7 (341) 123-45-67",email:"info@eta-ocenka.ru",director:"Комаров Павел Викторович",accreditationDate:"2019-05-14T00:00:00.000Z",certificateExpiryDate:"2025-05-14T00:00:00.000Z",insuranceExpiryDate:"2025-05-14T00:00:00.000Z",sroMembership:!0,status:"active",notes:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}].slice(0,t).filter(o=>!r.some(A=>A.inn===o.inn||A.name.toLowerCase()===o.name.toLowerCase()));if(s.length>0){const o=[...r,...s];this.saveCompanies(o),console.log(`Создано ${s.length} демо-компаний`)}return s.length}async loadInitialData(t=!1,r=20){if(localStorage.getItem("cms_appraisal_companies_initial_data_loaded")==="true"&&!t)return console.log("Начальные данные уже загружены, пропускаем"),0;try{console.log("Начинаем загрузку начальных данных из reestr_otsenschikov.xls (лимит:",r,")...");const n=await fetch("/reestr_apr/reestr_otsenschikov.xls");if(!n.ok){console.warn("Файл reestr_otsenschikov.xls не найден, создаем демо-данные:",n.status,n.statusText);const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}const s=await n.blob();if(console.log("Файл загружен, размер:",s.size,"байт"),s.size===0){console.warn("Файл пуст, создаем демо-данные");const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}const o=new File([s],"reestr_otsenschikov.xls",{type:"application/vnd.ms-excel"}),A=await this.loadFromExcelFile(o,r);if(console.log("Импортировано компаний:",A),A===0){console.warn("Из файла ничего не импортировано, создаем демо-данные");const c=this.createDemoCompanies(r);return c>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),c}return A>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),A}catch(n){console.error("Ошибка загрузки начальных данных:",n),console.error("Детали ошибки:",n.message,n.stack),console.warn("Создаем демо-данные из-за ошибки загрузки файла");const s=this.createDemoCompanies(r);return s>0&&localStorage.setItem("cms_appraisal_companies_initial_data_loaded","true"),s}}}const Nc=new HV,{TextArea:qE}=Re,GV=({initialValues:e,onSubmit:t,onCancel:r,loading:a})=>{const[n]=ne.useForm();K.useEffect(()=>{e?n.setFieldsValue({...e,accreditationDate:e.accreditationDate?We(e.accreditationDate):null,certificateExpiryDate:e.certificateExpiryDate?We(e.certificateExpiryDate):null,insuranceExpiryDate:e.insuranceExpiryDate?We(e.insuranceExpiryDate):null}):(n.resetFields(),n.setFieldsValue({status:"active"}))},[e,n]);const s=o=>{const A={...o,accreditationDate:o.accreditationDate?o.accreditationDate.toISOString():null,certificateExpiryDate:o.certificateExpiryDate?o.certificateExpiryDate.toISOString():null,insuranceExpiryDate:o.insuranceExpiryDate?o.insuranceExpiryDate.toISOString():null};t(A)};return i.jsxs(ne,{form:n,layout:"vertical",onFinish:s,disabled:a,children:[i.jsxs(Ge,{title:"Основная информация",size:"small",style:{marginBottom:16},children:[i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"name",label:"Наименование компании",rules:[{required:!0,message:"Введите наименование компании"}],children:i.jsx(Re,{placeholder:'ООО "Название компании"'})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"status",label:"Статус аккредитации",children:i.jsxs(Ye,{children:[i.jsx(Ye.Option,{value:"active",children:"Активна"}),i.jsx(Ye.Option,{value:"suspended",children:"Приостановлена"}),i.jsx(Ye.Option,{value:"revoked",children:"Отозвана"})]})})})]}),i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"inn",label:"ИНН",children:i.jsx(Re,{placeholder:"1234567890"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"ogrn",label:"ОГРН",children:i.jsx(Re,{placeholder:"1234567890123"})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"accreditationDate",label:"Дата аккредитации",children:i.jsx(Rr,{style:{width:"100%"}})})})]})]}),i.jsx(Ge,{title:"Контактная информация",size:"small",style:{marginBottom:16},children:i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"address",label:"Адрес",children:i.jsx(qE,{rows:2,placeholder:"Полный адрес компании"})})}),i.jsxs(Te,{span:12,children:[i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"phone",label:"Телефон",children:i.jsx(Re,{placeholder:"+7 (999) 123-45-67"})})}),i.jsx(Te,{span:12,children:i.jsx(ne.Item,{name:"email",label:"Email",children:i.jsx(Re,{placeholder:"info@company.ru"})})})]}),i.jsx(ne.Item,{name:"website",label:"Сайт",children:i.jsx(Re,{placeholder:"https://www.company.ru"})})]})]})}),i.jsx(Ge,{title:"Сертификаты и страхование",size:"small",style:{marginBottom:16},children:i.jsxs(ft,{gutter:16,children:[i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"certificateExpiryDate",label:"Срок действия сертификатов",children:i.jsx(Rr,{style:{width:"100%"}})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"insuranceExpiryDate",label:"Срок действия страхования",children:i.jsx(Rr,{style:{width:"100%"}})})}),i.jsx(Te,{span:8,children:i.jsx(ne.Item,{name:"sroMembership",label:"Членство в СРО",valuePropName:"checked",children:i.jsx(tc,{children:"Да, является членом СРО"})})})]})}),i.jsx(Ge,{title:"Дополнительная информация",size:"small",style:{marginBottom:16},children:i.jsx(ne.Item,{name:"notes",label:"Примечания",children:i.jsx(qE,{rows:4,placeholder:"Дополнительная информация о компании"})})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx(Be,{onClick:r,children:"Отмена"}),i.jsx(Be,{type:"primary",htmlType:"submit",loading:a,children:"Сохранить"})]})]})},zV=()=>{const[e,t]=K.useState([]),[r,a]=K.useState(!1),[n,s]=K.useState(null),[o,A]=K.useState(!1),[c,l]=K.useState(""),[d,f]=K.useState(!1);K.useEffect(()=>{(async()=>{try{const S=await Nc.loadInitialData();S>0?Ne.success(`Загружено компаний из реестра: ${S}`):localStorage.getItem("cms_appraisal_companies_initial_data_loaded")!=="true"&&Ne.warning("Не удалось загрузить данные из файла. Проверьте консоль для деталей.")}catch(S){console.error("Ошибка инициализации данных:",S),Ne.error(`Ошибка загрузки данных: ${S.message||"Неизвестная ошибка"}`)}finally{p()}})()},[]);const p=()=>{t(Nc.getAll())},u=()=>{s(null),a(!0)},g=_=>{s(_),a(!0)},h=_=>{dr.confirm({title:"Удалить компанию?",content:"Это действие нельзя отменить",onOk:()=>{Nc.delete(_),Ne.success("Компания удалена"),p()}})},y=_=>{Ne.info(`Запрос документов для компании "${_.name}" отправлен`)},x=async _=>{f(!0);try{let S=0;if(_.name.endsWith(".xls")||_.name.endsWith(".xlsx"))return S=await Nc.loadFromExcelFile(_,20,!0),Ne.success(`Импортировано компаний: ${S}`),p(),f(!1),!1;const O=await _.text();let M=[];if(_.name.endsWith(".json"))M=JSON.parse(O);else{const T=O.split(`
`).filter(L=>L.trim()),R=T[0].split(/\t|,/).map(L=>L.trim());for(let L=1;L<T.length;L++){const N=T[L].split(/\t|,/).map(U=>U.trim()),P={};R.forEach((U,V)=>{const ie=N[V]||"";U.toLowerCase().includes("наименование")||U.toLowerCase().includes("название")?P.name=ie:U.toLowerCase().includes("инн")?P.inn=ie:U.toLowerCase().includes("огрн")?P.ogrn=ie:U.toLowerCase().includes("адрес")?P.address=ie:U.toLowerCase().includes("телефон")?P.phone=ie:U.toLowerCase().includes("email")?P.email=ie:U.toLowerCase().includes("руководитель")||U.toLowerCase().includes("директор")?P.director=ie:U.toLowerCase().includes("лицензия")?P.licenseNumber=ie:P[U]=ie}),P.name&&M.push({...P,status:"active"})}}for(const T of M)T.name&&(Nc.create(T),S++);Ne.success(`Импортировано компаний: ${S}`),p()}catch(S){console.error("Ошибка импорта:",S),Ne.error(`Ошибка импорта файла: ${S.message||"Неизвестная ошибка"}`)}finally{f(!1)}return!1},v={beforeUpload:_=>(x(_),!1),showUploadList:!1,accept:".csv,.tsv,.txt,.json,.xls,.xlsx"},E=_=>{A(!0);try{n?(Nc.update(n.id,_),Ne.success("Компания обновлена")):(Nc.create(_),Ne.success("Компания создана")),a(!1),p()}catch{Ne.error("Ошибка при сохранении")}finally{A(!1)}},D=K.useMemo(()=>{const _=c.trim().toLowerCase();return e.filter(S=>!_||[S.name,S.inn,S.address,S.phone,S.website].filter(Boolean).some(O=>String(O).toLowerCase().includes(_)))},[e,c]),B=K.useMemo(()=>{const _=D.length,S=D.filter(T=>T.status==="active").length,O=D.filter(T=>T.status==="suspended").length,M=D.filter(T=>T.status==="revoked").length;return{total:_,active:S,suspended:O,revoked:M}},[D]),I=[{title:"Наименование",dataIndex:"name",key:"name",width:250,render:(_,S)=>i.jsx(Be,{type:"link",onClick:()=>g(S),style:{padding:0},children:_})},{title:"ИНН",dataIndex:"inn",key:"inn",width:120},{title:"Адрес",dataIndex:"address",key:"address",ellipsis:!0,width:300},{title:"Сайт",dataIndex:"website",key:"website",width:200,render:_=>_?i.jsx("a",{href:_.startsWith("http")?_:`https://${_}`,target:"_blank",rel:"noopener noreferrer",children:_}):i.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Телефон",dataIndex:"phone",key:"phone",width:150},{title:"Срок действия сертификатов",dataIndex:"certificateExpiryDate",key:"certificateExpiryDate",width:180,render:_=>_?i.jsx("span",{children:new Date(_).toLocaleDateString("ru-RU")}):i.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Срок действия страхования",dataIndex:"insuranceExpiryDate",key:"insuranceExpiryDate",width:180,render:_=>_?i.jsx("span",{children:new Date(_).toLocaleDateString("ru-RU")}):i.jsx("span",{style:{color:"#999"},children:"—"})},{title:"Членство в СРО",dataIndex:"sroMembership",key:"sroMembership",width:140,render:_=>i.jsx(at,{color:_?"green":"default",children:_?"Да":"Нет"})},{title:"Статус",dataIndex:"status",key:"status",width:120,render:_=>{const S={active:"green",suspended:"orange",revoked:"red"},O={active:"Активна",suspended:"Приостановлена",revoked:"Отозвана"};return i.jsx(at,{color:S[_]||"default",children:O[_]||_})}},{title:"Действия",key:"actions",width:200,fixed:"right",render:(_,S)=>i.jsxs(Fe,{children:[i.jsx(Be,{icon:i.jsx(Qr,{}),size:"small",onClick:()=>y(S),title:"Запросить документы",children:"Документы"}),i.jsx(Be,{icon:i.jsx(Ri,{}),size:"small",onClick:()=>g(S),title:"Редактировать"}),i.jsx(Be,{icon:i.jsx(Bs,{}),size:"small",danger:!0,onClick:()=>h(S.id),title:"Удалить"})]})}];return i.jsxs("div",{className:"appraisal-companies-page",children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("h2",{style:{margin:0},children:"Реестр оценочных компаний"}),i.jsxs(Fe,{children:[i.jsx(Xi,{...v,children:i.jsx(Be,{icon:i.jsx(Ii,{}),loading:d,children:"Импорт из файла"})}),i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:u,children:"Добавить компанию"})]})]}),i.jsx(Re,{allowClear:!0,size:"large",placeholder:"Поиск по названию, ИНН, адресу, телефону, сайту...",prefix:i.jsx(Pa,{}),value:c,onChange:_=>l(_.target.value),style:{width:400,marginBottom:16}})]}),i.jsx(Ge,{style:{marginBottom:16},children:i.jsxs(ft,{gutter:[16,16],children:[i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Всего компаний",value:B.total})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Активных",value:B.active,valueStyle:{color:"#3f8600"}})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Приостановленных",value:B.suspended,valueStyle:{color:"#fa8c16"}})}),i.jsx(Te,{xs:24,sm:12,md:6,children:i.jsx(yt,{title:"Отозванных",value:B.revoked,valueStyle:{color:"#cf1322"}})})]})}),i.jsx(Ge,{bodyStyle:{padding:0},children:i.jsx(nr,{columns:I,dataSource:D,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:1400},onRow:_=>({onDoubleClick:()=>g(_)})})}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx("span",{children:n?"Редактирование компании":"Добавление компании"}),n&&i.jsx(at,{color:n.status==="active"?"green":"orange",children:n.status==="active"?"Активна":n.status==="suspended"?"Приостановлена":"Отозвана"})]}),open:r,onCancel:()=>a(!1),footer:null,width:"95%",style:{top:10},styles:{body:{maxHeight:"85vh",overflowY:"auto",padding:"16px"}},destroyOnClose:!0,children:i.jsx(GV,{initialValues:n||{},onSubmit:E,onCancel:()=>a(!1),loading:o})})]})},{Text:KE}=mt,$p=[{key:"registry",label:"Реестр объектов",description:"Карточки залогового имущества"},{key:"portfolio",label:"Залоговый портфель",description:"Данные портфеля сделок"},{key:"collateral-dossier",label:"Залоговое досье",description:"Информация по сделкам"},{key:"collateral-conclusions",label:"Заключения по залогу",description:"Заключения и оценки"},{key:"tasks",label:"Задачи",description:"Задачи и поручения"},{key:"kpi",label:"KPI",description:"Ключевые показатели эффективности"},{key:"reports",label:"Отчеты",description:"Аналитические отчеты"},{key:"insurance",label:"Страхование",description:"Страховые полисы"},{key:"fnp",label:"ФНП",description:"Данные ФНП сервиса"},{key:"analytics",label:"Аналитика",description:"Аналитические данные"},{key:"credit-risk",label:"Кредитные риски",description:"Данные по рискам"},{key:"appraisal",label:"Оценка",description:"Данные оценок"},{key:"cms-check",label:"CMS Check",description:"Данные дистанционных осмотров"},{key:"egrn",label:"ЕГРН",description:"Данные ЕГРН"},{key:"monitoring",label:"Мониторинг",description:"Планы мониторинга и переоценки"},{key:"employees",label:"Сотрудники",description:"Данные сотрудников и их права"},{key:"reference-data",label:"Справочники",description:"Все справочники системы"},{key:"settings",label:"Настройки",description:"Настройки приложения"}],VV=({visible:e,onClose:t})=>{const[r]=ne.useForm(),[a,n]=K.useState(!1),[s,o]=K.useState([]),A=()=>{const d=$p.map(f=>f.key);o(d),r.setFieldsValue({modules:d})},c=()=>{o([]),r.setFieldsValue({modules:[]})},l=async()=>{var d;try{const p=(await r.validateFields()).modules||[];if(p.length===0){Ne.warning("Выберите хотя бы один модуль для выгрузки");return}n(!0);const u={version:"1.0.0",exportDate:new Date().toISOString(),modules:{}};for(const v of p)try{switch(v){case"registry":{const E=await Yt.getExtendedCards();u.modules.registry=E;break}case"portfolio":u.modules.portfolio=[];break;case"collateral-dossier":u.modules["collateral-dossier"]=[];break;case"collateral-conclusions":u.modules["collateral-conclusions"]=[];break;case"tasks":u.modules.tasks=[];break;case"kpi":u.modules.kpi=[];break;case"reports":u.modules.reports=[];break;case"insurance":u.modules.insurance=[];break;case"fnp":u.modules.fnp=[];break;case"analytics":u.modules.analytics=[];break;case"credit-risk":u.modules["credit-risk"]=[];break;case"appraisal":u.modules.appraisal=[];break;case"cms-check":u.modules["cms-check"]=[];break;case"egrn":u.modules.egrn=[];break;case"monitoring":u.modules.monitoring=[];break;case"employees":{const E=fr.getEmployees();u.modules.employees=E;break}case"reference-data":{const E=Sn.getDictionaries();u.modules["reference-data"]=E;break}case"settings":{const E=await Yt.getSettings();u.modules.settings=E;break}}}catch(E){console.error(`Ошибка выгрузки модуля ${v}:`,E),Ne.warning(`Не удалось выгрузить данные модуля "${(d=$p.find(D=>D.key===v))==null?void 0:d.label}"`)}const g=JSON.stringify(u,null,2),h=new Blob([g],{type:"application/json"}),y=URL.createObjectURL(h),x=document.createElement("a");x.href=y,x.download=`cms-migration-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(y),Ne.success(`Данные успешно выгружены. Выбрано модулей: ${p.length}`),t()}catch(f){console.error("Ошибка выгрузки данных:",f),Ne.error("Ошибка при выгрузке данных")}finally{n(!1)}};return i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(In,{}),i.jsx("span",{children:"Выгрузить форму для миграции"})]}),open:e,onCancel:t,width:800,footer:[i.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),i.jsx(Be,{onClick:A,children:"Выбрать все"},"select-all"),i.jsx(Be,{onClick:c,children:"Снять все"},"deselect-all"),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),loading:a,onClick:l,children:"Выгрузить"},"export")],children:i.jsxs(ne,{form:r,layout:"vertical",children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx(KE,{type:"secondary",children:"Выберите модули CMS, данные из которых необходимо выгрузить. Будет создан JSON файл с данными выбранных модулей."})}),i.jsx(jt,{}),i.jsx(ne.Item,{name:"modules",rules:[{validator:(d,f)=>!f||f.length===0?Promise.reject(new Error("Выберите хотя бы один модуль")):Promise.resolve()}],children:i.jsx(tc.Group,{value:s,onChange:d=>{o(d),r.setFieldsValue({modules:d})},style:{width:"100%"},children:i.jsx(ft,{gutter:[16,16],children:$p.map(d=>i.jsx(Te,{xs:24,sm:12,lg:8,children:i.jsx(tc,{value:d.key,style:{width:"100%"},children:i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:500},children:d.label}),i.jsx("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:d.description})]})})},d.key))})})}),i.jsx("div",{style:{marginTop:16,padding:12,backgroundColor:"#f0f2f5",borderRadius:4},children:i.jsxs(KE,{type:"secondary",style:{fontSize:"12px"},children:["Выбрано модулей: ",i.jsx("strong",{children:s.length})," из ",$p.length]})})]})})},{Text:$V}=mt,{Dragger:YV}=Xi,WV=({visible:e,onClose:t})=>{const[r]=ne.useForm(),[a,n]=K.useState(!1),[s,o]=K.useState([]),[A,c]=K.useState([]),[l,d]=K.useState(!1),f=Hd(),p=h=>{o(h.fileList),c([]),d(!1)},u=async()=>{if(s.length===0){Ne.warning("Выберите файл для загрузки");return}const h=s[0].originFileObj;if(!h){Ne.error("Файл не найден");return}n(!0),c([]),d(!1);try{const y=await h.text();let x;try{x=JSON.parse(y)}catch{Ne.error("Неверный формат файла. Ожидается JSON файл."),n(!1);return}if(!x.modules||typeof x.modules!="object"){Ne.error("Неверная структура файла миграции"),n(!1);return}const v=[];for(const[B,I]of Object.entries(x.modules))try{let _=0;switch(B){case"registry":if(Array.isArray(I)){for(const O of I)await Yt.saveExtendedCard(O),_++;const S=await Yt.getExtendedCards();f(tf(S))}v.push({module:"Реестр объектов",success:!0,count:_});break;case"portfolio":v.push({module:"Залоговый портфель",success:!0,count:0});break;case"collateral-dossier":v.push({module:"Залоговое досье",success:!0,count:0});break;case"collateral-conclusions":v.push({module:"Заключения по залогу",success:!0,count:0});break;case"tasks":v.push({module:"Задачи",success:!0,count:0});break;case"kpi":v.push({module:"KPI",success:!0,count:0});break;case"reports":v.push({module:"Отчеты",success:!0,count:0});break;case"insurance":v.push({module:"Страхование",success:!0,count:0});break;case"fnp":v.push({module:"ФНП",success:!0,count:0});break;case"analytics":v.push({module:"Аналитика",success:!0,count:0});break;case"credit-risk":v.push({module:"Кредитные риски",success:!0,count:0});break;case"appraisal":v.push({module:"Оценка",success:!0,count:0});break;case"cms-check":v.push({module:"CMS Check",success:!0,count:0});break;case"egrn":v.push({module:"ЕГРН",success:!0,count:0});break;case"monitoring":v.push({module:"Мониторинг",success:!0,count:0});break;case"employees":if(Array.isArray(I))for(const S of I)try{if(S.id&&fr.getEmployeeById(S.id)){const{id:N,...P}=S;delete P.createdAt,delete P.updatedAt,fr.updateEmployee(N,P),_++;continue}const{id:O,createdAt:M,updatedAt:T,...R}=S;fr.addEmployee(R),_++}catch(O){console.error("Ошибка импорта сотрудника:",O)}v.push({module:"Сотрудники",success:!0,count:_});break;case"reference-data":if(Array.isArray(I)){const O=[...Sn.getDictionaries()];for(const M of I)try{const T=O.findIndex(R=>R.id===M.id);T!==-1?O[T]={...O[T],...M,updatedAt:new Date().toISOString()}:O.push({...M,updatedAt:new Date().toISOString()}),_++}catch(T){console.error("Ошибка импорта справочника:",T)}Sn.saveDictionaries(O)}v.push({module:"Справочники",success:!0,count:_});break;case"settings":I&&(await Yt.saveSettings(I),_=1),v.push({module:"Настройки",success:!0,count:_});break;default:v.push({module:B,success:!1,count:0,error:"Неизвестный модуль"})}}catch(_){v.push({module:B,success:!1,count:0,error:_.message||"Ошибка импорта"})}c(v),d(!0);const E=v.filter(B=>B.success).length,D=v.reduce((B,I)=>B+I.count,0);E===v.length?Ne.success(`Импорт завершен успешно. Импортировано записей: ${D}`):Ne.warning(`Импорт завершен с ошибками. Успешно: ${E}/${v.length}`)}catch(y){console.error("Ошибка импорта данных:",y),Ne.error(`Ошибка при импорте данных: ${y.message}`)}finally{n(!1)}},g=()=>{o([]),c([]),d(!1),r.resetFields(),t()};return i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Ii,{}),i.jsx("span",{children:"Загрузить форму"})]}),open:e,onCancel:g,width:700,footer:[i.jsx(Be,{onClick:g,children:l?"Закрыть":"Отмена"},"cancel"),...l?[]:[i.jsx(Be,{type:"primary",icon:i.jsx(Ii,{}),loading:a,onClick:u,disabled:s.length===0,children:"Загрузить данные"},"import")]],children:i.jsx(ne,{form:r,layout:"vertical",children:l?i.jsxs(i.Fragment,{children:[i.jsx(Nr,{message:"Импорт завершен",description:"Результаты импорта данных из файла миграции",type:A.every(h=>h.success)?"success":"warning",showIcon:!0,style:{marginBottom:16}}),i.jsx(Ba,{dataSource:A,renderItem:h=>i.jsx(Ba.Item,{children:i.jsx(Ba.Item.Meta,{avatar:h.success?i.jsx(On,{style:{color:"#52c41a",fontSize:"20px"}}):i.jsx(ZA,{style:{color:"#ff4d4f",fontSize:"20px"}}),title:i.jsxs(Fe,{children:[i.jsx("span",{children:h.module}),h.success&&h.count>0&&i.jsxs(at,{color:"blue",children:[h.count," записей"]}),!h.success&&i.jsx(at,{color:"red",children:"Ошибка"})]}),description:h.error||(h.success?"Успешно импортировано":"")})})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx($V,{type:"secondary",children:"Выберите JSON файл миграции для загрузки данных в модули CMS. Данные будут импортированы в соответствующие модули системы."})}),i.jsx(jt,{}),i.jsx(ne.Item,{name:"file",rules:[{required:!0,message:"Выберите файл для загрузки"}],children:i.jsxs(YV,{accept:".json",fileList:s,onChange:p,beforeUpload:()=>!1,maxCount:1,children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(l_,{})}),i.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файл сюда для загрузки"}),i.jsx("p",{className:"ant-upload-hint",children:"Поддерживается только формат JSON"})]})}),i.jsx(Nr,{message:"Внимание",description:"При импорте данных существующие записи могут быть перезаписаны. Рекомендуется создать резервную копию перед импортом.",type:"warning",showIcon:!0,style:{marginTop:16}})]})})})},XV=async e=>{const t=[];for(const o of e)try{switch(o){case"registry":{const A=await Yt.getExtendedCards();for(const c of A){const l={module:"registry",id:c.id,number:c.number,name:c.name,mainCategory:c.mainCategory,status:c.status,cbCode:c.cbCode,propertyType:c.propertyType,reference:c.reference,contractNumber:c.contractNumber,contractId:c.contractId,marketValue:c.marketValue,pledgeValue:c.pledgeValue,notes:c.notes,suspensiveConditions:c.suspensiveConditions,egrnStatementDate:c.egrnStatementDate,partners:JSON.stringify(c.partners||[]),address:JSON.stringify(c.address||{}),characteristics:JSON.stringify(c.characteristics||{}),classification:JSON.stringify(c.classification||{})};t.push(l)}break}case"employees":{const A=fr.getEmployees();for(const c of A){const l={module:"employees",id:c.id,firstName:c.firstName,lastName:c.lastName,middleName:c.middleName,email:c.email,phone:c.phone,position:c.position,department:c.department,region:c.region,permissions:JSON.stringify(c.permissions||[]),isActive:c.isActive};t.push(l)}break}case"reference-data":{const A=Sn.getDictionaries();for(const c of A){const l={module:"reference-data",id:c.id,code:c.code,name:c.name,description:c.description,items:JSON.stringify(c.items||[])};t.push(l)}break}case"cms-check":{const A=await Ca.getInspections();for(const c of A){const l={module:"cms-check",id:c.id,inspectionType:c.inspectionType,status:c.status,inspectionDate:c.inspectionDate instanceof Date?c.inspectionDate.toISOString():c.inspectionDate,collateralCardId:c.collateralCardId,collateralName:c.collateralName,inspectorId:c.inspectorId,inspectorName:c.inspectorName,condition:c.condition,photos:JSON.stringify(c.photos||[]),notes:c.notes,defects:JSON.stringify(c.defects||[]),recommendations:JSON.stringify(c.recommendations||[])};t.push(l)}break}}}catch(A){console.error(`Ошибка экспорта модуля ${o}:`,A)}if(t.length===0)throw new Error("Нет данных для экспорта");const r=ui.json_to_sheet(t),a=ui.book_new();ui.book_append_sheet(a,r,"Массовые изменения");const n=30;r["!cols"]=Object.keys(t[0]||{}).map(()=>({wch:n}));const s=`bulk-edit-${new Date().toISOString().split("T")[0]}.xlsx`;jh(a,s)},JV=async e=>{const t=await e.arrayBuffer(),r=ul(t,{type:"array"}),a=r.Sheets[r.SheetNames[0]];return ui.sheet_to_json(a).map(o=>{const A={module:o.Модуль||o.module||"",id:o.ID||o.id||void 0};return Object.keys(o).forEach(c=>{c!=="Модуль"&&c!=="module"&&c!=="ID"&&c!=="id"&&(A[c]=o[c])}),A})},ZV=async(e,t)=>{try{switch(e){case"registry":{const r=t.partners?JSON.parse(String(t.partners)):[],a=t.address?JSON.parse(String(t.address)):void 0,n=t.characteristics?JSON.parse(String(t.characteristics)):{},s=t.classification?JSON.parse(String(t.classification)):{},o={id:t.id||`card-${Date.now()}-${Math.random()}`,number:t.number||"",name:t.name||"",mainCategory:t.mainCategory||"real_estate",status:t.status||"editing",cbCode:t.cbCode||0,propertyType:t.propertyType,reference:t.reference,contractNumber:t.contractNumber,contractId:t.contractId,marketValue:t.marketValue,pledgeValue:t.pledgeValue,notes:t.notes,suspensiveConditions:t.suspensiveConditions,egrnStatementDate:t.egrnStatementDate,partners:r,address:a,characteristics:n,classification:s,documents:[],createdAt:t.id?new Date:new Date,updatedAt:new Date};if(t.id){const A=await Yt.getExtendedCardById(t.id);if(A)return o.createdAt=A.createdAt,await Yt.saveExtendedCard(o),{success:!0,created:!1}}return await Yt.saveExtendedCard(o),{success:!0,created:!0}}case"employees":{const r=t.permissions?JSON.parse(String(t.permissions)):[],a={firstName:t.firstName||"",lastName:t.lastName||"",middleName:t.middleName,email:t.email,phone:t.phone,position:t.position||"",department:t.department,region:t.region||"",permissions:r,isActive:t.isActive!==void 0?!!t.isActive:!0};return t.id&&fr.getEmployeeById(t.id)?(fr.updateEmployee(t.id,a),{success:!0,created:!1}):(fr.addEmployee(a),{success:!0,created:!0})}case"reference-data":{const r=t.items?JSON.parse(String(t.items)):[],a={id:t.id||`dict-${Date.now()}-${Math.random()}`,code:t.code||"",name:t.name||"",description:t.description,items:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},n=Sn.getDictionaries();if(t.id){const s=n.findIndex(o=>o.id===t.id);if(s!==-1)return n[s]={...n[s],...a,createdAt:n[s].createdAt},Sn.saveDictionaries(n),{success:!0,created:!1}}return n.push(a),Sn.saveDictionaries(n),{success:!0,created:!0}}case"cms-check":{const r=t.photos?JSON.parse(String(t.photos)):[],a=t.defects?JSON.parse(String(t.defects)):[],n=t.recommendations?JSON.parse(String(t.recommendations)):[],s=t.inspectionDate?typeof t.inspectionDate=="string"?new Date(t.inspectionDate):t.inspectionDate:new Date;if(t.id){const A=await Ca.getInspectionById(t.id);if(A){const c={inspectionType:t.inspectionType||A.inspectionType,status:t.status||A.status,inspectionDate:s,collateralCardId:t.collateralCardId||A.collateralCardId,collateralName:t.collateralName||A.collateralName,inspectorId:t.inspectorId||A.inspectorId,inspectorName:t.inspectorName||A.inspectorName,condition:t.condition||A.condition,photos:r,notes:t.notes||A.notes,defects:a,recommendations:n,updatedAt:new Date};return await Ca.updateInspection(t.id,c),{success:!0,created:!1}}}const o={inspectorType:"employee",history:[{id:`hist-${Date.now()}`,date:new Date,action:"created",user:"Система",userRole:"creator",comment:"Осмотр создан через массовое редактирование",status:t.status||"scheduled"}],inspectionType:t.inspectionType||"primary",status:t.status||"scheduled",inspectionDate:s,collateralCardId:t.collateralCardId||"",collateralName:t.collateralName||"",inspectorId:t.inspectorId||"",inspectorName:t.inspectorName||"",condition:t.condition||"good",photos:r,notes:t.notes,defects:a,recommendations:n};return await Ca.createInspection(o),{success:!0,created:!0}}default:return{success:!1,created:!1,error:`Неизвестный модуль: ${e}`}}}catch(r){return{success:!1,created:!1,error:String(r)}}},{Text:HE}=mt,GE=[{key:"registry",label:"Реестр объектов",description:"Карточки залогового имущества"},{key:"employees",label:"Сотрудники",description:"Данные сотрудников и их права"},{key:"reference-data",label:"Справочники",description:"Все справочники системы"},{key:"cms-check",label:"CMS Check",description:"Данные дистанционных осмотров"}],e$=({visible:e,onClose:t})=>{const[r]=ne.useForm(),[a,n]=K.useState(!1),[s,o]=K.useState([]),A=()=>{const d=GE.map(f=>f.key);o(d),r.setFieldsValue({modules:d})},c=()=>{o([]),r.setFieldsValue({modules:[]})},l=async()=>{try{const f=(await r.validateFields()).modules||[];if(f.length===0){Ne.warning("Выберите хотя бы один модуль для выгрузки");return}n(!0);try{await XV(f),Ne.success(`Данные успешно выгружены в XLS. Выбрано модулей: ${f.length}`),t()}catch(p){console.error("Ошибка выгрузки данных:",p),Ne.error(`Ошибка при выгрузке данных: ${p.message||"Неизвестная ошибка"}`)}}catch(d){console.error("Ошибка валидации:",d)}finally{n(!1)}};return i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(In,{}),i.jsx("span",{children:"Выгрузить данные для массовых изменений"})]}),open:e,onCancel:t,width:700,footer:[i.jsx(Be,{onClick:t,children:"Отмена"},"cancel"),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),loading:a,onClick:l,children:"Выгрузить в XLS"},"export")],children:i.jsxs(ne,{form:r,layout:"vertical",children:[i.jsx(HE,{type:"secondary",style:{display:"block",marginBottom:16},children:'Выберите модули, данные из которых необходимо выгрузить для массовых изменений. Все данные будут выгружены в один XLS файл с колонками "Модуль" и "ID".'}),i.jsx(jt,{}),i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"middle",children:[i.jsxs(Fe,{children:[i.jsx(Be,{size:"small",onClick:A,children:"Выбрать все"}),i.jsx(Be,{size:"small",onClick:c,children:"Снять все"})]}),i.jsx(ne.Item,{name:"modules",rules:[{required:!0,message:"Выберите хотя бы один модуль"}],children:i.jsx(tc.Group,{value:s,onChange:d=>{o(d),r.setFieldsValue({modules:d})},style:{width:"100%"},children:i.jsx(Fe,{direction:"vertical",style:{width:"100%"},children:GE.map(d=>i.jsx(tc,{value:d.key,children:i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:500},children:d.label}),i.jsx(HE,{type:"secondary",style:{fontSize:"12px"},children:d.description})]})},d.key))})})})]})]})})},{Text:k1}=mt,{Dragger:t$}=Xi,r$=({visible:e,onClose:t})=>{const[r,a]=K.useState(!1),[n,s]=K.useState([]),[o,A]=K.useState([]),[c,l]=K.useState(!1),[d,f]=K.useState(0),p=Hd(),u=y=>{s(y.fileList),A([]),l(!1),f(0)},g=async()=>{if(n.length===0){Ne.warning("Выберите XLS файл для загрузки");return}const y=n[0].originFileObj;if(!y){Ne.error("Файл не найден");return}if(!y.name.endsWith(".xlsx")&&!y.name.endsWith(".xls")){Ne.error("Неверный формат файла. Ожидается XLS или XLSX файл.");return}a(!0),A([]),l(!1),f(0);try{const x=await JV(y);if(x.length===0){Ne.warning("Файл не содержит данных"),a(!1);return}const v=new Map;x.forEach(O=>{v.has(O.module)||v.set(O.module,[]),v.get(O.module).push(O)});const E=[];let D=0;const B=x.length;for(const[O,M]of v.entries()){const T={module:O,updated:0,created:0,errors:[]};for(const R of M){try{const L=await ZV(O,R);L.success?L.created?T.created++:T.updated++:T.errors.push(L.error||"Неизвестная ошибка")}catch(L){T.errors.push(`Строка ${R.id||"без ID"}: ${L.message||String(L)}`)}D++,f(Math.round(D/B*100))}E.push(T)}try{const O=await Yt.getExtendedCards();p(tf(O))}catch(O){console.warn("Не удалось обновить Redux store:",O)}A(E),l(!0);const I=E.reduce((O,M)=>O+M.updated,0),_=E.reduce((O,M)=>O+M.created,0),S=E.reduce((O,M)=>O+M.errors.length,0);S===0?Ne.success(`Импорт завершен: обновлено ${I}, создано ${_} записей`):Ne.warning(`Импорт завершен с ошибками: обновлено ${I}, создано ${_}, ошибок: ${S}`)}catch(x){console.error("Ошибка импорта данных:",x),Ne.error(`Ошибка при импорте данных: ${x.message||"Неизвестная ошибка"}`)}finally{a(!1)}},h=y=>({registry:"Реестр объектов",employees:"Сотрудники","reference-data":"Справочники","cms-check":"CMS Check"})[y]||y;return i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Ii,{}),i.jsx("span",{children:"Загрузить файл массовых изменений"})]}),open:e,onCancel:t,width:800,footer:[i.jsx(Be,{onClick:t,disabled:r,children:c?"Закрыть":"Отмена"},"cancel"),i.jsx(Be,{type:"primary",icon:i.jsx(Ii,{}),loading:r,onClick:g,disabled:n.length===0||c,children:"Загрузить и применить изменения"},"import")],children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"large",children:[i.jsx(k1,{type:"secondary",children:'Загрузите XLS файл с массовыми изменениями. Файл должен содержать колонки "Модуль" и "ID". Записи с существующим ID будут обновлены, записи без ID или с новым ID будут созданы.'}),i.jsxs(t$,{fileList:n,onChange:u,beforeUpload:()=>!1,accept:".xlsx,.xls",maxCount:1,children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(l_,{})}),i.jsx("p",{className:"ant-upload-text",children:"Нажмите или перетащите файл для загрузки"}),i.jsx("p",{className:"ant-upload-hint",children:"Поддерживаются файлы формата XLS и XLSX"})]}),r&&i.jsxs("div",{children:[i.jsx(Qn,{percent:d,status:"active"}),i.jsx(k1,{type:"secondary",style:{display:"block",marginTop:8},children:"Обработка данных..."})]}),c&&o.length>0&&i.jsxs("div",{children:[i.jsx(jt,{children:"Результаты импорта"}),i.jsx(Ba,{dataSource:o,renderItem:y=>i.jsx(Ba.Item,{children:i.jsx(Ba.Item.Meta,{title:i.jsxs(Fe,{children:[i.jsx("span",{children:h(y.module)}),y.errors.length===0?i.jsx(at,{color:"success",icon:i.jsx(On,{}),children:"Успешно"}):i.jsx(at,{color:"warning",icon:i.jsx(ZA,{}),children:"С ошибками"})]}),description:i.jsxs(Fe,{direction:"vertical",size:"small",children:[i.jsxs(k1,{children:["Обновлено: ",i.jsx("strong",{children:y.updated}),", Создано: ",i.jsx("strong",{children:y.created})]}),y.errors.length>0&&i.jsx(Nr,{type:"warning",message:"Ошибки",description:i.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[y.errors.slice(0,5).map((x,v)=>i.jsx("li",{children:x},v)),y.errors.length>5&&i.jsxs("li",{children:["... и еще ",y.errors.length-5," ошибок"]})]}),style:{marginTop:8}})]})})})})]})]})})},{Title:Uu,Text:Fc}=mt,a$=()=>{const[e,t]=K.useState(!1),[r,a]=K.useState(!1),[n,s]=K.useState(!1),[o,A]=K.useState(!1),c=[{key:"migration",label:"Миграция данных",icon:i.jsx(UT,{}),children:i.jsxs("div",{children:[i.jsx(Fc,{type:"secondary",style:{display:"block",marginBottom:24},children:"Выгрузка и загрузка данных из различных модулей CMS для переноса между системами или создания резервных копий. Данные выгружаются в формате JSON."}),i.jsxs(ft,{gutter:[24,24],children:[i.jsx(Te,{xs:24,md:12,children:i.jsxs(Ge,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>t(!0),children:[i.jsx(In,{style:{fontSize:"64px",color:"#1890ff",marginBottom:16}}),i.jsx(Uu,{level:4,children:"Выгрузить форму для миграции"}),i.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Выберите модули CMS, данные из которых необходимо выгрузить. Будет создан JSON файл для миграции с выбранными данными."}),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),size:"large",style:{marginTop:16},onClick:l=>{l.stopPropagation(),t(!0)},children:"Выгрузить данные"})]})}),i.jsx(Te,{xs:24,md:12,children:i.jsxs(Ge,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>a(!0),children:[i.jsx(Ii,{style:{fontSize:"64px",color:"#52c41a",marginBottom:16}}),i.jsx(Uu,{level:4,children:"Загрузить форму"}),i.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Загрузите JSON файл миграции для заполнения модулей CMS данными. Данные будут импортированы в соответствующие модули системы."}),i.jsx(Be,{type:"primary",icon:i.jsx(Ii,{}),size:"large",style:{marginTop:16,backgroundColor:"#52c41a",borderColor:"#52c41a"},onClick:l=>{l.stopPropagation(),a(!0)},children:"Загрузить данные"})]})})]})]})},{key:"bulk-edit",label:"Массовые изменения",icon:i.jsx(Ri,{}),children:i.jsxs("div",{children:[i.jsx(Fc,{type:"secondary",style:{display:"block",marginBottom:24},children:'Выгрузка данных в XLS файл для массового редактирования. После внесения изменений в файл, загрузите его обратно для обновления данных в системе. Все модули выгружаются в один лист с колонками "Модуль" и "ID".'}),i.jsxs(ft,{gutter:[24,24],children:[i.jsx(Te,{xs:24,md:12,children:i.jsxs(Ge,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>s(!0),children:[i.jsx(In,{style:{fontSize:"64px",color:"#1890ff",marginBottom:16}}),i.jsx(Uu,{level:4,children:"Выгрузить данные для редактирования"}),i.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:'Выберите модули, данные из которых необходимо выгрузить в XLS файл. Все данные будут в одном файле с колонками "Модуль" и "ID".'}),i.jsx(Be,{type:"primary",icon:i.jsx(In,{}),size:"large",style:{marginTop:16},onClick:l=>{l.stopPropagation(),s(!0)},children:"Выгрузить в XLS"})]})}),i.jsx(Te,{xs:24,md:12,children:i.jsxs(Ge,{hoverable:!0,style:{height:"100%",textAlign:"center"},onClick:()=>A(!0),children:[i.jsx(Ii,{style:{fontSize:"64px",color:"#722ed1",marginBottom:16}}),i.jsx(Uu,{level:4,children:"Загрузить измененный файл"}),i.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Загрузите отредактированный XLS файл для применения изменений. Записи с существующим ID будут обновлены, новые записи будут созданы."}),i.jsx(Be,{type:"primary",icon:i.jsx(Ii,{}),size:"large",style:{marginTop:16,backgroundColor:"#722ed1",borderColor:"#722ed1"},onClick:l=>{l.stopPropagation(),A(!0)},children:"Загрузить и применить"})]})})]})]})}];return i.jsxs("div",{style:{padding:"24px"},children:[i.jsxs(Ge,{children:[i.jsxs("div",{style:{marginBottom:24},children:[i.jsxs(Uu,{level:2,style:{margin:0,display:"flex",alignItems:"center",gap:12},children:[i.jsx(Ii,{style:{fontSize:"32px",color:"#1890ff"}}),"Загрузка и выгрузка данных"]}),i.jsx(Fc,{type:"secondary",style:{display:"block",marginTop:8},children:"Миграция данных между системами и массовое редактирование данных через XLS файлы"})]}),i.jsx(jt,{}),i.jsx(Ts,{items:c,defaultActiveKey:"migration"})]}),i.jsx(VV,{visible:e,onClose:()=>t(!1)}),i.jsx(WV,{visible:r,onClose:()=>a(!1)}),i.jsx(e$,{visible:n,onClose:()=>s(!1)}),i.jsx(r$,{visible:o,onClose:()=>A(!1)})]})},n$=["[Volhin_N.A.]_Zalogovik._Vse_o_bankovskih_zalogah_(b-ok.org).pdf","Виды залогового имущества.docx","Отнесение фондированного обеспечения к категориям качества обеспечения.docx","Документы для мониторинга залога.xlsx","Нетиповые риски.docx","Примеры заданий.docx","Оценка АЗС.docx","Оценка АЗС — копия.docx","Оценка торговых центров.docx","BusinesStat АЗС.docx","Анализ наилучшего и наиболее эффективного использования.docx","Величина физического износа объектов капитального строительства.docx","Вопросы переоценки основных средств.docx","Исследование методов оценки акций коммерческого банка.docx","Корректировка на удаленность земельных участков Московской области.docx","Коэффициент перехода на вторичный рынок.docx","Лямбда сестра омеги.docx","Метод АВС при оценке автотранспортных средств.docx","Метод дисконтирования денежных потоков.docx","Метод рыночной экстракции.docx","МЕТОДИЧЕСКОЕ РУКОВОДСТВО ПО ОПРЕДЕЛЕНИЮ СТОИМОСТИ.docx","Норма дисконта.docx","Обзор и сравнение современных отечественных и зарубежных методов оценки технического состояния зданий и сооружений.docx","ОБОСНОВАНИЕ И РАСЧЕТ ПОПРАВКИ НА ПЛОЩАДЬ.docx","Определение прибыли предпринимателя.docx","Особенности оценки имущества в деле о банкротстве.docx","Переоценка основных средств.docx","Практические аспекты расчёта ставки дисконта.docx","Применение модели Ольсона в оценке стоимости компании.docx","Расчет коэффициента капитализации.docx","Расчет ставки дисконтирования кумулятивным методом.docx","Справедливая.docx","Средняя скидка на торг при покупке жилого дома в Московской области.docx","Средняя скидка на торг при покупке земельных участков в Московской области.docx","Статистическое исследование зависимости накопленного износа автомобиля от его эффективного возраста.docx","Техника группы инвестиций.docx","FSO1.pdf","FSO2.pdf","FSO3.pdf","FSO4.pdf","FSO5.pdf","FSO6.pdf","FSO7.pdf","FSO8.pdf","FSO9.pdf","FSO10.pdf","FSO11.pdf","ocenka_biznesa_voprosy_s_otvetami.pdf","ocenka_nedvizhimosti_predpriyatiya_voprosy_s_otvetami.pdf","ocenka_nedvizhimosti_voprosy_s_otvetami.pdf","ekon_ocenka_investiciy_voprosy_s_otvetami.pdf","korrektirovki-zemelnyh-udalennosti-morya-sochi.pdf","Land_heritage_Yaskevich.pdf","Method-recommendations-determining-cadastrial-value.pdf","O-merah-korrektirovke-kadastrovoy-otsenki-zemel-poseleniy.pdf","otsenka-rynochnoy-stoimosti-uchastkov-azs-servisa.pdf","otsenka-rynochnoy-stoimosti-zemelnogo-uchastka-aeroporta.pdf","report-colliers-spb.pdf","Report-Imuschestvo-ip.pdf","Report-Market-Value-Assessment-Report-for-the-Store.pdf","Report-stoimosti-magazina-remonta-bytovoy-tehniki.pdf","Report-valuation-market-value-shares-enterprise-OJSC-BYT.pdf","stavki-diskontirovaniya-RF-pri-sankciyah.pdf","Valuation-minority-stake-in-company-OJSC-MOROZ.pdf","Valuation-report-stake-in-CJSC-Reserve.pdf"];function fS(e){const t=e.toLowerCase();return e.startsWith("~$")||t.endsWith(".doc")||t.endsWith(".pptx")||t.endsWith(".rtf")?"unknown":t.endsWith(".pdf")?"pdf":t.endsWith(".docx")?"docx":t.endsWith(".xlsx")||t.endsWith(".xls")?"xlsx":"unknown"}async function pS(e=!1){try{await fi.loadFromStorage();const t="./",r=[];let a=!1;for(const n of n$){if(n.startsWith("~$"))continue;const s=fS(n);if(s==="unknown"){console.warn(`Пропущен файл с неизвестным типом: ${n}`);continue}const o=[`${t}VND/${n}`,`./VND/${n}`,`/VND/${n}`,`VND/${n}`,`${window.location.origin}${t}VND/${n}`,`${window.location.origin}/VND/${n}`];let A=null;for(const c of o)try{const l=await fetch(c);if(l.ok){A=l;break}}catch{continue}if(A&&A.ok)try{const c=await A.blob();let l="application/octet-stream";s==="pdf"?l="application/pdf":s==="docx"?l="application/vnd.openxmlformats-officedocument.wordprocessingml.document":s==="xlsx"&&(l="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const d=new File([c],n,{type:l}),p=fi.getIndexedDocuments().find(u=>u.documentName===d.name);if(e||!p){console.log(`Индексирую документ: ${d.name} (тип: ${s})`);const u=await fi.indexDocument(d);r.push(u),console.log(`✅ Документ проиндексирован: ${d.name} (${u.totalPages} страниц/листов, ${u.chunks.length} чанков)`),a=!0}else console.log(`Документ уже проиндексирован: ${d.name} (${p.totalPages} страниц/листов)`),r.push(p)}catch(c){console.error(`Ошибка индексации документа ${n}:`,c)}else console.warn(`Не удалось загрузить документ из VND: ${n}`)}if(a||e){console.log("🔨 Строю базу знаний из всех документов..."),await bn.buildFromDocuments();const n=bn.getCategories();console.log(`✅ База знаний построена: ${n.length} категорий, ${r.length} документов`)}else{await bn.loadFromStorage();const n=bn.getCategories();console.log(`📚 База знаний загружена из хранилища: ${n.length} категорий, ${r.length} документов`)}if(r.length===0){const n=fi.getIndexedDocuments();if(n.length>0)return console.log(`Найдены ранее проиндексированные документы в localStorage: ${n.length}`),n;console.info('Документы не найдены. Вы можете загрузить PDF документ вручную через кнопку "Загрузить документ"')}else console.log(`✅ Всего проиндексировано документов: ${r.length}`);return r.length>0?r:fi.getIndexedDocuments()}catch(t){console.error("Ошибка загрузки документов VND:",t);try{const r=fi.getIndexedDocuments();if(r.length>0)return console.log("Загружены ранее проиндексированные документы из localStorage"),r}catch(r){console.error("Ошибка загрузки из localStorage:",r)}return[]}}async function i$(e){if(fS(e.name)==="unknown")throw new Error(`Неподдерживаемый формат файла: ${e.name}. Поддерживаются: PDF, DOCX, XLSX`);const r=await fi.indexDocument(e);return await bn.buildFromDocuments(),r}async function s$(){return console.log("🔄 Начинаю принудительную переиндексацию всех документов..."),fi.clearIndexes(),bn.clear(),await pS(!0)}const uh="reference_chats";function qy(e){try{const t=e.map(a=>({...a,messages:a.messages.map(n=>({...n,timestamp:n.timestamp.toISOString()})),createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}));let r=JSON.stringify(t);if(r.length>4*1024*1024){const n=[...e].sort((o,A)=>A.updatedAt.getTime()-o.updatedAt.getTime()).slice(0,50),s=n.map(o=>({...o,messages:o.messages.map(A=>({...A,timestamp:A.timestamp.toISOString()})),createdAt:o.createdAt.toISOString(),updatedAt:o.updatedAt.toISOString()}));r=JSON.stringify(s),console.warn("localStorage переполнен, удалены старые чаты. Оставлено:",n.length)}localStorage.setItem(uh,r)}catch(t){if(t.name==="QuotaExceededError"||t.code===22)try{const a=[...e].sort((s,o)=>o.updatedAt.getTime()-s.updatedAt.getTime()).slice(0,20),n=a.map(s=>({...s,messages:s.messages.map(o=>({...o,timestamp:o.timestamp.toISOString()})),createdAt:s.createdAt.toISOString(),updatedAt:s.updatedAt.toISOString()}));localStorage.setItem(uh,JSON.stringify(n)),console.warn("localStorage переполнен, удалены старые чаты. Оставлено:",a.length)}catch(r){console.error("Критическая ошибка сохранения чатов, очищаем все:",r),localStorage.removeItem(uh)}else console.error("Ошибка сохранения чатов:",t)}}function h0(){try{const e=localStorage.getItem(uh);return e?JSON.parse(e).map(r=>({...r,messages:r.messages.map(a=>({...a,timestamp:new Date(a.timestamp)})),createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)})):[]}catch(e){return console.error("Ошибка загрузки чатов:",e),[]}}function o$(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function D1(e){const t={id:o$(),title:`Чат ${new Date().toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}`,messages:[],createdAt:new Date,updatedAt:new Date},r=h0();return r.unshift(t),qy(r),t}function OA(){return h0().sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime())}function zE(e){return h0().find(r=>r.id===e)||null}function A$(e,t){const r=h0(),a=r.findIndex(n=>n.id===e);a>=0&&(r[a]={...r[a],...t,updatedAt:new Date},qy(r))}function Mu(e,t){const r=h0(),a=r.find(n=>n.id===e);if(a){if(a.messages.push(t),a.updatedAt=new Date,a.messages.length===1&&t.role==="user"){const n=t.content.substring(0,50);a.title=n.length<t.content.length?`${n}...`:n}qy(r)}}const Ef=e=>(e||"").trim().toLowerCase().replace(/\s+/g," "),c$=[{key:"location",label:"Адрес/локация",placeholder:"Регион, город, улица"},{key:"areaSqm",label:"Площадь, м²",type:"number",placeholder:"Общая площадь"},{key:"floors",label:"Этажность/уровни",type:"number",placeholder:"Количество этажей"},{key:"condition",label:"Состояние",placeholder:"Например, требует ремонта/хорошее"}],l$=[{key:"location",label:"Местоположение",placeholder:"Регион, населённый пункт"},{key:"areaSqm",label:"Площадь, м²",type:"number",placeholder:"Общая площадь в кв. метрах"},{key:"landUse",label:"Назначение",placeholder:"С/х, коммерческое, ИЖС и т.д."},{key:"ownershipType",label:"Тип права",placeholder:"Собственность / аренда"}],d2=[{key:"baseLocation",label:"Место базирования",placeholder:"Город, склад, порт"},{key:"year",label:"Год выпуска",type:"number",placeholder:"Например, 2018"},{key:"condition",label:"Состояние",placeholder:"Отличное / рабочее / требует ремонта"},{key:"usageHours",label:"Наработка/пробег",placeholder:"км или моточасы"}],d$=[{key:"companyName",label:"Компания/эмитент",placeholder:"Наименование юрлица"},{key:"sharePercent",label:"Доля, %",type:"number",placeholder:"Размер доли"},{key:"financialSnapshot",label:"Финансовые показатели",placeholder:"Выручка, EBITDA, прибыль"},{key:"corporateRights",label:"Особенности прав",placeholder:"Преимущественные права, ограничения"}],u$=[{key:"debtor",label:"Должник / контрагент",placeholder:"Компания / физлицо"},{key:"claimAmount",label:"Сумма требования (₽)",type:"number",placeholder:"Номинал требования"},{key:"maturity",label:"Срок погашения",placeholder:"Дата или период"},{key:"claimType",label:"Тип права",placeholder:"Договор, уступка, ИС и т.д."}],hS=[{key:"storageLocation",label:"Место хранения",placeholder:"Склад, регион"},{key:"quantity",label:"Количество / объём",placeholder:"шт., т, м³ и т.д."},{key:"quality",label:"Качество/сорт",placeholder:"ГОСТ, сорт, бренд"},{key:"turnoverRate",label:"Оборачиваемость",placeholder:"Срок реализации / оборота"}],f$={real_estate:c$,land:l$,movable:d2,metals_goods:hS,equity:d$,rights:u$},mS=[{label:"Воздушные суда",group:"real_estate"},{label:"Все имущество залогодателя",group:"real_estate"},{label:"Доли в уставных капиталах обществ с ограниченной ответственностью",group:"equity"},{label:"Единый недвижимый комплекс",group:"real_estate"},{label:"Железнодорожный подвижной состав",group:"movable"},{label:"Здание",group:"real_estate"},{label:"Земельный участок",group:"land"},{label:"Имущественный комплекс",group:"real_estate"},{label:"Космические объекты",group:"real_estate"},{label:"Машино-место",group:"real_estate"},{label:"Машины и оборудование",group:"movable"},{label:"Наземные безрельсовые механические транспортные средства, прицепы",group:"movable"},{label:"Недвижимое имущество и права аренды недвижимого имущества",group:"real_estate"},{label:"Объект незавершенного строительства",group:"real_estate"},{label:"Плавучие сооружения",group:"movable"},{label:"Плавучие сооружения, не являющиеся судами",group:"movable"},{label:"Помещение",group:"real_estate"},{label:"Прочие движимые вещи",group:"movable"},{label:"Прочие имущественные Права требования",group:"rights"},{label:"Прочие ценные бумаги",group:"equity"},{label:"Сооружение",group:"real_estate"},{label:"Суда, используемые для иных целей",group:"real_estate"},{label:"Суда, используемые для перевозки грузов, и (или) буксировки, а также хранения грузов",group:"real_estate"},{label:"Суда, используемые для перевозки пассажиров и их багажа",group:"real_estate"},{label:"Суда, используемые для рыболовства",group:"real_estate"},{label:"Товары в обороте",group:"movable"},{label:"Эмиссионные ценные бумаги",group:"equity"}],p$=mS.reduce((e,t)=>(e[Ef(t.label)]=t.group,e),{}),h$={[Ef("Воздушные суда")]:d2,[Ef("Железнодорожный подвижной состав")]:d2,[Ef("Товары в обороте")]:hS},m$=mS.map(e=>({value:e.label,label:e.label})),g$=e=>{if(!e)return null;const t=Ef(e),r=p$[t]||(t.includes("земел")?"land":t.includes("ценн")||t.includes("акц")||t.includes("дол")?"equity":t.includes("прав")?"rights":t.includes("товар")?"metals_goods":t.includes("оборуд")||t.includes("транспорт")?"movable":"real_estate");return{assetGroup:r,fields:h$[t]||f$[r]}},j1=(e,t=[])=>{if(!e)return"";const r=t.reduce((n,s)=>(n[s.key]=s.label,n),{});return Object.entries(e).filter(([,n])=>n!=null&&n!=="").map(([n,s])=>`${r[n]||n}: ${s}`).join("; ")};function x$(e){const t=e.toLowerCase().trim();return["торговый центр","торгово-развлекательный центр","офисное здание","офисный центр","бизнес-центр","склад","складской комплекс","логистический центр","гостиница","отель","гостиничный комплекс","ресторан","кафе","производственное здание","производственный комплекс","арендная недвижимость","доходная недвижимость"].some(c=>t.includes(c))?{incomeApproach:75,incomeMethods:{dcf:60,directCapitalization:80,grossRentMultiplier:70},comparativeApproach:60,comparativeMethods:{salesComparison:70,marketExtraction:50},costApproach:30,costMethods:{replacementCost:40,reproductionCost:30,depreciation:20}}:["квартира","жилое помещение","жилой дом","дом","коттедж","таунхаус","апартаменты"].some(c=>t.includes(c))?{incomeApproach:40,incomeMethods:{dcf:30,directCapitalization:50,grossRentMultiplier:40},comparativeApproach:85,comparativeMethods:{salesComparison:90,marketExtraction:80},costApproach:25,costMethods:{replacementCost:30,reproductionCost:25,depreciation:20}}:["здание","помещение","сооружение","недвижимое имущество","имущественный комплекс","единый недвижимый комплекс","объект незавершенного строительства","машино-место"].some(c=>t.includes(c))?{incomeApproach:50,incomeMethods:{dcf:45,directCapitalization:55,grossRentMultiplier:50},comparativeApproach:75,comparativeMethods:{salesComparison:80,marketExtraction:70},costApproach:40,costMethods:{replacementCost:45,reproductionCost:40,depreciation:35}}:t.includes("земельный участок")||t.includes("земля")?{incomeApproach:30,incomeMethods:{dcf:25,directCapitalization:35,grossRentMultiplier:30},comparativeApproach:80,comparativeMethods:{salesComparison:85,marketExtraction:75},costApproach:20,costMethods:{replacementCost:25,reproductionCost:20,depreciation:15}}:["наземные безрельсовые механические транспортные средства","автомобиль","транспортное средство","железнодорожный подвижной состав","плавучие сооружения","судно","воздушные суда"].some(c=>t.includes(c))?{incomeApproach:20,incomeMethods:{dcf:15,directCapitalization:25,grossRentMultiplier:20},comparativeApproach:85,comparativeMethods:{salesComparison:90,marketExtraction:80},costApproach:60,costMethods:{replacementCost:70,reproductionCost:65,depreciation:55}}:["машины и оборудование","оборудование","техника","прочие движимые вещи"].some(c=>t.includes(c))?{incomeApproach:25,incomeMethods:{dcf:20,directCapitalization:30,grossRentMultiplier:25},comparativeApproach:60,comparativeMethods:{salesComparison:65,marketExtraction:55},costApproach:80,costMethods:{replacementCost:85,reproductionCost:80,depreciation:75}}:t.includes("товары в обороте")||t.includes("товар")?{incomeApproach:15,incomeMethods:{dcf:10,directCapitalization:20,grossRentMultiplier:15},comparativeApproach:70,comparativeMethods:{salesComparison:75,marketExtraction:65},costApproach:50,costMethods:{replacementCost:55,reproductionCost:50,depreciation:45}}:["доли в уставных капиталах","доли","акции","ценные бумаги","прочие ценные бумаги","эмиссионные ценные бумаги"].some(c=>t.includes(c))?{incomeApproach:70,incomeMethods:{dcf:75,directCapitalization:65,grossRentMultiplier:60},comparativeApproach:60,comparativeMethods:{salesComparison:65,marketExtraction:55},costApproach:20,costMethods:{replacementCost:25,reproductionCost:20,depreciation:15}}:t.includes("права требования")||t.includes("права")?{incomeApproach:60,incomeMethods:{dcf:65,directCapitalization:55,grossRentMultiplier:50},comparativeApproach:40,comparativeMethods:{salesComparison:45,marketExtraction:35},costApproach:10,costMethods:{replacementCost:15,reproductionCost:10,depreciation:5}}:t.includes("космические объекты")?{incomeApproach:30,incomeMethods:{dcf:25,directCapitalization:35,grossRentMultiplier:30},comparativeApproach:40,comparativeMethods:{salesComparison:45,marketExtraction:35},costApproach:85,costMethods:{replacementCost:90,reproductionCost:85,depreciation:80}}:null}function y$(e,t,r=!0){const a=x$(t);return a?r?{...e,...a,incomeMethods:{...e.incomeMethods,...a.incomeMethods},comparativeMethods:{...e.comparativeMethods,...a.comparativeMethods},costMethods:{...e.costMethods,...a.costMethods}}:a:e}const VE="9eea4a27-e364-4888-9f9f-b8fe79761974",v$="https://api.deepai.org/api/text2img",$E="",w$="https://api.openai.com/v1/images/generations",E$="https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-xl-base-1.0",YE="";class _${async generateImage(t,r,a){try{const n=this.buildImagePrompt(t,r,a);if(VE)try{return await this.generateWithDeepAI(n)}catch(s){console.warn("Ошибка генерации через DeepAI, пробуем альтернативы:",s)}return this.generatePlaceholderImage(t,r)}catch(n){return console.error("Ошибка генерации изображения:",n),this.generatePlaceholderImage(t,r)}}async generateWithDeepAI(t){try{const r=new FormData;r.append("text",t);const a=await fetch(v$,{method:"POST",headers:{"api-key":VE},body:r});if(!a.ok){const c=await a.text().catch(()=>"Unknown error");throw new Error(`DeepAI API error: ${a.status} - ${c}`)}const n=await a.json(),s=n.output_url||n.url;if(!s)throw new Error("DeepAI не вернул URL изображения");const o=await fetch(s);if(!o.ok)throw new Error(`Не удалось загрузить изображение: ${o.status}`);const A=await o.blob();return await this.blobToBase64(A)}catch(r){throw console.error("Ошибка генерации через DeepAI:",r),r}}async generateWithOpenAI(t){try{const r=await fetch(w$,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${$E}`},body:JSON.stringify({model:"dall-e-3",prompt:t,n:1,size:"1024x1024",quality:"standard"})});if(!r.ok)throw new Error(`OpenAI API error: ${r.status}`);const a=await r.json();if(a.data&&a.data.length>0&&a.data[0].url){const s=await(await fetch(a.data[0].url)).blob();return await this.blobToBase64(s)}throw new Error("Не удалось получить изображение от OpenAI")}catch(r){throw console.error("Ошибка генерации через OpenAI:",r),r}}async generateWithHuggingFace(t){try{const r=await fetch(E$,{method:"POST",headers:{Authorization:`Bearer ${YE}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:t,parameters:{num_inference_steps:20,guidance_scale:7.5}})});if(!r.ok)throw new Error(`Hugging Face API error: ${r.status}`);const a=await r.blob();return await this.blobToBase64(a)}catch(r){throw console.error("Ошибка генерации через Hugging Face:",r),r}}buildImagePrompt(t,r,a){let n="Professional real estate photography, high quality, realistic, detailed, ";if(r){const s=r.toLowerCase();s.includes("квартира")||s.includes("жилое")?n+="modern apartment interior, well-lit, clean, spacious rooms, ":s.includes("дом")||s.includes("коттедж")?n+="beautiful house exterior, modern architecture, well-maintained, ":s.includes("торговый центр")||s.includes("офис")?n+="commercial building, modern architecture, professional, ":s.includes("склад")||s.includes("производство")?n+="industrial building, warehouse, functional, ":s.includes("земельный участок")||s.includes("земля")?n+="land plot, aerial view, well-maintained, clear boundaries, ":s.includes("автомобиль")||s.includes("транспорт")?n+="professional car photography, clean vehicle, good condition, ":s.includes("оборудование")||s.includes("техника")?n+="industrial equipment, professional photography, clean, functional, ":n+="professional property photography, well-maintained, "}return a&&(n+=`located in ${a}, `),n+=t,n+=", professional real estate photography style, high resolution, detailed, realistic",n}generatePlaceholderImage(t,r){const a=`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#1890ff;stop-opacity:1" />
            <stop offset="50%" style="stop-color:#40a9ff;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#bae7ff;stop-opacity:1" />
          </linearGradient>
        </defs>
        <rect width="400" height="300" fill="url(#grad)"/>
        <text x="200" y="120" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">
          ${r||"Объект оценки"}
        </text>
        <text x="200" y="160" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle">
          ${t.substring(0,50)}${t.length>50?"...":""}
        </text>
        <text x="200" y="200" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
          Изображение будет сгенерировано ИИ
        </text>
      </svg>
    `.trim();return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(a)))}`}async blobToBase64(t){return new Promise((r,a)=>{const n=new FileReader;n.onloadend=()=>{typeof n.result=="string"?r(n.result):a(new Error("Не удалось конвертировать изображение в base64"))},n.onerror=a,n.readAsDataURL(t)})}}const WE=new _$,{TextArea:b$}=Re,{Title:Yp,Text:zt,Paragraph:C$}=mt,gS=Ma.memo(({message:e,onRating:t,onTopicClick:r})=>{const a=K.useMemo(()=>e.timestamp.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),[e.timestamp]);return i.jsx("div",{className:`reference-page__message reference-page__message--${e.role}`,children:i.jsxs("div",{className:"reference-page__message-content",children:[i.jsx(tm,{icon:e.role==="user"?i.jsx(es,{}):i.jsx(bf,{}),style:{backgroundColor:e.role==="user"?"#1890ff":"#52c41a",marginRight:12}}),i.jsxs("div",{className:"reference-page__message-text",children:[i.jsxs("div",{className:"reference-page__message-header",children:[i.jsx(zt,{strong:!0,children:e.role==="user"?"Вы":"ИИ Помощник"}),i.jsx(zt,{type:"secondary",style:{fontSize:12,marginLeft:8},children:a})]}),i.jsx(C$,{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.content}),e.sources&&e.sources.length>0&&i.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid #f0f0f0"},children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Источники:"}),i.jsx("div",{style:{marginTop:4},children:e.sources.map(n=>i.jsxs(at,{style:{marginTop:4,cursor:"pointer"},onClick:()=>r(n),children:[n.title," (стр. ",n.page,")"]},`${n.id||n.title}-${n.page}`))})]}),e.role==="assistant"&&i.jsx("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid #f0f0f0"},children:i.jsxs(Fe,{children:[i.jsx(Be,{type:"text",size:"small",icon:i.jsx(d_,{}),onClick:()=>t(e.id,"like"),style:{color:e.rating==="like"?"#52c41a":void 0},children:"Полезно"}),i.jsx(Be,{type:"text",size:"small",icon:i.jsx(u_,{}),onClick:()=>t(e.id,"dislike"),style:{color:e.rating==="dislike"?"#ff4d4f":void 0},children:"Не полезно"})]})})]})]})})});gS.displayName="MessageItem";const B$=()=>{var Za,ca;const[e,t]=K.useState([]),[r,a]=K.useState(""),[n,s]=K.useState(!1),[o,A]=K.useState(!1),[c,l]=K.useState(!0),[d,f]=K.useState(null),[p,u]=K.useState([]),[g,h]=K.useState([]),[y,x]=K.useState(null),[v,E]=K.useState(""),[D,B]=K.useState([]),[I,_]=K.useState(0),[S,O]=K.useState(1),[M,T]=K.useState(null),[R,L]=K.useState(!1),[N,P]=K.useState(null),[U,V]=K.useState([]),[ie,W]=K.useState(0),[z,G]=K.useState(null),[b,k]=K.useState(()=>{try{return localStorage.getItem("reference_training_mode")==="true"}catch{return!1}}),[j,q]=K.useState(!1),[Y,de]=K.useState(null),[ue,pe]=K.useState(!1),[ye]=ne.useForm(),[ve,ae]=K.useState(!1),[Ke,Ee]=K.useState(()=>{try{const ge=localStorage.getItem("ai_appraisal_skills");if(ge)return JSON.parse(ge)}catch{}return{incomeApproach:50,incomeMethods:{dcf:50,directCapitalization:50,grossRentMultiplier:50},comparativeApproach:50,comparativeMethods:{salesComparison:50,marketExtraction:50},costApproach:50,costMethods:{replacementCost:50,reproductionCost:50,depreciation:50}}}),[me,le]=K.useState(()=>{try{const ge=localStorage.getItem("ai_expertise_skills");if(ge)return JSON.parse(ge)}catch{}return{expertiseLevel:50,analysisLevel:50,responseBrevity:50,riskAnalysis:50,comments:50,detailLevel:50}});K.useEffect(()=>{try{localStorage.setItem("ai_appraisal_skills",JSON.stringify(Ke))}catch{}},[Ke]),K.useEffect(()=>{try{localStorage.setItem("ai_expertise_skills",JSON.stringify(me))}catch{}},[me]);const He=K.useMemo(()=>[{value:"real_estate",label:"Недвижимое имущество"},{value:"land",label:"Земельные участки"},{value:"movable",label:"Движимое имущество"},{value:"metals_goods",label:"Товары и материалы"},{value:"equity",label:"Доли, акции и ЦБ"},{value:"rights",label:"Права требования"}],[]),Ze=m$,$e=ne.useWatch("assetType",ye),et=K.useMemo(()=>g$($e),[$e]),je=K.useMemo(()=>(et==null?void 0:et.fields)??[],[et]),_e=et==null?void 0:et.assetGroup;K.useEffect(()=>{if($e&&j){const ge=Ze.find(H=>H.value===$e);ge&&Ee(H=>{const Ae=y$(H,ge.label,!1);return JSON.stringify(Ae)!==JSON.stringify(H)?(Ne.info(`Настройки эквалайзера автоматически применены для типа: ${ge.label}`),Ae):H})}},[$e,j,Ze]);const lt=K.useCallback(()=>{k(ge=>{const H=!ge;try{localStorage.setItem("reference_training_mode",String(H))}catch{}return H})},[]),Ct=K.useCallback(()=>{q(ge=>(ge&&(de(null),G(null)),!ge))},[]),bt=K.useCallback(()=>{var se;const ge=ye.getFieldsValue();if(!ge||!ge.assetGroup||!ge.assetType)return"";const H=[],Ae=((se=He.find(ce=>ce.value===(ge.assetGroup||_e)))==null?void 0:se.label)||ge.assetGroup||_e,te=Ze.find(ce=>ce.value===ge.assetType);Ae&&H.push(`Категория: ${Ae}`),H.push(`Тип актива: ${(te==null?void 0:te.label)||ge.assetType}`),ge.purpose&&H.push(`Цель: ${ge.purpose}`),ge.additionalFactors&&H.push(`Особенности: ${ge.additionalFactors}`);const Z=j1(ge.attributes,je);return Z&&H.push(`Ключевые параметры: ${Z}`),H.join(`
`)},[ye,He,_e,je,Ze]);K.useEffect(()=>{if(!b)return;let ge=!1;const H=6e4,Ae=async()=>{if(!ge)try{Va.analyzeDocuments(),Va.analyzeFeedback(),da.addExperienceFromDocuments(),da.updateExperienceFromCurrentData();const Z=Va.getLearningStats(),se=da.getEvolutionStats(),ce=da.getProgressToNextLevel();if(!ge&&se&&(O(se.level),T(ce)),!ge){const Se=Math.min(Z.patternsCount*5,30),Me=Z.averageSuccessRate*25,be=Math.min(Z.totalUsage/10,15),ke=Math.min(Z.insightsCount*2,10),Ue=se?Math.min(se.level*2,20):0;_(Math.round(Se+Me+be+ke+Ue)),W(Va.getCategorySkill("appraisal"))}}catch{}finally{ge||window.setTimeout(Ae,H)}},te=window.setTimeout(Ae,2e3);return()=>{ge=!0,window.clearTimeout(te)}},[b]);const[Et,Mt]=K.useState(()=>{const ge=localStorage.getItem("reference_chats_visible");return ge!==null?ge==="true":!0}),Dt=K.useRef(null),Bt=K.useRef(null),ut=K.useRef(new Map);K.useEffect(()=>{localStorage.setItem("reference_chats_visible",String(Et))},[Et]);const ct=Math.min(32+(S-1)*6,80),vr=({size:ge=ct})=>i.jsxs("svg",{width:ge,height:ge,viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{display:"inline-block",verticalAlign:"middle",marginRight:"8px",transition:"width 0.5s ease-in-out, height 0.5s ease-in-out"},className:"robot-icon",children:[i.jsx("rect",{x:"156",y:"120",width:"200",height:"180",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"8"}),i.jsx("rect",{x:"176",y:"160",width:"160",height:"100",rx:"10",fill:"#e6f7ff",stroke:"#40a9ff",strokeWidth:"4"}),i.jsx("circle",{cx:"216",cy:"200",r:"12",fill:"#1890ff"}),i.jsx("circle",{cx:"296",cy:"200",r:"12",fill:"#1890ff"}),i.jsx("circle",{cx:"216",cy:"200",r:"6",fill:"#fff"}),i.jsx("circle",{cx:"296",cy:"200",r:"6",fill:"#fff"}),i.jsx("rect",{x:"236",y:"240",width:"40",height:"8",rx:"4",fill:"#1890ff"}),i.jsx("circle",{cx:"256",cy:"100",r:"8",fill:"#ff4d4f"}),i.jsx("line",{x1:"256",y1:"100",x2:"256",y2:"120",stroke:"#1890ff",strokeWidth:"6",strokeLinecap:"round"}),i.jsx("rect",{x:"176",y:"300",width:"160",height:"120",rx:"15",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"8"}),i.jsx("rect",{x:"196",y:"320",width:"120",height:"60",rx:"8",fill:"#e6f7ff",stroke:"#40a9ff",strokeWidth:"3"}),i.jsx("circle",{cx:"226",cy:"350",r:"6",fill:"#52c41a"}),i.jsx("circle",{cx:"256",cy:"350",r:"6",fill:"#faad14"}),i.jsx("circle",{cx:"286",cy:"350",r:"6",fill:"#ff4d4f"}),i.jsx("rect",{x:"116",y:"320",width:"40",height:"80",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),i.jsx("rect",{x:"356",y:"320",width:"40",height:"80",rx:"20",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),i.jsx("circle",{cx:"136",cy:"420",r:"12",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"4"}),i.jsx("circle",{cx:"376",cy:"420",r:"12",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"4"}),i.jsx("rect",{x:"196",y:"420",width:"50",height:"60",rx:"10",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),i.jsx("rect",{x:"266",y:"420",width:"50",height:"60",rx:"10",fill:"#1890ff",stroke:"#0050b3",strokeWidth:"6"}),i.jsx("ellipse",{cx:"221",cy:"490",rx:"20",ry:"8",fill:"#0050b3"}),i.jsx("ellipse",{cx:"291",cy:"490",rx:"20",ry:"8",fill:"#0050b3"}),i.jsx("line",{x1:"196",y1:"340",x2:"316",y2:"340",stroke:"#40a9ff",strokeWidth:"2",opacity:"0.5"}),i.jsx("line",{x1:"196",y1:"360",x2:"316",y2:"360",stroke:"#40a9ff",strokeWidth:"2",opacity:"0.5"})]});K.useEffect(()=>{let ge=!0;return(async()=>{l(!0);try{Va.initialize(),da.initialize(),await Promise.all([fi.loadFromStorage(),bn.loadFromStorage()]);const Ae=bn.getCategories();if(ge&&h(Ae),ge){const Z=Va.getLearningStats(),se=da.getEvolutionStats(),ce=da.getProgressToNextLevel();se&&(O(se.level),T(ce));const Se=Math.min(Z.patternsCount*5,30),Me=Z.averageSuccessRate*25,be=Math.min(Z.totalUsage/10,15),ke=Math.min(Z.insightsCount*2,10),Ue=se?Math.min(se.level*2,20):0;_(Math.round(Se+Me+be+ke+Ue)),W(Va.getCategorySkill("appraisal")),l(!1)}(async()=>{try{A(!0),console.log("🔄 Загружаю документы из VND...");const Z=await pS(!1);if(!ge)return;if(u(Z),console.log(`✅ Загружено документов: ${Z.length}`),Ae.length===0&&Z.length>0&&(console.log("Категории пустые, перестраиваю базу знаний..."),await bn.buildFromDocuments(),ge)){const se=bn.getCategories();h(se)}Z.length>0&&setTimeout(()=>{ge&&(console.log("🧠 Анализирую документы для обучения модели..."),Va.analyzeDocuments(),da.addExperienceFromDocuments(),console.log("✅ Анализ документов завершен"))},100),Z.length>0&&ge&&Ne.success(`Загружено документов: ${Z.length}. База знаний готова к использованию.`)}catch{ge&&Ne.warning("Не удалось загрузить документы из VND. Вы можете загрузить их вручную.")}finally{ge&&A(!1)}})(),setTimeout(()=>{ge&&(Va.analyzeFeedback(),da.updateExperienceFromCurrentData())},50)}catch{ge&&l(!1)}})(),()=>{ge=!1}},[]),K.useEffect(()=>{if(!j)return;!ye.getFieldsValue().assetType&&Ze.length>0&&ye.setFieldsValue({assetType:Ze[0].value})},[j,ye,Ze]),K.useEffect(()=>{_e&&ye.getFieldValue("assetGroup")!==_e&&ye.setFieldsValue({assetGroup:_e})},[_e,ye]),K.useEffect(()=>{const ge=OA();V(ge)},[]),K.useEffect(()=>{if(N){const ge=zE(N);ge&&t(ge.messages.map(H=>({...H,timestamp:H.timestamp instanceof Date?H.timestamp:new Date(H.timestamp)})))}else t([])},[N]),K.useEffect(()=>{N&&e.length>0&&zE(N)&&(A$(N,{messages:e}),V(OA()))},[e,N]);const Rt=K.useCallback(()=>{const ge=document.querySelector(".reference-page__messages");ge&&requestAnimationFrame(()=>{ge.scrollTo({top:ge.scrollHeight,behavior:"smooth"})}),Dt.current&&requestAnimationFrame(()=>{var H;(H=Dt.current)==null||H.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})},[]);K.useEffect(()=>{e.length>0&&setTimeout(()=>{Rt()},100)},[e.length,Rt]),K.useEffect(()=>{if(!c){f(null);return}f(10);const ge=window.setInterval(()=>{f(H=>H===null?null:H<=0?0:H-1)},1e3);return()=>{window.clearInterval(ge),f(null)}},[c]);const Gr=K.useCallback((ge,H)=>{const Ae=ge.trim().toLowerCase();if(!Ae)return[];const te=`${Ae}::${H}`,Z=ut.current.get(te),se=Date.now();if(Z&&se-Z.timestamp<5*60*1e3)return Z.result;const ce=bn.search(ge,H);return ut.current.set(te,{result:ce,timestamp:se}),ce},[]);K.useEffect(()=>{const ge=v.trim();if(ge.length<=2){B([]);return}const H=setTimeout(()=>{try{const Ae=Gr(ge,10);B(Ae)}catch{B([])}},400);return()=>clearTimeout(H)},[v,Gr]);const pr=K.useMemo(()=>g.map(ge=>ge.name).join(", "),[g]),vt=K.useCallback(async(ge,H=[],Ae)=>{var Me;const te=ge.toLowerCase(),Z=Gr(ge,5);let se="",ce=[],Se="";if(Z.length>0){const be=[];for(const ke of Z)be.push(`Тема: ${ke.title}
Содержание: ${ke.content}
Страница: ${ke.page}`);Se=be.join(`

---

`),ce=Z}Ae&&(Se=`${Se||""}

[Дополнительный контекст задания]
${Ae}`);try{if(H.length>0){const be=H.slice(-10).map(ze=>({role:ze.role,content:ze.content}));be.push({role:"user",content:ge});let ke=Se||`База знаний содержит информацию о банковских залогах, ипотеке, оценке имущества, LTV, договорах залога, нормативных требованиях и регистрации залогов. Доступные категории: ${pr}.`;const Ue=`

Настройки режима экспертизы:
- Уровень экспертизы: ${me.expertiseLevel}%
- Уровень анализа: ${me.analysisLevel}%
- Краткость ответов: ${me.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${me.riskAnalysis}%
- Комментарии: ${me.comments}%
- Детализация: ${me.detailLevel}%

Учитывай эти настройки при формировании ответа.`;ke+=Ue,se=await kc.chat(be,ke),setTimeout(()=>{da.addPassiveExperience(ge,se.length)},0)}else if(Se){const be=`

Настройки режима экспертизы:
- Уровень экспертизы: ${me.expertiseLevel}%
- Уровень анализа: ${me.analysisLevel}%
- Краткость ответов: ${me.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${me.riskAnalysis}%
- Комментарии: ${me.comments}%
- Детализация: ${me.detailLevel}%

Учитывай эти настройки при формировании ответа.`;se=await kc.generateResponse(ge,Se+be),setTimeout(()=>{da.addPassiveExperience(ge,se.length)},0)}else if(te.includes("привет")||te.includes("здравствуй")){const be='Поприветствуй пользователя и расскажи, что ты эксперт по банковским залогам и можешь помочь с вопросами об ипотеке, оценке, LTV, договорах залога и других аспектах залогового кредитования. База знаний основана на справочной литературе "Залоговik. Все о банковских залогах".',ke=`

Настройки режима экспертизы:
- Уровень экспертизы: ${me.expertiseLevel}%
- Уровень анализа: ${me.analysisLevel}%
- Краткость ответов: ${me.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${me.riskAnalysis}%
- Комментарии: ${me.comments}%
- Детализация: ${me.detailLevel}%

Учитывай эти настройки при формировании ответа.`;se=await kc.chat([{role:"user",content:be+ke}],ke),Se="Приветствие"}else{let be=`База знаний содержит информацию о банковских залогах, ипотеке, оценке имущества, LTV, договорах залога, нормативных требованиях и регистрации залогов. Доступные категории: ${pr}.`;const ke=`

Настройки режима экспертизы:
- Уровень экспертизы: ${me.expertiseLevel}%
- Уровень анализа: ${me.analysisLevel}%
- Краткость ответов: ${me.responseBrevity}% (0% = подробно, 100% = кратко)
- Анализ рисков: ${me.riskAnalysis}%
- Комментарии: ${me.comments}%
- Детализация: ${me.detailLevel}%

Учитывай эти настройки при формировании ответа.`;be+=ke,se=await kc.generateResponse(ge,be),Se=be}}catch(be){const ke=be instanceof Error?be.message:String(be);if(ke.includes("API ключ")||ke.includes("401")||ke.includes("403"))throw new Error("Проблема с доступом к AI сервису. Проверьте настройки API.");if(Z.length>0){se=`На основе справочной литературы по банковским залогам:

`;const Ue=new Map;for(const ze of Z)Ue.has(ze.category)||Ue.set(ze.category,[]),Ue.get(ze.category).push(ze);for(const[ze,dt]of Ue.entries()){const pt=((Me=g.find(st=>st.id===ze))==null?void 0:Me.name)||ze;se+=`**${pt}**

`;for(const st of dt.slice(0,2))se+=`*${st.title}*

${st.content.slice(0,300)}...

`}Se=Se||"Локальная генерация"}else se="Извините, произошла ошибка при обращении к ИИ. Попробуйте переформулировать вопрос или использовать поиск по категориям.",Se="Ошибка"}return{content:se,sources:ce,context:Se}},[pr,g,Gr,me]),Tr=K.useCallback(async()=>{if(!r.trim()||n)return;let ge=N;ge||(ge=D1().id,P(ge),V(OA()));const H={id:`user-${Date.now()}`,role:"user",content:r.trim(),timestamp:new Date};ge&&Mu(ge,H),t(te=>[...te,H]);const Ae=r.trim();a(""),s(!0);try{const te=e.map(be=>({id:be.id,role:be.role,content:be.content,timestamp:be.timestamp instanceof Date?be.timestamp:new Date(be.timestamp)})),Z=j?bt():"",{content:se,sources:ce,context:Se}=await vt(Ae,te,Z||void 0),Me={id:`ai-${Date.now()}`,role:"assistant",content:se,timestamp:new Date,sources:ce.length>0?ce:void 0,context:Se};ge&&(Mu(ge,Me),V(OA())),t(be=>[...be,Me]),setTimeout(()=>{Rt()},150)}catch(te){const Z=te instanceof Error?te.message:String(te);console.error("Ошибка генерации ответа:",te),console.error("Детали ошибки:",{message:Z,question:Ae,stack:te instanceof Error?te.stack:void 0});let se="Извините, произошла ошибка при генерации ответа. ";Z.includes("API ключ")||Z.includes("401")||Z.includes("403")?se+="Проблема с доступом к AI сервису. Проверьте настройки API ключа.":Z.includes("network")||Z.includes("fetch")||Z.includes("NetworkError")||Z.includes("Failed to fetch")?se+="Проблема с подключением к интернету. Проверьте соединение и попробуйте еще раз.":Z.includes("timeout")||Z.includes("время ожидания")?se+="Превышено время ожидания ответа (30 секунд). Попробуйте еще раз или упростите вопрос.":Z.includes("429")||Z.includes("лимит")?se+="Превышен лимит запросов к API. Подождите немного и попробуйте позже.":Z.includes("CORS")?se+="Ошибка CORS. Проблема с настройками сервера.":se+=`Попробуйте еще раз или переформулируйте вопрос. (Ошибка: ${Z.substring(0,100)})`,Ne.error("Не удалось получить ответ от AI помощника. Проверьте консоль браузера для деталей.");const ce={id:`ai-error-${Date.now()}`,role:"assistant",content:se,timestamp:new Date};t(Se=>[...Se,ce])}finally{s(!1)}},[r,n,vt,N,e,Rt,j,bt]),rr=ge=>{ge.key==="Enter"&&!ge.shiftKey&&(ge.preventDefault(),Tr())},ln=K.useCallback((ge,H)=>{var ce,Se,Me;const Ae=e.findIndex(be=>be.id===ge);if(Ae===-1)return;const te=e[Ae];if(!te||te.role!=="assistant")return;const Z=Ae>0?e[Ae-1]:null,se=(Z==null?void 0:Z.content)||"";try{Jc.saveFeedback({messageId:ge,question:se,answer:te.content,rating:H,timestamp:new Date,context:te.context}),t(st=>st.map(ht=>ht.id===ge?{...ht,rating:H}:ht)),Va.analyzeFeedback();const be=(ce=te.context)!=null&&ce.toLowerCase().includes("ltv")?"ltv_calculation":(Se=te.context)!=null&&Se.toLowerCase().includes("оценк")?"appraisal":(Me=te.context)!=null&&Me.toLowerCase().includes("риск")?"risks":"general";da.addExperienceFromFeedback(H,be,se),kc.invalidateFeedbackCache();const ke=Va.getLearningStats(),Ue=da.getEvolutionStats(),ze=da.getCurrentLevel(),dt=da.getProgressToNextLevel();if(Ue&&(O(Ue.level),T(dt)),_((()=>{const st=Math.min(ke.patternsCount*5,30),ht=ke.averageSuccessRate*25,Qt=Math.min(ke.totalUsage/10,15),xr=Math.min(ke.insightsCount*2,10),br=Ue?Math.min(Ue.level*2,20):0;return Math.round(st+ht+Qt+xr+br)})()),W(Va.getCategorySkill("appraisal")),ze&&Ue&&Ue.level>1){const st=da.getCurrentLevel();st&&Ne.success(`🎉 Модель достигла уровня: ${st.name}! Опыт: ${Ue.totalExperience}`)}H==="like"?Ne.success("Спасибо за оценку! Модель обучилась на вашем примере."):Ne.success("Спасибо за обратную связь. Модель проанализирует и улучшит ответы.")}catch{Ne.error("Не удалось сохранить оценку")}},[e]),kr=K.useCallback(async ge=>{const H=ge.name.toLowerCase();if(![".pdf",".docx",".xlsx",".xls",".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(ce=>H.endsWith(ce)))return Ne.error("Поддерживаются только файлы: PDF, DOCX, XLSX, XLS, JPG, JPEG, PNG, GIF, BMP, WEBP"),!1;const Z=[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(ce=>H.endsWith(ce)),se=Z?10*1024*1024:50*1024*1024;if(ge.size>se)return Ne.error(`Размер файла не должен превышать ${Z?"10MB":"50MB"}`),!1;A(!0);try{let ce;if(Z){if(Ne.info("Анализирую изображение через ИИ..."),ce=await fi.indexDocument(ge),ce.chunks.length>0&&ce.chunks[0].imageData)try{const Me=await kc.analyzeImage(ce.chunks[0].imageData,ge.name);ce.chunks[0].text=`[Изображение: ${ge.name}]

Описание от ИИ:
${Me}`;const be=fi.extractKeywordsPublic(Me);ce.chunks[0].keywords=[...new Set([...ce.chunks[0].keywords,...be])],fi.updateDocumentIndex(ce),Ne.success("Изображение проанализировано ИИ")}catch{Ne.warning("Изображение загружено, но не удалось проанализировать через ИИ")}}else ce=await i$(ge);u(Me=>Me.some(ke=>ke.documentName===ce.documentName)?Me:[...Me,ce]);const Se=bn.getCategories();if(h(Se),Se.length===0){await bn.buildFromDocuments();const Me=bn.getCategories();h(Me)}Ne.success(`${Z?"Изображение":"Документ"} "${ge.name}" успешно ${Z?"проанализирован":"проиндексирован"}. База знаний обновлена.`)}catch(ce){const Se=ce instanceof Error?ce.message:"Неизвестная ошибка";Ne.error(`Не удалось ${Z?"проанализировать изображение":"проиндексировать документ"}: ${Se}`)}finally{A(!1)}return!1},[]),ri=K.useCallback(async ge=>{const H=ge.name.toLowerCase();if(![".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(Z=>H.endsWith(Z)))return Ne.error("Для иллюстрации объекта поддерживаются только изображения (JPG, PNG, GIF, BMP, WEBP)"),Xi.LIST_IGNORE;const te=8*1024*1024;if(ge.size>te)return Ne.error("Размер изображения не должен превышать 8MB"),Xi.LIST_IGNORE;try{const Z=new FileReader;Z.onload=()=>{typeof Z.result=="string"&&(G(Z.result),Ne.success("Изображение объекта загружено для отчета"))},Z.readAsDataURL(ge)}catch{Ne.error("Не удалось загрузить изображение объекта")}return!1},[]),Di=K.useCallback(async()=>{try{const ge=await ye.validateFields();pe(!0);const H=Ze.find(be=>be.value===ge.assetType),Ae=ge.attributes||{},te=j1(Ae,je),Z=[ge.additionalFactors,te].filter(Boolean).join(". "),se=Ae.location||Ae.baseLocation||Ae.storageLocation||void 0,ce=(typeof Ae.areaSqm=="number"?Ae.areaSqm:void 0)??(typeof Ae.areaHa=="number"?Ae.areaHa:void 0)??(typeof Ae.quantity=="number"?Ae.quantity:void 0),Se=Ae.condition||Ae.quality,Me=await _y.generateEstimate({objectName:ge.objectName||(H==null?void 0:H.label)||"Объект оценки",assetGroup:ge.assetGroup,assetType:ge.assetType,location:se,area:ce,areaUnit:void 0,condition:Se,incomePerYear:void 0,occupancy:void 0,purpose:ge.purpose,additionalFactors:Z,card:null,skills:Ke});if(de(Me),W(Va.getCategorySkill("appraisal")),!z)try{const be=`${ge.objectName||(H==null?void 0:H.label)||"Объект оценки"}. ${(H==null?void 0:H.label)||""}. ${se?`Расположен: ${se}.`:""} ${Se?`Состояние: ${Se}.`:""} ${te?`Характеристики: ${te}.`:""}`;Ne.info("Генерация изображения объекта через ИИ...");const ke=await WE.generateImage(be,H==null?void 0:H.label,se);G(ke)}catch(be){console.warn("Не удалось сгенерировать изображение через ИИ:",be)}Ne.success("AI помощник подготовил оценку объекта")}catch(ge){if(ge&&ge.errorFields)return;console.error("Ошибка запроса оценки ИИ:",ge),Ne.error("Не удалось получить оценку. Проверьте заполненные данные.")}finally{pe(!1)}},[ye,Ze,je,Ke,z]),Dr=K.useCallback(async()=>{var ge,H;if(!Y){Ne.warning("Сначала выполните оценку ИИ, затем можно выгрузить PDF.");return}try{const Ae=ye.getFieldsValue(),te=bt(),Z=new Date().toLocaleString("ru-RU"),se=Ae.attributes||{},ce=Ze.find(zr=>zr.value===Ae.assetType),Se=((ge=Ae.objectName)==null?void 0:ge.trim())||(ce==null?void 0:ce.label)||"Объект оценки",Me=se.location||se.baseLocation||se.storageLocation||"";let be=z;if(!be)try{Ne.info("Генерация изображения объекта для PDF...");const zr=j1(se,je),en=`${Se}. ${(ce==null?void 0:ce.label)||""}. ${Me?`Расположен: ${Me}.`:""} ${zr?`Характеристики: ${zr}.`:""}`;be=await WE.generateImage(en,ce==null?void 0:ce.label,Me)}catch(zr){console.warn("Не удалось сгенерировать изображение для PDF:",zr)}let ke='<p style="margin: 0 0 8px 0;">Аналоги не были явно указаны в результате ИИ.</p>';Y.comparables&&Y.comparables.length>0&&(ke=(await Promise.all(Y.comparables.map(async(en,Is)=>{const Ns=typeof en=="string"?{description:en}:en,El=Ns.url,Li=Ns.imageUrl;let _o="";if(Li)try{const Fs=await fetch(Ns.imageUrl);if(Fs.ok){const bo=await Fs.blob(),Co=new FileReader;_o=`<img src="${await new Promise((mc,Zd)=>{Co.onloadend=()=>mc(Co.result),Co.onerror=Zd,Co.readAsDataURL(bo)})}" alt="Аналог ${Is+1}" style="max-width: 200px; max-height: 150px; border-radius: 4px; margin: 4px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1);" />`}}catch(Fs){console.warn(`Не удалось загрузить изображение аналога ${Is+1}:`,Fs)}let tn=Ns.description,oA=null;if(!El){const Fs=/(https?:\/\/[^\s)\]}>"]+)/,bo=tn.match(Fs);bo&&(oA=bo[0].replace(/[.,;:!?]+$/,""),tn=tn.replace(bo[0],"").trim())}const AA=El?Ns.url:oA,Jd=AA?` <br/><a href="${AA}" target="_blank" style="color: #1890ff; text-decoration: underline; font-size: 10px; word-break: break-all;">🔗 ${AA}</a>`:"";return`
              <div style="margin: 0 0 12px 0; padding: 8px; background: #f5f5f5; border-radius: 4px; border-left: 3px solid #1890ff;">
                <p style="margin: 0 0 4px 0;"><strong>Аналог ${Is+1}:</strong> ${tn}${Jd}</p>
                ${_o}
              </div>
            `}))).join(""));const Ue=`
        <div style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 16px; font-size: 11px; line-height: 1.4; width: 750px; box-sizing: border-box; background:#ffffff;">
          <h2 style="margin: 0 0 8px 0;">Отчет об экспресс-оценке залогового актива (ИИ)</h2>
          <div style="margin-bottom: 8px;">Дата формирования: ${Z}</div>

          <div style="display: flex; align-items: center; margin: 8px 0 12px 0;">
            ${be?`<img src="${be}" alt="Объект оценки" style="width: 90px; height: 90px; border-radius: 8px; object-fit: cover; box-shadow: 0 2px 6px rgba(0,0,0,0.2); margin-right: 12px;" />`:`<div style="
                    width: 90px;
                    height: 90px;
                    border-radius: 8px;
                    background: linear-gradient(135deg, #1890ff 0%, #40a9ff 50%, #bae7ff 100%);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: #ffffff;
                    font-size: 9px;
                    text-align: center;
                    padding: 4px;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
                    margin-right: 12px;
                  ">
                    <div>
                      <div style="font-weight: 600; margin-bottom: 2px;">ОБЪЕКТ</div>
                      <div style="word-break: break-word;">${Se}</div>
                    </div>
                  </div>`}
            <div style="font-size: 10px;">
              <div><strong>Тип актива:</strong> ${(ce==null?void 0:ce.label)||Ae.assetType||"-"}</div>
              ${Me?`<div><strong>Локация:</strong> ${Me}</div>`:""}
            </div>
          </div>

          <h3 style="margin: 12px 0 4px 0;">1. Описание объекта и исходные данные</h3>
          ${be?`<div style="margin: 8px 0; text-align: center;">
                  <img src="${be}" alt="Изображение объекта оценки" style="max-width: 100%; max-height: 400px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); margin-bottom: 8px;" />
                  <p style="font-size: 10px; color: #666; margin: 0;">Изображение объекта, сгенерированное ИИ на основе описания</p>
                </div>`:""}
          <pre style="white-space: pre-wrap; margin: 0 0 8px 0;">${te||"Нет данных"}</pre>

          <h3 style="margin: 12px 0 4px 0;">2. Итоги экспресс-оценки</h3>
          <ul style="margin: 0 0 8px 20px; padding: 0;">
            <li>Рыночная стоимость (ориентировочно): ${Y.marketValue.toLocaleString("ru-RU")} ₽</li>
            <li>Залоговая стоимость (ориентировочно): ${Y.collateralValue.toLocaleString("ru-RU")} ₽</li>
            ${typeof Y.recommendedLtv=="number"?`<li>Рекомендуемый LTV: ${Y.recommendedLtv}%</li>`:""}
            <li>Уровень уверенности модели: ${Y.confidence}</li>
          </ul>

          <h3 style="margin: 12px 0 4px 0;">3. Методология расчета</h3>
          <p style="margin: 0 0 8px 0;">${Y.methodology||"Методология не указана"}</p>

          <h3 style="margin: 12px 0 4px 0;">4. Использованные аналоги (если применимо)</h3>
          ${ke}

          <h3 style="margin: 12px 0 4px 0;">5. Риски и корректировки</h3>
          ${Y.riskFactors&&Y.riskFactors.length>0?`<p style="margin: 0 0 4px 0;">Идентифицированные риски: ${Y.riskFactors.join("; ")}</p>`:'<p style="margin: 0 0 4px 0;">Риски не были явно указаны моделью.</p>'}
          ${Y.recommendedActions&&Y.recommendedActions.length>0?`<p style="margin: 0 0 8px 0;">Рекомендации по учету рисков и корректировкам: ${Y.recommendedActions.join("; ")}</p>`:""}

          <h3 style="margin: 12px 0 4px 0;">6. Основные допущения</h3>
          <p style="margin: 0;">
            ${Y.assumptions&&Y.assumptions.length>0?Y.assumptions.join("; "):"Допущения явно не указаны моделью. Рекомендуется дополнительная экспертная проверка."}
          </p>
        </div>
      `,ze=document.createElement("div");if(ze.style.position="fixed",ze.style.left="-10000px",ze.style.top="0",ze.style.width="750px",ze.style.minHeight="100px",ze.style.padding="16px",ze.style.backgroundColor="#ffffff",ze.style.color="#000000",ze.style.fontFamily='system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',ze.style.fontSize="11px",ze.style.lineHeight="1.4",ze.style.boxSizing="border-box",ze.style.visibility="visible",ze.style.opacity="1",ze.style.pointerEvents="none",ze.style.zIndex="999999",ze.style.overflow="visible",ze.innerHTML=Ue,document.body.appendChild(ze),ze.offsetHeight,ze.scrollHeight,await new Promise(zr=>requestAnimationFrame(zr)),await new Promise(zr=>requestAnimationFrame(zr)),await new Promise(zr=>setTimeout(zr,300)),be){const zr=ze.querySelector("img");zr&&await new Promise(en=>{if(zr.complete&&zr.naturalWidth>0&&zr.naturalHeight>0)en(void 0);else{const Is=setTimeout(()=>en(void 0),3e3);zr.onload=()=>{clearTimeout(Is),en(void 0)},zr.onerror=()=>{clearTimeout(Is),en(void 0)}}})}ze.offsetHeight;const dt=ze.scrollHeight||1e3;if(dt<50)throw document.body.removeChild(ze),new Error("Контейнер PDF пуст или не отрендерился");const pt=await ky(ze,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1,width:750,height:dt,windowWidth:750,windowHeight:dt,onclone:zr=>{const en=zr.querySelector("div");en&&(en.style.visibility="visible",en.style.opacity="1")}});if(document.body.removeChild(ze),!pt||pt.width===0||pt.height===0)throw new Error("Canvas is empty");const st=pt.toDataURL("image/png"),ht=new Ht({orientation:"p",unit:"mm",format:"a4"}),Qt=ht.internal.pageSize.getWidth(),xr=ht.internal.pageSize.getHeight(),br=10,xa=Qt-br*2,wi=xr-br*2;let Ei=xa,Fn=pt.height*Ei/pt.width;Fn>wi&&(Fn=wi,Ei=pt.width*Fn/pt.height);const ji=(Qt-Ei)/2,is=(xr-Fn)/2;ht.addImage(st,"PNG",ji,is,Ei,Fn);const ni=((H=Ae.objectName)==null?void 0:H.trim())||"ai_appraisal_report",pa=new Date().toISOString().slice(0,10);ht.save(`Оценка_ИИ_${ni}_${pa}.pdf`)}catch{Ne.error("Не удалось сформировать PDF отчет.")}},[Y,ye,bt,z,Ze,je]),Gt=K.useCallback(ge=>{var H;if(Y)try{const Ae=ye.getFieldsValue(),te=((H=Ze.find(ce=>ce.value===Ae.assetType))==null?void 0:H.label)||Ae.assetType||"Неизвестный тип",Z=[];Z.push(`Объект: ${Ae.objectName||te}`),Z.push(`Тип актива: ${te}`),Z.push(`Рыночная: ${Y.marketValue.toLocaleString("ru-RU")} ₽, Залоговая: ${Y.collateralValue.toLocaleString("ru-RU")} ₽`),typeof Y.recommendedLtv=="number"&&Z.push(`LTV: ${Y.recommendedLtv}%`),Z.push(`Уверенность модели: ${Y.confidence}`);const se=Z.join(" | ");Jc.saveFeedback({messageId:`appraisal-${Date.now()}`,question:`AI-оценка для объекта "${Ae.objectName||te}"`,answer:JSON.stringify(Y),rating:ge,timestamp:new Date,context:se}),Va.analyzeFeedback(),da.addExperienceFromFeedback(ge,"appraisal",se),W(Va.getCategorySkill("appraisal")),ge==="like"?Ne.success("Спасибо! Модель учтёт, что оценка была точной."):Ne.success("Спасибо за замечание. Модель дообучится на этом примере.")}catch{Ne.error("Не удалось сохранить обратную связь по оценке.")}},[Y,ye,Ze]),wr=K.useCallback(async()=>{A(!0);try{Ne.info("Начинаю переиндексацию всех документов...");const ge=await s$();u(ge);const H=bn.getCategories();h(H),Va.forceUpdate(),da.addExperienceFromDocuments();const Ae=Va.getLearningStats(),te=da.getEvolutionStats(),Z=da.getProgressToNextLevel();te&&(O(te.level),T(Z)),_((()=>{const ce=Math.min(Ae.patternsCount*5,30),Se=Ae.averageSuccessRate*25,Me=Math.min(Ae.totalUsage/10,15),be=Math.min(Ae.insightsCount*2,10),ke=te?Math.min(te.level*2,20):0;return Math.round(ce+Se+Me+be+ke)})()),Ne.success(`Переиндексация завершена. Обработано документов: ${ge.length}. Категорий: ${H.length}. Данные для самообучения обновлены.`)}catch(ge){const H=ge instanceof Error?ge.message:"Неизвестная ошибка";Ne.error(`Ошибка переиндексации: ${H}`)}finally{A(!1)}},[]),ns=K.useCallback(ge=>{a(ge.title),requestAnimationFrame(()=>{setTimeout(()=>{const H=ge.title;if(!H.trim()||n)return;const Ae={id:`user-${Date.now()}`,role:"user",content:H.trim(),timestamp:new Date};t(te=>[...te,Ae]),a(""),s(!0),vt(H.trim(),[],j&&bt()||void 0).then(({content:te,sources:Z,context:se})=>{const ce={id:`ai-${Date.now()}`,role:"assistant",content:te,timestamp:new Date,sources:Z.length>0?Z:void 0,context:se};t(Se=>[...Se,ce])}).catch(te=>{const Z={id:`ai-error-${Date.now()}`,role:"assistant",content:"Извините, произошла ошибка при генерации ответа. Попробуйте еще раз или переформулируйте вопрос.",timestamp:new Date};t(se=>[...se,Z])}).finally(()=>{s(!1)})},50)})},[n,vt,j,bt]),ga=K.useCallback(ge=>{x(ge),E("")},[]),yi=K.useMemo(()=>[{icon:i.jsx(MA,{}),text:"Расчет LTV и залоговая стоимость",query:"Как правильно рассчитать LTV (loan-to-value) для залогового имущества? Какие факторы влияют на залоговую стоимость?"},{icon:i.jsx(Qr,{}),text:"Оценка залогового имущества",query:"Какие требования к независимой оценке залогового имущества? Как выбрать оценщика и проверить отчет об оценке?"},{icon:i.jsx(Ev,{}),text:"Анализ рисков залога",query:"Какие основные риски при принятии имущества в залог? Как оценить и минимизировать риски по залоговому обеспечению?"},{icon:i.jsx(MT,{}),text:"Регистрация обременения в Росреестре",query:"Как зарегистрировать обременение в Росреестре? Какие документы необходимы для регистрации залога недвижимости?"},{icon:i.jsx(Qr,{}),text:"Визуальный осмотр залогового имущества",query:"Как провести визуальный осмотр залогового имущества? На что обратить внимание при проверке наличия и состояния залога?"},{icon:i.jsx(Ev,{}),text:"Обращение взыскания на залог",query:"В каких случаях можно обратить взыскание на залоговое имущество? Каков порядок реализации залога?"}],[]),vi=K.useCallback(ge=>{if(!ge.trim()||n)return;let H=N;H||(H=D1().id,P(H),V(OA()));const Ae={id:`user-${Date.now()}`,role:"user",content:ge.trim(),timestamp:new Date};H&&Mu(H,Ae),t(Z=>[...Z,Ae]),a(""),s(!0);const te=e.map(Z=>({id:Z.id,role:Z.role,content:Z.content,timestamp:Z.timestamp instanceof Date?Z.timestamp:new Date(Z.timestamp)}));vt(ge.trim(),te,j&&bt()||void 0).then(({content:Z,sources:se,context:ce})=>{const Se={id:`ai-${Date.now()}`,role:"assistant",content:Z,timestamp:new Date,sources:se.length>0?se:void 0,context:ce};H&&(Mu(H,Se),V(OA())),t(Me=>[...Me,Se]),setTimeout(()=>{Rt()},150)}).catch(Z=>{const se={id:`ai-error-${Date.now()}`,role:"assistant",content:"Извините, произошла ошибка при генерации ответа. Попробуйте еще раз или переформулируйте вопрос.",timestamp:new Date};H&&(Mu(H,se),V(OA())),t(ce=>[...ce,se]),setTimeout(()=>{Rt()},150)}).finally(()=>{s(!1)})},[n,vt,N,e,Rt,j,bt]),kt=K.useMemo(()=>{const ge=new Date;ge.setHours(0,0,0,0);const H=new Date(ge);H.setDate(H.getDate()-1);const Ae=new Date(ge);Ae.setDate(Ae.getDate()-7);const te=new Date(ge);te.setDate(te.getDate()-30);const Z={today:[],yesterday:[],week:[],month:[]};return U.forEach(se=>{const ce=new Date(se.updatedAt);ce.setHours(0,0,0,0),ce.getTime()===ge.getTime()?Z.today.push(se):ce.getTime()===H.getTime()?Z.yesterday.push(se):ce>=Ae?Z.week.push(se):ce>=te&&Z.month.push(se)}),Z},[U]),ai=K.useCallback(()=>{const ge=D1();P(ge.id),V(OA()),t([]),Ne.success("Создан новый чат")},[]),Ja=K.useCallback(ge=>{P(ge)},[]);return i.jsxs("div",{className:"reference-page",children:[i.jsxs("div",{className:`reference-page__sidebar ${Et?"reference-page__sidebar--visible":""}`,children:[i.jsxs("div",{className:"reference-page__sidebar-header",children:[i.jsxs(Fe,{children:[i.jsx(vr,{size:24}),i.jsx(zt,{strong:!0,style:{color:"#fff",fontSize:"16px"},children:"Чаты"})]}),i.jsx(Be,{type:"text",icon:Et?i.jsx(r_,{}):i.jsx(t_,{}),onClick:()=>Mt(!Et),style:{color:"#fff"},title:Et?"Свернуть панель чатов":"Развернуть панель чатов"})]}),Et&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"reference-page__sidebar-content",children:[i.jsx(Be,{type:"primary",icon:i.jsx(xi,{}),onClick:ai,block:!0,style:{marginBottom:16},children:"Новый чат"}),i.jsxs("div",{className:"reference-page__chats-list",children:[kt.today.length>0&&i.jsxs("div",{className:"reference-page__chats-group",children:[i.jsx(zt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"Сегодня"}),kt.today.map(ge=>i.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[i.jsx(zt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),i.jsx(Be,{type:"text",icon:i.jsx(J0,{}),size:"small",onClick:H=>{H.stopPropagation()},style:{color:"#8c8c8c"}})]},ge.id))]}),kt.yesterday.length>0&&i.jsxs("div",{className:"reference-page__chats-group",children:[i.jsx(zt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"Вчера"}),kt.yesterday.map(ge=>i.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[i.jsx(zt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),i.jsx(Be,{type:"text",icon:i.jsx(J0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),kt.week.length>0&&i.jsxs("div",{className:"reference-page__chats-group",children:[i.jsx(zt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"7 дней"}),kt.week.map(ge=>i.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[i.jsx(zt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),i.jsx(Be,{type:"text",icon:i.jsx(J0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),kt.month.length>0&&i.jsxs("div",{className:"reference-page__chats-group",children:[i.jsx(zt,{type:"secondary",style:{fontSize:12,color:"#8c8c8c",padding:"8px 16px",display:"block"},children:"30 дней"}),kt.month.map(ge=>i.jsxs("div",{className:`reference-page__chat-item ${N===ge.id?"reference-page__chat-item--active":""}`,onClick:()=>Ja(ge.id),children:[i.jsx(zt,{ellipsis:!0,style:{flex:1,color:"#fff"},children:ge.title}),i.jsx(Be,{type:"text",icon:i.jsx(J0,{}),size:"small",style:{color:"#8c8c8c"}})]},ge.id))]}),U.length===0&&i.jsx("div",{style:{padding:16,textAlign:"center"},children:i.jsx(zt,{type:"secondary",style:{color:"#8c8c8c"},children:"Нет сохраненных чатов"})})]})]})})]}),i.jsxs("div",{className:`reference-page__main-content ${Et?"reference-page__main-content--with-sidebar":""}`,children:[i.jsxs("div",{className:"reference-page__header",children:[i.jsxs("div",{className:"reference-page__header-left",children:[i.jsx(vr,{size:ct}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs(Fe,{align:"center",style:{marginBottom:4},size:"small",children:[i.jsx(Yp,{level:2,style:{margin:0,fontSize:"22px",lineHeight:"1.2"},children:"Справочная с ИИ"}),i.jsxs(at,{color:I>=70?"success":I>=40?"processing":"default",icon:i.jsx(PT,{}),style:{fontSize:"12px",padding:"4px 12px",borderRadius:"16px",fontWeight:600,height:"auto",lineHeight:"1.5"},children:["Индекс самообучаемости: ",I,"%"]})]}),M&&i.jsx("div",{style:{marginBottom:4,maxWidth:500},children:i.jsxs(Fe,{direction:"vertical",size:2,style:{width:"100%"},children:[i.jsxs(Fe,{size:"small",children:[i.jsxs(zt,{strong:!0,style:{fontSize:"12px"},children:["Уровень: ",((Za=da.getCurrentLevel())==null?void 0:Za.name)||"Новичок"," (",S,")"]}),i.jsxs(zt,{type:"secondary",style:{fontSize:"11px"},children:["Опыт: ",((ca=da.getEvolutionStats())==null?void 0:ca.totalExperience)||0]})]}),i.jsx(Qn,{percent:M.percentage,status:M.percentage>=90?"active":"normal",strokeColor:{"0%":"#108ee9","100%":"#87d068"},format:()=>`${M.current}/${M.required} опыта`,size:"small",style:{marginTop:2},showInfo:!1})]})}),i.jsxs(Fe,{direction:"vertical",size:4,style:{width:"100%"},children:[i.jsx(zt,{type:"secondary",style:{fontSize:"11px",lineHeight:"1.3"},children:"База знаний на основе справочной литературы по банковским залогам"}),i.jsxs(Fe,{align:"center",wrap:!0,size:"small",children:[i.jsxs(at,{color:ie>=70?"success":ie>=40?"processing":"default",icon:i.jsx(MA,{}),style:{margin:0},children:["Скилл оценки: ",ie,"%"]}),i.jsx(at,{color:b?"processing":"default",icon:i.jsx(_v,{spin:b}),style:{margin:0},children:"Режим обучения"}),i.jsx(Be,{size:"small",type:j?"primary":"default",icon:i.jsx(MA,{}),onClick:Ct,children:"Режим оценки"}),i.jsx(Be,{size:"small",type:b?"primary":"default",icon:i.jsx(_v,{spin:b}),onClick:lt,children:b?"Остановить обучение":"Режим обучения"}),i.jsx(Be,{size:"small",type:"default",icon:i.jsx(Hc,{}),onClick:()=>ae(!0),children:"Эквалайзер скилов"})]})]})]})]}),i.jsxs("div",{className:"reference-page__header-right",children:[p.length>0&&i.jsxs(at,{icon:i.jsx(QT,{}),color:"blue",style:{margin:0,padding:"4px 12px"},children:["Документов: ",p.length]}),i.jsxs(Be,{icon:i.jsx(qT,{}),onClick:()=>Mt(!Et),size:"middle",type:Et?"primary":"default",style:{marginRight:8},title:Et?"Скрыть историю чатов":"Показать историю чатов",children:["Чаты"," ",U.length>0&&i.jsx(hh,{count:U.length,size:"small",style:{marginLeft:4}})]}),i.jsx(Be,{icon:i.jsx(Hc,{}),onClick:()=>L(!0),size:"middle",children:"Настройки"})]})]}),j?i.jsx(Ge,{size:"small",className:"reference-page__appraisal-panel",children:i.jsx(ne,{layout:"vertical",form:ye,children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"middle",children:[i.jsxs(Fe,{style:{width:"100%",justifyContent:"space-between"},children:[i.jsx(zt,{strong:!0,children:"Режим оценки активен"}),i.jsx(Be,{size:"small",onClick:Ct,children:"Выйти из режима оценки"})]}),i.jsxs(Fe,{size:"middle",wrap:!0,children:[i.jsx(ne.Item,{label:"Категория",name:"assetGroup",children:i.jsx(Ye,{style:{minWidth:220},options:He,disabled:!0})}),i.jsx(ne.Item,{label:"Тип актива",name:"assetType",dependencies:["assetGroup"],rules:[{required:!0,message:"Выберите тип актива"}],children:i.jsx(Ye,{style:{minWidth:260},placeholder:"Выберите тип",options:Ze})}),i.jsx(ne.Item,{label:"Наименование",name:"objectName",children:i.jsx(Re,{placeholder:"Например, складской комплекс на МКАД"})})]}),je.length>0&&i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Ключевые атрибуты для оценки"}),i.jsx(ft,{gutter:12,style:{marginTop:8},children:je.map(ge=>i.jsx(Te,{xs:24,md:12,lg:8,children:i.jsx(ne.Item,{label:ge.label,name:["attributes",ge.key],children:ge.type==="number"?i.jsx(fa,{style:{width:"100%"},placeholder:ge.placeholder,controls:!1}):i.jsx(Re,{placeholder:ge.placeholder})})},ge.key))})]}),i.jsx(ft,{gutter:12,children:i.jsx(Te,{xs:24,md:12,children:i.jsxs(ne.Item,{label:"Фото объекта для отчета",children:[i.jsx(Xi,{accept:".jpg,.jpeg,.png,.gif,.bmp,.webp",showUploadList:!1,beforeUpload:ri,children:i.jsx(Be,{size:"small",children:"Загрузить изображение"})}),z&&i.jsx("div",{style:{marginTop:8},children:i.jsx("img",{src:z,alt:"Объект оценки",style:{maxWidth:160,maxHeight:120,borderRadius:8,objectFit:"cover"}})})]})})}),i.jsxs(ft,{gutter:12,children:[i.jsx(Te,{xs:24,md:12,children:i.jsx(ne.Item,{label:"Цель оценки",name:"purpose",children:i.jsx(Re,{placeholder:"Например, взыскание, кредитование"})})}),i.jsx(Te,{xs:24,md:12,children:i.jsx(ne.Item,{label:"Особенности / комментарии",name:"additionalFactors",children:i.jsx(Re,{placeholder:"Земля в аренде, есть обременения..."})})})]}),i.jsxs(Fe,{style:{justifyContent:"space-between",width:"100%"},children:[i.jsx(zt,{type:"secondary",children:"После заполнения полей AI помощник выполнит экспресс-оценку и учтёт данные в самообучении."}),i.jsxs(Fe,{children:[i.jsx(Be,{type:"default",icon:i.jsx(Qr,{}),disabled:!Y,onClick:Dr,children:"Выгрузить PDF"}),i.jsx(Be,{type:"primary",icon:i.jsx(MA,{}),loading:ue,onClick:Di,children:"Получить оценку ИИ"})]})]}),Y&&i.jsx(Nr,{type:"success",showIcon:!0,message:`Рыночная стоимость: ${Y.marketValue.toLocaleString("ru-RU")} ₽ · Залоговая: ${Y.collateralValue.toLocaleString("ru-RU")} ₽`,description:i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Методология:"})," ",Y.methodology,i.jsx("br",{}),i.jsx(zt,{strong:!0,children:"Ключевые риски:"})," ",Y.riskFactors.join("; ")||"не выявлены",i.jsx("br",{}),i.jsx(zt,{strong:!0,children:"Рекомендации:"})," ",Y.recommendedActions.join("; ")||"—",i.jsx("br",{}),i.jsxs(Fe,{size:"small",style:{marginTop:8},children:[i.jsx(Be,{size:"small",type:"text",icon:i.jsx(d_,{}),onClick:()=>Gt("like"),title:"Оценка точна"}),i.jsx(Be,{size:"small",type:"text",icon:i.jsx(u_,{}),onClick:()=>Gt("dislike"),title:"Оценка неточна"})]})]})})]})})}):i.jsxs(i.Fragment,{children:[c&&i.jsx(Nr,{message:"Инициализация ИИ-справочной...",description:i.jsxs("div",{children:[i.jsx("span",{className:"reference-page__loading-text",children:"Справочная загружается, подождите пожалуйста..."}),typeof d=="number"&&i.jsxs("div",{style:{marginTop:4},children:["Осталось примерно ",d," сек."]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),i.jsx(Ge,{className:"reference-page__card",children:i.jsx("div",{className:"reference-page__chat",children:i.jsxs("div",{className:"reference-page__messages",children:[e.length===0?i.jsx("div",{className:"reference-page__empty",children:i.jsxs("div",{className:"reference-page__welcome",children:[i.jsx(bf,{style:{fontSize:40,color:"#1890ff",marginBottom:8}}),i.jsx(Yp,{level:4,style:{marginBottom:4,fontSize:"18px"},children:"Справочная с ИИ"}),i.jsx(zt,{type:"secondary",style:{fontSize:13,marginBottom:12,display:"block"},children:"Задайте вопрос ниже, и я найду ответ в базе знаний"}),i.jsx(jt,{style:{margin:"8px 0"}}),i.jsx("div",{className:"reference-page__quick-questions",children:i.jsx(p2,{ghost:!0,items:[{key:"1",label:i.jsx(zt,{strong:!0,style:{fontSize:14},children:"Популярные вопросы"}),children:i.jsx(Fe,{direction:"vertical",size:"small",style:{width:"100%"},children:yi.map((ge,H)=>i.jsx(Be,{type:"default",icon:ge.icon,onClick:()=>vi(ge.query),style:{width:"100%",textAlign:"left",height:"auto",padding:"10px 16px",fontSize:"14px"},children:ge.text},H))})}]})})]})}):i.jsxs(i.Fragment,{children:[e.map(ge=>i.jsx(gS,{message:ge,onRating:ln,onTopicClick:ns},ge.id)),n&&i.jsx("div",{className:"reference-page__message reference-page__message--assistant",children:i.jsxs("div",{className:"reference-page__message-content",children:[i.jsx(tm,{icon:i.jsx(bf,{}),style:{backgroundColor:"#52c41a",marginRight:12}}),i.jsx(Zn,{size:"small"}),i.jsx(zt,{type:"secondary",style:{marginLeft:12},children:"Ищу информацию в базе знаний..."})]})}),i.jsx("div",{ref:Dt})]}),i.jsx("div",{className:"reference-page__input-container",children:i.jsxs("div",{className:"reference-page__input-wrapper",children:[i.jsxs("div",{style:{position:"relative",width:"100%"},children:[i.jsx(b$,{ref:Bt,value:r,onChange:ge=>a(ge.target.value),onKeyPress:rr,placeholder:e.length===0?"Задайте вопрос о залогах, ипотеке, оценке...":"Задайте уточняющий вопрос...",autoSize:{minRows:3,maxRows:6},disabled:n||c,className:"reference-page__main-input",style:{fontSize:"16px",padding:"16px 50px 16px 16px",borderRadius:"12px",border:"2px solid #d9d9d9",transition:"all 0.3s"},onFocus:ge=>{ge.target.style.borderColor="#1890ff",ge.target.style.boxShadow="0 0 0 2px rgba(24, 144, 255, 0.2)"},onBlur:ge=>{ge.target.style.borderColor="#d9d9d9",ge.target.style.boxShadow="none"}}),i.jsx(Xi,{accept:".pdf,.docx,.xlsx,.xls,.jpg,.jpeg,.png,.gif,.bmp,.webp",beforeUpload:kr,showUploadList:!1,disabled:o,children:i.jsx(Be,{type:"text",icon:i.jsx(KT,{}),loading:o,disabled:o,style:{position:"absolute",right:"8px",top:"8px",zIndex:1,color:"#8c8c8c",fontSize:"18px",width:"32px",height:"32px",padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"Приложить документ или изображение"})})]}),i.jsx(Be,{type:"primary",icon:i.jsx(A_,{}),onClick:Tr,loading:n,disabled:!r.trim()||c,size:"large",className:"reference-page__send-button",style:{height:"auto",padding:"12px 24px",fontSize:"16px",marginTop:"12px",borderRadius:"8px"},children:"Отправить вопрос"})]})})]})})})]}),i.jsx(dr,{title:i.jsxs(Fe,{children:[i.jsx(Hc,{}),i.jsx("span",{children:"Настройки"})]}),open:R,onCancel:()=>L(!1),footer:null,width:600,style:{top:20},children:i.jsxs(Fe,{direction:"vertical",style:{width:"100%"},size:"large",children:[i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Поиск по темам"}),i.jsx(Re,{placeholder:"Поиск...",prefix:i.jsx(Pa,{}),value:v,onChange:ge=>E(ge.target.value),style:{marginTop:8},allowClear:!0})]}),i.jsx(jt,{style:{margin:"8px 0"}}),i.jsxs("div",{children:[i.jsxs(Fe,{style:{marginBottom:8},children:[i.jsx(zt,{strong:!0,children:"Категории"}),y&&i.jsx(Be,{type:"link",size:"small",onClick:()=>ga(null),children:"Сбросить"})]}),i.jsx(Ba,{size:"small",dataSource:g,style:{maxHeight:400,overflow:"auto"},renderItem:ge=>i.jsx(Ba.Item,{style:{cursor:"pointer",backgroundColor:y===ge.id?"#e6f7ff":"transparent",borderRadius:4,padding:"8px 12px"},onClick:()=>ga(ge.id),children:i.jsxs(Fe,{style:{width:"100%",justifyContent:"space-between"},children:[i.jsxs(Fe,{children:[i.jsx(Ao,{}),i.jsx(zt,{children:ge.name})]}),i.jsx(hh,{count:ge.topics.length,showZero:!0,style:{backgroundColor:"#52c41a"}})]})})})]}),D.length>0&&!y&&i.jsxs(i.Fragment,{children:[i.jsx(jt,{style:{margin:"8px 0"}}),i.jsxs("div",{children:[i.jsxs(zt,{strong:!0,children:["Результаты поиска (",D.length,")"]}),i.jsx(Ba,{size:"small",dataSource:D.slice(0,10),style:{marginTop:8,maxHeight:300,overflow:"auto"},renderItem:ge=>i.jsx(Ba.Item,{style:{cursor:"pointer",padding:"8px 12px",borderRadius:4},onClick:()=>{ns(ge),L(!1)},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="transparent"},children:i.jsx(zt,{ellipsis:!0,style:{fontSize:12},children:ge.title})})})]})]}),i.jsx(jt,{style:{margin:"8px 0"}}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,style:{display:"block",marginBottom:8},children:"Управление базой знаний"}),i.jsx(Be,{icon:i.jsx(ec,{}),onClick:wr,loading:o,title:"Переиндексировать все документы из папки VND",block:!0,style:{marginTop:8},children:"Обновить базу знаний"}),i.jsx(zt,{type:"secondary",style:{fontSize:12,display:"block",marginTop:8},children:"Переиндексирует все документы из папки VND и обновит базу знаний"})]})]})}),i.jsx(f2,{title:"Эквалайзер скилов и навыков Помощника ИИ",placement:"right",width:600,open:ve,onClose:()=>ae(!1),children:i.jsxs(Fe,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(Yp,{level:4,children:"Режим оценки"}),i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Доходный подход"}),i.jsx(En,{value:Ke.incomeApproach,onChange:ge=>Ee(H=>({...H,incomeApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),i.jsxs(Fe,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Дисконтирование денежных потоков (DCF)"}),i.jsx(En,{value:Ke.incomeMethods.dcf,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,dcf:ge}})),min:0,max:100,style:{marginTop:4}})]}),i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Прямая капитализация"}),i.jsx(En,{value:Ke.incomeMethods.directCapitalization,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,directCapitalization:ge}})),min:0,max:100,style:{marginTop:4}})]}),i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Множитель валового дохода"}),i.jsx(En,{value:Ke.incomeMethods.grossRentMultiplier,onChange:ge=>Ee(H=>({...H,incomeMethods:{...H.incomeMethods,grossRentMultiplier:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Сравнительный подход"}),i.jsx(En,{value:Ke.comparativeApproach,onChange:ge=>Ee(H=>({...H,comparativeApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),i.jsxs(Fe,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Сравнение продаж"}),i.jsx(En,{value:Ke.comparativeMethods.salesComparison,onChange:ge=>Ee(H=>({...H,comparativeMethods:{...H.comparativeMethods,salesComparison:ge}})),min:0,max:100,style:{marginTop:4}})]}),i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Извлечение из рынка"}),i.jsx(En,{value:Ke.comparativeMethods.marketExtraction,onChange:ge=>Ee(H=>({...H,comparativeMethods:{...H.comparativeMethods,marketExtraction:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Затратный подход"}),i.jsx(En,{value:Ke.costApproach,onChange:ge=>Ee(H=>({...H,costApproach:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}}),i.jsxs(Fe,{direction:"vertical",size:"small",style:{marginTop:8,marginLeft:12},children:[i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Стоимость замещения"}),i.jsx(En,{value:Ke.costMethods.replacementCost,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,replacementCost:ge}})),min:0,max:100,style:{marginTop:4}})]}),i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Стоимость воспроизводства"}),i.jsx(En,{value:Ke.costMethods.reproductionCost,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,reproductionCost:ge}})),min:0,max:100,style:{marginTop:4}})]}),i.jsxs("div",{children:[i.jsx(zt,{type:"secondary",style:{fontSize:12},children:"Износ"}),i.jsx(En,{value:Ke.costMethods.depreciation,onChange:ge=>Ee(H=>({...H,costMethods:{...H.costMethods,depreciation:ge}})),min:0,max:100,style:{marginTop:4}})]})]})]})]})]}),i.jsx(jt,{}),i.jsxs("div",{children:[i.jsx(Yp,{level:4,children:"Режим экспертизы"}),i.jsxs(Fe,{direction:"vertical",size:"middle",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Уровни экспертизы"}),i.jsx(En,{value:me.expertiseLevel,onChange:ge=>le(H=>({...H,expertiseLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Уровни анализа"}),i.jsx(En,{value:me.analysisLevel,onChange:ge=>le(H=>({...H,analysisLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Краткость ответов"}),i.jsx(En,{value:me.responseBrevity,onChange:ge=>le(H=>({...H,responseBrevity:ge})),min:0,max:100,marks:{0:"Подробно",50:"50%",100:"Кратко"}})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Анализ рисков"}),i.jsx(En,{value:me.riskAnalysis,onChange:ge=>le(H=>({...H,riskAnalysis:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Комментарии"}),i.jsx(En,{value:me.comments,onChange:ge=>le(H=>({...H,comments:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]}),i.jsxs("div",{children:[i.jsx(zt,{strong:!0,children:"Детализация"}),i.jsx(En,{value:me.detailLevel,onChange:ge=>le(H=>({...H,detailLevel:ge})),min:0,max:100,marks:{0:"0%",50:"50%",100:"100%"}})]})]})]})]})})]})]})},{Paragraph:rY,Text:aY}=mt;class S$ extends K.Component{constructor(r){super(r);sr(this,"logErrorToService",(r,a)=>{try{const n={timestamp:new Date().toISOString(),message:r.message,stack:r.stack,componentStack:a.componentStack},s=localStorage.getItem("error_logs"),o=s?JSON.parse(s):[];o.push(n),o.length>50&&o.shift(),localStorage.setItem("error_logs",JSON.stringify(o))}catch(n){console.error("Failed to log error:",n)}});sr(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});sr(this,"handleResetWithoutReload",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a),this.setState({error:r,errorInfo:a}),this.logErrorToService(r,a)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:i.jsx("div",{style:{padding:"50px",maxWidth:"800px",margin:"0 auto"},children:i.jsx(s_,{status:"error",icon:i.jsx(HT,{}),title:"Произошла ошибка",subTitle:"К сожалению, что-то пошло не так. Попробуйте перезагрузить страницу или вернуться на главную.",extra:[i.jsx(Be,{type:"primary",icon:i.jsx(ec,{}),onClick:this.handleReset,children:"Перезагрузить страницу"},"reload"),i.jsx(Be,{onClick:this.handleResetWithoutReload,children:"Попробовать снова"},"reset"),i.jsx(Be,{onClick:()=>window.location.href="/",children:"Вернуться на главную"},"home")],children:!1})}):this.props.children}}const T$=()=>{const e=Hd(),{theme:t,initialized:r}=Cf(n=>n.app);if(K.useEffect(()=>{(async()=>{try{try{localStorage.removeItem("zadachnik_tasks"),console.log("✅ Очищены старые задачи из localStorage (данные теперь в IndexedDB)")}catch(A){console.warn("Не удалось очистить задачи из localStorage (не критично):",A)}await Yt.initDatabase();const s=await Yt.getSettings();e(bO(s));const o=await Yt.getExtendedCards();if(o.length===0)try{const{loadDemoData:A}=await pi(async()=>{const{loadDemoData:l}=await import("./demoData-DEAyhEU4.js");return{loadDemoData:l}},__vite__mapDeps([4,1,5,3]),import.meta.url);await A(Yt);const c=await Yt.getExtendedCards();e(tf(c)),console.log("✅ Демо-данные загружены автоматически")}catch(A){console.warn("Демо-данные не загружены:",A),e(tf(o))}else e(tf(o));try{const{syncEmployeesToZadachnik:A}=await pi(async()=>{const{syncEmployeesToZadachnik:u}=await Promise.resolve().then(()=>OV);return{syncEmployeesToZadachnik:u}},void 0,import.meta.url);A();const l=fr.getEmployees().filter(u=>u.isActive);let d=[];try{d=await Yt.getTasks()}catch{try{const g=localStorage.getItem("zadachnik_tasks");g&&(g.length<4194304?d=JSON.parse(g):console.warn("Задачи в localStorage слишком большие, используем только IndexedDB"))}catch(g){console.warn("Не удалось загрузить задачи из localStorage:",g)}}const p=l.length*60;if(!d||d.length===0||d.length<p){const{generateTasksForEmployees:u}=await pi(async()=>{const{generateTasksForEmployees:g}=await Promise.resolve().then(()=>uS);return{generateTasksForEmployees:g}},void 0,import.meta.url);await u(),d=await Yt.getTasks(),console.log(`✅ Сгенерировано ${d.length} задач для ${l.length} активных сотрудников (${(d.length/l.length).toFixed(1)} задач на сотрудника)`)}else console.log(`✅ Загружено ${d.length} задач для ${l.length} активных сотрудников (${(d.length/l.length).toFixed(1)} задач на сотрудника)`)}catch(A){console.warn("Не удалось синхронизировать сотрудников с zadachnik:",A)}try{const A=(await pi(async()=>{const{default:l}=await Promise.resolve().then(()=>gM);return{default:l}},void 0,import.meta.url)).default;if(await A.initDatabase(),(await A.getInspections()).length===0){const{loadInspectionDemoData:l}=await pi(async()=>{const{loadInspectionDemoData:d}=await import("./inspectionDemoData-cQLZWfqt.js");return{loadInspectionDemoData:d}},__vite__mapDeps([6,1,5,3]),import.meta.url);await l(),console.log("✅ Демо-данные осмотров загружены автоматически")}}catch(A){console.warn("Демо-данные осмотров не загружены:",A)}e(_O(!0))}catch(s){console.error("Failed to initialize app:",s)}})()},[e]),!r)return i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Загрузка..."});const a=()=>{switch(t){case"dark":return UA.darkAlgorithm;case"compact":return[UA.defaultAlgorithm,UA.compactAlgorithm];default:return UA.defaultAlgorithm}};return i.jsx(j7,{children:i.jsx(H7,{children:i.jsx(JE,{locale:vO,theme:{algorithm:a(),token:{colorPrimary:"#1890ff",borderRadius:6}},children:i.jsx(GT,{children:i.jsx(oT,{children:i.jsx(AT,{children:i.jsxs(ra,{path:"/",element:i.jsx(Z7,{}),children:[i.jsx(ra,{index:!0,element:i.jsx(cT,{to:"/registry",replace:!0})}),i.jsx(ra,{path:"registry",element:i.jsx(_P,{})}),i.jsx(ra,{path:"portfolio",element:i.jsx(uz,{})}),i.jsx(ra,{path:"collateral-dossier",element:i.jsx(fz,{})}),i.jsx(ra,{path:"collateral-conclusions",element:i.jsx(tV,{})}),i.jsx(ra,{path:"tasks",element:i.jsx(Uz,{})}),i.jsx(ra,{path:"kpi",element:i.jsx(bV,{})}),i.jsx(ra,{path:"reports",element:i.jsx(Lz,{})}),i.jsx(ra,{path:"insurance",element:i.jsx(VG,{})}),i.jsx(ra,{path:"fnp",element:i.jsx(nV,{})}),i.jsx(ra,{path:"analytics",element:i.jsx(SV,{})}),i.jsx(ra,{path:"credit-risk",element:i.jsx(oV,{})}),i.jsx(ra,{path:"appraisal",element:i.jsx(AV,{})}),i.jsx(ra,{path:"cms-check",element:i.jsx(qz,{})}),i.jsx(ra,{path:"inspection/:token",element:i.jsx(Gz,{})}),i.jsx(ra,{path:"egrn",element:i.jsx(dV,{})}),i.jsx(ra,{path:"upload",element:i.jsx(a$,{})}),i.jsx(ra,{path:"monitoring",element:i.jsx(Rz,{})}),i.jsx(ra,{path:"reference",element:i.jsx(B$,{})}),i.jsx(ra,{path:"settings",element:i.jsx(zG,{title:"Настройки"})}),i.jsx(ra,{path:"settings/employees",element:i.jsx(kV,{})}),i.jsx(ra,{path:"settings/reference-data",element:i.jsx(jV,{})}),i.jsx(ra,{path:"settings/norm-hours",element:i.jsx(UV,{})}),i.jsx(ra,{path:"settings/metrics",element:i.jsx(KV,{})}),i.jsx(ra,{path:"settings/appraisal-companies",element:i.jsx(zV,{})})]})})})})})})})},O$=()=>i.jsx(S$,{children:i.jsx(fT,{store:RO,children:i.jsx(T$,{})})});M1.createRoot(document.getElementById("root")).render(i.jsx(Ma.StrictMode,{children:i.jsx(O$,{})}));export{Vs as g,Ca as i};
//# sourceMappingURL=index-DqF8OcGz.js.map
